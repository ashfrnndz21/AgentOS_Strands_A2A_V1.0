var Qpe=Object.defineProperty;var yU=e=>{throw TypeError(e)};var ege=(e,t,r)=>t in e?Qpe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var u0=(e,t,r)=>ege(e,typeof t!="symbol"?t+"":t,r),OI=(e,t,r)=>t.has(e)||yU("Cannot "+r);var dr=(e,t,r)=>(OI(e,t,"read from private field"),r?r.call(e):t.get(e)),rs=(e,t,r)=>t.has(e)?yU("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),ci=(e,t,r,i)=>(OI(e,t,"write to private field"),i?i.call(e,r):t.set(e,r),r),$o=(e,t,r)=>(OI(e,t,"access private method"),r);var hA=(e,t,r,i)=>({set _(a){ci(e,t,a,r)},get _(){return dr(e,t,i)}});function tge(e,t){for(var r=0;r<t.length;r++){const i=t[r];if(typeof i!="string"&&!Array.isArray(i)){for(const a in i)if(a!=="default"&&!(a in e)){const l=Object.getOwnPropertyDescriptor(i,a);l&&Object.defineProperty(e,a,l.get?l:{enumerable:!0,get:()=>i[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const d of l.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&i(d)}).observe(document,{childList:!0,subtree:!0});function r(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function i(a){if(a.ep)return;a.ep=!0;const l=r(a);fetch(a.href,l)}})();var To=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Vi(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function rge(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function i(){return this instanceof i?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(i){var a=Object.getOwnPropertyDescriptor(e,i);Object.defineProperty(r,i,a.get?a:{enumerable:!0,get:function(){return e[i]}})}),r}var RY={exports:{}},nE={},DY={exports:{}},vi={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ON=Symbol.for("react.element"),nge=Symbol.for("react.portal"),ige=Symbol.for("react.fragment"),sge=Symbol.for("react.strict_mode"),age=Symbol.for("react.profiler"),oge=Symbol.for("react.provider"),lge=Symbol.for("react.context"),cge=Symbol.for("react.forward_ref"),uge=Symbol.for("react.suspense"),dge=Symbol.for("react.memo"),hge=Symbol.for("react.lazy"),vU=Symbol.iterator;function mge(e){return e===null||typeof e!="object"?null:(e=vU&&e[vU]||e["@@iterator"],typeof e=="function"?e:null)}var zY={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},LY=Object.assign,FY={};function l_(e,t,r){this.props=e,this.context=t,this.refs=FY,this.updater=r||zY}l_.prototype.isReactComponent={};l_.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};l_.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function BY(){}BY.prototype=l_.prototype;function kL(e,t,r){this.props=e,this.context=t,this.refs=FY,this.updater=r||zY}var PL=kL.prototype=new BY;PL.constructor=kL;LY(PL,l_.prototype);PL.isPureReactComponent=!0;var bU=Array.isArray,$Y=Object.prototype.hasOwnProperty,EL={current:null},VY={key:!0,ref:!0,__self:!0,__source:!0};function UY(e,t,r){var i,a={},l=null,d=null;if(t!=null)for(i in t.ref!==void 0&&(d=t.ref),t.key!==void 0&&(l=""+t.key),t)$Y.call(t,i)&&!VY.hasOwnProperty(i)&&(a[i]=t[i]);var s=arguments.length-2;if(s===1)a.children=r;else if(1<s){for(var p=Array(s),x=0;x<s;x++)p[x]=arguments[x+2];a.children=p}if(e&&e.defaultProps)for(i in s=e.defaultProps,s)a[i]===void 0&&(a[i]=s[i]);return{$$typeof:ON,type:e,key:l,ref:d,props:a,_owner:EL.current}}function fge(e,t){return{$$typeof:ON,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function ML(e){return typeof e=="object"&&e!==null&&e.$$typeof===ON}function pge(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var _U=/\/+/g;function RI(e,t){return typeof e=="object"&&e!==null&&e.key!=null?pge(""+e.key):t.toString(36)}function fT(e,t,r,i,a){var l=typeof e;(l==="undefined"||l==="boolean")&&(e=null);var d=!1;if(e===null)d=!0;else switch(l){case"string":case"number":d=!0;break;case"object":switch(e.$$typeof){case ON:case nge:d=!0}}if(d)return d=e,a=a(d),e=i===""?"."+RI(d,0):i,bU(a)?(r="",e!=null&&(r=e.replace(_U,"$&/")+"/"),fT(a,t,r,"",function(x){return x})):a!=null&&(ML(a)&&(a=fge(a,r+(!a.key||d&&d.key===a.key?"":(""+a.key).replace(_U,"$&/")+"/")+e)),t.push(a)),1;if(d=0,i=i===""?".":i+":",bU(e))for(var s=0;s<e.length;s++){l=e[s];var p=i+RI(l,s);d+=fT(l,t,r,p,a)}else if(p=mge(e),typeof p=="function")for(e=p.call(e),s=0;!(l=e.next()).done;)l=l.value,p=i+RI(l,s++),d+=fT(l,t,r,p,a);else if(l==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return d}function mA(e,t,r){if(e==null)return e;var i=[],a=0;return fT(e,i,"","",function(l){return t.call(r,l,a++)}),i}function gge(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var kl={current:null},pT={transition:null},xge={ReactCurrentDispatcher:kl,ReactCurrentBatchConfig:pT,ReactCurrentOwner:EL};function GY(){throw Error("act(...) is not supported in production builds of React.")}vi.Children={map:mA,forEach:function(e,t,r){mA(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return mA(e,function(){t++}),t},toArray:function(e){return mA(e,function(t){return t})||[]},only:function(e){if(!ML(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};vi.Component=l_;vi.Fragment=ige;vi.Profiler=age;vi.PureComponent=kL;vi.StrictMode=sge;vi.Suspense=uge;vi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=xge;vi.act=GY;vi.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=LY({},e.props),a=e.key,l=e.ref,d=e._owner;if(t!=null){if(t.ref!==void 0&&(l=t.ref,d=EL.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var s=e.type.defaultProps;for(p in t)$Y.call(t,p)&&!VY.hasOwnProperty(p)&&(i[p]=t[p]===void 0&&s!==void 0?s[p]:t[p])}var p=arguments.length-2;if(p===1)i.children=r;else if(1<p){s=Array(p);for(var x=0;x<p;x++)s[x]=arguments[x+2];i.children=s}return{$$typeof:ON,type:e.type,key:a,ref:l,props:i,_owner:d}};vi.createContext=function(e){return e={$$typeof:lge,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:oge,_context:e},e.Consumer=e};vi.createElement=UY;vi.createFactory=function(e){var t=UY.bind(null,e);return t.type=e,t};vi.createRef=function(){return{current:null}};vi.forwardRef=function(e){return{$$typeof:cge,render:e}};vi.isValidElement=ML;vi.lazy=function(e){return{$$typeof:hge,_payload:{_status:-1,_result:e},_init:gge}};vi.memo=function(e,t){return{$$typeof:dge,type:e,compare:t===void 0?null:t}};vi.startTransition=function(e){var t=pT.transition;pT.transition={};try{e()}finally{pT.transition=t}};vi.unstable_act=GY;vi.useCallback=function(e,t){return kl.current.useCallback(e,t)};vi.useContext=function(e){return kl.current.useContext(e)};vi.useDebugValue=function(){};vi.useDeferredValue=function(e){return kl.current.useDeferredValue(e)};vi.useEffect=function(e,t){return kl.current.useEffect(e,t)};vi.useId=function(){return kl.current.useId()};vi.useImperativeHandle=function(e,t,r){return kl.current.useImperativeHandle(e,t,r)};vi.useInsertionEffect=function(e,t){return kl.current.useInsertionEffect(e,t)};vi.useLayoutEffect=function(e,t){return kl.current.useLayoutEffect(e,t)};vi.useMemo=function(e,t){return kl.current.useMemo(e,t)};vi.useReducer=function(e,t,r){return kl.current.useReducer(e,t,r)};vi.useRef=function(e){return kl.current.useRef(e)};vi.useState=function(e){return kl.current.useState(e)};vi.useSyncExternalStore=function(e,t,r){return kl.current.useSyncExternalStore(e,t,r)};vi.useTransition=function(){return kl.current.useTransition()};vi.version="18.3.1";DY.exports=vi;var U=DY.exports;const ke=Vi(U),HY=tge({__proto__:null,default:ke},[U]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yge=U,vge=Symbol.for("react.element"),bge=Symbol.for("react.fragment"),_ge=Object.prototype.hasOwnProperty,wge=yge.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,jge={key:!0,ref:!0,__self:!0,__source:!0};function qY(e,t,r){var i,a={},l=null,d=null;r!==void 0&&(l=""+r),t.key!==void 0&&(l=""+t.key),t.ref!==void 0&&(d=t.ref);for(i in t)_ge.call(t,i)&&!jge.hasOwnProperty(i)&&(a[i]=t[i]);if(e&&e.defaultProps)for(i in t=e.defaultProps,t)a[i]===void 0&&(a[i]=t[i]);return{$$typeof:vge,type:e,key:l,ref:d,props:a,_owner:wge.current}}nE.Fragment=bge;nE.jsx=qY;nE.jsxs=qY;RY.exports=nE;var n=RY.exports,FR={},WY={exports:{}},qc={},KY={exports:{}},ZY={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(je,Ce){var tt=je.length;je.push(Ce);e:for(;0<tt;){var it=tt-1>>>1,mt=je[it];if(0<a(mt,Ce))je[it]=Ce,je[tt]=mt,tt=it;else break e}}function r(je){return je.length===0?null:je[0]}function i(je){if(je.length===0)return null;var Ce=je[0],tt=je.pop();if(tt!==Ce){je[0]=tt;e:for(var it=0,mt=je.length,gt=mt>>>1;it<gt;){var qt=2*(it+1)-1,yr=je[qt],tr=qt+1,Ft=je[tr];if(0>a(yr,tt))tr<mt&&0>a(Ft,yr)?(je[it]=Ft,je[tr]=tt,it=tr):(je[it]=yr,je[qt]=tt,it=qt);else if(tr<mt&&0>a(Ft,tt))je[it]=Ft,je[tr]=tt,it=tr;else break e}}return Ce}function a(je,Ce){var tt=je.sortIndex-Ce.sortIndex;return tt!==0?tt:je.id-Ce.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;e.unstable_now=function(){return l.now()}}else{var d=Date,s=d.now();e.unstable_now=function(){return d.now()-s}}var p=[],x=[],w=1,j=null,S=3,P=!1,F=!1,L=!1,B=typeof setTimeout=="function"?setTimeout:null,V=typeof clearTimeout=="function"?clearTimeout:null,$=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function G(je){for(var Ce=r(x);Ce!==null;){if(Ce.callback===null)i(x);else if(Ce.startTime<=je)i(x),Ce.sortIndex=Ce.expirationTime,t(p,Ce);else break;Ce=r(x)}}function W(je){if(L=!1,G(je),!F)if(r(p)!==null)F=!0,_e(Z);else{var Ce=r(x);Ce!==null&&Ee(W,Ce.startTime-je)}}function Z(je,Ce){F=!1,L&&(L=!1,V(ce),ce=-1),P=!0;var tt=S;try{for(G(Ce),j=r(p);j!==null&&(!(j.expirationTime>Ce)||je&&!xe());){var it=j.callback;if(typeof it=="function"){j.callback=null,S=j.priorityLevel;var mt=it(j.expirationTime<=Ce);Ce=e.unstable_now(),typeof mt=="function"?j.callback=mt:j===r(p)&&i(p),G(Ce)}else i(p);j=r(p)}if(j!==null)var gt=!0;else{var qt=r(x);qt!==null&&Ee(W,qt.startTime-Ce),gt=!1}return gt}finally{j=null,S=tt,P=!1}}var se=!1,ae=null,ce=-1,Pe=5,we=-1;function xe(){return!(e.unstable_now()-we<Pe)}function Ne(){if(ae!==null){var je=e.unstable_now();we=je;var Ce=!0;try{Ce=ae(!0,je)}finally{Ce?ze():(se=!1,ae=null)}}else se=!1}var ze;if(typeof $=="function")ze=function(){$(Ne)};else if(typeof MessageChannel<"u"){var ye=new MessageChannel,ve=ye.port2;ye.port1.onmessage=Ne,ze=function(){ve.postMessage(null)}}else ze=function(){B(Ne,0)};function _e(je){ae=je,se||(se=!0,ze())}function Ee(je,Ce){ce=B(function(){je(e.unstable_now())},Ce)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(je){je.callback=null},e.unstable_continueExecution=function(){F||P||(F=!0,_e(Z))},e.unstable_forceFrameRate=function(je){0>je||125<je?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Pe=0<je?Math.floor(1e3/je):5},e.unstable_getCurrentPriorityLevel=function(){return S},e.unstable_getFirstCallbackNode=function(){return r(p)},e.unstable_next=function(je){switch(S){case 1:case 2:case 3:var Ce=3;break;default:Ce=S}var tt=S;S=Ce;try{return je()}finally{S=tt}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(je,Ce){switch(je){case 1:case 2:case 3:case 4:case 5:break;default:je=3}var tt=S;S=je;try{return Ce()}finally{S=tt}},e.unstable_scheduleCallback=function(je,Ce,tt){var it=e.unstable_now();switch(typeof tt=="object"&&tt!==null?(tt=tt.delay,tt=typeof tt=="number"&&0<tt?it+tt:it):tt=it,je){case 1:var mt=-1;break;case 2:mt=250;break;case 5:mt=1073741823;break;case 4:mt=1e4;break;default:mt=5e3}return mt=tt+mt,je={id:w++,callback:Ce,priorityLevel:je,startTime:tt,expirationTime:mt,sortIndex:-1},tt>it?(je.sortIndex=tt,t(x,je),r(p)===null&&je===r(x)&&(L?(V(ce),ce=-1):L=!0,Ee(W,tt-it))):(je.sortIndex=mt,t(p,je),F||P||(F=!0,_e(Z))),je},e.unstable_shouldYield=xe,e.unstable_wrapCallback=function(je){var Ce=S;return function(){var tt=S;S=Ce;try{return je.apply(this,arguments)}finally{S=tt}}}})(ZY);KY.exports=ZY;var Nge=KY.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Sge=U,Fc=Nge;function Sr(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var YY=new Set,Jj={};function gx(e,t){rb(e,t),rb(e+"Capture",t)}function rb(e,t){for(Jj[e]=t,e=0;e<t.length;e++)YY.add(t[e])}var Sm=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),BR=Object.prototype.hasOwnProperty,Cge=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,wU={},jU={};function Age(e){return BR.call(jU,e)?!0:BR.call(wU,e)?!1:Cge.test(e)?jU[e]=!0:(wU[e]=!0,!1)}function Tge(e,t,r,i){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return i?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function kge(e,t,r,i){if(t===null||typeof t>"u"||Tge(e,t,r,i))return!0;if(i)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Pl(e,t,r,i,a,l,d){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=i,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=l,this.removeEmptyString=d}var Eo={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Eo[e]=new Pl(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Eo[t]=new Pl(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Eo[e]=new Pl(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Eo[e]=new Pl(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Eo[e]=new Pl(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Eo[e]=new Pl(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Eo[e]=new Pl(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Eo[e]=new Pl(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Eo[e]=new Pl(e,5,!1,e.toLowerCase(),null,!1,!1)});var IL=/[\-:]([a-z])/g;function OL(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(IL,OL);Eo[t]=new Pl(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(IL,OL);Eo[t]=new Pl(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(IL,OL);Eo[t]=new Pl(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Eo[e]=new Pl(e,1,!1,e.toLowerCase(),null,!1,!1)});Eo.xlinkHref=new Pl("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Eo[e]=new Pl(e,1,!1,e.toLowerCase(),null,!0,!0)});function RL(e,t,r,i){var a=Eo.hasOwnProperty(t)?Eo[t]:null;(a!==null?a.type!==0:i||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(kge(t,r,a,i)&&(r=null),i||a===null?Age(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):a.mustUseProperty?e[a.propertyName]=r===null?a.type===3?!1:"":r:(t=a.attributeName,i=a.attributeNamespace,r===null?e.removeAttribute(t):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,i?e.setAttributeNS(i,t,r):e.setAttribute(t,r))))}var Lm=Sge.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,fA=Symbol.for("react.element"),cv=Symbol.for("react.portal"),uv=Symbol.for("react.fragment"),DL=Symbol.for("react.strict_mode"),$R=Symbol.for("react.profiler"),XY=Symbol.for("react.provider"),JY=Symbol.for("react.context"),zL=Symbol.for("react.forward_ref"),VR=Symbol.for("react.suspense"),UR=Symbol.for("react.suspense_list"),LL=Symbol.for("react.memo"),tp=Symbol.for("react.lazy"),QY=Symbol.for("react.offscreen"),NU=Symbol.iterator;function Fw(e){return e===null||typeof e!="object"?null:(e=NU&&e[NU]||e["@@iterator"],typeof e=="function"?e:null)}var sa=Object.assign,DI;function mj(e){if(DI===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);DI=t&&t[1]||""}return`
`+DI+e}var zI=!1;function LI(e,t){if(!e||zI)return"";zI=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(x){var i=x}Reflect.construct(e,[],t)}else{try{t.call()}catch(x){i=x}e.call(t.prototype)}else{try{throw Error()}catch(x){i=x}e()}}catch(x){if(x&&i&&typeof x.stack=="string"){for(var a=x.stack.split(`
`),l=i.stack.split(`
`),d=a.length-1,s=l.length-1;1<=d&&0<=s&&a[d]!==l[s];)s--;for(;1<=d&&0<=s;d--,s--)if(a[d]!==l[s]){if(d!==1||s!==1)do if(d--,s--,0>s||a[d]!==l[s]){var p=`
`+a[d].replace(" at new "," at ");return e.displayName&&p.includes("<anonymous>")&&(p=p.replace("<anonymous>",e.displayName)),p}while(1<=d&&0<=s);break}}}finally{zI=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?mj(e):""}function Pge(e){switch(e.tag){case 5:return mj(e.type);case 16:return mj("Lazy");case 13:return mj("Suspense");case 19:return mj("SuspenseList");case 0:case 2:case 15:return e=LI(e.type,!1),e;case 11:return e=LI(e.type.render,!1),e;case 1:return e=LI(e.type,!0),e;default:return""}}function GR(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case uv:return"Fragment";case cv:return"Portal";case $R:return"Profiler";case DL:return"StrictMode";case VR:return"Suspense";case UR:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case JY:return(e.displayName||"Context")+".Consumer";case XY:return(e._context.displayName||"Context")+".Provider";case zL:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case LL:return t=e.displayName||null,t!==null?t:GR(e.type)||"Memo";case tp:t=e._payload,e=e._init;try{return GR(e(t))}catch{}}return null}function Ege(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return GR(t);case 8:return t===DL?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Bp(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function eX(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Mge(e){var t=eX(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),i=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,l=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(d){i=""+d,l.call(this,d)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return i},setValue:function(d){i=""+d},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function pA(e){e._valueTracker||(e._valueTracker=Mge(e))}function tX(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),i="";return e&&(i=eX(e)?e.checked?"true":"false":e.value),e=i,e!==r?(t.setValue(e),!0):!1}function FT(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function HR(e,t){var r=t.checked;return sa({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function SU(e,t){var r=t.defaultValue==null?"":t.defaultValue,i=t.checked!=null?t.checked:t.defaultChecked;r=Bp(t.value!=null?t.value:r),e._wrapperState={initialChecked:i,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function rX(e,t){t=t.checked,t!=null&&RL(e,"checked",t,!1)}function qR(e,t){rX(e,t);var r=Bp(t.value),i=t.type;if(r!=null)i==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(i==="submit"||i==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?WR(e,t.type,r):t.hasOwnProperty("defaultValue")&&WR(e,t.type,Bp(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function CU(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var i=t.type;if(!(i!=="submit"&&i!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function WR(e,t,r){(t!=="number"||FT(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var fj=Array.isArray;function Tv(e,t,r,i){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&i&&(e[r].defaultSelected=!0)}else{for(r=""+Bp(r),t=null,a=0;a<e.length;a++){if(e[a].value===r){e[a].selected=!0,i&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function KR(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Sr(91));return sa({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function AU(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(Sr(92));if(fj(r)){if(1<r.length)throw Error(Sr(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Bp(r)}}function nX(e,t){var r=Bp(t.value),i=Bp(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),i!=null&&(e.defaultValue=""+i)}function TU(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function iX(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ZR(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?iX(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var gA,sX=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,i,a){MSApp.execUnsafeLocalFunction(function(){return e(t,r,i,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(gA=gA||document.createElement("div"),gA.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=gA.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Qj(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Sj={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Ige=["Webkit","ms","Moz","O"];Object.keys(Sj).forEach(function(e){Ige.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Sj[t]=Sj[e]})});function aX(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Sj.hasOwnProperty(e)&&Sj[e]?(""+t).trim():t+"px"}function oX(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var i=r.indexOf("--")===0,a=aX(r,t[r],i);r==="float"&&(r="cssFloat"),i?e.setProperty(r,a):e[r]=a}}var Oge=sa({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function YR(e,t){if(t){if(Oge[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Sr(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Sr(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Sr(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Sr(62))}}function XR(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var JR=null;function FL(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var QR=null,kv=null,Pv=null;function kU(e){if(e=zN(e)){if(typeof QR!="function")throw Error(Sr(280));var t=e.stateNode;t&&(t=lE(t),QR(e.stateNode,e.type,t))}}function lX(e){kv?Pv?Pv.push(e):Pv=[e]:kv=e}function cX(){if(kv){var e=kv,t=Pv;if(Pv=kv=null,kU(e),t)for(e=0;e<t.length;e++)kU(t[e])}}function uX(e,t){return e(t)}function dX(){}var FI=!1;function hX(e,t,r){if(FI)return e(t,r);FI=!0;try{return uX(e,t,r)}finally{FI=!1,(kv!==null||Pv!==null)&&(dX(),cX())}}function e2(e,t){var r=e.stateNode;if(r===null)return null;var i=lE(r);if(i===null)return null;r=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(e=e.type,i=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!i;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(Sr(231,t,typeof r));return r}var eD=!1;if(Sm)try{var Bw={};Object.defineProperty(Bw,"passive",{get:function(){eD=!0}}),window.addEventListener("test",Bw,Bw),window.removeEventListener("test",Bw,Bw)}catch{eD=!1}function Rge(e,t,r,i,a,l,d,s,p){var x=Array.prototype.slice.call(arguments,3);try{t.apply(r,x)}catch(w){this.onError(w)}}var Cj=!1,BT=null,$T=!1,tD=null,Dge={onError:function(e){Cj=!0,BT=e}};function zge(e,t,r,i,a,l,d,s,p){Cj=!1,BT=null,Rge.apply(Dge,arguments)}function Lge(e,t,r,i,a,l,d,s,p){if(zge.apply(this,arguments),Cj){if(Cj){var x=BT;Cj=!1,BT=null}else throw Error(Sr(198));$T||($T=!0,tD=x)}}function xx(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function mX(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function PU(e){if(xx(e)!==e)throw Error(Sr(188))}function Fge(e){var t=e.alternate;if(!t){if(t=xx(e),t===null)throw Error(Sr(188));return t!==e?null:e}for(var r=e,i=t;;){var a=r.return;if(a===null)break;var l=a.alternate;if(l===null){if(i=a.return,i!==null){r=i;continue}break}if(a.child===l.child){for(l=a.child;l;){if(l===r)return PU(a),e;if(l===i)return PU(a),t;l=l.sibling}throw Error(Sr(188))}if(r.return!==i.return)r=a,i=l;else{for(var d=!1,s=a.child;s;){if(s===r){d=!0,r=a,i=l;break}if(s===i){d=!0,i=a,r=l;break}s=s.sibling}if(!d){for(s=l.child;s;){if(s===r){d=!0,r=l,i=a;break}if(s===i){d=!0,i=l,r=a;break}s=s.sibling}if(!d)throw Error(Sr(189))}}if(r.alternate!==i)throw Error(Sr(190))}if(r.tag!==3)throw Error(Sr(188));return r.stateNode.current===r?e:t}function fX(e){return e=Fge(e),e!==null?pX(e):null}function pX(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=pX(e);if(t!==null)return t;e=e.sibling}return null}var gX=Fc.unstable_scheduleCallback,EU=Fc.unstable_cancelCallback,Bge=Fc.unstable_shouldYield,$ge=Fc.unstable_requestPaint,ja=Fc.unstable_now,Vge=Fc.unstable_getCurrentPriorityLevel,BL=Fc.unstable_ImmediatePriority,xX=Fc.unstable_UserBlockingPriority,VT=Fc.unstable_NormalPriority,Uge=Fc.unstable_LowPriority,yX=Fc.unstable_IdlePriority,iE=null,uh=null;function Gge(e){if(uh&&typeof uh.onCommitFiberRoot=="function")try{uh.onCommitFiberRoot(iE,e,void 0,(e.current.flags&128)===128)}catch{}}var pd=Math.clz32?Math.clz32:Wge,Hge=Math.log,qge=Math.LN2;function Wge(e){return e>>>=0,e===0?32:31-(Hge(e)/qge|0)|0}var xA=64,yA=4194304;function pj(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function UT(e,t){var r=e.pendingLanes;if(r===0)return 0;var i=0,a=e.suspendedLanes,l=e.pingedLanes,d=r&268435455;if(d!==0){var s=d&~a;s!==0?i=pj(s):(l&=d,l!==0&&(i=pj(l)))}else d=r&~a,d!==0?i=pj(d):l!==0&&(i=pj(l));if(i===0)return 0;if(t!==0&&t!==i&&!(t&a)&&(a=i&-i,l=t&-t,a>=l||a===16&&(l&4194240)!==0))return t;if(i&4&&(i|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=i;0<t;)r=31-pd(t),a=1<<r,i|=e[r],t&=~a;return i}function Kge(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Zge(e,t){for(var r=e.suspendedLanes,i=e.pingedLanes,a=e.expirationTimes,l=e.pendingLanes;0<l;){var d=31-pd(l),s=1<<d,p=a[d];p===-1?(!(s&r)||s&i)&&(a[d]=Kge(s,t)):p<=t&&(e.expiredLanes|=s),l&=~s}}function rD(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function vX(){var e=xA;return xA<<=1,!(xA&4194240)&&(xA=64),e}function BI(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function RN(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-pd(t),e[t]=r}function Yge(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var i=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-pd(r),l=1<<a;t[a]=0,i[a]=-1,e[a]=-1,r&=~l}}function $L(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var i=31-pd(r),a=1<<i;a&t|e[i]&t&&(e[i]|=t),r&=~a}}var ls=0;function bX(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var _X,VL,wX,jX,NX,nD=!1,vA=[],Np=null,Sp=null,Cp=null,t2=new Map,r2=new Map,sp=[],Xge="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function MU(e,t){switch(e){case"focusin":case"focusout":Np=null;break;case"dragenter":case"dragleave":Sp=null;break;case"mouseover":case"mouseout":Cp=null;break;case"pointerover":case"pointerout":t2.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":r2.delete(t.pointerId)}}function $w(e,t,r,i,a,l){return e===null||e.nativeEvent!==l?(e={blockedOn:t,domEventName:r,eventSystemFlags:i,nativeEvent:l,targetContainers:[a]},t!==null&&(t=zN(t),t!==null&&VL(t)),e):(e.eventSystemFlags|=i,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function Jge(e,t,r,i,a){switch(t){case"focusin":return Np=$w(Np,e,t,r,i,a),!0;case"dragenter":return Sp=$w(Sp,e,t,r,i,a),!0;case"mouseover":return Cp=$w(Cp,e,t,r,i,a),!0;case"pointerover":var l=a.pointerId;return t2.set(l,$w(t2.get(l)||null,e,t,r,i,a)),!0;case"gotpointercapture":return l=a.pointerId,r2.set(l,$w(r2.get(l)||null,e,t,r,i,a)),!0}return!1}function SX(e){var t=A0(e.target);if(t!==null){var r=xx(t);if(r!==null){if(t=r.tag,t===13){if(t=mX(r),t!==null){e.blockedOn=t,NX(e.priority,function(){wX(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function gT(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=iD(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var i=new r.constructor(r.type,r);JR=i,r.target.dispatchEvent(i),JR=null}else return t=zN(r),t!==null&&VL(t),e.blockedOn=r,!1;t.shift()}return!0}function IU(e,t,r){gT(e)&&r.delete(t)}function Qge(){nD=!1,Np!==null&&gT(Np)&&(Np=null),Sp!==null&&gT(Sp)&&(Sp=null),Cp!==null&&gT(Cp)&&(Cp=null),t2.forEach(IU),r2.forEach(IU)}function Vw(e,t){e.blockedOn===t&&(e.blockedOn=null,nD||(nD=!0,Fc.unstable_scheduleCallback(Fc.unstable_NormalPriority,Qge)))}function n2(e){function t(a){return Vw(a,e)}if(0<vA.length){Vw(vA[0],e);for(var r=1;r<vA.length;r++){var i=vA[r];i.blockedOn===e&&(i.blockedOn=null)}}for(Np!==null&&Vw(Np,e),Sp!==null&&Vw(Sp,e),Cp!==null&&Vw(Cp,e),t2.forEach(t),r2.forEach(t),r=0;r<sp.length;r++)i=sp[r],i.blockedOn===e&&(i.blockedOn=null);for(;0<sp.length&&(r=sp[0],r.blockedOn===null);)SX(r),r.blockedOn===null&&sp.shift()}var Ev=Lm.ReactCurrentBatchConfig,GT=!0;function e0e(e,t,r,i){var a=ls,l=Ev.transition;Ev.transition=null;try{ls=1,UL(e,t,r,i)}finally{ls=a,Ev.transition=l}}function t0e(e,t,r,i){var a=ls,l=Ev.transition;Ev.transition=null;try{ls=4,UL(e,t,r,i)}finally{ls=a,Ev.transition=l}}function UL(e,t,r,i){if(GT){var a=iD(e,t,r,i);if(a===null)YI(e,t,i,HT,r),MU(e,i);else if(Jge(a,e,t,r,i))i.stopPropagation();else if(MU(e,i),t&4&&-1<Xge.indexOf(e)){for(;a!==null;){var l=zN(a);if(l!==null&&_X(l),l=iD(e,t,r,i),l===null&&YI(e,t,i,HT,r),l===a)break;a=l}a!==null&&i.stopPropagation()}else YI(e,t,i,null,r)}}var HT=null;function iD(e,t,r,i){if(HT=null,e=FL(i),e=A0(e),e!==null)if(t=xx(e),t===null)e=null;else if(r=t.tag,r===13){if(e=mX(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return HT=e,null}function CX(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Vge()){case BL:return 1;case xX:return 4;case VT:case Uge:return 16;case yX:return 536870912;default:return 16}default:return 16}}var yp=null,GL=null,xT=null;function AX(){if(xT)return xT;var e,t=GL,r=t.length,i,a="value"in yp?yp.value:yp.textContent,l=a.length;for(e=0;e<r&&t[e]===a[e];e++);var d=r-e;for(i=1;i<=d&&t[r-i]===a[l-i];i++);return xT=a.slice(e,1<i?1-i:void 0)}function yT(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function bA(){return!0}function OU(){return!1}function Wc(e){function t(r,i,a,l,d){this._reactName=r,this._targetInst=a,this.type=i,this.nativeEvent=l,this.target=d,this.currentTarget=null;for(var s in e)e.hasOwnProperty(s)&&(r=e[s],this[s]=r?r(l):l[s]);return this.isDefaultPrevented=(l.defaultPrevented!=null?l.defaultPrevented:l.returnValue===!1)?bA:OU,this.isPropagationStopped=OU,this}return sa(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=bA)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=bA)},persist:function(){},isPersistent:bA}),t}var c_={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},HL=Wc(c_),DN=sa({},c_,{view:0,detail:0}),r0e=Wc(DN),$I,VI,Uw,sE=sa({},DN,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:qL,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Uw&&(Uw&&e.type==="mousemove"?($I=e.screenX-Uw.screenX,VI=e.screenY-Uw.screenY):VI=$I=0,Uw=e),$I)},movementY:function(e){return"movementY"in e?e.movementY:VI}}),RU=Wc(sE),n0e=sa({},sE,{dataTransfer:0}),i0e=Wc(n0e),s0e=sa({},DN,{relatedTarget:0}),UI=Wc(s0e),a0e=sa({},c_,{animationName:0,elapsedTime:0,pseudoElement:0}),o0e=Wc(a0e),l0e=sa({},c_,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),c0e=Wc(l0e),u0e=sa({},c_,{data:0}),DU=Wc(u0e),d0e={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},h0e={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},m0e={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function f0e(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=m0e[e])?!!t[e]:!1}function qL(){return f0e}var p0e=sa({},DN,{key:function(e){if(e.key){var t=d0e[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=yT(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?h0e[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:qL,charCode:function(e){return e.type==="keypress"?yT(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?yT(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),g0e=Wc(p0e),x0e=sa({},sE,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),zU=Wc(x0e),y0e=sa({},DN,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:qL}),v0e=Wc(y0e),b0e=sa({},c_,{propertyName:0,elapsedTime:0,pseudoElement:0}),_0e=Wc(b0e),w0e=sa({},sE,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),j0e=Wc(w0e),N0e=[9,13,27,32],WL=Sm&&"CompositionEvent"in window,Aj=null;Sm&&"documentMode"in document&&(Aj=document.documentMode);var S0e=Sm&&"TextEvent"in window&&!Aj,TX=Sm&&(!WL||Aj&&8<Aj&&11>=Aj),LU=" ",FU=!1;function kX(e,t){switch(e){case"keyup":return N0e.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function PX(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var dv=!1;function C0e(e,t){switch(e){case"compositionend":return PX(t);case"keypress":return t.which!==32?null:(FU=!0,LU);case"textInput":return e=t.data,e===LU&&FU?null:e;default:return null}}function A0e(e,t){if(dv)return e==="compositionend"||!WL&&kX(e,t)?(e=AX(),xT=GL=yp=null,dv=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return TX&&t.locale!=="ko"?null:t.data;default:return null}}var T0e={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function BU(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!T0e[e.type]:t==="textarea"}function EX(e,t,r,i){lX(i),t=qT(t,"onChange"),0<t.length&&(r=new HL("onChange","change",null,r,i),e.push({event:r,listeners:t}))}var Tj=null,i2=null;function k0e(e){VX(e,0)}function aE(e){var t=fv(e);if(tX(t))return e}function P0e(e,t){if(e==="change")return t}var MX=!1;if(Sm){var GI;if(Sm){var HI="oninput"in document;if(!HI){var $U=document.createElement("div");$U.setAttribute("oninput","return;"),HI=typeof $U.oninput=="function"}GI=HI}else GI=!1;MX=GI&&(!document.documentMode||9<document.documentMode)}function VU(){Tj&&(Tj.detachEvent("onpropertychange",IX),i2=Tj=null)}function IX(e){if(e.propertyName==="value"&&aE(i2)){var t=[];EX(t,i2,e,FL(e)),hX(k0e,t)}}function E0e(e,t,r){e==="focusin"?(VU(),Tj=t,i2=r,Tj.attachEvent("onpropertychange",IX)):e==="focusout"&&VU()}function M0e(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return aE(i2)}function I0e(e,t){if(e==="click")return aE(t)}function O0e(e,t){if(e==="input"||e==="change")return aE(t)}function R0e(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var vd=typeof Object.is=="function"?Object.is:R0e;function s2(e,t){if(vd(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),i=Object.keys(t);if(r.length!==i.length)return!1;for(i=0;i<r.length;i++){var a=r[i];if(!BR.call(t,a)||!vd(e[a],t[a]))return!1}return!0}function UU(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function GU(e,t){var r=UU(e);e=0;for(var i;r;){if(r.nodeType===3){if(i=e+r.textContent.length,e<=t&&i>=t)return{node:r,offset:t-e};e=i}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=UU(r)}}function OX(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?OX(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function RX(){for(var e=window,t=FT();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=FT(e.document)}return t}function KL(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function D0e(e){var t=RX(),r=e.focusedElem,i=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&OX(r.ownerDocument.documentElement,r)){if(i!==null&&KL(r)){if(t=i.start,e=i.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=r.textContent.length,l=Math.min(i.start,a);i=i.end===void 0?l:Math.min(i.end,a),!e.extend&&l>i&&(a=i,i=l,l=a),a=GU(r,l);var d=GU(r,i);a&&d&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==d.node||e.focusOffset!==d.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),l>i?(e.addRange(t),e.extend(d.node,d.offset)):(t.setEnd(d.node,d.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var z0e=Sm&&"documentMode"in document&&11>=document.documentMode,hv=null,sD=null,kj=null,aD=!1;function HU(e,t,r){var i=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;aD||hv==null||hv!==FT(i)||(i=hv,"selectionStart"in i&&KL(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),kj&&s2(kj,i)||(kj=i,i=qT(sD,"onSelect"),0<i.length&&(t=new HL("onSelect","select",null,t,r),e.push({event:t,listeners:i}),t.target=hv)))}function _A(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var mv={animationend:_A("Animation","AnimationEnd"),animationiteration:_A("Animation","AnimationIteration"),animationstart:_A("Animation","AnimationStart"),transitionend:_A("Transition","TransitionEnd")},qI={},DX={};Sm&&(DX=document.createElement("div").style,"AnimationEvent"in window||(delete mv.animationend.animation,delete mv.animationiteration.animation,delete mv.animationstart.animation),"TransitionEvent"in window||delete mv.transitionend.transition);function oE(e){if(qI[e])return qI[e];if(!mv[e])return e;var t=mv[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in DX)return qI[e]=t[r];return e}var zX=oE("animationend"),LX=oE("animationiteration"),FX=oE("animationstart"),BX=oE("transitionend"),$X=new Map,qU="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Jp(e,t){$X.set(e,t),gx(t,[e])}for(var WI=0;WI<qU.length;WI++){var KI=qU[WI],L0e=KI.toLowerCase(),F0e=KI[0].toUpperCase()+KI.slice(1);Jp(L0e,"on"+F0e)}Jp(zX,"onAnimationEnd");Jp(LX,"onAnimationIteration");Jp(FX,"onAnimationStart");Jp("dblclick","onDoubleClick");Jp("focusin","onFocus");Jp("focusout","onBlur");Jp(BX,"onTransitionEnd");rb("onMouseEnter",["mouseout","mouseover"]);rb("onMouseLeave",["mouseout","mouseover"]);rb("onPointerEnter",["pointerout","pointerover"]);rb("onPointerLeave",["pointerout","pointerover"]);gx("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));gx("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));gx("onBeforeInput",["compositionend","keypress","textInput","paste"]);gx("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));gx("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));gx("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var gj="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),B0e=new Set("cancel close invalid load scroll toggle".split(" ").concat(gj));function WU(e,t,r){var i=e.type||"unknown-event";e.currentTarget=r,Lge(i,t,void 0,e),e.currentTarget=null}function VX(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var i=e[r],a=i.event;i=i.listeners;e:{var l=void 0;if(t)for(var d=i.length-1;0<=d;d--){var s=i[d],p=s.instance,x=s.currentTarget;if(s=s.listener,p!==l&&a.isPropagationStopped())break e;WU(a,s,x),l=p}else for(d=0;d<i.length;d++){if(s=i[d],p=s.instance,x=s.currentTarget,s=s.listener,p!==l&&a.isPropagationStopped())break e;WU(a,s,x),l=p}}}if($T)throw e=tD,$T=!1,tD=null,e}function Rs(e,t){var r=t[dD];r===void 0&&(r=t[dD]=new Set);var i=e+"__bubble";r.has(i)||(UX(t,e,2,!1),r.add(i))}function ZI(e,t,r){var i=0;t&&(i|=4),UX(r,e,i,t)}var wA="_reactListening"+Math.random().toString(36).slice(2);function a2(e){if(!e[wA]){e[wA]=!0,YY.forEach(function(r){r!=="selectionchange"&&(B0e.has(r)||ZI(r,!1,e),ZI(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[wA]||(t[wA]=!0,ZI("selectionchange",!1,t))}}function UX(e,t,r,i){switch(CX(t)){case 1:var a=e0e;break;case 4:a=t0e;break;default:a=UL}r=a.bind(null,t,r,e),a=void 0,!eD||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),i?a!==void 0?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):a!==void 0?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function YI(e,t,r,i,a){var l=i;if(!(t&1)&&!(t&2)&&i!==null)e:for(;;){if(i===null)return;var d=i.tag;if(d===3||d===4){var s=i.stateNode.containerInfo;if(s===a||s.nodeType===8&&s.parentNode===a)break;if(d===4)for(d=i.return;d!==null;){var p=d.tag;if((p===3||p===4)&&(p=d.stateNode.containerInfo,p===a||p.nodeType===8&&p.parentNode===a))return;d=d.return}for(;s!==null;){if(d=A0(s),d===null)return;if(p=d.tag,p===5||p===6){i=l=d;continue e}s=s.parentNode}}i=i.return}hX(function(){var x=l,w=FL(r),j=[];e:{var S=$X.get(e);if(S!==void 0){var P=HL,F=e;switch(e){case"keypress":if(yT(r)===0)break e;case"keydown":case"keyup":P=g0e;break;case"focusin":F="focus",P=UI;break;case"focusout":F="blur",P=UI;break;case"beforeblur":case"afterblur":P=UI;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":P=RU;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":P=i0e;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":P=v0e;break;case zX:case LX:case FX:P=o0e;break;case BX:P=_0e;break;case"scroll":P=r0e;break;case"wheel":P=j0e;break;case"copy":case"cut":case"paste":P=c0e;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":P=zU}var L=(t&4)!==0,B=!L&&e==="scroll",V=L?S!==null?S+"Capture":null:S;L=[];for(var $=x,G;$!==null;){G=$;var W=G.stateNode;if(G.tag===5&&W!==null&&(G=W,V!==null&&(W=e2($,V),W!=null&&L.push(o2($,W,G)))),B)break;$=$.return}0<L.length&&(S=new P(S,F,null,r,w),j.push({event:S,listeners:L}))}}if(!(t&7)){e:{if(S=e==="mouseover"||e==="pointerover",P=e==="mouseout"||e==="pointerout",S&&r!==JR&&(F=r.relatedTarget||r.fromElement)&&(A0(F)||F[Cm]))break e;if((P||S)&&(S=w.window===w?w:(S=w.ownerDocument)?S.defaultView||S.parentWindow:window,P?(F=r.relatedTarget||r.toElement,P=x,F=F?A0(F):null,F!==null&&(B=xx(F),F!==B||F.tag!==5&&F.tag!==6)&&(F=null)):(P=null,F=x),P!==F)){if(L=RU,W="onMouseLeave",V="onMouseEnter",$="mouse",(e==="pointerout"||e==="pointerover")&&(L=zU,W="onPointerLeave",V="onPointerEnter",$="pointer"),B=P==null?S:fv(P),G=F==null?S:fv(F),S=new L(W,$+"leave",P,r,w),S.target=B,S.relatedTarget=G,W=null,A0(w)===x&&(L=new L(V,$+"enter",F,r,w),L.target=G,L.relatedTarget=B,W=L),B=W,P&&F)t:{for(L=P,V=F,$=0,G=L;G;G=Vy(G))$++;for(G=0,W=V;W;W=Vy(W))G++;for(;0<$-G;)L=Vy(L),$--;for(;0<G-$;)V=Vy(V),G--;for(;$--;){if(L===V||V!==null&&L===V.alternate)break t;L=Vy(L),V=Vy(V)}L=null}else L=null;P!==null&&KU(j,S,P,L,!1),F!==null&&B!==null&&KU(j,B,F,L,!0)}}e:{if(S=x?fv(x):window,P=S.nodeName&&S.nodeName.toLowerCase(),P==="select"||P==="input"&&S.type==="file")var Z=P0e;else if(BU(S))if(MX)Z=O0e;else{Z=M0e;var se=E0e}else(P=S.nodeName)&&P.toLowerCase()==="input"&&(S.type==="checkbox"||S.type==="radio")&&(Z=I0e);if(Z&&(Z=Z(e,x))){EX(j,Z,r,w);break e}se&&se(e,S,x),e==="focusout"&&(se=S._wrapperState)&&se.controlled&&S.type==="number"&&WR(S,"number",S.value)}switch(se=x?fv(x):window,e){case"focusin":(BU(se)||se.contentEditable==="true")&&(hv=se,sD=x,kj=null);break;case"focusout":kj=sD=hv=null;break;case"mousedown":aD=!0;break;case"contextmenu":case"mouseup":case"dragend":aD=!1,HU(j,r,w);break;case"selectionchange":if(z0e)break;case"keydown":case"keyup":HU(j,r,w)}var ae;if(WL)e:{switch(e){case"compositionstart":var ce="onCompositionStart";break e;case"compositionend":ce="onCompositionEnd";break e;case"compositionupdate":ce="onCompositionUpdate";break e}ce=void 0}else dv?kX(e,r)&&(ce="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(ce="onCompositionStart");ce&&(TX&&r.locale!=="ko"&&(dv||ce!=="onCompositionStart"?ce==="onCompositionEnd"&&dv&&(ae=AX()):(yp=w,GL="value"in yp?yp.value:yp.textContent,dv=!0)),se=qT(x,ce),0<se.length&&(ce=new DU(ce,e,null,r,w),j.push({event:ce,listeners:se}),ae?ce.data=ae:(ae=PX(r),ae!==null&&(ce.data=ae)))),(ae=S0e?C0e(e,r):A0e(e,r))&&(x=qT(x,"onBeforeInput"),0<x.length&&(w=new DU("onBeforeInput","beforeinput",null,r,w),j.push({event:w,listeners:x}),w.data=ae))}VX(j,t)})}function o2(e,t,r){return{instance:e,listener:t,currentTarget:r}}function qT(e,t){for(var r=t+"Capture",i=[];e!==null;){var a=e,l=a.stateNode;a.tag===5&&l!==null&&(a=l,l=e2(e,r),l!=null&&i.unshift(o2(e,l,a)),l=e2(e,t),l!=null&&i.push(o2(e,l,a))),e=e.return}return i}function Vy(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function KU(e,t,r,i,a){for(var l=t._reactName,d=[];r!==null&&r!==i;){var s=r,p=s.alternate,x=s.stateNode;if(p!==null&&p===i)break;s.tag===5&&x!==null&&(s=x,a?(p=e2(r,l),p!=null&&d.unshift(o2(r,p,s))):a||(p=e2(r,l),p!=null&&d.push(o2(r,p,s)))),r=r.return}d.length!==0&&e.push({event:t,listeners:d})}var $0e=/\r\n?/g,V0e=/\u0000|\uFFFD/g;function ZU(e){return(typeof e=="string"?e:""+e).replace($0e,`
`).replace(V0e,"")}function jA(e,t,r){if(t=ZU(t),ZU(e)!==t&&r)throw Error(Sr(425))}function WT(){}var oD=null,lD=null;function cD(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var uD=typeof setTimeout=="function"?setTimeout:void 0,U0e=typeof clearTimeout=="function"?clearTimeout:void 0,YU=typeof Promise=="function"?Promise:void 0,G0e=typeof queueMicrotask=="function"?queueMicrotask:typeof YU<"u"?function(e){return YU.resolve(null).then(e).catch(H0e)}:uD;function H0e(e){setTimeout(function(){throw e})}function XI(e,t){var r=t,i=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(i===0){e.removeChild(a),n2(t);return}i--}else r!=="$"&&r!=="$?"&&r!=="$!"||i++;r=a}while(r);n2(t)}function Ap(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function XU(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var u_=Math.random().toString(36).slice(2),th="__reactFiber$"+u_,l2="__reactProps$"+u_,Cm="__reactContainer$"+u_,dD="__reactEvents$"+u_,q0e="__reactListeners$"+u_,W0e="__reactHandles$"+u_;function A0(e){var t=e[th];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Cm]||r[th]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=XU(e);e!==null;){if(r=e[th])return r;e=XU(e)}return t}e=r,r=e.parentNode}return null}function zN(e){return e=e[th]||e[Cm],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function fv(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Sr(33))}function lE(e){return e[l2]||null}var hD=[],pv=-1;function Qp(e){return{current:e}}function Bs(e){0>pv||(e.current=hD[pv],hD[pv]=null,pv--)}function Ts(e,t){pv++,hD[pv]=e.current,e.current=t}var $p={},Yo=Qp($p),Ql=Qp(!1),W0=$p;function nb(e,t){var r=e.type.contextTypes;if(!r)return $p;var i=e.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===t)return i.__reactInternalMemoizedMaskedChildContext;var a={},l;for(l in r)a[l]=t[l];return i&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function ec(e){return e=e.childContextTypes,e!=null}function KT(){Bs(Ql),Bs(Yo)}function JU(e,t,r){if(Yo.current!==$p)throw Error(Sr(168));Ts(Yo,t),Ts(Ql,r)}function GX(e,t,r){var i=e.stateNode;if(t=t.childContextTypes,typeof i.getChildContext!="function")return r;i=i.getChildContext();for(var a in i)if(!(a in t))throw Error(Sr(108,Ege(e)||"Unknown",a));return sa({},r,i)}function ZT(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||$p,W0=Yo.current,Ts(Yo,e),Ts(Ql,Ql.current),!0}function QU(e,t,r){var i=e.stateNode;if(!i)throw Error(Sr(169));r?(e=GX(e,t,W0),i.__reactInternalMemoizedMergedChildContext=e,Bs(Ql),Bs(Yo),Ts(Yo,e)):Bs(Ql),Ts(Ql,r)}var um=null,cE=!1,JI=!1;function HX(e){um===null?um=[e]:um.push(e)}function K0e(e){cE=!0,HX(e)}function eg(){if(!JI&&um!==null){JI=!0;var e=0,t=ls;try{var r=um;for(ls=1;e<r.length;e++){var i=r[e];do i=i(!0);while(i!==null)}um=null,cE=!1}catch(a){throw um!==null&&(um=um.slice(e+1)),gX(BL,eg),a}finally{ls=t,JI=!1}}return null}var gv=[],xv=0,YT=null,XT=0,hu=[],mu=0,K0=null,hm=1,mm="";function x0(e,t){gv[xv++]=XT,gv[xv++]=YT,YT=e,XT=t}function qX(e,t,r){hu[mu++]=hm,hu[mu++]=mm,hu[mu++]=K0,K0=e;var i=hm;e=mm;var a=32-pd(i)-1;i&=~(1<<a),r+=1;var l=32-pd(t)+a;if(30<l){var d=a-a%5;l=(i&(1<<d)-1).toString(32),i>>=d,a-=d,hm=1<<32-pd(t)+a|r<<a|i,mm=l+e}else hm=1<<l|r<<a|i,mm=e}function ZL(e){e.return!==null&&(x0(e,1),qX(e,1,0))}function YL(e){for(;e===YT;)YT=gv[--xv],gv[xv]=null,XT=gv[--xv],gv[xv]=null;for(;e===K0;)K0=hu[--mu],hu[mu]=null,mm=hu[--mu],hu[mu]=null,hm=hu[--mu],hu[mu]=null}var Tc=null,Ac=null,qs=!1,cd=null;function WX(e,t){var r=pu(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function e9(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Tc=e,Ac=Ap(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Tc=e,Ac=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=K0!==null?{id:hm,overflow:mm}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=pu(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Tc=e,Ac=null,!0):!1;default:return!1}}function mD(e){return(e.mode&1)!==0&&(e.flags&128)===0}function fD(e){if(qs){var t=Ac;if(t){var r=t;if(!e9(e,t)){if(mD(e))throw Error(Sr(418));t=Ap(r.nextSibling);var i=Tc;t&&e9(e,t)?WX(i,r):(e.flags=e.flags&-4097|2,qs=!1,Tc=e)}}else{if(mD(e))throw Error(Sr(418));e.flags=e.flags&-4097|2,qs=!1,Tc=e}}}function t9(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Tc=e}function NA(e){if(e!==Tc)return!1;if(!qs)return t9(e),qs=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!cD(e.type,e.memoizedProps)),t&&(t=Ac)){if(mD(e))throw KX(),Error(Sr(418));for(;t;)WX(e,t),t=Ap(t.nextSibling)}if(t9(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Sr(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){Ac=Ap(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}Ac=null}}else Ac=Tc?Ap(e.stateNode.nextSibling):null;return!0}function KX(){for(var e=Ac;e;)e=Ap(e.nextSibling)}function ib(){Ac=Tc=null,qs=!1}function XL(e){cd===null?cd=[e]:cd.push(e)}var Z0e=Lm.ReactCurrentBatchConfig;function Gw(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Sr(309));var i=r.stateNode}if(!i)throw Error(Sr(147,e));var a=i,l=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===l?t.ref:(t=function(d){var s=a.refs;d===null?delete s[l]:s[l]=d},t._stringRef=l,t)}if(typeof e!="string")throw Error(Sr(284));if(!r._owner)throw Error(Sr(290,e))}return e}function SA(e,t){throw e=Object.prototype.toString.call(t),Error(Sr(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function r9(e){var t=e._init;return t(e._payload)}function ZX(e){function t(V,$){if(e){var G=V.deletions;G===null?(V.deletions=[$],V.flags|=16):G.push($)}}function r(V,$){if(!e)return null;for(;$!==null;)t(V,$),$=$.sibling;return null}function i(V,$){for(V=new Map;$!==null;)$.key!==null?V.set($.key,$):V.set($.index,$),$=$.sibling;return V}function a(V,$){return V=Ep(V,$),V.index=0,V.sibling=null,V}function l(V,$,G){return V.index=G,e?(G=V.alternate,G!==null?(G=G.index,G<$?(V.flags|=2,$):G):(V.flags|=2,$)):(V.flags|=1048576,$)}function d(V){return e&&V.alternate===null&&(V.flags|=2),V}function s(V,$,G,W){return $===null||$.tag!==6?($=sO(G,V.mode,W),$.return=V,$):($=a($,G),$.return=V,$)}function p(V,$,G,W){var Z=G.type;return Z===uv?w(V,$,G.props.children,W,G.key):$!==null&&($.elementType===Z||typeof Z=="object"&&Z!==null&&Z.$$typeof===tp&&r9(Z)===$.type)?(W=a($,G.props),W.ref=Gw(V,$,G),W.return=V,W):(W=ST(G.type,G.key,G.props,null,V.mode,W),W.ref=Gw(V,$,G),W.return=V,W)}function x(V,$,G,W){return $===null||$.tag!==4||$.stateNode.containerInfo!==G.containerInfo||$.stateNode.implementation!==G.implementation?($=aO(G,V.mode,W),$.return=V,$):($=a($,G.children||[]),$.return=V,$)}function w(V,$,G,W,Z){return $===null||$.tag!==7?($=$0(G,V.mode,W,Z),$.return=V,$):($=a($,G),$.return=V,$)}function j(V,$,G){if(typeof $=="string"&&$!==""||typeof $=="number")return $=sO(""+$,V.mode,G),$.return=V,$;if(typeof $=="object"&&$!==null){switch($.$$typeof){case fA:return G=ST($.type,$.key,$.props,null,V.mode,G),G.ref=Gw(V,null,$),G.return=V,G;case cv:return $=aO($,V.mode,G),$.return=V,$;case tp:var W=$._init;return j(V,W($._payload),G)}if(fj($)||Fw($))return $=$0($,V.mode,G,null),$.return=V,$;SA(V,$)}return null}function S(V,$,G,W){var Z=$!==null?$.key:null;if(typeof G=="string"&&G!==""||typeof G=="number")return Z!==null?null:s(V,$,""+G,W);if(typeof G=="object"&&G!==null){switch(G.$$typeof){case fA:return G.key===Z?p(V,$,G,W):null;case cv:return G.key===Z?x(V,$,G,W):null;case tp:return Z=G._init,S(V,$,Z(G._payload),W)}if(fj(G)||Fw(G))return Z!==null?null:w(V,$,G,W,null);SA(V,G)}return null}function P(V,$,G,W,Z){if(typeof W=="string"&&W!==""||typeof W=="number")return V=V.get(G)||null,s($,V,""+W,Z);if(typeof W=="object"&&W!==null){switch(W.$$typeof){case fA:return V=V.get(W.key===null?G:W.key)||null,p($,V,W,Z);case cv:return V=V.get(W.key===null?G:W.key)||null,x($,V,W,Z);case tp:var se=W._init;return P(V,$,G,se(W._payload),Z)}if(fj(W)||Fw(W))return V=V.get(G)||null,w($,V,W,Z,null);SA($,W)}return null}function F(V,$,G,W){for(var Z=null,se=null,ae=$,ce=$=0,Pe=null;ae!==null&&ce<G.length;ce++){ae.index>ce?(Pe=ae,ae=null):Pe=ae.sibling;var we=S(V,ae,G[ce],W);if(we===null){ae===null&&(ae=Pe);break}e&&ae&&we.alternate===null&&t(V,ae),$=l(we,$,ce),se===null?Z=we:se.sibling=we,se=we,ae=Pe}if(ce===G.length)return r(V,ae),qs&&x0(V,ce),Z;if(ae===null){for(;ce<G.length;ce++)ae=j(V,G[ce],W),ae!==null&&($=l(ae,$,ce),se===null?Z=ae:se.sibling=ae,se=ae);return qs&&x0(V,ce),Z}for(ae=i(V,ae);ce<G.length;ce++)Pe=P(ae,V,ce,G[ce],W),Pe!==null&&(e&&Pe.alternate!==null&&ae.delete(Pe.key===null?ce:Pe.key),$=l(Pe,$,ce),se===null?Z=Pe:se.sibling=Pe,se=Pe);return e&&ae.forEach(function(xe){return t(V,xe)}),qs&&x0(V,ce),Z}function L(V,$,G,W){var Z=Fw(G);if(typeof Z!="function")throw Error(Sr(150));if(G=Z.call(G),G==null)throw Error(Sr(151));for(var se=Z=null,ae=$,ce=$=0,Pe=null,we=G.next();ae!==null&&!we.done;ce++,we=G.next()){ae.index>ce?(Pe=ae,ae=null):Pe=ae.sibling;var xe=S(V,ae,we.value,W);if(xe===null){ae===null&&(ae=Pe);break}e&&ae&&xe.alternate===null&&t(V,ae),$=l(xe,$,ce),se===null?Z=xe:se.sibling=xe,se=xe,ae=Pe}if(we.done)return r(V,ae),qs&&x0(V,ce),Z;if(ae===null){for(;!we.done;ce++,we=G.next())we=j(V,we.value,W),we!==null&&($=l(we,$,ce),se===null?Z=we:se.sibling=we,se=we);return qs&&x0(V,ce),Z}for(ae=i(V,ae);!we.done;ce++,we=G.next())we=P(ae,V,ce,we.value,W),we!==null&&(e&&we.alternate!==null&&ae.delete(we.key===null?ce:we.key),$=l(we,$,ce),se===null?Z=we:se.sibling=we,se=we);return e&&ae.forEach(function(Ne){return t(V,Ne)}),qs&&x0(V,ce),Z}function B(V,$,G,W){if(typeof G=="object"&&G!==null&&G.type===uv&&G.key===null&&(G=G.props.children),typeof G=="object"&&G!==null){switch(G.$$typeof){case fA:e:{for(var Z=G.key,se=$;se!==null;){if(se.key===Z){if(Z=G.type,Z===uv){if(se.tag===7){r(V,se.sibling),$=a(se,G.props.children),$.return=V,V=$;break e}}else if(se.elementType===Z||typeof Z=="object"&&Z!==null&&Z.$$typeof===tp&&r9(Z)===se.type){r(V,se.sibling),$=a(se,G.props),$.ref=Gw(V,se,G),$.return=V,V=$;break e}r(V,se);break}else t(V,se);se=se.sibling}G.type===uv?($=$0(G.props.children,V.mode,W,G.key),$.return=V,V=$):(W=ST(G.type,G.key,G.props,null,V.mode,W),W.ref=Gw(V,$,G),W.return=V,V=W)}return d(V);case cv:e:{for(se=G.key;$!==null;){if($.key===se)if($.tag===4&&$.stateNode.containerInfo===G.containerInfo&&$.stateNode.implementation===G.implementation){r(V,$.sibling),$=a($,G.children||[]),$.return=V,V=$;break e}else{r(V,$);break}else t(V,$);$=$.sibling}$=aO(G,V.mode,W),$.return=V,V=$}return d(V);case tp:return se=G._init,B(V,$,se(G._payload),W)}if(fj(G))return F(V,$,G,W);if(Fw(G))return L(V,$,G,W);SA(V,G)}return typeof G=="string"&&G!==""||typeof G=="number"?(G=""+G,$!==null&&$.tag===6?(r(V,$.sibling),$=a($,G),$.return=V,V=$):(r(V,$),$=sO(G,V.mode,W),$.return=V,V=$),d(V)):r(V,$)}return B}var sb=ZX(!0),YX=ZX(!1),JT=Qp(null),QT=null,yv=null,JL=null;function QL(){JL=yv=QT=null}function eF(e){var t=JT.current;Bs(JT),e._currentValue=t}function pD(e,t,r){for(;e!==null;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,i!==null&&(i.childLanes|=t)):i!==null&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===r)break;e=e.return}}function Mv(e,t){QT=e,JL=yv=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Yl=!0),e.firstContext=null)}function wu(e){var t=e._currentValue;if(JL!==e)if(e={context:e,memoizedValue:t,next:null},yv===null){if(QT===null)throw Error(Sr(308));yv=e,QT.dependencies={lanes:0,firstContext:e}}else yv=yv.next=e;return t}var T0=null;function tF(e){T0===null?T0=[e]:T0.push(e)}function XX(e,t,r,i){var a=t.interleaved;return a===null?(r.next=r,tF(t)):(r.next=a.next,a.next=r),t.interleaved=r,Am(e,i)}function Am(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var rp=!1;function rF(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function JX(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function bm(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Tp(e,t,r){var i=e.updateQueue;if(i===null)return null;if(i=i.shared,Bi&2){var a=i.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),i.pending=t,Am(e,r)}return a=i.interleaved,a===null?(t.next=t,tF(i)):(t.next=a.next,a.next=t),i.interleaved=t,Am(e,r)}function vT(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var i=t.lanes;i&=e.pendingLanes,r|=i,t.lanes=r,$L(e,r)}}function n9(e,t){var r=e.updateQueue,i=e.alternate;if(i!==null&&(i=i.updateQueue,r===i)){var a=null,l=null;if(r=r.firstBaseUpdate,r!==null){do{var d={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};l===null?a=l=d:l=l.next=d,r=r.next}while(r!==null);l===null?a=l=t:l=l.next=t}else a=l=t;r={baseState:i.baseState,firstBaseUpdate:a,lastBaseUpdate:l,shared:i.shared,effects:i.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function ek(e,t,r,i){var a=e.updateQueue;rp=!1;var l=a.firstBaseUpdate,d=a.lastBaseUpdate,s=a.shared.pending;if(s!==null){a.shared.pending=null;var p=s,x=p.next;p.next=null,d===null?l=x:d.next=x,d=p;var w=e.alternate;w!==null&&(w=w.updateQueue,s=w.lastBaseUpdate,s!==d&&(s===null?w.firstBaseUpdate=x:s.next=x,w.lastBaseUpdate=p))}if(l!==null){var j=a.baseState;d=0,w=x=p=null,s=l;do{var S=s.lane,P=s.eventTime;if((i&S)===S){w!==null&&(w=w.next={eventTime:P,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var F=e,L=s;switch(S=t,P=r,L.tag){case 1:if(F=L.payload,typeof F=="function"){j=F.call(P,j,S);break e}j=F;break e;case 3:F.flags=F.flags&-65537|128;case 0:if(F=L.payload,S=typeof F=="function"?F.call(P,j,S):F,S==null)break e;j=sa({},j,S);break e;case 2:rp=!0}}s.callback!==null&&s.lane!==0&&(e.flags|=64,S=a.effects,S===null?a.effects=[s]:S.push(s))}else P={eventTime:P,lane:S,tag:s.tag,payload:s.payload,callback:s.callback,next:null},w===null?(x=w=P,p=j):w=w.next=P,d|=S;if(s=s.next,s===null){if(s=a.shared.pending,s===null)break;S=s,s=S.next,S.next=null,a.lastBaseUpdate=S,a.shared.pending=null}}while(!0);if(w===null&&(p=j),a.baseState=p,a.firstBaseUpdate=x,a.lastBaseUpdate=w,t=a.shared.interleaved,t!==null){a=t;do d|=a.lane,a=a.next;while(a!==t)}else l===null&&(a.shared.lanes=0);Y0|=d,e.lanes=d,e.memoizedState=j}}function i9(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var i=e[t],a=i.callback;if(a!==null){if(i.callback=null,i=r,typeof a!="function")throw Error(Sr(191,a));a.call(i)}}}var LN={},dh=Qp(LN),c2=Qp(LN),u2=Qp(LN);function k0(e){if(e===LN)throw Error(Sr(174));return e}function nF(e,t){switch(Ts(u2,t),Ts(c2,e),Ts(dh,LN),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:ZR(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=ZR(t,e)}Bs(dh),Ts(dh,t)}function ab(){Bs(dh),Bs(c2),Bs(u2)}function QX(e){k0(u2.current);var t=k0(dh.current),r=ZR(t,e.type);t!==r&&(Ts(c2,e),Ts(dh,r))}function iF(e){c2.current===e&&(Bs(dh),Bs(c2))}var na=Qp(0);function tk(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var QI=[];function sF(){for(var e=0;e<QI.length;e++)QI[e]._workInProgressVersionPrimary=null;QI.length=0}var bT=Lm.ReactCurrentDispatcher,eO=Lm.ReactCurrentBatchConfig,Z0=0,ia=null,Xa=null,uo=null,rk=!1,Pj=!1,d2=0,Y0e=0;function Vo(){throw Error(Sr(321))}function aF(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!vd(e[r],t[r]))return!1;return!0}function oF(e,t,r,i,a,l){if(Z0=l,ia=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,bT.current=e===null||e.memoizedState===null?exe:txe,e=r(i,a),Pj){l=0;do{if(Pj=!1,d2=0,25<=l)throw Error(Sr(301));l+=1,uo=Xa=null,t.updateQueue=null,bT.current=rxe,e=r(i,a)}while(Pj)}if(bT.current=nk,t=Xa!==null&&Xa.next!==null,Z0=0,uo=Xa=ia=null,rk=!1,t)throw Error(Sr(300));return e}function lF(){var e=d2!==0;return d2=0,e}function Xd(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return uo===null?ia.memoizedState=uo=e:uo=uo.next=e,uo}function ju(){if(Xa===null){var e=ia.alternate;e=e!==null?e.memoizedState:null}else e=Xa.next;var t=uo===null?ia.memoizedState:uo.next;if(t!==null)uo=t,Xa=e;else{if(e===null)throw Error(Sr(310));Xa=e,e={memoizedState:Xa.memoizedState,baseState:Xa.baseState,baseQueue:Xa.baseQueue,queue:Xa.queue,next:null},uo===null?ia.memoizedState=uo=e:uo=uo.next=e}return uo}function h2(e,t){return typeof t=="function"?t(e):t}function tO(e){var t=ju(),r=t.queue;if(r===null)throw Error(Sr(311));r.lastRenderedReducer=e;var i=Xa,a=i.baseQueue,l=r.pending;if(l!==null){if(a!==null){var d=a.next;a.next=l.next,l.next=d}i.baseQueue=a=l,r.pending=null}if(a!==null){l=a.next,i=i.baseState;var s=d=null,p=null,x=l;do{var w=x.lane;if((Z0&w)===w)p!==null&&(p=p.next={lane:0,action:x.action,hasEagerState:x.hasEagerState,eagerState:x.eagerState,next:null}),i=x.hasEagerState?x.eagerState:e(i,x.action);else{var j={lane:w,action:x.action,hasEagerState:x.hasEagerState,eagerState:x.eagerState,next:null};p===null?(s=p=j,d=i):p=p.next=j,ia.lanes|=w,Y0|=w}x=x.next}while(x!==null&&x!==l);p===null?d=i:p.next=s,vd(i,t.memoizedState)||(Yl=!0),t.memoizedState=i,t.baseState=d,t.baseQueue=p,r.lastRenderedState=i}if(e=r.interleaved,e!==null){a=e;do l=a.lane,ia.lanes|=l,Y0|=l,a=a.next;while(a!==e)}else a===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function rO(e){var t=ju(),r=t.queue;if(r===null)throw Error(Sr(311));r.lastRenderedReducer=e;var i=r.dispatch,a=r.pending,l=t.memoizedState;if(a!==null){r.pending=null;var d=a=a.next;do l=e(l,d.action),d=d.next;while(d!==a);vd(l,t.memoizedState)||(Yl=!0),t.memoizedState=l,t.baseQueue===null&&(t.baseState=l),r.lastRenderedState=l}return[l,i]}function eJ(){}function tJ(e,t){var r=ia,i=ju(),a=t(),l=!vd(i.memoizedState,a);if(l&&(i.memoizedState=a,Yl=!0),i=i.queue,cF(iJ.bind(null,r,i,e),[e]),i.getSnapshot!==t||l||uo!==null&&uo.memoizedState.tag&1){if(r.flags|=2048,m2(9,nJ.bind(null,r,i,a,t),void 0,null),mo===null)throw Error(Sr(349));Z0&30||rJ(r,t,a)}return a}function rJ(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=ia.updateQueue,t===null?(t={lastEffect:null,stores:null},ia.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function nJ(e,t,r,i){t.value=r,t.getSnapshot=i,sJ(t)&&aJ(e)}function iJ(e,t,r){return r(function(){sJ(t)&&aJ(e)})}function sJ(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!vd(e,r)}catch{return!0}}function aJ(e){var t=Am(e,1);t!==null&&gd(t,e,1,-1)}function s9(e){var t=Xd();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:h2,lastRenderedState:e},t.queue=e,e=e.dispatch=Q0e.bind(null,ia,e),[t.memoizedState,e]}function m2(e,t,r,i){return e={tag:e,create:t,destroy:r,deps:i,next:null},t=ia.updateQueue,t===null?(t={lastEffect:null,stores:null},ia.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(i=r.next,r.next=e,e.next=i,t.lastEffect=e)),e}function oJ(){return ju().memoizedState}function _T(e,t,r,i){var a=Xd();ia.flags|=e,a.memoizedState=m2(1|t,r,void 0,i===void 0?null:i)}function uE(e,t,r,i){var a=ju();i=i===void 0?null:i;var l=void 0;if(Xa!==null){var d=Xa.memoizedState;if(l=d.destroy,i!==null&&aF(i,d.deps)){a.memoizedState=m2(t,r,l,i);return}}ia.flags|=e,a.memoizedState=m2(1|t,r,l,i)}function a9(e,t){return _T(8390656,8,e,t)}function cF(e,t){return uE(2048,8,e,t)}function lJ(e,t){return uE(4,2,e,t)}function cJ(e,t){return uE(4,4,e,t)}function uJ(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function dJ(e,t,r){return r=r!=null?r.concat([e]):null,uE(4,4,uJ.bind(null,t,e),r)}function uF(){}function hJ(e,t){var r=ju();t=t===void 0?null:t;var i=r.memoizedState;return i!==null&&t!==null&&aF(t,i[1])?i[0]:(r.memoizedState=[e,t],e)}function mJ(e,t){var r=ju();t=t===void 0?null:t;var i=r.memoizedState;return i!==null&&t!==null&&aF(t,i[1])?i[0]:(e=e(),r.memoizedState=[e,t],e)}function fJ(e,t,r){return Z0&21?(vd(r,t)||(r=vX(),ia.lanes|=r,Y0|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Yl=!0),e.memoizedState=r)}function X0e(e,t){var r=ls;ls=r!==0&&4>r?r:4,e(!0);var i=eO.transition;eO.transition={};try{e(!1),t()}finally{ls=r,eO.transition=i}}function pJ(){return ju().memoizedState}function J0e(e,t,r){var i=Pp(e);if(r={lane:i,action:r,hasEagerState:!1,eagerState:null,next:null},gJ(e))xJ(t,r);else if(r=XX(e,t,r,i),r!==null){var a=Nl();gd(r,e,i,a),yJ(r,t,i)}}function Q0e(e,t,r){var i=Pp(e),a={lane:i,action:r,hasEagerState:!1,eagerState:null,next:null};if(gJ(e))xJ(t,a);else{var l=e.alternate;if(e.lanes===0&&(l===null||l.lanes===0)&&(l=t.lastRenderedReducer,l!==null))try{var d=t.lastRenderedState,s=l(d,r);if(a.hasEagerState=!0,a.eagerState=s,vd(s,d)){var p=t.interleaved;p===null?(a.next=a,tF(t)):(a.next=p.next,p.next=a),t.interleaved=a;return}}catch{}finally{}r=XX(e,t,a,i),r!==null&&(a=Nl(),gd(r,e,i,a),yJ(r,t,i))}}function gJ(e){var t=e.alternate;return e===ia||t!==null&&t===ia}function xJ(e,t){Pj=rk=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function yJ(e,t,r){if(r&4194240){var i=t.lanes;i&=e.pendingLanes,r|=i,t.lanes=r,$L(e,r)}}var nk={readContext:wu,useCallback:Vo,useContext:Vo,useEffect:Vo,useImperativeHandle:Vo,useInsertionEffect:Vo,useLayoutEffect:Vo,useMemo:Vo,useReducer:Vo,useRef:Vo,useState:Vo,useDebugValue:Vo,useDeferredValue:Vo,useTransition:Vo,useMutableSource:Vo,useSyncExternalStore:Vo,useId:Vo,unstable_isNewReconciler:!1},exe={readContext:wu,useCallback:function(e,t){return Xd().memoizedState=[e,t===void 0?null:t],e},useContext:wu,useEffect:a9,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,_T(4194308,4,uJ.bind(null,t,e),r)},useLayoutEffect:function(e,t){return _T(4194308,4,e,t)},useInsertionEffect:function(e,t){return _T(4,2,e,t)},useMemo:function(e,t){var r=Xd();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var i=Xd();return t=r!==void 0?r(t):t,i.memoizedState=i.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},i.queue=e,e=e.dispatch=J0e.bind(null,ia,e),[i.memoizedState,e]},useRef:function(e){var t=Xd();return e={current:e},t.memoizedState=e},useState:s9,useDebugValue:uF,useDeferredValue:function(e){return Xd().memoizedState=e},useTransition:function(){var e=s9(!1),t=e[0];return e=X0e.bind(null,e[1]),Xd().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var i=ia,a=Xd();if(qs){if(r===void 0)throw Error(Sr(407));r=r()}else{if(r=t(),mo===null)throw Error(Sr(349));Z0&30||rJ(i,t,r)}a.memoizedState=r;var l={value:r,getSnapshot:t};return a.queue=l,a9(iJ.bind(null,i,l,e),[e]),i.flags|=2048,m2(9,nJ.bind(null,i,l,r,t),void 0,null),r},useId:function(){var e=Xd(),t=mo.identifierPrefix;if(qs){var r=mm,i=hm;r=(i&~(1<<32-pd(i)-1)).toString(32)+r,t=":"+t+"R"+r,r=d2++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=Y0e++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},txe={readContext:wu,useCallback:hJ,useContext:wu,useEffect:cF,useImperativeHandle:dJ,useInsertionEffect:lJ,useLayoutEffect:cJ,useMemo:mJ,useReducer:tO,useRef:oJ,useState:function(){return tO(h2)},useDebugValue:uF,useDeferredValue:function(e){var t=ju();return fJ(t,Xa.memoizedState,e)},useTransition:function(){var e=tO(h2)[0],t=ju().memoizedState;return[e,t]},useMutableSource:eJ,useSyncExternalStore:tJ,useId:pJ,unstable_isNewReconciler:!1},rxe={readContext:wu,useCallback:hJ,useContext:wu,useEffect:cF,useImperativeHandle:dJ,useInsertionEffect:lJ,useLayoutEffect:cJ,useMemo:mJ,useReducer:rO,useRef:oJ,useState:function(){return rO(h2)},useDebugValue:uF,useDeferredValue:function(e){var t=ju();return Xa===null?t.memoizedState=e:fJ(t,Xa.memoizedState,e)},useTransition:function(){var e=rO(h2)[0],t=ju().memoizedState;return[e,t]},useMutableSource:eJ,useSyncExternalStore:tJ,useId:pJ,unstable_isNewReconciler:!1};function td(e,t){if(e&&e.defaultProps){t=sa({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function gD(e,t,r,i){t=e.memoizedState,r=r(i,t),r=r==null?t:sa({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var dE={isMounted:function(e){return(e=e._reactInternals)?xx(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var i=Nl(),a=Pp(e),l=bm(i,a);l.payload=t,r!=null&&(l.callback=r),t=Tp(e,l,a),t!==null&&(gd(t,e,a,i),vT(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var i=Nl(),a=Pp(e),l=bm(i,a);l.tag=1,l.payload=t,r!=null&&(l.callback=r),t=Tp(e,l,a),t!==null&&(gd(t,e,a,i),vT(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Nl(),i=Pp(e),a=bm(r,i);a.tag=2,t!=null&&(a.callback=t),t=Tp(e,a,i),t!==null&&(gd(t,e,i,r),vT(t,e,i))}};function o9(e,t,r,i,a,l,d){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(i,l,d):t.prototype&&t.prototype.isPureReactComponent?!s2(r,i)||!s2(a,l):!0}function vJ(e,t,r){var i=!1,a=$p,l=t.contextType;return typeof l=="object"&&l!==null?l=wu(l):(a=ec(t)?W0:Yo.current,i=t.contextTypes,l=(i=i!=null)?nb(e,a):$p),t=new t(r,l),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=dE,e.stateNode=t,t._reactInternals=e,i&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=l),t}function l9(e,t,r,i){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,i),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,i),t.state!==e&&dE.enqueueReplaceState(t,t.state,null)}function xD(e,t,r,i){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs={},rF(e);var l=t.contextType;typeof l=="object"&&l!==null?a.context=wu(l):(l=ec(t)?W0:Yo.current,a.context=nb(e,l)),a.state=e.memoizedState,l=t.getDerivedStateFromProps,typeof l=="function"&&(gD(e,t,l,r),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&dE.enqueueReplaceState(a,a.state,null),ek(e,r,a,i),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function ob(e,t){try{var r="",i=t;do r+=Pge(i),i=i.return;while(i);var a=r}catch(l){a=`
Error generating stack: `+l.message+`
`+l.stack}return{value:e,source:t,stack:a,digest:null}}function nO(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function yD(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var nxe=typeof WeakMap=="function"?WeakMap:Map;function bJ(e,t,r){r=bm(-1,r),r.tag=3,r.payload={element:null};var i=t.value;return r.callback=function(){sk||(sk=!0,TD=i),yD(e,t)},r}function _J(e,t,r){r=bm(-1,r),r.tag=3;var i=e.type.getDerivedStateFromError;if(typeof i=="function"){var a=t.value;r.payload=function(){return i(a)},r.callback=function(){yD(e,t)}}var l=e.stateNode;return l!==null&&typeof l.componentDidCatch=="function"&&(r.callback=function(){yD(e,t),typeof i!="function"&&(kp===null?kp=new Set([this]):kp.add(this));var d=t.stack;this.componentDidCatch(t.value,{componentStack:d!==null?d:""})}),r}function c9(e,t,r){var i=e.pingCache;if(i===null){i=e.pingCache=new nxe;var a=new Set;i.set(t,a)}else a=i.get(t),a===void 0&&(a=new Set,i.set(t,a));a.has(r)||(a.add(r),e=xxe.bind(null,e,t,r),t.then(e,e))}function u9(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function d9(e,t,r,i,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=bm(-1,1),t.tag=2,Tp(r,t,1))),r.lanes|=1),e)}var ixe=Lm.ReactCurrentOwner,Yl=!1;function xl(e,t,r,i){t.child=e===null?YX(t,null,r,i):sb(t,e.child,r,i)}function h9(e,t,r,i,a){r=r.render;var l=t.ref;return Mv(t,a),i=oF(e,t,r,i,l,a),r=lF(),e!==null&&!Yl?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Tm(e,t,a)):(qs&&r&&ZL(t),t.flags|=1,xl(e,t,i,a),t.child)}function m9(e,t,r,i,a){if(e===null){var l=r.type;return typeof l=="function"&&!yF(l)&&l.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=l,wJ(e,t,l,i,a)):(e=ST(r.type,null,i,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(l=e.child,!(e.lanes&a)){var d=l.memoizedProps;if(r=r.compare,r=r!==null?r:s2,r(d,i)&&e.ref===t.ref)return Tm(e,t,a)}return t.flags|=1,e=Ep(l,i),e.ref=t.ref,e.return=t,t.child=e}function wJ(e,t,r,i,a){if(e!==null){var l=e.memoizedProps;if(s2(l,i)&&e.ref===t.ref)if(Yl=!1,t.pendingProps=i=l,(e.lanes&a)!==0)e.flags&131072&&(Yl=!0);else return t.lanes=e.lanes,Tm(e,t,a)}return vD(e,t,r,i,a)}function jJ(e,t,r){var i=t.pendingProps,a=i.children,l=e!==null?e.memoizedState:null;if(i.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ts(bv,wc),wc|=r;else{if(!(r&1073741824))return e=l!==null?l.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ts(bv,wc),wc|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=l!==null?l.baseLanes:r,Ts(bv,wc),wc|=i}else l!==null?(i=l.baseLanes|r,t.memoizedState=null):i=r,Ts(bv,wc),wc|=i;return xl(e,t,a,r),t.child}function NJ(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function vD(e,t,r,i,a){var l=ec(r)?W0:Yo.current;return l=nb(t,l),Mv(t,a),r=oF(e,t,r,i,l,a),i=lF(),e!==null&&!Yl?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Tm(e,t,a)):(qs&&i&&ZL(t),t.flags|=1,xl(e,t,r,a),t.child)}function f9(e,t,r,i,a){if(ec(r)){var l=!0;ZT(t)}else l=!1;if(Mv(t,a),t.stateNode===null)wT(e,t),vJ(t,r,i),xD(t,r,i,a),i=!0;else if(e===null){var d=t.stateNode,s=t.memoizedProps;d.props=s;var p=d.context,x=r.contextType;typeof x=="object"&&x!==null?x=wu(x):(x=ec(r)?W0:Yo.current,x=nb(t,x));var w=r.getDerivedStateFromProps,j=typeof w=="function"||typeof d.getSnapshotBeforeUpdate=="function";j||typeof d.UNSAFE_componentWillReceiveProps!="function"&&typeof d.componentWillReceiveProps!="function"||(s!==i||p!==x)&&l9(t,d,i,x),rp=!1;var S=t.memoizedState;d.state=S,ek(t,i,d,a),p=t.memoizedState,s!==i||S!==p||Ql.current||rp?(typeof w=="function"&&(gD(t,r,w,i),p=t.memoizedState),(s=rp||o9(t,r,s,i,S,p,x))?(j||typeof d.UNSAFE_componentWillMount!="function"&&typeof d.componentWillMount!="function"||(typeof d.componentWillMount=="function"&&d.componentWillMount(),typeof d.UNSAFE_componentWillMount=="function"&&d.UNSAFE_componentWillMount()),typeof d.componentDidMount=="function"&&(t.flags|=4194308)):(typeof d.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=p),d.props=i,d.state=p,d.context=x,i=s):(typeof d.componentDidMount=="function"&&(t.flags|=4194308),i=!1)}else{d=t.stateNode,JX(e,t),s=t.memoizedProps,x=t.type===t.elementType?s:td(t.type,s),d.props=x,j=t.pendingProps,S=d.context,p=r.contextType,typeof p=="object"&&p!==null?p=wu(p):(p=ec(r)?W0:Yo.current,p=nb(t,p));var P=r.getDerivedStateFromProps;(w=typeof P=="function"||typeof d.getSnapshotBeforeUpdate=="function")||typeof d.UNSAFE_componentWillReceiveProps!="function"&&typeof d.componentWillReceiveProps!="function"||(s!==j||S!==p)&&l9(t,d,i,p),rp=!1,S=t.memoizedState,d.state=S,ek(t,i,d,a);var F=t.memoizedState;s!==j||S!==F||Ql.current||rp?(typeof P=="function"&&(gD(t,r,P,i),F=t.memoizedState),(x=rp||o9(t,r,x,i,S,F,p)||!1)?(w||typeof d.UNSAFE_componentWillUpdate!="function"&&typeof d.componentWillUpdate!="function"||(typeof d.componentWillUpdate=="function"&&d.componentWillUpdate(i,F,p),typeof d.UNSAFE_componentWillUpdate=="function"&&d.UNSAFE_componentWillUpdate(i,F,p)),typeof d.componentDidUpdate=="function"&&(t.flags|=4),typeof d.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof d.componentDidUpdate!="function"||s===e.memoizedProps&&S===e.memoizedState||(t.flags|=4),typeof d.getSnapshotBeforeUpdate!="function"||s===e.memoizedProps&&S===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=F),d.props=i,d.state=F,d.context=p,i=x):(typeof d.componentDidUpdate!="function"||s===e.memoizedProps&&S===e.memoizedState||(t.flags|=4),typeof d.getSnapshotBeforeUpdate!="function"||s===e.memoizedProps&&S===e.memoizedState||(t.flags|=1024),i=!1)}return bD(e,t,r,i,l,a)}function bD(e,t,r,i,a,l){NJ(e,t);var d=(t.flags&128)!==0;if(!i&&!d)return a&&QU(t,r,!1),Tm(e,t,l);i=t.stateNode,ixe.current=t;var s=d&&typeof r.getDerivedStateFromError!="function"?null:i.render();return t.flags|=1,e!==null&&d?(t.child=sb(t,e.child,null,l),t.child=sb(t,null,s,l)):xl(e,t,s,l),t.memoizedState=i.state,a&&QU(t,r,!0),t.child}function SJ(e){var t=e.stateNode;t.pendingContext?JU(e,t.pendingContext,t.pendingContext!==t.context):t.context&&JU(e,t.context,!1),nF(e,t.containerInfo)}function p9(e,t,r,i,a){return ib(),XL(a),t.flags|=256,xl(e,t,r,i),t.child}var _D={dehydrated:null,treeContext:null,retryLane:0};function wD(e){return{baseLanes:e,cachePool:null,transitions:null}}function CJ(e,t,r){var i=t.pendingProps,a=na.current,l=!1,d=(t.flags&128)!==0,s;if((s=d)||(s=e!==null&&e.memoizedState===null?!1:(a&2)!==0),s?(l=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),Ts(na,a&1),e===null)return fD(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(d=i.children,e=i.fallback,l?(i=t.mode,l=t.child,d={mode:"hidden",children:d},!(i&1)&&l!==null?(l.childLanes=0,l.pendingProps=d):l=fE(d,i,0,null),e=$0(e,i,r,null),l.return=t,e.return=t,l.sibling=e,t.child=l,t.child.memoizedState=wD(r),t.memoizedState=_D,e):dF(t,d));if(a=e.memoizedState,a!==null&&(s=a.dehydrated,s!==null))return sxe(e,t,d,i,s,a,r);if(l){l=i.fallback,d=t.mode,a=e.child,s=a.sibling;var p={mode:"hidden",children:i.children};return!(d&1)&&t.child!==a?(i=t.child,i.childLanes=0,i.pendingProps=p,t.deletions=null):(i=Ep(a,p),i.subtreeFlags=a.subtreeFlags&14680064),s!==null?l=Ep(s,l):(l=$0(l,d,r,null),l.flags|=2),l.return=t,i.return=t,i.sibling=l,t.child=i,i=l,l=t.child,d=e.child.memoizedState,d=d===null?wD(r):{baseLanes:d.baseLanes|r,cachePool:null,transitions:d.transitions},l.memoizedState=d,l.childLanes=e.childLanes&~r,t.memoizedState=_D,i}return l=e.child,e=l.sibling,i=Ep(l,{mode:"visible",children:i.children}),!(t.mode&1)&&(i.lanes=r),i.return=t,i.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=i,t.memoizedState=null,i}function dF(e,t){return t=fE({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function CA(e,t,r,i){return i!==null&&XL(i),sb(t,e.child,null,r),e=dF(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function sxe(e,t,r,i,a,l,d){if(r)return t.flags&256?(t.flags&=-257,i=nO(Error(Sr(422))),CA(e,t,d,i)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(l=i.fallback,a=t.mode,i=fE({mode:"visible",children:i.children},a,0,null),l=$0(l,a,d,null),l.flags|=2,i.return=t,l.return=t,i.sibling=l,t.child=i,t.mode&1&&sb(t,e.child,null,d),t.child.memoizedState=wD(d),t.memoizedState=_D,l);if(!(t.mode&1))return CA(e,t,d,null);if(a.data==="$!"){if(i=a.nextSibling&&a.nextSibling.dataset,i)var s=i.dgst;return i=s,l=Error(Sr(419)),i=nO(l,i,void 0),CA(e,t,d,i)}if(s=(d&e.childLanes)!==0,Yl||s){if(i=mo,i!==null){switch(d&-d){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(i.suspendedLanes|d)?0:a,a!==0&&a!==l.retryLane&&(l.retryLane=a,Am(e,a),gd(i,e,a,-1))}return xF(),i=nO(Error(Sr(421))),CA(e,t,d,i)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=yxe.bind(null,e),a._reactRetry=t,null):(e=l.treeContext,Ac=Ap(a.nextSibling),Tc=t,qs=!0,cd=null,e!==null&&(hu[mu++]=hm,hu[mu++]=mm,hu[mu++]=K0,hm=e.id,mm=e.overflow,K0=t),t=dF(t,i.children),t.flags|=4096,t)}function g9(e,t,r){e.lanes|=t;var i=e.alternate;i!==null&&(i.lanes|=t),pD(e.return,t,r)}function iO(e,t,r,i,a){var l=e.memoizedState;l===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:r,tailMode:a}:(l.isBackwards=t,l.rendering=null,l.renderingStartTime=0,l.last=i,l.tail=r,l.tailMode=a)}function AJ(e,t,r){var i=t.pendingProps,a=i.revealOrder,l=i.tail;if(xl(e,t,i.children,r),i=na.current,i&2)i=i&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&g9(e,r,t);else if(e.tag===19)g9(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}i&=1}if(Ts(na,i),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(r=t.child,a=null;r!==null;)e=r.alternate,e!==null&&tk(e)===null&&(a=r),r=r.sibling;r=a,r===null?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),iO(t,!1,a,r,l);break;case"backwards":for(r=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&tk(e)===null){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}iO(t,!0,r,null,l);break;case"together":iO(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function wT(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Tm(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Y0|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Sr(153));if(t.child!==null){for(e=t.child,r=Ep(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Ep(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function axe(e,t,r){switch(t.tag){case 3:SJ(t),ib();break;case 5:QX(t);break;case 1:ec(t.type)&&ZT(t);break;case 4:nF(t,t.stateNode.containerInfo);break;case 10:var i=t.type._context,a=t.memoizedProps.value;Ts(JT,i._currentValue),i._currentValue=a;break;case 13:if(i=t.memoizedState,i!==null)return i.dehydrated!==null?(Ts(na,na.current&1),t.flags|=128,null):r&t.child.childLanes?CJ(e,t,r):(Ts(na,na.current&1),e=Tm(e,t,r),e!==null?e.sibling:null);Ts(na,na.current&1);break;case 19:if(i=(r&t.childLanes)!==0,e.flags&128){if(i)return AJ(e,t,r);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),Ts(na,na.current),i)break;return null;case 22:case 23:return t.lanes=0,jJ(e,t,r)}return Tm(e,t,r)}var TJ,jD,kJ,PJ;TJ=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};jD=function(){};kJ=function(e,t,r,i){var a=e.memoizedProps;if(a!==i){e=t.stateNode,k0(dh.current);var l=null;switch(r){case"input":a=HR(e,a),i=HR(e,i),l=[];break;case"select":a=sa({},a,{value:void 0}),i=sa({},i,{value:void 0}),l=[];break;case"textarea":a=KR(e,a),i=KR(e,i),l=[];break;default:typeof a.onClick!="function"&&typeof i.onClick=="function"&&(e.onclick=WT)}YR(r,i);var d;r=null;for(x in a)if(!i.hasOwnProperty(x)&&a.hasOwnProperty(x)&&a[x]!=null)if(x==="style"){var s=a[x];for(d in s)s.hasOwnProperty(d)&&(r||(r={}),r[d]="")}else x!=="dangerouslySetInnerHTML"&&x!=="children"&&x!=="suppressContentEditableWarning"&&x!=="suppressHydrationWarning"&&x!=="autoFocus"&&(Jj.hasOwnProperty(x)?l||(l=[]):(l=l||[]).push(x,null));for(x in i){var p=i[x];if(s=a!=null?a[x]:void 0,i.hasOwnProperty(x)&&p!==s&&(p!=null||s!=null))if(x==="style")if(s){for(d in s)!s.hasOwnProperty(d)||p&&p.hasOwnProperty(d)||(r||(r={}),r[d]="");for(d in p)p.hasOwnProperty(d)&&s[d]!==p[d]&&(r||(r={}),r[d]=p[d])}else r||(l||(l=[]),l.push(x,r)),r=p;else x==="dangerouslySetInnerHTML"?(p=p?p.__html:void 0,s=s?s.__html:void 0,p!=null&&s!==p&&(l=l||[]).push(x,p)):x==="children"?typeof p!="string"&&typeof p!="number"||(l=l||[]).push(x,""+p):x!=="suppressContentEditableWarning"&&x!=="suppressHydrationWarning"&&(Jj.hasOwnProperty(x)?(p!=null&&x==="onScroll"&&Rs("scroll",e),l||s===p||(l=[])):(l=l||[]).push(x,p))}r&&(l=l||[]).push("style",r);var x=l;(t.updateQueue=x)&&(t.flags|=4)}};PJ=function(e,t,r,i){r!==i&&(t.flags|=4)};function Hw(e,t){if(!qs)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var i=null;r!==null;)r.alternate!==null&&(i=r),r=r.sibling;i===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:i.sibling=null}}function Uo(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,i=0;if(t)for(var a=e.child;a!==null;)r|=a.lanes|a.childLanes,i|=a.subtreeFlags&14680064,i|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)r|=a.lanes|a.childLanes,i|=a.subtreeFlags,i|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=i,e.childLanes=r,t}function oxe(e,t,r){var i=t.pendingProps;switch(YL(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Uo(t),null;case 1:return ec(t.type)&&KT(),Uo(t),null;case 3:return i=t.stateNode,ab(),Bs(Ql),Bs(Yo),sF(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(e===null||e.child===null)&&(NA(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,cd!==null&&(ED(cd),cd=null))),jD(e,t),Uo(t),null;case 5:iF(t);var a=k0(u2.current);if(r=t.type,e!==null&&t.stateNode!=null)kJ(e,t,r,i,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!i){if(t.stateNode===null)throw Error(Sr(166));return Uo(t),null}if(e=k0(dh.current),NA(t)){i=t.stateNode,r=t.type;var l=t.memoizedProps;switch(i[th]=t,i[l2]=l,e=(t.mode&1)!==0,r){case"dialog":Rs("cancel",i),Rs("close",i);break;case"iframe":case"object":case"embed":Rs("load",i);break;case"video":case"audio":for(a=0;a<gj.length;a++)Rs(gj[a],i);break;case"source":Rs("error",i);break;case"img":case"image":case"link":Rs("error",i),Rs("load",i);break;case"details":Rs("toggle",i);break;case"input":SU(i,l),Rs("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!l.multiple},Rs("invalid",i);break;case"textarea":AU(i,l),Rs("invalid",i)}YR(r,l),a=null;for(var d in l)if(l.hasOwnProperty(d)){var s=l[d];d==="children"?typeof s=="string"?i.textContent!==s&&(l.suppressHydrationWarning!==!0&&jA(i.textContent,s,e),a=["children",s]):typeof s=="number"&&i.textContent!==""+s&&(l.suppressHydrationWarning!==!0&&jA(i.textContent,s,e),a=["children",""+s]):Jj.hasOwnProperty(d)&&s!=null&&d==="onScroll"&&Rs("scroll",i)}switch(r){case"input":pA(i),CU(i,l,!0);break;case"textarea":pA(i),TU(i);break;case"select":case"option":break;default:typeof l.onClick=="function"&&(i.onclick=WT)}i=a,t.updateQueue=i,i!==null&&(t.flags|=4)}else{d=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=iX(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=d.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof i.is=="string"?e=d.createElement(r,{is:i.is}):(e=d.createElement(r),r==="select"&&(d=e,i.multiple?d.multiple=!0:i.size&&(d.size=i.size))):e=d.createElementNS(e,r),e[th]=t,e[l2]=i,TJ(e,t,!1,!1),t.stateNode=e;e:{switch(d=XR(r,i),r){case"dialog":Rs("cancel",e),Rs("close",e),a=i;break;case"iframe":case"object":case"embed":Rs("load",e),a=i;break;case"video":case"audio":for(a=0;a<gj.length;a++)Rs(gj[a],e);a=i;break;case"source":Rs("error",e),a=i;break;case"img":case"image":case"link":Rs("error",e),Rs("load",e),a=i;break;case"details":Rs("toggle",e),a=i;break;case"input":SU(e,i),a=HR(e,i),Rs("invalid",e);break;case"option":a=i;break;case"select":e._wrapperState={wasMultiple:!!i.multiple},a=sa({},i,{value:void 0}),Rs("invalid",e);break;case"textarea":AU(e,i),a=KR(e,i),Rs("invalid",e);break;default:a=i}YR(r,a),s=a;for(l in s)if(s.hasOwnProperty(l)){var p=s[l];l==="style"?oX(e,p):l==="dangerouslySetInnerHTML"?(p=p?p.__html:void 0,p!=null&&sX(e,p)):l==="children"?typeof p=="string"?(r!=="textarea"||p!=="")&&Qj(e,p):typeof p=="number"&&Qj(e,""+p):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(Jj.hasOwnProperty(l)?p!=null&&l==="onScroll"&&Rs("scroll",e):p!=null&&RL(e,l,p,d))}switch(r){case"input":pA(e),CU(e,i,!1);break;case"textarea":pA(e),TU(e);break;case"option":i.value!=null&&e.setAttribute("value",""+Bp(i.value));break;case"select":e.multiple=!!i.multiple,l=i.value,l!=null?Tv(e,!!i.multiple,l,!1):i.defaultValue!=null&&Tv(e,!!i.multiple,i.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=WT)}switch(r){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Uo(t),null;case 6:if(e&&t.stateNode!=null)PJ(e,t,e.memoizedProps,i);else{if(typeof i!="string"&&t.stateNode===null)throw Error(Sr(166));if(r=k0(u2.current),k0(dh.current),NA(t)){if(i=t.stateNode,r=t.memoizedProps,i[th]=t,(l=i.nodeValue!==r)&&(e=Tc,e!==null))switch(e.tag){case 3:jA(i.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&jA(i.nodeValue,r,(e.mode&1)!==0)}l&&(t.flags|=4)}else i=(r.nodeType===9?r:r.ownerDocument).createTextNode(i),i[th]=t,t.stateNode=i}return Uo(t),null;case 13:if(Bs(na),i=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(qs&&Ac!==null&&t.mode&1&&!(t.flags&128))KX(),ib(),t.flags|=98560,l=!1;else if(l=NA(t),i!==null&&i.dehydrated!==null){if(e===null){if(!l)throw Error(Sr(318));if(l=t.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(Sr(317));l[th]=t}else ib(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Uo(t),l=!1}else cd!==null&&(ED(cd),cd=null),l=!0;if(!l)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(i=i!==null,i!==(e!==null&&e.memoizedState!==null)&&i&&(t.child.flags|=8192,t.mode&1&&(e===null||na.current&1?Ja===0&&(Ja=3):xF())),t.updateQueue!==null&&(t.flags|=4),Uo(t),null);case 4:return ab(),jD(e,t),e===null&&a2(t.stateNode.containerInfo),Uo(t),null;case 10:return eF(t.type._context),Uo(t),null;case 17:return ec(t.type)&&KT(),Uo(t),null;case 19:if(Bs(na),l=t.memoizedState,l===null)return Uo(t),null;if(i=(t.flags&128)!==0,d=l.rendering,d===null)if(i)Hw(l,!1);else{if(Ja!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(d=tk(e),d!==null){for(t.flags|=128,Hw(l,!1),i=d.updateQueue,i!==null&&(t.updateQueue=i,t.flags|=4),t.subtreeFlags=0,i=r,r=t.child;r!==null;)l=r,e=i,l.flags&=14680066,d=l.alternate,d===null?(l.childLanes=0,l.lanes=e,l.child=null,l.subtreeFlags=0,l.memoizedProps=null,l.memoizedState=null,l.updateQueue=null,l.dependencies=null,l.stateNode=null):(l.childLanes=d.childLanes,l.lanes=d.lanes,l.child=d.child,l.subtreeFlags=0,l.deletions=null,l.memoizedProps=d.memoizedProps,l.memoizedState=d.memoizedState,l.updateQueue=d.updateQueue,l.type=d.type,e=d.dependencies,l.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Ts(na,na.current&1|2),t.child}e=e.sibling}l.tail!==null&&ja()>lb&&(t.flags|=128,i=!0,Hw(l,!1),t.lanes=4194304)}else{if(!i)if(e=tk(d),e!==null){if(t.flags|=128,i=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Hw(l,!0),l.tail===null&&l.tailMode==="hidden"&&!d.alternate&&!qs)return Uo(t),null}else 2*ja()-l.renderingStartTime>lb&&r!==1073741824&&(t.flags|=128,i=!0,Hw(l,!1),t.lanes=4194304);l.isBackwards?(d.sibling=t.child,t.child=d):(r=l.last,r!==null?r.sibling=d:t.child=d,l.last=d)}return l.tail!==null?(t=l.tail,l.rendering=t,l.tail=t.sibling,l.renderingStartTime=ja(),t.sibling=null,r=na.current,Ts(na,i?r&1|2:r&1),t):(Uo(t),null);case 22:case 23:return gF(),i=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==i&&(t.flags|=8192),i&&t.mode&1?wc&1073741824&&(Uo(t),t.subtreeFlags&6&&(t.flags|=8192)):Uo(t),null;case 24:return null;case 25:return null}throw Error(Sr(156,t.tag))}function lxe(e,t){switch(YL(t),t.tag){case 1:return ec(t.type)&&KT(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return ab(),Bs(Ql),Bs(Yo),sF(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return iF(t),null;case 13:if(Bs(na),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Sr(340));ib()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Bs(na),null;case 4:return ab(),null;case 10:return eF(t.type._context),null;case 22:case 23:return gF(),null;case 24:return null;default:return null}}var AA=!1,Wo=!1,cxe=typeof WeakSet=="function"?WeakSet:Set,tn=null;function vv(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(i){ha(e,t,i)}else r.current=null}function ND(e,t,r){try{r()}catch(i){ha(e,t,i)}}var x9=!1;function uxe(e,t){if(oD=GT,e=RX(),KL(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var i=r.getSelection&&r.getSelection();if(i&&i.rangeCount!==0){r=i.anchorNode;var a=i.anchorOffset,l=i.focusNode;i=i.focusOffset;try{r.nodeType,l.nodeType}catch{r=null;break e}var d=0,s=-1,p=-1,x=0,w=0,j=e,S=null;t:for(;;){for(var P;j!==r||a!==0&&j.nodeType!==3||(s=d+a),j!==l||i!==0&&j.nodeType!==3||(p=d+i),j.nodeType===3&&(d+=j.nodeValue.length),(P=j.firstChild)!==null;)S=j,j=P;for(;;){if(j===e)break t;if(S===r&&++x===a&&(s=d),S===l&&++w===i&&(p=d),(P=j.nextSibling)!==null)break;j=S,S=j.parentNode}j=P}r=s===-1||p===-1?null:{start:s,end:p}}else r=null}r=r||{start:0,end:0}}else r=null;for(lD={focusedElem:e,selectionRange:r},GT=!1,tn=t;tn!==null;)if(t=tn,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,tn=e;else for(;tn!==null;){t=tn;try{var F=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(F!==null){var L=F.memoizedProps,B=F.memoizedState,V=t.stateNode,$=V.getSnapshotBeforeUpdate(t.elementType===t.type?L:td(t.type,L),B);V.__reactInternalSnapshotBeforeUpdate=$}break;case 3:var G=t.stateNode.containerInfo;G.nodeType===1?G.textContent="":G.nodeType===9&&G.documentElement&&G.removeChild(G.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Sr(163))}}catch(W){ha(t,t.return,W)}if(e=t.sibling,e!==null){e.return=t.return,tn=e;break}tn=t.return}return F=x9,x9=!1,F}function Ej(e,t,r){var i=t.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var a=i=i.next;do{if((a.tag&e)===e){var l=a.destroy;a.destroy=void 0,l!==void 0&&ND(t,r,l)}a=a.next}while(a!==i)}}function hE(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var i=r.create;r.destroy=i()}r=r.next}while(r!==t)}}function SD(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function EJ(e){var t=e.alternate;t!==null&&(e.alternate=null,EJ(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[th],delete t[l2],delete t[dD],delete t[q0e],delete t[W0e])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function MJ(e){return e.tag===5||e.tag===3||e.tag===4}function y9(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||MJ(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function CD(e,t,r){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=WT));else if(i!==4&&(e=e.child,e!==null))for(CD(e,t,r),e=e.sibling;e!==null;)CD(e,t,r),e=e.sibling}function AD(e,t,r){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(i!==4&&(e=e.child,e!==null))for(AD(e,t,r),e=e.sibling;e!==null;)AD(e,t,r),e=e.sibling}var So=null,id=!1;function Vf(e,t,r){for(r=r.child;r!==null;)IJ(e,t,r),r=r.sibling}function IJ(e,t,r){if(uh&&typeof uh.onCommitFiberUnmount=="function")try{uh.onCommitFiberUnmount(iE,r)}catch{}switch(r.tag){case 5:Wo||vv(r,t);case 6:var i=So,a=id;So=null,Vf(e,t,r),So=i,id=a,So!==null&&(id?(e=So,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):So.removeChild(r.stateNode));break;case 18:So!==null&&(id?(e=So,r=r.stateNode,e.nodeType===8?XI(e.parentNode,r):e.nodeType===1&&XI(e,r),n2(e)):XI(So,r.stateNode));break;case 4:i=So,a=id,So=r.stateNode.containerInfo,id=!0,Vf(e,t,r),So=i,id=a;break;case 0:case 11:case 14:case 15:if(!Wo&&(i=r.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){a=i=i.next;do{var l=a,d=l.destroy;l=l.tag,d!==void 0&&(l&2||l&4)&&ND(r,t,d),a=a.next}while(a!==i)}Vf(e,t,r);break;case 1:if(!Wo&&(vv(r,t),i=r.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=r.memoizedProps,i.state=r.memoizedState,i.componentWillUnmount()}catch(s){ha(r,t,s)}Vf(e,t,r);break;case 21:Vf(e,t,r);break;case 22:r.mode&1?(Wo=(i=Wo)||r.memoizedState!==null,Vf(e,t,r),Wo=i):Vf(e,t,r);break;default:Vf(e,t,r)}}function v9(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new cxe),t.forEach(function(i){var a=vxe.bind(null,e,i);r.has(i)||(r.add(i),i.then(a,a))})}}function Ju(e,t){var r=t.deletions;if(r!==null)for(var i=0;i<r.length;i++){var a=r[i];try{var l=e,d=t,s=d;e:for(;s!==null;){switch(s.tag){case 5:So=s.stateNode,id=!1;break e;case 3:So=s.stateNode.containerInfo,id=!0;break e;case 4:So=s.stateNode.containerInfo,id=!0;break e}s=s.return}if(So===null)throw Error(Sr(160));IJ(l,d,a),So=null,id=!1;var p=a.alternate;p!==null&&(p.return=null),a.return=null}catch(x){ha(a,t,x)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)OJ(t,e),t=t.sibling}function OJ(e,t){var r=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Ju(t,e),Zd(e),i&4){try{Ej(3,e,e.return),hE(3,e)}catch(L){ha(e,e.return,L)}try{Ej(5,e,e.return)}catch(L){ha(e,e.return,L)}}break;case 1:Ju(t,e),Zd(e),i&512&&r!==null&&vv(r,r.return);break;case 5:if(Ju(t,e),Zd(e),i&512&&r!==null&&vv(r,r.return),e.flags&32){var a=e.stateNode;try{Qj(a,"")}catch(L){ha(e,e.return,L)}}if(i&4&&(a=e.stateNode,a!=null)){var l=e.memoizedProps,d=r!==null?r.memoizedProps:l,s=e.type,p=e.updateQueue;if(e.updateQueue=null,p!==null)try{s==="input"&&l.type==="radio"&&l.name!=null&&rX(a,l),XR(s,d);var x=XR(s,l);for(d=0;d<p.length;d+=2){var w=p[d],j=p[d+1];w==="style"?oX(a,j):w==="dangerouslySetInnerHTML"?sX(a,j):w==="children"?Qj(a,j):RL(a,w,j,x)}switch(s){case"input":qR(a,l);break;case"textarea":nX(a,l);break;case"select":var S=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!l.multiple;var P=l.value;P!=null?Tv(a,!!l.multiple,P,!1):S!==!!l.multiple&&(l.defaultValue!=null?Tv(a,!!l.multiple,l.defaultValue,!0):Tv(a,!!l.multiple,l.multiple?[]:"",!1))}a[l2]=l}catch(L){ha(e,e.return,L)}}break;case 6:if(Ju(t,e),Zd(e),i&4){if(e.stateNode===null)throw Error(Sr(162));a=e.stateNode,l=e.memoizedProps;try{a.nodeValue=l}catch(L){ha(e,e.return,L)}}break;case 3:if(Ju(t,e),Zd(e),i&4&&r!==null&&r.memoizedState.isDehydrated)try{n2(t.containerInfo)}catch(L){ha(e,e.return,L)}break;case 4:Ju(t,e),Zd(e);break;case 13:Ju(t,e),Zd(e),a=e.child,a.flags&8192&&(l=a.memoizedState!==null,a.stateNode.isHidden=l,!l||a.alternate!==null&&a.alternate.memoizedState!==null||(fF=ja())),i&4&&v9(e);break;case 22:if(w=r!==null&&r.memoizedState!==null,e.mode&1?(Wo=(x=Wo)||w,Ju(t,e),Wo=x):Ju(t,e),Zd(e),i&8192){if(x=e.memoizedState!==null,(e.stateNode.isHidden=x)&&!w&&e.mode&1)for(tn=e,w=e.child;w!==null;){for(j=tn=w;tn!==null;){switch(S=tn,P=S.child,S.tag){case 0:case 11:case 14:case 15:Ej(4,S,S.return);break;case 1:vv(S,S.return);var F=S.stateNode;if(typeof F.componentWillUnmount=="function"){i=S,r=S.return;try{t=i,F.props=t.memoizedProps,F.state=t.memoizedState,F.componentWillUnmount()}catch(L){ha(i,r,L)}}break;case 5:vv(S,S.return);break;case 22:if(S.memoizedState!==null){_9(j);continue}}P!==null?(P.return=S,tn=P):_9(j)}w=w.sibling}e:for(w=null,j=e;;){if(j.tag===5){if(w===null){w=j;try{a=j.stateNode,x?(l=a.style,typeof l.setProperty=="function"?l.setProperty("display","none","important"):l.display="none"):(s=j.stateNode,p=j.memoizedProps.style,d=p!=null&&p.hasOwnProperty("display")?p.display:null,s.style.display=aX("display",d))}catch(L){ha(e,e.return,L)}}}else if(j.tag===6){if(w===null)try{j.stateNode.nodeValue=x?"":j.memoizedProps}catch(L){ha(e,e.return,L)}}else if((j.tag!==22&&j.tag!==23||j.memoizedState===null||j===e)&&j.child!==null){j.child.return=j,j=j.child;continue}if(j===e)break e;for(;j.sibling===null;){if(j.return===null||j.return===e)break e;w===j&&(w=null),j=j.return}w===j&&(w=null),j.sibling.return=j.return,j=j.sibling}}break;case 19:Ju(t,e),Zd(e),i&4&&v9(e);break;case 21:break;default:Ju(t,e),Zd(e)}}function Zd(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(MJ(r)){var i=r;break e}r=r.return}throw Error(Sr(160))}switch(i.tag){case 5:var a=i.stateNode;i.flags&32&&(Qj(a,""),i.flags&=-33);var l=y9(e);AD(e,l,a);break;case 3:case 4:var d=i.stateNode.containerInfo,s=y9(e);CD(e,s,d);break;default:throw Error(Sr(161))}}catch(p){ha(e,e.return,p)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function dxe(e,t,r){tn=e,RJ(e)}function RJ(e,t,r){for(var i=(e.mode&1)!==0;tn!==null;){var a=tn,l=a.child;if(a.tag===22&&i){var d=a.memoizedState!==null||AA;if(!d){var s=a.alternate,p=s!==null&&s.memoizedState!==null||Wo;s=AA;var x=Wo;if(AA=d,(Wo=p)&&!x)for(tn=a;tn!==null;)d=tn,p=d.child,d.tag===22&&d.memoizedState!==null?w9(a):p!==null?(p.return=d,tn=p):w9(a);for(;l!==null;)tn=l,RJ(l),l=l.sibling;tn=a,AA=s,Wo=x}b9(e)}else a.subtreeFlags&8772&&l!==null?(l.return=a,tn=l):b9(e)}}function b9(e){for(;tn!==null;){var t=tn;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Wo||hE(5,t);break;case 1:var i=t.stateNode;if(t.flags&4&&!Wo)if(r===null)i.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:td(t.type,r.memoizedProps);i.componentDidUpdate(a,r.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var l=t.updateQueue;l!==null&&i9(t,l,i);break;case 3:var d=t.updateQueue;if(d!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}i9(t,d,r)}break;case 5:var s=t.stateNode;if(r===null&&t.flags&4){r=s;var p=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":p.autoFocus&&r.focus();break;case"img":p.src&&(r.src=p.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var x=t.alternate;if(x!==null){var w=x.memoizedState;if(w!==null){var j=w.dehydrated;j!==null&&n2(j)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Sr(163))}Wo||t.flags&512&&SD(t)}catch(S){ha(t,t.return,S)}}if(t===e){tn=null;break}if(r=t.sibling,r!==null){r.return=t.return,tn=r;break}tn=t.return}}function _9(e){for(;tn!==null;){var t=tn;if(t===e){tn=null;break}var r=t.sibling;if(r!==null){r.return=t.return,tn=r;break}tn=t.return}}function w9(e){for(;tn!==null;){var t=tn;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{hE(4,t)}catch(p){ha(t,r,p)}break;case 1:var i=t.stateNode;if(typeof i.componentDidMount=="function"){var a=t.return;try{i.componentDidMount()}catch(p){ha(t,a,p)}}var l=t.return;try{SD(t)}catch(p){ha(t,l,p)}break;case 5:var d=t.return;try{SD(t)}catch(p){ha(t,d,p)}}}catch(p){ha(t,t.return,p)}if(t===e){tn=null;break}var s=t.sibling;if(s!==null){s.return=t.return,tn=s;break}tn=t.return}}var hxe=Math.ceil,ik=Lm.ReactCurrentDispatcher,hF=Lm.ReactCurrentOwner,vu=Lm.ReactCurrentBatchConfig,Bi=0,mo=null,Ra=null,Po=0,wc=0,bv=Qp(0),Ja=0,f2=null,Y0=0,mE=0,mF=0,Mj=null,Kl=null,fF=0,lb=1/0,am=null,sk=!1,TD=null,kp=null,TA=!1,vp=null,ak=0,Ij=0,kD=null,jT=-1,NT=0;function Nl(){return Bi&6?ja():jT!==-1?jT:jT=ja()}function Pp(e){return e.mode&1?Bi&2&&Po!==0?Po&-Po:Z0e.transition!==null?(NT===0&&(NT=vX()),NT):(e=ls,e!==0||(e=window.event,e=e===void 0?16:CX(e.type)),e):1}function gd(e,t,r,i){if(50<Ij)throw Ij=0,kD=null,Error(Sr(185));RN(e,r,i),(!(Bi&2)||e!==mo)&&(e===mo&&(!(Bi&2)&&(mE|=r),Ja===4&&ap(e,Po)),tc(e,i),r===1&&Bi===0&&!(t.mode&1)&&(lb=ja()+500,cE&&eg()))}function tc(e,t){var r=e.callbackNode;Zge(e,t);var i=UT(e,e===mo?Po:0);if(i===0)r!==null&&EU(r),e.callbackNode=null,e.callbackPriority=0;else if(t=i&-i,e.callbackPriority!==t){if(r!=null&&EU(r),t===1)e.tag===0?K0e(j9.bind(null,e)):HX(j9.bind(null,e)),G0e(function(){!(Bi&6)&&eg()}),r=null;else{switch(bX(i)){case 1:r=BL;break;case 4:r=xX;break;case 16:r=VT;break;case 536870912:r=yX;break;default:r=VT}r=UJ(r,DJ.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function DJ(e,t){if(jT=-1,NT=0,Bi&6)throw Error(Sr(327));var r=e.callbackNode;if(Iv()&&e.callbackNode!==r)return null;var i=UT(e,e===mo?Po:0);if(i===0)return null;if(i&30||i&e.expiredLanes||t)t=ok(e,i);else{t=i;var a=Bi;Bi|=2;var l=LJ();(mo!==e||Po!==t)&&(am=null,lb=ja()+500,B0(e,t));do try{pxe();break}catch(s){zJ(e,s)}while(!0);QL(),ik.current=l,Bi=a,Ra!==null?t=0:(mo=null,Po=0,t=Ja)}if(t!==0){if(t===2&&(a=rD(e),a!==0&&(i=a,t=PD(e,a))),t===1)throw r=f2,B0(e,0),ap(e,i),tc(e,ja()),r;if(t===6)ap(e,i);else{if(a=e.current.alternate,!(i&30)&&!mxe(a)&&(t=ok(e,i),t===2&&(l=rD(e),l!==0&&(i=l,t=PD(e,l))),t===1))throw r=f2,B0(e,0),ap(e,i),tc(e,ja()),r;switch(e.finishedWork=a,e.finishedLanes=i,t){case 0:case 1:throw Error(Sr(345));case 2:y0(e,Kl,am);break;case 3:if(ap(e,i),(i&130023424)===i&&(t=fF+500-ja(),10<t)){if(UT(e,0)!==0)break;if(a=e.suspendedLanes,(a&i)!==i){Nl(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=uD(y0.bind(null,e,Kl,am),t);break}y0(e,Kl,am);break;case 4:if(ap(e,i),(i&4194240)===i)break;for(t=e.eventTimes,a=-1;0<i;){var d=31-pd(i);l=1<<d,d=t[d],d>a&&(a=d),i&=~l}if(i=a,i=ja()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*hxe(i/1960))-i,10<i){e.timeoutHandle=uD(y0.bind(null,e,Kl,am),i);break}y0(e,Kl,am);break;case 5:y0(e,Kl,am);break;default:throw Error(Sr(329))}}}return tc(e,ja()),e.callbackNode===r?DJ.bind(null,e):null}function PD(e,t){var r=Mj;return e.current.memoizedState.isDehydrated&&(B0(e,t).flags|=256),e=ok(e,t),e!==2&&(t=Kl,Kl=r,t!==null&&ED(t)),e}function ED(e){Kl===null?Kl=e:Kl.push.apply(Kl,e)}function mxe(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var i=0;i<r.length;i++){var a=r[i],l=a.getSnapshot;a=a.value;try{if(!vd(l(),a))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function ap(e,t){for(t&=~mF,t&=~mE,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-pd(t),i=1<<r;e[r]=-1,t&=~i}}function j9(e){if(Bi&6)throw Error(Sr(327));Iv();var t=UT(e,0);if(!(t&1))return tc(e,ja()),null;var r=ok(e,t);if(e.tag!==0&&r===2){var i=rD(e);i!==0&&(t=i,r=PD(e,i))}if(r===1)throw r=f2,B0(e,0),ap(e,t),tc(e,ja()),r;if(r===6)throw Error(Sr(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,y0(e,Kl,am),tc(e,ja()),null}function pF(e,t){var r=Bi;Bi|=1;try{return e(t)}finally{Bi=r,Bi===0&&(lb=ja()+500,cE&&eg())}}function X0(e){vp!==null&&vp.tag===0&&!(Bi&6)&&Iv();var t=Bi;Bi|=1;var r=vu.transition,i=ls;try{if(vu.transition=null,ls=1,e)return e()}finally{ls=i,vu.transition=r,Bi=t,!(Bi&6)&&eg()}}function gF(){wc=bv.current,Bs(bv)}function B0(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,U0e(r)),Ra!==null)for(r=Ra.return;r!==null;){var i=r;switch(YL(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&KT();break;case 3:ab(),Bs(Ql),Bs(Yo),sF();break;case 5:iF(i);break;case 4:ab();break;case 13:Bs(na);break;case 19:Bs(na);break;case 10:eF(i.type._context);break;case 22:case 23:gF()}r=r.return}if(mo=e,Ra=e=Ep(e.current,null),Po=wc=t,Ja=0,f2=null,mF=mE=Y0=0,Kl=Mj=null,T0!==null){for(t=0;t<T0.length;t++)if(r=T0[t],i=r.interleaved,i!==null){r.interleaved=null;var a=i.next,l=r.pending;if(l!==null){var d=l.next;l.next=a,i.next=d}r.pending=i}T0=null}return e}function zJ(e,t){do{var r=Ra;try{if(QL(),bT.current=nk,rk){for(var i=ia.memoizedState;i!==null;){var a=i.queue;a!==null&&(a.pending=null),i=i.next}rk=!1}if(Z0=0,uo=Xa=ia=null,Pj=!1,d2=0,hF.current=null,r===null||r.return===null){Ja=1,f2=t,Ra=null;break}e:{var l=e,d=r.return,s=r,p=t;if(t=Po,s.flags|=32768,p!==null&&typeof p=="object"&&typeof p.then=="function"){var x=p,w=s,j=w.tag;if(!(w.mode&1)&&(j===0||j===11||j===15)){var S=w.alternate;S?(w.updateQueue=S.updateQueue,w.memoizedState=S.memoizedState,w.lanes=S.lanes):(w.updateQueue=null,w.memoizedState=null)}var P=u9(d);if(P!==null){P.flags&=-257,d9(P,d,s,l,t),P.mode&1&&c9(l,x,t),t=P,p=x;var F=t.updateQueue;if(F===null){var L=new Set;L.add(p),t.updateQueue=L}else F.add(p);break e}else{if(!(t&1)){c9(l,x,t),xF();break e}p=Error(Sr(426))}}else if(qs&&s.mode&1){var B=u9(d);if(B!==null){!(B.flags&65536)&&(B.flags|=256),d9(B,d,s,l,t),XL(ob(p,s));break e}}l=p=ob(p,s),Ja!==4&&(Ja=2),Mj===null?Mj=[l]:Mj.push(l),l=d;do{switch(l.tag){case 3:l.flags|=65536,t&=-t,l.lanes|=t;var V=bJ(l,p,t);n9(l,V);break e;case 1:s=p;var $=l.type,G=l.stateNode;if(!(l.flags&128)&&(typeof $.getDerivedStateFromError=="function"||G!==null&&typeof G.componentDidCatch=="function"&&(kp===null||!kp.has(G)))){l.flags|=65536,t&=-t,l.lanes|=t;var W=_J(l,s,t);n9(l,W);break e}}l=l.return}while(l!==null)}BJ(r)}catch(Z){t=Z,Ra===r&&r!==null&&(Ra=r=r.return);continue}break}while(!0)}function LJ(){var e=ik.current;return ik.current=nk,e===null?nk:e}function xF(){(Ja===0||Ja===3||Ja===2)&&(Ja=4),mo===null||!(Y0&268435455)&&!(mE&268435455)||ap(mo,Po)}function ok(e,t){var r=Bi;Bi|=2;var i=LJ();(mo!==e||Po!==t)&&(am=null,B0(e,t));do try{fxe();break}catch(a){zJ(e,a)}while(!0);if(QL(),Bi=r,ik.current=i,Ra!==null)throw Error(Sr(261));return mo=null,Po=0,Ja}function fxe(){for(;Ra!==null;)FJ(Ra)}function pxe(){for(;Ra!==null&&!Bge();)FJ(Ra)}function FJ(e){var t=VJ(e.alternate,e,wc);e.memoizedProps=e.pendingProps,t===null?BJ(e):Ra=t,hF.current=null}function BJ(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=lxe(r,t),r!==null){r.flags&=32767,Ra=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Ja=6,Ra=null;return}}else if(r=oxe(r,t,wc),r!==null){Ra=r;return}if(t=t.sibling,t!==null){Ra=t;return}Ra=t=e}while(t!==null);Ja===0&&(Ja=5)}function y0(e,t,r){var i=ls,a=vu.transition;try{vu.transition=null,ls=1,gxe(e,t,r,i)}finally{vu.transition=a,ls=i}return null}function gxe(e,t,r,i){do Iv();while(vp!==null);if(Bi&6)throw Error(Sr(327));r=e.finishedWork;var a=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(Sr(177));e.callbackNode=null,e.callbackPriority=0;var l=r.lanes|r.childLanes;if(Yge(e,l),e===mo&&(Ra=mo=null,Po=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||TA||(TA=!0,UJ(VT,function(){return Iv(),null})),l=(r.flags&15990)!==0,r.subtreeFlags&15990||l){l=vu.transition,vu.transition=null;var d=ls;ls=1;var s=Bi;Bi|=4,hF.current=null,uxe(e,r),OJ(r,e),D0e(lD),GT=!!oD,lD=oD=null,e.current=r,dxe(r),$ge(),Bi=s,ls=d,vu.transition=l}else e.current=r;if(TA&&(TA=!1,vp=e,ak=a),l=e.pendingLanes,l===0&&(kp=null),Gge(r.stateNode),tc(e,ja()),t!==null)for(i=e.onRecoverableError,r=0;r<t.length;r++)a=t[r],i(a.value,{componentStack:a.stack,digest:a.digest});if(sk)throw sk=!1,e=TD,TD=null,e;return ak&1&&e.tag!==0&&Iv(),l=e.pendingLanes,l&1?e===kD?Ij++:(Ij=0,kD=e):Ij=0,eg(),null}function Iv(){if(vp!==null){var e=bX(ak),t=vu.transition,r=ls;try{if(vu.transition=null,ls=16>e?16:e,vp===null)var i=!1;else{if(e=vp,vp=null,ak=0,Bi&6)throw Error(Sr(331));var a=Bi;for(Bi|=4,tn=e.current;tn!==null;){var l=tn,d=l.child;if(tn.flags&16){var s=l.deletions;if(s!==null){for(var p=0;p<s.length;p++){var x=s[p];for(tn=x;tn!==null;){var w=tn;switch(w.tag){case 0:case 11:case 15:Ej(8,w,l)}var j=w.child;if(j!==null)j.return=w,tn=j;else for(;tn!==null;){w=tn;var S=w.sibling,P=w.return;if(EJ(w),w===x){tn=null;break}if(S!==null){S.return=P,tn=S;break}tn=P}}}var F=l.alternate;if(F!==null){var L=F.child;if(L!==null){F.child=null;do{var B=L.sibling;L.sibling=null,L=B}while(L!==null)}}tn=l}}if(l.subtreeFlags&2064&&d!==null)d.return=l,tn=d;else e:for(;tn!==null;){if(l=tn,l.flags&2048)switch(l.tag){case 0:case 11:case 15:Ej(9,l,l.return)}var V=l.sibling;if(V!==null){V.return=l.return,tn=V;break e}tn=l.return}}var $=e.current;for(tn=$;tn!==null;){d=tn;var G=d.child;if(d.subtreeFlags&2064&&G!==null)G.return=d,tn=G;else e:for(d=$;tn!==null;){if(s=tn,s.flags&2048)try{switch(s.tag){case 0:case 11:case 15:hE(9,s)}}catch(Z){ha(s,s.return,Z)}if(s===d){tn=null;break e}var W=s.sibling;if(W!==null){W.return=s.return,tn=W;break e}tn=s.return}}if(Bi=a,eg(),uh&&typeof uh.onPostCommitFiberRoot=="function")try{uh.onPostCommitFiberRoot(iE,e)}catch{}i=!0}return i}finally{ls=r,vu.transition=t}}return!1}function N9(e,t,r){t=ob(r,t),t=bJ(e,t,1),e=Tp(e,t,1),t=Nl(),e!==null&&(RN(e,1,t),tc(e,t))}function ha(e,t,r){if(e.tag===3)N9(e,e,r);else for(;t!==null;){if(t.tag===3){N9(t,e,r);break}else if(t.tag===1){var i=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(kp===null||!kp.has(i))){e=ob(r,e),e=_J(t,e,1),t=Tp(t,e,1),e=Nl(),t!==null&&(RN(t,1,e),tc(t,e));break}}t=t.return}}function xxe(e,t,r){var i=e.pingCache;i!==null&&i.delete(t),t=Nl(),e.pingedLanes|=e.suspendedLanes&r,mo===e&&(Po&r)===r&&(Ja===4||Ja===3&&(Po&130023424)===Po&&500>ja()-fF?B0(e,0):mF|=r),tc(e,t)}function $J(e,t){t===0&&(e.mode&1?(t=yA,yA<<=1,!(yA&130023424)&&(yA=4194304)):t=1);var r=Nl();e=Am(e,t),e!==null&&(RN(e,t,r),tc(e,r))}function yxe(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),$J(e,r)}function vxe(e,t){var r=0;switch(e.tag){case 13:var i=e.stateNode,a=e.memoizedState;a!==null&&(r=a.retryLane);break;case 19:i=e.stateNode;break;default:throw Error(Sr(314))}i!==null&&i.delete(t),$J(e,r)}var VJ;VJ=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Ql.current)Yl=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Yl=!1,axe(e,t,r);Yl=!!(e.flags&131072)}else Yl=!1,qs&&t.flags&1048576&&qX(t,XT,t.index);switch(t.lanes=0,t.tag){case 2:var i=t.type;wT(e,t),e=t.pendingProps;var a=nb(t,Yo.current);Mv(t,r),a=oF(null,t,i,e,a,r);var l=lF();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,ec(i)?(l=!0,ZT(t)):l=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,rF(t),a.updater=dE,t.stateNode=a,a._reactInternals=t,xD(t,i,e,r),t=bD(null,t,i,!0,l,r)):(t.tag=0,qs&&l&&ZL(t),xl(null,t,a,r),t=t.child),t;case 16:i=t.elementType;e:{switch(wT(e,t),e=t.pendingProps,a=i._init,i=a(i._payload),t.type=i,a=t.tag=_xe(i),e=td(i,e),a){case 0:t=vD(null,t,i,e,r);break e;case 1:t=f9(null,t,i,e,r);break e;case 11:t=h9(null,t,i,e,r);break e;case 14:t=m9(null,t,i,td(i.type,e),r);break e}throw Error(Sr(306,i,""))}return t;case 0:return i=t.type,a=t.pendingProps,a=t.elementType===i?a:td(i,a),vD(e,t,i,a,r);case 1:return i=t.type,a=t.pendingProps,a=t.elementType===i?a:td(i,a),f9(e,t,i,a,r);case 3:e:{if(SJ(t),e===null)throw Error(Sr(387));i=t.pendingProps,l=t.memoizedState,a=l.element,JX(e,t),ek(t,i,null,r);var d=t.memoizedState;if(i=d.element,l.isDehydrated)if(l={element:i,isDehydrated:!1,cache:d.cache,pendingSuspenseBoundaries:d.pendingSuspenseBoundaries,transitions:d.transitions},t.updateQueue.baseState=l,t.memoizedState=l,t.flags&256){a=ob(Error(Sr(423)),t),t=p9(e,t,i,r,a);break e}else if(i!==a){a=ob(Error(Sr(424)),t),t=p9(e,t,i,r,a);break e}else for(Ac=Ap(t.stateNode.containerInfo.firstChild),Tc=t,qs=!0,cd=null,r=YX(t,null,i,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(ib(),i===a){t=Tm(e,t,r);break e}xl(e,t,i,r)}t=t.child}return t;case 5:return QX(t),e===null&&fD(t),i=t.type,a=t.pendingProps,l=e!==null?e.memoizedProps:null,d=a.children,cD(i,a)?d=null:l!==null&&cD(i,l)&&(t.flags|=32),NJ(e,t),xl(e,t,d,r),t.child;case 6:return e===null&&fD(t),null;case 13:return CJ(e,t,r);case 4:return nF(t,t.stateNode.containerInfo),i=t.pendingProps,e===null?t.child=sb(t,null,i,r):xl(e,t,i,r),t.child;case 11:return i=t.type,a=t.pendingProps,a=t.elementType===i?a:td(i,a),h9(e,t,i,a,r);case 7:return xl(e,t,t.pendingProps,r),t.child;case 8:return xl(e,t,t.pendingProps.children,r),t.child;case 12:return xl(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(i=t.type._context,a=t.pendingProps,l=t.memoizedProps,d=a.value,Ts(JT,i._currentValue),i._currentValue=d,l!==null)if(vd(l.value,d)){if(l.children===a.children&&!Ql.current){t=Tm(e,t,r);break e}}else for(l=t.child,l!==null&&(l.return=t);l!==null;){var s=l.dependencies;if(s!==null){d=l.child;for(var p=s.firstContext;p!==null;){if(p.context===i){if(l.tag===1){p=bm(-1,r&-r),p.tag=2;var x=l.updateQueue;if(x!==null){x=x.shared;var w=x.pending;w===null?p.next=p:(p.next=w.next,w.next=p),x.pending=p}}l.lanes|=r,p=l.alternate,p!==null&&(p.lanes|=r),pD(l.return,r,t),s.lanes|=r;break}p=p.next}}else if(l.tag===10)d=l.type===t.type?null:l.child;else if(l.tag===18){if(d=l.return,d===null)throw Error(Sr(341));d.lanes|=r,s=d.alternate,s!==null&&(s.lanes|=r),pD(d,r,t),d=l.sibling}else d=l.child;if(d!==null)d.return=l;else for(d=l;d!==null;){if(d===t){d=null;break}if(l=d.sibling,l!==null){l.return=d.return,d=l;break}d=d.return}l=d}xl(e,t,a.children,r),t=t.child}return t;case 9:return a=t.type,i=t.pendingProps.children,Mv(t,r),a=wu(a),i=i(a),t.flags|=1,xl(e,t,i,r),t.child;case 14:return i=t.type,a=td(i,t.pendingProps),a=td(i.type,a),m9(e,t,i,a,r);case 15:return wJ(e,t,t.type,t.pendingProps,r);case 17:return i=t.type,a=t.pendingProps,a=t.elementType===i?a:td(i,a),wT(e,t),t.tag=1,ec(i)?(e=!0,ZT(t)):e=!1,Mv(t,r),vJ(t,i,a),xD(t,i,a,r),bD(null,t,i,!0,e,r);case 19:return AJ(e,t,r);case 22:return jJ(e,t,r)}throw Error(Sr(156,t.tag))};function UJ(e,t){return gX(e,t)}function bxe(e,t,r,i){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function pu(e,t,r,i){return new bxe(e,t,r,i)}function yF(e){return e=e.prototype,!(!e||!e.isReactComponent)}function _xe(e){if(typeof e=="function")return yF(e)?1:0;if(e!=null){if(e=e.$$typeof,e===zL)return 11;if(e===LL)return 14}return 2}function Ep(e,t){var r=e.alternate;return r===null?(r=pu(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function ST(e,t,r,i,a,l){var d=2;if(i=e,typeof e=="function")yF(e)&&(d=1);else if(typeof e=="string")d=5;else e:switch(e){case uv:return $0(r.children,a,l,t);case DL:d=8,a|=8;break;case $R:return e=pu(12,r,t,a|2),e.elementType=$R,e.lanes=l,e;case VR:return e=pu(13,r,t,a),e.elementType=VR,e.lanes=l,e;case UR:return e=pu(19,r,t,a),e.elementType=UR,e.lanes=l,e;case QY:return fE(r,a,l,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case XY:d=10;break e;case JY:d=9;break e;case zL:d=11;break e;case LL:d=14;break e;case tp:d=16,i=null;break e}throw Error(Sr(130,e==null?e:typeof e,""))}return t=pu(d,r,t,a),t.elementType=e,t.type=i,t.lanes=l,t}function $0(e,t,r,i){return e=pu(7,e,i,t),e.lanes=r,e}function fE(e,t,r,i){return e=pu(22,e,i,t),e.elementType=QY,e.lanes=r,e.stateNode={isHidden:!1},e}function sO(e,t,r){return e=pu(6,e,null,t),e.lanes=r,e}function aO(e,t,r){return t=pu(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function wxe(e,t,r,i,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=BI(0),this.expirationTimes=BI(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=BI(0),this.identifierPrefix=i,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function vF(e,t,r,i,a,l,d,s,p){return e=new wxe(e,t,r,s,p),t===1?(t=1,l===!0&&(t|=8)):t=0,l=pu(3,null,null,t),e.current=l,l.stateNode=e,l.memoizedState={element:i,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},rF(l),e}function jxe(e,t,r){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:cv,key:i==null?null:""+i,children:e,containerInfo:t,implementation:r}}function GJ(e){if(!e)return $p;e=e._reactInternals;e:{if(xx(e)!==e||e.tag!==1)throw Error(Sr(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(ec(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Sr(171))}if(e.tag===1){var r=e.type;if(ec(r))return GX(e,r,t)}return t}function HJ(e,t,r,i,a,l,d,s,p){return e=vF(r,i,!0,e,a,l,d,s,p),e.context=GJ(null),r=e.current,i=Nl(),a=Pp(r),l=bm(i,a),l.callback=t??null,Tp(r,l,a),e.current.lanes=a,RN(e,a,i),tc(e,i),e}function pE(e,t,r,i){var a=t.current,l=Nl(),d=Pp(a);return r=GJ(r),t.context===null?t.context=r:t.pendingContext=r,t=bm(l,d),t.payload={element:e},i=i===void 0?null:i,i!==null&&(t.callback=i),e=Tp(a,t,d),e!==null&&(gd(e,a,d,l),vT(e,a,d)),d}function lk(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function S9(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function bF(e,t){S9(e,t),(e=e.alternate)&&S9(e,t)}function Nxe(){return null}var qJ=typeof reportError=="function"?reportError:function(e){console.error(e)};function _F(e){this._internalRoot=e}gE.prototype.render=_F.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Sr(409));pE(e,t,null,null)};gE.prototype.unmount=_F.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;X0(function(){pE(null,e,null,null)}),t[Cm]=null}};function gE(e){this._internalRoot=e}gE.prototype.unstable_scheduleHydration=function(e){if(e){var t=jX();e={blockedOn:null,target:e,priority:t};for(var r=0;r<sp.length&&t!==0&&t<sp[r].priority;r++);sp.splice(r,0,e),r===0&&SX(e)}};function wF(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function xE(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function C9(){}function Sxe(e,t,r,i,a){if(a){if(typeof i=="function"){var l=i;i=function(){var x=lk(d);l.call(x)}}var d=HJ(t,i,e,0,null,!1,!1,"",C9);return e._reactRootContainer=d,e[Cm]=d.current,a2(e.nodeType===8?e.parentNode:e),X0(),d}for(;a=e.lastChild;)e.removeChild(a);if(typeof i=="function"){var s=i;i=function(){var x=lk(p);s.call(x)}}var p=vF(e,0,!1,null,null,!1,!1,"",C9);return e._reactRootContainer=p,e[Cm]=p.current,a2(e.nodeType===8?e.parentNode:e),X0(function(){pE(t,p,r,i)}),p}function yE(e,t,r,i,a){var l=r._reactRootContainer;if(l){var d=l;if(typeof a=="function"){var s=a;a=function(){var p=lk(d);s.call(p)}}pE(t,d,e,a)}else d=Sxe(r,t,e,a,i);return lk(d)}_X=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=pj(t.pendingLanes);r!==0&&($L(t,r|1),tc(t,ja()),!(Bi&6)&&(lb=ja()+500,eg()))}break;case 13:X0(function(){var i=Am(e,1);if(i!==null){var a=Nl();gd(i,e,1,a)}}),bF(e,1)}};VL=function(e){if(e.tag===13){var t=Am(e,134217728);if(t!==null){var r=Nl();gd(t,e,134217728,r)}bF(e,134217728)}};wX=function(e){if(e.tag===13){var t=Pp(e),r=Am(e,t);if(r!==null){var i=Nl();gd(r,e,t,i)}bF(e,t)}};jX=function(){return ls};NX=function(e,t){var r=ls;try{return ls=e,t()}finally{ls=r}};QR=function(e,t,r){switch(t){case"input":if(qR(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var i=r[t];if(i!==e&&i.form===e.form){var a=lE(i);if(!a)throw Error(Sr(90));tX(i),qR(i,a)}}}break;case"textarea":nX(e,r);break;case"select":t=r.value,t!=null&&Tv(e,!!r.multiple,t,!1)}};uX=pF;dX=X0;var Cxe={usingClientEntryPoint:!1,Events:[zN,fv,lE,lX,cX,pF]},qw={findFiberByHostInstance:A0,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Axe={bundleType:qw.bundleType,version:qw.version,rendererPackageName:qw.rendererPackageName,rendererConfig:qw.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Lm.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=fX(e),e===null?null:e.stateNode},findFiberByHostInstance:qw.findFiberByHostInstance||Nxe,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var kA=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!kA.isDisabled&&kA.supportsFiber)try{iE=kA.inject(Axe),uh=kA}catch{}}qc.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Cxe;qc.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!wF(t))throw Error(Sr(200));return jxe(e,t,null,r)};qc.createRoot=function(e,t){if(!wF(e))throw Error(Sr(299));var r=!1,i="",a=qJ;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(i=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=vF(e,1,!1,null,null,r,!1,i,a),e[Cm]=t.current,a2(e.nodeType===8?e.parentNode:e),new _F(t)};qc.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Sr(188)):(e=Object.keys(e).join(","),Error(Sr(268,e)));return e=fX(t),e=e===null?null:e.stateNode,e};qc.flushSync=function(e){return X0(e)};qc.hydrate=function(e,t,r){if(!xE(t))throw Error(Sr(200));return yE(null,e,t,!0,r)};qc.hydrateRoot=function(e,t,r){if(!wF(e))throw Error(Sr(405));var i=r!=null&&r.hydratedSources||null,a=!1,l="",d=qJ;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(l=r.identifierPrefix),r.onRecoverableError!==void 0&&(d=r.onRecoverableError)),t=HJ(t,null,e,1,r??null,a,!1,l,d),e[Cm]=t.current,a2(e),i)for(e=0;e<i.length;e++)r=i[e],a=r._getVersion,a=a(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new gE(t)};qc.render=function(e,t,r){if(!xE(t))throw Error(Sr(200));return yE(null,e,t,!1,r)};qc.unmountComponentAtNode=function(e){if(!xE(e))throw Error(Sr(40));return e._reactRootContainer?(X0(function(){yE(null,null,e,!1,function(){e._reactRootContainer=null,e[Cm]=null})}),!0):!1};qc.unstable_batchedUpdates=pF;qc.unstable_renderSubtreeIntoContainer=function(e,t,r,i){if(!xE(r))throw Error(Sr(200));if(e==null||e._reactInternals===void 0)throw Error(Sr(38));return yE(e,t,r,!1,i)};qc.version="18.3.1-next-f1338f8080-20240426";function WJ(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(WJ)}catch(e){console.error(e)}}WJ(),WY.exports=qc;var tg=WY.exports;const KJ=Vi(tg);var A9=tg;FR.createRoot=A9.createRoot,FR.hydrateRoot=A9.hydrateRoot;var vE=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},bE=typeof window>"u"||"Deno"in globalThis;function rd(){}function Txe(e,t){return typeof e=="function"?e(t):e}function kxe(e){return typeof e=="number"&&e>=0&&e!==1/0}function Pxe(e,t){return Math.max(e+(t||0)-Date.now(),0)}function T9(e,t){return typeof e=="function"?e(t):e}function Exe(e,t){return typeof e=="function"?e(t):e}function k9(e,t){const{type:r="all",exact:i,fetchStatus:a,predicate:l,queryKey:d,stale:s}=e;if(d){if(i){if(t.queryHash!==jF(d,t.options))return!1}else if(!g2(t.queryKey,d))return!1}if(r!=="all"){const p=t.isActive();if(r==="active"&&!p||r==="inactive"&&p)return!1}return!(typeof s=="boolean"&&t.isStale()!==s||a&&a!==t.state.fetchStatus||l&&!l(t))}function P9(e,t){const{exact:r,status:i,predicate:a,mutationKey:l}=e;if(l){if(!t.options.mutationKey)return!1;if(r){if(p2(t.options.mutationKey)!==p2(l))return!1}else if(!g2(t.options.mutationKey,l))return!1}return!(i&&t.state.status!==i||a&&!a(t))}function jF(e,t){return((t==null?void 0:t.queryKeyHashFn)||p2)(e)}function p2(e){return JSON.stringify(e,(t,r)=>MD(r)?Object.keys(r).sort().reduce((i,a)=>(i[a]=r[a],i),{}):r)}function g2(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?!Object.keys(t).some(r=>!g2(e[r],t[r])):!1}function ZJ(e,t){if(e===t)return e;const r=E9(e)&&E9(t);if(r||MD(e)&&MD(t)){const i=r?e:Object.keys(e),a=i.length,l=r?t:Object.keys(t),d=l.length,s=r?[]:{};let p=0;for(let x=0;x<d;x++){const w=r?x:l[x];(!r&&i.includes(w)||r)&&e[w]===void 0&&t[w]===void 0?(s[w]=void 0,p++):(s[w]=ZJ(e[w],t[w]),s[w]===e[w]&&e[w]!==void 0&&p++)}return a===d&&p===a?e:s}return t}function E9(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function MD(e){if(!M9(e))return!1;const t=e.constructor;if(t===void 0)return!0;const r=t.prototype;return!(!M9(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function M9(e){return Object.prototype.toString.call(e)==="[object Object]"}function Mxe(e){return new Promise(t=>{setTimeout(t,e)})}function Ixe(e,t,r){return typeof r.structuralSharing=="function"?r.structuralSharing(e,t):r.structuralSharing!==!1?ZJ(e,t):t}function Oxe(e,t,r=0){const i=[...e,t];return r&&i.length>r?i.slice(1):i}function Rxe(e,t,r=0){const i=[t,...e];return r&&i.length>r?i.slice(0,-1):i}var NF=Symbol();function YJ(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===NF?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}var D0,mp,Wv,AY,Dxe=(AY=class extends vE{constructor(){super();rs(this,D0);rs(this,mp);rs(this,Wv);ci(this,Wv,t=>{if(!bE&&window.addEventListener){const r=()=>t();return window.addEventListener("visibilitychange",r,!1),()=>{window.removeEventListener("visibilitychange",r)}}})}onSubscribe(){dr(this,mp)||this.setEventListener(dr(this,Wv))}onUnsubscribe(){var t;this.hasListeners()||((t=dr(this,mp))==null||t.call(this),ci(this,mp,void 0))}setEventListener(t){var r;ci(this,Wv,t),(r=dr(this,mp))==null||r.call(this),ci(this,mp,t(i=>{typeof i=="boolean"?this.setFocused(i):this.onFocus()}))}setFocused(t){dr(this,D0)!==t&&(ci(this,D0,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(r=>{r(t)})}isFocused(){var t;return typeof dr(this,D0)=="boolean"?dr(this,D0):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},D0=new WeakMap,mp=new WeakMap,Wv=new WeakMap,AY),XJ=new Dxe,Kv,fp,Zv,TY,zxe=(TY=class extends vE{constructor(){super();rs(this,Kv,!0);rs(this,fp);rs(this,Zv);ci(this,Zv,t=>{if(!bE&&window.addEventListener){const r=()=>t(!0),i=()=>t(!1);return window.addEventListener("online",r,!1),window.addEventListener("offline",i,!1),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",i)}}})}onSubscribe(){dr(this,fp)||this.setEventListener(dr(this,Zv))}onUnsubscribe(){var t;this.hasListeners()||((t=dr(this,fp))==null||t.call(this),ci(this,fp,void 0))}setEventListener(t){var r;ci(this,Zv,t),(r=dr(this,fp))==null||r.call(this),ci(this,fp,t(this.setOnline.bind(this)))}setOnline(t){dr(this,Kv)!==t&&(ci(this,Kv,t),this.listeners.forEach(i=>{i(t)}))}isOnline(){return dr(this,Kv)}},Kv=new WeakMap,fp=new WeakMap,Zv=new WeakMap,TY),ck=new zxe;function Lxe(){let e,t;const r=new Promise((a,l)=>{e=a,t=l});r.status="pending",r.catch(()=>{});function i(a){Object.assign(r,a),delete r.resolve,delete r.reject}return r.resolve=a=>{i({status:"fulfilled",value:a}),e(a)},r.reject=a=>{i({status:"rejected",reason:a}),t(a)},r}function Fxe(e){return Math.min(1e3*2**e,3e4)}function JJ(e){return(e??"online")==="online"?ck.isOnline():!0}var QJ=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function oO(e){return e instanceof QJ}function eQ(e){let t=!1,r=0,i=!1,a;const l=Lxe(),d=L=>{var B;i||(S(new QJ(L)),(B=e.abort)==null||B.call(e))},s=()=>{t=!0},p=()=>{t=!1},x=()=>XJ.isFocused()&&(e.networkMode==="always"||ck.isOnline())&&e.canRun(),w=()=>JJ(e.networkMode)&&e.canRun(),j=L=>{var B;i||(i=!0,(B=e.onSuccess)==null||B.call(e,L),a==null||a(),l.resolve(L))},S=L=>{var B;i||(i=!0,(B=e.onError)==null||B.call(e,L),a==null||a(),l.reject(L))},P=()=>new Promise(L=>{var B;a=V=>{(i||x())&&L(V)},(B=e.onPause)==null||B.call(e)}).then(()=>{var L;a=void 0,i||(L=e.onContinue)==null||L.call(e)}),F=()=>{if(i)return;let L;const B=r===0?e.initialPromise:void 0;try{L=B??e.fn()}catch(V){L=Promise.reject(V)}Promise.resolve(L).then(j).catch(V=>{var se;if(i)return;const $=e.retry??(bE?0:3),G=e.retryDelay??Fxe,W=typeof G=="function"?G(r,V):G,Z=$===!0||typeof $=="number"&&r<$||typeof $=="function"&&$(r,V);if(t||!Z){S(V);return}r++,(se=e.onFail)==null||se.call(e,r,V),Mxe(W).then(()=>x()?void 0:P()).then(()=>{t?S(V):F()})})};return{promise:l,cancel:d,continue:()=>(a==null||a(),l),cancelRetry:s,continueRetry:p,canStart:w,start:()=>(w()?F():P().then(F),l)}}function Bxe(){let e=[],t=0,r=s=>{s()},i=s=>{s()},a=s=>setTimeout(s,0);const l=s=>{t?e.push(s):a(()=>{r(s)})},d=()=>{const s=e;e=[],s.length&&a(()=>{i(()=>{s.forEach(p=>{r(p)})})})};return{batch:s=>{let p;t++;try{p=s()}finally{t--,t||d()}return p},batchCalls:s=>(...p)=>{l(()=>{s(...p)})},schedule:l,setNotifyFunction:s=>{r=s},setBatchNotifyFunction:s=>{i=s},setScheduler:s=>{a=s}}}var vl=Bxe(),z0,kY,tQ=(kY=class{constructor(){rs(this,z0)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),kxe(this.gcTime)&&ci(this,z0,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(bE?1/0:5*60*1e3))}clearGcTimeout(){dr(this,z0)&&(clearTimeout(dr(this,z0)),ci(this,z0,void 0))}},z0=new WeakMap,kY),Yv,Xv,uu,Go,MN,L0,nd,im,PY,$xe=(PY=class extends tQ{constructor(t){super();rs(this,nd);rs(this,Yv);rs(this,Xv);rs(this,uu);rs(this,Go);rs(this,MN);rs(this,L0);ci(this,L0,!1),ci(this,MN,t.defaultOptions),this.setOptions(t.options),this.observers=[],ci(this,uu,t.cache),this.queryKey=t.queryKey,this.queryHash=t.queryHash,ci(this,Yv,Uxe(this.options)),this.state=t.state??dr(this,Yv),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=dr(this,Go))==null?void 0:t.promise}setOptions(t){this.options={...dr(this,MN),...t},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&dr(this,uu).remove(this)}setData(t,r){const i=Ixe(this.state.data,t,this.options);return $o(this,nd,im).call(this,{data:i,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),i}setState(t,r){$o(this,nd,im).call(this,{type:"setState",state:t,setStateOptions:r})}cancel(t){var i,a;const r=(i=dr(this,Go))==null?void 0:i.promise;return(a=dr(this,Go))==null||a.cancel(t),r?r.then(rd).catch(rd):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(dr(this,Yv))}isActive(){return this.observers.some(t=>Exe(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===NF||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStale(){return this.state.isInvalidated?!0:this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0}isStaleByTime(t=0){return this.state.isInvalidated||this.state.data===void 0||!Pxe(this.state.dataUpdatedAt,t)}onFocus(){var r;const t=this.observers.find(i=>i.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(r=dr(this,Go))==null||r.continue()}onOnline(){var r;const t=this.observers.find(i=>i.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(r=dr(this,Go))==null||r.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),dr(this,uu).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(r=>r!==t),this.observers.length||(dr(this,Go)&&(dr(this,L0)?dr(this,Go).cancel({revert:!0}):dr(this,Go).cancelRetry()),this.scheduleGc()),dr(this,uu).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||$o(this,nd,im).call(this,{type:"invalidate"})}fetch(t,r){var p,x,w;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(dr(this,Go))return dr(this,Go).continueRetry(),dr(this,Go).promise}if(t&&this.setOptions(t),!this.options.queryFn){const j=this.observers.find(S=>S.options.queryFn);j&&this.setOptions(j.options)}const i=new AbortController,a=j=>{Object.defineProperty(j,"signal",{enumerable:!0,get:()=>(ci(this,L0,!0),i.signal)})},l=()=>{const j=YJ(this.options,r),S={queryKey:this.queryKey,meta:this.meta};return a(S),ci(this,L0,!1),this.options.persister?this.options.persister(j,S,this):j(S)},d={fetchOptions:r,options:this.options,queryKey:this.queryKey,state:this.state,fetchFn:l};a(d),(p=this.options.behavior)==null||p.onFetch(d,this),ci(this,Xv,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((x=d.fetchOptions)==null?void 0:x.meta))&&$o(this,nd,im).call(this,{type:"fetch",meta:(w=d.fetchOptions)==null?void 0:w.meta});const s=j=>{var S,P,F,L;oO(j)&&j.silent||$o(this,nd,im).call(this,{type:"error",error:j}),oO(j)||((P=(S=dr(this,uu).config).onError)==null||P.call(S,j,this),(L=(F=dr(this,uu).config).onSettled)==null||L.call(F,this.state.data,j,this)),this.scheduleGc()};return ci(this,Go,eQ({initialPromise:r==null?void 0:r.initialPromise,fn:d.fetchFn,abort:i.abort.bind(i),onSuccess:j=>{var S,P,F,L;if(j===void 0){s(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(j)}catch(B){s(B);return}(P=(S=dr(this,uu).config).onSuccess)==null||P.call(S,j,this),(L=(F=dr(this,uu).config).onSettled)==null||L.call(F,j,this.state.error,this),this.scheduleGc()},onError:s,onFail:(j,S)=>{$o(this,nd,im).call(this,{type:"failed",failureCount:j,error:S})},onPause:()=>{$o(this,nd,im).call(this,{type:"pause"})},onContinue:()=>{$o(this,nd,im).call(this,{type:"continue"})},retry:d.options.retry,retryDelay:d.options.retryDelay,networkMode:d.options.networkMode,canRun:()=>!0})),dr(this,Go).start()}},Yv=new WeakMap,Xv=new WeakMap,uu=new WeakMap,Go=new WeakMap,MN=new WeakMap,L0=new WeakMap,nd=new WeakSet,im=function(t){const r=i=>{switch(t.type){case"failed":return{...i,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...i,fetchStatus:"paused"};case"continue":return{...i,fetchStatus:"fetching"};case"fetch":return{...i,...Vxe(i.data,this.options),fetchMeta:t.meta??null};case"success":return{...i,data:t.data,dataUpdateCount:i.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const a=t.error;return oO(a)&&a.revert&&dr(this,Xv)?{...dr(this,Xv),fetchStatus:"idle"}:{...i,error:a,errorUpdateCount:i.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:i.fetchFailureCount+1,fetchFailureReason:a,fetchStatus:"idle",status:"error"};case"invalidate":return{...i,isInvalidated:!0};case"setState":return{...i,...t.state}}};this.state=r(this.state),vl.batch(()=>{this.observers.forEach(i=>{i.onQueryUpdate()}),dr(this,uu).notify({query:this,type:"updated",action:t})})},PY);function Vxe(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:JJ(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function Uxe(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,r=t!==void 0,i=r?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:r?i??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}var Jd,EY,Gxe=(EY=class extends vE{constructor(t={}){super();rs(this,Jd);this.config=t,ci(this,Jd,new Map)}build(t,r,i){const a=r.queryKey,l=r.queryHash??jF(a,r);let d=this.get(l);return d||(d=new $xe({cache:this,queryKey:a,queryHash:l,options:t.defaultQueryOptions(r),state:i,defaultOptions:t.getQueryDefaults(a)}),this.add(d)),d}add(t){dr(this,Jd).has(t.queryHash)||(dr(this,Jd).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const r=dr(this,Jd).get(t.queryHash);r&&(t.destroy(),r===t&&dr(this,Jd).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){vl.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return dr(this,Jd).get(t)}getAll(){return[...dr(this,Jd).values()]}find(t){const r={exact:!0,...t};return this.getAll().find(i=>k9(r,i))}findAll(t={}){const r=this.getAll();return Object.keys(t).length>0?r.filter(i=>k9(t,i)):r}notify(t){vl.batch(()=>{this.listeners.forEach(r=>{r(t)})})}onFocus(){vl.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){vl.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},Jd=new WeakMap,EY),Qd,pl,F0,eh,Kf,MY,Hxe=(MY=class extends tQ{constructor(t){super();rs(this,eh);rs(this,Qd);rs(this,pl);rs(this,F0);this.mutationId=t.mutationId,ci(this,pl,t.mutationCache),ci(this,Qd,[]),this.state=t.state||qxe(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){dr(this,Qd).includes(t)||(dr(this,Qd).push(t),this.clearGcTimeout(),dr(this,pl).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){ci(this,Qd,dr(this,Qd).filter(r=>r!==t)),this.scheduleGc(),dr(this,pl).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){dr(this,Qd).length||(this.state.status==="pending"?this.scheduleGc():dr(this,pl).remove(this))}continue(){var t;return((t=dr(this,F0))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var a,l,d,s,p,x,w,j,S,P,F,L,B,V,$,G,W,Z,se,ae;ci(this,F0,eQ({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(new Error("No mutationFn found")),onFail:(ce,Pe)=>{$o(this,eh,Kf).call(this,{type:"failed",failureCount:ce,error:Pe})},onPause:()=>{$o(this,eh,Kf).call(this,{type:"pause"})},onContinue:()=>{$o(this,eh,Kf).call(this,{type:"continue"})},retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>dr(this,pl).canRun(this)}));const r=this.state.status==="pending",i=!dr(this,F0).canStart();try{if(!r){$o(this,eh,Kf).call(this,{type:"pending",variables:t,isPaused:i}),await((l=(a=dr(this,pl).config).onMutate)==null?void 0:l.call(a,t,this));const Pe=await((s=(d=this.options).onMutate)==null?void 0:s.call(d,t));Pe!==this.state.context&&$o(this,eh,Kf).call(this,{type:"pending",context:Pe,variables:t,isPaused:i})}const ce=await dr(this,F0).start();return await((x=(p=dr(this,pl).config).onSuccess)==null?void 0:x.call(p,ce,t,this.state.context,this)),await((j=(w=this.options).onSuccess)==null?void 0:j.call(w,ce,t,this.state.context)),await((P=(S=dr(this,pl).config).onSettled)==null?void 0:P.call(S,ce,null,this.state.variables,this.state.context,this)),await((L=(F=this.options).onSettled)==null?void 0:L.call(F,ce,null,t,this.state.context)),$o(this,eh,Kf).call(this,{type:"success",data:ce}),ce}catch(ce){try{throw await((V=(B=dr(this,pl).config).onError)==null?void 0:V.call(B,ce,t,this.state.context,this)),await((G=($=this.options).onError)==null?void 0:G.call($,ce,t,this.state.context)),await((Z=(W=dr(this,pl).config).onSettled)==null?void 0:Z.call(W,void 0,ce,this.state.variables,this.state.context,this)),await((ae=(se=this.options).onSettled)==null?void 0:ae.call(se,void 0,ce,t,this.state.context)),ce}finally{$o(this,eh,Kf).call(this,{type:"error",error:ce})}}finally{dr(this,pl).runNext(this)}}},Qd=new WeakMap,pl=new WeakMap,F0=new WeakMap,eh=new WeakSet,Kf=function(t){const r=i=>{switch(t.type){case"failed":return{...i,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...i,isPaused:!0};case"continue":return{...i,isPaused:!1};case"pending":return{...i,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...i,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...i,data:void 0,error:t.error,failureCount:i.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=r(this.state),vl.batch(()=>{dr(this,Qd).forEach(i=>{i.onMutationUpdate(t)}),dr(this,pl).notify({mutation:this,type:"updated",action:t})})},MY);function qxe(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var bc,IN,IY,Wxe=(IY=class extends vE{constructor(t={}){super();rs(this,bc);rs(this,IN);this.config=t,ci(this,bc,new Map),ci(this,IN,Date.now())}build(t,r,i){const a=new Hxe({mutationCache:this,mutationId:++hA(this,IN)._,options:t.defaultMutationOptions(r),state:i});return this.add(a),a}add(t){const r=PA(t),i=dr(this,bc).get(r)??[];i.push(t),dr(this,bc).set(r,i),this.notify({type:"added",mutation:t})}remove(t){var i;const r=PA(t);if(dr(this,bc).has(r)){const a=(i=dr(this,bc).get(r))==null?void 0:i.filter(l=>l!==t);a&&(a.length===0?dr(this,bc).delete(r):dr(this,bc).set(r,a))}this.notify({type:"removed",mutation:t})}canRun(t){var i;const r=(i=dr(this,bc).get(PA(t)))==null?void 0:i.find(a=>a.state.status==="pending");return!r||r===t}runNext(t){var i;const r=(i=dr(this,bc).get(PA(t)))==null?void 0:i.find(a=>a!==t&&a.state.isPaused);return(r==null?void 0:r.continue())??Promise.resolve()}clear(){vl.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}getAll(){return[...dr(this,bc).values()].flat()}find(t){const r={exact:!0,...t};return this.getAll().find(i=>P9(r,i))}findAll(t={}){return this.getAll().filter(r=>P9(t,r))}notify(t){vl.batch(()=>{this.listeners.forEach(r=>{r(t)})})}resumePausedMutations(){const t=this.getAll().filter(r=>r.state.isPaused);return vl.batch(()=>Promise.all(t.map(r=>r.continue().catch(rd))))}},bc=new WeakMap,IN=new WeakMap,IY);function PA(e){var t;return((t=e.options.scope)==null?void 0:t.id)??String(e.mutationId)}function I9(e){return{onFetch:(t,r)=>{var w,j,S,P,F;const i=t.options,a=(S=(j=(w=t.fetchOptions)==null?void 0:w.meta)==null?void 0:j.fetchMore)==null?void 0:S.direction,l=((P=t.state.data)==null?void 0:P.pages)||[],d=((F=t.state.data)==null?void 0:F.pageParams)||[];let s={pages:[],pageParams:[]},p=0;const x=async()=>{let L=!1;const B=G=>{Object.defineProperty(G,"signal",{enumerable:!0,get:()=>(t.signal.aborted?L=!0:t.signal.addEventListener("abort",()=>{L=!0}),t.signal)})},V=YJ(t.options,t.fetchOptions),$=async(G,W,Z)=>{if(L)return Promise.reject();if(W==null&&G.pages.length)return Promise.resolve(G);const se={queryKey:t.queryKey,pageParam:W,direction:Z?"backward":"forward",meta:t.options.meta};B(se);const ae=await V(se),{maxPages:ce}=t.options,Pe=Z?Rxe:Oxe;return{pages:Pe(G.pages,ae,ce),pageParams:Pe(G.pageParams,W,ce)}};if(a&&l.length){const G=a==="backward",W=G?Kxe:O9,Z={pages:l,pageParams:d},se=W(i,Z);s=await $(Z,se,G)}else{const G=e??l.length;do{const W=p===0?d[0]??i.initialPageParam:O9(i,s);if(p>0&&W==null)break;s=await $(s,W),p++}while(p<G)}return s};t.options.persister?t.fetchFn=()=>{var L,B;return(B=(L=t.options).persister)==null?void 0:B.call(L,x,{queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},r)}:t.fetchFn=x}}}function O9(e,{pages:t,pageParams:r}){const i=t.length-1;return t.length>0?e.getNextPageParam(t[i],t,r[i],r):void 0}function Kxe(e,{pages:t,pageParams:r}){var i;return t.length>0?(i=e.getPreviousPageParam)==null?void 0:i.call(e,t[0],t,r[0],r):void 0}var da,pp,gp,Jv,Qv,xp,eb,tb,OY,Zxe=(OY=class{constructor(e={}){rs(this,da);rs(this,pp);rs(this,gp);rs(this,Jv);rs(this,Qv);rs(this,xp);rs(this,eb);rs(this,tb);ci(this,da,e.queryCache||new Gxe),ci(this,pp,e.mutationCache||new Wxe),ci(this,gp,e.defaultOptions||{}),ci(this,Jv,new Map),ci(this,Qv,new Map),ci(this,xp,0)}mount(){hA(this,xp)._++,dr(this,xp)===1&&(ci(this,eb,XJ.subscribe(async e=>{e&&(await this.resumePausedMutations(),dr(this,da).onFocus())})),ci(this,tb,ck.subscribe(async e=>{e&&(await this.resumePausedMutations(),dr(this,da).onOnline())})))}unmount(){var e,t;hA(this,xp)._--,dr(this,xp)===0&&((e=dr(this,eb))==null||e.call(this),ci(this,eb,void 0),(t=dr(this,tb))==null||t.call(this),ci(this,tb,void 0))}isFetching(e){return dr(this,da).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return dr(this,pp).findAll({...e,status:"pending"}).length}getQueryData(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=dr(this,da).get(t.queryHash))==null?void 0:r.state.data}ensureQueryData(e){const t=this.getQueryData(e.queryKey);if(t===void 0)return this.fetchQuery(e);{const r=this.defaultQueryOptions(e),i=dr(this,da).build(this,r);return e.revalidateIfStale&&i.isStaleByTime(T9(r.staleTime,i))&&this.prefetchQuery(r),Promise.resolve(t)}}getQueriesData(e){return dr(this,da).findAll(e).map(({queryKey:t,state:r})=>{const i=r.data;return[t,i]})}setQueryData(e,t,r){const i=this.defaultQueryOptions({queryKey:e}),a=dr(this,da).get(i.queryHash),l=a==null?void 0:a.state.data,d=Txe(t,l);if(d!==void 0)return dr(this,da).build(this,i).setData(d,{...r,manual:!0})}setQueriesData(e,t,r){return vl.batch(()=>dr(this,da).findAll(e).map(({queryKey:i})=>[i,this.setQueryData(i,t,r)]))}getQueryState(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=dr(this,da).get(t.queryHash))==null?void 0:r.state}removeQueries(e){const t=dr(this,da);vl.batch(()=>{t.findAll(e).forEach(r=>{t.remove(r)})})}resetQueries(e,t){const r=dr(this,da),i={type:"active",...e};return vl.batch(()=>(r.findAll(e).forEach(a=>{a.reset()}),this.refetchQueries(i,t)))}cancelQueries(e={},t={}){const r={revert:!0,...t},i=vl.batch(()=>dr(this,da).findAll(e).map(a=>a.cancel(r)));return Promise.all(i).then(rd).catch(rd)}invalidateQueries(e={},t={}){return vl.batch(()=>{if(dr(this,da).findAll(e).forEach(i=>{i.invalidate()}),e.refetchType==="none")return Promise.resolve();const r={...e,type:e.refetchType??e.type??"active"};return this.refetchQueries(r,t)})}refetchQueries(e={},t){const r={...t,cancelRefetch:(t==null?void 0:t.cancelRefetch)??!0},i=vl.batch(()=>dr(this,da).findAll(e).filter(a=>!a.isDisabled()).map(a=>{let l=a.fetch(void 0,r);return r.throwOnError||(l=l.catch(rd)),a.state.fetchStatus==="paused"?Promise.resolve():l}));return Promise.all(i).then(rd)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const r=dr(this,da).build(this,t);return r.isStaleByTime(T9(t.staleTime,r))?r.fetch(t):Promise.resolve(r.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(rd).catch(rd)}fetchInfiniteQuery(e){return e.behavior=I9(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(rd).catch(rd)}ensureInfiniteQueryData(e){return e.behavior=I9(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return ck.isOnline()?dr(this,pp).resumePausedMutations():Promise.resolve()}getQueryCache(){return dr(this,da)}getMutationCache(){return dr(this,pp)}getDefaultOptions(){return dr(this,gp)}setDefaultOptions(e){ci(this,gp,e)}setQueryDefaults(e,t){dr(this,Jv).set(p2(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...dr(this,Jv).values()];let r={};return t.forEach(i=>{g2(e,i.queryKey)&&(r={...r,...i.defaultOptions})}),r}setMutationDefaults(e,t){dr(this,Qv).set(p2(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...dr(this,Qv).values()];let r={};return t.forEach(i=>{g2(e,i.mutationKey)&&(r={...r,...i.defaultOptions})}),r}defaultQueryOptions(e){if(e._defaulted)return e;const t={...dr(this,gp).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=jF(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.enabled!==!0&&t.queryFn===NF&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...dr(this,gp).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){dr(this,da).clear(),dr(this,pp).clear()}},da=new WeakMap,pp=new WeakMap,gp=new WeakMap,Jv=new WeakMap,Qv=new WeakMap,xp=new WeakMap,eb=new WeakMap,tb=new WeakMap,OY),Yxe=U.createContext(void 0),Xxe=({client:e,children:t})=>(U.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),n.jsx(Yxe.Provider,{value:e,children:t}));function _r(e,t,{checkForDefaultPrevented:r=!0}={}){return function(a){if(e==null||e(a),r===!1||!a.defaultPrevented)return t==null?void 0:t(a)}}function Jxe(e,t){typeof e=="function"?e(t):e!=null&&(e.current=t)}function _E(...e){return t=>e.forEach(r=>Jxe(r,t))}function Mn(...e){return U.useCallback(_E(...e),e)}function Qxe(e,t=[]){let r=[];function i(l,d){const s=U.createContext(d),p=r.length;r=[...r,d];function x(j){const{scope:S,children:P,...F}=j,L=(S==null?void 0:S[e][p])||s,B=U.useMemo(()=>F,Object.values(F));return n.jsx(L.Provider,{value:B,children:P})}function w(j,S){const P=(S==null?void 0:S[e][p])||s,F=U.useContext(P);if(F)return F;if(d!==void 0)return d;throw new Error(`\`${j}\` must be used within \`${l}\``)}return x.displayName=l+"Provider",[x,w]}const a=()=>{const l=r.map(d=>U.createContext(d));return function(s){const p=(s==null?void 0:s[e])||l;return U.useMemo(()=>({[`__scope${e}`]:{...s,[e]:p}}),[s,p])}};return a.scopeName=e,[i,eye(a,...t)]}function eye(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const i=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(l){const d=i.reduce((s,{useScope:p,scopeName:x})=>{const j=p(l)[`__scope${x}`];return{...s,...j}},{});return U.useMemo(()=>({[`__scope${t.scopeName}`]:d}),[d])}};return r.scopeName=t.scopeName,r}var Al=U.forwardRef((e,t)=>{const{children:r,...i}=e,a=U.Children.toArray(r),l=a.find(tye);if(l){const d=l.props.children,s=a.map(p=>p===l?U.Children.count(d)>1?U.Children.only(null):U.isValidElement(d)?d.props.children:null:p);return n.jsx(ID,{...i,ref:t,children:U.isValidElement(d)?U.cloneElement(d,void 0,s):null})}return n.jsx(ID,{...i,ref:t,children:r})});Al.displayName="Slot";var ID=U.forwardRef((e,t)=>{const{children:r,...i}=e;if(U.isValidElement(r)){const a=nye(r);return U.cloneElement(r,{...rye(i,r.props),ref:t?_E(t,a):a})}return U.Children.count(r)>1?U.Children.only(null):null});ID.displayName="SlotClone";var SF=({children:e})=>n.jsx(n.Fragment,{children:e});function tye(e){return U.isValidElement(e)&&e.type===SF}function rye(e,t){const r={...t};for(const i in t){const a=e[i],l=t[i];/^on[A-Z]/.test(i)?a&&l?r[i]=(...s)=>{l(...s),a(...s)}:a&&(r[i]=a):i==="style"?r[i]={...a,...l}:i==="className"&&(r[i]=[a,l].filter(Boolean).join(" "))}return{...e,...r}}function nye(e){var i,a;let t=(i=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:i.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}function d_(e){const t=e+"CollectionProvider",[r,i]=Qxe(t),[a,l]=r(t,{collectionRef:{current:null},itemMap:new Map}),d=P=>{const{scope:F,children:L}=P,B=ke.useRef(null),V=ke.useRef(new Map).current;return n.jsx(a,{scope:F,itemMap:V,collectionRef:B,children:L})};d.displayName=t;const s=e+"CollectionSlot",p=ke.forwardRef((P,F)=>{const{scope:L,children:B}=P,V=l(s,L),$=Mn(F,V.collectionRef);return n.jsx(Al,{ref:$,children:B})});p.displayName=s;const x=e+"CollectionItemSlot",w="data-radix-collection-item",j=ke.forwardRef((P,F)=>{const{scope:L,children:B,...V}=P,$=ke.useRef(null),G=Mn(F,$),W=l(x,L);return ke.useEffect(()=>(W.itemMap.set($,{ref:$,...V}),()=>void W.itemMap.delete($))),n.jsx(Al,{[w]:"",ref:G,children:B})});j.displayName=x;function S(P){const F=l(e+"CollectionConsumer",P);return ke.useCallback(()=>{const B=F.collectionRef.current;if(!B)return[];const V=Array.from(B.querySelectorAll(`[${w}]`));return Array.from(F.itemMap.values()).sort((W,Z)=>V.indexOf(W.ref.current)-V.indexOf(Z.ref.current))},[F.collectionRef,F.itemMap])}return[{Provider:d,Slot:p,ItemSlot:j},S,i]}function iye(e,t){const r=U.createContext(t),i=l=>{const{children:d,...s}=l,p=U.useMemo(()=>s,Object.values(s));return n.jsx(r.Provider,{value:p,children:d})};i.displayName=e+"Provider";function a(l){const d=U.useContext(r);if(d)return d;if(t!==void 0)return t;throw new Error(`\`${l}\` must be used within \`${e}\``)}return[i,a]}function Jo(e,t=[]){let r=[];function i(l,d){const s=U.createContext(d),p=r.length;r=[...r,d];const x=j=>{var V;const{scope:S,children:P,...F}=j,L=((V=S==null?void 0:S[e])==null?void 0:V[p])||s,B=U.useMemo(()=>F,Object.values(F));return n.jsx(L.Provider,{value:B,children:P})};x.displayName=l+"Provider";function w(j,S){var L;const P=((L=S==null?void 0:S[e])==null?void 0:L[p])||s,F=U.useContext(P);if(F)return F;if(d!==void 0)return d;throw new Error(`\`${j}\` must be used within \`${l}\``)}return[x,w]}const a=()=>{const l=r.map(d=>U.createContext(d));return function(s){const p=(s==null?void 0:s[e])||l;return U.useMemo(()=>({[`__scope${e}`]:{...s,[e]:p}}),[s,p])}};return a.scopeName=e,[i,sye(a,...t)]}function sye(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const i=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(l){const d=i.reduce((s,{useScope:p,scopeName:x})=>{const j=p(l)[`__scope${x}`];return{...s,...j}},{});return U.useMemo(()=>({[`__scope${t.scopeName}`]:d}),[d])}};return r.scopeName=t.scopeName,r}var aye=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],Hr=aye.reduce((e,t)=>{const r=U.forwardRef((i,a)=>{const{asChild:l,...d}=i,s=l?Al:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),n.jsx(s,{...d,ref:a})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{});function CF(e,t){e&&tg.flushSync(()=>e.dispatchEvent(t))}function Ws(e){const t=U.useRef(e);return U.useEffect(()=>{t.current=e}),U.useMemo(()=>(...r)=>{var i;return(i=t.current)==null?void 0:i.call(t,...r)},[])}function oye(e,t=globalThis==null?void 0:globalThis.document){const r=Ws(e);U.useEffect(()=>{const i=a=>{a.key==="Escape"&&r(a)};return t.addEventListener("keydown",i,{capture:!0}),()=>t.removeEventListener("keydown",i,{capture:!0})},[r,t])}var lye="DismissableLayer",OD="dismissableLayer.update",cye="dismissableLayer.pointerDownOutside",uye="dismissableLayer.focusOutside",R9,rQ=U.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),yx=U.forwardRef((e,t)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:i,onPointerDownOutside:a,onFocusOutside:l,onInteractOutside:d,onDismiss:s,...p}=e,x=U.useContext(rQ),[w,j]=U.useState(null),S=(w==null?void 0:w.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,P]=U.useState({}),F=Mn(t,ae=>j(ae)),L=Array.from(x.layers),[B]=[...x.layersWithOutsidePointerEventsDisabled].slice(-1),V=L.indexOf(B),$=w?L.indexOf(w):-1,G=x.layersWithOutsidePointerEventsDisabled.size>0,W=$>=V,Z=hye(ae=>{const ce=ae.target,Pe=[...x.branches].some(we=>we.contains(ce));!W||Pe||(a==null||a(ae),d==null||d(ae),ae.defaultPrevented||s==null||s())},S),se=mye(ae=>{const ce=ae.target;[...x.branches].some(we=>we.contains(ce))||(l==null||l(ae),d==null||d(ae),ae.defaultPrevented||s==null||s())},S);return oye(ae=>{$===x.layers.size-1&&(i==null||i(ae),!ae.defaultPrevented&&s&&(ae.preventDefault(),s()))},S),U.useEffect(()=>{if(w)return r&&(x.layersWithOutsidePointerEventsDisabled.size===0&&(R9=S.body.style.pointerEvents,S.body.style.pointerEvents="none"),x.layersWithOutsidePointerEventsDisabled.add(w)),x.layers.add(w),D9(),()=>{r&&x.layersWithOutsidePointerEventsDisabled.size===1&&(S.body.style.pointerEvents=R9)}},[w,S,r,x]),U.useEffect(()=>()=>{w&&(x.layers.delete(w),x.layersWithOutsidePointerEventsDisabled.delete(w),D9())},[w,x]),U.useEffect(()=>{const ae=()=>P({});return document.addEventListener(OD,ae),()=>document.removeEventListener(OD,ae)},[]),n.jsx(Hr.div,{...p,ref:F,style:{pointerEvents:G?W?"auto":"none":void 0,...e.style},onFocusCapture:_r(e.onFocusCapture,se.onFocusCapture),onBlurCapture:_r(e.onBlurCapture,se.onBlurCapture),onPointerDownCapture:_r(e.onPointerDownCapture,Z.onPointerDownCapture)})});yx.displayName=lye;var dye="DismissableLayerBranch",nQ=U.forwardRef((e,t)=>{const r=U.useContext(rQ),i=U.useRef(null),a=Mn(t,i);return U.useEffect(()=>{const l=i.current;if(l)return r.branches.add(l),()=>{r.branches.delete(l)}},[r.branches]),n.jsx(Hr.div,{...e,ref:a})});nQ.displayName=dye;function hye(e,t=globalThis==null?void 0:globalThis.document){const r=Ws(e),i=U.useRef(!1),a=U.useRef(()=>{});return U.useEffect(()=>{const l=s=>{if(s.target&&!i.current){let p=function(){iQ(cye,r,x,{discrete:!0})};const x={originalEvent:s};s.pointerType==="touch"?(t.removeEventListener("click",a.current),a.current=p,t.addEventListener("click",a.current,{once:!0})):p()}else t.removeEventListener("click",a.current);i.current=!1},d=window.setTimeout(()=>{t.addEventListener("pointerdown",l)},0);return()=>{window.clearTimeout(d),t.removeEventListener("pointerdown",l),t.removeEventListener("click",a.current)}},[t,r]),{onPointerDownCapture:()=>i.current=!0}}function mye(e,t=globalThis==null?void 0:globalThis.document){const r=Ws(e),i=U.useRef(!1);return U.useEffect(()=>{const a=l=>{l.target&&!i.current&&iQ(uye,r,{originalEvent:l},{discrete:!1})};return t.addEventListener("focusin",a),()=>t.removeEventListener("focusin",a)},[t,r]),{onFocusCapture:()=>i.current=!0,onBlurCapture:()=>i.current=!1}}function D9(){const e=new CustomEvent(OD);document.dispatchEvent(e)}function iQ(e,t,r,{discrete:i}){const a=r.originalEvent.target,l=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:r});t&&a.addEventListener(e,t,{once:!0}),i?CF(a,l):a.dispatchEvent(l)}var fye=yx,pye=nQ,Ba=globalThis!=null&&globalThis.document?U.useLayoutEffect:()=>{},gye="Portal",h_=U.forwardRef((e,t)=>{var s;const{container:r,...i}=e,[a,l]=U.useState(!1);Ba(()=>l(!0),[]);const d=r||a&&((s=globalThis==null?void 0:globalThis.document)==null?void 0:s.body);return d?KJ.createPortal(n.jsx(Hr.div,{...i,ref:t}),d):null});h_.displayName=gye;function xye(e,t){return U.useReducer((r,i)=>t[r][i]??r,e)}var io=e=>{const{present:t,children:r}=e,i=yye(t),a=typeof r=="function"?r({present:i.isPresent}):U.Children.only(r),l=Mn(i.ref,vye(a));return typeof r=="function"||i.isPresent?U.cloneElement(a,{ref:l}):null};io.displayName="Presence";function yye(e){const[t,r]=U.useState(),i=U.useRef({}),a=U.useRef(e),l=U.useRef("none"),d=e?"mounted":"unmounted",[s,p]=xye(d,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return U.useEffect(()=>{const x=EA(i.current);l.current=s==="mounted"?x:"none"},[s]),Ba(()=>{const x=i.current,w=a.current;if(w!==e){const S=l.current,P=EA(x);e?p("MOUNT"):P==="none"||(x==null?void 0:x.display)==="none"?p("UNMOUNT"):p(w&&S!==P?"ANIMATION_OUT":"UNMOUNT"),a.current=e}},[e,p]),Ba(()=>{if(t){let x;const w=t.ownerDocument.defaultView??window,j=P=>{const L=EA(i.current).includes(P.animationName);if(P.target===t&&L&&(p("ANIMATION_END"),!a.current)){const B=t.style.animationFillMode;t.style.animationFillMode="forwards",x=w.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=B)})}},S=P=>{P.target===t&&(l.current=EA(i.current))};return t.addEventListener("animationstart",S),t.addEventListener("animationcancel",j),t.addEventListener("animationend",j),()=>{w.clearTimeout(x),t.removeEventListener("animationstart",S),t.removeEventListener("animationcancel",j),t.removeEventListener("animationend",j)}}else p("ANIMATION_END")},[t,p]),{isPresent:["mounted","unmountSuspended"].includes(s),ref:U.useCallback(x=>{x&&(i.current=getComputedStyle(x)),r(x)},[])}}function EA(e){return(e==null?void 0:e.animationName)||"none"}function vye(e){var i,a;let t=(i=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:i.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}function fo({prop:e,defaultProp:t,onChange:r=()=>{}}){const[i,a]=bye({defaultProp:t,onChange:r}),l=e!==void 0,d=l?e:i,s=Ws(r),p=U.useCallback(x=>{if(l){const j=typeof x=="function"?x(e):x;j!==e&&s(j)}else a(x)},[l,e,a,s]);return[d,p]}function bye({defaultProp:e,onChange:t}){const r=U.useState(e),[i]=r,a=U.useRef(i),l=Ws(t);return U.useEffect(()=>{a.current!==i&&(l(i),a.current=i)},[i,a,l]),r}var _ye="VisuallyHidden",FN=U.forwardRef((e,t)=>n.jsx(Hr.span,{...e,ref:t,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...e.style}}));FN.displayName=_ye;var wye=FN,AF="ToastProvider",[TF,jye,Nye]=d_("Toast"),[sQ,eft]=Jo("Toast",[Nye]),[Sye,wE]=sQ(AF),aQ=e=>{const{__scopeToast:t,label:r="Notification",duration:i=5e3,swipeDirection:a="right",swipeThreshold:l=50,children:d}=e,[s,p]=U.useState(null),[x,w]=U.useState(0),j=U.useRef(!1),S=U.useRef(!1);return r.trim()||console.error(`Invalid prop \`label\` supplied to \`${AF}\`. Expected non-empty \`string\`.`),n.jsx(TF.Provider,{scope:t,children:n.jsx(Sye,{scope:t,label:r,duration:i,swipeDirection:a,swipeThreshold:l,toastCount:x,viewport:s,onViewportChange:p,onToastAdd:U.useCallback(()=>w(P=>P+1),[]),onToastRemove:U.useCallback(()=>w(P=>P-1),[]),isFocusedToastEscapeKeyDownRef:j,isClosePausedRef:S,children:d})})};aQ.displayName=AF;var oQ="ToastViewport",Cye=["F8"],RD="toast.viewportPause",DD="toast.viewportResume",lQ=U.forwardRef((e,t)=>{const{__scopeToast:r,hotkey:i=Cye,label:a="Notifications ({hotkey})",...l}=e,d=wE(oQ,r),s=jye(r),p=U.useRef(null),x=U.useRef(null),w=U.useRef(null),j=U.useRef(null),S=Mn(t,j,d.onViewportChange),P=i.join("+").replace(/Key/g,"").replace(/Digit/g,""),F=d.toastCount>0;U.useEffect(()=>{const B=V=>{var G;i.length!==0&&i.every(W=>V[W]||V.code===W)&&((G=j.current)==null||G.focus())};return document.addEventListener("keydown",B),()=>document.removeEventListener("keydown",B)},[i]),U.useEffect(()=>{const B=p.current,V=j.current;if(F&&B&&V){const $=()=>{if(!d.isClosePausedRef.current){const se=new CustomEvent(RD);V.dispatchEvent(se),d.isClosePausedRef.current=!0}},G=()=>{if(d.isClosePausedRef.current){const se=new CustomEvent(DD);V.dispatchEvent(se),d.isClosePausedRef.current=!1}},W=se=>{!B.contains(se.relatedTarget)&&G()},Z=()=>{B.contains(document.activeElement)||G()};return B.addEventListener("focusin",$),B.addEventListener("focusout",W),B.addEventListener("pointermove",$),B.addEventListener("pointerleave",Z),window.addEventListener("blur",$),window.addEventListener("focus",G),()=>{B.removeEventListener("focusin",$),B.removeEventListener("focusout",W),B.removeEventListener("pointermove",$),B.removeEventListener("pointerleave",Z),window.removeEventListener("blur",$),window.removeEventListener("focus",G)}}},[F,d.isClosePausedRef]);const L=U.useCallback(({tabbingDirection:B})=>{const $=s().map(G=>{const W=G.ref.current,Z=[W,...Fye(W)];return B==="forwards"?Z:Z.reverse()});return(B==="forwards"?$.reverse():$).flat()},[s]);return U.useEffect(()=>{const B=j.current;if(B){const V=$=>{var Z,se,ae;const G=$.altKey||$.ctrlKey||$.metaKey;if($.key==="Tab"&&!G){const ce=document.activeElement,Pe=$.shiftKey;if($.target===B&&Pe){(Z=x.current)==null||Z.focus();return}const Ne=L({tabbingDirection:Pe?"backwards":"forwards"}),ze=Ne.findIndex(ye=>ye===ce);lO(Ne.slice(ze+1))?$.preventDefault():Pe?(se=x.current)==null||se.focus():(ae=w.current)==null||ae.focus()}};return B.addEventListener("keydown",V),()=>B.removeEventListener("keydown",V)}},[s,L]),n.jsxs(pye,{ref:p,role:"region","aria-label":a.replace("{hotkey}",P),tabIndex:-1,style:{pointerEvents:F?void 0:"none"},children:[F&&n.jsx(zD,{ref:x,onFocusFromOutsideViewport:()=>{const B=L({tabbingDirection:"forwards"});lO(B)}}),n.jsx(TF.Slot,{scope:r,children:n.jsx(Hr.ol,{tabIndex:-1,...l,ref:S})}),F&&n.jsx(zD,{ref:w,onFocusFromOutsideViewport:()=>{const B=L({tabbingDirection:"backwards"});lO(B)}})]})});lQ.displayName=oQ;var cQ="ToastFocusProxy",zD=U.forwardRef((e,t)=>{const{__scopeToast:r,onFocusFromOutsideViewport:i,...a}=e,l=wE(cQ,r);return n.jsx(FN,{"aria-hidden":!0,tabIndex:0,...a,ref:t,style:{position:"fixed"},onFocus:d=>{var x;const s=d.relatedTarget;!((x=l.viewport)!=null&&x.contains(s))&&i()}})});zD.displayName=cQ;var jE="Toast",Aye="toast.swipeStart",Tye="toast.swipeMove",kye="toast.swipeCancel",Pye="toast.swipeEnd",uQ=U.forwardRef((e,t)=>{const{forceMount:r,open:i,defaultOpen:a,onOpenChange:l,...d}=e,[s=!0,p]=fo({prop:i,defaultProp:a,onChange:l});return n.jsx(io,{present:r||s,children:n.jsx(Iye,{open:s,...d,ref:t,onClose:()=>p(!1),onPause:Ws(e.onPause),onResume:Ws(e.onResume),onSwipeStart:_r(e.onSwipeStart,x=>{x.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:_r(e.onSwipeMove,x=>{const{x:w,y:j}=x.detail.delta;x.currentTarget.setAttribute("data-swipe","move"),x.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${w}px`),x.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${j}px`)}),onSwipeCancel:_r(e.onSwipeCancel,x=>{x.currentTarget.setAttribute("data-swipe","cancel"),x.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),x.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),x.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),x.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:_r(e.onSwipeEnd,x=>{const{x:w,y:j}=x.detail.delta;x.currentTarget.setAttribute("data-swipe","end"),x.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),x.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),x.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${w}px`),x.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${j}px`),p(!1)})})})});uQ.displayName=jE;var[Eye,Mye]=sQ(jE,{onClose(){}}),Iye=U.forwardRef((e,t)=>{const{__scopeToast:r,type:i="foreground",duration:a,open:l,onClose:d,onEscapeKeyDown:s,onPause:p,onResume:x,onSwipeStart:w,onSwipeMove:j,onSwipeCancel:S,onSwipeEnd:P,...F}=e,L=wE(jE,r),[B,V]=U.useState(null),$=Mn(t,ye=>V(ye)),G=U.useRef(null),W=U.useRef(null),Z=a||L.duration,se=U.useRef(0),ae=U.useRef(Z),ce=U.useRef(0),{onToastAdd:Pe,onToastRemove:we}=L,xe=Ws(()=>{var ve;(B==null?void 0:B.contains(document.activeElement))&&((ve=L.viewport)==null||ve.focus()),d()}),Ne=U.useCallback(ye=>{!ye||ye===1/0||(window.clearTimeout(ce.current),se.current=new Date().getTime(),ce.current=window.setTimeout(xe,ye))},[xe]);U.useEffect(()=>{const ye=L.viewport;if(ye){const ve=()=>{Ne(ae.current),x==null||x()},_e=()=>{const Ee=new Date().getTime()-se.current;ae.current=ae.current-Ee,window.clearTimeout(ce.current),p==null||p()};return ye.addEventListener(RD,_e),ye.addEventListener(DD,ve),()=>{ye.removeEventListener(RD,_e),ye.removeEventListener(DD,ve)}}},[L.viewport,Z,p,x,Ne]),U.useEffect(()=>{l&&!L.isClosePausedRef.current&&Ne(Z)},[l,Z,L.isClosePausedRef,Ne]),U.useEffect(()=>(Pe(),()=>we()),[Pe,we]);const ze=U.useMemo(()=>B?xQ(B):null,[B]);return L.viewport?n.jsxs(n.Fragment,{children:[ze&&n.jsx(Oye,{__scopeToast:r,role:"status","aria-live":i==="foreground"?"assertive":"polite","aria-atomic":!0,children:ze}),n.jsx(Eye,{scope:r,onClose:xe,children:tg.createPortal(n.jsx(TF.ItemSlot,{scope:r,children:n.jsx(fye,{asChild:!0,onEscapeKeyDown:_r(s,()=>{L.isFocusedToastEscapeKeyDownRef.current||xe(),L.isFocusedToastEscapeKeyDownRef.current=!1}),children:n.jsx(Hr.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":l?"open":"closed","data-swipe-direction":L.swipeDirection,...F,ref:$,style:{userSelect:"none",touchAction:"none",...e.style},onKeyDown:_r(e.onKeyDown,ye=>{ye.key==="Escape"&&(s==null||s(ye.nativeEvent),ye.nativeEvent.defaultPrevented||(L.isFocusedToastEscapeKeyDownRef.current=!0,xe()))}),onPointerDown:_r(e.onPointerDown,ye=>{ye.button===0&&(G.current={x:ye.clientX,y:ye.clientY})}),onPointerMove:_r(e.onPointerMove,ye=>{if(!G.current)return;const ve=ye.clientX-G.current.x,_e=ye.clientY-G.current.y,Ee=!!W.current,je=["left","right"].includes(L.swipeDirection),Ce=["left","up"].includes(L.swipeDirection)?Math.min:Math.max,tt=je?Ce(0,ve):0,it=je?0:Ce(0,_e),mt=ye.pointerType==="touch"?10:2,gt={x:tt,y:it},qt={originalEvent:ye,delta:gt};Ee?(W.current=gt,MA(Tye,j,qt,{discrete:!1})):z9(gt,L.swipeDirection,mt)?(W.current=gt,MA(Aye,w,qt,{discrete:!1}),ye.target.setPointerCapture(ye.pointerId)):(Math.abs(ve)>mt||Math.abs(_e)>mt)&&(G.current=null)}),onPointerUp:_r(e.onPointerUp,ye=>{const ve=W.current,_e=ye.target;if(_e.hasPointerCapture(ye.pointerId)&&_e.releasePointerCapture(ye.pointerId),W.current=null,G.current=null,ve){const Ee=ye.currentTarget,je={originalEvent:ye,delta:ve};z9(ve,L.swipeDirection,L.swipeThreshold)?MA(Pye,P,je,{discrete:!0}):MA(kye,S,je,{discrete:!0}),Ee.addEventListener("click",Ce=>Ce.preventDefault(),{once:!0})}})})})}),L.viewport)})]}):null}),Oye=e=>{const{__scopeToast:t,children:r,...i}=e,a=wE(jE,t),[l,d]=U.useState(!1),[s,p]=U.useState(!1);return zye(()=>d(!0)),U.useEffect(()=>{const x=window.setTimeout(()=>p(!0),1e3);return()=>window.clearTimeout(x)},[]),s?null:n.jsx(h_,{asChild:!0,children:n.jsx(FN,{...i,children:l&&n.jsxs(n.Fragment,{children:[a.label," ",r]})})})},Rye="ToastTitle",dQ=U.forwardRef((e,t)=>{const{__scopeToast:r,...i}=e;return n.jsx(Hr.div,{...i,ref:t})});dQ.displayName=Rye;var Dye="ToastDescription",hQ=U.forwardRef((e,t)=>{const{__scopeToast:r,...i}=e;return n.jsx(Hr.div,{...i,ref:t})});hQ.displayName=Dye;var mQ="ToastAction",fQ=U.forwardRef((e,t)=>{const{altText:r,...i}=e;return r.trim()?n.jsx(gQ,{altText:r,asChild:!0,children:n.jsx(kF,{...i,ref:t})}):(console.error(`Invalid prop \`altText\` supplied to \`${mQ}\`. Expected non-empty \`string\`.`),null)});fQ.displayName=mQ;var pQ="ToastClose",kF=U.forwardRef((e,t)=>{const{__scopeToast:r,...i}=e,a=Mye(pQ,r);return n.jsx(gQ,{asChild:!0,children:n.jsx(Hr.button,{type:"button",...i,ref:t,onClick:_r(e.onClick,a.onClose)})})});kF.displayName=pQ;var gQ=U.forwardRef((e,t)=>{const{__scopeToast:r,altText:i,...a}=e;return n.jsx(Hr.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":i||void 0,...a,ref:t})});function xQ(e){const t=[];return Array.from(e.childNodes).forEach(i=>{if(i.nodeType===i.TEXT_NODE&&i.textContent&&t.push(i.textContent),Lye(i)){const a=i.ariaHidden||i.hidden||i.style.display==="none",l=i.dataset.radixToastAnnounceExclude==="";if(!a)if(l){const d=i.dataset.radixToastAnnounceAlt;d&&t.push(d)}else t.push(...xQ(i))}}),t}function MA(e,t,r,{discrete:i}){const a=r.originalEvent.currentTarget,l=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:r});t&&a.addEventListener(e,t,{once:!0}),i?CF(a,l):a.dispatchEvent(l)}var z9=(e,t,r=0)=>{const i=Math.abs(e.x),a=Math.abs(e.y),l=i>a;return t==="left"||t==="right"?l&&i>r:!l&&a>r};function zye(e=()=>{}){const t=Ws(e);Ba(()=>{let r=0,i=0;return r=window.requestAnimationFrame(()=>i=window.requestAnimationFrame(t)),()=>{window.cancelAnimationFrame(r),window.cancelAnimationFrame(i)}},[t])}function Lye(e){return e.nodeType===e.ELEMENT_NODE}function Fye(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:i=>{const a=i.tagName==="INPUT"&&i.type==="hidden";return i.disabled||i.hidden||a?NodeFilter.FILTER_SKIP:i.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function lO(e){const t=document.activeElement;return e.some(r=>r===t?!0:(r.focus(),document.activeElement!==t))}var Bye=aQ,yQ=lQ,vQ=uQ,bQ=dQ,_Q=hQ,wQ=fQ,jQ=kF;function NQ(e){var t,r,i="";if(typeof e=="string"||typeof e=="number")i+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(r=NQ(e[t]))&&(i&&(i+=" "),i+=r)}else for(r in e)e[r]&&(i&&(i+=" "),i+=r);return i}function zn(){for(var e,t,r=0,i="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=NQ(e))&&(i&&(i+=" "),i+=t);return i}const L9=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,F9=zn,rg=(e,t)=>r=>{var i;if((t==null?void 0:t.variants)==null)return F9(e,r==null?void 0:r.class,r==null?void 0:r.className);const{variants:a,defaultVariants:l}=t,d=Object.keys(a).map(x=>{const w=r==null?void 0:r[x],j=l==null?void 0:l[x];if(w===null)return null;const S=L9(w)||L9(j);return a[x][S]}),s=r&&Object.entries(r).reduce((x,w)=>{let[j,S]=w;return S===void 0||(x[j]=S),x},{}),p=t==null||(i=t.compoundVariants)===null||i===void 0?void 0:i.reduce((x,w)=>{let{class:j,className:S,...P}=w;return Object.entries(P).every(F=>{let[L,B]=F;return Array.isArray(B)?B.includes({...l,...s}[L]):{...l,...s}[L]===B})?[...x,j,S]:x},[]);return F9(e,d,p,r==null?void 0:r.class,r==null?void 0:r.className)};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $ye=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),SQ=(...e)=>e.filter((t,r,i)=>!!t&&t.trim()!==""&&i.indexOf(t)===r).join(" ").trim();/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Vye={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uye=U.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:i,className:a="",children:l,iconNode:d,...s},p)=>U.createElement("svg",{ref:p,...Vye,width:t,height:t,stroke:e,strokeWidth:i?Number(r)*24/Number(t):r,className:SQ("lucide",a),...s},[...d.map(([x,w])=>U.createElement(x,w)),...Array.isArray(l)?l:[l]]));/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ut=(e,t)=>{const r=U.forwardRef(({className:i,...a},l)=>U.createElement(Uye,{ref:l,iconNode:t,className:SQ(`lucide-${$ye(e)}`,i),...a}));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bs=Ut("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LD=Ut("Antenna",[["path",{d:"M2 12 7 2",key:"117k30"}],["path",{d:"m7 12 5-10",key:"1tvx22"}],["path",{d:"m12 12 5-10",key:"ev1o1a"}],["path",{d:"m17 12 5-10",key:"1e4ti3"}],["path",{d:"M4.5 7h15",key:"vlsxkz"}],["path",{d:"M12 16v6",key:"c8a4gj"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PF=Ut("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gye=Ut("ArrowDownRight",[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cb=Ut("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hye=Ut("ArrowUpRight",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qye=Ut("Award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wye=Ut("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kye=Ut("BookOpen",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CQ=Ut("Book",[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hi=Ut("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zye=Ut("BrainCircuit",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M9 13a4.5 4.5 0 0 0 3-4",key:"10igwf"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M12 13h4",key:"1ku699"}],["path",{d:"M12 18h6a2 2 0 0 1 2 2v1",key:"105ag5"}],["path",{d:"M12 8h8",key:"1lhi5i"}],["path",{d:"M16 8V5a2 2 0 0 1 2-2",key:"u6izg6"}],["circle",{cx:"16",cy:"13",r:".5",key:"ry7gng"}],["circle",{cx:"18",cy:"3",r:".5",key:"1aiba7"}],["circle",{cx:"20",cy:"21",r:".5",key:"yhc1fs"}],["circle",{cx:"20",cy:"8",r:".5",key:"1e43v0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ti=Ut("Brain",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J0=Ut("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yye=Ut("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CT=Ut("Cable",[["path",{d:"M17 21v-2a1 1 0 0 1-1-1v-1a2 2 0 0 1 2-2h2a2 2 0 0 1 2 2v1a1 1 0 0 1-1 1",key:"10bnsj"}],["path",{d:"M19 15V6.5a1 1 0 0 0-7 0v11a1 1 0 0 1-7 0V9",key:"1eqmu1"}],["path",{d:"M21 21v-2h-4",key:"14zm7j"}],["path",{d:"M3 5h4V3",key:"z442eg"}],["path",{d:"M7 5a1 1 0 0 1 1 1v1a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V6a1 1 0 0 1 1-1V3",key:"ebdjd7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xye=Ut("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jye=Ut("CalendarDays",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xh=Ut("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qye=Ut("ChartColumnIncreasing",[["path",{d:"M13 17V9",key:"1fwyjl"}],["path",{d:"M18 17V5",key:"sfb6ij"}],["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const to=Ut("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FD=Ut("ChartLine",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"m19 9-5 5-4-4-3 3",key:"2osh9i"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Co=Ut("ChartNoAxesColumn",[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AQ=Ut("ChartPie",[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hh=Ut("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Na=Ut("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EF=Ut("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ng=Ut("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x2=Ut("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ub=Ut("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eve=Ut("CircleArrowRight",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"m12 16 4-4-4-4",key:"1i9zcv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ro=Ut("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const db=Ut("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tve=Ut("CircleDollarSign",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 18V6",key:"zqpxq5"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rve=Ut("CirclePause",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"10",x2:"10",y1:"15",y2:"9",key:"c1nkhi"}],["line",{x1:"14",x2:"14",y1:"15",y2:"9",key:"h65svq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nve=Ut("CirclePlay",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"10 8 16 12 10 16 10 8",key:"1cimsy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MF=Ut("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BD=Ut("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ive=Ut("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $a=Ut("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const op=Ut("Cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bc=Ut("Code",[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sve=Ut("Columns2",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M12 3v18",key:"108xh3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hb=Ut("Command",[["path",{d:"M15 6v12a3 3 0 1 0 3-3H6a3 3 0 1 0 3 3V6a3 3 0 1 0-3 3h12a3 3 0 1 0-3-3",key:"11bfej"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bd=Ut("Cpu",[["rect",{width:"16",height:"16",x:"4",y:"4",rx:"2",key:"14l7u7"}],["rect",{width:"6",height:"6",x:"9",y:"9",rx:"1",key:"5aljv4"}],["path",{d:"M15 2v2",key:"13l42r"}],["path",{d:"M15 20v2",key:"15mkzm"}],["path",{d:"M2 15h2",key:"1gxd5l"}],["path",{d:"M2 9h2",key:"1bbxkp"}],["path",{d:"M20 15h2",key:"19e6y8"}],["path",{d:"M20 9h2",key:"19tzq7"}],["path",{d:"M9 2v2",key:"165o2o"}],["path",{d:"M9 20v2",key:"i2bqo8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m_=Ut("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ln=Ut("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sc=Ut("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nu=Ut("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IF=Ut("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mh=Ut("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TQ=Ut("FileCheck",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kQ=Ut("FileCode",[["path",{d:"M10 12.5 8 15l2 2.5",key:"1tg20x"}],["path",{d:"m14 12.5 2 2.5-2 2.5",key:"yinavb"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7z",key:"1mlx9k"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IA=Ut("FileDown",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ave=Ut("FilePlus",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M9 15h6",key:"cctwl0"}],["path",{d:"M12 18v-6",key:"17g6i2"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nh=Ut("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ove=Ut("FileUp",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"m15 15-3-3-3 3",key:"15xj92"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fm=Ut("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lve=Ut("Folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cve=Ut("Gavel",[["path",{d:"m14.5 12.5-8 8a2.119 2.119 0 1 1-3-3l8-8",key:"15492f"}],["path",{d:"m16 16 6-6",key:"vzrcl6"}],["path",{d:"m8 8 6-6",key:"18bi4p"}],["path",{d:"m9 7 8 8",key:"5jnvq1"}],["path",{d:"m21 11-8-8",key:"z4y7zo"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $D=Ut("Gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q0=Ut("GitBranch",[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PQ=Ut("GitMerge",[["circle",{cx:"18",cy:"18",r:"3",key:"1xkwt0"}],["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M6 21V9a9 9 0 0 0 9 9",key:"7kw0sc"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zs=Ut("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uve=Ut("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dve=Ut("HardDrive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hve=Ut("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OF=Ut("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mve=Ut("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EQ=Ut("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f_=Ut("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MQ=Ut("Layers3",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m6.08 9.5-3.5 1.6a1 1 0 0 0 0 1.81l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9a1 1 0 0 0 0-1.83l-3.5-1.59",key:"1e5n1m"}],["path",{d:"m6.08 14.5-3.5 1.6a1 1 0 0 0 0 1.81l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9a1 1 0 0 0 0-1.83l-3.5-1.59",key:"1iwflc"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IQ=Ut("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RF=Ut("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B9=Ut("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OQ=Ut("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NE=Ut("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RQ=Ut("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ex=Ut("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V0=Ut("Map",[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fve=Ut("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _s=Ut("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VD=Ut("Microchip",[["path",{d:"M18 12h2",key:"quuxs7"}],["path",{d:"M18 16h2",key:"zsn3lv"}],["path",{d:"M18 20h2",key:"9x5y9y"}],["path",{d:"M18 4h2",key:"1luxfb"}],["path",{d:"M18 8h2",key:"nxqzg"}],["path",{d:"M4 12h2",key:"1ltxp0"}],["path",{d:"M4 16h2",key:"8a5zha"}],["path",{d:"M4 20h2",key:"27dk57"}],["path",{d:"M4 4h2",key:"10groj"}],["path",{d:"M4 8h2",key:"18vq6w"}],["path",{d:"M8 2a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2h-1.5c-.276 0-.494.227-.562.495a2 2 0 0 1-3.876 0C9.994 2.227 9.776 2 9.5 2z",key:"1681fp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pve=Ut("Minimize2",[["polyline",{points:"4 14 10 14 10 20",key:"11kfnr"}],["polyline",{points:"20 10 14 10 14 4",key:"rlmsce"}],["line",{x1:"14",x2:"21",y1:"10",y2:"3",key:"o5lafz"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gve=Ut("MonitorSpeaker",[["path",{d:"M5.5 20H8",key:"1k40s5"}],["path",{d:"M17 9h.01",key:"1j24nn"}],["rect",{width:"10",height:"16",x:"12",y:"4",rx:"2",key:"ixliua"}],["path",{d:"M8 6H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h4",key:"1mp6e1"}],["circle",{cx:"17",cy:"15",r:"1",key:"tqvash"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UD=Ut("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xve=Ut("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ga=Ut("Network",[["rect",{x:"16",y:"16",width:"6",height:"6",rx:"1",key:"4q2zg0"}],["rect",{x:"2",y:"16",width:"6",height:"6",rx:"1",key:"8cvhb9"}],["rect",{x:"9",y:"2",width:"6",height:"6",rx:"1",key:"1egb70"}],["path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3",key:"1jsf9p"}],["path",{d:"M12 12V8",key:"2874zd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DQ=Ut("Newspaper",[["path",{d:"M4 22h16a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v16a2 2 0 0 1-2 2Zm0 0a2 2 0 0 1-2-2v-9c0-1.1.9-2 2-2h2",key:"7pis2x"}],["path",{d:"M18 14h-8",key:"sponae"}],["path",{d:"M15 18h-5",key:"95g1m2"}],["path",{d:"M10 6h8v4h-8V6Z",key:"smlsk5"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yve=Ut("OctagonAlert",[["path",{d:"M12 16h.01",key:"1drbdi"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M15.312 2a2 2 0 0 1 1.414.586l4.688 4.688A2 2 0 0 1 22 8.688v6.624a2 2 0 0 1-.586 1.414l-4.688 4.688a2 2 0 0 1-1.414.586H8.688a2 2 0 0 1-1.414-.586l-4.688-4.688A2 2 0 0 1 2 15.312V8.688a2 2 0 0 1 .586-1.414l4.688-4.688A2 2 0 0 1 8.688 2z",key:"1fd625"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vve=Ut("PackageCheck",[["path",{d:"m16 16 2 2 4-4",key:"gfu2re"}],["path",{d:"M21 10V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l2-1.14",key:"e7tb2h"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["line",{x1:"12",x2:"12",y1:"22",y2:"12",key:"a4e8g8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DF=Ut("Package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["path",{d:"m3.3 7 7.703 4.734a2 2 0 0 0 1.994 0L20.7 7",key:"yx3hmr"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bve=Ut("PanelLeft",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zQ=Ut("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $9=Ut("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _ve=Ut("PiggyBank",[["path",{d:"M19 5c-1.5 0-2.8 1.4-3 2-3.5-1.5-11-.3-11 5 0 1.8 0 3 2 4.5V20h4v-2h3v2h4v-4c1-.5 1.7-1 2-2h2v-4h-2c0-1-.5-1.5-1-2V5z",key:"1ivx2i"}],["path",{d:"M2 9v1c0 1.1.9 2 2 2h1",key:"nm575m"}],["path",{d:"M16 11h.01",key:"xkw8gn"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sh=Ut("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mo=Ut("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wve=Ut("Radar",[["path",{d:"M19.07 4.93A10 10 0 0 0 6.99 3.34",key:"z3du51"}],["path",{d:"M4 6h.01",key:"oypzma"}],["path",{d:"M2.29 9.62A10 10 0 1 0 21.31 8.35",key:"qzzz0"}],["path",{d:"M16.24 7.76A6 6 0 1 0 8.23 16.67",key:"1yjesh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M17.99 11.66A6 6 0 0 1 15.77 16.67",key:"1u2y91"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"m13.41 10.59 5.66-5.66",key:"mhq4k0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kc=Ut("Radio",[["path",{d:"M4.9 19.1C1 15.2 1 8.8 4.9 4.9",key:"1vaf9d"}],["path",{d:"M7.8 16.2c-2.3-2.3-2.3-6.1 0-8.5",key:"u1ii0m"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M16.2 7.8c2.3 2.3 2.3 6.1 0 8.5",key:"1j5fej"}],["path",{d:"M19.1 4.9C23 8.8 23 15.1 19.1 19",key:"10b0cb"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jve=Ut("RefreshCcw",[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uk=Ut("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vx=Ut("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nve=Ut("Route",[["circle",{cx:"6",cy:"19",r:"3",key:"1kj8tv"}],["path",{d:"M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15",key:"1d8sl"}],["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sve=Ut("Router",[["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",key:"w68u3i"}],["path",{d:"M6.01 18H6",key:"19vcac"}],["path",{d:"M10.01 18H10",key:"uamcmx"}],["path",{d:"M15 10v4",key:"qjz1xs"}],["path",{d:"M17.84 7.17a4 4 0 0 0-5.66 0",key:"1rif40"}],["path",{d:"M20.66 4.34a8 8 0 0 0-11.31 0",key:"6a5xfq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cve=Ut("Satellite",[["path",{d:"M13 7 9 3 5 7l4 4",key:"vyckw6"}],["path",{d:"m17 11 4 4-4 4-4-4",key:"rchckc"}],["path",{d:"m8 12 4 4 6-6-4-4Z",key:"1sshf7"}],["path",{d:"m16 8 3-3",key:"x428zp"}],["path",{d:"M9 21a6 6 0 0 0-6-6",key:"1iajcf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LQ=Ut("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $c=Ut("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zF=Ut("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ave=Ut("ServerCog",[["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}],["path",{d:"M4.5 10H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v4a2 2 0 0 1-2 2h-.5",key:"tn8das"}],["path",{d:"M4.5 14H4a2 2 0 0 0-2 2v4a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-4a2 2 0 0 0-2-2h-.5",key:"1g2pve"}],["path",{d:"M6 6h.01",key:"1utrut"}],["path",{d:"M6 18h.01",key:"uhywen"}],["path",{d:"m15.7 13.4-.9-.3",key:"1jwmzr"}],["path",{d:"m9.2 10.9-.9-.3",key:"qapnim"}],["path",{d:"m10.6 15.7.3-.9",key:"quwk0k"}],["path",{d:"m13.6 15.7-.4-1",key:"cb9xp7"}],["path",{d:"m10.8 9.3-.4-1",key:"1uaiz5"}],["path",{d:"m8.3 13.6 1-.4",key:"s6srou"}],["path",{d:"m14.7 10.8 1-.4",key:"4d31cq"}],["path",{d:"m13.4 8.3-.3.9",key:"1bm987"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eo=Ut("Server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ws=Ut("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FQ=Ut("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dn=Ut("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BQ=Ut("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tve=Ut("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ov=Ut("Signal",[["path",{d:"M2 20h.01",key:"4haj6o"}],["path",{d:"M7 20v-4",key:"j294jx"}],["path",{d:"M12 20v-8",key:"i3yub9"}],["path",{d:"M17 20V8",key:"1tkaf5"}],["path",{d:"M22 4v16",key:"sih9yq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kve=Ut("SlidersHorizontal",[["line",{x1:"21",x2:"14",y1:"4",y2:"4",key:"obuewd"}],["line",{x1:"10",x2:"3",y1:"4",y2:"4",key:"1q6298"}],["line",{x1:"21",x2:"12",y1:"12",y2:"12",key:"1iu8h1"}],["line",{x1:"8",x2:"3",y1:"12",y2:"12",key:"ntss68"}],["line",{x1:"21",x2:"16",y1:"20",y2:"20",key:"14d8ph"}],["line",{x1:"12",x2:"3",y1:"20",y2:"20",key:"m0wm8r"}],["line",{x1:"14",x2:"14",y1:"2",y2:"6",key:"14e1ph"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"16",x2:"16",y1:"18",y2:"22",key:"1lctlv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vp=Ut("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $Q=Ut("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LF=Ut("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FF=Ut("Star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pve=Ut("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ch=Ut("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GD=Ut("Terminal",[["polyline",{points:"4 17 10 11 4 5",key:"akl6gq"}],["line",{x1:"12",x2:"20",y1:"19",y2:"19",key:"q2wloq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VQ=Ut("TestTube",[["path",{d:"M14.5 2v17.5c0 1.4-1.1 2.5-2.5 2.5c-1.4 0-2.5-1.1-2.5-2.5V2",key:"125lnx"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M14.5 16h-5",key:"1ox875"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eve=Ut("Timer",[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UQ=Ut("TowerControl",[["path",{d:"M18.2 12.27 20 6H4l1.8 6.27a1 1 0 0 0 .95.73h10.5a1 1 0 0 0 .96-.73Z",key:"1pledb"}],["path",{d:"M8 13v9",key:"hmv0ci"}],["path",{d:"M16 22v-9",key:"ylnf1u"}],["path",{d:"m9 6 1 7",key:"dpdgam"}],["path",{d:"m15 6-1 7",key:"ls7zgu"}],["path",{d:"M12 6V2",key:"1pj48d"}],["path",{d:"M13 2h-2",key:"mj6ths"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BN=Ut("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mve=Ut("TreePine",[["path",{d:"m17 14 3 3.3a1 1 0 0 1-.7 1.7H4.7a1 1 0 0 1-.7-1.7L7 14h-.3a1 1 0 0 1-.7-1.7L9 9h-.2A1 1 0 0 1 8 7.3L12 3l4 4.3a1 1 0 0 1-.8 1.7H15l3 3.3a1 1 0 0 1-.7 1.7H17Z",key:"cpyugq"}],["path",{d:"M12 22v-3",key:"kmzjlo"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tx=Ut("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const En=Ut("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fs=Ut("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ive=Ut("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $N=Ut("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qi=Ut("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ove=Ut("Wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p_=Ut("Workflow",[["rect",{width:"8",height:"8",x:"3",y:"3",rx:"2",key:"by2w9f"}],["path",{d:"M7 11v4a2 2 0 0 0 2 2h4",key:"xkn7yn"}],["rect",{width:"8",height:"8",x:"13",y:"13",rx:"2",key:"1cgmvn"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vc=Ut("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pc=Ut("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yi=Ut("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),BF="-",Rve=e=>{const t=zve(e),{conflictingClassGroups:r,conflictingClassGroupModifiers:i}=e;return{getClassGroupId:d=>{const s=d.split(BF);return s[0]===""&&s.length!==1&&s.shift(),GQ(s,t)||Dve(d)},getConflictingClassGroupIds:(d,s)=>{const p=r[d]||[];return s&&i[d]?[...p,...i[d]]:p}}},GQ=(e,t)=>{var d;if(e.length===0)return t.classGroupId;const r=e[0],i=t.nextPart.get(r),a=i?GQ(e.slice(1),i):void 0;if(a)return a;if(t.validators.length===0)return;const l=e.join(BF);return(d=t.validators.find(({validator:s})=>s(l)))==null?void 0:d.classGroupId},V9=/^\[(.+)\]$/,Dve=e=>{if(V9.test(e)){const t=V9.exec(e)[1],r=t==null?void 0:t.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}},zve=e=>{const{theme:t,prefix:r}=e,i={nextPart:new Map,validators:[]};return Fve(Object.entries(e.classGroups),r).forEach(([l,d])=>{HD(d,i,l,t)}),i},HD=(e,t,r,i)=>{e.forEach(a=>{if(typeof a=="string"){const l=a===""?t:U9(t,a);l.classGroupId=r;return}if(typeof a=="function"){if(Lve(a)){HD(a(i),t,r,i);return}t.validators.push({validator:a,classGroupId:r});return}Object.entries(a).forEach(([l,d])=>{HD(d,U9(t,l),r,i)})})},U9=(e,t)=>{let r=e;return t.split(BF).forEach(i=>{r.nextPart.has(i)||r.nextPart.set(i,{nextPart:new Map,validators:[]}),r=r.nextPart.get(i)}),r},Lve=e=>e.isThemeGetter,Fve=(e,t)=>t?e.map(([r,i])=>{const a=i.map(l=>typeof l=="string"?t+l:typeof l=="object"?Object.fromEntries(Object.entries(l).map(([d,s])=>[t+d,s])):l);return[r,a]}):e,Bve=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,r=new Map,i=new Map;const a=(l,d)=>{r.set(l,d),t++,t>e&&(t=0,i=r,r=new Map)};return{get(l){let d=r.get(l);if(d!==void 0)return d;if((d=i.get(l))!==void 0)return a(l,d),d},set(l,d){r.has(l)?r.set(l,d):a(l,d)}}},HQ="!",$ve=e=>{const{separator:t,experimentalParseClassName:r}=e,i=t.length===1,a=t[0],l=t.length,d=s=>{const p=[];let x=0,w=0,j;for(let B=0;B<s.length;B++){let V=s[B];if(x===0){if(V===a&&(i||s.slice(B,B+l)===t)){p.push(s.slice(w,B)),w=B+l;continue}if(V==="/"){j=B;continue}}V==="["?x++:V==="]"&&x--}const S=p.length===0?s:s.substring(w),P=S.startsWith(HQ),F=P?S.substring(1):S,L=j&&j>w?j-w:void 0;return{modifiers:p,hasImportantModifier:P,baseClassName:F,maybePostfixModifierPosition:L}};return r?s=>r({className:s,parseClassName:d}):d},Vve=e=>{if(e.length<=1)return e;const t=[];let r=[];return e.forEach(i=>{i[0]==="["?(t.push(...r.sort(),i),r=[]):r.push(i)}),t.push(...r.sort()),t},Uve=e=>({cache:Bve(e.cacheSize),parseClassName:$ve(e),...Rve(e)}),Gve=/\s+/,Hve=(e,t)=>{const{parseClassName:r,getClassGroupId:i,getConflictingClassGroupIds:a}=t,l=[],d=e.trim().split(Gve);let s="";for(let p=d.length-1;p>=0;p-=1){const x=d[p],{modifiers:w,hasImportantModifier:j,baseClassName:S,maybePostfixModifierPosition:P}=r(x);let F=!!P,L=i(F?S.substring(0,P):S);if(!L){if(!F){s=x+(s.length>0?" "+s:s);continue}if(L=i(S),!L){s=x+(s.length>0?" "+s:s);continue}F=!1}const B=Vve(w).join(":"),V=j?B+HQ:B,$=V+L;if(l.includes($))continue;l.push($);const G=a(L,F);for(let W=0;W<G.length;++W){const Z=G[W];l.push(V+Z)}s=x+(s.length>0?" "+s:s)}return s};function qve(){let e=0,t,r,i="";for(;e<arguments.length;)(t=arguments[e++])&&(r=qQ(t))&&(i&&(i+=" "),i+=r);return i}const qQ=e=>{if(typeof e=="string")return e;let t,r="";for(let i=0;i<e.length;i++)e[i]&&(t=qQ(e[i]))&&(r&&(r+=" "),r+=t);return r};function Wve(e,...t){let r,i,a,l=d;function d(p){const x=t.reduce((w,j)=>j(w),e());return r=Uve(x),i=r.cache.get,a=r.cache.set,l=s,s(p)}function s(p){const x=i(p);if(x)return x;const w=Hve(p,r);return a(p,w),w}return function(){return l(qve.apply(null,arguments))}}const Os=e=>{const t=r=>r[e]||[];return t.isThemeGetter=!0,t},WQ=/^\[(?:([a-z-]+):)?(.+)\]$/i,Kve=/^\d+\/\d+$/,Zve=new Set(["px","full","screen"]),Yve=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Xve=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,Jve=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,Qve=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,ebe=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Jh=e=>Rv(e)||Zve.has(e)||Kve.test(e),Uf=e=>g_(e,"length",lbe),Rv=e=>!!e&&!Number.isNaN(Number(e)),cO=e=>g_(e,"number",Rv),Ww=e=>!!e&&Number.isInteger(Number(e)),tbe=e=>e.endsWith("%")&&Rv(e.slice(0,-1)),ni=e=>WQ.test(e),Gf=e=>Yve.test(e),rbe=new Set(["length","size","percentage"]),nbe=e=>g_(e,rbe,KQ),ibe=e=>g_(e,"position",KQ),sbe=new Set(["image","url"]),abe=e=>g_(e,sbe,ube),obe=e=>g_(e,"",cbe),Kw=()=>!0,g_=(e,t,r)=>{const i=WQ.exec(e);return i?i[1]?typeof t=="string"?i[1]===t:t.has(i[1]):r(i[2]):!1},lbe=e=>Xve.test(e)&&!Jve.test(e),KQ=()=>!1,cbe=e=>Qve.test(e),ube=e=>ebe.test(e),dbe=()=>{const e=Os("colors"),t=Os("spacing"),r=Os("blur"),i=Os("brightness"),a=Os("borderColor"),l=Os("borderRadius"),d=Os("borderSpacing"),s=Os("borderWidth"),p=Os("contrast"),x=Os("grayscale"),w=Os("hueRotate"),j=Os("invert"),S=Os("gap"),P=Os("gradientColorStops"),F=Os("gradientColorStopPositions"),L=Os("inset"),B=Os("margin"),V=Os("opacity"),$=Os("padding"),G=Os("saturate"),W=Os("scale"),Z=Os("sepia"),se=Os("skew"),ae=Os("space"),ce=Os("translate"),Pe=()=>["auto","contain","none"],we=()=>["auto","hidden","clip","visible","scroll"],xe=()=>["auto",ni,t],Ne=()=>[ni,t],ze=()=>["",Jh,Uf],ye=()=>["auto",Rv,ni],ve=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],_e=()=>["solid","dashed","dotted","double","none"],Ee=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],je=()=>["start","end","center","between","around","evenly","stretch"],Ce=()=>["","0",ni],tt=()=>["auto","avoid","all","avoid-page","page","left","right","column"],it=()=>[Rv,ni];return{cacheSize:500,separator:":",theme:{colors:[Kw],spacing:[Jh,Uf],blur:["none","",Gf,ni],brightness:it(),borderColor:[e],borderRadius:["none","","full",Gf,ni],borderSpacing:Ne(),borderWidth:ze(),contrast:it(),grayscale:Ce(),hueRotate:it(),invert:Ce(),gap:Ne(),gradientColorStops:[e],gradientColorStopPositions:[tbe,Uf],inset:xe(),margin:xe(),opacity:it(),padding:Ne(),saturate:it(),scale:it(),sepia:Ce(),skew:it(),space:Ne(),translate:Ne()},classGroups:{aspect:[{aspect:["auto","square","video",ni]}],container:["container"],columns:[{columns:[Gf]}],"break-after":[{"break-after":tt()}],"break-before":[{"break-before":tt()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...ve(),ni]}],overflow:[{overflow:we()}],"overflow-x":[{"overflow-x":we()}],"overflow-y":[{"overflow-y":we()}],overscroll:[{overscroll:Pe()}],"overscroll-x":[{"overscroll-x":Pe()}],"overscroll-y":[{"overscroll-y":Pe()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[L]}],"inset-x":[{"inset-x":[L]}],"inset-y":[{"inset-y":[L]}],start:[{start:[L]}],end:[{end:[L]}],top:[{top:[L]}],right:[{right:[L]}],bottom:[{bottom:[L]}],left:[{left:[L]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Ww,ni]}],basis:[{basis:xe()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",ni]}],grow:[{grow:Ce()}],shrink:[{shrink:Ce()}],order:[{order:["first","last","none",Ww,ni]}],"grid-cols":[{"grid-cols":[Kw]}],"col-start-end":[{col:["auto",{span:["full",Ww,ni]},ni]}],"col-start":[{"col-start":ye()}],"col-end":[{"col-end":ye()}],"grid-rows":[{"grid-rows":[Kw]}],"row-start-end":[{row:["auto",{span:[Ww,ni]},ni]}],"row-start":[{"row-start":ye()}],"row-end":[{"row-end":ye()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",ni]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",ni]}],gap:[{gap:[S]}],"gap-x":[{"gap-x":[S]}],"gap-y":[{"gap-y":[S]}],"justify-content":[{justify:["normal",...je()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...je(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...je(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[$]}],px:[{px:[$]}],py:[{py:[$]}],ps:[{ps:[$]}],pe:[{pe:[$]}],pt:[{pt:[$]}],pr:[{pr:[$]}],pb:[{pb:[$]}],pl:[{pl:[$]}],m:[{m:[B]}],mx:[{mx:[B]}],my:[{my:[B]}],ms:[{ms:[B]}],me:[{me:[B]}],mt:[{mt:[B]}],mr:[{mr:[B]}],mb:[{mb:[B]}],ml:[{ml:[B]}],"space-x":[{"space-x":[ae]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[ae]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",ni,t]}],"min-w":[{"min-w":[ni,t,"min","max","fit"]}],"max-w":[{"max-w":[ni,t,"none","full","min","max","fit","prose",{screen:[Gf]},Gf]}],h:[{h:[ni,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[ni,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[ni,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[ni,t,"auto","min","max","fit"]}],"font-size":[{text:["base",Gf,Uf]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",cO]}],"font-family":[{font:[Kw]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",ni]}],"line-clamp":[{"line-clamp":["none",Rv,cO]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Jh,ni]}],"list-image":[{"list-image":["none",ni]}],"list-style-type":[{list:["none","disc","decimal",ni]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[V]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[V]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[..._e(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Jh,Uf]}],"underline-offset":[{"underline-offset":["auto",Jh,ni]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:Ne()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",ni]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",ni]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[V]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...ve(),ibe]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",nbe]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},abe]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[F]}],"gradient-via-pos":[{via:[F]}],"gradient-to-pos":[{to:[F]}],"gradient-from":[{from:[P]}],"gradient-via":[{via:[P]}],"gradient-to":[{to:[P]}],rounded:[{rounded:[l]}],"rounded-s":[{"rounded-s":[l]}],"rounded-e":[{"rounded-e":[l]}],"rounded-t":[{"rounded-t":[l]}],"rounded-r":[{"rounded-r":[l]}],"rounded-b":[{"rounded-b":[l]}],"rounded-l":[{"rounded-l":[l]}],"rounded-ss":[{"rounded-ss":[l]}],"rounded-se":[{"rounded-se":[l]}],"rounded-ee":[{"rounded-ee":[l]}],"rounded-es":[{"rounded-es":[l]}],"rounded-tl":[{"rounded-tl":[l]}],"rounded-tr":[{"rounded-tr":[l]}],"rounded-br":[{"rounded-br":[l]}],"rounded-bl":[{"rounded-bl":[l]}],"border-w":[{border:[s]}],"border-w-x":[{"border-x":[s]}],"border-w-y":[{"border-y":[s]}],"border-w-s":[{"border-s":[s]}],"border-w-e":[{"border-e":[s]}],"border-w-t":[{"border-t":[s]}],"border-w-r":[{"border-r":[s]}],"border-w-b":[{"border-b":[s]}],"border-w-l":[{"border-l":[s]}],"border-opacity":[{"border-opacity":[V]}],"border-style":[{border:[..._e(),"hidden"]}],"divide-x":[{"divide-x":[s]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[s]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[V]}],"divide-style":[{divide:_e()}],"border-color":[{border:[a]}],"border-color-x":[{"border-x":[a]}],"border-color-y":[{"border-y":[a]}],"border-color-s":[{"border-s":[a]}],"border-color-e":[{"border-e":[a]}],"border-color-t":[{"border-t":[a]}],"border-color-r":[{"border-r":[a]}],"border-color-b":[{"border-b":[a]}],"border-color-l":[{"border-l":[a]}],"divide-color":[{divide:[a]}],"outline-style":[{outline:["",..._e()]}],"outline-offset":[{"outline-offset":[Jh,ni]}],"outline-w":[{outline:[Jh,Uf]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:ze()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[V]}],"ring-offset-w":[{"ring-offset":[Jh,Uf]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",Gf,obe]}],"shadow-color":[{shadow:[Kw]}],opacity:[{opacity:[V]}],"mix-blend":[{"mix-blend":[...Ee(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":Ee()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[i]}],contrast:[{contrast:[p]}],"drop-shadow":[{"drop-shadow":["","none",Gf,ni]}],grayscale:[{grayscale:[x]}],"hue-rotate":[{"hue-rotate":[w]}],invert:[{invert:[j]}],saturate:[{saturate:[G]}],sepia:[{sepia:[Z]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[i]}],"backdrop-contrast":[{"backdrop-contrast":[p]}],"backdrop-grayscale":[{"backdrop-grayscale":[x]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[w]}],"backdrop-invert":[{"backdrop-invert":[j]}],"backdrop-opacity":[{"backdrop-opacity":[V]}],"backdrop-saturate":[{"backdrop-saturate":[G]}],"backdrop-sepia":[{"backdrop-sepia":[Z]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[d]}],"border-spacing-x":[{"border-spacing-x":[d]}],"border-spacing-y":[{"border-spacing-y":[d]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",ni]}],duration:[{duration:it()}],ease:[{ease:["linear","in","out","in-out",ni]}],delay:[{delay:it()}],animate:[{animate:["none","spin","ping","pulse","bounce",ni]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[W]}],"scale-x":[{"scale-x":[W]}],"scale-y":[{"scale-y":[W]}],rotate:[{rotate:[Ww,ni]}],"translate-x":[{"translate-x":[ce]}],"translate-y":[{"translate-y":[ce]}],"skew-x":[{"skew-x":[se]}],"skew-y":[{"skew-y":[se]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",ni]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",ni]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":Ne()}],"scroll-mx":[{"scroll-mx":Ne()}],"scroll-my":[{"scroll-my":Ne()}],"scroll-ms":[{"scroll-ms":Ne()}],"scroll-me":[{"scroll-me":Ne()}],"scroll-mt":[{"scroll-mt":Ne()}],"scroll-mr":[{"scroll-mr":Ne()}],"scroll-mb":[{"scroll-mb":Ne()}],"scroll-ml":[{"scroll-ml":Ne()}],"scroll-p":[{"scroll-p":Ne()}],"scroll-px":[{"scroll-px":Ne()}],"scroll-py":[{"scroll-py":Ne()}],"scroll-ps":[{"scroll-ps":Ne()}],"scroll-pe":[{"scroll-pe":Ne()}],"scroll-pt":[{"scroll-pt":Ne()}],"scroll-pr":[{"scroll-pr":Ne()}],"scroll-pb":[{"scroll-pb":Ne()}],"scroll-pl":[{"scroll-pl":Ne()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",ni]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[Jh,Uf,cO]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},hbe=Wve(dbe);function Yt(...e){return hbe(zn(e))}const mbe=Bye,ZQ=U.forwardRef(({className:e,...t},r)=>n.jsx(yQ,{ref:r,className:Yt("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",e),...t}));ZQ.displayName=yQ.displayName;const fbe=rg("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),YQ=U.forwardRef(({className:e,variant:t,...r},i)=>n.jsx(vQ,{ref:i,className:Yt(fbe({variant:t}),e),...r}));YQ.displayName=vQ.displayName;const pbe=U.forwardRef(({className:e,...t},r)=>n.jsx(wQ,{ref:r,className:Yt("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",e),...t}));pbe.displayName=wQ.displayName;const XQ=U.forwardRef(({className:e,...t},r)=>n.jsx(jQ,{ref:r,className:Yt("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",e),"toast-close":"",...t,children:n.jsx(Pc,{className:"h-4 w-4"})}));XQ.displayName=jQ.displayName;const JQ=U.forwardRef(({className:e,...t},r)=>n.jsx(bQ,{ref:r,className:Yt("text-sm font-semibold",e),...t}));JQ.displayName=bQ.displayName;const QQ=U.forwardRef(({className:e,...t},r)=>n.jsx(_Q,{ref:r,className:Yt("text-sm opacity-90",e),...t}));QQ.displayName=_Q.displayName;const gbe=20,G9=1e3,gu={ADD_TOAST:"ADD_TOAST",UPDATE_TOAST:"UPDATE_TOAST",DISMISS_TOAST:"DISMISS_TOAST",REMOVE_TOAST:"REMOVE_TOAST"};let xbe=0;function eee(){return(++xbe).toString()}let Oj=()=>{};const ybe=e=>{Oj=e},vbe=new Map;function H9(e,t){const r=setTimeout(()=>{Oj({type:gu.REMOVE_TOAST,toastId:e})},t);return vbe.set(e,r),r}const bbe=(e,t)=>{switch(t.type){case gu.ADD_TOAST:return{...e,toasts:[t.toast,...e.toasts].slice(0,gbe)};case gu.UPDATE_TOAST:return{...e,toasts:e.toasts.map(r=>r.id===t.toast.id?{...r,...t.toast}:r)};case gu.DISMISS_TOAST:{const{toastId:r}=t;return r?H9(r,G9):e.toasts.forEach(i=>{H9(i.id,G9)}),{...e,toasts:e.toasts.map(i=>i.id===r||r===void 0?{...i,open:!1}:i)}}case gu.REMOVE_TOAST:return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(r=>r.id!==t.toastId)};default:return e}},tee=U.createContext({state:{toasts:[]},dispatch:()=>{}});function _be({children:e}){const[t,r]=U.useReducer(bbe,{toasts:[]});return U.useEffect(()=>{ybe(r)},[r]),n.jsxs(tee.Provider,{value:{state:t,dispatch:r},children:[n.jsx("div",{id:"toast-provider",style:{display:"none"}}),e]})}function wbe(){const e=U.useContext(tee);if(!e)throw new Error("useToastContext must be used within a ToastProvider");return e}function Ah(){const{state:e,dispatch:t}=wbe();return{toast:i=>{const a=eee(),l=s=>t({type:gu.UPDATE_TOAST,toast:{...s,id:a}}),d=()=>t({type:gu.DISMISS_TOAST,toastId:a});return t({type:gu.ADD_TOAST,toast:{...i,id:a,open:!0,onOpenChange:s=>{s||d()}}}),{id:a,dismiss:d,update:l}},dismiss:i=>t({type:gu.DISMISS_TOAST,toastId:i}),toasts:e.toasts}}function za(e){const t=eee(),r=a=>Oj({type:gu.UPDATE_TOAST,toast:{...a,id:t}}),i=()=>Oj({type:gu.DISMISS_TOAST,toastId:t});return Oj({type:gu.ADD_TOAST,toast:{...e,id:t,open:!0,onOpenChange:a=>{a||i()}}}),{id:t,dismiss:i,update:r}}function jbe(){const{toasts:e}=Ah();return n.jsxs(mbe,{children:[e.map(function({id:t,title:r,description:i,action:a,...l}){return n.jsxs(YQ,{...l,children:[n.jsxs("div",{className:"grid gap-1",children:[r&&n.jsx(JQ,{children:r}),i&&n.jsx(QQ,{children:i})]}),a,n.jsx(XQ,{})]},t)}),n.jsx(ZQ,{})]})}var Nbe=e=>{switch(e){case"success":return Abe;case"info":return kbe;case"warning":return Tbe;case"error":return Pbe;default:return null}},Sbe=Array(12).fill(0),Cbe=({visible:e})=>ke.createElement("div",{className:"sonner-loading-wrapper","data-visible":e},ke.createElement("div",{className:"sonner-spinner"},Sbe.map((t,r)=>ke.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${r}`})))),Abe=ke.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},ke.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),Tbe=ke.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},ke.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),kbe=ke.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},ke.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),Pbe=ke.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},ke.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),Ebe=()=>{let[e,t]=ke.useState(document.hidden);return ke.useEffect(()=>{let r=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",r),()=>window.removeEventListener("visibilitychange",r)},[]),e},qD=1,Mbe=class{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{let t=this.subscribers.indexOf(e);this.subscribers.splice(t,1)}),this.publish=e=>{this.subscribers.forEach(t=>t(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var t;let{message:r,...i}=e,a=typeof(e==null?void 0:e.id)=="number"||((t=e.id)==null?void 0:t.length)>0?e.id:qD++,l=this.toasts.find(s=>s.id===a),d=e.dismissible===void 0?!0:e.dismissible;return l?this.toasts=this.toasts.map(s=>s.id===a?(this.publish({...s,...e,id:a,title:r}),{...s,...e,id:a,dismissible:d,title:r}):s):this.addToast({title:r,...i,dismissible:d,id:a}),a},this.dismiss=e=>(e||this.toasts.forEach(t=>{this.subscribers.forEach(r=>r({id:t.id,dismiss:!0}))}),this.subscribers.forEach(t=>t({id:e,dismiss:!0})),e),this.message=(e,t)=>this.create({...t,message:e}),this.error=(e,t)=>this.create({...t,message:e,type:"error"}),this.success=(e,t)=>this.create({...t,type:"success",message:e}),this.info=(e,t)=>this.create({...t,type:"info",message:e}),this.warning=(e,t)=>this.create({...t,type:"warning",message:e}),this.loading=(e,t)=>this.create({...t,type:"loading",message:e}),this.promise=(e,t)=>{if(!t)return;let r;t.loading!==void 0&&(r=this.create({...t,promise:e,type:"loading",message:t.loading,description:typeof t.description!="function"?t.description:void 0}));let i=e instanceof Promise?e:e(),a=r!==void 0;return i.then(async l=>{if(Obe(l)&&!l.ok){a=!1;let d=typeof t.error=="function"?await t.error(`HTTP error! status: ${l.status}`):t.error,s=typeof t.description=="function"?await t.description(`HTTP error! status: ${l.status}`):t.description;this.create({id:r,type:"error",message:d,description:s})}else if(t.success!==void 0){a=!1;let d=typeof t.success=="function"?await t.success(l):t.success,s=typeof t.description=="function"?await t.description(l):t.description;this.create({id:r,type:"success",message:d,description:s})}}).catch(async l=>{if(t.error!==void 0){a=!1;let d=typeof t.error=="function"?await t.error(l):t.error,s=typeof t.description=="function"?await t.description(l):t.description;this.create({id:r,type:"error",message:d,description:s})}}).finally(()=>{var l;a&&(this.dismiss(r),r=void 0),(l=t.finally)==null||l.call(t)}),r},this.custom=(e,t)=>{let r=(t==null?void 0:t.id)||qD++;return this.create({jsx:e(r),id:r,...t}),r},this.subscribers=[],this.toasts=[]}},_c=new Mbe,Ibe=(e,t)=>{let r=(t==null?void 0:t.id)||qD++;return _c.addToast({title:e,...t,id:r}),r},Obe=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",Rbe=Ibe,Dbe=()=>_c.toasts,Ls=Object.assign(Rbe,{success:_c.success,info:_c.info,warning:_c.warning,error:_c.error,custom:_c.custom,message:_c.message,promise:_c.promise,dismiss:_c.dismiss,loading:_c.loading},{getHistory:Dbe});function zbe(e,{insertAt:t}={}){if(typeof document>"u")return;let r=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css",t==="top"&&r.firstChild?r.insertBefore(i,r.firstChild):r.appendChild(i),i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e))}zbe(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999}:where([data-sonner-toaster][data-x-position="right"]){right:max(var(--offset),env(safe-area-inset-right))}:where([data-sonner-toaster][data-x-position="left"]){left:max(var(--offset),env(safe-area-inset-left))}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:max(var(--offset),env(safe-area-inset-top))}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:max(var(--offset),env(safe-area-inset-bottom))}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;background:var(--gray1);color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:0;right:0;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount, 0px));transition:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation:swipe-out .2s ease-out forwards}@keyframes swipe-out{0%{transform:translateY(calc(var(--lift) * var(--offset) + var(--swipe-amount)));opacity:1}to{transform:translateY(calc(var(--lift) * var(--offset) + var(--swipe-amount) + var(--lift) * -100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;--mobile-offset: 16px;right:var(--mobile-offset);left:var(--mobile-offset);width:100%}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset)}[data-sonner-toaster][data-y-position=bottom]{bottom:20px}[data-sonner-toaster][data-y-position=top]{top:20px}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset);right:var(--mobile-offset);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function OA(e){return e.label!==void 0}var Lbe=3,Fbe="32px",Bbe=4e3,$be=356,Vbe=14,Ube=20,Gbe=200;function Hbe(...e){return e.filter(Boolean).join(" ")}var qbe=e=>{var t,r,i,a,l,d,s,p,x,w;let{invert:j,toast:S,unstyled:P,interacting:F,setHeights:L,visibleToasts:B,heights:V,index:$,toasts:G,expanded:W,removeToast:Z,defaultRichColors:se,closeButton:ae,style:ce,cancelButtonStyle:Pe,actionButtonStyle:we,className:xe="",descriptionClassName:Ne="",duration:ze,position:ye,gap:ve,loadingIcon:_e,expandByDefault:Ee,classNames:je,icons:Ce,closeButtonAriaLabel:tt="Close toast",pauseWhenPageIsHidden:it,cn:mt}=e,[gt,qt]=ke.useState(!1),[yr,tr]=ke.useState(!1),[Ft,er]=ke.useState(!1),[Dt,ge]=ke.useState(!1),[sr,St]=ke.useState(0),[jr,dt]=ke.useState(0),Yr=ke.useRef(null),Vr=ke.useRef(null),Yn=$===0,Ye=$+1<=B,Nt=S.type,zt=S.dismissible!==!1,Nr=S.className||"",br=S.descriptionClassName||"",hr=ke.useMemo(()=>V.findIndex(Ir=>Ir.toastId===S.id)||0,[V,S.id]),rr=ke.useMemo(()=>{var Ir;return(Ir=S.closeButton)!=null?Ir:ae},[S.closeButton,ae]),an=ke.useMemo(()=>S.duration||ze||Bbe,[S.duration,ze]),ai=ke.useRef(0),ri=ke.useRef(0),Ui=ke.useRef(0),oa=ke.useRef(null),[Xs,rl]=ye.split("-"),Il=ke.useMemo(()=>V.reduce((Ir,wi,gi)=>gi>=hr?Ir:Ir+wi.height,0),[V,hr]),xo=Ebe(),nl=S.invert||j,Vs=Nt==="loading";ri.current=ke.useMemo(()=>hr*ve+Il,[hr,Il]),ke.useEffect(()=>{qt(!0)},[]),ke.useLayoutEffect(()=>{if(!gt)return;let Ir=Vr.current,wi=Ir.style.height;Ir.style.height="auto";let gi=Ir.getBoundingClientRect().height;Ir.style.height=wi,dt(gi),L(Ji=>Ji.find(la=>la.toastId===S.id)?Ji.map(la=>la.toastId===S.id?{...la,height:gi}:la):[{toastId:S.id,height:gi,position:S.position},...Ji])},[gt,S.title,S.description,L,S.id]);let Ua=ke.useCallback(()=>{tr(!0),St(ri.current),L(Ir=>Ir.filter(wi=>wi.toastId!==S.id)),setTimeout(()=>{Z(S)},Gbe)},[S,Z,L,ri]);ke.useEffect(()=>{if(S.promise&&Nt==="loading"||S.duration===1/0||S.type==="loading")return;let Ir,wi=an;return W||F||it&&xo?(()=>{if(Ui.current<ai.current){let gi=new Date().getTime()-ai.current;wi=wi-gi}Ui.current=new Date().getTime()})():wi!==1/0&&(ai.current=new Date().getTime(),Ir=setTimeout(()=>{var gi;(gi=S.onAutoClose)==null||gi.call(S,S),Ua()},wi)),()=>clearTimeout(Ir)},[W,F,Ee,S,an,Ua,S.promise,Nt,it,xo]),ke.useEffect(()=>{let Ir=Vr.current;if(Ir){let wi=Ir.getBoundingClientRect().height;return dt(wi),L(gi=>[{toastId:S.id,height:wi,position:S.position},...gi]),()=>L(gi=>gi.filter(Ji=>Ji.toastId!==S.id))}},[L,S.id]),ke.useEffect(()=>{S.delete&&Ua()},[Ua,S.delete]);function _i(){return Ce!=null&&Ce.loading?ke.createElement("div",{className:"sonner-loader","data-visible":Nt==="loading"},Ce.loading):_e?ke.createElement("div",{className:"sonner-loader","data-visible":Nt==="loading"},_e):ke.createElement(Cbe,{visible:Nt==="loading"})}return ke.createElement("li",{"aria-live":S.important?"assertive":"polite","aria-atomic":"true",role:"status",tabIndex:0,ref:Vr,className:mt(xe,Nr,je==null?void 0:je.toast,(t=S==null?void 0:S.classNames)==null?void 0:t.toast,je==null?void 0:je.default,je==null?void 0:je[Nt],(r=S==null?void 0:S.classNames)==null?void 0:r[Nt]),"data-sonner-toast":"","data-rich-colors":(i=S.richColors)!=null?i:se,"data-styled":!(S.jsx||S.unstyled||P),"data-mounted":gt,"data-promise":!!S.promise,"data-removed":yr,"data-visible":Ye,"data-y-position":Xs,"data-x-position":rl,"data-index":$,"data-front":Yn,"data-swiping":Ft,"data-dismissible":zt,"data-type":Nt,"data-invert":nl,"data-swipe-out":Dt,"data-expanded":!!(W||Ee&&gt),style:{"--index":$,"--toasts-before":$,"--z-index":G.length-$,"--offset":`${yr?sr:ri.current}px`,"--initial-height":Ee?"auto":`${jr}px`,...ce,...S.style},onPointerDown:Ir=>{Vs||!zt||(Yr.current=new Date,St(ri.current),Ir.target.setPointerCapture(Ir.pointerId),Ir.target.tagName!=="BUTTON"&&(er(!0),oa.current={x:Ir.clientX,y:Ir.clientY}))},onPointerUp:()=>{var Ir,wi,gi,Ji;if(Dt||!zt)return;oa.current=null;let la=Number(((Ir=Vr.current)==null?void 0:Ir.style.getPropertyValue("--swipe-amount").replace("px",""))||0),Ol=new Date().getTime()-((wi=Yr.current)==null?void 0:wi.getTime()),Kc=Math.abs(la)/Ol;if(Math.abs(la)>=Ube||Kc>.11){St(ri.current),(gi=S.onDismiss)==null||gi.call(S,S),Ua(),ge(!0);return}(Ji=Vr.current)==null||Ji.style.setProperty("--swipe-amount","0px"),er(!1)},onPointerMove:Ir=>{var wi;if(!oa.current||!zt)return;let gi=Ir.clientY-oa.current.y,Ji=Ir.clientX-oa.current.x,la=(Xs==="top"?Math.min:Math.max)(0,gi),Ol=Ir.pointerType==="touch"?10:2;Math.abs(la)>Ol?(wi=Vr.current)==null||wi.style.setProperty("--swipe-amount",`${gi}px`):Math.abs(Ji)>Ol&&(oa.current=null)}},rr&&!S.jsx?ke.createElement("button",{"aria-label":tt,"data-disabled":Vs,"data-close-button":!0,onClick:Vs||!zt?()=>{}:()=>{var Ir;Ua(),(Ir=S.onDismiss)==null||Ir.call(S,S)},className:mt(je==null?void 0:je.closeButton,(a=S==null?void 0:S.classNames)==null?void 0:a.closeButton)},ke.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},ke.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),ke.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"}))):null,S.jsx||ke.isValidElement(S.title)?S.jsx||S.title:ke.createElement(ke.Fragment,null,Nt||S.icon||S.promise?ke.createElement("div",{"data-icon":"",className:mt(je==null?void 0:je.icon,(l=S==null?void 0:S.classNames)==null?void 0:l.icon)},S.promise||S.type==="loading"&&!S.icon?S.icon||_i():null,S.type!=="loading"?S.icon||(Ce==null?void 0:Ce[Nt])||Nbe(Nt):null):null,ke.createElement("div",{"data-content":"",className:mt(je==null?void 0:je.content,(d=S==null?void 0:S.classNames)==null?void 0:d.content)},ke.createElement("div",{"data-title":"",className:mt(je==null?void 0:je.title,(s=S==null?void 0:S.classNames)==null?void 0:s.title)},S.title),S.description?ke.createElement("div",{"data-description":"",className:mt(Ne,br,je==null?void 0:je.description,(p=S==null?void 0:S.classNames)==null?void 0:p.description)},S.description):null),ke.isValidElement(S.cancel)?S.cancel:S.cancel&&OA(S.cancel)?ke.createElement("button",{"data-button":!0,"data-cancel":!0,style:S.cancelButtonStyle||Pe,onClick:Ir=>{var wi,gi;OA(S.cancel)&&zt&&((gi=(wi=S.cancel).onClick)==null||gi.call(wi,Ir),Ua())},className:mt(je==null?void 0:je.cancelButton,(x=S==null?void 0:S.classNames)==null?void 0:x.cancelButton)},S.cancel.label):null,ke.isValidElement(S.action)?S.action:S.action&&OA(S.action)?ke.createElement("button",{"data-button":!0,"data-action":!0,style:S.actionButtonStyle||we,onClick:Ir=>{var wi,gi;OA(S.action)&&(Ir.defaultPrevented||((gi=(wi=S.action).onClick)==null||gi.call(wi,Ir),Ua()))},className:mt(je==null?void 0:je.actionButton,(w=S==null?void 0:S.classNames)==null?void 0:w.actionButton)},S.action.label):null))};function q9(){if(typeof window>"u"||typeof document>"u")return"ltr";let e=document.documentElement.getAttribute("dir");return e==="auto"||!e?window.getComputedStyle(document.documentElement).direction:e}var Wbe=e=>{let{invert:t,position:r="bottom-right",hotkey:i=["altKey","KeyT"],expand:a,closeButton:l,className:d,offset:s,theme:p="light",richColors:x,duration:w,style:j,visibleToasts:S=Lbe,toastOptions:P,dir:F=q9(),gap:L=Vbe,loadingIcon:B,icons:V,containerAriaLabel:$="Notifications",pauseWhenPageIsHidden:G,cn:W=Hbe}=e,[Z,se]=ke.useState([]),ae=ke.useMemo(()=>Array.from(new Set([r].concat(Z.filter(it=>it.position).map(it=>it.position)))),[Z,r]),[ce,Pe]=ke.useState([]),[we,xe]=ke.useState(!1),[Ne,ze]=ke.useState(!1),[ye,ve]=ke.useState(p!=="system"?p:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),_e=ke.useRef(null),Ee=i.join("+").replace(/Key/g,"").replace(/Digit/g,""),je=ke.useRef(null),Ce=ke.useRef(!1),tt=ke.useCallback(it=>{var mt;(mt=Z.find(gt=>gt.id===it.id))!=null&&mt.delete||_c.dismiss(it.id),se(gt=>gt.filter(({id:qt})=>qt!==it.id))},[Z]);return ke.useEffect(()=>_c.subscribe(it=>{if(it.dismiss){se(mt=>mt.map(gt=>gt.id===it.id?{...gt,delete:!0}:gt));return}setTimeout(()=>{KJ.flushSync(()=>{se(mt=>{let gt=mt.findIndex(qt=>qt.id===it.id);return gt!==-1?[...mt.slice(0,gt),{...mt[gt],...it},...mt.slice(gt+1)]:[it,...mt]})})})}),[]),ke.useEffect(()=>{if(p!=="system"){ve(p);return}p==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?ve("dark"):ve("light")),typeof window<"u"&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",({matches:it})=>{ve(it?"dark":"light")})},[p]),ke.useEffect(()=>{Z.length<=1&&xe(!1)},[Z]),ke.useEffect(()=>{let it=mt=>{var gt,qt;i.every(yr=>mt[yr]||mt.code===yr)&&(xe(!0),(gt=_e.current)==null||gt.focus()),mt.code==="Escape"&&(document.activeElement===_e.current||(qt=_e.current)!=null&&qt.contains(document.activeElement))&&xe(!1)};return document.addEventListener("keydown",it),()=>document.removeEventListener("keydown",it)},[i]),ke.useEffect(()=>{if(_e.current)return()=>{je.current&&(je.current.focus({preventScroll:!0}),je.current=null,Ce.current=!1)}},[_e.current]),Z.length?ke.createElement("section",{"aria-label":`${$} ${Ee}`,tabIndex:-1},ae.map((it,mt)=>{var gt;let[qt,yr]=it.split("-");return ke.createElement("ol",{key:it,dir:F==="auto"?q9():F,tabIndex:-1,ref:_e,className:d,"data-sonner-toaster":!0,"data-theme":ye,"data-y-position":qt,"data-x-position":yr,style:{"--front-toast-height":`${((gt=ce[0])==null?void 0:gt.height)||0}px`,"--offset":typeof s=="number"?`${s}px`:s||Fbe,"--width":`${$be}px`,"--gap":`${L}px`,...j},onBlur:tr=>{Ce.current&&!tr.currentTarget.contains(tr.relatedTarget)&&(Ce.current=!1,je.current&&(je.current.focus({preventScroll:!0}),je.current=null))},onFocus:tr=>{tr.target instanceof HTMLElement&&tr.target.dataset.dismissible==="false"||Ce.current||(Ce.current=!0,je.current=tr.relatedTarget)},onMouseEnter:()=>xe(!0),onMouseMove:()=>xe(!0),onMouseLeave:()=>{Ne||xe(!1)},onPointerDown:tr=>{tr.target instanceof HTMLElement&&tr.target.dataset.dismissible==="false"||ze(!0)},onPointerUp:()=>ze(!1)},Z.filter(tr=>!tr.position&&mt===0||tr.position===it).map((tr,Ft)=>{var er,Dt;return ke.createElement(qbe,{key:tr.id,icons:V,index:Ft,toast:tr,defaultRichColors:x,duration:(er=P==null?void 0:P.duration)!=null?er:w,className:P==null?void 0:P.className,descriptionClassName:P==null?void 0:P.descriptionClassName,invert:t,visibleToasts:S,closeButton:(Dt=P==null?void 0:P.closeButton)!=null?Dt:l,interacting:Ne,position:it,style:P==null?void 0:P.style,unstyled:P==null?void 0:P.unstyled,classNames:P==null?void 0:P.classNames,cancelButtonStyle:P==null?void 0:P.cancelButtonStyle,actionButtonStyle:P==null?void 0:P.actionButtonStyle,removeToast:tt,toasts:Z.filter(ge=>ge.position==tr.position),heights:ce.filter(ge=>ge.position==tr.position),setHeights:Pe,expandByDefault:a,gap:L,loadingIcon:B,expanded:we,pauseWhenPageIsHidden:G,cn:W})}))})):null};const Kbe=({...e})=>n.jsx(Wbe,{theme:"dark",className:"toaster group",...e});var Zbe=HY.useId||(()=>{}),Ybe=0;function rc(e){const[t,r]=U.useState(Zbe());return Ba(()=>{e||r(i=>i??String(Ybe++))},[e]),e||(t?`radix-${t}`:"")}const Xbe=["top","right","bottom","left"],Up=Math.min,Nc=Math.max,dk=Math.round,RA=Math.floor,Gp=e=>({x:e,y:e}),Jbe={left:"right",right:"left",bottom:"top",top:"bottom"},Qbe={start:"end",end:"start"};function WD(e,t,r){return Nc(e,Up(t,r))}function km(e,t){return typeof e=="function"?e(t):e}function Pm(e){return e.split("-")[0]}function x_(e){return e.split("-")[1]}function $F(e){return e==="x"?"y":"x"}function VF(e){return e==="y"?"height":"width"}function Hp(e){return["top","bottom"].includes(Pm(e))?"y":"x"}function UF(e){return $F(Hp(e))}function e_e(e,t,r){r===void 0&&(r=!1);const i=x_(e),a=UF(e),l=VF(a);let d=a==="x"?i===(r?"end":"start")?"right":"left":i==="start"?"bottom":"top";return t.reference[l]>t.floating[l]&&(d=hk(d)),[d,hk(d)]}function t_e(e){const t=hk(e);return[KD(e),t,KD(t)]}function KD(e){return e.replace(/start|end/g,t=>Qbe[t])}function r_e(e,t,r){const i=["left","right"],a=["right","left"],l=["top","bottom"],d=["bottom","top"];switch(e){case"top":case"bottom":return r?t?a:i:t?i:a;case"left":case"right":return t?l:d;default:return[]}}function n_e(e,t,r,i){const a=x_(e);let l=r_e(Pm(e),r==="start",i);return a&&(l=l.map(d=>d+"-"+a),t&&(l=l.concat(l.map(KD)))),l}function hk(e){return e.replace(/left|right|bottom|top/g,t=>Jbe[t])}function i_e(e){return{top:0,right:0,bottom:0,left:0,...e}}function ree(e){return typeof e!="number"?i_e(e):{top:e,right:e,bottom:e,left:e}}function mk(e){const{x:t,y:r,width:i,height:a}=e;return{width:i,height:a,top:r,left:t,right:t+i,bottom:r+a,x:t,y:r}}function W9(e,t,r){let{reference:i,floating:a}=e;const l=Hp(t),d=UF(t),s=VF(d),p=Pm(t),x=l==="y",w=i.x+i.width/2-a.width/2,j=i.y+i.height/2-a.height/2,S=i[s]/2-a[s]/2;let P;switch(p){case"top":P={x:w,y:i.y-a.height};break;case"bottom":P={x:w,y:i.y+i.height};break;case"right":P={x:i.x+i.width,y:j};break;case"left":P={x:i.x-a.width,y:j};break;default:P={x:i.x,y:i.y}}switch(x_(t)){case"start":P[d]-=S*(r&&x?-1:1);break;case"end":P[d]+=S*(r&&x?-1:1);break}return P}const s_e=async(e,t,r)=>{const{placement:i="bottom",strategy:a="absolute",middleware:l=[],platform:d}=r,s=l.filter(Boolean),p=await(d.isRTL==null?void 0:d.isRTL(t));let x=await d.getElementRects({reference:e,floating:t,strategy:a}),{x:w,y:j}=W9(x,i,p),S=i,P={},F=0;for(let L=0;L<s.length;L++){const{name:B,fn:V}=s[L],{x:$,y:G,data:W,reset:Z}=await V({x:w,y:j,initialPlacement:i,placement:S,strategy:a,middlewareData:P,rects:x,platform:d,elements:{reference:e,floating:t}});w=$??w,j=G??j,P={...P,[B]:{...P[B],...W}},Z&&F<=50&&(F++,typeof Z=="object"&&(Z.placement&&(S=Z.placement),Z.rects&&(x=Z.rects===!0?await d.getElementRects({reference:e,floating:t,strategy:a}):Z.rects),{x:w,y:j}=W9(x,S,p)),L=-1)}return{x:w,y:j,placement:S,strategy:a,middlewareData:P}};async function y2(e,t){var r;t===void 0&&(t={});const{x:i,y:a,platform:l,rects:d,elements:s,strategy:p}=e,{boundary:x="clippingAncestors",rootBoundary:w="viewport",elementContext:j="floating",altBoundary:S=!1,padding:P=0}=km(t,e),F=ree(P),B=s[S?j==="floating"?"reference":"floating":j],V=mk(await l.getClippingRect({element:(r=await(l.isElement==null?void 0:l.isElement(B)))==null||r?B:B.contextElement||await(l.getDocumentElement==null?void 0:l.getDocumentElement(s.floating)),boundary:x,rootBoundary:w,strategy:p})),$=j==="floating"?{x:i,y:a,width:d.floating.width,height:d.floating.height}:d.reference,G=await(l.getOffsetParent==null?void 0:l.getOffsetParent(s.floating)),W=await(l.isElement==null?void 0:l.isElement(G))?await(l.getScale==null?void 0:l.getScale(G))||{x:1,y:1}:{x:1,y:1},Z=mk(l.convertOffsetParentRelativeRectToViewportRelativeRect?await l.convertOffsetParentRelativeRectToViewportRelativeRect({elements:s,rect:$,offsetParent:G,strategy:p}):$);return{top:(V.top-Z.top+F.top)/W.y,bottom:(Z.bottom-V.bottom+F.bottom)/W.y,left:(V.left-Z.left+F.left)/W.x,right:(Z.right-V.right+F.right)/W.x}}const a_e=e=>({name:"arrow",options:e,async fn(t){const{x:r,y:i,placement:a,rects:l,platform:d,elements:s,middlewareData:p}=t,{element:x,padding:w=0}=km(e,t)||{};if(x==null)return{};const j=ree(w),S={x:r,y:i},P=UF(a),F=VF(P),L=await d.getDimensions(x),B=P==="y",V=B?"top":"left",$=B?"bottom":"right",G=B?"clientHeight":"clientWidth",W=l.reference[F]+l.reference[P]-S[P]-l.floating[F],Z=S[P]-l.reference[P],se=await(d.getOffsetParent==null?void 0:d.getOffsetParent(x));let ae=se?se[G]:0;(!ae||!await(d.isElement==null?void 0:d.isElement(se)))&&(ae=s.floating[G]||l.floating[F]);const ce=W/2-Z/2,Pe=ae/2-L[F]/2-1,we=Up(j[V],Pe),xe=Up(j[$],Pe),Ne=we,ze=ae-L[F]-xe,ye=ae/2-L[F]/2+ce,ve=WD(Ne,ye,ze),_e=!p.arrow&&x_(a)!=null&&ye!==ve&&l.reference[F]/2-(ye<Ne?we:xe)-L[F]/2<0,Ee=_e?ye<Ne?ye-Ne:ye-ze:0;return{[P]:S[P]+Ee,data:{[P]:ve,centerOffset:ye-ve-Ee,..._e&&{alignmentOffset:Ee}},reset:_e}}}),o_e=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var r,i;const{placement:a,middlewareData:l,rects:d,initialPlacement:s,platform:p,elements:x}=t,{mainAxis:w=!0,crossAxis:j=!0,fallbackPlacements:S,fallbackStrategy:P="bestFit",fallbackAxisSideDirection:F="none",flipAlignment:L=!0,...B}=km(e,t);if((r=l.arrow)!=null&&r.alignmentOffset)return{};const V=Pm(a),$=Hp(s),G=Pm(s)===s,W=await(p.isRTL==null?void 0:p.isRTL(x.floating)),Z=S||(G||!L?[hk(s)]:t_e(s)),se=F!=="none";!S&&se&&Z.push(...n_e(s,L,F,W));const ae=[s,...Z],ce=await y2(t,B),Pe=[];let we=((i=l.flip)==null?void 0:i.overflows)||[];if(w&&Pe.push(ce[V]),j){const ye=e_e(a,d,W);Pe.push(ce[ye[0]],ce[ye[1]])}if(we=[...we,{placement:a,overflows:Pe}],!Pe.every(ye=>ye<=0)){var xe,Ne;const ye=(((xe=l.flip)==null?void 0:xe.index)||0)+1,ve=ae[ye];if(ve)return{data:{index:ye,overflows:we},reset:{placement:ve}};let _e=(Ne=we.filter(Ee=>Ee.overflows[0]<=0).sort((Ee,je)=>Ee.overflows[1]-je.overflows[1])[0])==null?void 0:Ne.placement;if(!_e)switch(P){case"bestFit":{var ze;const Ee=(ze=we.filter(je=>{if(se){const Ce=Hp(je.placement);return Ce===$||Ce==="y"}return!0}).map(je=>[je.placement,je.overflows.filter(Ce=>Ce>0).reduce((Ce,tt)=>Ce+tt,0)]).sort((je,Ce)=>je[1]-Ce[1])[0])==null?void 0:ze[0];Ee&&(_e=Ee);break}case"initialPlacement":_e=s;break}if(a!==_e)return{reset:{placement:_e}}}return{}}}};function K9(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function Z9(e){return Xbe.some(t=>e[t]>=0)}const l_e=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:r}=t,{strategy:i="referenceHidden",...a}=km(e,t);switch(i){case"referenceHidden":{const l=await y2(t,{...a,elementContext:"reference"}),d=K9(l,r.reference);return{data:{referenceHiddenOffsets:d,referenceHidden:Z9(d)}}}case"escaped":{const l=await y2(t,{...a,altBoundary:!0}),d=K9(l,r.floating);return{data:{escapedOffsets:d,escaped:Z9(d)}}}default:return{}}}}};async function c_e(e,t){const{placement:r,platform:i,elements:a}=e,l=await(i.isRTL==null?void 0:i.isRTL(a.floating)),d=Pm(r),s=x_(r),p=Hp(r)==="y",x=["left","top"].includes(d)?-1:1,w=l&&p?-1:1,j=km(t,e);let{mainAxis:S,crossAxis:P,alignmentAxis:F}=typeof j=="number"?{mainAxis:j,crossAxis:0,alignmentAxis:null}:{mainAxis:j.mainAxis||0,crossAxis:j.crossAxis||0,alignmentAxis:j.alignmentAxis};return s&&typeof F=="number"&&(P=s==="end"?F*-1:F),p?{x:P*w,y:S*x}:{x:S*x,y:P*w}}const u_e=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var r,i;const{x:a,y:l,placement:d,middlewareData:s}=t,p=await c_e(t,e);return d===((r=s.offset)==null?void 0:r.placement)&&(i=s.arrow)!=null&&i.alignmentOffset?{}:{x:a+p.x,y:l+p.y,data:{...p,placement:d}}}}},d_e=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:r,y:i,placement:a}=t,{mainAxis:l=!0,crossAxis:d=!1,limiter:s={fn:B=>{let{x:V,y:$}=B;return{x:V,y:$}}},...p}=km(e,t),x={x:r,y:i},w=await y2(t,p),j=Hp(Pm(a)),S=$F(j);let P=x[S],F=x[j];if(l){const B=S==="y"?"top":"left",V=S==="y"?"bottom":"right",$=P+w[B],G=P-w[V];P=WD($,P,G)}if(d){const B=j==="y"?"top":"left",V=j==="y"?"bottom":"right",$=F+w[B],G=F-w[V];F=WD($,F,G)}const L=s.fn({...t,[S]:P,[j]:F});return{...L,data:{x:L.x-r,y:L.y-i,enabled:{[S]:l,[j]:d}}}}}},h_e=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:r,y:i,placement:a,rects:l,middlewareData:d}=t,{offset:s=0,mainAxis:p=!0,crossAxis:x=!0}=km(e,t),w={x:r,y:i},j=Hp(a),S=$F(j);let P=w[S],F=w[j];const L=km(s,t),B=typeof L=="number"?{mainAxis:L,crossAxis:0}:{mainAxis:0,crossAxis:0,...L};if(p){const G=S==="y"?"height":"width",W=l.reference[S]-l.floating[G]+B.mainAxis,Z=l.reference[S]+l.reference[G]-B.mainAxis;P<W?P=W:P>Z&&(P=Z)}if(x){var V,$;const G=S==="y"?"width":"height",W=["top","left"].includes(Pm(a)),Z=l.reference[j]-l.floating[G]+(W&&((V=d.offset)==null?void 0:V[j])||0)+(W?0:B.crossAxis),se=l.reference[j]+l.reference[G]+(W?0:(($=d.offset)==null?void 0:$[j])||0)-(W?B.crossAxis:0);F<Z?F=Z:F>se&&(F=se)}return{[S]:P,[j]:F}}}},m_e=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var r,i;const{placement:a,rects:l,platform:d,elements:s}=t,{apply:p=()=>{},...x}=km(e,t),w=await y2(t,x),j=Pm(a),S=x_(a),P=Hp(a)==="y",{width:F,height:L}=l.floating;let B,V;j==="top"||j==="bottom"?(B=j,V=S===(await(d.isRTL==null?void 0:d.isRTL(s.floating))?"start":"end")?"left":"right"):(V=j,B=S==="end"?"top":"bottom");const $=L-w.top-w.bottom,G=F-w.left-w.right,W=Up(L-w[B],$),Z=Up(F-w[V],G),se=!t.middlewareData.shift;let ae=W,ce=Z;if((r=t.middlewareData.shift)!=null&&r.enabled.x&&(ce=G),(i=t.middlewareData.shift)!=null&&i.enabled.y&&(ae=$),se&&!S){const we=Nc(w.left,0),xe=Nc(w.right,0),Ne=Nc(w.top,0),ze=Nc(w.bottom,0);P?ce=F-2*(we!==0||xe!==0?we+xe:Nc(w.left,w.right)):ae=L-2*(Ne!==0||ze!==0?Ne+ze:Nc(w.top,w.bottom))}await p({...t,availableWidth:ce,availableHeight:ae});const Pe=await d.getDimensions(s.floating);return F!==Pe.width||L!==Pe.height?{reset:{rects:!0}}:{}}}};function SE(){return typeof window<"u"}function y_(e){return nee(e)?(e.nodeName||"").toLowerCase():"#document"}function Ec(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function Th(e){var t;return(t=(nee(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function nee(e){return SE()?e instanceof Node||e instanceof Ec(e).Node:!1}function _d(e){return SE()?e instanceof Element||e instanceof Ec(e).Element:!1}function yh(e){return SE()?e instanceof HTMLElement||e instanceof Ec(e).HTMLElement:!1}function Y9(e){return!SE()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof Ec(e).ShadowRoot}function VN(e){const{overflow:t,overflowX:r,overflowY:i,display:a}=wd(e);return/auto|scroll|overlay|hidden|clip/.test(t+i+r)&&!["inline","contents"].includes(a)}function f_e(e){return["table","td","th"].includes(y_(e))}function CE(e){return[":popover-open",":modal"].some(t=>{try{return e.matches(t)}catch{return!1}})}function GF(e){const t=HF(),r=_d(e)?wd(e):e;return r.transform!=="none"||r.perspective!=="none"||(r.containerType?r.containerType!=="normal":!1)||!t&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!t&&(r.filter?r.filter!=="none":!1)||["transform","perspective","filter"].some(i=>(r.willChange||"").includes(i))||["paint","layout","strict","content"].some(i=>(r.contain||"").includes(i))}function p_e(e){let t=qp(e);for(;yh(t)&&!mb(t);){if(GF(t))return t;if(CE(t))return null;t=qp(t)}return null}function HF(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function mb(e){return["html","body","#document"].includes(y_(e))}function wd(e){return Ec(e).getComputedStyle(e)}function AE(e){return _d(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function qp(e){if(y_(e)==="html")return e;const t=e.assignedSlot||e.parentNode||Y9(e)&&e.host||Th(e);return Y9(t)?t.host:t}function iee(e){const t=qp(e);return mb(t)?e.ownerDocument?e.ownerDocument.body:e.body:yh(t)&&VN(t)?t:iee(t)}function v2(e,t,r){var i;t===void 0&&(t=[]),r===void 0&&(r=!0);const a=iee(e),l=a===((i=e.ownerDocument)==null?void 0:i.body),d=Ec(a);if(l){const s=ZD(d);return t.concat(d,d.visualViewport||[],VN(a)?a:[],s&&r?v2(s):[])}return t.concat(a,v2(a,[],r))}function ZD(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function see(e){const t=wd(e);let r=parseFloat(t.width)||0,i=parseFloat(t.height)||0;const a=yh(e),l=a?e.offsetWidth:r,d=a?e.offsetHeight:i,s=dk(r)!==l||dk(i)!==d;return s&&(r=l,i=d),{width:r,height:i,$:s}}function qF(e){return _d(e)?e:e.contextElement}function Dv(e){const t=qF(e);if(!yh(t))return Gp(1);const r=t.getBoundingClientRect(),{width:i,height:a,$:l}=see(t);let d=(l?dk(r.width):r.width)/i,s=(l?dk(r.height):r.height)/a;return(!d||!Number.isFinite(d))&&(d=1),(!s||!Number.isFinite(s))&&(s=1),{x:d,y:s}}const g_e=Gp(0);function aee(e){const t=Ec(e);return!HF()||!t.visualViewport?g_e:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function x_e(e,t,r){return t===void 0&&(t=!1),!r||t&&r!==Ec(e)?!1:t}function rx(e,t,r,i){t===void 0&&(t=!1),r===void 0&&(r=!1);const a=e.getBoundingClientRect(),l=qF(e);let d=Gp(1);t&&(i?_d(i)&&(d=Dv(i)):d=Dv(e));const s=x_e(l,r,i)?aee(l):Gp(0);let p=(a.left+s.x)/d.x,x=(a.top+s.y)/d.y,w=a.width/d.x,j=a.height/d.y;if(l){const S=Ec(l),P=i&&_d(i)?Ec(i):i;let F=S,L=ZD(F);for(;L&&i&&P!==F;){const B=Dv(L),V=L.getBoundingClientRect(),$=wd(L),G=V.left+(L.clientLeft+parseFloat($.paddingLeft))*B.x,W=V.top+(L.clientTop+parseFloat($.paddingTop))*B.y;p*=B.x,x*=B.y,w*=B.x,j*=B.y,p+=G,x+=W,F=Ec(L),L=ZD(F)}}return mk({width:w,height:j,x:p,y:x})}function y_e(e){let{elements:t,rect:r,offsetParent:i,strategy:a}=e;const l=a==="fixed",d=Th(i),s=t?CE(t.floating):!1;if(i===d||s&&l)return r;let p={scrollLeft:0,scrollTop:0},x=Gp(1);const w=Gp(0),j=yh(i);if((j||!j&&!l)&&((y_(i)!=="body"||VN(d))&&(p=AE(i)),yh(i))){const S=rx(i);x=Dv(i),w.x=S.x+i.clientLeft,w.y=S.y+i.clientTop}return{width:r.width*x.x,height:r.height*x.y,x:r.x*x.x-p.scrollLeft*x.x+w.x,y:r.y*x.y-p.scrollTop*x.y+w.y}}function v_e(e){return Array.from(e.getClientRects())}function YD(e,t){const r=AE(e).scrollLeft;return t?t.left+r:rx(Th(e)).left+r}function b_e(e){const t=Th(e),r=AE(e),i=e.ownerDocument.body,a=Nc(t.scrollWidth,t.clientWidth,i.scrollWidth,i.clientWidth),l=Nc(t.scrollHeight,t.clientHeight,i.scrollHeight,i.clientHeight);let d=-r.scrollLeft+YD(e);const s=-r.scrollTop;return wd(i).direction==="rtl"&&(d+=Nc(t.clientWidth,i.clientWidth)-a),{width:a,height:l,x:d,y:s}}function __e(e,t){const r=Ec(e),i=Th(e),a=r.visualViewport;let l=i.clientWidth,d=i.clientHeight,s=0,p=0;if(a){l=a.width,d=a.height;const x=HF();(!x||x&&t==="fixed")&&(s=a.offsetLeft,p=a.offsetTop)}return{width:l,height:d,x:s,y:p}}function w_e(e,t){const r=rx(e,!0,t==="fixed"),i=r.top+e.clientTop,a=r.left+e.clientLeft,l=yh(e)?Dv(e):Gp(1),d=e.clientWidth*l.x,s=e.clientHeight*l.y,p=a*l.x,x=i*l.y;return{width:d,height:s,x:p,y:x}}function X9(e,t,r){let i;if(t==="viewport")i=__e(e,r);else if(t==="document")i=b_e(Th(e));else if(_d(t))i=w_e(t,r);else{const a=aee(e);i={...t,x:t.x-a.x,y:t.y-a.y}}return mk(i)}function oee(e,t){const r=qp(e);return r===t||!_d(r)||mb(r)?!1:wd(r).position==="fixed"||oee(r,t)}function j_e(e,t){const r=t.get(e);if(r)return r;let i=v2(e,[],!1).filter(s=>_d(s)&&y_(s)!=="body"),a=null;const l=wd(e).position==="fixed";let d=l?qp(e):e;for(;_d(d)&&!mb(d);){const s=wd(d),p=GF(d);!p&&s.position==="fixed"&&(a=null),(l?!p&&!a:!p&&s.position==="static"&&!!a&&["absolute","fixed"].includes(a.position)||VN(d)&&!p&&oee(e,d))?i=i.filter(w=>w!==d):a=s,d=qp(d)}return t.set(e,i),i}function N_e(e){let{element:t,boundary:r,rootBoundary:i,strategy:a}=e;const d=[...r==="clippingAncestors"?CE(t)?[]:j_e(t,this._c):[].concat(r),i],s=d[0],p=d.reduce((x,w)=>{const j=X9(t,w,a);return x.top=Nc(j.top,x.top),x.right=Up(j.right,x.right),x.bottom=Up(j.bottom,x.bottom),x.left=Nc(j.left,x.left),x},X9(t,s,a));return{width:p.right-p.left,height:p.bottom-p.top,x:p.left,y:p.top}}function S_e(e){const{width:t,height:r}=see(e);return{width:t,height:r}}function C_e(e,t,r){const i=yh(t),a=Th(t),l=r==="fixed",d=rx(e,!0,l,t);let s={scrollLeft:0,scrollTop:0};const p=Gp(0);if(i||!i&&!l)if((y_(t)!=="body"||VN(a))&&(s=AE(t)),i){const P=rx(t,!0,l,t);p.x=P.x+t.clientLeft,p.y=P.y+t.clientTop}else a&&(p.x=YD(a));let x=0,w=0;if(a&&!i&&!l){const P=a.getBoundingClientRect();w=P.top+s.scrollTop,x=P.left+s.scrollLeft-YD(a,P)}const j=d.left+s.scrollLeft-p.x-x,S=d.top+s.scrollTop-p.y-w;return{x:j,y:S,width:d.width,height:d.height}}function uO(e){return wd(e).position==="static"}function J9(e,t){if(!yh(e)||wd(e).position==="fixed")return null;if(t)return t(e);let r=e.offsetParent;return Th(e)===r&&(r=r.ownerDocument.body),r}function lee(e,t){const r=Ec(e);if(CE(e))return r;if(!yh(e)){let a=qp(e);for(;a&&!mb(a);){if(_d(a)&&!uO(a))return a;a=qp(a)}return r}let i=J9(e,t);for(;i&&f_e(i)&&uO(i);)i=J9(i,t);return i&&mb(i)&&uO(i)&&!GF(i)?r:i||p_e(e)||r}const A_e=async function(e){const t=this.getOffsetParent||lee,r=this.getDimensions,i=await r(e.floating);return{reference:C_e(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:i.width,height:i.height}}};function T_e(e){return wd(e).direction==="rtl"}const k_e={convertOffsetParentRelativeRectToViewportRelativeRect:y_e,getDocumentElement:Th,getClippingRect:N_e,getOffsetParent:lee,getElementRects:A_e,getClientRects:v_e,getDimensions:S_e,getScale:Dv,isElement:_d,isRTL:T_e};function P_e(e,t){let r=null,i;const a=Th(e);function l(){var s;clearTimeout(i),(s=r)==null||s.disconnect(),r=null}function d(s,p){s===void 0&&(s=!1),p===void 0&&(p=1),l();const{left:x,top:w,width:j,height:S}=e.getBoundingClientRect();if(s||t(),!j||!S)return;const P=RA(w),F=RA(a.clientWidth-(x+j)),L=RA(a.clientHeight-(w+S)),B=RA(x),$={rootMargin:-P+"px "+-F+"px "+-L+"px "+-B+"px",threshold:Nc(0,Up(1,p))||1};let G=!0;function W(Z){const se=Z[0].intersectionRatio;if(se!==p){if(!G)return d();se?d(!1,se):i=setTimeout(()=>{d(!1,1e-7)},1e3)}G=!1}try{r=new IntersectionObserver(W,{...$,root:a.ownerDocument})}catch{r=new IntersectionObserver(W,$)}r.observe(e)}return d(!0),l}function E_e(e,t,r,i){i===void 0&&(i={});const{ancestorScroll:a=!0,ancestorResize:l=!0,elementResize:d=typeof ResizeObserver=="function",layoutShift:s=typeof IntersectionObserver=="function",animationFrame:p=!1}=i,x=qF(e),w=a||l?[...x?v2(x):[],...v2(t)]:[];w.forEach(V=>{a&&V.addEventListener("scroll",r,{passive:!0}),l&&V.addEventListener("resize",r)});const j=x&&s?P_e(x,r):null;let S=-1,P=null;d&&(P=new ResizeObserver(V=>{let[$]=V;$&&$.target===x&&P&&(P.unobserve(t),cancelAnimationFrame(S),S=requestAnimationFrame(()=>{var G;(G=P)==null||G.observe(t)})),r()}),x&&!p&&P.observe(x),P.observe(t));let F,L=p?rx(e):null;p&&B();function B(){const V=rx(e);L&&(V.x!==L.x||V.y!==L.y||V.width!==L.width||V.height!==L.height)&&r(),L=V,F=requestAnimationFrame(B)}return r(),()=>{var V;w.forEach($=>{a&&$.removeEventListener("scroll",r),l&&$.removeEventListener("resize",r)}),j==null||j(),(V=P)==null||V.disconnect(),P=null,p&&cancelAnimationFrame(F)}}const M_e=u_e,I_e=d_e,O_e=o_e,R_e=m_e,D_e=l_e,Q9=a_e,z_e=h_e,L_e=(e,t,r)=>{const i=new Map,a={platform:k_e,...r},l={...a.platform,_c:i};return s_e(e,t,{...a,platform:l})};var AT=typeof document<"u"?U.useLayoutEffect:U.useEffect;function fk(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let r,i,a;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(r=e.length,r!==t.length)return!1;for(i=r;i--!==0;)if(!fk(e[i],t[i]))return!1;return!0}if(a=Object.keys(e),r=a.length,r!==Object.keys(t).length)return!1;for(i=r;i--!==0;)if(!{}.hasOwnProperty.call(t,a[i]))return!1;for(i=r;i--!==0;){const l=a[i];if(!(l==="_owner"&&e.$$typeof)&&!fk(e[l],t[l]))return!1}return!0}return e!==e&&t!==t}function cee(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function eG(e,t){const r=cee(e);return Math.round(t*r)/r}function dO(e){const t=U.useRef(e);return AT(()=>{t.current=e}),t}function F_e(e){e===void 0&&(e={});const{placement:t="bottom",strategy:r="absolute",middleware:i=[],platform:a,elements:{reference:l,floating:d}={},transform:s=!0,whileElementsMounted:p,open:x}=e,[w,j]=U.useState({x:0,y:0,strategy:r,placement:t,middlewareData:{},isPositioned:!1}),[S,P]=U.useState(i);fk(S,i)||P(i);const[F,L]=U.useState(null),[B,V]=U.useState(null),$=U.useCallback(je=>{je!==se.current&&(se.current=je,L(je))},[]),G=U.useCallback(je=>{je!==ae.current&&(ae.current=je,V(je))},[]),W=l||F,Z=d||B,se=U.useRef(null),ae=U.useRef(null),ce=U.useRef(w),Pe=p!=null,we=dO(p),xe=dO(a),Ne=dO(x),ze=U.useCallback(()=>{if(!se.current||!ae.current)return;const je={placement:t,strategy:r,middleware:S};xe.current&&(je.platform=xe.current),L_e(se.current,ae.current,je).then(Ce=>{const tt={...Ce,isPositioned:Ne.current!==!1};ye.current&&!fk(ce.current,tt)&&(ce.current=tt,tg.flushSync(()=>{j(tt)}))})},[S,t,r,xe,Ne]);AT(()=>{x===!1&&ce.current.isPositioned&&(ce.current.isPositioned=!1,j(je=>({...je,isPositioned:!1})))},[x]);const ye=U.useRef(!1);AT(()=>(ye.current=!0,()=>{ye.current=!1}),[]),AT(()=>{if(W&&(se.current=W),Z&&(ae.current=Z),W&&Z){if(we.current)return we.current(W,Z,ze);ze()}},[W,Z,ze,we,Pe]);const ve=U.useMemo(()=>({reference:se,floating:ae,setReference:$,setFloating:G}),[$,G]),_e=U.useMemo(()=>({reference:W,floating:Z}),[W,Z]),Ee=U.useMemo(()=>{const je={position:r,left:0,top:0};if(!_e.floating)return je;const Ce=eG(_e.floating,w.x),tt=eG(_e.floating,w.y);return s?{...je,transform:"translate("+Ce+"px, "+tt+"px)",...cee(_e.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:Ce,top:tt}},[r,s,_e.floating,w.x,w.y]);return U.useMemo(()=>({...w,update:ze,refs:ve,elements:_e,floatingStyles:Ee}),[w,ze,ve,_e,Ee])}const B_e=e=>{function t(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:e,fn(r){const{element:i,padding:a}=typeof e=="function"?e(r):e;return i&&t(i)?i.current!=null?Q9({element:i.current,padding:a}).fn(r):{}:i?Q9({element:i,padding:a}).fn(r):{}}}},$_e=(e,t)=>({...M_e(e),options:[e,t]}),V_e=(e,t)=>({...I_e(e),options:[e,t]}),U_e=(e,t)=>({...z_e(e),options:[e,t]}),G_e=(e,t)=>({...O_e(e),options:[e,t]}),H_e=(e,t)=>({...R_e(e),options:[e,t]}),q_e=(e,t)=>({...D_e(e),options:[e,t]}),W_e=(e,t)=>({...B_e(e),options:[e,t]});var K_e="Arrow",uee=U.forwardRef((e,t)=>{const{children:r,width:i=10,height:a=5,...l}=e;return n.jsx(Hr.svg,{...l,ref:t,width:i,height:a,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?r:n.jsx("polygon",{points:"0,0 30,0 15,10"})})});uee.displayName=K_e;var Z_e=uee;function Y_e(e,t=[]){let r=[];function i(l,d){const s=U.createContext(d),p=r.length;r=[...r,d];function x(j){const{scope:S,children:P,...F}=j,L=(S==null?void 0:S[e][p])||s,B=U.useMemo(()=>F,Object.values(F));return n.jsx(L.Provider,{value:B,children:P})}function w(j,S){const P=(S==null?void 0:S[e][p])||s,F=U.useContext(P);if(F)return F;if(d!==void 0)return d;throw new Error(`\`${j}\` must be used within \`${l}\``)}return x.displayName=l+"Provider",[x,w]}const a=()=>{const l=r.map(d=>U.createContext(d));return function(s){const p=(s==null?void 0:s[e])||l;return U.useMemo(()=>({[`__scope${e}`]:{...s,[e]:p}}),[s,p])}};return a.scopeName=e,[i,X_e(a,...t)]}function X_e(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const i=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(l){const d=i.reduce((s,{useScope:p,scopeName:x})=>{const j=p(l)[`__scope${x}`];return{...s,...j}},{});return U.useMemo(()=>({[`__scope${t.scopeName}`]:d}),[d])}};return r.scopeName=t.scopeName,r}function TE(e){const[t,r]=U.useState(void 0);return Ba(()=>{if(e){r({width:e.offsetWidth,height:e.offsetHeight});const i=new ResizeObserver(a=>{if(!Array.isArray(a)||!a.length)return;const l=a[0];let d,s;if("borderBoxSize"in l){const p=l.borderBoxSize,x=Array.isArray(p)?p[0]:p;d=x.inlineSize,s=x.blockSize}else d=e.offsetWidth,s=e.offsetHeight;r({width:d,height:s})});return i.observe(e,{box:"border-box"}),()=>i.unobserve(e)}else r(void 0)},[e]),t}var WF="Popper",[dee,ig]=Y_e(WF),[J_e,hee]=dee(WF),mee=e=>{const{__scopePopper:t,children:r}=e,[i,a]=U.useState(null);return n.jsx(J_e,{scope:t,anchor:i,onAnchorChange:a,children:r})};mee.displayName=WF;var fee="PopperAnchor",pee=U.forwardRef((e,t)=>{const{__scopePopper:r,virtualRef:i,...a}=e,l=hee(fee,r),d=U.useRef(null),s=Mn(t,d);return U.useEffect(()=>{l.onAnchorChange((i==null?void 0:i.current)||d.current)}),i?null:n.jsx(Hr.div,{...a,ref:s})});pee.displayName=fee;var KF="PopperContent",[Q_e,e1e]=dee(KF),gee=U.forwardRef((e,t)=>{var Ft,er,Dt,ge,sr,St;const{__scopePopper:r,side:i="bottom",sideOffset:a=0,align:l="center",alignOffset:d=0,arrowPadding:s=0,avoidCollisions:p=!0,collisionBoundary:x=[],collisionPadding:w=0,sticky:j="partial",hideWhenDetached:S=!1,updatePositionStrategy:P="optimized",onPlaced:F,...L}=e,B=hee(KF,r),[V,$]=U.useState(null),G=Mn(t,jr=>$(jr)),[W,Z]=U.useState(null),se=TE(W),ae=(se==null?void 0:se.width)??0,ce=(se==null?void 0:se.height)??0,Pe=i+(l!=="center"?"-"+l:""),we=typeof w=="number"?w:{top:0,right:0,bottom:0,left:0,...w},xe=Array.isArray(x)?x:[x],Ne=xe.length>0,ze={padding:we,boundary:xe.filter(r1e),altBoundary:Ne},{refs:ye,floatingStyles:ve,placement:_e,isPositioned:Ee,middlewareData:je}=F_e({strategy:"fixed",placement:Pe,whileElementsMounted:(...jr)=>E_e(...jr,{animationFrame:P==="always"}),elements:{reference:B.anchor},middleware:[$_e({mainAxis:a+ce,alignmentAxis:d}),p&&V_e({mainAxis:!0,crossAxis:!1,limiter:j==="partial"?U_e():void 0,...ze}),p&&G_e({...ze}),H_e({...ze,apply:({elements:jr,rects:dt,availableWidth:Yr,availableHeight:Vr})=>{const{width:Yn,height:Ye}=dt.reference,Nt=jr.floating.style;Nt.setProperty("--radix-popper-available-width",`${Yr}px`),Nt.setProperty("--radix-popper-available-height",`${Vr}px`),Nt.setProperty("--radix-popper-anchor-width",`${Yn}px`),Nt.setProperty("--radix-popper-anchor-height",`${Ye}px`)}}),W&&W_e({element:W,padding:s}),n1e({arrowWidth:ae,arrowHeight:ce}),S&&q_e({strategy:"referenceHidden",...ze})]}),[Ce,tt]=vee(_e),it=Ws(F);Ba(()=>{Ee&&(it==null||it())},[Ee,it]);const mt=(Ft=je.arrow)==null?void 0:Ft.x,gt=(er=je.arrow)==null?void 0:er.y,qt=((Dt=je.arrow)==null?void 0:Dt.centerOffset)!==0,[yr,tr]=U.useState();return Ba(()=>{V&&tr(window.getComputedStyle(V).zIndex)},[V]),n.jsx("div",{ref:ye.setFloating,"data-radix-popper-content-wrapper":"",style:{...ve,transform:Ee?ve.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:yr,"--radix-popper-transform-origin":[(ge=je.transformOrigin)==null?void 0:ge.x,(sr=je.transformOrigin)==null?void 0:sr.y].join(" "),...((St=je.hide)==null?void 0:St.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:n.jsx(Q_e,{scope:r,placedSide:Ce,onArrowChange:Z,arrowX:mt,arrowY:gt,shouldHideArrow:qt,children:n.jsx(Hr.div,{"data-side":Ce,"data-align":tt,...L,ref:G,style:{...L.style,animation:Ee?void 0:"none"}})})})});gee.displayName=KF;var xee="PopperArrow",t1e={top:"bottom",right:"left",bottom:"top",left:"right"},yee=U.forwardRef(function(t,r){const{__scopePopper:i,...a}=t,l=e1e(xee,i),d=t1e[l.placedSide];return n.jsx("span",{ref:l.onArrowChange,style:{position:"absolute",left:l.arrowX,top:l.arrowY,[d]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[l.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[l.placedSide],visibility:l.shouldHideArrow?"hidden":void 0},children:n.jsx(Z_e,{...a,ref:r,style:{...a.style,display:"block"}})})});yee.displayName=xee;function r1e(e){return e!==null}var n1e=e=>({name:"transformOrigin",options:e,fn(t){var B,V,$;const{placement:r,rects:i,middlewareData:a}=t,d=((B=a.arrow)==null?void 0:B.centerOffset)!==0,s=d?0:e.arrowWidth,p=d?0:e.arrowHeight,[x,w]=vee(r),j={start:"0%",center:"50%",end:"100%"}[w],S=(((V=a.arrow)==null?void 0:V.x)??0)+s/2,P=((($=a.arrow)==null?void 0:$.y)??0)+p/2;let F="",L="";return x==="bottom"?(F=d?j:`${S}px`,L=`${-p}px`):x==="top"?(F=d?j:`${S}px`,L=`${i.floating.height+p}px`):x==="right"?(F=`${-p}px`,L=d?j:`${P}px`):x==="left"&&(F=`${i.floating.width+p}px`,L=d?j:`${P}px`),{data:{x:F,y:L}}}});function vee(e){const[t,r="center"]=e.split("-");return[t,r]}var kE=mee,UN=pee,PE=gee,EE=yee,[ME,tft]=Jo("Tooltip",[ig]),IE=ig(),bee="TooltipProvider",i1e=700,XD="tooltip.open",[s1e,ZF]=ME(bee),YF=e=>{const{__scopeTooltip:t,delayDuration:r=i1e,skipDelayDuration:i=300,disableHoverableContent:a=!1,children:l}=e,[d,s]=U.useState(!0),p=U.useRef(!1),x=U.useRef(0);return U.useEffect(()=>{const w=x.current;return()=>window.clearTimeout(w)},[]),n.jsx(s1e,{scope:t,isOpenDelayed:d,delayDuration:r,onOpen:U.useCallback(()=>{window.clearTimeout(x.current),s(!1)},[]),onClose:U.useCallback(()=>{window.clearTimeout(x.current),x.current=window.setTimeout(()=>s(!0),i)},[i]),isPointerInTransitRef:p,onPointerInTransitChange:U.useCallback(w=>{p.current=w},[]),disableHoverableContent:a,children:l})};YF.displayName=bee;var OE="Tooltip",[a1e,RE]=ME(OE),_ee=e=>{const{__scopeTooltip:t,children:r,open:i,defaultOpen:a=!1,onOpenChange:l,disableHoverableContent:d,delayDuration:s}=e,p=ZF(OE,e.__scopeTooltip),x=IE(t),[w,j]=U.useState(null),S=rc(),P=U.useRef(0),F=d??p.disableHoverableContent,L=s??p.delayDuration,B=U.useRef(!1),[V=!1,$]=fo({prop:i,defaultProp:a,onChange:ae=>{ae?(p.onOpen(),document.dispatchEvent(new CustomEvent(XD))):p.onClose(),l==null||l(ae)}}),G=U.useMemo(()=>V?B.current?"delayed-open":"instant-open":"closed",[V]),W=U.useCallback(()=>{window.clearTimeout(P.current),P.current=0,B.current=!1,$(!0)},[$]),Z=U.useCallback(()=>{window.clearTimeout(P.current),P.current=0,$(!1)},[$]),se=U.useCallback(()=>{window.clearTimeout(P.current),P.current=window.setTimeout(()=>{B.current=!0,$(!0),P.current=0},L)},[L,$]);return U.useEffect(()=>()=>{P.current&&(window.clearTimeout(P.current),P.current=0)},[]),n.jsx(kE,{...x,children:n.jsx(a1e,{scope:t,contentId:S,open:V,stateAttribute:G,trigger:w,onTriggerChange:j,onTriggerEnter:U.useCallback(()=>{p.isOpenDelayed?se():W()},[p.isOpenDelayed,se,W]),onTriggerLeave:U.useCallback(()=>{F?Z():(window.clearTimeout(P.current),P.current=0)},[Z,F]),onOpen:W,onClose:Z,disableHoverableContent:F,children:r})})};_ee.displayName=OE;var JD="TooltipTrigger",wee=U.forwardRef((e,t)=>{const{__scopeTooltip:r,...i}=e,a=RE(JD,r),l=ZF(JD,r),d=IE(r),s=U.useRef(null),p=Mn(t,s,a.onTriggerChange),x=U.useRef(!1),w=U.useRef(!1),j=U.useCallback(()=>x.current=!1,[]);return U.useEffect(()=>()=>document.removeEventListener("pointerup",j),[j]),n.jsx(UN,{asChild:!0,...d,children:n.jsx(Hr.button,{"aria-describedby":a.open?a.contentId:void 0,"data-state":a.stateAttribute,...i,ref:p,onPointerMove:_r(e.onPointerMove,S=>{S.pointerType!=="touch"&&!w.current&&!l.isPointerInTransitRef.current&&(a.onTriggerEnter(),w.current=!0)}),onPointerLeave:_r(e.onPointerLeave,()=>{a.onTriggerLeave(),w.current=!1}),onPointerDown:_r(e.onPointerDown,()=>{x.current=!0,document.addEventListener("pointerup",j,{once:!0})}),onFocus:_r(e.onFocus,()=>{x.current||a.onOpen()}),onBlur:_r(e.onBlur,a.onClose),onClick:_r(e.onClick,a.onClose)})})});wee.displayName=JD;var o1e="TooltipPortal",[rft,l1e]=ME(o1e,{forceMount:void 0}),fb="TooltipContent",jee=U.forwardRef((e,t)=>{const r=l1e(fb,e.__scopeTooltip),{forceMount:i=r.forceMount,side:a="top",...l}=e,d=RE(fb,e.__scopeTooltip);return n.jsx(io,{present:i||d.open,children:d.disableHoverableContent?n.jsx(Nee,{side:a,...l,ref:t}):n.jsx(c1e,{side:a,...l,ref:t})})}),c1e=U.forwardRef((e,t)=>{const r=RE(fb,e.__scopeTooltip),i=ZF(fb,e.__scopeTooltip),a=U.useRef(null),l=Mn(t,a),[d,s]=U.useState(null),{trigger:p,onClose:x}=r,w=a.current,{onPointerInTransitChange:j}=i,S=U.useCallback(()=>{s(null),j(!1)},[j]),P=U.useCallback((F,L)=>{const B=F.currentTarget,V={x:F.clientX,y:F.clientY},$=m1e(V,B.getBoundingClientRect()),G=f1e(V,$),W=p1e(L.getBoundingClientRect()),Z=x1e([...G,...W]);s(Z),j(!0)},[j]);return U.useEffect(()=>()=>S(),[S]),U.useEffect(()=>{if(p&&w){const F=B=>P(B,w),L=B=>P(B,p);return p.addEventListener("pointerleave",F),w.addEventListener("pointerleave",L),()=>{p.removeEventListener("pointerleave",F),w.removeEventListener("pointerleave",L)}}},[p,w,P,S]),U.useEffect(()=>{if(d){const F=L=>{const B=L.target,V={x:L.clientX,y:L.clientY},$=(p==null?void 0:p.contains(B))||(w==null?void 0:w.contains(B)),G=!g1e(V,d);$?S():G&&(S(),x())};return document.addEventListener("pointermove",F),()=>document.removeEventListener("pointermove",F)}},[p,w,d,x,S]),n.jsx(Nee,{...e,ref:l})}),[u1e,d1e]=ME(OE,{isInside:!1}),Nee=U.forwardRef((e,t)=>{const{__scopeTooltip:r,children:i,"aria-label":a,onEscapeKeyDown:l,onPointerDownOutside:d,...s}=e,p=RE(fb,r),x=IE(r),{onClose:w}=p;return U.useEffect(()=>(document.addEventListener(XD,w),()=>document.removeEventListener(XD,w)),[w]),U.useEffect(()=>{if(p.trigger){const j=S=>{const P=S.target;P!=null&&P.contains(p.trigger)&&w()};return window.addEventListener("scroll",j,{capture:!0}),()=>window.removeEventListener("scroll",j,{capture:!0})}},[p.trigger,w]),n.jsx(yx,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:l,onPointerDownOutside:d,onFocusOutside:j=>j.preventDefault(),onDismiss:w,children:n.jsxs(PE,{"data-state":p.stateAttribute,...x,...s,ref:t,style:{...s.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[n.jsx(SF,{children:i}),n.jsx(u1e,{scope:r,isInside:!0,children:n.jsx(wye,{id:p.contentId,role:"tooltip",children:a||i})})]})})});jee.displayName=fb;var See="TooltipArrow",h1e=U.forwardRef((e,t)=>{const{__scopeTooltip:r,...i}=e,a=IE(r);return d1e(See,r).isInside?null:n.jsx(EE,{...a,...i,ref:t})});h1e.displayName=See;function m1e(e,t){const r=Math.abs(t.top-e.y),i=Math.abs(t.bottom-e.y),a=Math.abs(t.right-e.x),l=Math.abs(t.left-e.x);switch(Math.min(r,i,a,l)){case l:return"left";case a:return"right";case r:return"top";case i:return"bottom";default:throw new Error("unreachable")}}function f1e(e,t,r=5){const i=[];switch(t){case"top":i.push({x:e.x-r,y:e.y+r},{x:e.x+r,y:e.y+r});break;case"bottom":i.push({x:e.x-r,y:e.y-r},{x:e.x+r,y:e.y-r});break;case"left":i.push({x:e.x+r,y:e.y-r},{x:e.x+r,y:e.y+r});break;case"right":i.push({x:e.x-r,y:e.y-r},{x:e.x-r,y:e.y+r});break}return i}function p1e(e){const{top:t,right:r,bottom:i,left:a}=e;return[{x:a,y:t},{x:r,y:t},{x:r,y:i},{x:a,y:i}]}function g1e(e,t){const{x:r,y:i}=e;let a=!1;for(let l=0,d=t.length-1;l<t.length;d=l++){const s=t[l].x,p=t[l].y,x=t[d].x,w=t[d].y;p>i!=w>i&&r<(x-s)*(i-p)/(w-p)+s&&(a=!a)}return a}function x1e(e){const t=e.slice();return t.sort((r,i)=>r.x<i.x?-1:r.x>i.x?1:r.y<i.y?-1:r.y>i.y?1:0),y1e(t)}function y1e(e){if(e.length<=1)return e.slice();const t=[];for(let i=0;i<e.length;i++){const a=e[i];for(;t.length>=2;){const l=t[t.length-1],d=t[t.length-2];if((l.x-d.x)*(a.y-d.y)>=(l.y-d.y)*(a.x-d.x))t.pop();else break}t.push(a)}t.pop();const r=[];for(let i=e.length-1;i>=0;i--){const a=e[i];for(;r.length>=2;){const l=r[r.length-1],d=r[r.length-2];if((l.x-d.x)*(a.y-d.y)>=(l.y-d.y)*(a.x-d.x))r.pop();else break}r.push(a)}return r.pop(),t.length===1&&r.length===1&&t[0].x===r[0].x&&t[0].y===r[0].y?t:t.concat(r)}var v1e=YF,b1e=_ee,_1e=wee,Cee=jee;const XF=v1e,DE=b1e,zE=_1e,GN=U.forwardRef(({className:e,sideOffset:t=4,...r},i)=>n.jsx(Cee,{ref:i,sideOffset:t,className:Yt("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r}));GN.displayName=Cee.displayName;/**
 * @remix-run/router v1.20.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function b2(){return b2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},b2.apply(this,arguments)}var bp;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(bp||(bp={}));const tG="popstate";function w1e(e){e===void 0&&(e={});function t(i,a){let{pathname:l,search:d,hash:s}=i.location;return QD("",{pathname:l,search:d,hash:s},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function r(i,a){return typeof a=="string"?a:pk(a)}return N1e(t,r,null,e)}function La(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Aee(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function j1e(){return Math.random().toString(36).substr(2,8)}function rG(e,t){return{usr:e.state,key:e.key,idx:t}}function QD(e,t,r,i){return r===void 0&&(r=null),b2({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?v_(t):t,{state:r,key:t&&t.key||i||j1e()})}function pk(e){let{pathname:t="/",search:r="",hash:i=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),i&&i!=="#"&&(t+=i.charAt(0)==="#"?i:"#"+i),t}function v_(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let i=e.indexOf("?");i>=0&&(t.search=e.substr(i),e=e.substr(0,i)),e&&(t.pathname=e)}return t}function N1e(e,t,r,i){i===void 0&&(i={});let{window:a=document.defaultView,v5Compat:l=!1}=i,d=a.history,s=bp.Pop,p=null,x=w();x==null&&(x=0,d.replaceState(b2({},d.state,{idx:x}),""));function w(){return(d.state||{idx:null}).idx}function j(){s=bp.Pop;let B=w(),V=B==null?null:B-x;x=B,p&&p({action:s,location:L.location,delta:V})}function S(B,V){s=bp.Push;let $=QD(L.location,B,V);x=w()+1;let G=rG($,x),W=L.createHref($);try{d.pushState(G,"",W)}catch(Z){if(Z instanceof DOMException&&Z.name==="DataCloneError")throw Z;a.location.assign(W)}l&&p&&p({action:s,location:L.location,delta:1})}function P(B,V){s=bp.Replace;let $=QD(L.location,B,V);x=w();let G=rG($,x),W=L.createHref($);d.replaceState(G,"",W),l&&p&&p({action:s,location:L.location,delta:0})}function F(B){let V=a.location.origin!=="null"?a.location.origin:a.location.href,$=typeof B=="string"?B:pk(B);return $=$.replace(/ $/,"%20"),La(V,"No window.location.(origin|href) available to create URL for href: "+$),new URL($,V)}let L={get action(){return s},get location(){return e(a,d)},listen(B){if(p)throw new Error("A history only accepts one active listener");return a.addEventListener(tG,j),p=B,()=>{a.removeEventListener(tG,j),p=null}},createHref(B){return t(a,B)},createURL:F,encodeLocation(B){let V=F(B);return{pathname:V.pathname,search:V.search,hash:V.hash}},push:S,replace:P,go(B){return d.go(B)}};return L}var nG;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(nG||(nG={}));function S1e(e,t,r){return r===void 0&&(r="/"),C1e(e,t,r,!1)}function C1e(e,t,r,i){let a=typeof t=="string"?v_(t):t,l=JF(a.pathname||"/",r);if(l==null)return null;let d=Tee(e);A1e(d);let s=null;for(let p=0;s==null&&p<d.length;++p){let x=L1e(l);s=D1e(d[p],x,i)}return s}function Tee(e,t,r,i){t===void 0&&(t=[]),r===void 0&&(r=[]),i===void 0&&(i="");let a=(l,d,s)=>{let p={relativePath:s===void 0?l.path||"":s,caseSensitive:l.caseSensitive===!0,childrenIndex:d,route:l};p.relativePath.startsWith("/")&&(La(p.relativePath.startsWith(i),'Absolute route path "'+p.relativePath+'" nested under path '+('"'+i+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),p.relativePath=p.relativePath.slice(i.length));let x=Mp([i,p.relativePath]),w=r.concat(p);l.children&&l.children.length>0&&(La(l.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+x+'".')),Tee(l.children,t,w,x)),!(l.path==null&&!l.index)&&t.push({path:x,score:O1e(x,l.index),routesMeta:w})};return e.forEach((l,d)=>{var s;if(l.path===""||!((s=l.path)!=null&&s.includes("?")))a(l,d);else for(let p of kee(l.path))a(l,d,p)}),t}function kee(e){let t=e.split("/");if(t.length===0)return[];let[r,...i]=t,a=r.endsWith("?"),l=r.replace(/\?$/,"");if(i.length===0)return a?[l,""]:[l];let d=kee(i.join("/")),s=[];return s.push(...d.map(p=>p===""?l:[l,p].join("/"))),a&&s.push(...d),s.map(p=>e.startsWith("/")&&p===""?"/":p)}function A1e(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:R1e(t.routesMeta.map(i=>i.childrenIndex),r.routesMeta.map(i=>i.childrenIndex)))}const T1e=/^:[\w-]+$/,k1e=3,P1e=2,E1e=1,M1e=10,I1e=-2,iG=e=>e==="*";function O1e(e,t){let r=e.split("/"),i=r.length;return r.some(iG)&&(i+=I1e),t&&(i+=P1e),r.filter(a=>!iG(a)).reduce((a,l)=>a+(T1e.test(l)?k1e:l===""?E1e:M1e),i)}function R1e(e,t){return e.length===t.length&&e.slice(0,-1).every((i,a)=>i===t[a])?e[e.length-1]-t[t.length-1]:0}function D1e(e,t,r){let{routesMeta:i}=e,a={},l="/",d=[];for(let s=0;s<i.length;++s){let p=i[s],x=s===i.length-1,w=l==="/"?t:t.slice(l.length)||"/",j=sG({path:p.relativePath,caseSensitive:p.caseSensitive,end:x},w),S=p.route;if(!j&&x&&r&&!i[i.length-1].route.index&&(j=sG({path:p.relativePath,caseSensitive:p.caseSensitive,end:!1},w)),!j)return null;Object.assign(a,j.params),d.push({params:a,pathname:Mp([l,j.pathname]),pathnameBase:V1e(Mp([l,j.pathnameBase])),route:S}),j.pathnameBase!=="/"&&(l=Mp([l,j.pathnameBase]))}return d}function sG(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,i]=z1e(e.path,e.caseSensitive,e.end),a=t.match(r);if(!a)return null;let l=a[0],d=l.replace(/(.)\/+$/,"$1"),s=a.slice(1);return{params:i.reduce((x,w,j)=>{let{paramName:S,isOptional:P}=w;if(S==="*"){let L=s[j]||"";d=l.slice(0,l.length-L.length).replace(/(.)\/+$/,"$1")}const F=s[j];return P&&!F?x[S]=void 0:x[S]=(F||"").replace(/%2F/g,"/"),x},{}),pathname:l,pathnameBase:d,pattern:e}}function z1e(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),Aee(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let i=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(d,s,p)=>(i.push({paramName:s,isOptional:p!=null}),p?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(i.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),i]}function L1e(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Aee(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function JF(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,i=e.charAt(r);return i&&i!=="/"?null:e.slice(r)||"/"}function F1e(e,t){t===void 0&&(t="/");let{pathname:r,search:i="",hash:a=""}=typeof e=="string"?v_(e):e;return{pathname:r?r.startsWith("/")?r:B1e(r,t):t,search:U1e(i),hash:G1e(a)}}function B1e(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function hO(e,t,r,i){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(i)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function $1e(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function Pee(e,t){let r=$1e(e);return t?r.map((i,a)=>a===r.length-1?i.pathname:i.pathnameBase):r.map(i=>i.pathnameBase)}function Eee(e,t,r,i){i===void 0&&(i=!1);let a;typeof e=="string"?a=v_(e):(a=b2({},e),La(!a.pathname||!a.pathname.includes("?"),hO("?","pathname","search",a)),La(!a.pathname||!a.pathname.includes("#"),hO("#","pathname","hash",a)),La(!a.search||!a.search.includes("#"),hO("#","search","hash",a)));let l=e===""||a.pathname==="",d=l?"/":a.pathname,s;if(d==null)s=r;else{let j=t.length-1;if(!i&&d.startsWith("..")){let S=d.split("/");for(;S[0]==="..";)S.shift(),j-=1;a.pathname=S.join("/")}s=j>=0?t[j]:"/"}let p=F1e(a,s),x=d&&d!=="/"&&d.endsWith("/"),w=(l||d===".")&&r.endsWith("/");return!p.pathname.endsWith("/")&&(x||w)&&(p.pathname+="/"),p}const Mp=e=>e.join("/").replace(/\/\/+/g,"/"),V1e=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),U1e=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,G1e=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function H1e(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const Mee=["post","put","patch","delete"];new Set(Mee);const q1e=["get",...Mee];new Set(q1e);/**
 * React Router v6.27.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _2(){return _2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},_2.apply(this,arguments)}const QF=U.createContext(null),W1e=U.createContext(null),bx=U.createContext(null),LE=U.createContext(null),_x=U.createContext({outlet:null,matches:[],isDataRoute:!1}),Iee=U.createContext(null);function K1e(e,t){let{relative:r}=t===void 0?{}:t;HN()||La(!1);let{basename:i,navigator:a}=U.useContext(bx),{hash:l,pathname:d,search:s}=Ree(e,{relative:r}),p=d;return i!=="/"&&(p=d==="/"?i:Mp([i,d])),a.createHref({pathname:p,search:s,hash:l})}function HN(){return U.useContext(LE)!=null}function qN(){return HN()||La(!1),U.useContext(LE).location}function Oee(e){U.useContext(bx).static||U.useLayoutEffect(e)}function eB(){let{isDataRoute:e}=U.useContext(_x);return e?owe():Z1e()}function Z1e(){HN()||La(!1);let e=U.useContext(QF),{basename:t,future:r,navigator:i}=U.useContext(bx),{matches:a}=U.useContext(_x),{pathname:l}=qN(),d=JSON.stringify(Pee(a,r.v7_relativeSplatPath)),s=U.useRef(!1);return Oee(()=>{s.current=!0}),U.useCallback(function(x,w){if(w===void 0&&(w={}),!s.current)return;if(typeof x=="number"){i.go(x);return}let j=Eee(x,JSON.parse(d),l,w.relative==="path");e==null&&t!=="/"&&(j.pathname=j.pathname==="/"?t:Mp([t,j.pathname])),(w.replace?i.replace:i.push)(j,w.state,w)},[t,i,d,l,e])}function Ree(e,t){let{relative:r}=t===void 0?{}:t,{future:i}=U.useContext(bx),{matches:a}=U.useContext(_x),{pathname:l}=qN(),d=JSON.stringify(Pee(a,i.v7_relativeSplatPath));return U.useMemo(()=>Eee(e,JSON.parse(d),l,r==="path"),[e,d,l,r])}function Y1e(e,t){return X1e(e,t)}function X1e(e,t,r,i){HN()||La(!1);let{navigator:a}=U.useContext(bx),{matches:l}=U.useContext(_x),d=l[l.length-1],s=d?d.params:{};d&&d.pathname;let p=d?d.pathnameBase:"/";d&&d.route;let x=qN(),w;if(t){var j;let B=typeof t=="string"?v_(t):t;p==="/"||(j=B.pathname)!=null&&j.startsWith(p)||La(!1),w=B}else w=x;let S=w.pathname||"/",P=S;if(p!=="/"){let B=p.replace(/^\//,"").split("/");P="/"+S.replace(/^\//,"").split("/").slice(B.length).join("/")}let F=S1e(e,{pathname:P}),L=rwe(F&&F.map(B=>Object.assign({},B,{params:Object.assign({},s,B.params),pathname:Mp([p,a.encodeLocation?a.encodeLocation(B.pathname).pathname:B.pathname]),pathnameBase:B.pathnameBase==="/"?p:Mp([p,a.encodeLocation?a.encodeLocation(B.pathnameBase).pathname:B.pathnameBase])})),l,r,i);return t&&L?U.createElement(LE.Provider,{value:{location:_2({pathname:"/",search:"",hash:"",state:null,key:"default"},w),navigationType:bp.Pop}},L):L}function J1e(){let e=awe(),t=H1e(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return U.createElement(U.Fragment,null,U.createElement("h2",null,"Unexpected Application Error!"),U.createElement("h3",{style:{fontStyle:"italic"}},t),r?U.createElement("pre",{style:a},r):null,null)}const Q1e=U.createElement(J1e,null);class ewe extends U.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?U.createElement(_x.Provider,{value:this.props.routeContext},U.createElement(Iee.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function twe(e){let{routeContext:t,match:r,children:i}=e,a=U.useContext(QF);return a&&a.static&&a.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=r.route.id),U.createElement(_x.Provider,{value:t},i)}function rwe(e,t,r,i){var a;if(t===void 0&&(t=[]),r===void 0&&(r=null),i===void 0&&(i=null),e==null){var l;if(!r)return null;if(r.errors)e=r.matches;else if((l=i)!=null&&l.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let d=e,s=(a=r)==null?void 0:a.errors;if(s!=null){let w=d.findIndex(j=>j.route.id&&(s==null?void 0:s[j.route.id])!==void 0);w>=0||La(!1),d=d.slice(0,Math.min(d.length,w+1))}let p=!1,x=-1;if(r&&i&&i.v7_partialHydration)for(let w=0;w<d.length;w++){let j=d[w];if((j.route.HydrateFallback||j.route.hydrateFallbackElement)&&(x=w),j.route.id){let{loaderData:S,errors:P}=r,F=j.route.loader&&S[j.route.id]===void 0&&(!P||P[j.route.id]===void 0);if(j.route.lazy||F){p=!0,x>=0?d=d.slice(0,x+1):d=[d[0]];break}}}return d.reduceRight((w,j,S)=>{let P,F=!1,L=null,B=null;r&&(P=s&&j.route.id?s[j.route.id]:void 0,L=j.route.errorElement||Q1e,p&&(x<0&&S===0?(F=!0,B=null):x===S&&(F=!0,B=j.route.hydrateFallbackElement||null)));let V=t.concat(d.slice(0,S+1)),$=()=>{let G;return P?G=L:F?G=B:j.route.Component?G=U.createElement(j.route.Component,null):j.route.element?G=j.route.element:G=w,U.createElement(twe,{match:j,routeContext:{outlet:w,matches:V,isDataRoute:r!=null},children:G})};return r&&(j.route.ErrorBoundary||j.route.errorElement||S===0)?U.createElement(ewe,{location:r.location,revalidation:r.revalidation,component:L,error:P,children:$(),routeContext:{outlet:null,matches:V,isDataRoute:!0}}):$()},null)}var Dee=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(Dee||{}),gk=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(gk||{});function nwe(e){let t=U.useContext(QF);return t||La(!1),t}function iwe(e){let t=U.useContext(W1e);return t||La(!1),t}function swe(e){let t=U.useContext(_x);return t||La(!1),t}function zee(e){let t=swe(),r=t.matches[t.matches.length-1];return r.route.id||La(!1),r.route.id}function awe(){var e;let t=U.useContext(Iee),r=iwe(gk.UseRouteError),i=zee(gk.UseRouteError);return t!==void 0?t:(e=r.errors)==null?void 0:e[i]}function owe(){let{router:e}=nwe(Dee.UseNavigateStable),t=zee(gk.UseNavigateStable),r=U.useRef(!1);return Oee(()=>{r.current=!0}),U.useCallback(function(a,l){l===void 0&&(l={}),r.current&&(typeof a=="number"?e.navigate(a):e.navigate(a,_2({fromRouteId:t},l)))},[e,t])}function jo(e){La(!1)}function lwe(e){let{basename:t="/",children:r=null,location:i,navigationType:a=bp.Pop,navigator:l,static:d=!1,future:s}=e;HN()&&La(!1);let p=t.replace(/^\/*/,"/"),x=U.useMemo(()=>({basename:p,navigator:l,static:d,future:_2({v7_relativeSplatPath:!1},s)}),[p,s,l,d]);typeof i=="string"&&(i=v_(i));let{pathname:w="/",search:j="",hash:S="",state:P=null,key:F="default"}=i,L=U.useMemo(()=>{let B=JF(w,p);return B==null?null:{location:{pathname:B,search:j,hash:S,state:P,key:F},navigationType:a}},[p,w,j,S,P,F,a]);return L==null?null:U.createElement(bx.Provider,{value:x},U.createElement(LE.Provider,{children:r,value:L}))}function cwe(e){let{children:t,location:r}=e;return Y1e(e5(t),r)}new Promise(()=>{});function e5(e,t){t===void 0&&(t=[]);let r=[];return U.Children.forEach(e,(i,a)=>{if(!U.isValidElement(i))return;let l=[...t,a];if(i.type===U.Fragment){r.push.apply(r,e5(i.props.children,l));return}i.type!==jo&&La(!1),!i.props.index||!i.props.children||La(!1);let d={id:i.props.id||l.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,loader:i.props.loader,action:i.props.action,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(d.children=e5(i.props.children,l)),r.push(d)}),r}/**
 * React Router DOM v6.27.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function t5(){return t5=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},t5.apply(this,arguments)}function uwe(e,t){if(e==null)return{};var r={},i=Object.keys(e),a,l;for(l=0;l<i.length;l++)a=i[l],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}function dwe(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function hwe(e,t){return e.button===0&&(!t||t==="_self")&&!dwe(e)}const mwe=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],fwe="6";try{window.__reactRouterVersion=fwe}catch{}const pwe="startTransition",aG=HY[pwe];function gwe(e){let{basename:t,children:r,future:i,window:a}=e,l=U.useRef();l.current==null&&(l.current=w1e({window:a,v5Compat:!0}));let d=l.current,[s,p]=U.useState({action:d.action,location:d.location}),{v7_startTransition:x}=i||{},w=U.useCallback(j=>{x&&aG?aG(()=>p(j)):p(j)},[p,x]);return U.useLayoutEffect(()=>d.listen(w),[d,w]),U.createElement(lwe,{basename:t,children:r,location:s.location,navigationType:s.action,navigator:d,future:i})}const xwe=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",ywe=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,om=U.forwardRef(function(t,r){let{onClick:i,relative:a,reloadDocument:l,replace:d,state:s,target:p,to:x,preventScrollReset:w,viewTransition:j}=t,S=uwe(t,mwe),{basename:P}=U.useContext(bx),F,L=!1;if(typeof x=="string"&&ywe.test(x)&&(F=x,xwe))try{let G=new URL(window.location.href),W=x.startsWith("//")?new URL(G.protocol+x):new URL(x),Z=JF(W.pathname,P);W.origin===G.origin&&Z!=null?x=Z+W.search+W.hash:L=!0}catch{}let B=K1e(x,{relative:a}),V=vwe(x,{replace:d,state:s,target:p,preventScrollReset:w,relative:a,viewTransition:j});function $(G){i&&i(G),G.defaultPrevented||V(G)}return U.createElement("a",t5({},S,{href:F||B,onClick:L||l?i:$,ref:r,target:p}))});var oG;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(oG||(oG={}));var lG;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(lG||(lG={}));function vwe(e,t){let{target:r,replace:i,state:a,preventScrollReset:l,relative:d,viewTransition:s}=t===void 0?{}:t,p=eB(),x=qN(),w=Ree(e,{relative:d});return U.useCallback(j=>{if(hwe(j,r)){j.preventDefault();let S=i!==void 0?i:pk(x)===pk(w);p(e,{replace:S,state:a,preventScrollReset:l,relative:d,viewTransition:s})}},[x,p,w,i,a,r,e,l,d,s])}const w2=rg("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),lt=U.forwardRef(({className:e,variant:t,size:r,asChild:i=!1,...a},l)=>{const d=i?Al:"button";return n.jsx(d,{className:Yt(w2({variant:t,size:r,className:e})),ref:l,...a})});lt.displayName="Button";const An=U.forwardRef(({className:e,type:t,...r},i)=>n.jsx("input",{type:t,className:Yt("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:i,...r}));An.displayName="Input";var bwe="Separator",cG="horizontal",_we=["horizontal","vertical"],Lee=U.forwardRef((e,t)=>{const{decorative:r,orientation:i=cG,...a}=e,l=wwe(i)?i:cG,s=r?{role:"none"}:{"aria-orientation":l==="vertical"?l:void 0,role:"separator"};return n.jsx(Hr.div,{"data-orientation":l,...s,...a,ref:t})});Lee.displayName=bwe;function wwe(e){return _we.includes(e)}var Fee=Lee;const Da=U.forwardRef(({className:e,orientation:t="horizontal",decorative:r=!0,...i},a)=>n.jsx(Fee,{ref:a,decorative:r,orientation:t,className:Yt("shrink-0 bg-border",t==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",e),...i}));Da.displayName=Fee.displayName;var mO="focusScope.autoFocusOnMount",fO="focusScope.autoFocusOnUnmount",uG={bubbles:!1,cancelable:!0},jwe="FocusScope",WN=U.forwardRef((e,t)=>{const{loop:r=!1,trapped:i=!1,onMountAutoFocus:a,onUnmountAutoFocus:l,...d}=e,[s,p]=U.useState(null),x=Ws(a),w=Ws(l),j=U.useRef(null),S=Mn(t,L=>p(L)),P=U.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;U.useEffect(()=>{if(i){let L=function(G){if(P.paused||!s)return;const W=G.target;s.contains(W)?j.current=W:Zf(j.current,{select:!0})},B=function(G){if(P.paused||!s)return;const W=G.relatedTarget;W!==null&&(s.contains(W)||Zf(j.current,{select:!0}))},V=function(G){if(document.activeElement===document.body)for(const Z of G)Z.removedNodes.length>0&&Zf(s)};document.addEventListener("focusin",L),document.addEventListener("focusout",B);const $=new MutationObserver(V);return s&&$.observe(s,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",L),document.removeEventListener("focusout",B),$.disconnect()}}},[i,s,P.paused]),U.useEffect(()=>{if(s){hG.add(P);const L=document.activeElement;if(!s.contains(L)){const V=new CustomEvent(mO,uG);s.addEventListener(mO,x),s.dispatchEvent(V),V.defaultPrevented||(Nwe(kwe(Bee(s)),{select:!0}),document.activeElement===L&&Zf(s))}return()=>{s.removeEventListener(mO,x),setTimeout(()=>{const V=new CustomEvent(fO,uG);s.addEventListener(fO,w),s.dispatchEvent(V),V.defaultPrevented||Zf(L??document.body,{select:!0}),s.removeEventListener(fO,w),hG.remove(P)},0)}}},[s,x,w,P]);const F=U.useCallback(L=>{if(!r&&!i||P.paused)return;const B=L.key==="Tab"&&!L.altKey&&!L.ctrlKey&&!L.metaKey,V=document.activeElement;if(B&&V){const $=L.currentTarget,[G,W]=Swe($);G&&W?!L.shiftKey&&V===W?(L.preventDefault(),r&&Zf(G,{select:!0})):L.shiftKey&&V===G&&(L.preventDefault(),r&&Zf(W,{select:!0})):V===$&&L.preventDefault()}},[r,i,P.paused]);return n.jsx(Hr.div,{tabIndex:-1,...d,ref:S,onKeyDown:F})});WN.displayName=jwe;function Nwe(e,{select:t=!1}={}){const r=document.activeElement;for(const i of e)if(Zf(i,{select:t}),document.activeElement!==r)return}function Swe(e){const t=Bee(e),r=dG(t,e),i=dG(t.reverse(),e);return[r,i]}function Bee(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:i=>{const a=i.tagName==="INPUT"&&i.type==="hidden";return i.disabled||i.hidden||a?NodeFilter.FILTER_SKIP:i.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function dG(e,t){for(const r of e)if(!Cwe(r,{upTo:t}))return r}function Cwe(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function Awe(e){return e instanceof HTMLInputElement&&"select"in e}function Zf(e,{select:t=!1}={}){if(e&&e.focus){const r=document.activeElement;e.focus({preventScroll:!0}),e!==r&&Awe(e)&&t&&e.select()}}var hG=Twe();function Twe(){let e=[];return{add(t){const r=e[0];t!==r&&(r==null||r.pause()),e=mG(e,t),e.unshift(t)},remove(t){var r;e=mG(e,t),(r=e[0])==null||r.resume()}}}function mG(e,t){const r=[...e],i=r.indexOf(t);return i!==-1&&r.splice(i,1),r}function kwe(e){return e.filter(t=>t.tagName!=="A")}var pO=0;function FE(){U.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??fG()),document.body.insertAdjacentElement("beforeend",e[1]??fG()),pO++,()=>{pO===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),pO--}},[])}function fG(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var rh=function(){return rh=Object.assign||function(t){for(var r,i=1,a=arguments.length;i<a;i++){r=arguments[i];for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&(t[l]=r[l])}return t},rh.apply(this,arguments)};function $ee(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(e);a<i.length;a++)t.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(e,i[a])&&(r[i[a]]=e[i[a]]);return r}function Pwe(e,t,r){if(r||arguments.length===2)for(var i=0,a=t.length,l;i<a;i++)(l||!(i in t))&&(l||(l=Array.prototype.slice.call(t,0,i)),l[i]=t[i]);return e.concat(l||Array.prototype.slice.call(t))}var TT="right-scroll-bar-position",kT="width-before-scroll-bar",Ewe="with-scroll-bars-hidden",Mwe="--removed-body-scroll-bar-size";function gO(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function Iwe(e,t){var r=U.useState(function(){return{value:e,callback:t,facade:{get current(){return r.value},set current(i){var a=r.value;a!==i&&(r.value=i,r.callback(i,a))}}}})[0];return r.callback=t,r.facade}var Owe=typeof window<"u"?U.useLayoutEffect:U.useEffect,pG=new WeakMap;function Rwe(e,t){var r=Iwe(null,function(i){return e.forEach(function(a){return gO(a,i)})});return Owe(function(){var i=pG.get(r);if(i){var a=new Set(i),l=new Set(e),d=r.current;a.forEach(function(s){l.has(s)||gO(s,null)}),l.forEach(function(s){a.has(s)||gO(s,d)})}pG.set(r,e)},[e]),r}function Dwe(e){return e}function zwe(e,t){t===void 0&&(t=Dwe);var r=[],i=!1,a={read:function(){if(i)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:e},useMedium:function(l){var d=t(l,i);return r.push(d),function(){r=r.filter(function(s){return s!==d})}},assignSyncMedium:function(l){for(i=!0;r.length;){var d=r;r=[],d.forEach(l)}r={push:function(s){return l(s)},filter:function(){return r}}},assignMedium:function(l){i=!0;var d=[];if(r.length){var s=r;r=[],s.forEach(l),d=r}var p=function(){var w=d;d=[],w.forEach(l)},x=function(){return Promise.resolve().then(p)};x(),r={push:function(w){d.push(w),x()},filter:function(w){return d=d.filter(w),r}}}};return a}function Lwe(e){e===void 0&&(e={});var t=zwe(null);return t.options=rh({async:!0,ssr:!1},e),t}var Vee=function(e){var t=e.sideCar,r=$ee(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var i=t.read();if(!i)throw new Error("Sidecar medium not found");return U.createElement(i,rh({},r))};Vee.isSideCarExport=!0;function Fwe(e,t){return e.useMedium(t),Vee}var Uee=Lwe(),xO=function(){},BE=U.forwardRef(function(e,t){var r=U.useRef(null),i=U.useState({onScrollCapture:xO,onWheelCapture:xO,onTouchMoveCapture:xO}),a=i[0],l=i[1],d=e.forwardProps,s=e.children,p=e.className,x=e.removeScrollBar,w=e.enabled,j=e.shards,S=e.sideCar,P=e.noIsolation,F=e.inert,L=e.allowPinchZoom,B=e.as,V=B===void 0?"div":B,$=e.gapMode,G=$ee(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),W=S,Z=Rwe([r,t]),se=rh(rh({},G),a);return U.createElement(U.Fragment,null,w&&U.createElement(W,{sideCar:Uee,removeScrollBar:x,shards:j,noIsolation:P,inert:F,setCallbacks:l,allowPinchZoom:!!L,lockRef:r,gapMode:$}),d?U.cloneElement(U.Children.only(s),rh(rh({},se),{ref:Z})):U.createElement(V,rh({},se,{className:p,ref:Z}),s))});BE.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};BE.classNames={fullWidth:kT,zeroRight:TT};var Bwe=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function $we(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=Bwe();return t&&e.setAttribute("nonce",t),e}function Vwe(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function Uwe(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var Gwe=function(){var e=0,t=null;return{add:function(r){e==0&&(t=$we())&&(Vwe(t,r),Uwe(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},Hwe=function(){var e=Gwe();return function(t,r){U.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&r])}},Gee=function(){var e=Hwe(),t=function(r){var i=r.styles,a=r.dynamic;return e(i,a),null};return t},qwe={left:0,top:0,right:0,gap:0},yO=function(e){return parseInt(e||"",10)||0},Wwe=function(e){var t=window.getComputedStyle(document.body),r=t[e==="padding"?"paddingLeft":"marginLeft"],i=t[e==="padding"?"paddingTop":"marginTop"],a=t[e==="padding"?"paddingRight":"marginRight"];return[yO(r),yO(i),yO(a)]},Kwe=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return qwe;var t=Wwe(e),r=document.documentElement.clientWidth,i=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,i-r+t[2]-t[0])}},Zwe=Gee(),zv="data-scroll-locked",Ywe=function(e,t,r,i){var a=e.left,l=e.top,d=e.right,s=e.gap;return r===void 0&&(r="margin"),`
  .`.concat(Ewe,` {
   overflow: hidden `).concat(i,`;
   padding-right: `).concat(s,"px ").concat(i,`;
  }
  body[`).concat(zv,`] {
    overflow: hidden `).concat(i,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(i,";"),r==="margin"&&`
    padding-left: `.concat(a,`px;
    padding-top: `).concat(l,`px;
    padding-right: `).concat(d,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(s,"px ").concat(i,`;
    `),r==="padding"&&"padding-right: ".concat(s,"px ").concat(i,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(TT,` {
    right: `).concat(s,"px ").concat(i,`;
  }
  
  .`).concat(kT,` {
    margin-right: `).concat(s,"px ").concat(i,`;
  }
  
  .`).concat(TT," .").concat(TT,` {
    right: 0 `).concat(i,`;
  }
  
  .`).concat(kT," .").concat(kT,` {
    margin-right: 0 `).concat(i,`;
  }
  
  body[`).concat(zv,`] {
    `).concat(Mwe,": ").concat(s,`px;
  }
`)},gG=function(){var e=parseInt(document.body.getAttribute(zv)||"0",10);return isFinite(e)?e:0},Xwe=function(){U.useEffect(function(){return document.body.setAttribute(zv,(gG()+1).toString()),function(){var e=gG()-1;e<=0?document.body.removeAttribute(zv):document.body.setAttribute(zv,e.toString())}},[])},Jwe=function(e){var t=e.noRelative,r=e.noImportant,i=e.gapMode,a=i===void 0?"margin":i;Xwe();var l=U.useMemo(function(){return Kwe(a)},[a]);return U.createElement(Zwe,{styles:Ywe(l,!t,a,r?"":"!important")})},r5=!1;if(typeof window<"u")try{var DA=Object.defineProperty({},"passive",{get:function(){return r5=!0,!0}});window.addEventListener("test",DA,DA),window.removeEventListener("test",DA,DA)}catch{r5=!1}var Uy=r5?{passive:!1}:!1,Qwe=function(e){return e.tagName==="TEXTAREA"},Hee=function(e,t){if(!(e instanceof Element))return!1;var r=window.getComputedStyle(e);return r[t]!=="hidden"&&!(r.overflowY===r.overflowX&&!Qwe(e)&&r[t]==="visible")},eje=function(e){return Hee(e,"overflowY")},tje=function(e){return Hee(e,"overflowX")},xG=function(e,t){var r=t.ownerDocument,i=t;do{typeof ShadowRoot<"u"&&i instanceof ShadowRoot&&(i=i.host);var a=qee(e,i);if(a){var l=Wee(e,i),d=l[1],s=l[2];if(d>s)return!0}i=i.parentNode}while(i&&i!==r.body);return!1},rje=function(e){var t=e.scrollTop,r=e.scrollHeight,i=e.clientHeight;return[t,r,i]},nje=function(e){var t=e.scrollLeft,r=e.scrollWidth,i=e.clientWidth;return[t,r,i]},qee=function(e,t){return e==="v"?eje(t):tje(t)},Wee=function(e,t){return e==="v"?rje(t):nje(t)},ije=function(e,t){return e==="h"&&t==="rtl"?-1:1},sje=function(e,t,r,i,a){var l=ije(e,window.getComputedStyle(t).direction),d=l*i,s=r.target,p=t.contains(s),x=!1,w=d>0,j=0,S=0;do{var P=Wee(e,s),F=P[0],L=P[1],B=P[2],V=L-B-l*F;(F||V)&&qee(e,s)&&(j+=V,S+=F),s instanceof ShadowRoot?s=s.host:s=s.parentNode}while(!p&&s!==document.body||p&&(t.contains(s)||t===s));return(w&&(Math.abs(j)<1||!a)||!w&&(Math.abs(S)<1||!a))&&(x=!0),x},zA=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},yG=function(e){return[e.deltaX,e.deltaY]},vG=function(e){return e&&"current"in e?e.current:e},aje=function(e,t){return e[0]===t[0]&&e[1]===t[1]},oje=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},lje=0,Gy=[];function cje(e){var t=U.useRef([]),r=U.useRef([0,0]),i=U.useRef(),a=U.useState(lje++)[0],l=U.useState(Gee)[0],d=U.useRef(e);U.useEffect(function(){d.current=e},[e]),U.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(a));var L=Pwe([e.lockRef.current],(e.shards||[]).map(vG),!0).filter(Boolean);return L.forEach(function(B){return B.classList.add("allow-interactivity-".concat(a))}),function(){document.body.classList.remove("block-interactivity-".concat(a)),L.forEach(function(B){return B.classList.remove("allow-interactivity-".concat(a))})}}},[e.inert,e.lockRef.current,e.shards]);var s=U.useCallback(function(L,B){if("touches"in L&&L.touches.length===2||L.type==="wheel"&&L.ctrlKey)return!d.current.allowPinchZoom;var V=zA(L),$=r.current,G="deltaX"in L?L.deltaX:$[0]-V[0],W="deltaY"in L?L.deltaY:$[1]-V[1],Z,se=L.target,ae=Math.abs(G)>Math.abs(W)?"h":"v";if("touches"in L&&ae==="h"&&se.type==="range")return!1;var ce=xG(ae,se);if(!ce)return!0;if(ce?Z=ae:(Z=ae==="v"?"h":"v",ce=xG(ae,se)),!ce)return!1;if(!i.current&&"changedTouches"in L&&(G||W)&&(i.current=Z),!Z)return!0;var Pe=i.current||Z;return sje(Pe,B,L,Pe==="h"?G:W,!0)},[]),p=U.useCallback(function(L){var B=L;if(!(!Gy.length||Gy[Gy.length-1]!==l)){var V="deltaY"in B?yG(B):zA(B),$=t.current.filter(function(Z){return Z.name===B.type&&(Z.target===B.target||B.target===Z.shadowParent)&&aje(Z.delta,V)})[0];if($&&$.should){B.cancelable&&B.preventDefault();return}if(!$){var G=(d.current.shards||[]).map(vG).filter(Boolean).filter(function(Z){return Z.contains(B.target)}),W=G.length>0?s(B,G[0]):!d.current.noIsolation;W&&B.cancelable&&B.preventDefault()}}},[]),x=U.useCallback(function(L,B,V,$){var G={name:L,delta:B,target:V,should:$,shadowParent:uje(V)};t.current.push(G),setTimeout(function(){t.current=t.current.filter(function(W){return W!==G})},1)},[]),w=U.useCallback(function(L){r.current=zA(L),i.current=void 0},[]),j=U.useCallback(function(L){x(L.type,yG(L),L.target,s(L,e.lockRef.current))},[]),S=U.useCallback(function(L){x(L.type,zA(L),L.target,s(L,e.lockRef.current))},[]);U.useEffect(function(){return Gy.push(l),e.setCallbacks({onScrollCapture:j,onWheelCapture:j,onTouchMoveCapture:S}),document.addEventListener("wheel",p,Uy),document.addEventListener("touchmove",p,Uy),document.addEventListener("touchstart",w,Uy),function(){Gy=Gy.filter(function(L){return L!==l}),document.removeEventListener("wheel",p,Uy),document.removeEventListener("touchmove",p,Uy),document.removeEventListener("touchstart",w,Uy)}},[]);var P=e.removeScrollBar,F=e.inert;return U.createElement(U.Fragment,null,F?U.createElement(l,{styles:oje(a)}):null,P?U.createElement(Jwe,{gapMode:e.gapMode}):null)}function uje(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const dje=Fwe(Uee,cje);var KN=U.forwardRef(function(e,t){return U.createElement(BE,rh({},e,{ref:t,sideCar:dje}))});KN.classNames=BE.classNames;var hje=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},Hy=new WeakMap,LA=new WeakMap,FA={},vO=0,Kee=function(e){return e&&(e.host||Kee(e.parentNode))},mje=function(e,t){return t.map(function(r){if(e.contains(r))return r;var i=Kee(r);return i&&e.contains(i)?i:(console.error("aria-hidden",r,"in not contained inside",e,". Doing nothing"),null)}).filter(function(r){return!!r})},fje=function(e,t,r,i){var a=mje(t,Array.isArray(e)?e:[e]);FA[r]||(FA[r]=new WeakMap);var l=FA[r],d=[],s=new Set,p=new Set(a),x=function(j){!j||s.has(j)||(s.add(j),x(j.parentNode))};a.forEach(x);var w=function(j){!j||p.has(j)||Array.prototype.forEach.call(j.children,function(S){if(s.has(S))w(S);else try{var P=S.getAttribute(i),F=P!==null&&P!=="false",L=(Hy.get(S)||0)+1,B=(l.get(S)||0)+1;Hy.set(S,L),l.set(S,B),d.push(S),L===1&&F&&LA.set(S,!0),B===1&&S.setAttribute(r,"true"),F||S.setAttribute(i,"true")}catch(V){console.error("aria-hidden: cannot operate on ",S,V)}})};return w(t),s.clear(),vO++,function(){d.forEach(function(j){var S=Hy.get(j)-1,P=l.get(j)-1;Hy.set(j,S),l.set(j,P),S||(LA.has(j)||j.removeAttribute(i),LA.delete(j)),P||j.removeAttribute(r)}),vO--,vO||(Hy=new WeakMap,Hy=new WeakMap,LA=new WeakMap,FA={})}},$E=function(e,t,r){r===void 0&&(r="data-aria-hidden");var i=Array.from(Array.isArray(e)?e:[e]),a=hje(e);return a?(i.push.apply(i,Array.from(a.querySelectorAll("[aria-live]"))),fje(i,a,r,"aria-hidden")):function(){return null}},tB="Dialog",[Zee,Yee]=Jo(tB),[pje,Ad]=Zee(tB),Xee=e=>{const{__scopeDialog:t,children:r,open:i,defaultOpen:a,onOpenChange:l,modal:d=!0}=e,s=U.useRef(null),p=U.useRef(null),[x=!1,w]=fo({prop:i,defaultProp:a,onChange:l});return n.jsx(pje,{scope:t,triggerRef:s,contentRef:p,contentId:rc(),titleId:rc(),descriptionId:rc(),open:x,onOpenChange:w,onOpenToggle:U.useCallback(()=>w(j=>!j),[w]),modal:d,children:r})};Xee.displayName=tB;var Jee="DialogTrigger",Qee=U.forwardRef((e,t)=>{const{__scopeDialog:r,...i}=e,a=Ad(Jee,r),l=Mn(t,a.triggerRef);return n.jsx(Hr.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":iB(a.open),...i,ref:l,onClick:_r(e.onClick,a.onOpenToggle)})});Qee.displayName=Jee;var rB="DialogPortal",[gje,ete]=Zee(rB,{forceMount:void 0}),tte=e=>{const{__scopeDialog:t,forceMount:r,children:i,container:a}=e,l=Ad(rB,t);return n.jsx(gje,{scope:t,forceMount:r,children:U.Children.map(i,d=>n.jsx(io,{present:r||l.open,children:n.jsx(h_,{asChild:!0,container:a,children:d})}))})};tte.displayName=rB;var xk="DialogOverlay",rte=U.forwardRef((e,t)=>{const r=ete(xk,e.__scopeDialog),{forceMount:i=r.forceMount,...a}=e,l=Ad(xk,e.__scopeDialog);return l.modal?n.jsx(io,{present:i||l.open,children:n.jsx(xje,{...a,ref:t})}):null});rte.displayName=xk;var xje=U.forwardRef((e,t)=>{const{__scopeDialog:r,...i}=e,a=Ad(xk,r);return n.jsx(KN,{as:Al,allowPinchZoom:!0,shards:[a.contentRef],children:n.jsx(Hr.div,{"data-state":iB(a.open),...i,ref:t,style:{pointerEvents:"auto",...i.style}})})}),nx="DialogContent",nte=U.forwardRef((e,t)=>{const r=ete(nx,e.__scopeDialog),{forceMount:i=r.forceMount,...a}=e,l=Ad(nx,e.__scopeDialog);return n.jsx(io,{present:i||l.open,children:l.modal?n.jsx(yje,{...a,ref:t}):n.jsx(vje,{...a,ref:t})})});nte.displayName=nx;var yje=U.forwardRef((e,t)=>{const r=Ad(nx,e.__scopeDialog),i=U.useRef(null),a=Mn(t,r.contentRef,i);return U.useEffect(()=>{const l=i.current;if(l)return $E(l)},[]),n.jsx(ite,{...e,ref:a,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:_r(e.onCloseAutoFocus,l=>{var d;l.preventDefault(),(d=r.triggerRef.current)==null||d.focus()}),onPointerDownOutside:_r(e.onPointerDownOutside,l=>{const d=l.detail.originalEvent,s=d.button===0&&d.ctrlKey===!0;(d.button===2||s)&&l.preventDefault()}),onFocusOutside:_r(e.onFocusOutside,l=>l.preventDefault())})}),vje=U.forwardRef((e,t)=>{const r=Ad(nx,e.__scopeDialog),i=U.useRef(!1),a=U.useRef(!1);return n.jsx(ite,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:l=>{var d,s;(d=e.onCloseAutoFocus)==null||d.call(e,l),l.defaultPrevented||(i.current||(s=r.triggerRef.current)==null||s.focus(),l.preventDefault()),i.current=!1,a.current=!1},onInteractOutside:l=>{var p,x;(p=e.onInteractOutside)==null||p.call(e,l),l.defaultPrevented||(i.current=!0,l.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const d=l.target;((x=r.triggerRef.current)==null?void 0:x.contains(d))&&l.preventDefault(),l.detail.originalEvent.type==="focusin"&&a.current&&l.preventDefault()}})}),ite=U.forwardRef((e,t)=>{const{__scopeDialog:r,trapFocus:i,onOpenAutoFocus:a,onCloseAutoFocus:l,...d}=e,s=Ad(nx,r),p=U.useRef(null),x=Mn(t,p);return FE(),n.jsxs(n.Fragment,{children:[n.jsx(WN,{asChild:!0,loop:!0,trapped:i,onMountAutoFocus:a,onUnmountAutoFocus:l,children:n.jsx(yx,{role:"dialog",id:s.contentId,"aria-describedby":s.descriptionId,"aria-labelledby":s.titleId,"data-state":iB(s.open),...d,ref:x,onDismiss:()=>s.onOpenChange(!1)})}),n.jsxs(n.Fragment,{children:[n.jsx(_je,{titleId:s.titleId}),n.jsx(jje,{contentRef:p,descriptionId:s.descriptionId})]})]})}),nB="DialogTitle",ste=U.forwardRef((e,t)=>{const{__scopeDialog:r,...i}=e,a=Ad(nB,r);return n.jsx(Hr.h2,{id:a.titleId,...i,ref:t})});ste.displayName=nB;var ate="DialogDescription",ote=U.forwardRef((e,t)=>{const{__scopeDialog:r,...i}=e,a=Ad(ate,r);return n.jsx(Hr.p,{id:a.descriptionId,...i,ref:t})});ote.displayName=ate;var lte="DialogClose",cte=U.forwardRef((e,t)=>{const{__scopeDialog:r,...i}=e,a=Ad(lte,r);return n.jsx(Hr.button,{type:"button",...i,ref:t,onClick:_r(e.onClick,()=>a.onOpenChange(!1))})});cte.displayName=lte;function iB(e){return e?"open":"closed"}var ute="DialogTitleWarning",[bje,dte]=iye(ute,{contentName:nx,titleName:nB,docsSlug:"dialog"}),_je=({titleId:e})=>{const t=dte(ute),r=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return U.useEffect(()=>{e&&(document.getElementById(e)||console.error(r))},[r,e]),null},wje="DialogDescriptionWarning",jje=({contentRef:e,descriptionId:t})=>{const i=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${dte(wje).contentName}}.`;return U.useEffect(()=>{var l;const a=(l=e.current)==null?void 0:l.getAttribute("aria-describedby");t&&a&&(document.getElementById(t)||console.warn(i))},[i,e,t]),null},sB=Xee,hte=Qee,aB=tte,ZN=rte,YN=nte,XN=ste,JN=ote,VE=cte;const Nje=sB,Sje=aB,mte=U.forwardRef(({className:e,...t},r)=>n.jsx(ZN,{className:Yt("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:r}));mte.displayName=ZN.displayName;const Cje=rg("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),fte=U.forwardRef(({side:e="right",className:t,children:r,...i},a)=>n.jsxs(Sje,{children:[n.jsx(mte,{}),n.jsxs(YN,{ref:a,className:Yt(Cje({side:e}),t),...i,children:[r,n.jsxs(VE,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[n.jsx(Pc,{className:"h-4 w-4"}),n.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));fte.displayName=YN.displayName;const Aje=U.forwardRef(({className:e,...t},r)=>n.jsx(XN,{ref:r,className:Yt("text-lg font-semibold text-foreground",e),...t}));Aje.displayName=XN.displayName;const Tje=U.forwardRef(({className:e,...t},r)=>n.jsx(JN,{ref:r,className:Yt("text-sm text-muted-foreground",e),...t}));Tje.displayName=JN.displayName;function bG({className:e,...t}){return n.jsx("div",{className:Yt("animate-pulse rounded-md bg-muted",e),...t})}const pte=U.createContext(null);function UE(){const e=U.useContext(pte);if(!e)throw new Error("useSidebar must be used within a SidebarProvider.");return e}const bO=768;function kje(){const[e,t]=U.useState(void 0);return U.useEffect(()=>{const r=window.matchMedia(`(max-width: ${bO-1}px)`),i=()=>{t(window.innerWidth<bO)};return r.addEventListener("change",i),t(window.innerWidth<bO),()=>r.removeEventListener("change",i)},[]),!!e}const Pje="sidebar:state",Eje=60*60*24*7,Mje="16rem",Ije="3rem",Oje="b",gte=U.forwardRef(({defaultOpen:e=!0,open:t,onOpenChange:r,className:i,style:a,children:l,...d},s)=>{const p=kje(),[x,w]=U.useState(!1),[j,S]=U.useState(e),P=t??j,F=U.useCallback($=>{const G=typeof $=="function"?$(P):$;r?r(G):S(G),document.cookie=`${Pje}=${G}; path=/; max-age=${Eje}`},[r,P]),L=U.useCallback(()=>p?w($=>!$):F($=>!$),[p,F,w]);U.useEffect(()=>{const $=G=>{G.key===Oje&&(G.metaKey||G.ctrlKey)&&(G.preventDefault(),L())};return window.addEventListener("keydown",$),()=>window.removeEventListener("keydown",$)},[L]);const B=P?"expanded":"collapsed",V=U.useMemo(()=>({state:B,open:P,setOpen:F,isMobile:p,openMobile:x,setOpenMobile:w,toggleSidebar:L}),[B,P,F,p,x,w,L]);return n.jsx(pte.Provider,{value:V,children:n.jsx(YF,{delayDuration:0,children:n.jsx("div",{style:{"--sidebar-width":Mje,"--sidebar-width-icon":Ije,...a},className:Yt("group/sidebar-wrapper flex min-h-svh w-full has-[[data-variant=inset]]:bg-sidebar",i),ref:s,...d,children:l})})})});gte.displayName="SidebarProvider";const Rje=rg("peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-none ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:!size-8 group-data-[collapsible=icon]:!p-2 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0",{variants:{variant:{default:"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground",outline:"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]"},size:{default:"h-8 text-sm",sm:"h-7 text-xs",lg:"h-12 text-sm group-data-[collapsible=icon]:!p-0"}},defaultVariants:{variant:"default",size:"default"}}),xte=U.forwardRef(({side:e="left",variant:t="sidebar",collapsible:r="offcanvas",className:i,children:a,...l},d)=>{const{isMobile:s,state:p,openMobile:x,setOpenMobile:w}=UE();return r==="none"?n.jsx("div",{className:Yt("flex h-full w-[--sidebar-width] flex-col bg-sidebar text-sidebar-foreground",i),ref:d,...l,children:a}):s?n.jsx(Nje,{open:x,onOpenChange:w,...l,children:n.jsx(fte,{"data-sidebar":"sidebar","data-mobile":"true",className:"w-[--sidebar-width] bg-sidebar p-0 text-sidebar-foreground [&>button]:hidden",style:{"--sidebar-width":"18rem"},side:e,children:n.jsx("div",{className:"flex h-full w-full flex-col",children:a})})}):n.jsxs("div",{ref:d,className:"group peer hidden md:block text-sidebar-foreground","data-state":p,"data-collapsible":p==="collapsed"?r:"","data-variant":t,"data-side":e,children:[n.jsx("div",{className:Yt("duration-200 relative h-svh w-[--sidebar-width] bg-transparent transition-[width] ease-linear","group-data-[collapsible=offcanvas]:w-0","group-data-[side=right]:rotate-180",t==="floating"||t==="inset"?"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4))]":"group-data-[collapsible=icon]:w-[--sidebar-width-icon]")}),n.jsx("div",{className:Yt("duration-200 fixed inset-y-0 z-10 hidden h-svh w-[--sidebar-width] transition-[left,right,width] ease-linear md:flex",e==="left"?"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]":"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]",t==="floating"||t==="inset"?"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4)_+2px)]":"group-data-[collapsible=icon]:w-[--sidebar-width-icon] group-data-[side=left]:border-r group-data-[side=right]:border-l",i),...l,children:n.jsx("div",{"data-sidebar":"sidebar",className:"flex h-full w-full flex-col bg-sidebar group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:border-sidebar-border group-data-[variant=floating]:shadow",children:a})})]})});xte.displayName="Sidebar";const Dje=U.forwardRef(({className:e,onClick:t,...r},i)=>{const{toggleSidebar:a}=UE();return n.jsxs(lt,{ref:i,"data-sidebar":"trigger",variant:"ghost",size:"icon",className:Yt("h-7 w-7",e),onClick:l=>{t==null||t(l),a()},...r,children:[n.jsx(bve,{}),n.jsx("span",{className:"sr-only",children:"Toggle Sidebar"})]})});Dje.displayName="SidebarTrigger";const zje=U.forwardRef(({className:e,...t},r)=>{const{toggleSidebar:i}=UE();return n.jsx("button",{ref:r,"data-sidebar":"rail","aria-label":"Toggle Sidebar",tabIndex:-1,onClick:i,title:"Toggle Sidebar",className:Yt("absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] hover:after:bg-sidebar-border group-data-[side=left]:-right-4 group-data-[side=right]:left-0 sm:flex","[[data-side=left]_&]:cursor-w-resize [[data-side=right]_&]:cursor-e-resize","[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize","group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full group-data-[collapsible=offcanvas]:hover:bg-sidebar","[[data-side=left][data-collapsible=offcanvas]_&]:-right-2","[[data-side=right][data-collapsible=offcanvas]_&]:-left-2",e),...t})});zje.displayName="SidebarRail";const Lje=U.forwardRef(({className:e,...t},r)=>n.jsx("main",{ref:r,className:Yt("relative flex min-h-svh flex-1 flex-col bg-background","peer-data-[variant=inset]:min-h-[calc(100svh-theme(spacing.4))] md:peer-data-[variant=inset]:m-2 md:peer-data-[state=collapsed]:peer-data-[variant=inset]:ml-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow",e),...t}));Lje.displayName="SidebarInset";const Fje=U.forwardRef(({className:e,...t},r)=>n.jsx(An,{ref:r,"data-sidebar":"input",className:Yt("h-8 w-full bg-background shadow-none focus-visible:ring-2 focus-visible:ring-sidebar-ring",e),...t}));Fje.displayName="SidebarInput";const yte=U.forwardRef(({className:e,...t},r)=>n.jsx("div",{ref:r,"data-sidebar":"header",className:Yt("flex flex-col gap-2 p-2",e),...t}));yte.displayName="SidebarHeader";const vte=U.forwardRef(({className:e,...t},r)=>n.jsx("div",{ref:r,"data-sidebar":"footer",className:Yt("flex flex-col gap-2 p-2",e),...t}));vte.displayName="SidebarFooter";const Bje=U.forwardRef(({className:e,...t},r)=>n.jsx(Da,{ref:r,"data-sidebar":"separator",className:Yt("mx-2 w-auto bg-sidebar-border",e),...t}));Bje.displayName="SidebarSeparator";const bte=U.forwardRef(({className:e,...t},r)=>n.jsx("div",{ref:r,"data-sidebar":"content",className:Yt("flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden",e),...t}));bte.displayName="SidebarContent";const $je=U.forwardRef(({className:e,...t},r)=>n.jsx("div",{ref:r,"data-sidebar":"group",className:Yt("relative flex w-full min-w-0 flex-col p-2",e),...t}));$je.displayName="SidebarGroup";const Vje=U.forwardRef(({className:e,asChild:t=!1,...r},i)=>{const a=t?Al:"div";return n.jsx(a,{ref:i,"data-sidebar":"group-label",className:Yt("duration-200 flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium text-sidebar-foreground/70 outline-none ring-sidebar-ring transition-[margin,opa] ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0","group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0",e),...r})});Vje.displayName="SidebarGroupLabel";const Uje=U.forwardRef(({className:e,asChild:t=!1,...r},i)=>{const a=t?Al:"button";return n.jsx(a,{ref:i,"data-sidebar":"group-action",className:Yt("absolute right-3 top-3.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0","after:absolute after:-inset-2 after:md:hidden","group-data-[collapsible=icon]:hidden",e),...r})});Uje.displayName="SidebarGroupAction";const Gje=U.forwardRef(({className:e,...t},r)=>n.jsx("div",{ref:r,"data-sidebar":"group-content",className:Yt("w-full text-sm",e),...t}));Gje.displayName="SidebarGroupContent";const _te=U.forwardRef(({className:e,...t},r)=>n.jsx("ul",{ref:r,"data-sidebar":"menu",className:Yt("flex w-full min-w-0 flex-col gap-1",e),...t}));_te.displayName="SidebarMenu";const n5=U.forwardRef(({className:e,...t},r)=>n.jsx("li",{ref:r,"data-sidebar":"menu-item",className:Yt("group/menu-item relative",e),...t}));n5.displayName="SidebarMenuItem";const i5=U.forwardRef(({asChild:e=!1,isActive:t=!1,variant:r="default",size:i="default",tooltip:a,className:l,...d},s)=>{const p=e?Al:"button",{isMobile:x,state:w}=UE(),j=n.jsx(p,{ref:s,"data-sidebar":"menu-button","data-size":i,"data-active":t,className:Yt(Rje({variant:r,size:i}),l),...d});return a?(typeof a=="string"&&(a={children:a}),n.jsxs(DE,{children:[n.jsx(zE,{asChild:!0,children:j}),n.jsx(GN,{side:"right",align:"center",hidden:w!=="collapsed"||x,...a})]})):j});i5.displayName="SidebarMenuButton";const Hje=U.forwardRef(({className:e,asChild:t=!1,showOnHover:r=!1,...i},a)=>{const l=t?Al:"button";return n.jsx(l,{ref:a,"data-sidebar":"menu-action",className:Yt("absolute right-1 top-1.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 peer-hover/menu-button:text-sidebar-accent-foreground [&>svg]:size-4 [&>svg]:shrink-0","after:absolute after:-inset-2 after:md:hidden","peer-data-[size=sm]/menu-button:top-1","peer-data-[size=default]/menu-button:top-1.5","peer-data-[size=lg]/menu-button:top-2.5","group-data-[collapsible=icon]:hidden",r&&"group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 peer-data-[active=true]/menu-button:text-sidebar-accent-foreground md:opacity-0",e),...i})});Hje.displayName="SidebarMenuAction";const qje=U.forwardRef(({className:e,...t},r)=>n.jsx("div",{ref:r,"data-sidebar":"menu-badge",className:Yt("absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums text-sidebar-foreground select-none pointer-events-none","peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground","peer-data-[size=sm]/menu-button:top-1","peer-data-[size=default]/menu-button:top-1.5","peer-data-[size=lg]/menu-button:top-2.5","group-data-[collapsible=icon]:hidden",e),...t}));qje.displayName="SidebarMenuBadge";const Wje=U.forwardRef(({className:e,showIcon:t=!1,...r},i)=>{const a=U.useMemo(()=>`${Math.floor(Math.random()*40)+50}%`,[]);return n.jsxs("div",{ref:i,"data-sidebar":"menu-skeleton",className:Yt("rounded-md h-8 flex gap-2 px-2 items-center",e),...r,children:[t&&n.jsx(bG,{className:"size-4 rounded-md","data-sidebar":"menu-skeleton-icon"}),n.jsx(bG,{className:"h-4 flex-1 max-w-[--skeleton-width]","data-sidebar":"menu-skeleton-text",style:{"--skeleton-width":a}})]})});Wje.displayName="SidebarMenuSkeleton";const Kje=U.forwardRef(({className:e,...t},r)=>n.jsx("ul",{ref:r,"data-sidebar":"menu-sub",className:Yt("mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l border-sidebar-border px-2.5 py-0.5","group-data-[collapsible=icon]:hidden",e),...t}));Kje.displayName="SidebarMenuSub";const Zje=U.forwardRef(({...e},t)=>n.jsx("li",{ref:t,...e}));Zje.displayName="SidebarMenuSubItem";const Yje=U.forwardRef(({asChild:e=!1,size:t="md",isActive:r,className:i,...a},l)=>{const d=e?Al:"a";return n.jsx(d,{ref:l,"data-sidebar":"menu-sub-button","data-size":t,"data-active":r,className:Yt("flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 text-sidebar-foreground outline-none ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 [&>svg]:text-sidebar-accent-foreground","data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground",t==="sm"&&"text-xs",t==="md"&&"text-sm","group-data-[collapsible=icon]:hidden",i),...a})});Yje.displayName="SidebarMenuSubButton";const _G=[{id:"banking",name:"banking",displayName:"AWS Banking Agent OS",description:"Comprehensive banking operations and customer management",logo:"https://aws.amazon.com/favicon.ico",primaryColor:"hsl(358, 75%, 45%)",accentColor:"hsl(358, 75%, 35%)",gradientBg:"linear-gradient(145deg, #000000 0%, #E31E24 50%, #FFFFFF 100%)",borderColor:"hsl(358, 75%, 45% / 0.3)",navigation:[{path:"/",label:"Dashboard",icon:"Command"},{path:"/agent-command",label:"Agent Command Centre",icon:"Command"},{path:"/agents",label:"AI Agents",icon:"Bot"},{path:"/multi-agent-workspace",label:"Multi Agent Workspace",icon:"Bot"},{path:"/mcp-dashboard",label:"MCP Gateway",icon:"Server"},{path:"/agent-exchange",label:"AI Marketplace",icon:"ShoppingBag"},{path:"/risk-analytics",label:"Risk Analytics",icon:"TrendingUp"},{path:"/wealth-management",label:"Wealth Management",icon:"TrendingUp"},{path:"/customer-insights",label:"Customer Insights",icon:"Users"},{path:"/agent-control",label:"Agent Control Panel",icon:"Activity"},{path:"/system-flow",label:"AgentOS Architecture Blueprint",icon:"Network"},{path:"/settings",label:"Settings",icon:"Settings"}],workflows:[{id:"wealth-management",name:"AI Wealth Management Centre",description:"Complete wealth management workflow with 6 specialized agents",agents:["Portfolio Manager","Risk Assessor","Market Analyst","Client Advisor","Compliance Officer","Research Analyst"],workflows:["Portfolio Analysis","Risk Assessment","Market Research","Client Consultation","Compliance Check","Investment Research"]}]},{id:"telco",name:"telco",displayName:"AWS Telco Agent OS",description:"Telecommunications operations and network management",logo:"https://aws.amazon.com/favicon.ico",primaryColor:"hsl(220, 90%, 55%)",accentColor:"hsl(220, 90%, 45%)",gradientBg:"linear-gradient(145deg, #000000 0%, #0066FF 50%, #FFFFFF 100%)",borderColor:"hsl(220, 90%, 55% / 0.3)",navigation:[{path:"/",label:"Dashboard",icon:"Command"},{path:"/agent-command",label:"Agent Command Centre",icon:"Command"},{path:"/agent-exchange",label:"Agent Marketplace",icon:"ShoppingBag"},{path:"/multi-agent-workspace",label:"Multi Agent Orchestration",icon:"Bot"},{path:"/agents",label:"Network Agents",icon:"Bot"},{path:"/mcp-dashboard",label:"MCP Gateway",icon:"Server"},{path:"/network-twin",label:"Network Twin",icon:"Globe"},{path:"/customer-analytics",label:"Customer Analytics",icon:"Users"},{path:"/agent-control",label:"Agent Control Panel",icon:"Activity"},{path:"/system-flow",label:"AgentOS Architecture Blueprint",icon:"Network"},{path:"/settings",label:"Settings",icon:"Settings"}],workflows:[{id:"network-optimization",name:"Network Optimization Suite",description:"Complete network management with specialized agents",agents:["Network Monitor","Performance Optimizer","Fault Detector","Customer Support","Capacity Planner","Security Guard"],workflows:["Network Monitoring","Performance Analysis","Fault Detection","Customer Support","Capacity Planning","Security Monitoring"]}]},{id:"healthcare",name:"healthcare",displayName:"AWS Healthcare Agent OS",description:"Healthcare operations and patient management",logo:"https://aws.amazon.com/favicon.ico",primaryColor:"hsl(145, 70%, 45%)",accentColor:"hsl(145, 70%, 35%)",gradientBg:"linear-gradient(145deg, #000000 0%, #00B566 50%, #FFFFFF 100%)",borderColor:"hsl(145, 70%, 45% / 0.3)",navigation:[{path:"/",label:"Health Dashboard",icon:"Command"},{path:"/agent-command",label:"Care Command Centre",icon:"Command"},{path:"/agents",label:"Healthcare Agents",icon:"Bot"},{path:"/multi-agent-workspace",label:"Care Orchestration",icon:"Bot"},{path:"/mcp-dashboard",label:"MCP Gateway",icon:"Server"},{path:"/agent-exchange",label:"Health Solutions",icon:"ShoppingBag"},{path:"/patient-analytics",label:"Patient Analytics",icon:"TrendingUp"},{path:"/care-management",label:"Care Management",icon:"Heart"},{path:"/system-flow",label:"AgentOS Architecture Blueprint",icon:"Network"},{path:"/settings",label:"Settings",icon:"Settings"}],workflows:[{id:"patient-care",name:"Patient Care Management",description:"Comprehensive patient care with specialized agents",agents:["Care Coordinator","Diagnostic Assistant","Treatment Planner","Medication Manager","Wellness Coach","Emergency Responder"],workflows:["Care Coordination","Diagnosis Support","Treatment Planning","Medication Management","Wellness Monitoring","Emergency Response"]}]}],wte=U.createContext(void 0),b_=()=>{const e=U.useContext(wte);if(e===void 0)throw new Error("useIndustry must be used within an IndustryProvider");return e},Xje=({children:e})=>{const t=()=>{try{const p=localStorage.getItem("industryConfig");if(p){const x=JSON.parse(p);if(x.id&&x.name&&x.displayName)return x}}catch(p){console.warn("Failed to load saved industry config:",p)}const d={..._G[0]},s=localStorage.getItem("customLogo");return s&&(d.logo=s),d},[r,i]=U.useState(t()),l={currentIndustry:r,setIndustry:d=>{i(d),document.documentElement.style.setProperty("--industry-primary",d.primaryColor),document.documentElement.style.setProperty("--industry-accent",d.accentColor),document.documentElement.style.setProperty("--industry-border",d.borderColor)},availableIndustries:_G};return n.jsx(wte.Provider,{value:l,children:e})},Jje=()=>{const{currentIndustry:e}=b_();return n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx("div",{className:"flex items-center justify-center w-10 h-10 bg-white rounded-lg p-1",children:n.jsx("img",{src:e.logo,alt:`${e.displayName} Logo`,className:"w-full h-full object-contain"})}),n.jsxs("div",{className:"flex flex-col",children:[n.jsx("h1",{className:"text-lg font-bold text-white leading-tight",children:e.name.charAt(0).toUpperCase()+e.name.slice(1)}),n.jsx("span",{className:"text-xs text-gray-400 leading-tight",children:"Agent OS"})]})]})},wG={Command:hb,Bot:Hi,Workflow:p_,ShoppingBag:BQ,TrendingUp:En,Users:qi,Settings:ws,Globe:Zs,Heart:OF,CreditCard:m_,Smartphone:Vp,Building2:J0,ChevronDown:Na,ChevronRight:ng,Activity:bs,Network:ga,Server:eo};function Qje(){const e=qN(),{currentIndustry:t}=b_(),[r,i]=U.useState(new Set(["core"])),a=s=>e.pathname===s,l=s=>{const p=new Set(r);p.has(s)?p.delete(s):p.add(s),i(p)},d=[{id:"core",label:"Core Platform",icon:"Command",items:[{path:"/",label:"Dashboard",icon:"Command"},{path:"/system-flow",label:"AgentOS Architecture Blueprint",icon:"Network"},{path:"/agent-command",label:"Agent Command Centre",icon:"Command"},{path:"/agents",label:"AI Agents",icon:"Bot"},{path:"/multi-agent-workspace",label:"Multi Agent Workspace",icon:"Bot"},{path:"/mcp-dashboard",label:"MCP Gateway",icon:"Server"},{path:"/agent-exchange",label:"AI Marketplace",icon:"ShoppingBag"}]},{id:"use-cases",label:"Agent Use Cases",icon:"TrendingUp",items:t.id==="banking"?[{path:"/risk-analytics",label:"Risk Analytics",icon:"TrendingUp"},{path:"/wealth-management",label:"Wealth Management",icon:"TrendingUp"},{path:"/customer-insights",label:"Customer Insights",icon:"Users"}]:t.id==="telco"?[{path:"/network-twin",label:"Network Twin",icon:"Globe"},{path:"/customer-analytics",label:"Customer Analytics",icon:"Users"}]:[{path:"/patient-analytics",label:"Patient Analytics",icon:"TrendingUp"},{path:"/care-management",label:"Care Management",icon:"Users"}]},{id:"monitoring",label:"Monitoring & Control",icon:"Activity",items:[{path:"/agent-control",label:"AgentCore Observability",icon:"Activity"}]},{id:"configuration",label:"Configuration",icon:"Settings",items:[{path:"/settings",label:"Settings",icon:"Settings"}]}];return n.jsx(xte,{style:{borderColor:t.borderColor},children:n.jsxs(bte,{className:"bg-black text-white",children:[n.jsx(yte,{className:"border-b pb-4",style:{borderColor:t.borderColor},children:n.jsx(om,{to:"/",className:"px-4",children:n.jsx(Jje,{})})}),n.jsx(_te,{className:"space-y-2 p-2",children:d.map(s=>{const p=wG[s.icon]||hb,x=r.has(s.id),w=x?Na:ng;return n.jsxs("div",{className:"space-y-1",children:[n.jsx(n5,{children:n.jsxs(i5,{onClick:()=>l(s.id),className:"hover:bg-white/10 hover:text-white rounded-lg text-gray-300 cursor-pointer transition-colors",children:[n.jsx(p,{style:{color:t.primaryColor}}),n.jsx("span",{className:"flex-1 text-left",children:s.label}),n.jsx(w,{className:"w-4 h-4 text-gray-400"})]})}),x&&n.jsx("div",{className:"ml-4 space-y-1",children:s.items.map(j=>{const S=wG[j.icon]||hb;return n.jsx(n5,{children:n.jsx(i5,{asChild:!0,className:`hover:bg-white/10 hover:text-white rounded-lg transition-colors ${a(j.path)?"text-white":"text-gray-400"}`,style:{backgroundColor:a(j.path)?t.primaryColor:"transparent"},children:n.jsxs(om,{to:j.path,children:[n.jsx(S,{className:"w-4 h-4",style:{color:a(j.path)?"white":t.primaryColor}}),n.jsx("span",{className:"text-sm",children:j.label})]})})},j.path)})})]},s.id)})}),n.jsxs(vte,{className:"text-xs text-gray-400 border-t pt-4",style:{borderColor:t.borderColor},children:["© ",new Date().getFullYear()," ",t.displayName]})]})})}var e2e=U.createContext(void 0);function sg(e){const t=U.useContext(e2e);return e||t||"ltr"}function t2e(e,t=[]){let r=[];function i(l,d){const s=U.createContext(d),p=r.length;r=[...r,d];function x(j){const{scope:S,children:P,...F}=j,L=(S==null?void 0:S[e][p])||s,B=U.useMemo(()=>F,Object.values(F));return n.jsx(L.Provider,{value:B,children:P})}function w(j,S){const P=(S==null?void 0:S[e][p])||s,F=U.useContext(P);if(F)return F;if(d!==void 0)return d;throw new Error(`\`${j}\` must be used within \`${l}\``)}return x.displayName=l+"Provider",[x,w]}const a=()=>{const l=r.map(d=>U.createContext(d));return function(s){const p=(s==null?void 0:s[e])||l;return U.useMemo(()=>({[`__scope${e}`]:{...s,[e]:p}}),[s,p])}};return a.scopeName=e,[i,r2e(a,...t)]}function r2e(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const i=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(l){const d=i.reduce((s,{useScope:p,scopeName:x})=>{const j=p(l)[`__scope${x}`];return{...s,...j}},{});return U.useMemo(()=>({[`__scope${t.scopeName}`]:d}),[d])}};return r.scopeName=t.scopeName,r}var _O="rovingFocusGroup.onEntryFocus",n2e={bubbles:!1,cancelable:!0},GE="RovingFocusGroup",[s5,jte,i2e]=d_(GE),[s2e,__]=t2e(GE,[i2e]),[a2e,o2e]=s2e(GE),Nte=U.forwardRef((e,t)=>n.jsx(s5.Provider,{scope:e.__scopeRovingFocusGroup,children:n.jsx(s5.Slot,{scope:e.__scopeRovingFocusGroup,children:n.jsx(l2e,{...e,ref:t})})}));Nte.displayName=GE;var l2e=U.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,orientation:i,loop:a=!1,dir:l,currentTabStopId:d,defaultCurrentTabStopId:s,onCurrentTabStopIdChange:p,onEntryFocus:x,preventScrollOnEntryFocus:w=!1,...j}=e,S=U.useRef(null),P=Mn(t,S),F=sg(l),[L=null,B]=fo({prop:d,defaultProp:s,onChange:p}),[V,$]=U.useState(!1),G=Ws(x),W=jte(r),Z=U.useRef(!1),[se,ae]=U.useState(0);return U.useEffect(()=>{const ce=S.current;if(ce)return ce.addEventListener(_O,G),()=>ce.removeEventListener(_O,G)},[G]),n.jsx(a2e,{scope:r,orientation:i,dir:F,loop:a,currentTabStopId:L,onItemFocus:U.useCallback(ce=>B(ce),[B]),onItemShiftTab:U.useCallback(()=>$(!0),[]),onFocusableItemAdd:U.useCallback(()=>ae(ce=>ce+1),[]),onFocusableItemRemove:U.useCallback(()=>ae(ce=>ce-1),[]),children:n.jsx(Hr.div,{tabIndex:V||se===0?-1:0,"data-orientation":i,...j,ref:P,style:{outline:"none",...e.style},onMouseDown:_r(e.onMouseDown,()=>{Z.current=!0}),onFocus:_r(e.onFocus,ce=>{const Pe=!Z.current;if(ce.target===ce.currentTarget&&Pe&&!V){const we=new CustomEvent(_O,n2e);if(ce.currentTarget.dispatchEvent(we),!we.defaultPrevented){const xe=W().filter(_e=>_e.focusable),Ne=xe.find(_e=>_e.active),ze=xe.find(_e=>_e.id===L),ve=[Ne,ze,...xe].filter(Boolean).map(_e=>_e.ref.current);Ate(ve,w)}}Z.current=!1}),onBlur:_r(e.onBlur,()=>$(!1))})})}),Ste="RovingFocusGroupItem",Cte=U.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,focusable:i=!0,active:a=!1,tabStopId:l,...d}=e,s=rc(),p=l||s,x=o2e(Ste,r),w=x.currentTabStopId===p,j=jte(r),{onFocusableItemAdd:S,onFocusableItemRemove:P}=x;return U.useEffect(()=>{if(i)return S(),()=>P()},[i,S,P]),n.jsx(s5.ItemSlot,{scope:r,id:p,focusable:i,active:a,children:n.jsx(Hr.span,{tabIndex:w?0:-1,"data-orientation":x.orientation,...d,ref:t,onMouseDown:_r(e.onMouseDown,F=>{i?x.onItemFocus(p):F.preventDefault()}),onFocus:_r(e.onFocus,()=>x.onItemFocus(p)),onKeyDown:_r(e.onKeyDown,F=>{if(F.key==="Tab"&&F.shiftKey){x.onItemShiftTab();return}if(F.target!==F.currentTarget)return;const L=d2e(F,x.orientation,x.dir);if(L!==void 0){if(F.metaKey||F.ctrlKey||F.altKey||F.shiftKey)return;F.preventDefault();let V=j().filter($=>$.focusable).map($=>$.ref.current);if(L==="last")V.reverse();else if(L==="prev"||L==="next"){L==="prev"&&V.reverse();const $=V.indexOf(F.currentTarget);V=x.loop?h2e(V,$+1):V.slice($+1)}setTimeout(()=>Ate(V))}})})})});Cte.displayName=Ste;var c2e={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function u2e(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function d2e(e,t,r){const i=u2e(e.key,r);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(i))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(i)))return c2e[i]}function Ate(e,t=!1){const r=document.activeElement;for(const i of e)if(i===r||(i.focus({preventScroll:t}),document.activeElement!==r))return}function h2e(e,t){return e.map((r,i)=>e[(t+i)%e.length])}var oB=Nte,lB=Cte,a5=["Enter"," "],m2e=["ArrowDown","PageUp","Home"],Tte=["ArrowUp","PageDown","End"],f2e=[...m2e,...Tte],p2e={ltr:[...a5,"ArrowRight"],rtl:[...a5,"ArrowLeft"]},g2e={ltr:["ArrowLeft"],rtl:["ArrowRight"]},QN="Menu",[j2,x2e,y2e]=d_(QN),[wx,kte]=Jo(QN,[y2e,ig,__]),HE=ig(),Pte=__(),[v2e,jx]=wx(QN),[b2e,eS]=wx(QN),Ete=e=>{const{__scopeMenu:t,open:r=!1,children:i,dir:a,onOpenChange:l,modal:d=!0}=e,s=HE(t),[p,x]=U.useState(null),w=U.useRef(!1),j=Ws(l),S=sg(a);return U.useEffect(()=>{const P=()=>{w.current=!0,document.addEventListener("pointerdown",F,{capture:!0,once:!0}),document.addEventListener("pointermove",F,{capture:!0,once:!0})},F=()=>w.current=!1;return document.addEventListener("keydown",P,{capture:!0}),()=>{document.removeEventListener("keydown",P,{capture:!0}),document.removeEventListener("pointerdown",F,{capture:!0}),document.removeEventListener("pointermove",F,{capture:!0})}},[]),n.jsx(kE,{...s,children:n.jsx(v2e,{scope:t,open:r,onOpenChange:j,content:p,onContentChange:x,children:n.jsx(b2e,{scope:t,onClose:U.useCallback(()=>j(!1),[j]),isUsingKeyboardRef:w,dir:S,modal:d,children:i})})})};Ete.displayName=QN;var _2e="MenuAnchor",cB=U.forwardRef((e,t)=>{const{__scopeMenu:r,...i}=e,a=HE(r);return n.jsx(UN,{...a,...i,ref:t})});cB.displayName=_2e;var uB="MenuPortal",[w2e,Mte]=wx(uB,{forceMount:void 0}),Ite=e=>{const{__scopeMenu:t,forceMount:r,children:i,container:a}=e,l=jx(uB,t);return n.jsx(w2e,{scope:t,forceMount:r,children:n.jsx(io,{present:r||l.open,children:n.jsx(h_,{asChild:!0,container:a,children:i})})})};Ite.displayName=uB;var bu="MenuContent",[j2e,dB]=wx(bu),Ote=U.forwardRef((e,t)=>{const r=Mte(bu,e.__scopeMenu),{forceMount:i=r.forceMount,...a}=e,l=jx(bu,e.__scopeMenu),d=eS(bu,e.__scopeMenu);return n.jsx(j2.Provider,{scope:e.__scopeMenu,children:n.jsx(io,{present:i||l.open,children:n.jsx(j2.Slot,{scope:e.__scopeMenu,children:d.modal?n.jsx(N2e,{...a,ref:t}):n.jsx(S2e,{...a,ref:t})})})})}),N2e=U.forwardRef((e,t)=>{const r=jx(bu,e.__scopeMenu),i=U.useRef(null),a=Mn(t,i);return U.useEffect(()=>{const l=i.current;if(l)return $E(l)},[]),n.jsx(hB,{...e,ref:a,trapFocus:r.open,disableOutsidePointerEvents:r.open,disableOutsideScroll:!0,onFocusOutside:_r(e.onFocusOutside,l=>l.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>r.onOpenChange(!1)})}),S2e=U.forwardRef((e,t)=>{const r=jx(bu,e.__scopeMenu);return n.jsx(hB,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>r.onOpenChange(!1)})}),hB=U.forwardRef((e,t)=>{const{__scopeMenu:r,loop:i=!1,trapFocus:a,onOpenAutoFocus:l,onCloseAutoFocus:d,disableOutsidePointerEvents:s,onEntryFocus:p,onEscapeKeyDown:x,onPointerDownOutside:w,onFocusOutside:j,onInteractOutside:S,onDismiss:P,disableOutsideScroll:F,...L}=e,B=jx(bu,r),V=eS(bu,r),$=HE(r),G=Pte(r),W=x2e(r),[Z,se]=U.useState(null),ae=U.useRef(null),ce=Mn(t,ae,B.onContentChange),Pe=U.useRef(0),we=U.useRef(""),xe=U.useRef(0),Ne=U.useRef(null),ze=U.useRef("right"),ye=U.useRef(0),ve=F?KN:U.Fragment,_e=F?{as:Al,allowPinchZoom:!0}:void 0,Ee=Ce=>{var Ft,er;const tt=we.current+Ce,it=W().filter(Dt=>!Dt.disabled),mt=document.activeElement,gt=(Ft=it.find(Dt=>Dt.ref.current===mt))==null?void 0:Ft.textValue,qt=it.map(Dt=>Dt.textValue),yr=z2e(qt,tt,gt),tr=(er=it.find(Dt=>Dt.textValue===yr))==null?void 0:er.ref.current;(function Dt(ge){we.current=ge,window.clearTimeout(Pe.current),ge!==""&&(Pe.current=window.setTimeout(()=>Dt(""),1e3))})(tt),tr&&setTimeout(()=>tr.focus())};U.useEffect(()=>()=>window.clearTimeout(Pe.current),[]),FE();const je=U.useCallback(Ce=>{var it,mt;return ze.current===((it=Ne.current)==null?void 0:it.side)&&F2e(Ce,(mt=Ne.current)==null?void 0:mt.area)},[]);return n.jsx(j2e,{scope:r,searchRef:we,onItemEnter:U.useCallback(Ce=>{je(Ce)&&Ce.preventDefault()},[je]),onItemLeave:U.useCallback(Ce=>{var tt;je(Ce)||((tt=ae.current)==null||tt.focus(),se(null))},[je]),onTriggerLeave:U.useCallback(Ce=>{je(Ce)&&Ce.preventDefault()},[je]),pointerGraceTimerRef:xe,onPointerGraceIntentChange:U.useCallback(Ce=>{Ne.current=Ce},[]),children:n.jsx(ve,{..._e,children:n.jsx(WN,{asChild:!0,trapped:a,onMountAutoFocus:_r(l,Ce=>{var tt;Ce.preventDefault(),(tt=ae.current)==null||tt.focus({preventScroll:!0})}),onUnmountAutoFocus:d,children:n.jsx(yx,{asChild:!0,disableOutsidePointerEvents:s,onEscapeKeyDown:x,onPointerDownOutside:w,onFocusOutside:j,onInteractOutside:S,onDismiss:P,children:n.jsx(oB,{asChild:!0,...G,dir:V.dir,orientation:"vertical",loop:i,currentTabStopId:Z,onCurrentTabStopIdChange:se,onEntryFocus:_r(p,Ce=>{V.isUsingKeyboardRef.current||Ce.preventDefault()}),preventScrollOnEntryFocus:!0,children:n.jsx(PE,{role:"menu","aria-orientation":"vertical","data-state":Yte(B.open),"data-radix-menu-content":"",dir:V.dir,...$,...L,ref:ce,style:{outline:"none",...L.style},onKeyDown:_r(L.onKeyDown,Ce=>{const it=Ce.target.closest("[data-radix-menu-content]")===Ce.currentTarget,mt=Ce.ctrlKey||Ce.altKey||Ce.metaKey,gt=Ce.key.length===1;it&&(Ce.key==="Tab"&&Ce.preventDefault(),!mt&&gt&&Ee(Ce.key));const qt=ae.current;if(Ce.target!==qt||!f2e.includes(Ce.key))return;Ce.preventDefault();const tr=W().filter(Ft=>!Ft.disabled).map(Ft=>Ft.ref.current);Tte.includes(Ce.key)&&tr.reverse(),R2e(tr)}),onBlur:_r(e.onBlur,Ce=>{Ce.currentTarget.contains(Ce.target)||(window.clearTimeout(Pe.current),we.current="")}),onPointerMove:_r(e.onPointerMove,N2(Ce=>{const tt=Ce.target,it=ye.current!==Ce.clientX;if(Ce.currentTarget.contains(tt)&&it){const mt=Ce.clientX>ye.current?"right":"left";ze.current=mt,ye.current=Ce.clientX}}))})})})})})})});Ote.displayName=bu;var C2e="MenuGroup",mB=U.forwardRef((e,t)=>{const{__scopeMenu:r,...i}=e;return n.jsx(Hr.div,{role:"group",...i,ref:t})});mB.displayName=C2e;var A2e="MenuLabel",Rte=U.forwardRef((e,t)=>{const{__scopeMenu:r,...i}=e;return n.jsx(Hr.div,{...i,ref:t})});Rte.displayName=A2e;var yk="MenuItem",jG="menu.itemSelect",qE=U.forwardRef((e,t)=>{const{disabled:r=!1,onSelect:i,...a}=e,l=U.useRef(null),d=eS(yk,e.__scopeMenu),s=dB(yk,e.__scopeMenu),p=Mn(t,l),x=U.useRef(!1),w=()=>{const j=l.current;if(!r&&j){const S=new CustomEvent(jG,{bubbles:!0,cancelable:!0});j.addEventListener(jG,P=>i==null?void 0:i(P),{once:!0}),CF(j,S),S.defaultPrevented?x.current=!1:d.onClose()}};return n.jsx(Dte,{...a,ref:p,disabled:r,onClick:_r(e.onClick,w),onPointerDown:j=>{var S;(S=e.onPointerDown)==null||S.call(e,j),x.current=!0},onPointerUp:_r(e.onPointerUp,j=>{var S;x.current||(S=j.currentTarget)==null||S.click()}),onKeyDown:_r(e.onKeyDown,j=>{const S=s.searchRef.current!=="";r||S&&j.key===" "||a5.includes(j.key)&&(j.currentTarget.click(),j.preventDefault())})})});qE.displayName=yk;var Dte=U.forwardRef((e,t)=>{const{__scopeMenu:r,disabled:i=!1,textValue:a,...l}=e,d=dB(yk,r),s=Pte(r),p=U.useRef(null),x=Mn(t,p),[w,j]=U.useState(!1),[S,P]=U.useState("");return U.useEffect(()=>{const F=p.current;F&&P((F.textContent??"").trim())},[l.children]),n.jsx(j2.ItemSlot,{scope:r,disabled:i,textValue:a??S,children:n.jsx(lB,{asChild:!0,...s,focusable:!i,children:n.jsx(Hr.div,{role:"menuitem","data-highlighted":w?"":void 0,"aria-disabled":i||void 0,"data-disabled":i?"":void 0,...l,ref:x,onPointerMove:_r(e.onPointerMove,N2(F=>{i?d.onItemLeave(F):(d.onItemEnter(F),F.defaultPrevented||F.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:_r(e.onPointerLeave,N2(F=>d.onItemLeave(F))),onFocus:_r(e.onFocus,()=>j(!0)),onBlur:_r(e.onBlur,()=>j(!1))})})})}),T2e="MenuCheckboxItem",zte=U.forwardRef((e,t)=>{const{checked:r=!1,onCheckedChange:i,...a}=e;return n.jsx(Vte,{scope:e.__scopeMenu,checked:r,children:n.jsx(qE,{role:"menuitemcheckbox","aria-checked":vk(r)?"mixed":r,...a,ref:t,"data-state":pB(r),onSelect:_r(a.onSelect,()=>i==null?void 0:i(vk(r)?!0:!r),{checkForDefaultPrevented:!1})})})});zte.displayName=T2e;var Lte="MenuRadioGroup",[k2e,P2e]=wx(Lte,{value:void 0,onValueChange:()=>{}}),Fte=U.forwardRef((e,t)=>{const{value:r,onValueChange:i,...a}=e,l=Ws(i);return n.jsx(k2e,{scope:e.__scopeMenu,value:r,onValueChange:l,children:n.jsx(mB,{...a,ref:t})})});Fte.displayName=Lte;var Bte="MenuRadioItem",$te=U.forwardRef((e,t)=>{const{value:r,...i}=e,a=P2e(Bte,e.__scopeMenu),l=r===a.value;return n.jsx(Vte,{scope:e.__scopeMenu,checked:l,children:n.jsx(qE,{role:"menuitemradio","aria-checked":l,...i,ref:t,"data-state":pB(l),onSelect:_r(i.onSelect,()=>{var d;return(d=a.onValueChange)==null?void 0:d.call(a,r)},{checkForDefaultPrevented:!1})})})});$te.displayName=Bte;var fB="MenuItemIndicator",[Vte,E2e]=wx(fB,{checked:!1}),Ute=U.forwardRef((e,t)=>{const{__scopeMenu:r,forceMount:i,...a}=e,l=E2e(fB,r);return n.jsx(io,{present:i||vk(l.checked)||l.checked===!0,children:n.jsx(Hr.span,{...a,ref:t,"data-state":pB(l.checked)})})});Ute.displayName=fB;var M2e="MenuSeparator",Gte=U.forwardRef((e,t)=>{const{__scopeMenu:r,...i}=e;return n.jsx(Hr.div,{role:"separator","aria-orientation":"horizontal",...i,ref:t})});Gte.displayName=M2e;var I2e="MenuArrow",Hte=U.forwardRef((e,t)=>{const{__scopeMenu:r,...i}=e,a=HE(r);return n.jsx(EE,{...a,...i,ref:t})});Hte.displayName=I2e;var O2e="MenuSub",[nft,qte]=wx(O2e),xj="MenuSubTrigger",Wte=U.forwardRef((e,t)=>{const r=jx(xj,e.__scopeMenu),i=eS(xj,e.__scopeMenu),a=qte(xj,e.__scopeMenu),l=dB(xj,e.__scopeMenu),d=U.useRef(null),{pointerGraceTimerRef:s,onPointerGraceIntentChange:p}=l,x={__scopeMenu:e.__scopeMenu},w=U.useCallback(()=>{d.current&&window.clearTimeout(d.current),d.current=null},[]);return U.useEffect(()=>w,[w]),U.useEffect(()=>{const j=s.current;return()=>{window.clearTimeout(j),p(null)}},[s,p]),n.jsx(cB,{asChild:!0,...x,children:n.jsx(Dte,{id:a.triggerId,"aria-haspopup":"menu","aria-expanded":r.open,"aria-controls":a.contentId,"data-state":Yte(r.open),...e,ref:_E(t,a.onTriggerChange),onClick:j=>{var S;(S=e.onClick)==null||S.call(e,j),!(e.disabled||j.defaultPrevented)&&(j.currentTarget.focus(),r.open||r.onOpenChange(!0))},onPointerMove:_r(e.onPointerMove,N2(j=>{l.onItemEnter(j),!j.defaultPrevented&&!e.disabled&&!r.open&&!d.current&&(l.onPointerGraceIntentChange(null),d.current=window.setTimeout(()=>{r.onOpenChange(!0),w()},100))})),onPointerLeave:_r(e.onPointerLeave,N2(j=>{var P,F;w();const S=(P=r.content)==null?void 0:P.getBoundingClientRect();if(S){const L=(F=r.content)==null?void 0:F.dataset.side,B=L==="right",V=B?-5:5,$=S[B?"left":"right"],G=S[B?"right":"left"];l.onPointerGraceIntentChange({area:[{x:j.clientX+V,y:j.clientY},{x:$,y:S.top},{x:G,y:S.top},{x:G,y:S.bottom},{x:$,y:S.bottom}],side:L}),window.clearTimeout(s.current),s.current=window.setTimeout(()=>l.onPointerGraceIntentChange(null),300)}else{if(l.onTriggerLeave(j),j.defaultPrevented)return;l.onPointerGraceIntentChange(null)}})),onKeyDown:_r(e.onKeyDown,j=>{var P;const S=l.searchRef.current!=="";e.disabled||S&&j.key===" "||p2e[i.dir].includes(j.key)&&(r.onOpenChange(!0),(P=r.content)==null||P.focus(),j.preventDefault())})})})});Wte.displayName=xj;var Kte="MenuSubContent",Zte=U.forwardRef((e,t)=>{const r=Mte(bu,e.__scopeMenu),{forceMount:i=r.forceMount,...a}=e,l=jx(bu,e.__scopeMenu),d=eS(bu,e.__scopeMenu),s=qte(Kte,e.__scopeMenu),p=U.useRef(null),x=Mn(t,p);return n.jsx(j2.Provider,{scope:e.__scopeMenu,children:n.jsx(io,{present:i||l.open,children:n.jsx(j2.Slot,{scope:e.__scopeMenu,children:n.jsx(hB,{id:s.contentId,"aria-labelledby":s.triggerId,...a,ref:x,align:"start",side:d.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:w=>{var j;d.isUsingKeyboardRef.current&&((j=p.current)==null||j.focus()),w.preventDefault()},onCloseAutoFocus:w=>w.preventDefault(),onFocusOutside:_r(e.onFocusOutside,w=>{w.target!==s.trigger&&l.onOpenChange(!1)}),onEscapeKeyDown:_r(e.onEscapeKeyDown,w=>{d.onClose(),w.preventDefault()}),onKeyDown:_r(e.onKeyDown,w=>{var P;const j=w.currentTarget.contains(w.target),S=g2e[d.dir].includes(w.key);j&&S&&(l.onOpenChange(!1),(P=s.trigger)==null||P.focus(),w.preventDefault())})})})})})});Zte.displayName=Kte;function Yte(e){return e?"open":"closed"}function vk(e){return e==="indeterminate"}function pB(e){return vk(e)?"indeterminate":e?"checked":"unchecked"}function R2e(e){const t=document.activeElement;for(const r of e)if(r===t||(r.focus(),document.activeElement!==t))return}function D2e(e,t){return e.map((r,i)=>e[(t+i)%e.length])}function z2e(e,t,r){const a=t.length>1&&Array.from(t).every(x=>x===t[0])?t[0]:t,l=r?e.indexOf(r):-1;let d=D2e(e,Math.max(l,0));a.length===1&&(d=d.filter(x=>x!==r));const p=d.find(x=>x.toLowerCase().startsWith(a.toLowerCase()));return p!==r?p:void 0}function L2e(e,t){const{x:r,y:i}=e;let a=!1;for(let l=0,d=t.length-1;l<t.length;d=l++){const s=t[l].x,p=t[l].y,x=t[d].x,w=t[d].y;p>i!=w>i&&r<(x-s)*(i-p)/(w-p)+s&&(a=!a)}return a}function F2e(e,t){if(!t)return!1;const r={x:e.clientX,y:e.clientY};return L2e(r,t)}function N2(e){return t=>t.pointerType==="mouse"?e(t):void 0}var B2e=Ete,$2e=cB,V2e=Ite,U2e=Ote,G2e=mB,H2e=Rte,q2e=qE,W2e=zte,K2e=Fte,Z2e=$te,Y2e=Ute,X2e=Gte,J2e=Hte,Q2e=Wte,eNe=Zte,gB="DropdownMenu",[tNe,ift]=Jo(gB,[kte]),El=kte(),[rNe,Xte]=tNe(gB),Jte=e=>{const{__scopeDropdownMenu:t,children:r,dir:i,open:a,defaultOpen:l,onOpenChange:d,modal:s=!0}=e,p=El(t),x=U.useRef(null),[w=!1,j]=fo({prop:a,defaultProp:l,onChange:d});return n.jsx(rNe,{scope:t,triggerId:rc(),triggerRef:x,contentId:rc(),open:w,onOpenChange:j,onOpenToggle:U.useCallback(()=>j(S=>!S),[j]),modal:s,children:n.jsx(B2e,{...p,open:w,onOpenChange:j,dir:i,modal:s,children:r})})};Jte.displayName=gB;var Qte="DropdownMenuTrigger",ere=U.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,disabled:i=!1,...a}=e,l=Xte(Qte,r),d=El(r);return n.jsx($2e,{asChild:!0,...d,children:n.jsx(Hr.button,{type:"button",id:l.triggerId,"aria-haspopup":"menu","aria-expanded":l.open,"aria-controls":l.open?l.contentId:void 0,"data-state":l.open?"open":"closed","data-disabled":i?"":void 0,disabled:i,...a,ref:_E(t,l.triggerRef),onPointerDown:_r(e.onPointerDown,s=>{!i&&s.button===0&&s.ctrlKey===!1&&(l.onOpenToggle(),l.open||s.preventDefault())}),onKeyDown:_r(e.onKeyDown,s=>{i||(["Enter"," "].includes(s.key)&&l.onOpenToggle(),s.key==="ArrowDown"&&l.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(s.key)&&s.preventDefault())})})})});ere.displayName=Qte;var nNe="DropdownMenuPortal",tre=e=>{const{__scopeDropdownMenu:t,...r}=e,i=El(t);return n.jsx(V2e,{...i,...r})};tre.displayName=nNe;var rre="DropdownMenuContent",nre=U.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...i}=e,a=Xte(rre,r),l=El(r),d=U.useRef(!1);return n.jsx(U2e,{id:a.contentId,"aria-labelledby":a.triggerId,...l,...i,ref:t,onCloseAutoFocus:_r(e.onCloseAutoFocus,s=>{var p;d.current||(p=a.triggerRef.current)==null||p.focus(),d.current=!1,s.preventDefault()}),onInteractOutside:_r(e.onInteractOutside,s=>{const p=s.detail.originalEvent,x=p.button===0&&p.ctrlKey===!0,w=p.button===2||x;(!a.modal||w)&&(d.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});nre.displayName=rre;var iNe="DropdownMenuGroup",sNe=U.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...i}=e,a=El(r);return n.jsx(G2e,{...a,...i,ref:t})});sNe.displayName=iNe;var aNe="DropdownMenuLabel",ire=U.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...i}=e,a=El(r);return n.jsx(H2e,{...a,...i,ref:t})});ire.displayName=aNe;var oNe="DropdownMenuItem",sre=U.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...i}=e,a=El(r);return n.jsx(q2e,{...a,...i,ref:t})});sre.displayName=oNe;var lNe="DropdownMenuCheckboxItem",are=U.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...i}=e,a=El(r);return n.jsx(W2e,{...a,...i,ref:t})});are.displayName=lNe;var cNe="DropdownMenuRadioGroup",uNe=U.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...i}=e,a=El(r);return n.jsx(K2e,{...a,...i,ref:t})});uNe.displayName=cNe;var dNe="DropdownMenuRadioItem",ore=U.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...i}=e,a=El(r);return n.jsx(Z2e,{...a,...i,ref:t})});ore.displayName=dNe;var hNe="DropdownMenuItemIndicator",lre=U.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...i}=e,a=El(r);return n.jsx(Y2e,{...a,...i,ref:t})});lre.displayName=hNe;var mNe="DropdownMenuSeparator",cre=U.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...i}=e,a=El(r);return n.jsx(X2e,{...a,...i,ref:t})});cre.displayName=mNe;var fNe="DropdownMenuArrow",pNe=U.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...i}=e,a=El(r);return n.jsx(J2e,{...a,...i,ref:t})});pNe.displayName=fNe;var gNe="DropdownMenuSubTrigger",ure=U.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...i}=e,a=El(r);return n.jsx(Q2e,{...a,...i,ref:t})});ure.displayName=gNe;var xNe="DropdownMenuSubContent",dre=U.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...i}=e,a=El(r);return n.jsx(eNe,{...a,...i,ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});dre.displayName=xNe;var yNe=Jte,vNe=ere,bNe=tre,hre=nre,mre=ire,fre=sre,pre=are,gre=ore,xre=lre,yre=cre,vre=ure,bre=dre;const Ip=yNe,Op=vNe,_Ne=U.forwardRef(({className:e,inset:t,children:r,...i},a)=>n.jsxs(vre,{ref:a,className:Yt("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",t&&"pl-8",e),...i,children:[r,n.jsx(ng,{className:"ml-auto h-4 w-4"})]}));_Ne.displayName=vre.displayName;const wNe=U.forwardRef(({className:e,...t},r)=>n.jsx(bre,{ref:r,className:Yt("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t}));wNe.displayName=bre.displayName;const _m=U.forwardRef(({className:e,sideOffset:t=4,...r},i)=>n.jsx(bNe,{children:n.jsx(hre,{ref:i,sideOffset:t,className:Yt("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r})}));_m.displayName=hre.displayName;const Ao=U.forwardRef(({className:e,inset:t,...r},i)=>n.jsx(fre,{ref:i,className:Yt("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t&&"pl-8",e),...r}));Ao.displayName=fre.displayName;const jNe=U.forwardRef(({className:e,children:t,checked:r,...i},a)=>n.jsxs(pre,{ref:a,className:Yt("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),checked:r,...i,children:[n.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:n.jsx(xre,{children:n.jsx(hh,{className:"h-4 w-4"})})}),t]}));jNe.displayName=pre.displayName;const NNe=U.forwardRef(({className:e,children:t,...r},i)=>n.jsxs(gre,{ref:i,className:Yt("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...r,children:[n.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:n.jsx(xre,{children:n.jsx(ive,{className:"h-2 w-2 fill-current"})})}),t]}));NNe.displayName=gre.displayName;const SNe=U.forwardRef(({className:e,inset:t,...r},i)=>n.jsx(mre,{ref:i,className:Yt("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",e),...r}));SNe.displayName=mre.displayName;const _re=U.forwardRef(({className:e,...t},r)=>n.jsx(yre,{ref:r,className:Yt("-mx-1 my-1 h-px bg-muted",e),...t}));_re.displayName=yre.displayName;const NG={banking:J0,telco:Vp,healthcare:OF},CNe=()=>{const{currentIndustry:e,availableIndustries:t,setIndustry:r}=b_(),i=l=>{r(l)},a=NG[e.id]||J0;return n.jsxs(Ip,{children:[n.jsx(Op,{asChild:!0,children:n.jsxs(lt,{variant:"ghost",className:"flex items-center gap-2 text-white hover:bg-white/10 border border-white/20",children:[n.jsx(a,{className:"h-4 w-4",style:{color:e.primaryColor}}),n.jsx("span",{className:"hidden sm:inline",children:e.displayName}),n.jsx(Na,{className:"h-4 w-4"})]})}),n.jsxs(_m,{align:"end",className:"w-64 bg-black/90 border-white/20",children:[n.jsx("div",{className:"px-3 py-2 text-sm text-gray-400",children:"Switch Industry"}),n.jsx(_re,{className:"bg-white/20"}),t.map(l=>{const d=NG[l.id]||J0,s=e.id===l.id;return n.jsxs(Ao,{onClick:()=>i(l),className:`flex items-start gap-3 p-3 cursor-pointer hover:bg-white/10 ${s?"bg-white/5":""}`,children:[n.jsx(d,{className:"h-5 w-5 mt-0.5 flex-shrink-0",style:{color:l.primaryColor}}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"font-medium text-white",children:l.displayName}),s&&n.jsx("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:l.primaryColor}})]}),n.jsx("p",{className:"text-xs text-gray-400 mt-0.5 leading-tight",children:l.description})]})]},l.id)})]})]})},Ia=({children:e})=>{const[t]=U.useState({email:"demo@ashrepo.com"}),r=eB(),i=()=>{console.log("Logged out successfully"),r("/auth")};return n.jsx(gte,{children:n.jsxs("div",{className:"flex h-screen overflow-hidden bg-black w-full",children:[n.jsx(Qje,{}),n.jsxs("div",{className:"flex-1 overflow-hidden min-w-0",children:[t&&n.jsxs("div",{className:"flex justify-between items-center px-4 py-2 bg-gray-900/80 border-b border-white/20",children:[n.jsx(CNe,{}),n.jsxs("div",{className:"flex items-center gap-2 text-white",children:[n.jsx($N,{className:"h-4 w-4 text-gray-400"}),n.jsx("span",{className:"text-sm",children:t.email}),n.jsxs(lt,{variant:"ghost",size:"sm",onClick:i,className:"text-white hover:bg-white/10",children:[n.jsx(RQ,{className:"h-4 w-4 mr-2"}),"Logout"]})]})]}),n.jsx("div",{className:"h-full overflow-y-auto overflow-x-hidden pl-6 pr-0 pt-6 pb-6",children:e})]})]})})},jt=U.forwardRef(({className:e,...t},r)=>n.jsx("div",{ref:r,className:Yt("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));jt.displayName="Card";const wr=U.forwardRef(({className:e,...t},r)=>n.jsx("div",{ref:r,className:Yt("flex flex-col space-y-1.5 p-6",e),...t}));wr.displayName="CardHeader";const fr=U.forwardRef(({className:e,...t},r)=>n.jsx("h3",{ref:r,className:Yt("text-2xl font-semibold leading-none tracking-tight",e),...t}));fr.displayName="CardTitle";const Ii=U.forwardRef(({className:e,...t},r)=>n.jsx("p",{ref:r,className:Yt("text-sm text-muted-foreground",e),...t}));Ii.displayName="CardDescription";const Ht=U.forwardRef(({className:e,...t},r)=>n.jsx("div",{ref:r,className:Yt("p-6 pt-0",e),...t}));Ht.displayName="CardContent";const WE=U.forwardRef(({className:e,...t},r)=>n.jsx("div",{ref:r,className:Yt("flex items-center p-6 pt-0",e),...t}));WE.displayName="CardFooter";const ANe=()=>n.jsxs("div",{className:"flex-1 p-6 md:p-10 space-y-8",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold text-white",children:"Intelligent Agent OS"}),n.jsx("p",{className:"text-gray-400 mt-2",children:"AI-powered solutions for modern operations"})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[n.jsxs(jt,{className:"bg-beam-dark-accent border-gray-700 p-6 hover:border-beam-blue/50 transition-colors",children:[n.jsx("div",{className:"h-12 w-12 rounded-lg bg-beam-dark flex items-center justify-center mb-4",children:n.jsx(hb,{className:"h-6 w-6 text-beam-blue"})}),n.jsx("h2",{className:"text-xl font-semibold text-white mb-2",children:"Control Center"}),n.jsx("p",{className:"text-gray-400 mb-4",children:"Centrally manage all banking AI operations"}),n.jsx(lt,{asChild:!0,variant:"default",className:"w-full bg-beam-blue hover:bg-beam-blue/90",children:n.jsx(om,{to:"/agent-command",children:"Launch Control Center"})})]}),n.jsxs(jt,{className:"bg-beam-dark-accent border-gray-700 p-6 hover:border-beam-blue/50 transition-colors",children:[n.jsx("div",{className:"h-12 w-12 rounded-lg bg-beam-dark flex items-center justify-center mb-4",children:n.jsx(Hi,{className:"h-6 w-6 text-beam-blue"})}),n.jsx("h2",{className:"text-xl font-semibold text-white mb-2",children:"AI Agents"}),n.jsx("p",{className:"text-gray-400 mb-4",children:"Manage intelligent banking assistants"}),n.jsx(lt,{asChild:!0,variant:"default",className:"w-full bg-beam-blue hover:bg-beam-blue/90",children:n.jsx(om,{to:"/agents",children:"Agent Dashboard"})})]}),n.jsxs(jt,{className:"bg-beam-dark-accent border-gray-700 p-6 hover:border-beam-blue/50 transition-colors",children:[n.jsx("div",{className:"h-12 w-12 rounded-lg bg-beam-dark flex items-center justify-center mb-4",children:n.jsx(p_,{className:"h-6 w-6 text-beam-blue"})}),n.jsx("h2",{className:"text-xl font-semibold text-white mb-2",children:"Agent Workspace"}),n.jsx("p",{className:"text-gray-400 mb-4",children:"Interactive environment for banking AI deployment"}),n.jsx(lt,{asChild:!0,variant:"default",className:"w-full bg-beam-blue hover:bg-beam-blue/90",children:n.jsx(om,{to:"/agent-workspace",children:"Open Workspace"})})]}),n.jsxs(jt,{className:"bg-beam-dark-accent border-gray-700 p-6 hover:border-beam-blue/50 transition-colors",children:[n.jsx("div",{className:"h-12 w-12 rounded-lg bg-beam-dark flex items-center justify-center mb-4",children:n.jsx(Hi,{className:"h-6 w-6 text-beam-blue"})}),n.jsx("h2",{className:"text-xl font-semibold text-white mb-2",children:"Multi Agent Workspace"}),n.jsx("p",{className:"text-gray-400 mb-4",children:"Drag-and-drop builder for multi-agent workflows"}),n.jsx(lt,{asChild:!0,variant:"default",className:"w-full bg-beam-blue hover:bg-beam-blue/90",children:n.jsx(om,{to:"/multi-agent-workspace",children:"Build Workflows"})})]}),n.jsxs(jt,{className:"bg-beam-dark-accent border-gray-700 p-6 hover:border-beam-blue/50 transition-colors",children:[n.jsx("div",{className:"h-12 w-12 rounded-lg bg-beam-dark flex items-center justify-center mb-4",children:n.jsx(BQ,{className:"h-6 w-6 text-beam-blue"})}),n.jsx("h2",{className:"text-xl font-semibold text-white mb-2",children:"AI Marketplace"}),n.jsx("p",{className:"text-gray-400 mb-4",children:"Discover banking-specific AI solutions"}),n.jsx(lt,{asChild:!0,variant:"default",className:"w-full bg-beam-blue hover:bg-beam-blue/90",children:n.jsx(om,{to:"/agent-exchange",children:"Browse Marketplace"})})]}),n.jsxs(jt,{className:"bg-beam-dark-accent border-gray-700 p-6 hover:border-beam-blue/50 transition-colors",children:[n.jsx("div",{className:"h-12 w-12 rounded-lg bg-beam-dark flex items-center justify-center mb-4",children:n.jsx(En,{className:"h-6 w-6 text-beam-blue"})}),n.jsx("h2",{className:"text-xl font-semibold text-white mb-2",children:"Risk Analytics"}),n.jsx("p",{className:"text-gray-400 mb-4",children:"Advanced risk modeling and fraud detection"}),n.jsx(lt,{asChild:!0,variant:"default",className:"w-full bg-beam-blue hover:bg-beam-blue/90",children:n.jsx(om,{to:"/risk-analytics",children:"Open Risk Analytics"})})]}),n.jsxs(jt,{className:"bg-beam-dark-accent border-gray-700 p-6 hover:border-beam-blue/50 transition-colors",children:[n.jsx("div",{className:"h-12 w-12 rounded-lg bg-beam-dark flex items-center justify-center mb-4",children:n.jsx(qi,{className:"h-6 w-6 text-beam-blue"})}),n.jsx("h2",{className:"text-xl font-semibold text-white mb-2",children:"Customer Insights"}),n.jsx("p",{className:"text-gray-400 mb-4",children:"Deep customer analytics and personalization"}),n.jsx(lt,{asChild:!0,variant:"default",className:"w-full bg-beam-blue hover:bg-beam-blue/90",children:n.jsx(om,{to:"/customer-insights",children:"View Insights"})})]})]})]});function TNe(){return n.jsx(ANe,{})}const wO=[{id:1,name:"Product Development Agent",status:"Active",model:"GPT-4o",owner:"Product Team",lastActive:"2 hours ago",tools:["Database","Market Research","Roadmap Planning"],data:["Product Metrics","User Feedback","Industry Reports"],guardrails:["Content Filter: High","PII Redaction: On","Budget: $50/day"],performance:{satisfaction:92,accuracy:89,responseTime:1.2},modelMetadata:{provider:"OpenAI",size:"1.76 trillion parameters",contextLength:"128K tokens",costPerToken:"$0.005/1K tokens",capabilities:["Multimodal","Code Generation","Complex Reasoning"]}},{id:2,name:"Customer Support Agent",status:"Active",model:"Claude 3",owner:"Support Team",lastActive:"5 mins ago",tools:["CRM","Knowledge Base","Ticket Management"],data:["Customer Profiles","Support Tickets","Product Documentation"],guardrails:["Content Filter: High","Authentication Required","Budget: $75/day"],performance:{satisfaction:95,accuracy:91,responseTime:.8},modelMetadata:{provider:"Anthropic",size:"1.5 trillion parameters",contextLength:"200K tokens",costPerToken:"$0.008/1K tokens",capabilities:["Multimodal","Nuanced Instructions","Long Context"]}},{id:3,name:"Marketing Analysis Agent",status:"Idle",model:"GPT-4.5-preview",owner:"Marketing Team",lastActive:"1 day ago",tools:["Analytics","Content Generator","Social Media API"],data:["Campaign Metrics","Audience Data","Market Trends"],guardrails:["Content Filter: Medium","Brand Voice Control","Budget: $40/day"],performance:{satisfaction:88,accuracy:85,responseTime:1.7},modelMetadata:{provider:"OpenAI",size:"2.1 trillion parameters",contextLength:"256K tokens",costPerToken:"$0.01/1K tokens",capabilities:["Advanced Reasoning","Creative Generation","Fine-grained Control"]}}],Mc=U.forwardRef(({className:e,...t},r)=>n.jsx("div",{className:"relative w-full overflow-auto",children:n.jsx("table",{ref:r,className:Yt("w-full caption-bottom text-sm",e),...t})}));Mc.displayName="Table";const Ic=U.forwardRef(({className:e,...t},r)=>n.jsx("thead",{ref:r,className:Yt("[&_tr]:border-b",e),...t}));Ic.displayName="TableHeader";const Oc=U.forwardRef(({className:e,...t},r)=>n.jsx("tbody",{ref:r,className:Yt("[&_tr:last-child]:border-0",e),...t}));Oc.displayName="TableBody";const kNe=U.forwardRef(({className:e,...t},r)=>n.jsx("tfoot",{ref:r,className:Yt("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...t}));kNe.displayName="TableFooter";const Fs=U.forwardRef(({className:e,...t},r)=>n.jsx("tr",{ref:r,className:Yt("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...t}));Fs.displayName="TableRow";const Or=U.forwardRef(({className:e,...t},r)=>n.jsx("th",{ref:r,className:Yt("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...t}));Or.displayName="TableHead";const Rr=U.forwardRef(({className:e,...t},r)=>n.jsx("td",{ref:r,className:Yt("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...t}));Rr.displayName="TableCell";const PNe=U.forwardRef(({className:e,...t},r)=>n.jsx("caption",{ref:r,className:Yt("mt-4 text-sm text-muted-foreground",e),...t}));PNe.displayName="TableCaption";const ENe=({agents:e,selectedAgent:t,setSelectedAgent:r})=>n.jsxs(jt,{className:"bg-beam-dark-accent/70 border-gray-700",children:[n.jsxs(wr,{className:"pb-2",children:[n.jsx(fr,{className:"text-xl text-white",children:"Deployed Agents"}),n.jsx(Ii,{className:"text-gray-400",children:"Select an agent to view details"})]}),n.jsx(Ht,{children:n.jsx("div",{className:"overflow-x-auto",children:n.jsxs(Mc,{children:[n.jsx(Ic,{children:n.jsxs(Fs,{className:"hover:bg-white/5",children:[n.jsx(Or,{className:"text-white",children:"Name"}),n.jsx(Or,{className:"text-white",children:"Status"}),n.jsx(Or,{className:"text-white",children:"Model"}),n.jsx(Or,{className:"text-white",children:"Owner"}),n.jsx(Or,{className:"text-white",children:"Last Active"}),n.jsx(Or,{className:"text-white",children:"Actions"})]})}),n.jsx(Oc,{children:e.map(i=>n.jsxs(Fs,{className:`hover:bg-white/5 border-white/10 cursor-pointer ${t.id===i.id?"bg-beam-blue/10":""}`,onClick:()=>r(i),children:[n.jsx(Rr,{className:"font-medium text-white",children:i.name}),n.jsx(Rr,{children:n.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${i.status==="Active"?"bg-green-500/20 text-green-400":"bg-amber-500/20 text-amber-400"}`,children:i.status})}),n.jsx(Rr,{className:"text-gray-300",children:i.model}),n.jsx(Rr,{className:"text-gray-300",children:i.owner}),n.jsx(Rr,{className:"text-gray-300",children:i.lastActive}),n.jsx(Rr,{children:n.jsxs("button",{className:"text-beam-blue hover:text-beam-blue-light flex items-center gap-1",children:["Details",n.jsx(cb,{size:14})]})})]},i.id))})]})})})]});var xB="Tabs",[MNe,sft]=Jo(xB,[__]),wre=__(),[INe,yB]=MNe(xB),jre=U.forwardRef((e,t)=>{const{__scopeTabs:r,value:i,onValueChange:a,defaultValue:l,orientation:d="horizontal",dir:s,activationMode:p="automatic",...x}=e,w=sg(s),[j,S]=fo({prop:i,onChange:a,defaultProp:l});return n.jsx(INe,{scope:r,baseId:rc(),value:j,onValueChange:S,orientation:d,dir:w,activationMode:p,children:n.jsx(Hr.div,{dir:w,"data-orientation":d,...x,ref:t})})});jre.displayName=xB;var Nre="TabsList",Sre=U.forwardRef((e,t)=>{const{__scopeTabs:r,loop:i=!0,...a}=e,l=yB(Nre,r),d=wre(r);return n.jsx(oB,{asChild:!0,...d,orientation:l.orientation,dir:l.dir,loop:i,children:n.jsx(Hr.div,{role:"tablist","aria-orientation":l.orientation,...a,ref:t})})});Sre.displayName=Nre;var Cre="TabsTrigger",Are=U.forwardRef((e,t)=>{const{__scopeTabs:r,value:i,disabled:a=!1,...l}=e,d=yB(Cre,r),s=wre(r),p=Pre(d.baseId,i),x=Ere(d.baseId,i),w=i===d.value;return n.jsx(lB,{asChild:!0,...s,focusable:!a,active:w,children:n.jsx(Hr.button,{type:"button",role:"tab","aria-selected":w,"aria-controls":x,"data-state":w?"active":"inactive","data-disabled":a?"":void 0,disabled:a,id:p,...l,ref:t,onMouseDown:_r(e.onMouseDown,j=>{!a&&j.button===0&&j.ctrlKey===!1?d.onValueChange(i):j.preventDefault()}),onKeyDown:_r(e.onKeyDown,j=>{[" ","Enter"].includes(j.key)&&d.onValueChange(i)}),onFocus:_r(e.onFocus,()=>{const j=d.activationMode!=="manual";!w&&!a&&j&&d.onValueChange(i)})})})});Are.displayName=Cre;var Tre="TabsContent",kre=U.forwardRef((e,t)=>{const{__scopeTabs:r,value:i,forceMount:a,children:l,...d}=e,s=yB(Tre,r),p=Pre(s.baseId,i),x=Ere(s.baseId,i),w=i===s.value,j=U.useRef(w);return U.useEffect(()=>{const S=requestAnimationFrame(()=>j.current=!1);return()=>cancelAnimationFrame(S)},[]),n.jsx(io,{present:a||w,children:({present:S})=>n.jsx(Hr.div,{"data-state":w?"active":"inactive","data-orientation":s.orientation,role:"tabpanel","aria-labelledby":p,hidden:!S,id:x,tabIndex:0,...d,ref:t,style:{...e.style,animationDuration:j.current?"0s":void 0},children:S&&l})})});kre.displayName=Tre;function Pre(e,t){return`${e}-trigger-${t}`}function Ere(e,t){return`${e}-content-${t}`}var ONe=jre,Mre=Sre,Ire=Are,Ore=kre;const $i=ONe,Di=U.forwardRef(({className:e,...t},r)=>n.jsx(Mre,{ref:r,className:Yt("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...t}));Di.displayName=Mre.displayName;const Jt=U.forwardRef(({className:e,...t},r)=>n.jsx(Ire,{ref:r,className:Yt("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...t}));Jt.displayName=Ire.displayName;const ur=U.forwardRef(({className:e,...t},r)=>n.jsx(Ore,{ref:r,className:Yt("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...t}));ur.displayName=Ore.displayName;const jO=({title:e,children:t,defaultOpen:r=!1})=>{const[i,a]=ke.useState(r);return n.jsxs("div",{className:"glass-panel mb-4",children:[n.jsxs(lt,{variant:"ghost",className:"w-full flex justify-between items-center p-4",onClick:()=>a(!i),children:[n.jsx("span",{className:"font-medium",children:e}),n.jsx(Na,{size:18,className:`transform transition-transform ${i?"rotate-180":""}`})]}),i&&n.jsx("div",{className:"p-4 pt-0",children:t})]})};var RNe=Array.isArray,ac=RNe,DNe=typeof To=="object"&&To&&To.Object===Object&&To,Rre=DNe,zNe=Rre,LNe=typeof self=="object"&&self&&self.Object===Object&&self,FNe=zNe||LNe||Function("return this")(),kh=FNe,BNe=kh,$Ne=BNe.Symbol,tS=$Ne,SG=tS,Dre=Object.prototype,VNe=Dre.hasOwnProperty,UNe=Dre.toString,Zw=SG?SG.toStringTag:void 0;function GNe(e){var t=VNe.call(e,Zw),r=e[Zw];try{e[Zw]=void 0;var i=!0}catch{}var a=UNe.call(e);return i&&(t?e[Zw]=r:delete e[Zw]),a}var HNe=GNe,qNe=Object.prototype,WNe=qNe.toString;function KNe(e){return WNe.call(e)}var ZNe=KNe,CG=tS,YNe=HNe,XNe=ZNe,JNe="[object Null]",QNe="[object Undefined]",AG=CG?CG.toStringTag:void 0;function eSe(e){return e==null?e===void 0?QNe:JNe:AG&&AG in Object(e)?YNe(e):XNe(e)}var Fm=eSe;function tSe(e){return e!=null&&typeof e=="object"}var Bm=tSe,rSe=Fm,nSe=Bm,iSe="[object Symbol]";function sSe(e){return typeof e=="symbol"||nSe(e)&&rSe(e)==iSe}var w_=sSe,aSe=ac,oSe=w_,lSe=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,cSe=/^\w*$/;function uSe(e,t){if(aSe(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||oSe(e)?!0:cSe.test(e)||!lSe.test(e)||t!=null&&e in Object(t)}var vB=uSe;function dSe(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var ag=dSe;const j_=Vi(ag);var hSe=Fm,mSe=ag,fSe="[object AsyncFunction]",pSe="[object Function]",gSe="[object GeneratorFunction]",xSe="[object Proxy]";function ySe(e){if(!mSe(e))return!1;var t=hSe(e);return t==pSe||t==gSe||t==fSe||t==xSe}var bB=ySe;const Cn=Vi(bB);var vSe=kh,bSe=vSe["__core-js_shared__"],_Se=bSe,NO=_Se,TG=function(){var e=/[^.]+$/.exec(NO&&NO.keys&&NO.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function wSe(e){return!!TG&&TG in e}var jSe=wSe,NSe=Function.prototype,SSe=NSe.toString;function CSe(e){if(e!=null){try{return SSe.call(e)}catch{}try{return e+""}catch{}}return""}var zre=CSe,ASe=bB,TSe=jSe,kSe=ag,PSe=zre,ESe=/[\\^$.*+?()[\]{}|]/g,MSe=/^\[object .+?Constructor\]$/,ISe=Function.prototype,OSe=Object.prototype,RSe=ISe.toString,DSe=OSe.hasOwnProperty,zSe=RegExp("^"+RSe.call(DSe).replace(ESe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function LSe(e){if(!kSe(e)||TSe(e))return!1;var t=ASe(e)?zSe:MSe;return t.test(PSe(e))}var FSe=LSe;function BSe(e,t){return e==null?void 0:e[t]}var $Se=BSe,VSe=FSe,USe=$Se;function GSe(e,t){var r=USe(e,t);return VSe(r)?r:void 0}var Nx=GSe,HSe=Nx,qSe=HSe(Object,"create"),KE=qSe,kG=KE;function WSe(){this.__data__=kG?kG(null):{},this.size=0}var KSe=WSe;function ZSe(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var YSe=ZSe,XSe=KE,JSe="__lodash_hash_undefined__",QSe=Object.prototype,eCe=QSe.hasOwnProperty;function tCe(e){var t=this.__data__;if(XSe){var r=t[e];return r===JSe?void 0:r}return eCe.call(t,e)?t[e]:void 0}var rCe=tCe,nCe=KE,iCe=Object.prototype,sCe=iCe.hasOwnProperty;function aCe(e){var t=this.__data__;return nCe?t[e]!==void 0:sCe.call(t,e)}var oCe=aCe,lCe=KE,cCe="__lodash_hash_undefined__";function uCe(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=lCe&&t===void 0?cCe:t,this}var dCe=uCe,hCe=KSe,mCe=YSe,fCe=rCe,pCe=oCe,gCe=dCe;function N_(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}N_.prototype.clear=hCe;N_.prototype.delete=mCe;N_.prototype.get=fCe;N_.prototype.has=pCe;N_.prototype.set=gCe;var xCe=N_;function yCe(){this.__data__=[],this.size=0}var vCe=yCe;function bCe(e,t){return e===t||e!==e&&t!==t}var _B=bCe,_Ce=_B;function wCe(e,t){for(var r=e.length;r--;)if(_Ce(e[r][0],t))return r;return-1}var ZE=wCe,jCe=ZE,NCe=Array.prototype,SCe=NCe.splice;function CCe(e){var t=this.__data__,r=jCe(t,e);if(r<0)return!1;var i=t.length-1;return r==i?t.pop():SCe.call(t,r,1),--this.size,!0}var ACe=CCe,TCe=ZE;function kCe(e){var t=this.__data__,r=TCe(t,e);return r<0?void 0:t[r][1]}var PCe=kCe,ECe=ZE;function MCe(e){return ECe(this.__data__,e)>-1}var ICe=MCe,OCe=ZE;function RCe(e,t){var r=this.__data__,i=OCe(r,e);return i<0?(++this.size,r.push([e,t])):r[i][1]=t,this}var DCe=RCe,zCe=vCe,LCe=ACe,FCe=PCe,BCe=ICe,$Ce=DCe;function S_(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}S_.prototype.clear=zCe;S_.prototype.delete=LCe;S_.prototype.get=FCe;S_.prototype.has=BCe;S_.prototype.set=$Ce;var YE=S_,VCe=Nx,UCe=kh,GCe=VCe(UCe,"Map"),wB=GCe,PG=xCe,HCe=YE,qCe=wB;function WCe(){this.size=0,this.__data__={hash:new PG,map:new(qCe||HCe),string:new PG}}var KCe=WCe;function ZCe(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var YCe=ZCe,XCe=YCe;function JCe(e,t){var r=e.__data__;return XCe(t)?r[typeof t=="string"?"string":"hash"]:r.map}var XE=JCe,QCe=XE;function eAe(e){var t=QCe(this,e).delete(e);return this.size-=t?1:0,t}var tAe=eAe,rAe=XE;function nAe(e){return rAe(this,e).get(e)}var iAe=nAe,sAe=XE;function aAe(e){return sAe(this,e).has(e)}var oAe=aAe,lAe=XE;function cAe(e,t){var r=lAe(this,e),i=r.size;return r.set(e,t),this.size+=r.size==i?0:1,this}var uAe=cAe,dAe=KCe,hAe=tAe,mAe=iAe,fAe=oAe,pAe=uAe;function C_(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}C_.prototype.clear=dAe;C_.prototype.delete=hAe;C_.prototype.get=mAe;C_.prototype.has=fAe;C_.prototype.set=pAe;var jB=C_,Lre=jB,gAe="Expected a function";function NB(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(gAe);var r=function(){var i=arguments,a=t?t.apply(this,i):i[0],l=r.cache;if(l.has(a))return l.get(a);var d=e.apply(this,i);return r.cache=l.set(a,d)||l,d};return r.cache=new(NB.Cache||Lre),r}NB.Cache=Lre;var Fre=NB;const xAe=Vi(Fre);var yAe=Fre,vAe=500;function bAe(e){var t=yAe(e,function(i){return r.size===vAe&&r.clear(),i}),r=t.cache;return t}var _Ae=bAe,wAe=_Ae,jAe=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,NAe=/\\(\\)?/g,SAe=wAe(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(jAe,function(r,i,a,l){t.push(a?l.replace(NAe,"$1"):i||r)}),t}),CAe=SAe;function AAe(e,t){for(var r=-1,i=e==null?0:e.length,a=Array(i);++r<i;)a[r]=t(e[r],r,e);return a}var SB=AAe,EG=tS,TAe=SB,kAe=ac,PAe=w_,EAe=1/0,MG=EG?EG.prototype:void 0,IG=MG?MG.toString:void 0;function Bre(e){if(typeof e=="string")return e;if(kAe(e))return TAe(e,Bre)+"";if(PAe(e))return IG?IG.call(e):"";var t=e+"";return t=="0"&&1/e==-EAe?"-0":t}var MAe=Bre,IAe=MAe;function OAe(e){return e==null?"":IAe(e)}var $re=OAe,RAe=ac,DAe=vB,zAe=CAe,LAe=$re;function FAe(e,t){return RAe(e)?e:DAe(e,t)?[e]:zAe(LAe(e))}var Vre=FAe,BAe=w_,$Ae=1/0;function VAe(e){if(typeof e=="string"||BAe(e))return e;var t=e+"";return t=="0"&&1/e==-$Ae?"-0":t}var JE=VAe,UAe=Vre,GAe=JE;function HAe(e,t){t=UAe(t,e);for(var r=0,i=t.length;e!=null&&r<i;)e=e[GAe(t[r++])];return r&&r==i?e:void 0}var CB=HAe,qAe=CB;function WAe(e,t,r){var i=e==null?void 0:qAe(e,t);return i===void 0?r:i}var Ure=WAe;const Rc=Vi(Ure);function KAe(e){return e==null}var ZAe=KAe;const Tn=Vi(ZAe);var YAe=Fm,XAe=ac,JAe=Bm,QAe="[object String]";function eTe(e){return typeof e=="string"||!XAe(e)&&JAe(e)&&YAe(e)==QAe}var tTe=eTe;const rS=Vi(tTe);var Gre={exports:{}},cs={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var AB=Symbol.for("react.element"),TB=Symbol.for("react.portal"),QE=Symbol.for("react.fragment"),eM=Symbol.for("react.strict_mode"),tM=Symbol.for("react.profiler"),rM=Symbol.for("react.provider"),nM=Symbol.for("react.context"),rTe=Symbol.for("react.server_context"),iM=Symbol.for("react.forward_ref"),sM=Symbol.for("react.suspense"),aM=Symbol.for("react.suspense_list"),oM=Symbol.for("react.memo"),lM=Symbol.for("react.lazy"),nTe=Symbol.for("react.offscreen"),Hre;Hre=Symbol.for("react.module.reference");function Cu(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case AB:switch(e=e.type,e){case QE:case tM:case eM:case sM:case aM:return e;default:switch(e=e&&e.$$typeof,e){case rTe:case nM:case iM:case lM:case oM:case rM:return e;default:return t}}case TB:return t}}}cs.ContextConsumer=nM;cs.ContextProvider=rM;cs.Element=AB;cs.ForwardRef=iM;cs.Fragment=QE;cs.Lazy=lM;cs.Memo=oM;cs.Portal=TB;cs.Profiler=tM;cs.StrictMode=eM;cs.Suspense=sM;cs.SuspenseList=aM;cs.isAsyncMode=function(){return!1};cs.isConcurrentMode=function(){return!1};cs.isContextConsumer=function(e){return Cu(e)===nM};cs.isContextProvider=function(e){return Cu(e)===rM};cs.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===AB};cs.isForwardRef=function(e){return Cu(e)===iM};cs.isFragment=function(e){return Cu(e)===QE};cs.isLazy=function(e){return Cu(e)===lM};cs.isMemo=function(e){return Cu(e)===oM};cs.isPortal=function(e){return Cu(e)===TB};cs.isProfiler=function(e){return Cu(e)===tM};cs.isStrictMode=function(e){return Cu(e)===eM};cs.isSuspense=function(e){return Cu(e)===sM};cs.isSuspenseList=function(e){return Cu(e)===aM};cs.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===QE||e===tM||e===eM||e===sM||e===aM||e===nTe||typeof e=="object"&&e!==null&&(e.$$typeof===lM||e.$$typeof===oM||e.$$typeof===rM||e.$$typeof===nM||e.$$typeof===iM||e.$$typeof===Hre||e.getModuleId!==void 0)};cs.typeOf=Cu;Gre.exports=cs;var qre=Gre.exports,iTe=Fm,sTe=Bm,aTe="[object Number]";function oTe(e){return typeof e=="number"||sTe(e)&&iTe(e)==aTe}var Wre=oTe;const lTe=Vi(Wre);var cTe=Wre;function uTe(e){return cTe(e)&&e!=+e}var dTe=uTe;const A_=Vi(dTe);var bl=function(t){return t===0?0:t>0?1:-1},P0=function(t){return rS(t)&&t.indexOf("%")===t.length-1},kr=function(t){return lTe(t)&&!A_(t)},Qa=function(t){return kr(t)||rS(t)},hTe=0,og=function(t){var r=++hTe;return"".concat(t||"").concat(r)},_l=function(t,r){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!kr(t)&&!rS(t))return i;var l;if(P0(t)){var d=t.indexOf("%");l=r*parseFloat(t.slice(0,d))/100}else l=+t;return A_(l)&&(l=i),a&&l>r&&(l=r),l},lp=function(t){if(!t)return null;var r=Object.keys(t);return r&&r.length?t[r[0]]:null},mTe=function(t){if(!Array.isArray(t))return!1;for(var r=t.length,i={},a=0;a<r;a++)if(!i[t[a]])i[t[a]]=!0;else return!0;return!1},xs=function(t,r){return kr(t)&&kr(r)?function(i){return t+i*(r-t)}:function(){return r}};function bk(e,t,r){return!e||!e.length?null:e.find(function(i){return i&&(typeof t=="function"?t(i):Rc(i,t))===r})}var fTe=function(t){if(!t||!t.length)return null;for(var r=t.length,i=0,a=0,l=0,d=0,s=1/0,p=-1/0,x=0,w=0,j=0;j<r;j++)x=t[j].cx||0,w=t[j].cy||0,i+=x,a+=w,l+=x*w,d+=x*x,s=Math.min(s,x),p=Math.max(p,x);var S=r*d!==i*i?(r*l-i*a)/(r*d-i*i):0;return{xmin:s,xmax:p,a:S,b:(a-S*i)/r}};function Lv(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var i in t)if({}.hasOwnProperty.call(t,i)&&!{}.hasOwnProperty.call(e,i))return!1;return!0}function o5(e){"@babel/helpers - typeof";return o5=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o5(e)}var pTe=["viewBox","children"],gTe=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],OG=["points","pathLength"],SO={svg:pTe,polygon:OG,polyline:OG},kB=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],_k=function(t,r){if(!t||typeof t=="function"||typeof t=="boolean")return null;var i=t;if(U.isValidElement(t)&&(i=t.props),!j_(i))return null;var a={};return Object.keys(i).forEach(function(l){kB.includes(l)&&(a[l]=r||function(d){return i[l](i,d)})}),a},xTe=function(t,r,i){return function(a){return t(r,i,a),null}},Wp=function(t,r,i){if(!j_(t)||o5(t)!=="object")return null;var a=null;return Object.keys(t).forEach(function(l){var d=t[l];kB.includes(l)&&typeof d=="function"&&(a||(a={}),a[l]=xTe(d,r,i))}),a},yTe=["children"],vTe=["children"];function RG(e,t){if(e==null)return{};var r=bTe(e,t),i,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)i=l[a],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}function bTe(e,t){if(e==null)return{};var r={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;r[i]=e[i]}return r}function l5(e){"@babel/helpers - typeof";return l5=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l5(e)}var DG={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart"},wm=function(t){return typeof t=="string"?t:t?t.displayName||t.name||"Component":""},zG=null,CO=null,PB=function e(t){if(t===zG&&Array.isArray(CO))return CO;var r=[];return U.Children.forEach(t,function(i){Tn(i)||(qre.isFragment(i)?r=r.concat(e(i.props.children)):r.push(i))}),CO=r,zG=t,r};function Sl(e,t){var r=[],i=[];return Array.isArray(t)?i=t.map(function(a){return wm(a)}):i=[wm(t)],PB(e).forEach(function(a){var l=Rc(a,"type.displayName")||Rc(a,"type.name");i.indexOf(l)!==-1&&r.push(a)}),r}function jc(e,t){var r=Sl(e,t);return r&&r[0]}var LG=function(t){if(!t||!t.props)return!1;var r=t.props,i=r.width,a=r.height;return!(!kr(i)||i<=0||!kr(a)||a<=0)},_Te=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],wTe=function(t){return t&&t.type&&rS(t.type)&&_Te.indexOf(t.type)>=0},Kre=function(t){return t&&l5(t)==="object"&&"clipDot"in t},jTe=function(t,r,i,a){var l,d=(l=SO==null?void 0:SO[a])!==null&&l!==void 0?l:[];return!Cn(t)&&(a&&d.includes(r)||gTe.includes(r))||i&&kB.includes(r)},en=function(t,r,i){if(!t||typeof t=="function"||typeof t=="boolean")return null;var a=t;if(U.isValidElement(t)&&(a=t.props),!j_(a))return null;var l={};return Object.keys(a).forEach(function(d){var s;jTe((s=a)===null||s===void 0?void 0:s[d],d,r,i)&&(l[d]=a[d])}),l},c5=function e(t,r){if(t===r)return!0;var i=U.Children.count(t);if(i!==U.Children.count(r))return!1;if(i===0)return!0;if(i===1)return FG(Array.isArray(t)?t[0]:t,Array.isArray(r)?r[0]:r);for(var a=0;a<i;a++){var l=t[a],d=r[a];if(Array.isArray(l)||Array.isArray(d)){if(!e(l,d))return!1}else if(!FG(l,d))return!1}return!0},FG=function(t,r){if(Tn(t)&&Tn(r))return!0;if(!Tn(t)&&!Tn(r)){var i=t.props||{},a=i.children,l=RG(i,yTe),d=r.props||{},s=d.children,p=RG(d,vTe);return a&&s?Lv(l,p)&&c5(a,s):!a&&!s?Lv(l,p):!1}return!1},BG=function(t,r){var i=[],a={};return PB(t).forEach(function(l,d){if(wTe(l))i.push(l);else if(l){var s=wm(l.type),p=r[s]||{},x=p.handler,w=p.once;if(x&&(!w||!a[s])){var j=x(l,s,d);i.push(j),a[s]=!0}}}),i},NTe=function(t){var r=t&&t.type;return r&&DG[r]?DG[r]:null},STe=function(t,r){return PB(r).indexOf(t)},CTe=["children","width","height","viewBox","className","style","title","desc"];function u5(){return u5=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},u5.apply(this,arguments)}function ATe(e,t){if(e==null)return{};var r=TTe(e,t),i,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)i=l[a],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}function TTe(e,t){if(e==null)return{};var r={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;r[i]=e[i]}return r}function d5(e){var t=e.children,r=e.width,i=e.height,a=e.viewBox,l=e.className,d=e.style,s=e.title,p=e.desc,x=ATe(e,CTe),w=a||{width:r,height:i,x:0,y:0},j=zn("recharts-surface",l);return ke.createElement("svg",u5({},en(x,!0,"svg"),{className:j,width:r,height:i,style:d,viewBox:"".concat(w.x," ").concat(w.y," ").concat(w.width," ").concat(w.height)}),ke.createElement("title",null,s),ke.createElement("desc",null,p),t)}var kTe=["children","className"];function h5(){return h5=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},h5.apply(this,arguments)}function PTe(e,t){if(e==null)return{};var r=ETe(e,t),i,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)i=l[a],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}function ETe(e,t){if(e==null)return{};var r={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;r[i]=e[i]}return r}var Qn=ke.forwardRef(function(e,t){var r=e.children,i=e.className,a=PTe(e,kTe),l=zn("recharts-layer",i);return ke.createElement("g",h5({className:l},en(a,!0),{ref:t}),r)}),xd=function(t,r){for(var i=arguments.length,a=new Array(i>2?i-2:0),l=2;l<i;l++)a[l-2]=arguments[l]};function MTe(e,t,r){var i=-1,a=e.length;t<0&&(t=-t>a?0:a+t),r=r>a?a:r,r<0&&(r+=a),a=t>r?0:r-t>>>0,t>>>=0;for(var l=Array(a);++i<a;)l[i]=e[i+t];return l}var ITe=MTe,OTe=ITe;function RTe(e,t,r){var i=e.length;return r=r===void 0?i:r,!t&&r>=i?e:OTe(e,t,r)}var DTe=RTe,zTe="\\ud800-\\udfff",LTe="\\u0300-\\u036f",FTe="\\ufe20-\\ufe2f",BTe="\\u20d0-\\u20ff",$Te=LTe+FTe+BTe,VTe="\\ufe0e\\ufe0f",UTe="\\u200d",GTe=RegExp("["+UTe+zTe+$Te+VTe+"]");function HTe(e){return GTe.test(e)}var Zre=HTe;function qTe(e){return e.split("")}var WTe=qTe,Yre="\\ud800-\\udfff",KTe="\\u0300-\\u036f",ZTe="\\ufe20-\\ufe2f",YTe="\\u20d0-\\u20ff",XTe=KTe+ZTe+YTe,JTe="\\ufe0e\\ufe0f",QTe="["+Yre+"]",m5="["+XTe+"]",f5="\\ud83c[\\udffb-\\udfff]",eke="(?:"+m5+"|"+f5+")",Xre="[^"+Yre+"]",Jre="(?:\\ud83c[\\udde6-\\uddff]){2}",Qre="[\\ud800-\\udbff][\\udc00-\\udfff]",tke="\\u200d",ene=eke+"?",tne="["+JTe+"]?",rke="(?:"+tke+"(?:"+[Xre,Jre,Qre].join("|")+")"+tne+ene+")*",nke=tne+ene+rke,ike="(?:"+[Xre+m5+"?",m5,Jre,Qre,QTe].join("|")+")",ske=RegExp(f5+"(?="+f5+")|"+ike+nke,"g");function ake(e){return e.match(ske)||[]}var oke=ake,lke=WTe,cke=Zre,uke=oke;function dke(e){return cke(e)?uke(e):lke(e)}var hke=dke,mke=DTe,fke=Zre,pke=hke,gke=$re;function xke(e){return function(t){t=gke(t);var r=fke(t)?pke(t):void 0,i=r?r[0]:t.charAt(0),a=r?mke(r,1).join(""):t.slice(1);return i[e]()+a}}var yke=xke,vke=yke,bke=vke("toUpperCase"),_ke=bke;const cM=Vi(_ke);function As(e){return function(){return e}}const rne=Math.cos,wk=Math.sin,Td=Math.sqrt,jk=Math.PI,uM=2*jk,p5=Math.PI,g5=2*p5,v0=1e-6,wke=g5-v0;function nne(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function jke(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return nne;const r=10**t;return function(i){this._+=i[0];for(let a=1,l=i.length;a<l;++a)this._+=Math.round(arguments[a]*r)/r+i[a]}}class Nke{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?nne:jke(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,i,a){this._append`Q${+t},${+r},${this._x1=+i},${this._y1=+a}`}bezierCurveTo(t,r,i,a,l,d){this._append`C${+t},${+r},${+i},${+a},${this._x1=+l},${this._y1=+d}`}arcTo(t,r,i,a,l){if(t=+t,r=+r,i=+i,a=+a,l=+l,l<0)throw new Error(`negative radius: ${l}`);let d=this._x1,s=this._y1,p=i-t,x=a-r,w=d-t,j=s-r,S=w*w+j*j;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(S>v0)if(!(Math.abs(j*p-x*w)>v0)||!l)this._append`L${this._x1=t},${this._y1=r}`;else{let P=i-d,F=a-s,L=p*p+x*x,B=P*P+F*F,V=Math.sqrt(L),$=Math.sqrt(S),G=l*Math.tan((p5-Math.acos((L+S-B)/(2*V*$)))/2),W=G/$,Z=G/V;Math.abs(W-1)>v0&&this._append`L${t+W*w},${r+W*j}`,this._append`A${l},${l},0,0,${+(j*P>w*F)},${this._x1=t+Z*p},${this._y1=r+Z*x}`}}arc(t,r,i,a,l,d){if(t=+t,r=+r,i=+i,d=!!d,i<0)throw new Error(`negative radius: ${i}`);let s=i*Math.cos(a),p=i*Math.sin(a),x=t+s,w=r+p,j=1^d,S=d?a-l:l-a;this._x1===null?this._append`M${x},${w}`:(Math.abs(this._x1-x)>v0||Math.abs(this._y1-w)>v0)&&this._append`L${x},${w}`,i&&(S<0&&(S=S%g5+g5),S>wke?this._append`A${i},${i},0,1,${j},${t-s},${r-p}A${i},${i},0,1,${j},${this._x1=x},${this._y1=w}`:S>v0&&this._append`A${i},${i},0,${+(S>=p5)},${j},${this._x1=t+i*Math.cos(l)},${this._y1=r+i*Math.sin(l)}`)}rect(t,r,i,a){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${i=+i}v${+a}h${-i}Z`}toString(){return this._}}function EB(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const i=Math.floor(r);if(!(i>=0))throw new RangeError(`invalid digits: ${r}`);t=i}return e},()=>new Nke(t)}function MB(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function ine(e){this._context=e}ine.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function dM(e){return new ine(e)}function sne(e){return e[0]}function ane(e){return e[1]}function one(e,t){var r=As(!0),i=null,a=dM,l=null,d=EB(s);e=typeof e=="function"?e:e===void 0?sne:As(e),t=typeof t=="function"?t:t===void 0?ane:As(t);function s(p){var x,w=(p=MB(p)).length,j,S=!1,P;for(i==null&&(l=a(P=d())),x=0;x<=w;++x)!(x<w&&r(j=p[x],x,p))===S&&((S=!S)?l.lineStart():l.lineEnd()),S&&l.point(+e(j,x,p),+t(j,x,p));if(P)return l=null,P+""||null}return s.x=function(p){return arguments.length?(e=typeof p=="function"?p:As(+p),s):e},s.y=function(p){return arguments.length?(t=typeof p=="function"?p:As(+p),s):t},s.defined=function(p){return arguments.length?(r=typeof p=="function"?p:As(!!p),s):r},s.curve=function(p){return arguments.length?(a=p,i!=null&&(l=a(i)),s):a},s.context=function(p){return arguments.length?(p==null?i=l=null:l=a(i=p),s):i},s}function BA(e,t,r){var i=null,a=As(!0),l=null,d=dM,s=null,p=EB(x);e=typeof e=="function"?e:e===void 0?sne:As(+e),t=typeof t=="function"?t:As(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?ane:As(+r);function x(j){var S,P,F,L=(j=MB(j)).length,B,V=!1,$,G=new Array(L),W=new Array(L);for(l==null&&(s=d($=p())),S=0;S<=L;++S){if(!(S<L&&a(B=j[S],S,j))===V)if(V=!V)P=S,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),F=S-1;F>=P;--F)s.point(G[F],W[F]);s.lineEnd(),s.areaEnd()}V&&(G[S]=+e(B,S,j),W[S]=+t(B,S,j),s.point(i?+i(B,S,j):G[S],r?+r(B,S,j):W[S]))}if($)return s=null,$+""||null}function w(){return one().defined(a).curve(d).context(l)}return x.x=function(j){return arguments.length?(e=typeof j=="function"?j:As(+j),i=null,x):e},x.x0=function(j){return arguments.length?(e=typeof j=="function"?j:As(+j),x):e},x.x1=function(j){return arguments.length?(i=j==null?null:typeof j=="function"?j:As(+j),x):i},x.y=function(j){return arguments.length?(t=typeof j=="function"?j:As(+j),r=null,x):t},x.y0=function(j){return arguments.length?(t=typeof j=="function"?j:As(+j),x):t},x.y1=function(j){return arguments.length?(r=j==null?null:typeof j=="function"?j:As(+j),x):r},x.lineX0=x.lineY0=function(){return w().x(e).y(t)},x.lineY1=function(){return w().x(e).y(r)},x.lineX1=function(){return w().x(i).y(t)},x.defined=function(j){return arguments.length?(a=typeof j=="function"?j:As(!!j),x):a},x.curve=function(j){return arguments.length?(d=j,l!=null&&(s=d(l)),x):d},x.context=function(j){return arguments.length?(j==null?l=s=null:s=d(l=j),x):l},x}class lne{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function Ske(e){return new lne(e,!0)}function Cke(e){return new lne(e,!1)}const IB={draw(e,t){const r=Td(t/jk);e.moveTo(r,0),e.arc(0,0,r,0,uM)}},Ake={draw(e,t){const r=Td(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},cne=Td(1/3),Tke=cne*2,kke={draw(e,t){const r=Td(t/Tke),i=r*cne;e.moveTo(0,-r),e.lineTo(i,0),e.lineTo(0,r),e.lineTo(-i,0),e.closePath()}},Pke={draw(e,t){const r=Td(t),i=-r/2;e.rect(i,i,r,r)}},Eke=.8908130915292852,une=wk(jk/10)/wk(7*jk/10),Mke=wk(uM/10)*une,Ike=-rne(uM/10)*une,Oke={draw(e,t){const r=Td(t*Eke),i=Mke*r,a=Ike*r;e.moveTo(0,-r),e.lineTo(i,a);for(let l=1;l<5;++l){const d=uM*l/5,s=rne(d),p=wk(d);e.lineTo(p*r,-s*r),e.lineTo(s*i-p*a,p*i+s*a)}e.closePath()}},AO=Td(3),Rke={draw(e,t){const r=-Td(t/(AO*3));e.moveTo(0,r*2),e.lineTo(-AO*r,-r),e.lineTo(AO*r,-r),e.closePath()}},su=-.5,au=Td(3)/2,x5=1/Td(12),Dke=(x5/2+1)*3,zke={draw(e,t){const r=Td(t/Dke),i=r/2,a=r*x5,l=i,d=r*x5+r,s=-l,p=d;e.moveTo(i,a),e.lineTo(l,d),e.lineTo(s,p),e.lineTo(su*i-au*a,au*i+su*a),e.lineTo(su*l-au*d,au*l+su*d),e.lineTo(su*s-au*p,au*s+su*p),e.lineTo(su*i+au*a,su*a-au*i),e.lineTo(su*l+au*d,su*d-au*l),e.lineTo(su*s+au*p,su*p-au*s),e.closePath()}};function Lke(e,t){let r=null,i=EB(a);e=typeof e=="function"?e:As(e||IB),t=typeof t=="function"?t:As(t===void 0?64:+t);function a(){let l;if(r||(r=l=i()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),l)return r=null,l+""||null}return a.type=function(l){return arguments.length?(e=typeof l=="function"?l:As(l),a):e},a.size=function(l){return arguments.length?(t=typeof l=="function"?l:As(+l),a):t},a.context=function(l){return arguments.length?(r=l??null,a):r},a}function Nk(){}function Sk(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function dne(e){this._context=e}dne.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Sk(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Sk(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Fke(e){return new dne(e)}function hne(e){this._context=e}hne.prototype={areaStart:Nk,areaEnd:Nk,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:Sk(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Bke(e){return new hne(e)}function mne(e){this._context=e}mne.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,i=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,i):this._context.moveTo(r,i);break;case 3:this._point=4;default:Sk(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function $ke(e){return new mne(e)}function fne(e){this._context=e}fne.prototype={areaStart:Nk,areaEnd:Nk,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function Vke(e){return new fne(e)}function $G(e){return e<0?-1:1}function VG(e,t,r){var i=e._x1-e._x0,a=t-e._x1,l=(e._y1-e._y0)/(i||a<0&&-0),d=(r-e._y1)/(a||i<0&&-0),s=(l*a+d*i)/(i+a);return($G(l)+$G(d))*Math.min(Math.abs(l),Math.abs(d),.5*Math.abs(s))||0}function UG(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function TO(e,t,r){var i=e._x0,a=e._y0,l=e._x1,d=e._y1,s=(l-i)/3;e._context.bezierCurveTo(i+s,a+s*t,l-s,d-s*r,l,d)}function Ck(e){this._context=e}Ck.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:TO(this,this._t0,UG(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,TO(this,UG(this,r=VG(this,e,t)),r);break;default:TO(this,this._t0,r=VG(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function pne(e){this._context=new gne(e)}(pne.prototype=Object.create(Ck.prototype)).point=function(e,t){Ck.prototype.point.call(this,t,e)};function gne(e){this._context=e}gne.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,i,a,l){this._context.bezierCurveTo(t,e,i,r,l,a)}};function Uke(e){return new Ck(e)}function Gke(e){return new pne(e)}function xne(e){this._context=e}xne.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var i=GG(e),a=GG(t),l=0,d=1;d<r;++l,++d)this._context.bezierCurveTo(i[0][l],a[0][l],i[1][l],a[1][l],e[d],t[d]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function GG(e){var t,r=e.length-1,i,a=new Array(r),l=new Array(r),d=new Array(r);for(a[0]=0,l[0]=2,d[0]=e[0]+2*e[1],t=1;t<r-1;++t)a[t]=1,l[t]=4,d[t]=4*e[t]+2*e[t+1];for(a[r-1]=2,l[r-1]=7,d[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)i=a[t]/l[t-1],l[t]-=i,d[t]-=i*d[t-1];for(a[r-1]=d[r-1]/l[r-1],t=r-2;t>=0;--t)a[t]=(d[t]-a[t+1])/l[t];for(l[r-1]=(e[r]+a[r-1])/2,t=0;t<r-1;++t)l[t]=2*e[t+1]-a[t+1];return[a,l]}function Hke(e){return new xne(e)}function hM(e,t){this._context=e,this._t=t}hM.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function qke(e){return new hM(e,.5)}function Wke(e){return new hM(e,0)}function Kke(e){return new hM(e,1)}function pb(e,t){if((d=e.length)>1)for(var r=1,i,a,l=e[t[0]],d,s=l.length;r<d;++r)for(a=l,l=e[t[r]],i=0;i<s;++i)l[i][1]+=l[i][0]=isNaN(a[i][1])?a[i][0]:a[i][1]}function y5(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function Zke(e,t){return e[t]}function Yke(e){const t=[];return t.key=e,t}function Xke(){var e=As([]),t=y5,r=pb,i=Zke;function a(l){var d=Array.from(e.apply(this,arguments),Yke),s,p=d.length,x=-1,w;for(const j of l)for(s=0,++x;s<p;++s)(d[s][x]=[0,+i(j,d[s].key,x,l)]).data=j;for(s=0,w=MB(t(d));s<p;++s)d[w[s]].index=s;return r(d,w),d}return a.keys=function(l){return arguments.length?(e=typeof l=="function"?l:As(Array.from(l)),a):e},a.value=function(l){return arguments.length?(i=typeof l=="function"?l:As(+l),a):i},a.order=function(l){return arguments.length?(t=l==null?y5:typeof l=="function"?l:As(Array.from(l)),a):t},a.offset=function(l){return arguments.length?(r=l??pb,a):r},a}function Jke(e,t){if((i=e.length)>0){for(var r,i,a=0,l=e[0].length,d;a<l;++a){for(d=r=0;r<i;++r)d+=e[r][a][1]||0;if(d)for(r=0;r<i;++r)e[r][a][1]/=d}pb(e,t)}}function Qke(e,t){if((a=e.length)>0){for(var r=0,i=e[t[0]],a,l=i.length;r<l;++r){for(var d=0,s=0;d<a;++d)s+=e[d][r][1]||0;i[r][1]+=i[r][0]=-s/2}pb(e,t)}}function ePe(e,t){if(!(!((d=e.length)>0)||!((l=(a=e[t[0]]).length)>0))){for(var r=0,i=1,a,l,d;i<l;++i){for(var s=0,p=0,x=0;s<d;++s){for(var w=e[t[s]],j=w[i][1]||0,S=w[i-1][1]||0,P=(j-S)/2,F=0;F<s;++F){var L=e[t[F]],B=L[i][1]||0,V=L[i-1][1]||0;P+=B-V}p+=j,x+=P*j}a[i-1][1]+=a[i-1][0]=r,p&&(r-=x/p)}a[i-1][1]+=a[i-1][0]=r,pb(e,t)}}function S2(e){"@babel/helpers - typeof";return S2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},S2(e)}var tPe=["type","size","sizeType"];function v5(){return v5=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},v5.apply(this,arguments)}function HG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,i)}return r}function qG(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?HG(Object(r),!0).forEach(function(i){rPe(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):HG(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function rPe(e,t,r){return t=nPe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nPe(e){var t=iPe(e,"string");return S2(t)=="symbol"?t:t+""}function iPe(e,t){if(S2(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(S2(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function sPe(e,t){if(e==null)return{};var r=aPe(e,t),i,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)i=l[a],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}function aPe(e,t){if(e==null)return{};var r={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;r[i]=e[i]}return r}var yne={symbolCircle:IB,symbolCross:Ake,symbolDiamond:kke,symbolSquare:Pke,symbolStar:Oke,symbolTriangle:Rke,symbolWye:zke},oPe=Math.PI/180,lPe=function(t){var r="symbol".concat(cM(t));return yne[r]||IB},cPe=function(t,r,i){if(r==="area")return t;switch(i){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var a=18*oPe;return 1.25*t*t*(Math.tan(a)-Math.tan(a*2)*Math.pow(Math.tan(a),2))}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},uPe=function(t,r){yne["symbol".concat(cM(t))]=r},mM=function(t){var r=t.type,i=r===void 0?"circle":r,a=t.size,l=a===void 0?64:a,d=t.sizeType,s=d===void 0?"area":d,p=sPe(t,tPe),x=qG(qG({},p),{},{type:i,size:l,sizeType:s}),w=function(){var B=lPe(i),V=Lke().type(B).size(cPe(l,s,i));return V()},j=x.className,S=x.cx,P=x.cy,F=en(x,!0);return S===+S&&P===+P&&l===+l?ke.createElement("path",v5({},F,{className:zn("recharts-symbols",j),transform:"translate(".concat(S,", ").concat(P,")"),d:w()})):null};mM.registerSymbol=uPe;function gb(e){"@babel/helpers - typeof";return gb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gb(e)}function b5(){return b5=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},b5.apply(this,arguments)}function WG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,i)}return r}function dPe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?WG(Object(r),!0).forEach(function(i){C2(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):WG(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function hPe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mPe(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,bne(i.key),i)}}function fPe(e,t,r){return t&&mPe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function pPe(e,t,r){return t=Ak(t),gPe(e,vne()?Reflect.construct(t,r||[],Ak(e).constructor):t.apply(e,r))}function gPe(e,t){if(t&&(gb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return xPe(e)}function xPe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vne(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(vne=function(){return!!e})()}function Ak(e){return Ak=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ak(e)}function yPe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_5(e,t)}function _5(e,t){return _5=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,a){return i.__proto__=a,i},_5(e,t)}function C2(e,t,r){return t=bne(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function bne(e){var t=vPe(e,"string");return gb(t)=="symbol"?t:t+""}function vPe(e,t){if(gb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(gb(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ou=32,OB=function(e){function t(){return hPe(this,t),pPe(this,t,arguments)}return yPe(t,e),fPe(t,[{key:"renderIcon",value:function(i){var a=this.props.inactiveColor,l=ou/2,d=ou/6,s=ou/3,p=i.inactive?a:i.color;if(i.type==="plainline")return ke.createElement("line",{strokeWidth:4,fill:"none",stroke:p,strokeDasharray:i.payload.strokeDasharray,x1:0,y1:l,x2:ou,y2:l,className:"recharts-legend-icon"});if(i.type==="line")return ke.createElement("path",{strokeWidth:4,fill:"none",stroke:p,d:"M0,".concat(l,"h").concat(s,`
            A`).concat(d,",").concat(d,",0,1,1,").concat(2*s,",").concat(l,`
            H`).concat(ou,"M").concat(2*s,",").concat(l,`
            A`).concat(d,",").concat(d,",0,1,1,").concat(s,",").concat(l),className:"recharts-legend-icon"});if(i.type==="rect")return ke.createElement("path",{stroke:"none",fill:p,d:"M0,".concat(ou/8,"h").concat(ou,"v").concat(ou*3/4,"h").concat(-ou,"z"),className:"recharts-legend-icon"});if(ke.isValidElement(i.legendIcon)){var x=dPe({},i);return delete x.legendIcon,ke.cloneElement(i.legendIcon,x)}return ke.createElement(mM,{fill:p,cx:l,cy:l,size:ou,sizeType:"diameter",type:i.type})}},{key:"renderItems",value:function(){var i=this,a=this.props,l=a.payload,d=a.iconSize,s=a.layout,p=a.formatter,x=a.inactiveColor,w={x:0,y:0,width:ou,height:ou},j={display:s==="horizontal"?"inline-block":"block",marginRight:10},S={display:"inline-block",verticalAlign:"middle",marginRight:4};return l.map(function(P,F){var L=P.formatter||p,B=zn(C2(C2({"recharts-legend-item":!0},"legend-item-".concat(F),!0),"inactive",P.inactive));if(P.type==="none")return null;var V=Cn(P.value)?null:P.value;xd(!Cn(P.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var $=P.inactive?x:P.color;return ke.createElement("li",b5({className:B,style:j,key:"legend-item-".concat(F)},Wp(i.props,P,F)),ke.createElement(d5,{width:d,height:d,viewBox:w,style:S},i.renderIcon(P)),ke.createElement("span",{className:"recharts-legend-item-text",style:{color:$}},L?L(V,P,F):V))})}},{key:"render",value:function(){var i=this.props,a=i.payload,l=i.layout,d=i.align;if(!a||!a.length)return null;var s={padding:0,margin:0,textAlign:l==="horizontal"?d:"left"};return ke.createElement("ul",{className:"recharts-default-legend",style:s},this.renderItems())}}])}(U.PureComponent);C2(OB,"displayName","Legend");C2(OB,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var bPe=YE;function _Pe(){this.__data__=new bPe,this.size=0}var wPe=_Pe;function jPe(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var NPe=jPe;function SPe(e){return this.__data__.get(e)}var CPe=SPe;function APe(e){return this.__data__.has(e)}var TPe=APe,kPe=YE,PPe=wB,EPe=jB,MPe=200;function IPe(e,t){var r=this.__data__;if(r instanceof kPe){var i=r.__data__;if(!PPe||i.length<MPe-1)return i.push([e,t]),this.size=++r.size,this;r=this.__data__=new EPe(i)}return r.set(e,t),this.size=r.size,this}var OPe=IPe,RPe=YE,DPe=wPe,zPe=NPe,LPe=CPe,FPe=TPe,BPe=OPe;function T_(e){var t=this.__data__=new RPe(e);this.size=t.size}T_.prototype.clear=DPe;T_.prototype.delete=zPe;T_.prototype.get=LPe;T_.prototype.has=FPe;T_.prototype.set=BPe;var _ne=T_,$Pe="__lodash_hash_undefined__";function VPe(e){return this.__data__.set(e,$Pe),this}var UPe=VPe;function GPe(e){return this.__data__.has(e)}var HPe=GPe,qPe=jB,WPe=UPe,KPe=HPe;function Tk(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new qPe;++t<r;)this.add(e[t])}Tk.prototype.add=Tk.prototype.push=WPe;Tk.prototype.has=KPe;var wne=Tk;function ZPe(e,t){for(var r=-1,i=e==null?0:e.length;++r<i;)if(t(e[r],r,e))return!0;return!1}var jne=ZPe;function YPe(e,t){return e.has(t)}var Nne=YPe,XPe=wne,JPe=jne,QPe=Nne,eEe=1,tEe=2;function rEe(e,t,r,i,a,l){var d=r&eEe,s=e.length,p=t.length;if(s!=p&&!(d&&p>s))return!1;var x=l.get(e),w=l.get(t);if(x&&w)return x==t&&w==e;var j=-1,S=!0,P=r&tEe?new XPe:void 0;for(l.set(e,t),l.set(t,e);++j<s;){var F=e[j],L=t[j];if(i)var B=d?i(L,F,j,t,e,l):i(F,L,j,e,t,l);if(B!==void 0){if(B)continue;S=!1;break}if(P){if(!JPe(t,function(V,$){if(!QPe(P,$)&&(F===V||a(F,V,r,i,l)))return P.push($)})){S=!1;break}}else if(!(F===L||a(F,L,r,i,l))){S=!1;break}}return l.delete(e),l.delete(t),S}var Sne=rEe,nEe=kh,iEe=nEe.Uint8Array,sEe=iEe;function aEe(e){var t=-1,r=Array(e.size);return e.forEach(function(i,a){r[++t]=[a,i]}),r}var oEe=aEe;function lEe(e){var t=-1,r=Array(e.size);return e.forEach(function(i){r[++t]=i}),r}var RB=lEe,KG=tS,ZG=sEe,cEe=_B,uEe=Sne,dEe=oEe,hEe=RB,mEe=1,fEe=2,pEe="[object Boolean]",gEe="[object Date]",xEe="[object Error]",yEe="[object Map]",vEe="[object Number]",bEe="[object RegExp]",_Ee="[object Set]",wEe="[object String]",jEe="[object Symbol]",NEe="[object ArrayBuffer]",SEe="[object DataView]",YG=KG?KG.prototype:void 0,kO=YG?YG.valueOf:void 0;function CEe(e,t,r,i,a,l,d){switch(r){case SEe:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case NEe:return!(e.byteLength!=t.byteLength||!l(new ZG(e),new ZG(t)));case pEe:case gEe:case vEe:return cEe(+e,+t);case xEe:return e.name==t.name&&e.message==t.message;case bEe:case wEe:return e==t+"";case yEe:var s=dEe;case _Ee:var p=i&mEe;if(s||(s=hEe),e.size!=t.size&&!p)return!1;var x=d.get(e);if(x)return x==t;i|=fEe,d.set(e,t);var w=uEe(s(e),s(t),i,a,l,d);return d.delete(e),w;case jEe:if(kO)return kO.call(e)==kO.call(t)}return!1}var AEe=CEe;function TEe(e,t){for(var r=-1,i=t.length,a=e.length;++r<i;)e[a+r]=t[r];return e}var Cne=TEe,kEe=Cne,PEe=ac;function EEe(e,t,r){var i=t(e);return PEe(e)?i:kEe(i,r(e))}var MEe=EEe;function IEe(e,t){for(var r=-1,i=e==null?0:e.length,a=0,l=[];++r<i;){var d=e[r];t(d,r,e)&&(l[a++]=d)}return l}var OEe=IEe;function REe(){return[]}var DEe=REe,zEe=OEe,LEe=DEe,FEe=Object.prototype,BEe=FEe.propertyIsEnumerable,XG=Object.getOwnPropertySymbols,$Ee=XG?function(e){return e==null?[]:(e=Object(e),zEe(XG(e),function(t){return BEe.call(e,t)}))}:LEe,VEe=$Ee;function UEe(e,t){for(var r=-1,i=Array(e);++r<e;)i[r]=t(r);return i}var GEe=UEe,HEe=Fm,qEe=Bm,WEe="[object Arguments]";function KEe(e){return qEe(e)&&HEe(e)==WEe}var ZEe=KEe,JG=ZEe,YEe=Bm,Ane=Object.prototype,XEe=Ane.hasOwnProperty,JEe=Ane.propertyIsEnumerable,QEe=JG(function(){return arguments}())?JG:function(e){return YEe(e)&&XEe.call(e,"callee")&&!JEe.call(e,"callee")},DB=QEe,kk={exports:{}};function eMe(){return!1}var tMe=eMe;kk.exports;(function(e,t){var r=kh,i=tMe,a=t&&!t.nodeType&&t,l=a&&!0&&e&&!e.nodeType&&e,d=l&&l.exports===a,s=d?r.Buffer:void 0,p=s?s.isBuffer:void 0,x=p||i;e.exports=x})(kk,kk.exports);var Tne=kk.exports,rMe=9007199254740991,nMe=/^(?:0|[1-9]\d*)$/;function iMe(e,t){var r=typeof e;return t=t??rMe,!!t&&(r=="number"||r!="symbol"&&nMe.test(e))&&e>-1&&e%1==0&&e<t}var zB=iMe,sMe=9007199254740991;function aMe(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=sMe}var LB=aMe,oMe=Fm,lMe=LB,cMe=Bm,uMe="[object Arguments]",dMe="[object Array]",hMe="[object Boolean]",mMe="[object Date]",fMe="[object Error]",pMe="[object Function]",gMe="[object Map]",xMe="[object Number]",yMe="[object Object]",vMe="[object RegExp]",bMe="[object Set]",_Me="[object String]",wMe="[object WeakMap]",jMe="[object ArrayBuffer]",NMe="[object DataView]",SMe="[object Float32Array]",CMe="[object Float64Array]",AMe="[object Int8Array]",TMe="[object Int16Array]",kMe="[object Int32Array]",PMe="[object Uint8Array]",EMe="[object Uint8ClampedArray]",MMe="[object Uint16Array]",IMe="[object Uint32Array]",Ds={};Ds[SMe]=Ds[CMe]=Ds[AMe]=Ds[TMe]=Ds[kMe]=Ds[PMe]=Ds[EMe]=Ds[MMe]=Ds[IMe]=!0;Ds[uMe]=Ds[dMe]=Ds[jMe]=Ds[hMe]=Ds[NMe]=Ds[mMe]=Ds[fMe]=Ds[pMe]=Ds[gMe]=Ds[xMe]=Ds[yMe]=Ds[vMe]=Ds[bMe]=Ds[_Me]=Ds[wMe]=!1;function OMe(e){return cMe(e)&&lMe(e.length)&&!!Ds[oMe(e)]}var RMe=OMe;function DMe(e){return function(t){return e(t)}}var kne=DMe,Pk={exports:{}};Pk.exports;(function(e,t){var r=Rre,i=t&&!t.nodeType&&t,a=i&&!0&&e&&!e.nodeType&&e,l=a&&a.exports===i,d=l&&r.process,s=function(){try{var p=a&&a.require&&a.require("util").types;return p||d&&d.binding&&d.binding("util")}catch{}}();e.exports=s})(Pk,Pk.exports);var zMe=Pk.exports,LMe=RMe,FMe=kne,QG=zMe,eH=QG&&QG.isTypedArray,BMe=eH?FMe(eH):LMe,Pne=BMe,$Me=GEe,VMe=DB,UMe=ac,GMe=Tne,HMe=zB,qMe=Pne,WMe=Object.prototype,KMe=WMe.hasOwnProperty;function ZMe(e,t){var r=UMe(e),i=!r&&VMe(e),a=!r&&!i&&GMe(e),l=!r&&!i&&!a&&qMe(e),d=r||i||a||l,s=d?$Me(e.length,String):[],p=s.length;for(var x in e)(t||KMe.call(e,x))&&!(d&&(x=="length"||a&&(x=="offset"||x=="parent")||l&&(x=="buffer"||x=="byteLength"||x=="byteOffset")||HMe(x,p)))&&s.push(x);return s}var YMe=ZMe,XMe=Object.prototype;function JMe(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||XMe;return e===r}var QMe=JMe;function e3e(e,t){return function(r){return e(t(r))}}var Ene=e3e,t3e=Ene,r3e=t3e(Object.keys,Object),n3e=r3e,i3e=QMe,s3e=n3e,a3e=Object.prototype,o3e=a3e.hasOwnProperty;function l3e(e){if(!i3e(e))return s3e(e);var t=[];for(var r in Object(e))o3e.call(e,r)&&r!="constructor"&&t.push(r);return t}var c3e=l3e,u3e=bB,d3e=LB;function h3e(e){return e!=null&&d3e(e.length)&&!u3e(e)}var nS=h3e,m3e=YMe,f3e=c3e,p3e=nS;function g3e(e){return p3e(e)?m3e(e):f3e(e)}var fM=g3e,x3e=MEe,y3e=VEe,v3e=fM;function b3e(e){return x3e(e,v3e,y3e)}var _3e=b3e,tH=_3e,w3e=1,j3e=Object.prototype,N3e=j3e.hasOwnProperty;function S3e(e,t,r,i,a,l){var d=r&w3e,s=tH(e),p=s.length,x=tH(t),w=x.length;if(p!=w&&!d)return!1;for(var j=p;j--;){var S=s[j];if(!(d?S in t:N3e.call(t,S)))return!1}var P=l.get(e),F=l.get(t);if(P&&F)return P==t&&F==e;var L=!0;l.set(e,t),l.set(t,e);for(var B=d;++j<p;){S=s[j];var V=e[S],$=t[S];if(i)var G=d?i($,V,S,t,e,l):i(V,$,S,e,t,l);if(!(G===void 0?V===$||a(V,$,r,i,l):G)){L=!1;break}B||(B=S=="constructor")}if(L&&!B){var W=e.constructor,Z=t.constructor;W!=Z&&"constructor"in e&&"constructor"in t&&!(typeof W=="function"&&W instanceof W&&typeof Z=="function"&&Z instanceof Z)&&(L=!1)}return l.delete(e),l.delete(t),L}var C3e=S3e,A3e=Nx,T3e=kh,k3e=A3e(T3e,"DataView"),P3e=k3e,E3e=Nx,M3e=kh,I3e=E3e(M3e,"Promise"),O3e=I3e,R3e=Nx,D3e=kh,z3e=R3e(D3e,"Set"),Mne=z3e,L3e=Nx,F3e=kh,B3e=L3e(F3e,"WeakMap"),$3e=B3e,w5=P3e,j5=wB,N5=O3e,S5=Mne,C5=$3e,Ine=Fm,k_=zre,rH="[object Map]",V3e="[object Object]",nH="[object Promise]",iH="[object Set]",sH="[object WeakMap]",aH="[object DataView]",U3e=k_(w5),G3e=k_(j5),H3e=k_(N5),q3e=k_(S5),W3e=k_(C5),b0=Ine;(w5&&b0(new w5(new ArrayBuffer(1)))!=aH||j5&&b0(new j5)!=rH||N5&&b0(N5.resolve())!=nH||S5&&b0(new S5)!=iH||C5&&b0(new C5)!=sH)&&(b0=function(e){var t=Ine(e),r=t==V3e?e.constructor:void 0,i=r?k_(r):"";if(i)switch(i){case U3e:return aH;case G3e:return rH;case H3e:return nH;case q3e:return iH;case W3e:return sH}return t});var K3e=b0,PO=_ne,Z3e=Sne,Y3e=AEe,X3e=C3e,oH=K3e,lH=ac,cH=Tne,J3e=Pne,Q3e=1,uH="[object Arguments]",dH="[object Array]",$A="[object Object]",e4e=Object.prototype,hH=e4e.hasOwnProperty;function t4e(e,t,r,i,a,l){var d=lH(e),s=lH(t),p=d?dH:oH(e),x=s?dH:oH(t);p=p==uH?$A:p,x=x==uH?$A:x;var w=p==$A,j=x==$A,S=p==x;if(S&&cH(e)){if(!cH(t))return!1;d=!0,w=!1}if(S&&!w)return l||(l=new PO),d||J3e(e)?Z3e(e,t,r,i,a,l):Y3e(e,t,p,r,i,a,l);if(!(r&Q3e)){var P=w&&hH.call(e,"__wrapped__"),F=j&&hH.call(t,"__wrapped__");if(P||F){var L=P?e.value():e,B=F?t.value():t;return l||(l=new PO),a(L,B,r,i,l)}}return S?(l||(l=new PO),X3e(e,t,r,i,a,l)):!1}var r4e=t4e,n4e=r4e,mH=Bm;function One(e,t,r,i,a){return e===t?!0:e==null||t==null||!mH(e)&&!mH(t)?e!==e&&t!==t:n4e(e,t,r,i,One,a)}var FB=One,i4e=_ne,s4e=FB,a4e=1,o4e=2;function l4e(e,t,r,i){var a=r.length,l=a,d=!i;if(e==null)return!l;for(e=Object(e);a--;){var s=r[a];if(d&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++a<l;){s=r[a];var p=s[0],x=e[p],w=s[1];if(d&&s[2]){if(x===void 0&&!(p in e))return!1}else{var j=new i4e;if(i)var S=i(x,w,p,e,t,j);if(!(S===void 0?s4e(w,x,a4e|o4e,i,j):S))return!1}}return!0}var c4e=l4e,u4e=ag;function d4e(e){return e===e&&!u4e(e)}var Rne=d4e,h4e=Rne,m4e=fM;function f4e(e){for(var t=m4e(e),r=t.length;r--;){var i=t[r],a=e[i];t[r]=[i,a,h4e(a)]}return t}var p4e=f4e;function g4e(e,t){return function(r){return r==null?!1:r[e]===t&&(t!==void 0||e in Object(r))}}var Dne=g4e,x4e=c4e,y4e=p4e,v4e=Dne;function b4e(e){var t=y4e(e);return t.length==1&&t[0][2]?v4e(t[0][0],t[0][1]):function(r){return r===e||x4e(r,e,t)}}var _4e=b4e;function w4e(e,t){return e!=null&&t in Object(e)}var j4e=w4e,N4e=Vre,S4e=DB,C4e=ac,A4e=zB,T4e=LB,k4e=JE;function P4e(e,t,r){t=N4e(t,e);for(var i=-1,a=t.length,l=!1;++i<a;){var d=k4e(t[i]);if(!(l=e!=null&&r(e,d)))break;e=e[d]}return l||++i!=a?l:(a=e==null?0:e.length,!!a&&T4e(a)&&A4e(d,a)&&(C4e(e)||S4e(e)))}var E4e=P4e,M4e=j4e,I4e=E4e;function O4e(e,t){return e!=null&&I4e(e,t,M4e)}var R4e=O4e,D4e=FB,z4e=Ure,L4e=R4e,F4e=vB,B4e=Rne,$4e=Dne,V4e=JE,U4e=1,G4e=2;function H4e(e,t){return F4e(e)&&B4e(t)?$4e(V4e(e),t):function(r){var i=z4e(r,e);return i===void 0&&i===t?L4e(r,e):D4e(t,i,U4e|G4e)}}var q4e=H4e;function W4e(e){return e}var P_=W4e;function K4e(e){return function(t){return t==null?void 0:t[e]}}var Z4e=K4e,Y4e=CB;function X4e(e){return function(t){return Y4e(t,e)}}var J4e=X4e,Q4e=Z4e,eIe=J4e,tIe=vB,rIe=JE;function nIe(e){return tIe(e)?Q4e(rIe(e)):eIe(e)}var iIe=nIe,sIe=_4e,aIe=q4e,oIe=P_,lIe=ac,cIe=iIe;function uIe(e){return typeof e=="function"?e:e==null?oIe:typeof e=="object"?lIe(e)?aIe(e[0],e[1]):sIe(e):cIe(e)}var Ph=uIe;function dIe(e,t,r,i){for(var a=e.length,l=r+(i?1:-1);i?l--:++l<a;)if(t(e[l],l,e))return l;return-1}var zne=dIe;function hIe(e){return e!==e}var mIe=hIe;function fIe(e,t,r){for(var i=r-1,a=e.length;++i<a;)if(e[i]===t)return i;return-1}var pIe=fIe,gIe=zne,xIe=mIe,yIe=pIe;function vIe(e,t,r){return t===t?yIe(e,t,r):gIe(e,xIe,r)}var bIe=vIe,_Ie=bIe;function wIe(e,t){var r=e==null?0:e.length;return!!r&&_Ie(e,t,0)>-1}var jIe=wIe;function NIe(e,t,r){for(var i=-1,a=e==null?0:e.length;++i<a;)if(r(t,e[i]))return!0;return!1}var SIe=NIe;function CIe(){}var AIe=CIe,EO=Mne,TIe=AIe,kIe=RB,PIe=1/0,EIe=EO&&1/kIe(new EO([,-0]))[1]==PIe?function(e){return new EO(e)}:TIe,MIe=EIe,IIe=wne,OIe=jIe,RIe=SIe,DIe=Nne,zIe=MIe,LIe=RB,FIe=200;function BIe(e,t,r){var i=-1,a=OIe,l=e.length,d=!0,s=[],p=s;if(r)d=!1,a=RIe;else if(l>=FIe){var x=t?null:zIe(e);if(x)return LIe(x);d=!1,a=DIe,p=new IIe}else p=t?[]:s;e:for(;++i<l;){var w=e[i],j=t?t(w):w;if(w=r||w!==0?w:0,d&&j===j){for(var S=p.length;S--;)if(p[S]===j)continue e;t&&p.push(j),s.push(w)}else a(p,j,r)||(p!==s&&p.push(j),s.push(w))}return s}var $Ie=BIe,VIe=Ph,UIe=$Ie;function GIe(e,t){return e&&e.length?UIe(e,VIe(t)):[]}var HIe=GIe;const fH=Vi(HIe);function Lne(e,t,r){return t===!0?fH(e,r):Cn(t)?fH(e,t):e}function xb(e){"@babel/helpers - typeof";return xb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xb(e)}var qIe=["ref"];function pH(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,i)}return r}function Qh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?pH(Object(r),!0).forEach(function(i){pM(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pH(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function WIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gH(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,Bne(i.key),i)}}function KIe(e,t,r){return t&&gH(e.prototype,t),r&&gH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ZIe(e,t,r){return t=Ek(t),YIe(e,Fne()?Reflect.construct(t,r||[],Ek(e).constructor):t.apply(e,r))}function YIe(e,t){if(t&&(xb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return XIe(e)}function XIe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Fne(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Fne=function(){return!!e})()}function Ek(e){return Ek=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ek(e)}function JIe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&A5(e,t)}function A5(e,t){return A5=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,a){return i.__proto__=a,i},A5(e,t)}function pM(e,t,r){return t=Bne(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Bne(e){var t=QIe(e,"string");return xb(t)=="symbol"?t:t+""}function QIe(e,t){if(xb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(xb(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function eOe(e,t){if(e==null)return{};var r=tOe(e,t),i,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)i=l[a],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}function tOe(e,t){if(e==null)return{};var r={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;r[i]=e[i]}return r}function rOe(e){return e.value}function nOe(e,t){if(ke.isValidElement(e))return ke.cloneElement(e,t);if(typeof e=="function")return ke.createElement(e,t);t.ref;var r=eOe(t,qIe);return ke.createElement(OB,r)}var xH=1,xa=function(e){function t(){var r;WIe(this,t);for(var i=arguments.length,a=new Array(i),l=0;l<i;l++)a[l]=arguments[l];return r=ZIe(this,t,[].concat(a)),pM(r,"lastBoundingBox",{width:-1,height:-1}),r}return JIe(t,e),KIe(t,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var i=this.wrapperNode.getBoundingClientRect();return i.height=this.wrapperNode.offsetHeight,i.width=this.wrapperNode.offsetWidth,i}return null}},{key:"updateBBox",value:function(){var i=this.props.onBBoxUpdate,a=this.getBBox();a?(Math.abs(a.width-this.lastBoundingBox.width)>xH||Math.abs(a.height-this.lastBoundingBox.height)>xH)&&(this.lastBoundingBox.width=a.width,this.lastBoundingBox.height=a.height,i&&i(a)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,i&&i(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?Qh({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(i){var a=this.props,l=a.layout,d=a.align,s=a.verticalAlign,p=a.margin,x=a.chartWidth,w=a.chartHeight,j,S;if(!i||(i.left===void 0||i.left===null)&&(i.right===void 0||i.right===null))if(d==="center"&&l==="vertical"){var P=this.getBBoxSnapshot();j={left:((x||0)-P.width)/2}}else j=d==="right"?{right:p&&p.right||0}:{left:p&&p.left||0};if(!i||(i.top===void 0||i.top===null)&&(i.bottom===void 0||i.bottom===null))if(s==="middle"){var F=this.getBBoxSnapshot();S={top:((w||0)-F.height)/2}}else S=s==="bottom"?{bottom:p&&p.bottom||0}:{top:p&&p.top||0};return Qh(Qh({},j),S)}},{key:"render",value:function(){var i=this,a=this.props,l=a.content,d=a.width,s=a.height,p=a.wrapperStyle,x=a.payloadUniqBy,w=a.payload,j=Qh(Qh({position:"absolute",width:d||"auto",height:s||"auto"},this.getDefaultPosition(p)),p);return ke.createElement("div",{className:"recharts-legend-wrapper",style:j,ref:function(P){i.wrapperNode=P}},nOe(l,Qh(Qh({},this.props),{},{payload:Lne(w,x,rOe)})))}}],[{key:"getWithHeight",value:function(i,a){var l=Qh(Qh({},this.defaultProps),i.props),d=l.layout;return d==="vertical"&&kr(i.props.height)?{height:i.props.height}:d==="horizontal"?{width:i.props.width||a}:null}}])}(U.PureComponent);pM(xa,"displayName","Legend");pM(xa,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var yH=tS,iOe=DB,sOe=ac,vH=yH?yH.isConcatSpreadable:void 0;function aOe(e){return sOe(e)||iOe(e)||!!(vH&&e&&e[vH])}var oOe=aOe,lOe=Cne,cOe=oOe;function $ne(e,t,r,i,a){var l=-1,d=e.length;for(r||(r=cOe),a||(a=[]);++l<d;){var s=e[l];t>0&&r(s)?t>1?$ne(s,t-1,r,i,a):lOe(a,s):i||(a[a.length]=s)}return a}var Vne=$ne;function uOe(e){return function(t,r,i){for(var a=-1,l=Object(t),d=i(t),s=d.length;s--;){var p=d[e?s:++a];if(r(l[p],p,l)===!1)break}return t}}var dOe=uOe,hOe=dOe,mOe=hOe(),fOe=mOe,pOe=fOe,gOe=fM;function xOe(e,t){return e&&pOe(e,t,gOe)}var Une=xOe,yOe=nS;function vOe(e,t){return function(r,i){if(r==null)return r;if(!yOe(r))return e(r,i);for(var a=r.length,l=t?a:-1,d=Object(r);(t?l--:++l<a)&&i(d[l],l,d)!==!1;);return r}}var bOe=vOe,_Oe=Une,wOe=bOe,jOe=wOe(_Oe),BB=jOe,NOe=BB,SOe=nS;function COe(e,t){var r=-1,i=SOe(e)?Array(e.length):[];return NOe(e,function(a,l,d){i[++r]=t(a,l,d)}),i}var Gne=COe;function AOe(e,t){var r=e.length;for(e.sort(t);r--;)e[r]=e[r].value;return e}var TOe=AOe,bH=w_;function kOe(e,t){if(e!==t){var r=e!==void 0,i=e===null,a=e===e,l=bH(e),d=t!==void 0,s=t===null,p=t===t,x=bH(t);if(!s&&!x&&!l&&e>t||l&&d&&p&&!s&&!x||i&&d&&p||!r&&p||!a)return 1;if(!i&&!l&&!x&&e<t||x&&r&&a&&!i&&!l||s&&r&&a||!d&&a||!p)return-1}return 0}var POe=kOe,EOe=POe;function MOe(e,t,r){for(var i=-1,a=e.criteria,l=t.criteria,d=a.length,s=r.length;++i<d;){var p=EOe(a[i],l[i]);if(p){if(i>=s)return p;var x=r[i];return p*(x=="desc"?-1:1)}}return e.index-t.index}var IOe=MOe,MO=SB,OOe=CB,ROe=Ph,DOe=Gne,zOe=TOe,LOe=kne,FOe=IOe,BOe=P_,$Oe=ac;function VOe(e,t,r){t.length?t=MO(t,function(l){return $Oe(l)?function(d){return OOe(d,l.length===1?l[0]:l)}:l}):t=[BOe];var i=-1;t=MO(t,LOe(ROe));var a=DOe(e,function(l,d,s){var p=MO(t,function(x){return x(l)});return{criteria:p,index:++i,value:l}});return zOe(a,function(l,d){return FOe(l,d,r)})}var UOe=VOe;function GOe(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var HOe=GOe,qOe=HOe,_H=Math.max;function WOe(e,t,r){return t=_H(t===void 0?e.length-1:t,0),function(){for(var i=arguments,a=-1,l=_H(i.length-t,0),d=Array(l);++a<l;)d[a]=i[t+a];a=-1;for(var s=Array(t+1);++a<t;)s[a]=i[a];return s[t]=r(d),qOe(e,this,s)}}var KOe=WOe;function ZOe(e){return function(){return e}}var YOe=ZOe,XOe=Nx,JOe=function(){try{var e=XOe(Object,"defineProperty");return e({},"",{}),e}catch{}}(),Hne=JOe,QOe=YOe,wH=Hne,eRe=P_,tRe=wH?function(e,t){return wH(e,"toString",{configurable:!0,enumerable:!1,value:QOe(t),writable:!0})}:eRe,rRe=tRe,nRe=800,iRe=16,sRe=Date.now;function aRe(e){var t=0,r=0;return function(){var i=sRe(),a=iRe-(i-r);if(r=i,a>0){if(++t>=nRe)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var oRe=aRe,lRe=rRe,cRe=oRe,uRe=cRe(lRe),dRe=uRe,hRe=P_,mRe=KOe,fRe=dRe;function pRe(e,t){return fRe(mRe(e,t,hRe),e+"")}var gRe=pRe,xRe=_B,yRe=nS,vRe=zB,bRe=ag;function _Re(e,t,r){if(!bRe(r))return!1;var i=typeof t;return(i=="number"?yRe(r)&&vRe(t,r.length):i=="string"&&t in r)?xRe(r[t],e):!1}var gM=_Re,wRe=Vne,jRe=UOe,NRe=gRe,jH=gM,SRe=NRe(function(e,t){if(e==null)return[];var r=t.length;return r>1&&jH(e,t[0],t[1])?t=[]:r>2&&jH(t[0],t[1],t[2])&&(t=[t[0]]),jRe(e,wRe(t,1),[])}),CRe=SRe;const $B=Vi(CRe);function A2(e){"@babel/helpers - typeof";return A2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},A2(e)}function T5(){return T5=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},T5.apply(this,arguments)}function ARe(e,t){return ERe(e)||PRe(e,t)||kRe(e,t)||TRe()}function TRe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kRe(e,t){if(e){if(typeof e=="string")return NH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return NH(e,t)}}function NH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function PRe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var i,a,l,d,s=[],p=!0,x=!1;try{if(l=(r=r.call(e)).next,t!==0)for(;!(p=(i=l.call(r)).done)&&(s.push(i.value),s.length!==t);p=!0);}catch(w){x=!0,a=w}finally{try{if(!p&&r.return!=null&&(d=r.return(),Object(d)!==d))return}finally{if(x)throw a}}return s}}function ERe(e){if(Array.isArray(e))return e}function SH(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,i)}return r}function IO(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?SH(Object(r),!0).forEach(function(i){MRe(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):SH(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function MRe(e,t,r){return t=IRe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function IRe(e){var t=ORe(e,"string");return A2(t)=="symbol"?t:t+""}function ORe(e,t){if(A2(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(A2(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function RRe(e){return Array.isArray(e)&&Qa(e[0])&&Qa(e[1])?e.join(" ~ "):e}var DRe=function(t){var r=t.separator,i=r===void 0?" : ":r,a=t.contentStyle,l=a===void 0?{}:a,d=t.itemStyle,s=d===void 0?{}:d,p=t.labelStyle,x=p===void 0?{}:p,w=t.payload,j=t.formatter,S=t.itemSorter,P=t.wrapperClassName,F=t.labelClassName,L=t.label,B=t.labelFormatter,V=t.accessibilityLayer,$=V===void 0?!1:V,G=function(){if(w&&w.length){var Ne={padding:0,margin:0},ze=(S?$B(w,S):w).map(function(ye,ve){if(ye.type==="none")return null;var _e=IO({display:"block",paddingTop:4,paddingBottom:4,color:ye.color||"#000"},s),Ee=ye.formatter||j||RRe,je=ye.value,Ce=ye.name,tt=je,it=Ce;if(Ee&&tt!=null&&it!=null){var mt=Ee(je,Ce,ye,ve,w);if(Array.isArray(mt)){var gt=ARe(mt,2);tt=gt[0],it=gt[1]}else tt=mt}return ke.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(ve),style:_e},Qa(it)?ke.createElement("span",{className:"recharts-tooltip-item-name"},it):null,Qa(it)?ke.createElement("span",{className:"recharts-tooltip-item-separator"},i):null,ke.createElement("span",{className:"recharts-tooltip-item-value"},tt),ke.createElement("span",{className:"recharts-tooltip-item-unit"},ye.unit||""))});return ke.createElement("ul",{className:"recharts-tooltip-item-list",style:Ne},ze)}return null},W=IO({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},l),Z=IO({margin:0},x),se=!Tn(L),ae=se?L:"",ce=zn("recharts-default-tooltip",P),Pe=zn("recharts-tooltip-label",F);se&&B&&w!==void 0&&w!==null&&(ae=B(L,w));var we=$?{role:"status","aria-live":"assertive"}:{};return ke.createElement("div",T5({className:ce,style:W},we),ke.createElement("p",{className:Pe,style:Z},ke.isValidElement(ae)?ae:"".concat(ae)),G())};function T2(e){"@babel/helpers - typeof";return T2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},T2(e)}function VA(e,t,r){return t=zRe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zRe(e){var t=LRe(e,"string");return T2(t)=="symbol"?t:t+""}function LRe(e,t){if(T2(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(T2(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Yw="recharts-tooltip-wrapper",FRe={visibility:"hidden"};function BRe(e){var t=e.coordinate,r=e.translateX,i=e.translateY;return zn(Yw,VA(VA(VA(VA({},"".concat(Yw,"-right"),kr(r)&&t&&kr(t.x)&&r>=t.x),"".concat(Yw,"-left"),kr(r)&&t&&kr(t.x)&&r<t.x),"".concat(Yw,"-bottom"),kr(i)&&t&&kr(t.y)&&i>=t.y),"".concat(Yw,"-top"),kr(i)&&t&&kr(t.y)&&i<t.y))}function CH(e){var t=e.allowEscapeViewBox,r=e.coordinate,i=e.key,a=e.offsetTopLeft,l=e.position,d=e.reverseDirection,s=e.tooltipDimension,p=e.viewBox,x=e.viewBoxDimension;if(l&&kr(l[i]))return l[i];var w=r[i]-s-a,j=r[i]+a;if(t[i])return d[i]?w:j;if(d[i]){var S=w,P=p[i];return S<P?Math.max(j,p[i]):Math.max(w,p[i])}var F=j+s,L=p[i]+x;return F>L?Math.max(w,p[i]):Math.max(j,p[i])}function $Re(e){var t=e.translateX,r=e.translateY,i=e.useTranslate3d;return{transform:i?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function VRe(e){var t=e.allowEscapeViewBox,r=e.coordinate,i=e.offsetTopLeft,a=e.position,l=e.reverseDirection,d=e.tooltipBox,s=e.useTranslate3d,p=e.viewBox,x,w,j;return d.height>0&&d.width>0&&r?(w=CH({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:i,position:a,reverseDirection:l,tooltipDimension:d.width,viewBox:p,viewBoxDimension:p.width}),j=CH({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:i,position:a,reverseDirection:l,tooltipDimension:d.height,viewBox:p,viewBoxDimension:p.height}),x=$Re({translateX:w,translateY:j,useTranslate3d:s})):x=FRe,{cssProperties:x,cssClasses:BRe({translateX:w,translateY:j,coordinate:r})}}function yb(e){"@babel/helpers - typeof";return yb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yb(e)}function AH(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,i)}return r}function TH(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?AH(Object(r),!0).forEach(function(i){P5(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):AH(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function URe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function GRe(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,Wne(i.key),i)}}function HRe(e,t,r){return t&&GRe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function qRe(e,t,r){return t=Mk(t),WRe(e,qne()?Reflect.construct(t,r||[],Mk(e).constructor):t.apply(e,r))}function WRe(e,t){if(t&&(yb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return KRe(e)}function KRe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function qne(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(qne=function(){return!!e})()}function Mk(e){return Mk=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Mk(e)}function ZRe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&k5(e,t)}function k5(e,t){return k5=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,a){return i.__proto__=a,i},k5(e,t)}function P5(e,t,r){return t=Wne(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Wne(e){var t=YRe(e,"string");return yb(t)=="symbol"?t:t+""}function YRe(e,t){if(yb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(yb(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var kH=1,XRe=function(e){function t(){var r;URe(this,t);for(var i=arguments.length,a=new Array(i),l=0;l<i;l++)a[l]=arguments[l];return r=qRe(this,t,[].concat(a)),P5(r,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),P5(r,"handleKeyDown",function(d){if(d.key==="Escape"){var s,p,x,w;r.setState({dismissed:!0,dismissedAtCoordinate:{x:(s=(p=r.props.coordinate)===null||p===void 0?void 0:p.x)!==null&&s!==void 0?s:0,y:(x=(w=r.props.coordinate)===null||w===void 0?void 0:w.y)!==null&&x!==void 0?x:0}})}}),r}return ZRe(t,e),HRe(t,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var i=this.wrapperNode.getBoundingClientRect();(Math.abs(i.width-this.state.lastBoundingBox.width)>kH||Math.abs(i.height-this.state.lastBoundingBox.height)>kH)&&this.setState({lastBoundingBox:{width:i.width,height:i.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var i,a;this.props.active&&this.updateBBox(),this.state.dismissed&&(((i=this.props.coordinate)===null||i===void 0?void 0:i.x)!==this.state.dismissedAtCoordinate.x||((a=this.props.coordinate)===null||a===void 0?void 0:a.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var i=this,a=this.props,l=a.active,d=a.allowEscapeViewBox,s=a.animationDuration,p=a.animationEasing,x=a.children,w=a.coordinate,j=a.hasPayload,S=a.isAnimationActive,P=a.offset,F=a.position,L=a.reverseDirection,B=a.useTranslate3d,V=a.viewBox,$=a.wrapperStyle,G=VRe({allowEscapeViewBox:d,coordinate:w,offsetTopLeft:P,position:F,reverseDirection:L,tooltipBox:this.state.lastBoundingBox,useTranslate3d:B,viewBox:V}),W=G.cssClasses,Z=G.cssProperties,se=TH(TH({transition:S&&l?"transform ".concat(s,"ms ").concat(p):void 0},Z),{},{pointerEvents:"none",visibility:!this.state.dismissed&&l&&j?"visible":"hidden",position:"absolute",top:0,left:0},$);return ke.createElement("div",{tabIndex:-1,className:W,style:se,ref:function(ce){i.wrapperNode=ce}},x)}}])}(U.PureComponent),JRe=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},Dc={isSsr:JRe(),get:function(t){return Dc[t]},set:function(t,r){if(typeof t=="string")Dc[t]=r;else{var i=Object.keys(t);i&&i.length&&i.forEach(function(a){Dc[a]=t[a]})}}};function vb(e){"@babel/helpers - typeof";return vb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vb(e)}function PH(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,i)}return r}function EH(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?PH(Object(r),!0).forEach(function(i){VB(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):PH(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function QRe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function eDe(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,Zne(i.key),i)}}function tDe(e,t,r){return t&&eDe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function rDe(e,t,r){return t=Ik(t),nDe(e,Kne()?Reflect.construct(t,r||[],Ik(e).constructor):t.apply(e,r))}function nDe(e,t){if(t&&(vb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return iDe(e)}function iDe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Kne(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Kne=function(){return!!e})()}function Ik(e){return Ik=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ik(e)}function sDe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&E5(e,t)}function E5(e,t){return E5=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,a){return i.__proto__=a,i},E5(e,t)}function VB(e,t,r){return t=Zne(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Zne(e){var t=aDe(e,"string");return vb(t)=="symbol"?t:t+""}function aDe(e,t){if(vb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(vb(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function oDe(e){return e.dataKey}function lDe(e,t){return ke.isValidElement(e)?ke.cloneElement(e,t):typeof e=="function"?ke.createElement(e,t):ke.createElement(DRe,t)}var yi=function(e){function t(){return QRe(this,t),rDe(this,t,arguments)}return sDe(t,e),tDe(t,[{key:"render",value:function(){var i=this,a=this.props,l=a.active,d=a.allowEscapeViewBox,s=a.animationDuration,p=a.animationEasing,x=a.content,w=a.coordinate,j=a.filterNull,S=a.isAnimationActive,P=a.offset,F=a.payload,L=a.payloadUniqBy,B=a.position,V=a.reverseDirection,$=a.useTranslate3d,G=a.viewBox,W=a.wrapperStyle,Z=F??[];j&&Z.length&&(Z=Lne(F.filter(function(ae){return ae.value!=null&&(ae.hide!==!0||i.props.includeHidden)}),L,oDe));var se=Z.length>0;return ke.createElement(XRe,{allowEscapeViewBox:d,animationDuration:s,animationEasing:p,isAnimationActive:S,active:l,coordinate:w,hasPayload:se,offset:P,position:B,reverseDirection:V,useTranslate3d:$,viewBox:G,wrapperStyle:W},lDe(x,EH(EH({},this.props),{},{payload:Z})))}}])}(U.PureComponent);VB(yi,"displayName","Tooltip");VB(yi,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!Dc.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var cDe=kh,uDe=function(){return cDe.Date.now()},dDe=uDe,hDe=/\s/;function mDe(e){for(var t=e.length;t--&&hDe.test(e.charAt(t)););return t}var fDe=mDe,pDe=fDe,gDe=/^\s+/;function xDe(e){return e&&e.slice(0,pDe(e)+1).replace(gDe,"")}var yDe=xDe,vDe=yDe,MH=ag,bDe=w_,IH=NaN,_De=/^[-+]0x[0-9a-f]+$/i,wDe=/^0b[01]+$/i,jDe=/^0o[0-7]+$/i,NDe=parseInt;function SDe(e){if(typeof e=="number")return e;if(bDe(e))return IH;if(MH(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=MH(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=vDe(e);var r=wDe.test(e);return r||jDe.test(e)?NDe(e.slice(2),r?2:8):_De.test(e)?IH:+e}var Yne=SDe,CDe=ag,OO=dDe,OH=Yne,ADe="Expected a function",TDe=Math.max,kDe=Math.min;function PDe(e,t,r){var i,a,l,d,s,p,x=0,w=!1,j=!1,S=!0;if(typeof e!="function")throw new TypeError(ADe);t=OH(t)||0,CDe(r)&&(w=!!r.leading,j="maxWait"in r,l=j?TDe(OH(r.maxWait)||0,t):l,S="trailing"in r?!!r.trailing:S);function P(se){var ae=i,ce=a;return i=a=void 0,x=se,d=e.apply(ce,ae),d}function F(se){return x=se,s=setTimeout(V,t),w?P(se):d}function L(se){var ae=se-p,ce=se-x,Pe=t-ae;return j?kDe(Pe,l-ce):Pe}function B(se){var ae=se-p,ce=se-x;return p===void 0||ae>=t||ae<0||j&&ce>=l}function V(){var se=OO();if(B(se))return $(se);s=setTimeout(V,L(se))}function $(se){return s=void 0,S&&i?P(se):(i=a=void 0,d)}function G(){s!==void 0&&clearTimeout(s),x=0,i=p=a=s=void 0}function W(){return s===void 0?d:$(OO())}function Z(){var se=OO(),ae=B(se);if(i=arguments,a=this,p=se,ae){if(s===void 0)return F(p);if(j)return clearTimeout(s),s=setTimeout(V,t),P(p)}return s===void 0&&(s=setTimeout(V,t)),d}return Z.cancel=G,Z.flush=W,Z}var EDe=PDe,MDe=EDe,IDe=ag,ODe="Expected a function";function RDe(e,t,r){var i=!0,a=!0;if(typeof e!="function")throw new TypeError(ODe);return IDe(r)&&(i="leading"in r?!!r.leading:i,a="trailing"in r?!!r.trailing:a),MDe(e,t,{leading:i,maxWait:t,trailing:a})}var DDe=RDe;const Xne=Vi(DDe);function k2(e){"@babel/helpers - typeof";return k2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},k2(e)}function RH(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,i)}return r}function UA(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?RH(Object(r),!0).forEach(function(i){zDe(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):RH(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function zDe(e,t,r){return t=LDe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function LDe(e){var t=FDe(e,"string");return k2(t)=="symbol"?t:t+""}function FDe(e,t){if(k2(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(k2(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function BDe(e,t){return GDe(e)||UDe(e,t)||VDe(e,t)||$De()}function $De(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function VDe(e,t){if(e){if(typeof e=="string")return DH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return DH(e,t)}}function DH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function UDe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var i,a,l,d,s=[],p=!0,x=!1;try{if(l=(r=r.call(e)).next,t!==0)for(;!(p=(i=l.call(r)).done)&&(s.push(i.value),s.length!==t);p=!0);}catch(w){x=!0,a=w}finally{try{if(!p&&r.return!=null&&(d=r.return(),Object(d)!==d))return}finally{if(x)throw a}}return s}}function GDe(e){if(Array.isArray(e))return e}var ms=U.forwardRef(function(e,t){var r=e.aspect,i=e.initialDimension,a=i===void 0?{width:-1,height:-1}:i,l=e.width,d=l===void 0?"100%":l,s=e.height,p=s===void 0?"100%":s,x=e.minWidth,w=x===void 0?0:x,j=e.minHeight,S=e.maxHeight,P=e.children,F=e.debounce,L=F===void 0?0:F,B=e.id,V=e.className,$=e.onResize,G=e.style,W=G===void 0?{}:G,Z=U.useRef(null),se=U.useRef();se.current=$,U.useImperativeHandle(t,function(){return Object.defineProperty(Z.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),Z.current},configurable:!0})});var ae=U.useState({containerWidth:a.width,containerHeight:a.height}),ce=BDe(ae,2),Pe=ce[0],we=ce[1],xe=U.useCallback(function(ze,ye){we(function(ve){var _e=Math.round(ze),Ee=Math.round(ye);return ve.containerWidth===_e&&ve.containerHeight===Ee?ve:{containerWidth:_e,containerHeight:Ee}})},[]);U.useEffect(function(){var ze=function(Ce){var tt,it=Ce[0].contentRect,mt=it.width,gt=it.height;xe(mt,gt),(tt=se.current)===null||tt===void 0||tt.call(se,mt,gt)};L>0&&(ze=Xne(ze,L,{trailing:!0,leading:!1}));var ye=new ResizeObserver(ze),ve=Z.current.getBoundingClientRect(),_e=ve.width,Ee=ve.height;return xe(_e,Ee),ye.observe(Z.current),function(){ye.disconnect()}},[xe,L]);var Ne=U.useMemo(function(){var ze=Pe.containerWidth,ye=Pe.containerHeight;if(ze<0||ye<0)return null;xd(P0(d)||P0(p),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,d,p),xd(!r||r>0,"The aspect(%s) must be greater than zero.",r);var ve=P0(d)?ze:d,_e=P0(p)?ye:p;r&&r>0&&(ve?_e=ve/r:_e&&(ve=_e*r),S&&_e>S&&(_e=S)),xd(ve>0||_e>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,ve,_e,d,p,w,j,r);var Ee=!Array.isArray(P)&&wm(P.type).endsWith("Chart");return ke.Children.map(P,function(je){return qre.isElement(je)?U.cloneElement(je,UA({width:ve,height:_e},Ee?{style:UA({height:"100%",width:"100%",maxHeight:_e,maxWidth:ve},je.props.style)}:{})):je})},[r,P,p,S,j,w,Pe,d]);return ke.createElement("div",{id:B?"".concat(B):void 0,className:zn("recharts-responsive-container",V),style:UA(UA({},W),{},{width:d,height:p,minWidth:w,minHeight:j,maxHeight:S}),ref:Z},Ne)}),jd=function(t){return null};jd.displayName="Cell";function P2(e){"@babel/helpers - typeof";return P2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},P2(e)}function zH(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,i)}return r}function M5(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?zH(Object(r),!0).forEach(function(i){HDe(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zH(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function HDe(e,t,r){return t=qDe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qDe(e){var t=WDe(e,"string");return P2(t)=="symbol"?t:t+""}function WDe(e,t){if(P2(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(P2(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var qy={widthCache:{},cacheCount:0},KDe=2e3,ZDe={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},LH="recharts_measurement_span";function YDe(e){var t=M5({},e);return Object.keys(t).forEach(function(r){t[r]||delete t[r]}),t}var Rj=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||Dc.isSsr)return{width:0,height:0};var i=YDe(r),a=JSON.stringify({text:t,copyStyle:i});if(qy.widthCache[a])return qy.widthCache[a];try{var l=document.getElementById(LH);l||(l=document.createElement("span"),l.setAttribute("id",LH),l.setAttribute("aria-hidden","true"),document.body.appendChild(l));var d=M5(M5({},ZDe),i);Object.assign(l.style,d),l.textContent="".concat(t);var s=l.getBoundingClientRect(),p={width:s.width,height:s.height};return qy.widthCache[a]=p,++qy.cacheCount>KDe&&(qy.cacheCount=0,qy.widthCache={}),p}catch{return{width:0,height:0}}},XDe=function(t){return{top:t.top+window.scrollY-document.documentElement.clientTop,left:t.left+window.scrollX-document.documentElement.clientLeft}};function E2(e){"@babel/helpers - typeof";return E2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},E2(e)}function Ok(e,t){return t5e(e)||e5e(e,t)||QDe(e,t)||JDe()}function JDe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function QDe(e,t){if(e){if(typeof e=="string")return FH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return FH(e,t)}}function FH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function e5e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var i,a,l,d,s=[],p=!0,x=!1;try{if(l=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;p=!1}else for(;!(p=(i=l.call(r)).done)&&(s.push(i.value),s.length!==t);p=!0);}catch(w){x=!0,a=w}finally{try{if(!p&&r.return!=null&&(d=r.return(),Object(d)!==d))return}finally{if(x)throw a}}return s}}function t5e(e){if(Array.isArray(e))return e}function r5e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BH(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i5e(i.key),i)}}function n5e(e,t,r){return t&&BH(e.prototype,t),r&&BH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function i5e(e){var t=s5e(e,"string");return E2(t)=="symbol"?t:t+""}function s5e(e,t){if(E2(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t);if(E2(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var $H=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,VH=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,a5e=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,o5e=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,Jne={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},l5e=Object.keys(Jne),_v="NaN";function c5e(e,t){return e*Jne[t]}var GA=function(){function e(t,r){r5e(this,e),this.num=t,this.unit=r,this.num=t,this.unit=r,Number.isNaN(t)&&(this.unit=""),r!==""&&!a5e.test(r)&&(this.num=NaN,this.unit=""),l5e.includes(r)&&(this.num=c5e(t,r),this.unit="px")}return n5e(e,[{key:"add",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num+r.num,this.unit)}},{key:"subtract",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num-r.num,this.unit)}},{key:"multiply",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num*r.num,this.unit||r.unit)}},{key:"divide",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num/r.num,this.unit||r.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(r){var i,a=(i=o5e.exec(r))!==null&&i!==void 0?i:[],l=Ok(a,3),d=l[1],s=l[2];return new e(parseFloat(d),s??"")}}])}();function Qne(e){if(e.includes(_v))return _v;for(var t=e;t.includes("*")||t.includes("/");){var r,i=(r=$H.exec(t))!==null&&r!==void 0?r:[],a=Ok(i,4),l=a[1],d=a[2],s=a[3],p=GA.parse(l??""),x=GA.parse(s??""),w=d==="*"?p.multiply(x):p.divide(x);if(w.isNaN())return _v;t=t.replace($H,w.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var j,S=(j=VH.exec(t))!==null&&j!==void 0?j:[],P=Ok(S,4),F=P[1],L=P[2],B=P[3],V=GA.parse(F??""),$=GA.parse(B??""),G=L==="+"?V.add($):V.subtract($);if(G.isNaN())return _v;t=t.replace(VH,G.toString())}return t}var UH=/\(([^()]*)\)/;function u5e(e){for(var t=e;t.includes("(");){var r=UH.exec(t),i=Ok(r,2),a=i[1];t=t.replace(UH,Qne(a))}return t}function d5e(e){var t=e.replace(/\s+/g,"");return t=u5e(t),t=Qne(t),t}function h5e(e){try{return d5e(e)}catch{return _v}}function RO(e){var t=h5e(e.slice(5,-1));return t===_v?"":t}var m5e=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],f5e=["dx","dy","angle","className","breakAll"];function I5(){return I5=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},I5.apply(this,arguments)}function GH(e,t){if(e==null)return{};var r=p5e(e,t),i,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)i=l[a],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}function p5e(e,t){if(e==null)return{};var r={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;r[i]=e[i]}return r}function HH(e,t){return v5e(e)||y5e(e,t)||x5e(e,t)||g5e()}function g5e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function x5e(e,t){if(e){if(typeof e=="string")return qH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return qH(e,t)}}function qH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function y5e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var i,a,l,d,s=[],p=!0,x=!1;try{if(l=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;p=!1}else for(;!(p=(i=l.call(r)).done)&&(s.push(i.value),s.length!==t);p=!0);}catch(w){x=!0,a=w}finally{try{if(!p&&r.return!=null&&(d=r.return(),Object(d)!==d))return}finally{if(x)throw a}}return s}}function v5e(e){if(Array.isArray(e))return e}var eie=/[ \f\n\r\t\v\u2028\u2029]+/,tie=function(t){var r=t.children,i=t.breakAll,a=t.style;try{var l=[];Tn(r)||(i?l=r.toString().split(""):l=r.toString().split(eie));var d=l.map(function(p){return{word:p,width:Rj(p,a).width}}),s=i?0:Rj(" ",a).width;return{wordsWithComputedWidth:d,spaceWidth:s}}catch{return null}},b5e=function(t,r,i,a,l){var d=t.maxLines,s=t.children,p=t.style,x=t.breakAll,w=kr(d),j=s,S=function(){var ve=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return ve.reduce(function(_e,Ee){var je=Ee.word,Ce=Ee.width,tt=_e[_e.length-1];if(tt&&(a==null||l||tt.width+Ce+i<Number(a)))tt.words.push(je),tt.width+=Ce+i;else{var it={words:[je],width:Ce};_e.push(it)}return _e},[])},P=S(r),F=function(ve){return ve.reduce(function(_e,Ee){return _e.width>Ee.width?_e:Ee})};if(!w)return P;for(var L="…",B=function(ve){var _e=j.slice(0,ve),Ee=tie({breakAll:x,style:p,children:_e+L}).wordsWithComputedWidth,je=S(Ee),Ce=je.length>d||F(je).width>Number(a);return[Ce,je]},V=0,$=j.length-1,G=0,W;V<=$&&G<=j.length-1;){var Z=Math.floor((V+$)/2),se=Z-1,ae=B(se),ce=HH(ae,2),Pe=ce[0],we=ce[1],xe=B(Z),Ne=HH(xe,1),ze=Ne[0];if(!Pe&&!ze&&(V=Z+1),Pe&&ze&&($=Z-1),!Pe&&ze){W=we;break}G++}return W||P},WH=function(t){var r=Tn(t)?[]:t.toString().split(eie);return[{words:r}]},_5e=function(t){var r=t.width,i=t.scaleToFit,a=t.children,l=t.style,d=t.breakAll,s=t.maxLines;if((r||i)&&!Dc.isSsr){var p,x,w=tie({breakAll:d,children:a,style:l});if(w){var j=w.wordsWithComputedWidth,S=w.spaceWidth;p=j,x=S}else return WH(a);return b5e({breakAll:d,children:a,maxLines:s,style:l},p,x,r,i)}return WH(a)},KH="#808080",ix=function(t){var r=t.x,i=r===void 0?0:r,a=t.y,l=a===void 0?0:a,d=t.lineHeight,s=d===void 0?"1em":d,p=t.capHeight,x=p===void 0?"0.71em":p,w=t.scaleToFit,j=w===void 0?!1:w,S=t.textAnchor,P=S===void 0?"start":S,F=t.verticalAnchor,L=F===void 0?"end":F,B=t.fill,V=B===void 0?KH:B,$=GH(t,m5e),G=U.useMemo(function(){return _5e({breakAll:$.breakAll,children:$.children,maxLines:$.maxLines,scaleToFit:j,style:$.style,width:$.width})},[$.breakAll,$.children,$.maxLines,j,$.style,$.width]),W=$.dx,Z=$.dy,se=$.angle,ae=$.className,ce=$.breakAll,Pe=GH($,f5e);if(!Qa(i)||!Qa(l))return null;var we=i+(kr(W)?W:0),xe=l+(kr(Z)?Z:0),Ne;switch(L){case"start":Ne=RO("calc(".concat(x,")"));break;case"middle":Ne=RO("calc(".concat((G.length-1)/2," * -").concat(s," + (").concat(x," / 2))"));break;default:Ne=RO("calc(".concat(G.length-1," * -").concat(s,")"));break}var ze=[];if(j){var ye=G[0].width,ve=$.width;ze.push("scale(".concat((kr(ve)?ve/ye:1)/ye,")"))}return se&&ze.push("rotate(".concat(se,", ").concat(we,", ").concat(xe,")")),ze.length&&(Pe.transform=ze.join(" ")),ke.createElement("text",I5({},en(Pe,!0),{x:we,y:xe,className:zn("recharts-text",ae),textAnchor:P,fill:V.includes("url")?KH:V}),G.map(function(_e,Ee){var je=_e.words.join(ce?"":" ");return ke.createElement("tspan",{x:we,dy:Ee===0?Ne:s,key:"".concat(je,"-").concat(Ee)},je)}))};function Rp(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function w5e(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function UB(e){let t,r,i;e.length!==2?(t=Rp,r=(s,p)=>Rp(e(s),p),i=(s,p)=>e(s)-p):(t=e===Rp||e===w5e?e:j5e,r=e,i=e);function a(s,p,x=0,w=s.length){if(x<w){if(t(p,p)!==0)return w;do{const j=x+w>>>1;r(s[j],p)<0?x=j+1:w=j}while(x<w)}return x}function l(s,p,x=0,w=s.length){if(x<w){if(t(p,p)!==0)return w;do{const j=x+w>>>1;r(s[j],p)<=0?x=j+1:w=j}while(x<w)}return x}function d(s,p,x=0,w=s.length){const j=a(s,p,x,w-1);return j>x&&i(s[j-1],p)>-i(s[j],p)?j-1:j}return{left:a,center:d,right:l}}function j5e(){return 0}function rie(e){return e===null?NaN:+e}function*N5e(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const S5e=UB(Rp),iS=S5e.right;UB(rie).center;class ZH extends Map{constructor(t,r=T5e){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[i,a]of t)this.set(i,a)}get(t){return super.get(YH(this,t))}has(t){return super.has(YH(this,t))}set(t,r){return super.set(C5e(this,t),r)}delete(t){return super.delete(A5e(this,t))}}function YH({_intern:e,_key:t},r){const i=t(r);return e.has(i)?e.get(i):r}function C5e({_intern:e,_key:t},r){const i=t(r);return e.has(i)?e.get(i):(e.set(i,r),r)}function A5e({_intern:e,_key:t},r){const i=t(r);return e.has(i)&&(r=e.get(i),e.delete(i)),r}function T5e(e){return e!==null&&typeof e=="object"?e.valueOf():e}function k5e(e=Rp){if(e===Rp)return nie;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const i=e(t,r);return i||i===0?i:(e(r,r)===0)-(e(t,t)===0)}}function nie(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const P5e=Math.sqrt(50),E5e=Math.sqrt(10),M5e=Math.sqrt(2);function Rk(e,t,r){const i=(t-e)/Math.max(0,r),a=Math.floor(Math.log10(i)),l=i/Math.pow(10,a),d=l>=P5e?10:l>=E5e?5:l>=M5e?2:1;let s,p,x;return a<0?(x=Math.pow(10,-a)/d,s=Math.round(e*x),p=Math.round(t*x),s/x<e&&++s,p/x>t&&--p,x=-x):(x=Math.pow(10,a)*d,s=Math.round(e/x),p=Math.round(t/x),s*x<e&&++s,p*x>t&&--p),p<s&&.5<=r&&r<2?Rk(e,t,r*2):[s,p,x]}function O5(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const i=t<e,[a,l,d]=i?Rk(t,e,r):Rk(e,t,r);if(!(l>=a))return[];const s=l-a+1,p=new Array(s);if(i)if(d<0)for(let x=0;x<s;++x)p[x]=(l-x)/-d;else for(let x=0;x<s;++x)p[x]=(l-x)*d;else if(d<0)for(let x=0;x<s;++x)p[x]=(a+x)/-d;else for(let x=0;x<s;++x)p[x]=(a+x)*d;return p}function R5(e,t,r){return t=+t,e=+e,r=+r,Rk(e,t,r)[2]}function D5(e,t,r){t=+t,e=+e,r=+r;const i=t<e,a=i?R5(t,e,r):R5(e,t,r);return(i?-1:1)*(a<0?1/-a:a)}function XH(e,t){let r;for(const i of e)i!=null&&(r<i||r===void 0&&i>=i)&&(r=i);return r}function JH(e,t){let r;for(const i of e)i!=null&&(r>i||r===void 0&&i>=i)&&(r=i);return r}function iie(e,t,r=0,i=1/0,a){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),i=Math.floor(Math.min(e.length-1,i)),!(r<=t&&t<=i))return e;for(a=a===void 0?nie:k5e(a);i>r;){if(i-r>600){const p=i-r+1,x=t-r+1,w=Math.log(p),j=.5*Math.exp(2*w/3),S=.5*Math.sqrt(w*j*(p-j)/p)*(x-p/2<0?-1:1),P=Math.max(r,Math.floor(t-x*j/p+S)),F=Math.min(i,Math.floor(t+(p-x)*j/p+S));iie(e,t,P,F,a)}const l=e[t];let d=r,s=i;for(Xw(e,r,t),a(e[i],l)>0&&Xw(e,r,i);d<s;){for(Xw(e,d,s),++d,--s;a(e[d],l)<0;)++d;for(;a(e[s],l)>0;)--s}a(e[r],l)===0?Xw(e,r,s):(++s,Xw(e,s,i)),s<=t&&(r=s+1),t<=s&&(i=s-1)}return e}function Xw(e,t,r){const i=e[t];e[t]=e[r],e[r]=i}function I5e(e,t,r){if(e=Float64Array.from(N5e(e)),!(!(i=e.length)||isNaN(t=+t))){if(t<=0||i<2)return JH(e);if(t>=1)return XH(e);var i,a=(i-1)*t,l=Math.floor(a),d=XH(iie(e,l).subarray(0,l+1)),s=JH(e.subarray(l+1));return d+(s-d)*(a-l)}}function O5e(e,t,r=rie){if(!(!(i=e.length)||isNaN(t=+t))){if(t<=0||i<2)return+r(e[0],0,e);if(t>=1)return+r(e[i-1],i-1,e);var i,a=(i-1)*t,l=Math.floor(a),d=+r(e[l],l,e),s=+r(e[l+1],l+1,e);return d+(s-d)*(a-l)}}function R5e(e,t,r){e=+e,t=+t,r=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+r;for(var i=-1,a=Math.max(0,Math.ceil((t-e)/r))|0,l=new Array(a);++i<a;)l[i]=e+i*r;return l}function Au(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function $m(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const z5=Symbol("implicit");function GB(){var e=new ZH,t=[],r=[],i=z5;function a(l){let d=e.get(l);if(d===void 0){if(i!==z5)return i;e.set(l,d=t.push(l)-1)}return r[d%r.length]}return a.domain=function(l){if(!arguments.length)return t.slice();t=[],e=new ZH;for(const d of l)e.has(d)||e.set(d,t.push(d)-1);return a},a.range=function(l){return arguments.length?(r=Array.from(l),a):r.slice()},a.unknown=function(l){return arguments.length?(i=l,a):i},a.copy=function(){return GB(t,r).unknown(i)},Au.apply(a,arguments),a}function M2(){var e=GB().unknown(void 0),t=e.domain,r=e.range,i=0,a=1,l,d,s=!1,p=0,x=0,w=.5;delete e.unknown;function j(){var S=t().length,P=a<i,F=P?a:i,L=P?i:a;l=(L-F)/Math.max(1,S-p+x*2),s&&(l=Math.floor(l)),F+=(L-F-l*(S-p))*w,d=l*(1-p),s&&(F=Math.round(F),d=Math.round(d));var B=R5e(S).map(function(V){return F+l*V});return r(P?B.reverse():B)}return e.domain=function(S){return arguments.length?(t(S),j()):t()},e.range=function(S){return arguments.length?([i,a]=S,i=+i,a=+a,j()):[i,a]},e.rangeRound=function(S){return[i,a]=S,i=+i,a=+a,s=!0,j()},e.bandwidth=function(){return d},e.step=function(){return l},e.round=function(S){return arguments.length?(s=!!S,j()):s},e.padding=function(S){return arguments.length?(p=Math.min(1,x=+S),j()):p},e.paddingInner=function(S){return arguments.length?(p=Math.min(1,S),j()):p},e.paddingOuter=function(S){return arguments.length?(x=+S,j()):x},e.align=function(S){return arguments.length?(w=Math.max(0,Math.min(1,S)),j()):w},e.copy=function(){return M2(t(),[i,a]).round(s).paddingInner(p).paddingOuter(x).align(w)},Au.apply(j(),arguments)}function sie(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return sie(t())},e}function Dj(){return sie(M2.apply(null,arguments).paddingInner(1))}function HB(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function aie(e,t){var r=Object.create(e.prototype);for(var i in t)r[i]=t[i];return r}function sS(){}var I2=.7,Dk=1/I2,Fv="\\s*([+-]?\\d+)\\s*",O2="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",fh="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",D5e=/^#([0-9a-f]{3,8})$/,z5e=new RegExp(`^rgb\\(${Fv},${Fv},${Fv}\\)$`),L5e=new RegExp(`^rgb\\(${fh},${fh},${fh}\\)$`),F5e=new RegExp(`^rgba\\(${Fv},${Fv},${Fv},${O2}\\)$`),B5e=new RegExp(`^rgba\\(${fh},${fh},${fh},${O2}\\)$`),$5e=new RegExp(`^hsl\\(${O2},${fh},${fh}\\)$`),V5e=new RegExp(`^hsla\\(${O2},${fh},${fh},${O2}\\)$`),QH={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};HB(sS,sx,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:eq,formatHex:eq,formatHex8:U5e,formatHsl:G5e,formatRgb:tq,toString:tq});function eq(){return this.rgb().formatHex()}function U5e(){return this.rgb().formatHex8()}function G5e(){return oie(this).formatHsl()}function tq(){return this.rgb().formatRgb()}function sx(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=D5e.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?rq(t):r===3?new Xl(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?HA(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?HA(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=z5e.exec(e))?new Xl(t[1],t[2],t[3],1):(t=L5e.exec(e))?new Xl(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=F5e.exec(e))?HA(t[1],t[2],t[3],t[4]):(t=B5e.exec(e))?HA(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=$5e.exec(e))?sq(t[1],t[2]/100,t[3]/100,1):(t=V5e.exec(e))?sq(t[1],t[2]/100,t[3]/100,t[4]):QH.hasOwnProperty(e)?rq(QH[e]):e==="transparent"?new Xl(NaN,NaN,NaN,0):null}function rq(e){return new Xl(e>>16&255,e>>8&255,e&255,1)}function HA(e,t,r,i){return i<=0&&(e=t=r=NaN),new Xl(e,t,r,i)}function H5e(e){return e instanceof sS||(e=sx(e)),e?(e=e.rgb(),new Xl(e.r,e.g,e.b,e.opacity)):new Xl}function L5(e,t,r,i){return arguments.length===1?H5e(e):new Xl(e,t,r,i??1)}function Xl(e,t,r,i){this.r=+e,this.g=+t,this.b=+r,this.opacity=+i}HB(Xl,L5,aie(sS,{brighter(e){return e=e==null?Dk:Math.pow(Dk,e),new Xl(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?I2:Math.pow(I2,e),new Xl(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Xl(U0(this.r),U0(this.g),U0(this.b),zk(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:nq,formatHex:nq,formatHex8:q5e,formatRgb:iq,toString:iq}));function nq(){return`#${E0(this.r)}${E0(this.g)}${E0(this.b)}`}function q5e(){return`#${E0(this.r)}${E0(this.g)}${E0(this.b)}${E0((isNaN(this.opacity)?1:this.opacity)*255)}`}function iq(){const e=zk(this.opacity);return`${e===1?"rgb(":"rgba("}${U0(this.r)}, ${U0(this.g)}, ${U0(this.b)}${e===1?")":`, ${e})`}`}function zk(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function U0(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function E0(e){return e=U0(e),(e<16?"0":"")+e.toString(16)}function sq(e,t,r,i){return i<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new dd(e,t,r,i)}function oie(e){if(e instanceof dd)return new dd(e.h,e.s,e.l,e.opacity);if(e instanceof sS||(e=sx(e)),!e)return new dd;if(e instanceof dd)return e;e=e.rgb();var t=e.r/255,r=e.g/255,i=e.b/255,a=Math.min(t,r,i),l=Math.max(t,r,i),d=NaN,s=l-a,p=(l+a)/2;return s?(t===l?d=(r-i)/s+(r<i)*6:r===l?d=(i-t)/s+2:d=(t-r)/s+4,s/=p<.5?l+a:2-l-a,d*=60):s=p>0&&p<1?0:d,new dd(d,s,p,e.opacity)}function W5e(e,t,r,i){return arguments.length===1?oie(e):new dd(e,t,r,i??1)}function dd(e,t,r,i){this.h=+e,this.s=+t,this.l=+r,this.opacity=+i}HB(dd,W5e,aie(sS,{brighter(e){return e=e==null?Dk:Math.pow(Dk,e),new dd(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?I2:Math.pow(I2,e),new dd(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,i=r+(r<.5?r:1-r)*t,a=2*r-i;return new Xl(DO(e>=240?e-240:e+120,a,i),DO(e,a,i),DO(e<120?e+240:e-120,a,i),this.opacity)},clamp(){return new dd(aq(this.h),qA(this.s),qA(this.l),zk(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=zk(this.opacity);return`${e===1?"hsl(":"hsla("}${aq(this.h)}, ${qA(this.s)*100}%, ${qA(this.l)*100}%${e===1?")":`, ${e})`}`}}));function aq(e){return e=(e||0)%360,e<0?e+360:e}function qA(e){return Math.max(0,Math.min(1,e||0))}function DO(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const qB=e=>()=>e;function K5e(e,t){return function(r){return e+r*t}}function Z5e(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(i){return Math.pow(e+i*t,r)}}function Y5e(e){return(e=+e)==1?lie:function(t,r){return r-t?Z5e(t,r,e):qB(isNaN(t)?r:t)}}function lie(e,t){var r=t-e;return r?K5e(e,r):qB(isNaN(e)?t:e)}const Lk=function e(t){var r=Y5e(t);function i(a,l){var d=r((a=L5(a)).r,(l=L5(l)).r),s=r(a.g,l.g),p=r(a.b,l.b),x=lie(a.opacity,l.opacity);return function(w){return a.r=d(w),a.g=s(w),a.b=p(w),a.opacity=x(w),a+""}}return i.gamma=e,i}(1);function X5e(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,i=t.slice(),a;return function(l){for(a=0;a<r;++a)i[a]=e[a]*(1-l)+t[a]*l;return i}}function J5e(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Q5e(e,t){var r=t?t.length:0,i=e?Math.min(r,e.length):0,a=new Array(i),l=new Array(r),d;for(d=0;d<i;++d)a[d]=jm(e[d],t[d]);for(;d<r;++d)l[d]=t[d];return function(s){for(d=0;d<i;++d)l[d]=a[d](s);return l}}function eze(e,t){var r=new Date;return e=+e,t=+t,function(i){return r.setTime(e*(1-i)+t*i),r}}function ud(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function tze(e,t){var r={},i={},a;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(a in t)a in e?r[a]=jm(e[a],t[a]):i[a]=t[a];return function(l){for(a in r)i[a]=r[a](l);return i}}var F5=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,zO=new RegExp(F5.source,"g");function rze(e){return function(){return e}}function nze(e){return function(t){return e(t)+""}}function cie(e,t){var r=F5.lastIndex=zO.lastIndex=0,i,a,l,d=-1,s=[],p=[];for(e=e+"",t=t+"";(i=F5.exec(e))&&(a=zO.exec(t));)(l=a.index)>r&&(l=t.slice(r,l),s[d]?s[d]+=l:s[++d]=l),(i=i[0])===(a=a[0])?s[d]?s[d]+=a:s[++d]=a:(s[++d]=null,p.push({i:d,x:ud(i,a)})),r=zO.lastIndex;return r<t.length&&(l=t.slice(r),s[d]?s[d]+=l:s[++d]=l),s.length<2?p[0]?nze(p[0].x):rze(t):(t=p.length,function(x){for(var w=0,j;w<t;++w)s[(j=p[w]).i]=j.x(x);return s.join("")})}function jm(e,t){var r=typeof t,i;return t==null||r==="boolean"?qB(t):(r==="number"?ud:r==="string"?(i=sx(t))?(t=i,Lk):cie:t instanceof sx?Lk:t instanceof Date?eze:J5e(t)?X5e:Array.isArray(t)?Q5e:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?tze:ud)(e,t)}function WB(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}var oq=180/Math.PI,B5={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function uie(e,t,r,i,a,l){var d,s,p;return(d=Math.sqrt(e*e+t*t))&&(e/=d,t/=d),(p=e*r+t*i)&&(r-=e*p,i-=t*p),(s=Math.sqrt(r*r+i*i))&&(r/=s,i/=s,p/=s),e*i<t*r&&(e=-e,t=-t,p=-p,d=-d),{translateX:a,translateY:l,rotate:Math.atan2(t,e)*oq,skewX:Math.atan(p)*oq,scaleX:d,scaleY:s}}var WA;function ize(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?B5:uie(t.a,t.b,t.c,t.d,t.e,t.f)}function sze(e){return e==null||(WA||(WA=document.createElementNS("http://www.w3.org/2000/svg","g")),WA.setAttribute("transform",e),!(e=WA.transform.baseVal.consolidate()))?B5:(e=e.matrix,uie(e.a,e.b,e.c,e.d,e.e,e.f))}function die(e,t,r,i){function a(x){return x.length?x.pop()+" ":""}function l(x,w,j,S,P,F){if(x!==j||w!==S){var L=P.push("translate(",null,t,null,r);F.push({i:L-4,x:ud(x,j)},{i:L-2,x:ud(w,S)})}else(j||S)&&P.push("translate("+j+t+S+r)}function d(x,w,j,S){x!==w?(x-w>180?w+=360:w-x>180&&(x+=360),S.push({i:j.push(a(j)+"rotate(",null,i)-2,x:ud(x,w)})):w&&j.push(a(j)+"rotate("+w+i)}function s(x,w,j,S){x!==w?S.push({i:j.push(a(j)+"skewX(",null,i)-2,x:ud(x,w)}):w&&j.push(a(j)+"skewX("+w+i)}function p(x,w,j,S,P,F){if(x!==j||w!==S){var L=P.push(a(P)+"scale(",null,",",null,")");F.push({i:L-4,x:ud(x,j)},{i:L-2,x:ud(w,S)})}else(j!==1||S!==1)&&P.push(a(P)+"scale("+j+","+S+")")}return function(x,w){var j=[],S=[];return x=e(x),w=e(w),l(x.translateX,x.translateY,w.translateX,w.translateY,j,S),d(x.rotate,w.rotate,j,S),s(x.skewX,w.skewX,j,S),p(x.scaleX,x.scaleY,w.scaleX,w.scaleY,j,S),x=w=null,function(P){for(var F=-1,L=S.length,B;++F<L;)j[(B=S[F]).i]=B.x(P);return j.join("")}}}var aze=die(ize,"px, ","px)","deg)"),oze=die(sze,", ",")",")"),lze=1e-12;function lq(e){return((e=Math.exp(e))+1/e)/2}function cze(e){return((e=Math.exp(e))-1/e)/2}function uze(e){return((e=Math.exp(2*e))-1)/(e+1)}const PT=function e(t,r,i){function a(l,d){var s=l[0],p=l[1],x=l[2],w=d[0],j=d[1],S=d[2],P=w-s,F=j-p,L=P*P+F*F,B,V;if(L<lze)V=Math.log(S/x)/t,B=function(ae){return[s+ae*P,p+ae*F,x*Math.exp(t*ae*V)]};else{var $=Math.sqrt(L),G=(S*S-x*x+i*L)/(2*x*r*$),W=(S*S-x*x-i*L)/(2*S*r*$),Z=Math.log(Math.sqrt(G*G+1)-G),se=Math.log(Math.sqrt(W*W+1)-W);V=(se-Z)/t,B=function(ae){var ce=ae*V,Pe=lq(Z),we=x/(r*$)*(Pe*uze(t*ce+Z)-cze(Z));return[s+we*P,p+we*F,x*Pe/lq(t*ce+Z)]}}return B.duration=V*1e3*t/Math.SQRT2,B}return a.rho=function(l){var d=Math.max(.001,+l),s=d*d,p=s*s;return e(d,s,p)},a}(Math.SQRT2,2,4);function dze(e,t){t===void 0&&(t=e,e=jm);for(var r=0,i=t.length-1,a=t[0],l=new Array(i<0?0:i);r<i;)l[r]=e(a,a=t[++r]);return function(d){var s=Math.max(0,Math.min(i-1,Math.floor(d*=i)));return l[s](d-s)}}function hze(e){return function(){return e}}function Fk(e){return+e}var cq=[0,1];function wl(e){return e}function $5(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:hze(isNaN(t)?NaN:.5)}function mze(e,t){var r;return e>t&&(r=e,e=t,t=r),function(i){return Math.max(e,Math.min(t,i))}}function fze(e,t,r){var i=e[0],a=e[1],l=t[0],d=t[1];return a<i?(i=$5(a,i),l=r(d,l)):(i=$5(i,a),l=r(l,d)),function(s){return l(i(s))}}function pze(e,t,r){var i=Math.min(e.length,t.length)-1,a=new Array(i),l=new Array(i),d=-1;for(e[i]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++d<i;)a[d]=$5(e[d],e[d+1]),l[d]=r(t[d],t[d+1]);return function(s){var p=iS(e,s,1,i)-1;return l[p](a[p](s))}}function aS(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function xM(){var e=cq,t=cq,r=jm,i,a,l,d=wl,s,p,x;function w(){var S=Math.min(e.length,t.length);return d!==wl&&(d=mze(e[0],e[S-1])),s=S>2?pze:fze,p=x=null,j}function j(S){return S==null||isNaN(S=+S)?l:(p||(p=s(e.map(i),t,r)))(i(d(S)))}return j.invert=function(S){return d(a((x||(x=s(t,e.map(i),ud)))(S)))},j.domain=function(S){return arguments.length?(e=Array.from(S,Fk),w()):e.slice()},j.range=function(S){return arguments.length?(t=Array.from(S),w()):t.slice()},j.rangeRound=function(S){return t=Array.from(S),r=WB,w()},j.clamp=function(S){return arguments.length?(d=S?!0:wl,w()):d!==wl},j.interpolate=function(S){return arguments.length?(r=S,w()):r},j.unknown=function(S){return arguments.length?(l=S,j):l},function(S,P){return i=S,a=P,w()}}function KB(){return xM()(wl,wl)}function gze(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Bk(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,i=e.slice(0,r);return[i.length>1?i[0]+i.slice(2):i,+e.slice(r+1)]}function bb(e){return e=Bk(Math.abs(e)),e?e[1]:NaN}function xze(e,t){return function(r,i){for(var a=r.length,l=[],d=0,s=e[0],p=0;a>0&&s>0&&(p+s+1>i&&(s=Math.max(1,i-p)),l.push(r.substring(a-=s,a+s)),!((p+=s+1)>i));)s=e[d=(d+1)%e.length];return l.reverse().join(t)}}function yze(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var vze=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function R2(e){if(!(t=vze.exec(e)))throw new Error("invalid format: "+e);var t;return new ZB({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}R2.prototype=ZB.prototype;function ZB(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}ZB.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function bze(e){e:for(var t=e.length,r=1,i=-1,a;r<t;++r)switch(e[r]){case".":i=a=r;break;case"0":i===0&&(i=r),a=r;break;default:if(!+e[r])break e;i>0&&(i=0);break}return i>0?e.slice(0,i)+e.slice(a+1):e}var hie;function _ze(e,t){var r=Bk(e,t);if(!r)return e+"";var i=r[0],a=r[1],l=a-(hie=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,d=i.length;return l===d?i:l>d?i+new Array(l-d+1).join("0"):l>0?i.slice(0,l)+"."+i.slice(l):"0."+new Array(1-l).join("0")+Bk(e,Math.max(0,t+l-1))[0]}function uq(e,t){var r=Bk(e,t);if(!r)return e+"";var i=r[0],a=r[1];return a<0?"0."+new Array(-a).join("0")+i:i.length>a+1?i.slice(0,a+1)+"."+i.slice(a+1):i+new Array(a-i.length+2).join("0")}const dq={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:gze,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>uq(e*100,t),r:uq,s:_ze,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function hq(e){return e}var mq=Array.prototype.map,fq=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function wze(e){var t=e.grouping===void 0||e.thousands===void 0?hq:xze(mq.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",i=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",l=e.numerals===void 0?hq:yze(mq.call(e.numerals,String)),d=e.percent===void 0?"%":e.percent+"",s=e.minus===void 0?"−":e.minus+"",p=e.nan===void 0?"NaN":e.nan+"";function x(j){j=R2(j);var S=j.fill,P=j.align,F=j.sign,L=j.symbol,B=j.zero,V=j.width,$=j.comma,G=j.precision,W=j.trim,Z=j.type;Z==="n"?($=!0,Z="g"):dq[Z]||(G===void 0&&(G=12),W=!0,Z="g"),(B||S==="0"&&P==="=")&&(B=!0,S="0",P="=");var se=L==="$"?r:L==="#"&&/[boxX]/.test(Z)?"0"+Z.toLowerCase():"",ae=L==="$"?i:/[%p]/.test(Z)?d:"",ce=dq[Z],Pe=/[defgprs%]/.test(Z);G=G===void 0?6:/[gprs]/.test(Z)?Math.max(1,Math.min(21,G)):Math.max(0,Math.min(20,G));function we(xe){var Ne=se,ze=ae,ye,ve,_e;if(Z==="c")ze=ce(xe)+ze,xe="";else{xe=+xe;var Ee=xe<0||1/xe<0;if(xe=isNaN(xe)?p:ce(Math.abs(xe),G),W&&(xe=bze(xe)),Ee&&+xe==0&&F!=="+"&&(Ee=!1),Ne=(Ee?F==="("?F:s:F==="-"||F==="("?"":F)+Ne,ze=(Z==="s"?fq[8+hie/3]:"")+ze+(Ee&&F==="("?")":""),Pe){for(ye=-1,ve=xe.length;++ye<ve;)if(_e=xe.charCodeAt(ye),48>_e||_e>57){ze=(_e===46?a+xe.slice(ye+1):xe.slice(ye))+ze,xe=xe.slice(0,ye);break}}}$&&!B&&(xe=t(xe,1/0));var je=Ne.length+xe.length+ze.length,Ce=je<V?new Array(V-je+1).join(S):"";switch($&&B&&(xe=t(Ce+xe,Ce.length?V-ze.length:1/0),Ce=""),P){case"<":xe=Ne+xe+ze+Ce;break;case"=":xe=Ne+Ce+xe+ze;break;case"^":xe=Ce.slice(0,je=Ce.length>>1)+Ne+xe+ze+Ce.slice(je);break;default:xe=Ce+Ne+xe+ze;break}return l(xe)}return we.toString=function(){return j+""},we}function w(j,S){var P=x((j=R2(j),j.type="f",j)),F=Math.max(-8,Math.min(8,Math.floor(bb(S)/3)))*3,L=Math.pow(10,-F),B=fq[8+F/3];return function(V){return P(L*V)+B}}return{format:x,formatPrefix:w}}var KA,YB,mie;jze({thousands:",",grouping:[3],currency:["$",""]});function jze(e){return KA=wze(e),YB=KA.format,mie=KA.formatPrefix,KA}function Nze(e){return Math.max(0,-bb(Math.abs(e)))}function Sze(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(bb(t)/3)))*3-bb(Math.abs(e)))}function Cze(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,bb(t)-bb(e))+1}function fie(e,t,r,i){var a=D5(e,t,r),l;switch(i=R2(i??",f"),i.type){case"s":{var d=Math.max(Math.abs(e),Math.abs(t));return i.precision==null&&!isNaN(l=Sze(a,d))&&(i.precision=l),mie(i,d)}case"":case"e":case"g":case"p":case"r":{i.precision==null&&!isNaN(l=Cze(a,Math.max(Math.abs(e),Math.abs(t))))&&(i.precision=l-(i.type==="e"));break}case"f":case"%":{i.precision==null&&!isNaN(l=Nze(a))&&(i.precision=l-(i.type==="%")*2);break}}return YB(i)}function lg(e){var t=e.domain;return e.ticks=function(r){var i=t();return O5(i[0],i[i.length-1],r??10)},e.tickFormat=function(r,i){var a=t();return fie(a[0],a[a.length-1],r??10,i)},e.nice=function(r){r==null&&(r=10);var i=t(),a=0,l=i.length-1,d=i[a],s=i[l],p,x,w=10;for(s<d&&(x=d,d=s,s=x,x=a,a=l,l=x);w-- >0;){if(x=R5(d,s,r),x===p)return i[a]=d,i[l]=s,t(i);if(x>0)d=Math.floor(d/x)*x,s=Math.ceil(s/x)*x;else if(x<0)d=Math.ceil(d*x)/x,s=Math.floor(s*x)/x;else break;p=x}return e},e}function $k(){var e=KB();return e.copy=function(){return aS(e,$k())},Au.apply(e,arguments),lg(e)}function pie(e){var t;function r(i){return i==null||isNaN(i=+i)?t:i}return r.invert=r,r.domain=r.range=function(i){return arguments.length?(e=Array.from(i,Fk),r):e.slice()},r.unknown=function(i){return arguments.length?(t=i,r):t},r.copy=function(){return pie(e).unknown(t)},e=arguments.length?Array.from(e,Fk):[0,1],lg(r)}function gie(e,t){e=e.slice();var r=0,i=e.length-1,a=e[r],l=e[i],d;return l<a&&(d=r,r=i,i=d,d=a,a=l,l=d),e[r]=t.floor(a),e[i]=t.ceil(l),e}function pq(e){return Math.log(e)}function gq(e){return Math.exp(e)}function Aze(e){return-Math.log(-e)}function Tze(e){return-Math.exp(-e)}function kze(e){return isFinite(e)?+("1e"+e):e<0?0:e}function Pze(e){return e===10?kze:e===Math.E?Math.exp:t=>Math.pow(e,t)}function Eze(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function xq(e){return(t,r)=>-e(-t,r)}function XB(e){const t=e(pq,gq),r=t.domain;let i=10,a,l;function d(){return a=Eze(i),l=Pze(i),r()[0]<0?(a=xq(a),l=xq(l),e(Aze,Tze)):e(pq,gq),t}return t.base=function(s){return arguments.length?(i=+s,d()):i},t.domain=function(s){return arguments.length?(r(s),d()):r()},t.ticks=s=>{const p=r();let x=p[0],w=p[p.length-1];const j=w<x;j&&([x,w]=[w,x]);let S=a(x),P=a(w),F,L;const B=s==null?10:+s;let V=[];if(!(i%1)&&P-S<B){if(S=Math.floor(S),P=Math.ceil(P),x>0){for(;S<=P;++S)for(F=1;F<i;++F)if(L=S<0?F/l(-S):F*l(S),!(L<x)){if(L>w)break;V.push(L)}}else for(;S<=P;++S)for(F=i-1;F>=1;--F)if(L=S>0?F/l(-S):F*l(S),!(L<x)){if(L>w)break;V.push(L)}V.length*2<B&&(V=O5(x,w,B))}else V=O5(S,P,Math.min(P-S,B)).map(l);return j?V.reverse():V},t.tickFormat=(s,p)=>{if(s==null&&(s=10),p==null&&(p=i===10?"s":","),typeof p!="function"&&(!(i%1)&&(p=R2(p)).precision==null&&(p.trim=!0),p=YB(p)),s===1/0)return p;const x=Math.max(1,i*s/t.ticks().length);return w=>{let j=w/l(Math.round(a(w)));return j*i<i-.5&&(j*=i),j<=x?p(w):""}},t.nice=()=>r(gie(r(),{floor:s=>l(Math.floor(a(s))),ceil:s=>l(Math.ceil(a(s)))})),t}function xie(){const e=XB(xM()).domain([1,10]);return e.copy=()=>aS(e,xie()).base(e.base()),Au.apply(e,arguments),e}function yq(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function vq(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function JB(e){var t=1,r=e(yq(t),vq(t));return r.constant=function(i){return arguments.length?e(yq(t=+i),vq(t)):t},lg(r)}function yie(){var e=JB(xM());return e.copy=function(){return aS(e,yie()).constant(e.constant())},Au.apply(e,arguments)}function bq(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function Mze(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function Ize(e){return e<0?-e*e:e*e}function QB(e){var t=e(wl,wl),r=1;function i(){return r===1?e(wl,wl):r===.5?e(Mze,Ize):e(bq(r),bq(1/r))}return t.exponent=function(a){return arguments.length?(r=+a,i()):r},lg(t)}function e6(){var e=QB(xM());return e.copy=function(){return aS(e,e6()).exponent(e.exponent())},Au.apply(e,arguments),e}function Oze(){return e6.apply(null,arguments).exponent(.5)}function _q(e){return Math.sign(e)*e*e}function Rze(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function vie(){var e=KB(),t=[0,1],r=!1,i;function a(l){var d=Rze(e(l));return isNaN(d)?i:r?Math.round(d):d}return a.invert=function(l){return e.invert(_q(l))},a.domain=function(l){return arguments.length?(e.domain(l),a):e.domain()},a.range=function(l){return arguments.length?(e.range((t=Array.from(l,Fk)).map(_q)),a):t.slice()},a.rangeRound=function(l){return a.range(l).round(!0)},a.round=function(l){return arguments.length?(r=!!l,a):r},a.clamp=function(l){return arguments.length?(e.clamp(l),a):e.clamp()},a.unknown=function(l){return arguments.length?(i=l,a):i},a.copy=function(){return vie(e.domain(),t).round(r).clamp(e.clamp()).unknown(i)},Au.apply(a,arguments),lg(a)}function bie(){var e=[],t=[],r=[],i;function a(){var d=0,s=Math.max(1,t.length);for(r=new Array(s-1);++d<s;)r[d-1]=O5e(e,d/s);return l}function l(d){return d==null||isNaN(d=+d)?i:t[iS(r,d)]}return l.invertExtent=function(d){var s=t.indexOf(d);return s<0?[NaN,NaN]:[s>0?r[s-1]:e[0],s<r.length?r[s]:e[e.length-1]]},l.domain=function(d){if(!arguments.length)return e.slice();e=[];for(let s of d)s!=null&&!isNaN(s=+s)&&e.push(s);return e.sort(Rp),a()},l.range=function(d){return arguments.length?(t=Array.from(d),a()):t.slice()},l.unknown=function(d){return arguments.length?(i=d,l):i},l.quantiles=function(){return r.slice()},l.copy=function(){return bie().domain(e).range(t).unknown(i)},Au.apply(l,arguments)}function _ie(){var e=0,t=1,r=1,i=[.5],a=[0,1],l;function d(p){return p!=null&&p<=p?a[iS(i,p,0,r)]:l}function s(){var p=-1;for(i=new Array(r);++p<r;)i[p]=((p+1)*t-(p-r)*e)/(r+1);return d}return d.domain=function(p){return arguments.length?([e,t]=p,e=+e,t=+t,s()):[e,t]},d.range=function(p){return arguments.length?(r=(a=Array.from(p)).length-1,s()):a.slice()},d.invertExtent=function(p){var x=a.indexOf(p);return x<0?[NaN,NaN]:x<1?[e,i[0]]:x>=r?[i[r-1],t]:[i[x-1],i[x]]},d.unknown=function(p){return arguments.length&&(l=p),d},d.thresholds=function(){return i.slice()},d.copy=function(){return _ie().domain([e,t]).range(a).unknown(l)},Au.apply(lg(d),arguments)}function wie(){var e=[.5],t=[0,1],r,i=1;function a(l){return l!=null&&l<=l?t[iS(e,l,0,i)]:r}return a.domain=function(l){return arguments.length?(e=Array.from(l),i=Math.min(e.length,t.length-1),a):e.slice()},a.range=function(l){return arguments.length?(t=Array.from(l),i=Math.min(e.length,t.length-1),a):t.slice()},a.invertExtent=function(l){var d=t.indexOf(l);return[e[d-1],e[d]]},a.unknown=function(l){return arguments.length?(r=l,a):r},a.copy=function(){return wie().domain(e).range(t).unknown(r)},Au.apply(a,arguments)}const LO=new Date,FO=new Date;function so(e,t,r,i){function a(l){return e(l=arguments.length===0?new Date:new Date(+l)),l}return a.floor=l=>(e(l=new Date(+l)),l),a.ceil=l=>(e(l=new Date(l-1)),t(l,1),e(l),l),a.round=l=>{const d=a(l),s=a.ceil(l);return l-d<s-l?d:s},a.offset=(l,d)=>(t(l=new Date(+l),d==null?1:Math.floor(d)),l),a.range=(l,d,s)=>{const p=[];if(l=a.ceil(l),s=s==null?1:Math.floor(s),!(l<d)||!(s>0))return p;let x;do p.push(x=new Date(+l)),t(l,s),e(l);while(x<l&&l<d);return p},a.filter=l=>so(d=>{if(d>=d)for(;e(d),!l(d);)d.setTime(d-1)},(d,s)=>{if(d>=d)if(s<0)for(;++s<=0;)for(;t(d,-1),!l(d););else for(;--s>=0;)for(;t(d,1),!l(d););}),r&&(a.count=(l,d)=>(LO.setTime(+l),FO.setTime(+d),e(LO),e(FO),Math.floor(r(LO,FO))),a.every=l=>(l=Math.floor(l),!isFinite(l)||!(l>0)?null:l>1?a.filter(i?d=>i(d)%l===0:d=>a.count(0,d)%l===0):a)),a}const Vk=so(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);Vk.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?so(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):Vk);Vk.range;const pm=1e3,xu=pm*60,gm=xu*60,Em=gm*24,t6=Em*7,wq=Em*30,BO=Em*365,M0=so(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*pm)},(e,t)=>(t-e)/pm,e=>e.getUTCSeconds());M0.range;const r6=so(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*pm)},(e,t)=>{e.setTime(+e+t*xu)},(e,t)=>(t-e)/xu,e=>e.getMinutes());r6.range;const n6=so(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*xu)},(e,t)=>(t-e)/xu,e=>e.getUTCMinutes());n6.range;const i6=so(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*pm-e.getMinutes()*xu)},(e,t)=>{e.setTime(+e+t*gm)},(e,t)=>(t-e)/gm,e=>e.getHours());i6.range;const s6=so(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*gm)},(e,t)=>(t-e)/gm,e=>e.getUTCHours());s6.range;const oS=so(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*xu)/Em,e=>e.getDate()-1);oS.range;const yM=so(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Em,e=>e.getUTCDate()-1);yM.range;const jie=so(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Em,e=>Math.floor(e/Em));jie.range;function Sx(e){return so(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*xu)/t6)}const vM=Sx(0),Uk=Sx(1),Dze=Sx(2),zze=Sx(3),_b=Sx(4),Lze=Sx(5),Fze=Sx(6);vM.range;Uk.range;Dze.range;zze.range;_b.range;Lze.range;Fze.range;function Cx(e){return so(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/t6)}const bM=Cx(0),Gk=Cx(1),Bze=Cx(2),$ze=Cx(3),wb=Cx(4),Vze=Cx(5),Uze=Cx(6);bM.range;Gk.range;Bze.range;$ze.range;wb.range;Vze.range;Uze.range;const a6=so(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());a6.range;const o6=so(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());o6.range;const Mm=so(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Mm.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:so(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});Mm.range;const Im=so(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Im.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:so(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});Im.range;function Nie(e,t,r,i,a,l){const d=[[M0,1,pm],[M0,5,5*pm],[M0,15,15*pm],[M0,30,30*pm],[l,1,xu],[l,5,5*xu],[l,15,15*xu],[l,30,30*xu],[a,1,gm],[a,3,3*gm],[a,6,6*gm],[a,12,12*gm],[i,1,Em],[i,2,2*Em],[r,1,t6],[t,1,wq],[t,3,3*wq],[e,1,BO]];function s(x,w,j){const S=w<x;S&&([x,w]=[w,x]);const P=j&&typeof j.range=="function"?j:p(x,w,j),F=P?P.range(x,+w+1):[];return S?F.reverse():F}function p(x,w,j){const S=Math.abs(w-x)/j,P=UB(([,,B])=>B).right(d,S);if(P===d.length)return e.every(D5(x/BO,w/BO,j));if(P===0)return Vk.every(Math.max(D5(x,w,j),1));const[F,L]=d[S/d[P-1][2]<d[P][2]/S?P-1:P];return F.every(L)}return[s,p]}const[Gze,Hze]=Nie(Im,o6,bM,jie,s6,n6),[qze,Wze]=Nie(Mm,a6,vM,oS,i6,r6);function $O(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function VO(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Jw(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function Kze(e){var t=e.dateTime,r=e.date,i=e.time,a=e.periods,l=e.days,d=e.shortDays,s=e.months,p=e.shortMonths,x=Qw(a),w=ej(a),j=Qw(l),S=ej(l),P=Qw(d),F=ej(d),L=Qw(s),B=ej(s),V=Qw(p),$=ej(p),G={a:Ee,A:je,b:Ce,B:tt,c:null,d:Tq,e:Tq,f:xLe,g:ALe,G:kLe,H:fLe,I:pLe,j:gLe,L:Sie,m:yLe,M:vLe,p:it,q:mt,Q:Eq,s:Mq,S:bLe,u:_Le,U:wLe,V:jLe,w:NLe,W:SLe,x:null,X:null,y:CLe,Y:TLe,Z:PLe,"%":Pq},W={a:gt,A:qt,b:yr,B:tr,c:null,d:kq,e:kq,f:OLe,g:GLe,G:qLe,H:ELe,I:MLe,j:ILe,L:Aie,m:RLe,M:DLe,p:Ft,q:er,Q:Eq,s:Mq,S:zLe,u:LLe,U:FLe,V:BLe,w:$Le,W:VLe,x:null,X:null,y:ULe,Y:HLe,Z:WLe,"%":Pq},Z={a:we,A:xe,b:Ne,B:ze,c:ye,d:Cq,e:Cq,f:uLe,g:Sq,G:Nq,H:Aq,I:Aq,j:aLe,L:cLe,m:sLe,M:oLe,p:Pe,q:iLe,Q:hLe,s:mLe,S:lLe,u:Qze,U:eLe,V:tLe,w:Jze,W:rLe,x:ve,X:_e,y:Sq,Y:Nq,Z:nLe,"%":dLe};G.x=se(r,G),G.X=se(i,G),G.c=se(t,G),W.x=se(r,W),W.X=se(i,W),W.c=se(t,W);function se(Dt,ge){return function(sr){var St=[],jr=-1,dt=0,Yr=Dt.length,Vr,Yn,Ye;for(sr instanceof Date||(sr=new Date(+sr));++jr<Yr;)Dt.charCodeAt(jr)===37&&(St.push(Dt.slice(dt,jr)),(Yn=jq[Vr=Dt.charAt(++jr)])!=null?Vr=Dt.charAt(++jr):Yn=Vr==="e"?" ":"0",(Ye=ge[Vr])&&(Vr=Ye(sr,Yn)),St.push(Vr),dt=jr+1);return St.push(Dt.slice(dt,jr)),St.join("")}}function ae(Dt,ge){return function(sr){var St=Jw(1900,void 0,1),jr=ce(St,Dt,sr+="",0),dt,Yr;if(jr!=sr.length)return null;if("Q"in St)return new Date(St.Q);if("s"in St)return new Date(St.s*1e3+("L"in St?St.L:0));if(ge&&!("Z"in St)&&(St.Z=0),"p"in St&&(St.H=St.H%12+St.p*12),St.m===void 0&&(St.m="q"in St?St.q:0),"V"in St){if(St.V<1||St.V>53)return null;"w"in St||(St.w=1),"Z"in St?(dt=VO(Jw(St.y,0,1)),Yr=dt.getUTCDay(),dt=Yr>4||Yr===0?Gk.ceil(dt):Gk(dt),dt=yM.offset(dt,(St.V-1)*7),St.y=dt.getUTCFullYear(),St.m=dt.getUTCMonth(),St.d=dt.getUTCDate()+(St.w+6)%7):(dt=$O(Jw(St.y,0,1)),Yr=dt.getDay(),dt=Yr>4||Yr===0?Uk.ceil(dt):Uk(dt),dt=oS.offset(dt,(St.V-1)*7),St.y=dt.getFullYear(),St.m=dt.getMonth(),St.d=dt.getDate()+(St.w+6)%7)}else("W"in St||"U"in St)&&("w"in St||(St.w="u"in St?St.u%7:"W"in St?1:0),Yr="Z"in St?VO(Jw(St.y,0,1)).getUTCDay():$O(Jw(St.y,0,1)).getDay(),St.m=0,St.d="W"in St?(St.w+6)%7+St.W*7-(Yr+5)%7:St.w+St.U*7-(Yr+6)%7);return"Z"in St?(St.H+=St.Z/100|0,St.M+=St.Z%100,VO(St)):$O(St)}}function ce(Dt,ge,sr,St){for(var jr=0,dt=ge.length,Yr=sr.length,Vr,Yn;jr<dt;){if(St>=Yr)return-1;if(Vr=ge.charCodeAt(jr++),Vr===37){if(Vr=ge.charAt(jr++),Yn=Z[Vr in jq?ge.charAt(jr++):Vr],!Yn||(St=Yn(Dt,sr,St))<0)return-1}else if(Vr!=sr.charCodeAt(St++))return-1}return St}function Pe(Dt,ge,sr){var St=x.exec(ge.slice(sr));return St?(Dt.p=w.get(St[0].toLowerCase()),sr+St[0].length):-1}function we(Dt,ge,sr){var St=P.exec(ge.slice(sr));return St?(Dt.w=F.get(St[0].toLowerCase()),sr+St[0].length):-1}function xe(Dt,ge,sr){var St=j.exec(ge.slice(sr));return St?(Dt.w=S.get(St[0].toLowerCase()),sr+St[0].length):-1}function Ne(Dt,ge,sr){var St=V.exec(ge.slice(sr));return St?(Dt.m=$.get(St[0].toLowerCase()),sr+St[0].length):-1}function ze(Dt,ge,sr){var St=L.exec(ge.slice(sr));return St?(Dt.m=B.get(St[0].toLowerCase()),sr+St[0].length):-1}function ye(Dt,ge,sr){return ce(Dt,t,ge,sr)}function ve(Dt,ge,sr){return ce(Dt,r,ge,sr)}function _e(Dt,ge,sr){return ce(Dt,i,ge,sr)}function Ee(Dt){return d[Dt.getDay()]}function je(Dt){return l[Dt.getDay()]}function Ce(Dt){return p[Dt.getMonth()]}function tt(Dt){return s[Dt.getMonth()]}function it(Dt){return a[+(Dt.getHours()>=12)]}function mt(Dt){return 1+~~(Dt.getMonth()/3)}function gt(Dt){return d[Dt.getUTCDay()]}function qt(Dt){return l[Dt.getUTCDay()]}function yr(Dt){return p[Dt.getUTCMonth()]}function tr(Dt){return s[Dt.getUTCMonth()]}function Ft(Dt){return a[+(Dt.getUTCHours()>=12)]}function er(Dt){return 1+~~(Dt.getUTCMonth()/3)}return{format:function(Dt){var ge=se(Dt+="",G);return ge.toString=function(){return Dt},ge},parse:function(Dt){var ge=ae(Dt+="",!1);return ge.toString=function(){return Dt},ge},utcFormat:function(Dt){var ge=se(Dt+="",W);return ge.toString=function(){return Dt},ge},utcParse:function(Dt){var ge=ae(Dt+="",!0);return ge.toString=function(){return Dt},ge}}}var jq={"-":"",_:" ",0:"0"},go=/^\s*\d+/,Zze=/^%/,Yze=/[\\^$*+?|[\]().{}]/g;function Wi(e,t,r){var i=e<0?"-":"",a=(i?-e:e)+"",l=a.length;return i+(l<r?new Array(r-l+1).join(t)+a:a)}function Xze(e){return e.replace(Yze,"\\$&")}function Qw(e){return new RegExp("^(?:"+e.map(Xze).join("|")+")","i")}function ej(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function Jze(e,t,r){var i=go.exec(t.slice(r,r+1));return i?(e.w=+i[0],r+i[0].length):-1}function Qze(e,t,r){var i=go.exec(t.slice(r,r+1));return i?(e.u=+i[0],r+i[0].length):-1}function eLe(e,t,r){var i=go.exec(t.slice(r,r+2));return i?(e.U=+i[0],r+i[0].length):-1}function tLe(e,t,r){var i=go.exec(t.slice(r,r+2));return i?(e.V=+i[0],r+i[0].length):-1}function rLe(e,t,r){var i=go.exec(t.slice(r,r+2));return i?(e.W=+i[0],r+i[0].length):-1}function Nq(e,t,r){var i=go.exec(t.slice(r,r+4));return i?(e.y=+i[0],r+i[0].length):-1}function Sq(e,t,r){var i=go.exec(t.slice(r,r+2));return i?(e.y=+i[0]+(+i[0]>68?1900:2e3),r+i[0].length):-1}function nLe(e,t,r){var i=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return i?(e.Z=i[1]?0:-(i[2]+(i[3]||"00")),r+i[0].length):-1}function iLe(e,t,r){var i=go.exec(t.slice(r,r+1));return i?(e.q=i[0]*3-3,r+i[0].length):-1}function sLe(e,t,r){var i=go.exec(t.slice(r,r+2));return i?(e.m=i[0]-1,r+i[0].length):-1}function Cq(e,t,r){var i=go.exec(t.slice(r,r+2));return i?(e.d=+i[0],r+i[0].length):-1}function aLe(e,t,r){var i=go.exec(t.slice(r,r+3));return i?(e.m=0,e.d=+i[0],r+i[0].length):-1}function Aq(e,t,r){var i=go.exec(t.slice(r,r+2));return i?(e.H=+i[0],r+i[0].length):-1}function oLe(e,t,r){var i=go.exec(t.slice(r,r+2));return i?(e.M=+i[0],r+i[0].length):-1}function lLe(e,t,r){var i=go.exec(t.slice(r,r+2));return i?(e.S=+i[0],r+i[0].length):-1}function cLe(e,t,r){var i=go.exec(t.slice(r,r+3));return i?(e.L=+i[0],r+i[0].length):-1}function uLe(e,t,r){var i=go.exec(t.slice(r,r+6));return i?(e.L=Math.floor(i[0]/1e3),r+i[0].length):-1}function dLe(e,t,r){var i=Zze.exec(t.slice(r,r+1));return i?r+i[0].length:-1}function hLe(e,t,r){var i=go.exec(t.slice(r));return i?(e.Q=+i[0],r+i[0].length):-1}function mLe(e,t,r){var i=go.exec(t.slice(r));return i?(e.s=+i[0],r+i[0].length):-1}function Tq(e,t){return Wi(e.getDate(),t,2)}function fLe(e,t){return Wi(e.getHours(),t,2)}function pLe(e,t){return Wi(e.getHours()%12||12,t,2)}function gLe(e,t){return Wi(1+oS.count(Mm(e),e),t,3)}function Sie(e,t){return Wi(e.getMilliseconds(),t,3)}function xLe(e,t){return Sie(e,t)+"000"}function yLe(e,t){return Wi(e.getMonth()+1,t,2)}function vLe(e,t){return Wi(e.getMinutes(),t,2)}function bLe(e,t){return Wi(e.getSeconds(),t,2)}function _Le(e){var t=e.getDay();return t===0?7:t}function wLe(e,t){return Wi(vM.count(Mm(e)-1,e),t,2)}function Cie(e){var t=e.getDay();return t>=4||t===0?_b(e):_b.ceil(e)}function jLe(e,t){return e=Cie(e),Wi(_b.count(Mm(e),e)+(Mm(e).getDay()===4),t,2)}function NLe(e){return e.getDay()}function SLe(e,t){return Wi(Uk.count(Mm(e)-1,e),t,2)}function CLe(e,t){return Wi(e.getFullYear()%100,t,2)}function ALe(e,t){return e=Cie(e),Wi(e.getFullYear()%100,t,2)}function TLe(e,t){return Wi(e.getFullYear()%1e4,t,4)}function kLe(e,t){var r=e.getDay();return e=r>=4||r===0?_b(e):_b.ceil(e),Wi(e.getFullYear()%1e4,t,4)}function PLe(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Wi(t/60|0,"0",2)+Wi(t%60,"0",2)}function kq(e,t){return Wi(e.getUTCDate(),t,2)}function ELe(e,t){return Wi(e.getUTCHours(),t,2)}function MLe(e,t){return Wi(e.getUTCHours()%12||12,t,2)}function ILe(e,t){return Wi(1+yM.count(Im(e),e),t,3)}function Aie(e,t){return Wi(e.getUTCMilliseconds(),t,3)}function OLe(e,t){return Aie(e,t)+"000"}function RLe(e,t){return Wi(e.getUTCMonth()+1,t,2)}function DLe(e,t){return Wi(e.getUTCMinutes(),t,2)}function zLe(e,t){return Wi(e.getUTCSeconds(),t,2)}function LLe(e){var t=e.getUTCDay();return t===0?7:t}function FLe(e,t){return Wi(bM.count(Im(e)-1,e),t,2)}function Tie(e){var t=e.getUTCDay();return t>=4||t===0?wb(e):wb.ceil(e)}function BLe(e,t){return e=Tie(e),Wi(wb.count(Im(e),e)+(Im(e).getUTCDay()===4),t,2)}function $Le(e){return e.getUTCDay()}function VLe(e,t){return Wi(Gk.count(Im(e)-1,e),t,2)}function ULe(e,t){return Wi(e.getUTCFullYear()%100,t,2)}function GLe(e,t){return e=Tie(e),Wi(e.getUTCFullYear()%100,t,2)}function HLe(e,t){return Wi(e.getUTCFullYear()%1e4,t,4)}function qLe(e,t){var r=e.getUTCDay();return e=r>=4||r===0?wb(e):wb.ceil(e),Wi(e.getUTCFullYear()%1e4,t,4)}function WLe(){return"+0000"}function Pq(){return"%"}function Eq(e){return+e}function Mq(e){return Math.floor(+e/1e3)}var Wy,kie,Pie;KLe({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function KLe(e){return Wy=Kze(e),kie=Wy.format,Wy.parse,Pie=Wy.utcFormat,Wy.utcParse,Wy}function ZLe(e){return new Date(e)}function YLe(e){return e instanceof Date?+e:+new Date(+e)}function l6(e,t,r,i,a,l,d,s,p,x){var w=KB(),j=w.invert,S=w.domain,P=x(".%L"),F=x(":%S"),L=x("%I:%M"),B=x("%I %p"),V=x("%a %d"),$=x("%b %d"),G=x("%B"),W=x("%Y");function Z(se){return(p(se)<se?P:s(se)<se?F:d(se)<se?L:l(se)<se?B:i(se)<se?a(se)<se?V:$:r(se)<se?G:W)(se)}return w.invert=function(se){return new Date(j(se))},w.domain=function(se){return arguments.length?S(Array.from(se,YLe)):S().map(ZLe)},w.ticks=function(se){var ae=S();return e(ae[0],ae[ae.length-1],se??10)},w.tickFormat=function(se,ae){return ae==null?Z:x(ae)},w.nice=function(se){var ae=S();return(!se||typeof se.range!="function")&&(se=t(ae[0],ae[ae.length-1],se??10)),se?S(gie(ae,se)):w},w.copy=function(){return aS(w,l6(e,t,r,i,a,l,d,s,p,x))},w}function XLe(){return Au.apply(l6(qze,Wze,Mm,a6,vM,oS,i6,r6,M0,kie).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function JLe(){return Au.apply(l6(Gze,Hze,Im,o6,bM,yM,s6,n6,M0,Pie).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function _M(){var e=0,t=1,r,i,a,l,d=wl,s=!1,p;function x(j){return j==null||isNaN(j=+j)?p:d(a===0?.5:(j=(l(j)-r)*a,s?Math.max(0,Math.min(1,j)):j))}x.domain=function(j){return arguments.length?([e,t]=j,r=l(e=+e),i=l(t=+t),a=r===i?0:1/(i-r),x):[e,t]},x.clamp=function(j){return arguments.length?(s=!!j,x):s},x.interpolator=function(j){return arguments.length?(d=j,x):d};function w(j){return function(S){var P,F;return arguments.length?([P,F]=S,d=j(P,F),x):[d(0),d(1)]}}return x.range=w(jm),x.rangeRound=w(WB),x.unknown=function(j){return arguments.length?(p=j,x):p},function(j){return l=j,r=j(e),i=j(t),a=r===i?0:1/(i-r),x}}function cg(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function Eie(){var e=lg(_M()(wl));return e.copy=function(){return cg(e,Eie())},$m.apply(e,arguments)}function Mie(){var e=XB(_M()).domain([1,10]);return e.copy=function(){return cg(e,Mie()).base(e.base())},$m.apply(e,arguments)}function Iie(){var e=JB(_M());return e.copy=function(){return cg(e,Iie()).constant(e.constant())},$m.apply(e,arguments)}function c6(){var e=QB(_M());return e.copy=function(){return cg(e,c6()).exponent(e.exponent())},$m.apply(e,arguments)}function QLe(){return c6.apply(null,arguments).exponent(.5)}function Oie(){var e=[],t=wl;function r(i){if(i!=null&&!isNaN(i=+i))return t((iS(e,i,1)-1)/(e.length-1))}return r.domain=function(i){if(!arguments.length)return e.slice();e=[];for(let a of i)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(Rp),r},r.interpolator=function(i){return arguments.length?(t=i,r):t},r.range=function(){return e.map((i,a)=>t(a/(e.length-1)))},r.quantiles=function(i){return Array.from({length:i+1},(a,l)=>I5e(e,l/i))},r.copy=function(){return Oie(t).domain(e)},$m.apply(r,arguments)}function wM(){var e=0,t=.5,r=1,i=1,a,l,d,s,p,x=wl,w,j=!1,S;function P(L){return isNaN(L=+L)?S:(L=.5+((L=+w(L))-l)*(i*L<i*l?s:p),x(j?Math.max(0,Math.min(1,L)):L))}P.domain=function(L){return arguments.length?([e,t,r]=L,a=w(e=+e),l=w(t=+t),d=w(r=+r),s=a===l?0:.5/(l-a),p=l===d?0:.5/(d-l),i=l<a?-1:1,P):[e,t,r]},P.clamp=function(L){return arguments.length?(j=!!L,P):j},P.interpolator=function(L){return arguments.length?(x=L,P):x};function F(L){return function(B){var V,$,G;return arguments.length?([V,$,G]=B,x=dze(L,[V,$,G]),P):[x(0),x(.5),x(1)]}}return P.range=F(jm),P.rangeRound=F(WB),P.unknown=function(L){return arguments.length?(S=L,P):S},function(L){return w=L,a=L(e),l=L(t),d=L(r),s=a===l?0:.5/(l-a),p=l===d?0:.5/(d-l),i=l<a?-1:1,P}}function Rie(){var e=lg(wM()(wl));return e.copy=function(){return cg(e,Rie())},$m.apply(e,arguments)}function Die(){var e=XB(wM()).domain([.1,1,10]);return e.copy=function(){return cg(e,Die()).base(e.base())},$m.apply(e,arguments)}function zie(){var e=JB(wM());return e.copy=function(){return cg(e,zie()).constant(e.constant())},$m.apply(e,arguments)}function u6(){var e=QB(wM());return e.copy=function(){return cg(e,u6()).exponent(e.exponent())},$m.apply(e,arguments)}function eFe(){return u6.apply(null,arguments).exponent(.5)}const Iq=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:M2,scaleDiverging:Rie,scaleDivergingLog:Die,scaleDivergingPow:u6,scaleDivergingSqrt:eFe,scaleDivergingSymlog:zie,scaleIdentity:pie,scaleImplicit:z5,scaleLinear:$k,scaleLog:xie,scaleOrdinal:GB,scalePoint:Dj,scalePow:e6,scaleQuantile:bie,scaleQuantize:_ie,scaleRadial:vie,scaleSequential:Eie,scaleSequentialLog:Mie,scaleSequentialPow:c6,scaleSequentialQuantile:Oie,scaleSequentialSqrt:QLe,scaleSequentialSymlog:Iie,scaleSqrt:Oze,scaleSymlog:yie,scaleThreshold:wie,scaleTime:XLe,scaleUtc:JLe,tickFormat:fie},Symbol.toStringTag,{value:"Module"}));var tFe=w_;function rFe(e,t,r){for(var i=-1,a=e.length;++i<a;){var l=e[i],d=t(l);if(d!=null&&(s===void 0?d===d&&!tFe(d):r(d,s)))var s=d,p=l}return p}var jM=rFe;function nFe(e,t){return e>t}var Lie=nFe,iFe=jM,sFe=Lie,aFe=P_;function oFe(e){return e&&e.length?iFe(e,aFe,sFe):void 0}var lFe=oFe;const _p=Vi(lFe);function cFe(e,t){return e<t}var Fie=cFe,uFe=jM,dFe=Fie,hFe=P_;function mFe(e){return e&&e.length?uFe(e,hFe,dFe):void 0}var fFe=mFe;const NM=Vi(fFe);var pFe=SB,gFe=Ph,xFe=Gne,yFe=ac;function vFe(e,t){var r=yFe(e)?pFe:xFe;return r(e,gFe(t))}var bFe=vFe,_Fe=Vne,wFe=bFe;function jFe(e,t){return _Fe(wFe(e,t),1)}var NFe=jFe;const SFe=Vi(NFe);var CFe=FB;function AFe(e,t){return CFe(e,t)}var TFe=AFe;const Om=Vi(TFe);var E_=1e9,kFe={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},h6,Ks=!0,Su="[DecimalError] ",G0=Su+"Invalid argument: ",d6=Su+"Exponent out of range: ",M_=Math.floor,_0=Math.pow,PFe=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Sc,co=1e7,zs=7,Bie=9007199254740991,Hk=M_(Bie/zs),rn={};rn.absoluteValue=rn.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};rn.comparedTo=rn.cmp=function(e){var t,r,i,a,l=this;if(e=new l.constructor(e),l.s!==e.s)return l.s||-e.s;if(l.e!==e.e)return l.e>e.e^l.s<0?1:-1;for(i=l.d.length,a=e.d.length,t=0,r=i<a?i:a;t<r;++t)if(l.d[t]!==e.d[t])return l.d[t]>e.d[t]^l.s<0?1:-1;return i===a?0:i>a^l.s<0?1:-1};rn.decimalPlaces=rn.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*zs;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};rn.dividedBy=rn.div=function(e){return Nm(this,new this.constructor(e))};rn.dividedToIntegerBy=rn.idiv=function(e){var t=this,r=t.constructor;return vs(Nm(t,new r(e),0,1),r.precision)};rn.equals=rn.eq=function(e){return!this.cmp(e)};rn.exponent=function(){return Fa(this)};rn.greaterThan=rn.gt=function(e){return this.cmp(e)>0};rn.greaterThanOrEqualTo=rn.gte=function(e){return this.cmp(e)>=0};rn.isInteger=rn.isint=function(){return this.e>this.d.length-2};rn.isNegative=rn.isneg=function(){return this.s<0};rn.isPositive=rn.ispos=function(){return this.s>0};rn.isZero=function(){return this.s===0};rn.lessThan=rn.lt=function(e){return this.cmp(e)<0};rn.lessThanOrEqualTo=rn.lte=function(e){return this.cmp(e)<1};rn.logarithm=rn.log=function(e){var t,r=this,i=r.constructor,a=i.precision,l=a+5;if(e===void 0)e=new i(10);else if(e=new i(e),e.s<1||e.eq(Sc))throw Error(Su+"NaN");if(r.s<1)throw Error(Su+(r.s?"NaN":"-Infinity"));return r.eq(Sc)?new i(0):(Ks=!1,t=Nm(D2(r,l),D2(e,l),l),Ks=!0,vs(t,a))};rn.minus=rn.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?Uie(t,e):$ie(t,(e.s=-e.s,e))};rn.modulo=rn.mod=function(e){var t,r=this,i=r.constructor,a=i.precision;if(e=new i(e),!e.s)throw Error(Su+"NaN");return r.s?(Ks=!1,t=Nm(r,e,0,1).times(e),Ks=!0,r.minus(t)):vs(new i(r),a)};rn.naturalExponential=rn.exp=function(){return Vie(this)};rn.naturalLogarithm=rn.ln=function(){return D2(this)};rn.negated=rn.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};rn.plus=rn.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?$ie(t,e):Uie(t,(e.s=-e.s,e))};rn.precision=rn.sd=function(e){var t,r,i,a=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(G0+e);if(t=Fa(a)+1,i=a.d.length-1,r=i*zs+1,i=a.d[i],i){for(;i%10==0;i/=10)r--;for(i=a.d[0];i>=10;i/=10)r++}return e&&t>r?t:r};rn.squareRoot=rn.sqrt=function(){var e,t,r,i,a,l,d,s=this,p=s.constructor;if(s.s<1){if(!s.s)return new p(0);throw Error(Su+"NaN")}for(e=Fa(s),Ks=!1,a=Math.sqrt(+s),a==0||a==1/0?(t=nh(s.d),(t.length+e)%2==0&&(t+="0"),a=Math.sqrt(t),e=M_((e+1)/2)-(e<0||e%2),a==1/0?t="5e"+e:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),i=new p(t)):i=new p(a.toString()),r=p.precision,a=d=r+3;;)if(l=i,i=l.plus(Nm(s,l,d+2)).times(.5),nh(l.d).slice(0,d)===(t=nh(i.d)).slice(0,d)){if(t=t.slice(d-3,d+1),a==d&&t=="4999"){if(vs(l,r+1,0),l.times(l).eq(s)){i=l;break}}else if(t!="9999")break;d+=4}return Ks=!0,vs(i,r)};rn.times=rn.mul=function(e){var t,r,i,a,l,d,s,p,x,w=this,j=w.constructor,S=w.d,P=(e=new j(e)).d;if(!w.s||!e.s)return new j(0);for(e.s*=w.s,r=w.e+e.e,p=S.length,x=P.length,p<x&&(l=S,S=P,P=l,d=p,p=x,x=d),l=[],d=p+x,i=d;i--;)l.push(0);for(i=x;--i>=0;){for(t=0,a=p+i;a>i;)s=l[a]+P[i]*S[a-i-1]+t,l[a--]=s%co|0,t=s/co|0;l[a]=(l[a]+t)%co|0}for(;!l[--d];)l.pop();return t?++r:l.shift(),e.d=l,e.e=r,Ks?vs(e,j.precision):e};rn.toDecimalPlaces=rn.todp=function(e,t){var r=this,i=r.constructor;return r=new i(r),e===void 0?r:(vh(e,0,E_),t===void 0?t=i.rounding:vh(t,0,8),vs(r,e+Fa(r)+1,t))};rn.toExponential=function(e,t){var r,i=this,a=i.constructor;return e===void 0?r=ax(i,!0):(vh(e,0,E_),t===void 0?t=a.rounding:vh(t,0,8),i=vs(new a(i),e+1,t),r=ax(i,!0,e+1)),r};rn.toFixed=function(e,t){var r,i,a=this,l=a.constructor;return e===void 0?ax(a):(vh(e,0,E_),t===void 0?t=l.rounding:vh(t,0,8),i=vs(new l(a),e+Fa(a)+1,t),r=ax(i.abs(),!1,e+Fa(i)+1),a.isneg()&&!a.isZero()?"-"+r:r)};rn.toInteger=rn.toint=function(){var e=this,t=e.constructor;return vs(new t(e),Fa(e)+1,t.rounding)};rn.toNumber=function(){return+this};rn.toPower=rn.pow=function(e){var t,r,i,a,l,d,s=this,p=s.constructor,x=12,w=+(e=new p(e));if(!e.s)return new p(Sc);if(s=new p(s),!s.s){if(e.s<1)throw Error(Su+"Infinity");return s}if(s.eq(Sc))return s;if(i=p.precision,e.eq(Sc))return vs(s,i);if(t=e.e,r=e.d.length-1,d=t>=r,l=s.s,d){if((r=w<0?-w:w)<=Bie){for(a=new p(Sc),t=Math.ceil(i/zs+4),Ks=!1;r%2&&(a=a.times(s),Rq(a.d,t)),r=M_(r/2),r!==0;)s=s.times(s),Rq(s.d,t);return Ks=!0,e.s<0?new p(Sc).div(a):vs(a,i)}}else if(l<0)throw Error(Su+"NaN");return l=l<0&&e.d[Math.max(t,r)]&1?-1:1,s.s=1,Ks=!1,a=e.times(D2(s,i+x)),Ks=!0,a=Vie(a),a.s=l,a};rn.toPrecision=function(e,t){var r,i,a=this,l=a.constructor;return e===void 0?(r=Fa(a),i=ax(a,r<=l.toExpNeg||r>=l.toExpPos)):(vh(e,1,E_),t===void 0?t=l.rounding:vh(t,0,8),a=vs(new l(a),e,t),r=Fa(a),i=ax(a,e<=r||r<=l.toExpNeg,e)),i};rn.toSignificantDigits=rn.tosd=function(e,t){var r=this,i=r.constructor;return e===void 0?(e=i.precision,t=i.rounding):(vh(e,1,E_),t===void 0?t=i.rounding:vh(t,0,8)),vs(new i(r),e,t)};rn.toString=rn.valueOf=rn.val=rn.toJSON=rn[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=Fa(e),r=e.constructor;return ax(e,t<=r.toExpNeg||t>=r.toExpPos)};function $ie(e,t){var r,i,a,l,d,s,p,x,w=e.constructor,j=w.precision;if(!e.s||!t.s)return t.s||(t=new w(e)),Ks?vs(t,j):t;if(p=e.d,x=t.d,d=e.e,a=t.e,p=p.slice(),l=d-a,l){for(l<0?(i=p,l=-l,s=x.length):(i=x,a=d,s=p.length),d=Math.ceil(j/zs),s=d>s?d+1:s+1,l>s&&(l=s,i.length=1),i.reverse();l--;)i.push(0);i.reverse()}for(s=p.length,l=x.length,s-l<0&&(l=s,i=x,x=p,p=i),r=0;l;)r=(p[--l]=p[l]+x[l]+r)/co|0,p[l]%=co;for(r&&(p.unshift(r),++a),s=p.length;p[--s]==0;)p.pop();return t.d=p,t.e=a,Ks?vs(t,j):t}function vh(e,t,r){if(e!==~~e||e<t||e>r)throw Error(G0+e)}function nh(e){var t,r,i,a=e.length-1,l="",d=e[0];if(a>0){for(l+=d,t=1;t<a;t++)i=e[t]+"",r=zs-i.length,r&&(l+=np(r)),l+=i;d=e[t],i=d+"",r=zs-i.length,r&&(l+=np(r))}else if(d===0)return"0";for(;d%10===0;)d/=10;return l+d}var Nm=function(){function e(i,a){var l,d=0,s=i.length;for(i=i.slice();s--;)l=i[s]*a+d,i[s]=l%co|0,d=l/co|0;return d&&i.unshift(d),i}function t(i,a,l,d){var s,p;if(l!=d)p=l>d?1:-1;else for(s=p=0;s<l;s++)if(i[s]!=a[s]){p=i[s]>a[s]?1:-1;break}return p}function r(i,a,l){for(var d=0;l--;)i[l]-=d,d=i[l]<a[l]?1:0,i[l]=d*co+i[l]-a[l];for(;!i[0]&&i.length>1;)i.shift()}return function(i,a,l,d){var s,p,x,w,j,S,P,F,L,B,V,$,G,W,Z,se,ae,ce,Pe=i.constructor,we=i.s==a.s?1:-1,xe=i.d,Ne=a.d;if(!i.s)return new Pe(i);if(!a.s)throw Error(Su+"Division by zero");for(p=i.e-a.e,ae=Ne.length,Z=xe.length,P=new Pe(we),F=P.d=[],x=0;Ne[x]==(xe[x]||0);)++x;if(Ne[x]>(xe[x]||0)&&--p,l==null?$=l=Pe.precision:d?$=l+(Fa(i)-Fa(a))+1:$=l,$<0)return new Pe(0);if($=$/zs+2|0,x=0,ae==1)for(w=0,Ne=Ne[0],$++;(x<Z||w)&&$--;x++)G=w*co+(xe[x]||0),F[x]=G/Ne|0,w=G%Ne|0;else{for(w=co/(Ne[0]+1)|0,w>1&&(Ne=e(Ne,w),xe=e(xe,w),ae=Ne.length,Z=xe.length),W=ae,L=xe.slice(0,ae),B=L.length;B<ae;)L[B++]=0;ce=Ne.slice(),ce.unshift(0),se=Ne[0],Ne[1]>=co/2&&++se;do w=0,s=t(Ne,L,ae,B),s<0?(V=L[0],ae!=B&&(V=V*co+(L[1]||0)),w=V/se|0,w>1?(w>=co&&(w=co-1),j=e(Ne,w),S=j.length,B=L.length,s=t(j,L,S,B),s==1&&(w--,r(j,ae<S?ce:Ne,S))):(w==0&&(s=w=1),j=Ne.slice()),S=j.length,S<B&&j.unshift(0),r(L,j,B),s==-1&&(B=L.length,s=t(Ne,L,ae,B),s<1&&(w++,r(L,ae<B?ce:Ne,B))),B=L.length):s===0&&(w++,L=[0]),F[x++]=w,s&&L[0]?L[B++]=xe[W]||0:(L=[xe[W]],B=1);while((W++<Z||L[0]!==void 0)&&$--)}return F[0]||F.shift(),P.e=p,vs(P,d?l+Fa(P)+1:l)}}();function Vie(e,t){var r,i,a,l,d,s,p=0,x=0,w=e.constructor,j=w.precision;if(Fa(e)>16)throw Error(d6+Fa(e));if(!e.s)return new w(Sc);for(t==null?(Ks=!1,s=j):s=t,d=new w(.03125);e.abs().gte(.1);)e=e.times(d),x+=5;for(i=Math.log(_0(2,x))/Math.LN10*2+5|0,s+=i,r=a=l=new w(Sc),w.precision=s;;){if(a=vs(a.times(e),s),r=r.times(++p),d=l.plus(Nm(a,r,s)),nh(d.d).slice(0,s)===nh(l.d).slice(0,s)){for(;x--;)l=vs(l.times(l),s);return w.precision=j,t==null?(Ks=!0,vs(l,j)):l}l=d}}function Fa(e){for(var t=e.e*zs,r=e.d[0];r>=10;r/=10)t++;return t}function UO(e,t,r){if(t>e.LN10.sd())throw Ks=!0,r&&(e.precision=r),Error(Su+"LN10 precision limit exceeded");return vs(new e(e.LN10),t)}function np(e){for(var t="";e--;)t+="0";return t}function D2(e,t){var r,i,a,l,d,s,p,x,w,j=1,S=10,P=e,F=P.d,L=P.constructor,B=L.precision;if(P.s<1)throw Error(Su+(P.s?"NaN":"-Infinity"));if(P.eq(Sc))return new L(0);if(t==null?(Ks=!1,x=B):x=t,P.eq(10))return t==null&&(Ks=!0),UO(L,x);if(x+=S,L.precision=x,r=nh(F),i=r.charAt(0),l=Fa(P),Math.abs(l)<15e14){for(;i<7&&i!=1||i==1&&r.charAt(1)>3;)P=P.times(e),r=nh(P.d),i=r.charAt(0),j++;l=Fa(P),i>1?(P=new L("0."+r),l++):P=new L(i+"."+r.slice(1))}else return p=UO(L,x+2,B).times(l+""),P=D2(new L(i+"."+r.slice(1)),x-S).plus(p),L.precision=B,t==null?(Ks=!0,vs(P,B)):P;for(s=d=P=Nm(P.minus(Sc),P.plus(Sc),x),w=vs(P.times(P),x),a=3;;){if(d=vs(d.times(w),x),p=s.plus(Nm(d,new L(a),x)),nh(p.d).slice(0,x)===nh(s.d).slice(0,x))return s=s.times(2),l!==0&&(s=s.plus(UO(L,x+2,B).times(l+""))),s=Nm(s,new L(j),x),L.precision=B,t==null?(Ks=!0,vs(s,B)):s;s=p,a+=2}}function Oq(e,t){var r,i,a;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(i=t.search(/e/i))>0?(r<0&&(r=i),r+=+t.slice(i+1),t=t.substring(0,i)):r<0&&(r=t.length),i=0;t.charCodeAt(i)===48;)++i;for(a=t.length;t.charCodeAt(a-1)===48;)--a;if(t=t.slice(i,a),t){if(a-=i,r=r-i-1,e.e=M_(r/zs),e.d=[],i=(r+1)%zs,r<0&&(i+=zs),i<a){for(i&&e.d.push(+t.slice(0,i)),a-=zs;i<a;)e.d.push(+t.slice(i,i+=zs));t=t.slice(i),i=zs-t.length}else i-=a;for(;i--;)t+="0";if(e.d.push(+t),Ks&&(e.e>Hk||e.e<-Hk))throw Error(d6+r)}else e.s=0,e.e=0,e.d=[0];return e}function vs(e,t,r){var i,a,l,d,s,p,x,w,j=e.d;for(d=1,l=j[0];l>=10;l/=10)d++;if(i=t-d,i<0)i+=zs,a=t,x=j[w=0];else{if(w=Math.ceil((i+1)/zs),l=j.length,w>=l)return e;for(x=l=j[w],d=1;l>=10;l/=10)d++;i%=zs,a=i-zs+d}if(r!==void 0&&(l=_0(10,d-a-1),s=x/l%10|0,p=t<0||j[w+1]!==void 0||x%l,p=r<4?(s||p)&&(r==0||r==(e.s<0?3:2)):s>5||s==5&&(r==4||p||r==6&&(i>0?a>0?x/_0(10,d-a):0:j[w-1])%10&1||r==(e.s<0?8:7))),t<1||!j[0])return p?(l=Fa(e),j.length=1,t=t-l-1,j[0]=_0(10,(zs-t%zs)%zs),e.e=M_(-t/zs)||0):(j.length=1,j[0]=e.e=e.s=0),e;if(i==0?(j.length=w,l=1,w--):(j.length=w+1,l=_0(10,zs-i),j[w]=a>0?(x/_0(10,d-a)%_0(10,a)|0)*l:0),p)for(;;)if(w==0){(j[0]+=l)==co&&(j[0]=1,++e.e);break}else{if(j[w]+=l,j[w]!=co)break;j[w--]=0,l=1}for(i=j.length;j[--i]===0;)j.pop();if(Ks&&(e.e>Hk||e.e<-Hk))throw Error(d6+Fa(e));return e}function Uie(e,t){var r,i,a,l,d,s,p,x,w,j,S=e.constructor,P=S.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new S(e),Ks?vs(t,P):t;if(p=e.d,j=t.d,i=t.e,x=e.e,p=p.slice(),d=x-i,d){for(w=d<0,w?(r=p,d=-d,s=j.length):(r=j,i=x,s=p.length),a=Math.max(Math.ceil(P/zs),s)+2,d>a&&(d=a,r.length=1),r.reverse(),a=d;a--;)r.push(0);r.reverse()}else{for(a=p.length,s=j.length,w=a<s,w&&(s=a),a=0;a<s;a++)if(p[a]!=j[a]){w=p[a]<j[a];break}d=0}for(w&&(r=p,p=j,j=r,t.s=-t.s),s=p.length,a=j.length-s;a>0;--a)p[s++]=0;for(a=j.length;a>d;){if(p[--a]<j[a]){for(l=a;l&&p[--l]===0;)p[l]=co-1;--p[l],p[a]+=co}p[a]-=j[a]}for(;p[--s]===0;)p.pop();for(;p[0]===0;p.shift())--i;return p[0]?(t.d=p,t.e=i,Ks?vs(t,P):t):new S(0)}function ax(e,t,r){var i,a=Fa(e),l=nh(e.d),d=l.length;return t?(r&&(i=r-d)>0?l=l.charAt(0)+"."+l.slice(1)+np(i):d>1&&(l=l.charAt(0)+"."+l.slice(1)),l=l+(a<0?"e":"e+")+a):a<0?(l="0."+np(-a-1)+l,r&&(i=r-d)>0&&(l+=np(i))):a>=d?(l+=np(a+1-d),r&&(i=r-a-1)>0&&(l=l+"."+np(i))):((i=a+1)<d&&(l=l.slice(0,i)+"."+l.slice(i)),r&&(i=r-d)>0&&(a+1===d&&(l+="."),l+=np(i))),e.s<0?"-"+l:l}function Rq(e,t){if(e.length>t)return e.length=t,!0}function Gie(e){var t,r,i;function a(l){var d=this;if(!(d instanceof a))return new a(l);if(d.constructor=a,l instanceof a){d.s=l.s,d.e=l.e,d.d=(l=l.d)?l.slice():l;return}if(typeof l=="number"){if(l*0!==0)throw Error(G0+l);if(l>0)d.s=1;else if(l<0)l=-l,d.s=-1;else{d.s=0,d.e=0,d.d=[0];return}if(l===~~l&&l<1e7){d.e=0,d.d=[l];return}return Oq(d,l.toString())}else if(typeof l!="string")throw Error(G0+l);if(l.charCodeAt(0)===45?(l=l.slice(1),d.s=-1):d.s=1,PFe.test(l))Oq(d,l);else throw Error(G0+l)}if(a.prototype=rn,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=Gie,a.config=a.set=EFe,e===void 0&&(e={}),e)for(i=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<i.length;)e.hasOwnProperty(r=i[t++])||(e[r]=this[r]);return a.config(e),a}function EFe(e){if(!e||typeof e!="object")throw Error(Su+"Object expected");var t,r,i,a=["precision",1,E_,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<a.length;t+=3)if((i=e[r=a[t]])!==void 0)if(M_(i)===i&&i>=a[t+1]&&i<=a[t+2])this[r]=i;else throw Error(G0+r+": "+i);if((i=e[r="LN10"])!==void 0)if(i==Math.LN10)this[r]=new this(i);else throw Error(G0+r+": "+i);return this}var h6=Gie(kFe);Sc=new h6(1);const hs=h6;function MFe(e){return DFe(e)||RFe(e)||OFe(e)||IFe()}function IFe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function OFe(e,t){if(e){if(typeof e=="string")return V5(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return V5(e,t)}}function RFe(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function DFe(e){if(Array.isArray(e))return V5(e)}function V5(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}var zFe=function(t){return t},Hie={"@@functional/placeholder":!0},qie=function(t){return t===Hie},Dq=function(t){return function r(){return arguments.length===0||arguments.length===1&&qie(arguments.length<=0?void 0:arguments[0])?r:t.apply(void 0,arguments)}},LFe=function e(t,r){return t===1?r:Dq(function(){for(var i=arguments.length,a=new Array(i),l=0;l<i;l++)a[l]=arguments[l];var d=a.filter(function(s){return s!==Hie}).length;return d>=t?r.apply(void 0,a):e(t-d,Dq(function(){for(var s=arguments.length,p=new Array(s),x=0;x<s;x++)p[x]=arguments[x];var w=a.map(function(j){return qie(j)?p.shift():j});return r.apply(void 0,MFe(w).concat(p))}))})},SM=function(t){return LFe(t.length,t)},U5=function(t,r){for(var i=[],a=t;a<r;++a)i[a-t]=a;return i},FFe=SM(function(e,t){return Array.isArray(t)?t.map(e):Object.keys(t).map(function(r){return t[r]}).map(e)}),BFe=function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];if(!r.length)return zFe;var a=r.reverse(),l=a[0],d=a.slice(1);return function(){return d.reduce(function(s,p){return p(s)},l.apply(void 0,arguments))}},G5=function(t){return Array.isArray(t)?t.reverse():t.split("").reverse.join("")},Wie=function(t){var r=null,i=null;return function(){for(var a=arguments.length,l=new Array(a),d=0;d<a;d++)l[d]=arguments[d];return r&&l.every(function(s,p){return s===r[p]})||(r=l,i=t.apply(void 0,l)),i}};function $Fe(e){var t;return e===0?t=1:t=Math.floor(new hs(e).abs().log(10).toNumber())+1,t}function VFe(e,t,r){for(var i=new hs(e),a=0,l=[];i.lt(t)&&a<1e5;)l.push(i.toNumber()),i=i.add(r),a++;return l}var UFe=SM(function(e,t,r){var i=+e,a=+t;return i+r*(a-i)}),GFe=SM(function(e,t,r){var i=t-+e;return i=i||1/0,(r-e)/i}),HFe=SM(function(e,t,r){var i=t-+e;return i=i||1/0,Math.max(0,Math.min(1,(r-e)/i))});const CM={rangeStep:VFe,getDigitCount:$Fe,interpolateNumber:UFe,uninterpolateNumber:GFe,uninterpolateTruncation:HFe};function H5(e){return KFe(e)||WFe(e)||Kie(e)||qFe()}function qFe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function WFe(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function KFe(e){if(Array.isArray(e))return q5(e)}function z2(e,t){return XFe(e)||YFe(e,t)||Kie(e,t)||ZFe()}function ZFe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Kie(e,t){if(e){if(typeof e=="string")return q5(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return q5(e,t)}}function q5(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function YFe(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var r=[],i=!0,a=!1,l=void 0;try{for(var d=e[Symbol.iterator](),s;!(i=(s=d.next()).done)&&(r.push(s.value),!(t&&r.length===t));i=!0);}catch(p){a=!0,l=p}finally{try{!i&&d.return!=null&&d.return()}finally{if(a)throw l}}return r}}function XFe(e){if(Array.isArray(e))return e}function Zie(e){var t=z2(e,2),r=t[0],i=t[1],a=r,l=i;return r>i&&(a=i,l=r),[a,l]}function Yie(e,t,r){if(e.lte(0))return new hs(0);var i=CM.getDigitCount(e.toNumber()),a=new hs(10).pow(i),l=e.div(a),d=i!==1?.05:.1,s=new hs(Math.ceil(l.div(d).toNumber())).add(r).mul(d),p=s.mul(a);return t?p:new hs(Math.ceil(p))}function JFe(e,t,r){var i=1,a=new hs(e);if(!a.isint()&&r){var l=Math.abs(e);l<1?(i=new hs(10).pow(CM.getDigitCount(e)-1),a=new hs(Math.floor(a.div(i).toNumber())).mul(i)):l>1&&(a=new hs(Math.floor(e)))}else e===0?a=new hs(Math.floor((t-1)/2)):r||(a=new hs(Math.floor(e)));var d=Math.floor((t-1)/2),s=BFe(FFe(function(p){return a.add(new hs(p-d).mul(i)).toNumber()}),U5);return s(0,t)}function Xie(e,t,r,i){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((t-e)/(r-1)))return{step:new hs(0),tickMin:new hs(0),tickMax:new hs(0)};var l=Yie(new hs(t).sub(e).div(r-1),i,a),d;e<=0&&t>=0?d=new hs(0):(d=new hs(e).add(t).div(2),d=d.sub(new hs(d).mod(l)));var s=Math.ceil(d.sub(e).div(l).toNumber()),p=Math.ceil(new hs(t).sub(d).div(l).toNumber()),x=s+p+1;return x>r?Xie(e,t,r,i,a+1):(x<r&&(p=t>0?p+(r-x):p,s=t>0?s:s+(r-x)),{step:l,tickMin:d.sub(new hs(s).mul(l)),tickMax:d.add(new hs(p).mul(l))})}function QFe(e){var t=z2(e,2),r=t[0],i=t[1],a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,d=Math.max(a,2),s=Zie([r,i]),p=z2(s,2),x=p[0],w=p[1];if(x===-1/0||w===1/0){var j=w===1/0?[x].concat(H5(U5(0,a-1).map(function(){return 1/0}))):[].concat(H5(U5(0,a-1).map(function(){return-1/0})),[w]);return r>i?G5(j):j}if(x===w)return JFe(x,a,l);var S=Xie(x,w,d,l),P=S.step,F=S.tickMin,L=S.tickMax,B=CM.rangeStep(F,L.add(new hs(.1).mul(P)),P);return r>i?G5(B):B}function eBe(e,t){var r=z2(e,2),i=r[0],a=r[1],l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,d=Zie([i,a]),s=z2(d,2),p=s[0],x=s[1];if(p===-1/0||x===1/0)return[i,a];if(p===x)return[p];var w=Math.max(t,2),j=Yie(new hs(x).sub(p).div(w-1),l,0),S=[].concat(H5(CM.rangeStep(new hs(p),new hs(x).sub(new hs(.99).mul(j)),j)),[x]);return i>a?G5(S):S}var tBe=Wie(QFe),rBe=Wie(eBe),nBe="Invariant failed";function ox(e,t){throw new Error(nBe)}var iBe=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function jb(e){"@babel/helpers - typeof";return jb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jb(e)}function qk(){return qk=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},qk.apply(this,arguments)}function sBe(e,t){return cBe(e)||lBe(e,t)||oBe(e,t)||aBe()}function aBe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function oBe(e,t){if(e){if(typeof e=="string")return zq(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return zq(e,t)}}function zq(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function lBe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var i,a,l,d,s=[],p=!0,x=!1;try{if(l=(r=r.call(e)).next,t!==0)for(;!(p=(i=l.call(r)).done)&&(s.push(i.value),s.length!==t);p=!0);}catch(w){x=!0,a=w}finally{try{if(!p&&r.return!=null&&(d=r.return(),Object(d)!==d))return}finally{if(x)throw a}}return s}}function cBe(e){if(Array.isArray(e))return e}function uBe(e,t){if(e==null)return{};var r=dBe(e,t),i,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)i=l[a],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}function dBe(e,t){if(e==null)return{};var r={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;r[i]=e[i]}return r}function hBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mBe(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,ese(i.key),i)}}function fBe(e,t,r){return t&&mBe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function pBe(e,t,r){return t=Wk(t),gBe(e,Jie()?Reflect.construct(t,r||[],Wk(e).constructor):t.apply(e,r))}function gBe(e,t){if(t&&(jb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return xBe(e)}function xBe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Jie(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Jie=function(){return!!e})()}function Wk(e){return Wk=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Wk(e)}function yBe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&W5(e,t)}function W5(e,t){return W5=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,a){return i.__proto__=a,i},W5(e,t)}function Qie(e,t,r){return t=ese(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ese(e){var t=vBe(e,"string");return jb(t)=="symbol"?t:t+""}function vBe(e,t){if(jb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(jb(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var I_=function(e){function t(){return hBe(this,t),pBe(this,t,arguments)}return yBe(t,e),fBe(t,[{key:"render",value:function(){var i=this.props,a=i.offset,l=i.layout,d=i.width,s=i.dataKey,p=i.data,x=i.dataPointFormatter,w=i.xAxis,j=i.yAxis,S=uBe(i,iBe),P=en(S,!1);this.props.direction==="x"&&w.type!=="number"&&ox();var F=p.map(function(L){var B=x(L,s),V=B.x,$=B.y,G=B.value,W=B.errorVal;if(!W)return null;var Z=[],se,ae;if(Array.isArray(W)){var ce=sBe(W,2);se=ce[0],ae=ce[1]}else se=ae=W;if(l==="vertical"){var Pe=w.scale,we=$+a,xe=we+d,Ne=we-d,ze=Pe(G-se),ye=Pe(G+ae);Z.push({x1:ye,y1:xe,x2:ye,y2:Ne}),Z.push({x1:ze,y1:we,x2:ye,y2:we}),Z.push({x1:ze,y1:xe,x2:ze,y2:Ne})}else if(l==="horizontal"){var ve=j.scale,_e=V+a,Ee=_e-d,je=_e+d,Ce=ve(G-se),tt=ve(G+ae);Z.push({x1:Ee,y1:tt,x2:je,y2:tt}),Z.push({x1:_e,y1:Ce,x2:_e,y2:tt}),Z.push({x1:Ee,y1:Ce,x2:je,y2:Ce})}return ke.createElement(Qn,qk({className:"recharts-errorBar",key:"bar-".concat(Z.map(function(it){return"".concat(it.x1,"-").concat(it.x2,"-").concat(it.y1,"-").concat(it.y2)}))},P),Z.map(function(it){return ke.createElement("line",qk({},it,{key:"line-".concat(it.x1,"-").concat(it.x2,"-").concat(it.y1,"-").concat(it.y2)}))}))});return ke.createElement(Qn,{className:"recharts-errorBars"},F)}}])}(ke.Component);Qie(I_,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});Qie(I_,"displayName","ErrorBar");function L2(e){"@babel/helpers - typeof";return L2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},L2(e)}function Lq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,i)}return r}function d0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Lq(Object(r),!0).forEach(function(i){bBe(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Lq(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function bBe(e,t,r){return t=_Be(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _Be(e){var t=wBe(e,"string");return L2(t)=="symbol"?t:t+""}function wBe(e,t){if(L2(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(L2(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var tse=function(t){var r=t.children,i=t.formattedGraphicalItems,a=t.legendWidth,l=t.legendContent,d=jc(r,xa);if(!d)return null;var s=xa.defaultProps,p=s!==void 0?d0(d0({},s),d.props):{},x;return d.props&&d.props.payload?x=d.props&&d.props.payload:l==="children"?x=(i||[]).reduce(function(w,j){var S=j.item,P=j.props,F=P.sectors||P.data||[];return w.concat(F.map(function(L){return{type:d.props.iconType||S.props.legendType,value:L.name,color:L.fill,payload:L}}))},[]):x=(i||[]).map(function(w){var j=w.item,S=j.type.defaultProps,P=S!==void 0?d0(d0({},S),j.props):{},F=P.dataKey,L=P.name,B=P.legendType,V=P.hide;return{inactive:V,dataKey:F,type:p.iconType||B||"square",color:m6(j),value:L||F,payload:P}}),d0(d0(d0({},p),xa.getWithHeight(d,a)),{},{payload:x,item:d})};function F2(e){"@babel/helpers - typeof";return F2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},F2(e)}function Fq(e){return CBe(e)||SBe(e)||NBe(e)||jBe()}function jBe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function NBe(e,t){if(e){if(typeof e=="string")return K5(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return K5(e,t)}}function SBe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function CBe(e){if(Array.isArray(e))return K5(e)}function K5(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function Bq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,i)}return r}function pa(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Bq(Object(r),!0).forEach(function(i){Bv(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Bq(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function Bv(e,t,r){return t=ABe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ABe(e){var t=TBe(e,"string");return F2(t)=="symbol"?t:t+""}function TBe(e,t){if(F2(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(F2(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ys(e,t,r){return Tn(e)||Tn(t)?r:Qa(t)?Rc(e,t,r):Cn(t)?t(e):r}function zj(e,t,r,i){var a=SFe(e,function(s){return ys(s,t)});if(r==="number"){var l=a.filter(function(s){return kr(s)||parseFloat(s)});return l.length?[NM(l),_p(l)]:[1/0,-1/0]}var d=i?a.filter(function(s){return!Tn(s)}):a;return d.map(function(s){return Qa(s)||s instanceof Date?s:""})}var kBe=function(t){var r,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],a=arguments.length>2?arguments[2]:void 0,l=arguments.length>3?arguments[3]:void 0,d=-1,s=(r=i==null?void 0:i.length)!==null&&r!==void 0?r:0;if(s<=1)return 0;if(l&&l.axisType==="angleAxis"&&Math.abs(Math.abs(l.range[1]-l.range[0])-360)<=1e-6)for(var p=l.range,x=0;x<s;x++){var w=x>0?a[x-1].coordinate:a[s-1].coordinate,j=a[x].coordinate,S=x>=s-1?a[0].coordinate:a[x+1].coordinate,P=void 0;if(bl(j-w)!==bl(S-j)){var F=[];if(bl(S-j)===bl(p[1]-p[0])){P=S;var L=j+p[1]-p[0];F[0]=Math.min(L,(L+w)/2),F[1]=Math.max(L,(L+w)/2)}else{P=w;var B=S+p[1]-p[0];F[0]=Math.min(j,(B+j)/2),F[1]=Math.max(j,(B+j)/2)}var V=[Math.min(j,(P+j)/2),Math.max(j,(P+j)/2)];if(t>V[0]&&t<=V[1]||t>=F[0]&&t<=F[1]){d=a[x].index;break}}else{var $=Math.min(w,S),G=Math.max(w,S);if(t>($+j)/2&&t<=(G+j)/2){d=a[x].index;break}}}else for(var W=0;W<s;W++)if(W===0&&t<=(i[W].coordinate+i[W+1].coordinate)/2||W>0&&W<s-1&&t>(i[W].coordinate+i[W-1].coordinate)/2&&t<=(i[W].coordinate+i[W+1].coordinate)/2||W===s-1&&t>(i[W].coordinate+i[W-1].coordinate)/2){d=i[W].index;break}return d},m6=function(t){var r,i=t,a=i.type.displayName,l=(r=t.type)!==null&&r!==void 0&&r.defaultProps?pa(pa({},t.type.defaultProps),t.props):t.props,d=l.stroke,s=l.fill,p;switch(a){case"Line":p=d;break;case"Area":case"Radar":p=d&&d!=="none"?d:s;break;default:p=s;break}return p},PBe=function(t){var r=t.barSize,i=t.totalSize,a=t.stackGroups,l=a===void 0?{}:a;if(!l)return{};for(var d={},s=Object.keys(l),p=0,x=s.length;p<x;p++)for(var w=l[s[p]].stackGroups,j=Object.keys(w),S=0,P=j.length;S<P;S++){var F=w[j[S]],L=F.items,B=F.cateAxisId,V=L.filter(function(ae){return wm(ae.type).indexOf("Bar")>=0});if(V&&V.length){var $=V[0].type.defaultProps,G=$!==void 0?pa(pa({},$),V[0].props):V[0].props,W=G.barSize,Z=G[B];d[Z]||(d[Z]=[]);var se=Tn(W)?r:W;d[Z].push({item:V[0],stackList:V.slice(1),barSize:Tn(se)?void 0:_l(se,i,0)})}}return d},EBe=function(t){var r=t.barGap,i=t.barCategoryGap,a=t.bandSize,l=t.sizeList,d=l===void 0?[]:l,s=t.maxBarSize,p=d.length;if(p<1)return null;var x=_l(r,a,0,!0),w,j=[];if(d[0].barSize===+d[0].barSize){var S=!1,P=a/p,F=d.reduce(function(W,Z){return W+Z.barSize||0},0);F+=(p-1)*x,F>=a&&(F-=(p-1)*x,x=0),F>=a&&P>0&&(S=!0,P*=.9,F=p*P);var L=(a-F)/2>>0,B={offset:L-x,size:0};w=d.reduce(function(W,Z){var se={item:Z.item,position:{offset:B.offset+B.size+x,size:S?P:Z.barSize}},ae=[].concat(Fq(W),[se]);return B=ae[ae.length-1].position,Z.stackList&&Z.stackList.length&&Z.stackList.forEach(function(ce){ae.push({item:ce,position:B})}),ae},j)}else{var V=_l(i,a,0,!0);a-2*V-(p-1)*x<=0&&(x=0);var $=(a-2*V-(p-1)*x)/p;$>1&&($>>=0);var G=s===+s?Math.min($,s):$;w=d.reduce(function(W,Z,se){var ae=[].concat(Fq(W),[{item:Z.item,position:{offset:V+($+x)*se+($-G)/2,size:G}}]);return Z.stackList&&Z.stackList.length&&Z.stackList.forEach(function(ce){ae.push({item:ce,position:ae[ae.length-1].position})}),ae},j)}return w},MBe=function(t,r,i,a){var l=i.children,d=i.width,s=i.margin,p=d-(s.left||0)-(s.right||0),x=tse({children:l,legendWidth:p});if(x){var w=a||{},j=w.width,S=w.height,P=x.align,F=x.verticalAlign,L=x.layout;if((L==="vertical"||L==="horizontal"&&F==="middle")&&P!=="center"&&kr(t[P]))return pa(pa({},t),{},Bv({},P,t[P]+(j||0)));if((L==="horizontal"||L==="vertical"&&P==="center")&&F!=="middle"&&kr(t[F]))return pa(pa({},t),{},Bv({},F,t[F]+(S||0)))}return t},IBe=function(t,r,i){return Tn(r)?!0:t==="horizontal"?r==="yAxis":t==="vertical"||i==="x"?r==="xAxis":i==="y"?r==="yAxis":!0},rse=function(t,r,i,a,l){var d=r.props.children,s=Sl(d,I_).filter(function(x){return IBe(a,l,x.props.direction)});if(s&&s.length){var p=s.map(function(x){return x.props.dataKey});return t.reduce(function(x,w){var j=ys(w,i);if(Tn(j))return x;var S=Array.isArray(j)?[NM(j),_p(j)]:[j,j],P=p.reduce(function(F,L){var B=ys(w,L,0),V=S[0]-Math.abs(Array.isArray(B)?B[0]:B),$=S[1]+Math.abs(Array.isArray(B)?B[1]:B);return[Math.min(V,F[0]),Math.max($,F[1])]},[1/0,-1/0]);return[Math.min(P[0],x[0]),Math.max(P[1],x[1])]},[1/0,-1/0])}return null},OBe=function(t,r,i,a,l){var d=r.map(function(s){return rse(t,s,i,l,a)}).filter(function(s){return!Tn(s)});return d&&d.length?d.reduce(function(s,p){return[Math.min(s[0],p[0]),Math.max(s[1],p[1])]},[1/0,-1/0]):null},nse=function(t,r,i,a,l){var d=r.map(function(p){var x=p.props.dataKey;return i==="number"&&x&&rse(t,p,x,a)||zj(t,x,i,l)});if(i==="number")return d.reduce(function(p,x){return[Math.min(p[0],x[0]),Math.max(p[1],x[1])]},[1/0,-1/0]);var s={};return d.reduce(function(p,x){for(var w=0,j=x.length;w<j;w++)s[x[w]]||(s[x[w]]=!0,p.push(x[w]));return p},[])},ise=function(t,r){return t==="horizontal"&&r==="xAxis"||t==="vertical"&&r==="yAxis"||t==="centric"&&r==="angleAxis"||t==="radial"&&r==="radiusAxis"},sse=function(t,r,i,a){if(a)return t.map(function(p){return p.coordinate});var l,d,s=t.map(function(p){return p.coordinate===r&&(l=!0),p.coordinate===i&&(d=!0),p.coordinate});return l||s.push(r),d||s.push(i),s},xm=function(t,r,i){if(!t)return null;var a=t.scale,l=t.duplicateDomain,d=t.type,s=t.range,p=t.realScaleType==="scaleBand"?a.bandwidth()/2:2,x=(r||i)&&d==="category"&&a.bandwidth?a.bandwidth()/p:0;if(x=t.axisType==="angleAxis"&&(s==null?void 0:s.length)>=2?bl(s[0]-s[1])*2*x:x,r&&(t.ticks||t.niceTicks)){var w=(t.ticks||t.niceTicks).map(function(j){var S=l?l.indexOf(j):j;return{coordinate:a(S)+x,value:j,offset:x}});return w.filter(function(j){return!A_(j.coordinate)})}return t.isCategorical&&t.categoricalDomain?t.categoricalDomain.map(function(j,S){return{coordinate:a(j)+x,value:j,index:S,offset:x}}):a.ticks&&!i?a.ticks(t.tickCount).map(function(j){return{coordinate:a(j)+x,value:j,offset:x}}):a.domain().map(function(j,S){return{coordinate:a(j)+x,value:l?l[j]:j,index:S,offset:x}})},GO=new WeakMap,ZA=function(t,r){if(typeof r!="function")return t;GO.has(t)||GO.set(t,new WeakMap);var i=GO.get(t);if(i.has(r))return i.get(r);var a=function(){t.apply(void 0,arguments),r.apply(void 0,arguments)};return i.set(r,a),a},ase=function(t,r,i){var a=t.scale,l=t.type,d=t.layout,s=t.axisType;if(a==="auto")return d==="radial"&&s==="radiusAxis"?{scale:M2(),realScaleType:"band"}:d==="radial"&&s==="angleAxis"?{scale:$k(),realScaleType:"linear"}:l==="category"&&r&&(r.indexOf("LineChart")>=0||r.indexOf("AreaChart")>=0||r.indexOf("ComposedChart")>=0&&!i)?{scale:Dj(),realScaleType:"point"}:l==="category"?{scale:M2(),realScaleType:"band"}:{scale:$k(),realScaleType:"linear"};if(rS(a)){var p="scale".concat(cM(a));return{scale:(Iq[p]||Dj)(),realScaleType:Iq[p]?p:"point"}}return Cn(a)?{scale:a}:{scale:Dj(),realScaleType:"point"}},$q=1e-4,ose=function(t){var r=t.domain();if(!(!r||r.length<=2)){var i=r.length,a=t.range(),l=Math.min(a[0],a[1])-$q,d=Math.max(a[0],a[1])+$q,s=t(r[0]),p=t(r[i-1]);(s<l||s>d||p<l||p>d)&&t.domain([r[0],r[i-1]])}},RBe=function(t,r){if(!t)return null;for(var i=0,a=t.length;i<a;i++)if(t[i].item===r)return t[i].position;return null},DBe=function(t,r){if(!r||r.length!==2||!kr(r[0])||!kr(r[1]))return t;var i=Math.min(r[0],r[1]),a=Math.max(r[0],r[1]),l=[t[0],t[1]];return(!kr(t[0])||t[0]<i)&&(l[0]=i),(!kr(t[1])||t[1]>a)&&(l[1]=a),l[0]>a&&(l[0]=a),l[1]<i&&(l[1]=i),l},zBe=function(t){var r=t.length;if(!(r<=0))for(var i=0,a=t[0].length;i<a;++i)for(var l=0,d=0,s=0;s<r;++s){var p=A_(t[s][i][1])?t[s][i][0]:t[s][i][1];p>=0?(t[s][i][0]=l,t[s][i][1]=l+p,l=t[s][i][1]):(t[s][i][0]=d,t[s][i][1]=d+p,d=t[s][i][1])}},LBe=function(t){var r=t.length;if(!(r<=0))for(var i=0,a=t[0].length;i<a;++i)for(var l=0,d=0;d<r;++d){var s=A_(t[d][i][1])?t[d][i][0]:t[d][i][1];s>=0?(t[d][i][0]=l,t[d][i][1]=l+s,l=t[d][i][1]):(t[d][i][0]=0,t[d][i][1]=0)}},FBe={sign:zBe,expand:Jke,none:pb,silhouette:Qke,wiggle:ePe,positive:LBe},BBe=function(t,r,i){var a=r.map(function(s){return s.props.dataKey}),l=FBe[i],d=Xke().keys(a).value(function(s,p){return+ys(s,p,0)}).order(y5).offset(l);return d(t)},$Be=function(t,r,i,a,l,d){if(!t)return null;var s=d?r.reverse():r,p={},x=s.reduce(function(j,S){var P,F=(P=S.type)!==null&&P!==void 0&&P.defaultProps?pa(pa({},S.type.defaultProps),S.props):S.props,L=F.stackId,B=F.hide;if(B)return j;var V=F[i],$=j[V]||{hasStack:!1,stackGroups:{}};if(Qa(L)){var G=$.stackGroups[L]||{numericAxisId:i,cateAxisId:a,items:[]};G.items.push(S),$.hasStack=!0,$.stackGroups[L]=G}else $.stackGroups[og("_stackId_")]={numericAxisId:i,cateAxisId:a,items:[S]};return pa(pa({},j),{},Bv({},V,$))},p),w={};return Object.keys(x).reduce(function(j,S){var P=x[S];if(P.hasStack){var F={};P.stackGroups=Object.keys(P.stackGroups).reduce(function(L,B){var V=P.stackGroups[B];return pa(pa({},L),{},Bv({},B,{numericAxisId:i,cateAxisId:a,items:V.items,stackedData:BBe(t,V.items,l)}))},F)}return pa(pa({},j),{},Bv({},S,P))},w)},lse=function(t,r){var i=r.realScaleType,a=r.type,l=r.tickCount,d=r.originalDomain,s=r.allowDecimals,p=i||r.scale;if(p!=="auto"&&p!=="linear")return null;if(l&&a==="number"&&d&&(d[0]==="auto"||d[1]==="auto")){var x=t.domain();if(!x.length)return null;var w=tBe(x,l,s);return t.domain([NM(w),_p(w)]),{niceTicks:w}}if(l&&a==="number"){var j=t.domain(),S=rBe(j,l,s);return{niceTicks:S}}return null};function Nb(e){var t=e.axis,r=e.ticks,i=e.bandSize,a=e.entry,l=e.index,d=e.dataKey;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!Tn(a[t.dataKey])){var s=bk(r,"value",a[t.dataKey]);if(s)return s.coordinate+i/2}return r[l]?r[l].coordinate+i/2:null}var p=ys(a,Tn(d)?t.dataKey:d);return Tn(p)?null:t.scale(p)}var Vq=function(t){var r=t.axis,i=t.ticks,a=t.offset,l=t.bandSize,d=t.entry,s=t.index;if(r.type==="category")return i[s]?i[s].coordinate+a:null;var p=ys(d,r.dataKey,r.domain[s]);return Tn(p)?null:r.scale(p)-l/2+a},VBe=function(t){var r=t.numericAxis,i=r.scale.domain();if(r.type==="number"){var a=Math.min(i[0],i[1]),l=Math.max(i[0],i[1]);return a<=0&&l>=0?0:l<0?l:a}return i[0]},UBe=function(t,r){var i,a=(i=t.type)!==null&&i!==void 0&&i.defaultProps?pa(pa({},t.type.defaultProps),t.props):t.props,l=a.stackId;if(Qa(l)){var d=r[l];if(d){var s=d.items.indexOf(t);return s>=0?d.stackedData[s]:null}}return null},GBe=function(t){return t.reduce(function(r,i){return[NM(i.concat([r[0]]).filter(kr)),_p(i.concat([r[1]]).filter(kr))]},[1/0,-1/0])},cse=function(t,r,i){return Object.keys(t).reduce(function(a,l){var d=t[l],s=d.stackedData,p=s.reduce(function(x,w){var j=GBe(w.slice(r,i+1));return[Math.min(x[0],j[0]),Math.max(x[1],j[1])]},[1/0,-1/0]);return[Math.min(p[0],a[0]),Math.max(p[1],a[1])]},[1/0,-1/0]).map(function(a){return a===1/0||a===-1/0?0:a})},Uq=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Gq=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Z5=function(t,r,i){if(Cn(t))return t(r,i);if(!Array.isArray(t))return r;var a=[];if(kr(t[0]))a[0]=i?t[0]:Math.min(t[0],r[0]);else if(Uq.test(t[0])){var l=+Uq.exec(t[0])[1];a[0]=r[0]-l}else Cn(t[0])?a[0]=t[0](r[0]):a[0]=r[0];if(kr(t[1]))a[1]=i?t[1]:Math.max(t[1],r[1]);else if(Gq.test(t[1])){var d=+Gq.exec(t[1])[1];a[1]=r[1]+d}else Cn(t[1])?a[1]=t[1](r[1]):a[1]=r[1];return a},Kk=function(t,r,i){if(t&&t.scale&&t.scale.bandwidth){var a=t.scale.bandwidth();if(!i||a>0)return a}if(t&&r&&r.length>=2){for(var l=$B(r,function(j){return j.coordinate}),d=1/0,s=1,p=l.length;s<p;s++){var x=l[s],w=l[s-1];d=Math.min((x.coordinate||0)-(w.coordinate||0),d)}return d===1/0?0:d}return i?void 0:0},Hq=function(t,r,i){return!t||!t.length||Om(t,Rc(i,"type.defaultProps.domain"))?r:t},use=function(t,r){var i=t.type.defaultProps?pa(pa({},t.type.defaultProps),t.props):t.props,a=i.dataKey,l=i.name,d=i.unit,s=i.formatter,p=i.tooltipType,x=i.chartType,w=i.hide;return pa(pa({},en(t,!1)),{},{dataKey:a,unit:d,formatter:s,name:l||a,color:m6(t),value:ys(r,a),type:p,payload:r,chartType:x,hide:w})};function B2(e){"@babel/helpers - typeof";return B2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},B2(e)}function qq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,i)}return r}function lm(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?qq(Object(r),!0).forEach(function(i){dse(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):qq(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function dse(e,t,r){return t=HBe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function HBe(e){var t=qBe(e,"string");return B2(t)=="symbol"?t:t+""}function qBe(e,t){if(B2(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(B2(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function WBe(e,t){return XBe(e)||YBe(e,t)||ZBe(e,t)||KBe()}function KBe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ZBe(e,t){if(e){if(typeof e=="string")return Wq(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Wq(e,t)}}function Wq(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function YBe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var i,a,l,d,s=[],p=!0,x=!1;try{if(l=(r=r.call(e)).next,t!==0)for(;!(p=(i=l.call(r)).done)&&(s.push(i.value),s.length!==t);p=!0);}catch(w){x=!0,a=w}finally{try{if(!p&&r.return!=null&&(d=r.return(),Object(d)!==d))return}finally{if(x)throw a}}return s}}function XBe(e){if(Array.isArray(e))return e}var Zk=Math.PI/180,JBe=function(t){return t*180/Math.PI},Xi=function(t,r,i,a){return{x:t+Math.cos(-Zk*a)*i,y:r+Math.sin(-Zk*a)*i}},hse=function(t,r){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(i.left||0)-(i.right||0)),Math.abs(r-(i.top||0)-(i.bottom||0)))/2},mse=function(t,r,i,a,l){var d=t.width,s=t.height,p=t.startAngle,x=t.endAngle,w=_l(t.cx,d,d/2),j=_l(t.cy,s,s/2),S=hse(d,s,i),P=_l(t.innerRadius,S,0),F=_l(t.outerRadius,S,S*.8),L=Object.keys(r);return L.reduce(function(B,V){var $=r[V],G=$.domain,W=$.reversed,Z;if(Tn($.range))a==="angleAxis"?Z=[p,x]:a==="radiusAxis"&&(Z=[P,F]),W&&(Z=[Z[1],Z[0]]);else{Z=$.range;var se=Z,ae=WBe(se,2);p=ae[0],x=ae[1]}var ce=ase($,l),Pe=ce.realScaleType,we=ce.scale;we.domain(G).range(Z),ose(we);var xe=lse(we,lm(lm({},$),{},{realScaleType:Pe})),Ne=lm(lm(lm({},$),xe),{},{range:Z,radius:F,realScaleType:Pe,scale:we,cx:w,cy:j,innerRadius:P,outerRadius:F,startAngle:p,endAngle:x});return lm(lm({},B),{},dse({},V,Ne))},{})},QBe=function(t,r){var i=t.x,a=t.y,l=r.x,d=r.y;return Math.sqrt(Math.pow(i-l,2)+Math.pow(a-d,2))},e6e=function(t,r){var i=t.x,a=t.y,l=r.cx,d=r.cy,s=QBe({x:i,y:a},{x:l,y:d});if(s<=0)return{radius:s};var p=(i-l)/s,x=Math.acos(p);return a>d&&(x=2*Math.PI-x),{radius:s,angle:JBe(x),angleInRadian:x}},t6e=function(t){var r=t.startAngle,i=t.endAngle,a=Math.floor(r/360),l=Math.floor(i/360),d=Math.min(a,l);return{startAngle:r-d*360,endAngle:i-d*360}},r6e=function(t,r){var i=r.startAngle,a=r.endAngle,l=Math.floor(i/360),d=Math.floor(a/360),s=Math.min(l,d);return t+s*360},Kq=function(t,r){var i=t.x,a=t.y,l=e6e({x:i,y:a},r),d=l.radius,s=l.angle,p=r.innerRadius,x=r.outerRadius;if(d<p||d>x)return!1;if(d===0)return!0;var w=t6e(r),j=w.startAngle,S=w.endAngle,P=s,F;if(j<=S){for(;P>S;)P-=360;for(;P<j;)P+=360;F=P>=j&&P<=S}else{for(;P>j;)P-=360;for(;P<S;)P+=360;F=P>=S&&P<=j}return F?lm(lm({},r),{},{radius:d,angle:r6e(P,r)}):null},fse=function(t){return!U.isValidElement(t)&&!Cn(t)&&typeof t!="boolean"?t.className:""};function $2(e){"@babel/helpers - typeof";return $2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$2(e)}var n6e=["offset"];function i6e(e){return l6e(e)||o6e(e)||a6e(e)||s6e()}function s6e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function a6e(e,t){if(e){if(typeof e=="string")return Y5(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Y5(e,t)}}function o6e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function l6e(e){if(Array.isArray(e))return Y5(e)}function Y5(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function c6e(e,t){if(e==null)return{};var r=u6e(e,t),i,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)i=l[a],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}function u6e(e,t){if(e==null)return{};var r={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;r[i]=e[i]}return r}function Zq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,i)}return r}function Za(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Zq(Object(r),!0).forEach(function(i){d6e(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Zq(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function d6e(e,t,r){return t=h6e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function h6e(e){var t=m6e(e,"string");return $2(t)=="symbol"?t:t+""}function m6e(e,t){if($2(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if($2(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function V2(){return V2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},V2.apply(this,arguments)}var f6e=function(t){var r=t.value,i=t.formatter,a=Tn(t.children)?r:t.children;return Cn(i)?i(a):a},p6e=function(t,r){var i=bl(r-t),a=Math.min(Math.abs(r-t),360);return i*a},g6e=function(t,r,i){var a=t.position,l=t.viewBox,d=t.offset,s=t.className,p=l,x=p.cx,w=p.cy,j=p.innerRadius,S=p.outerRadius,P=p.startAngle,F=p.endAngle,L=p.clockWise,B=(j+S)/2,V=p6e(P,F),$=V>=0?1:-1,G,W;a==="insideStart"?(G=P+$*d,W=L):a==="insideEnd"?(G=F-$*d,W=!L):a==="end"&&(G=F+$*d,W=L),W=V<=0?W:!W;var Z=Xi(x,w,B,G),se=Xi(x,w,B,G+(W?1:-1)*359),ae="M".concat(Z.x,",").concat(Z.y,`
    A`).concat(B,",").concat(B,",0,1,").concat(W?0:1,`,
    `).concat(se.x,",").concat(se.y),ce=Tn(t.id)?og("recharts-radial-line-"):t.id;return ke.createElement("text",V2({},i,{dominantBaseline:"central",className:zn("recharts-radial-bar-label",s)}),ke.createElement("defs",null,ke.createElement("path",{id:ce,d:ae})),ke.createElement("textPath",{xlinkHref:"#".concat(ce)},r))},x6e=function(t){var r=t.viewBox,i=t.offset,a=t.position,l=r,d=l.cx,s=l.cy,p=l.innerRadius,x=l.outerRadius,w=l.startAngle,j=l.endAngle,S=(w+j)/2;if(a==="outside"){var P=Xi(d,s,x+i,S),F=P.x,L=P.y;return{x:F,y:L,textAnchor:F>=d?"start":"end",verticalAnchor:"middle"}}if(a==="center")return{x:d,y:s,textAnchor:"middle",verticalAnchor:"middle"};if(a==="centerTop")return{x:d,y:s,textAnchor:"middle",verticalAnchor:"start"};if(a==="centerBottom")return{x:d,y:s,textAnchor:"middle",verticalAnchor:"end"};var B=(p+x)/2,V=Xi(d,s,B,S),$=V.x,G=V.y;return{x:$,y:G,textAnchor:"middle",verticalAnchor:"middle"}},y6e=function(t){var r=t.viewBox,i=t.parentViewBox,a=t.offset,l=t.position,d=r,s=d.x,p=d.y,x=d.width,w=d.height,j=w>=0?1:-1,S=j*a,P=j>0?"end":"start",F=j>0?"start":"end",L=x>=0?1:-1,B=L*a,V=L>0?"end":"start",$=L>0?"start":"end";if(l==="top"){var G={x:s+x/2,y:p-j*a,textAnchor:"middle",verticalAnchor:P};return Za(Za({},G),i?{height:Math.max(p-i.y,0),width:x}:{})}if(l==="bottom"){var W={x:s+x/2,y:p+w+S,textAnchor:"middle",verticalAnchor:F};return Za(Za({},W),i?{height:Math.max(i.y+i.height-(p+w),0),width:x}:{})}if(l==="left"){var Z={x:s-B,y:p+w/2,textAnchor:V,verticalAnchor:"middle"};return Za(Za({},Z),i?{width:Math.max(Z.x-i.x,0),height:w}:{})}if(l==="right"){var se={x:s+x+B,y:p+w/2,textAnchor:$,verticalAnchor:"middle"};return Za(Za({},se),i?{width:Math.max(i.x+i.width-se.x,0),height:w}:{})}var ae=i?{width:x,height:w}:{};return l==="insideLeft"?Za({x:s+B,y:p+w/2,textAnchor:$,verticalAnchor:"middle"},ae):l==="insideRight"?Za({x:s+x-B,y:p+w/2,textAnchor:V,verticalAnchor:"middle"},ae):l==="insideTop"?Za({x:s+x/2,y:p+S,textAnchor:"middle",verticalAnchor:F},ae):l==="insideBottom"?Za({x:s+x/2,y:p+w-S,textAnchor:"middle",verticalAnchor:P},ae):l==="insideTopLeft"?Za({x:s+B,y:p+S,textAnchor:$,verticalAnchor:F},ae):l==="insideTopRight"?Za({x:s+x-B,y:p+S,textAnchor:V,verticalAnchor:F},ae):l==="insideBottomLeft"?Za({x:s+B,y:p+w-S,textAnchor:$,verticalAnchor:P},ae):l==="insideBottomRight"?Za({x:s+x-B,y:p+w-S,textAnchor:V,verticalAnchor:P},ae):j_(l)&&(kr(l.x)||P0(l.x))&&(kr(l.y)||P0(l.y))?Za({x:s+_l(l.x,x),y:p+_l(l.y,w),textAnchor:"end",verticalAnchor:"end"},ae):Za({x:s+x/2,y:p+w/2,textAnchor:"middle",verticalAnchor:"middle"},ae)},v6e=function(t){return"cx"in t&&kr(t.cx)};function ho(e){var t=e.offset,r=t===void 0?5:t,i=c6e(e,n6e),a=Za({offset:r},i),l=a.viewBox,d=a.position,s=a.value,p=a.children,x=a.content,w=a.className,j=w===void 0?"":w,S=a.textBreakAll;if(!l||Tn(s)&&Tn(p)&&!U.isValidElement(x)&&!Cn(x))return null;if(U.isValidElement(x))return U.cloneElement(x,a);var P;if(Cn(x)){if(P=U.createElement(x,a),U.isValidElement(P))return P}else P=f6e(a);var F=v6e(l),L=en(a,!0);if(F&&(d==="insideStart"||d==="insideEnd"||d==="end"))return g6e(a,P,L);var B=F?x6e(a):y6e(a);return ke.createElement(ix,V2({className:zn("recharts-label",j)},L,B,{breakAll:S}),P)}ho.displayName="Label";var pse=function(t){var r=t.cx,i=t.cy,a=t.angle,l=t.startAngle,d=t.endAngle,s=t.r,p=t.radius,x=t.innerRadius,w=t.outerRadius,j=t.x,S=t.y,P=t.top,F=t.left,L=t.width,B=t.height,V=t.clockWise,$=t.labelViewBox;if($)return $;if(kr(L)&&kr(B)){if(kr(j)&&kr(S))return{x:j,y:S,width:L,height:B};if(kr(P)&&kr(F))return{x:P,y:F,width:L,height:B}}return kr(j)&&kr(S)?{x:j,y:S,width:0,height:0}:kr(r)&&kr(i)?{cx:r,cy:i,startAngle:l||a||0,endAngle:d||a||0,innerRadius:x||0,outerRadius:w||p||s||0,clockWise:V}:t.viewBox?t.viewBox:{}},b6e=function(t,r){return t?t===!0?ke.createElement(ho,{key:"label-implicit",viewBox:r}):Qa(t)?ke.createElement(ho,{key:"label-implicit",viewBox:r,value:t}):U.isValidElement(t)?t.type===ho?U.cloneElement(t,{key:"label-implicit",viewBox:r}):ke.createElement(ho,{key:"label-implicit",content:t,viewBox:r}):Cn(t)?ke.createElement(ho,{key:"label-implicit",content:t,viewBox:r}):j_(t)?ke.createElement(ho,V2({viewBox:r},t,{key:"label-implicit"})):null:null},_6e=function(t,r){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&i&&!t.label)return null;var a=t.children,l=pse(t),d=Sl(a,ho).map(function(p,x){return U.cloneElement(p,{viewBox:r||l,key:"label-".concat(x)})});if(!i)return d;var s=b6e(t.label,r||l);return[s].concat(i6e(d))};ho.parseViewBox=pse;ho.renderCallByParent=_6e;function w6e(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var j6e=w6e;const gse=Vi(j6e);function U2(e){"@babel/helpers - typeof";return U2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},U2(e)}var N6e=["valueAccessor"],S6e=["data","dataKey","clockWise","id","textBreakAll"];function C6e(e){return P6e(e)||k6e(e)||T6e(e)||A6e()}function A6e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function T6e(e,t){if(e){if(typeof e=="string")return X5(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return X5(e,t)}}function k6e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function P6e(e){if(Array.isArray(e))return X5(e)}function X5(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function Yk(){return Yk=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},Yk.apply(this,arguments)}function Yq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,i)}return r}function Xq(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Yq(Object(r),!0).forEach(function(i){E6e(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Yq(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function E6e(e,t,r){return t=M6e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function M6e(e){var t=I6e(e,"string");return U2(t)=="symbol"?t:t+""}function I6e(e,t){if(U2(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(U2(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Jq(e,t){if(e==null)return{};var r=O6e(e,t),i,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)i=l[a],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}function O6e(e,t){if(e==null)return{};var r={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;r[i]=e[i]}return r}var R6e=function(t){return Array.isArray(t.value)?gse(t.value):t.value};function _u(e){var t=e.valueAccessor,r=t===void 0?R6e:t,i=Jq(e,N6e),a=i.data,l=i.dataKey,d=i.clockWise,s=i.id,p=i.textBreakAll,x=Jq(i,S6e);return!a||!a.length?null:ke.createElement(Qn,{className:"recharts-label-list"},a.map(function(w,j){var S=Tn(l)?r(w,j):ys(w&&w.payload,l),P=Tn(s)?{}:{id:"".concat(s,"-").concat(j)};return ke.createElement(ho,Yk({},en(w,!0),x,P,{parentViewBox:w.parentViewBox,value:S,textBreakAll:p,viewBox:ho.parseViewBox(Tn(d)?w:Xq(Xq({},w),{},{clockWise:d})),key:"label-".concat(j),index:j}))}))}_u.displayName="LabelList";function D6e(e,t){return e?e===!0?ke.createElement(_u,{key:"labelList-implicit",data:t}):ke.isValidElement(e)||Cn(e)?ke.createElement(_u,{key:"labelList-implicit",data:t,content:e}):j_(e)?ke.createElement(_u,Yk({data:t},e,{key:"labelList-implicit"})):null:null}function z6e(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&r&&!e.label)return null;var i=e.children,a=Sl(i,_u).map(function(d,s){return U.cloneElement(d,{data:t,key:"labelList-".concat(s)})});if(!r)return a;var l=D6e(e.label,t);return[l].concat(C6e(a))}_u.renderCallByParent=z6e;function G2(e){"@babel/helpers - typeof";return G2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},G2(e)}function J5(){return J5=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},J5.apply(this,arguments)}function Qq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,i)}return r}function eW(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Qq(Object(r),!0).forEach(function(i){L6e(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Qq(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function L6e(e,t,r){return t=F6e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function F6e(e){var t=B6e(e,"string");return G2(t)=="symbol"?t:t+""}function B6e(e,t){if(G2(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(G2(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var $6e=function(t,r){var i=bl(r-t),a=Math.min(Math.abs(r-t),359.999);return i*a},YA=function(t){var r=t.cx,i=t.cy,a=t.radius,l=t.angle,d=t.sign,s=t.isExternal,p=t.cornerRadius,x=t.cornerIsExternal,w=p*(s?1:-1)+a,j=Math.asin(p/w)/Zk,S=x?l:l+d*j,P=Xi(r,i,w,S),F=Xi(r,i,a,S),L=x?l-d*j:l,B=Xi(r,i,w*Math.cos(j*Zk),L);return{center:P,circleTangency:F,lineTangency:B,theta:j}},xse=function(t){var r=t.cx,i=t.cy,a=t.innerRadius,l=t.outerRadius,d=t.startAngle,s=t.endAngle,p=$6e(d,s),x=d+p,w=Xi(r,i,l,d),j=Xi(r,i,l,x),S="M ".concat(w.x,",").concat(w.y,`
    A `).concat(l,",").concat(l,`,0,
    `).concat(+(Math.abs(p)>180),",").concat(+(d>x),`,
    `).concat(j.x,",").concat(j.y,`
  `);if(a>0){var P=Xi(r,i,a,d),F=Xi(r,i,a,x);S+="L ".concat(F.x,",").concat(F.y,`
            A `).concat(a,",").concat(a,`,0,
            `).concat(+(Math.abs(p)>180),",").concat(+(d<=x),`,
            `).concat(P.x,",").concat(P.y," Z")}else S+="L ".concat(r,",").concat(i," Z");return S},V6e=function(t){var r=t.cx,i=t.cy,a=t.innerRadius,l=t.outerRadius,d=t.cornerRadius,s=t.forceCornerRadius,p=t.cornerIsExternal,x=t.startAngle,w=t.endAngle,j=bl(w-x),S=YA({cx:r,cy:i,radius:l,angle:x,sign:j,cornerRadius:d,cornerIsExternal:p}),P=S.circleTangency,F=S.lineTangency,L=S.theta,B=YA({cx:r,cy:i,radius:l,angle:w,sign:-j,cornerRadius:d,cornerIsExternal:p}),V=B.circleTangency,$=B.lineTangency,G=B.theta,W=p?Math.abs(x-w):Math.abs(x-w)-L-G;if(W<0)return s?"M ".concat(F.x,",").concat(F.y,`
        a`).concat(d,",").concat(d,",0,0,1,").concat(d*2,`,0
        a`).concat(d,",").concat(d,",0,0,1,").concat(-d*2,`,0
      `):xse({cx:r,cy:i,innerRadius:a,outerRadius:l,startAngle:x,endAngle:w});var Z="M ".concat(F.x,",").concat(F.y,`
    A`).concat(d,",").concat(d,",0,0,").concat(+(j<0),",").concat(P.x,",").concat(P.y,`
    A`).concat(l,",").concat(l,",0,").concat(+(W>180),",").concat(+(j<0),",").concat(V.x,",").concat(V.y,`
    A`).concat(d,",").concat(d,",0,0,").concat(+(j<0),",").concat($.x,",").concat($.y,`
  `);if(a>0){var se=YA({cx:r,cy:i,radius:a,angle:x,sign:j,isExternal:!0,cornerRadius:d,cornerIsExternal:p}),ae=se.circleTangency,ce=se.lineTangency,Pe=se.theta,we=YA({cx:r,cy:i,radius:a,angle:w,sign:-j,isExternal:!0,cornerRadius:d,cornerIsExternal:p}),xe=we.circleTangency,Ne=we.lineTangency,ze=we.theta,ye=p?Math.abs(x-w):Math.abs(x-w)-Pe-ze;if(ye<0&&d===0)return"".concat(Z,"L").concat(r,",").concat(i,"Z");Z+="L".concat(Ne.x,",").concat(Ne.y,`
      A`).concat(d,",").concat(d,",0,0,").concat(+(j<0),",").concat(xe.x,",").concat(xe.y,`
      A`).concat(a,",").concat(a,",0,").concat(+(ye>180),",").concat(+(j>0),",").concat(ae.x,",").concat(ae.y,`
      A`).concat(d,",").concat(d,",0,0,").concat(+(j<0),",").concat(ce.x,",").concat(ce.y,"Z")}else Z+="L".concat(r,",").concat(i,"Z");return Z},U6e={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},yse=function(t){var r=eW(eW({},U6e),t),i=r.cx,a=r.cy,l=r.innerRadius,d=r.outerRadius,s=r.cornerRadius,p=r.forceCornerRadius,x=r.cornerIsExternal,w=r.startAngle,j=r.endAngle,S=r.className;if(d<l||w===j)return null;var P=zn("recharts-sector",S),F=d-l,L=_l(s,F,0,!0),B;return L>0&&Math.abs(w-j)<360?B=V6e({cx:i,cy:a,innerRadius:l,outerRadius:d,cornerRadius:Math.min(L,F/2),forceCornerRadius:p,cornerIsExternal:x,startAngle:w,endAngle:j}):B=xse({cx:i,cy:a,innerRadius:l,outerRadius:d,startAngle:w,endAngle:j}),ke.createElement("path",J5({},en(r,!0),{className:P,d:B,role:"img"}))};function H2(e){"@babel/helpers - typeof";return H2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},H2(e)}function Q5(){return Q5=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},Q5.apply(this,arguments)}function tW(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,i)}return r}function rW(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?tW(Object(r),!0).forEach(function(i){G6e(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tW(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function G6e(e,t,r){return t=H6e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function H6e(e){var t=q6e(e,"string");return H2(t)=="symbol"?t:t+""}function q6e(e,t){if(H2(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(H2(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var nW={curveBasisClosed:Bke,curveBasisOpen:$ke,curveBasis:Fke,curveBumpX:Ske,curveBumpY:Cke,curveLinearClosed:Vke,curveLinear:dM,curveMonotoneX:Uke,curveMonotoneY:Gke,curveNatural:Hke,curveStep:qke,curveStepAfter:Kke,curveStepBefore:Wke},XA=function(t){return t.x===+t.x&&t.y===+t.y},tj=function(t){return t.x},rj=function(t){return t.y},W6e=function(t,r){if(Cn(t))return t;var i="curve".concat(cM(t));return(i==="curveMonotone"||i==="curveBump")&&r?nW["".concat(i).concat(r==="vertical"?"Y":"X")]:nW[i]||dM},K6e=function(t){var r=t.type,i=r===void 0?"linear":r,a=t.points,l=a===void 0?[]:a,d=t.baseLine,s=t.layout,p=t.connectNulls,x=p===void 0?!1:p,w=W6e(i,s),j=x?l.filter(function(L){return XA(L)}):l,S;if(Array.isArray(d)){var P=x?d.filter(function(L){return XA(L)}):d,F=j.map(function(L,B){return rW(rW({},L),{},{base:P[B]})});return s==="vertical"?S=BA().y(rj).x1(tj).x0(function(L){return L.base.x}):S=BA().x(tj).y1(rj).y0(function(L){return L.base.y}),S.defined(XA).curve(w),S(F)}return s==="vertical"&&kr(d)?S=BA().y(rj).x1(tj).x0(d):kr(d)?S=BA().x(tj).y1(rj).y0(d):S=one().x(tj).y(rj),S.defined(XA).curve(w),S(j)},Dp=function(t){var r=t.className,i=t.points,a=t.path,l=t.pathRef;if((!i||!i.length)&&!a)return null;var d=i&&i.length?K6e(t):a;return ke.createElement("path",Q5({},en(t,!1),_k(t),{className:zn("recharts-curve",r),d,ref:l}))},vse={exports:{}},Z6e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",Y6e=Z6e,X6e=Y6e;function bse(){}function _se(){}_se.resetWarningCache=bse;var J6e=function(){function e(i,a,l,d,s,p){if(p!==X6e){var x=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw x.name="Invariant Violation",x}}e.isRequired=e;function t(){return e}var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:_se,resetWarningCache:bse};return r.PropTypes=r,r};vse.exports=J6e();var Q6e=vse.exports;const ii=Vi(Q6e);var e$e=Object.getOwnPropertyNames,t$e=Object.getOwnPropertySymbols,r$e=Object.prototype.hasOwnProperty;function iW(e,t){return function(i,a,l){return e(i,a,l)&&t(i,a,l)}}function JA(e){return function(r,i,a){if(!r||!i||typeof r!="object"||typeof i!="object")return e(r,i,a);var l=a.cache,d=l.get(r),s=l.get(i);if(d&&s)return d===i&&s===r;l.set(r,i),l.set(i,r);var p=e(r,i,a);return l.delete(r),l.delete(i),p}}function sW(e){return e$e(e).concat(t$e(e))}var wse=Object.hasOwn||function(e,t){return r$e.call(e,t)};function O_(e,t){return e||t?e===t:e===t||e!==e&&t!==t}var jse="_owner",aW=Object.getOwnPropertyDescriptor,oW=Object.keys;function n$e(e,t,r){var i=e.length;if(t.length!==i)return!1;for(;i-- >0;)if(!r.equals(e[i],t[i],i,i,e,t,r))return!1;return!0}function i$e(e,t){return O_(e.getTime(),t.getTime())}function lW(e,t,r){if(e.size!==t.size)return!1;for(var i={},a=e.entries(),l=0,d,s;(d=a.next())&&!d.done;){for(var p=t.entries(),x=!1,w=0;(s=p.next())&&!s.done;){var j=d.value,S=j[0],P=j[1],F=s.value,L=F[0],B=F[1];!x&&!i[w]&&(x=r.equals(S,L,l,w,e,t,r)&&r.equals(P,B,S,L,e,t,r))&&(i[w]=!0),w++}if(!x)return!1;l++}return!0}function s$e(e,t,r){var i=oW(e),a=i.length;if(oW(t).length!==a)return!1;for(var l;a-- >0;)if(l=i[a],l===jse&&(e.$$typeof||t.$$typeof)&&e.$$typeof!==t.$$typeof||!wse(t,l)||!r.equals(e[l],t[l],l,l,e,t,r))return!1;return!0}function nj(e,t,r){var i=sW(e),a=i.length;if(sW(t).length!==a)return!1;for(var l,d,s;a-- >0;)if(l=i[a],l===jse&&(e.$$typeof||t.$$typeof)&&e.$$typeof!==t.$$typeof||!wse(t,l)||!r.equals(e[l],t[l],l,l,e,t,r)||(d=aW(e,l),s=aW(t,l),(d||s)&&(!d||!s||d.configurable!==s.configurable||d.enumerable!==s.enumerable||d.writable!==s.writable)))return!1;return!0}function a$e(e,t){return O_(e.valueOf(),t.valueOf())}function o$e(e,t){return e.source===t.source&&e.flags===t.flags}function cW(e,t,r){if(e.size!==t.size)return!1;for(var i={},a=e.values(),l,d;(l=a.next())&&!l.done;){for(var s=t.values(),p=!1,x=0;(d=s.next())&&!d.done;)!p&&!i[x]&&(p=r.equals(l.value,d.value,l.value,d.value,e,t,r))&&(i[x]=!0),x++;if(!p)return!1}return!0}function l$e(e,t){var r=e.length;if(t.length!==r)return!1;for(;r-- >0;)if(e[r]!==t[r])return!1;return!0}var c$e="[object Arguments]",u$e="[object Boolean]",d$e="[object Date]",h$e="[object Map]",m$e="[object Number]",f$e="[object Object]",p$e="[object RegExp]",g$e="[object Set]",x$e="[object String]",y$e=Array.isArray,uW=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,dW=Object.assign,v$e=Object.prototype.toString.call.bind(Object.prototype.toString);function b$e(e){var t=e.areArraysEqual,r=e.areDatesEqual,i=e.areMapsEqual,a=e.areObjectsEqual,l=e.arePrimitiveWrappersEqual,d=e.areRegExpsEqual,s=e.areSetsEqual,p=e.areTypedArraysEqual;return function(w,j,S){if(w===j)return!0;if(w==null||j==null||typeof w!="object"||typeof j!="object")return w!==w&&j!==j;var P=w.constructor;if(P!==j.constructor)return!1;if(P===Object)return a(w,j,S);if(y$e(w))return t(w,j,S);if(uW!=null&&uW(w))return p(w,j,S);if(P===Date)return r(w,j,S);if(P===RegExp)return d(w,j,S);if(P===Map)return i(w,j,S);if(P===Set)return s(w,j,S);var F=v$e(w);return F===d$e?r(w,j,S):F===p$e?d(w,j,S):F===h$e?i(w,j,S):F===g$e?s(w,j,S):F===f$e?typeof w.then!="function"&&typeof j.then!="function"&&a(w,j,S):F===c$e?a(w,j,S):F===u$e||F===m$e||F===x$e?l(w,j,S):!1}}function _$e(e){var t=e.circular,r=e.createCustomConfig,i=e.strict,a={areArraysEqual:i?nj:n$e,areDatesEqual:i$e,areMapsEqual:i?iW(lW,nj):lW,areObjectsEqual:i?nj:s$e,arePrimitiveWrappersEqual:a$e,areRegExpsEqual:o$e,areSetsEqual:i?iW(cW,nj):cW,areTypedArraysEqual:i?nj:l$e};if(r&&(a=dW({},a,r(a))),t){var l=JA(a.areArraysEqual),d=JA(a.areMapsEqual),s=JA(a.areObjectsEqual),p=JA(a.areSetsEqual);a=dW({},a,{areArraysEqual:l,areMapsEqual:d,areObjectsEqual:s,areSetsEqual:p})}return a}function w$e(e){return function(t,r,i,a,l,d,s){return e(t,r,s)}}function j$e(e){var t=e.circular,r=e.comparator,i=e.createState,a=e.equals,l=e.strict;if(i)return function(p,x){var w=i(),j=w.cache,S=j===void 0?t?new WeakMap:void 0:j,P=w.meta;return r(p,x,{cache:S,equals:a,meta:P,strict:l})};if(t)return function(p,x){return r(p,x,{cache:new WeakMap,equals:a,meta:void 0,strict:l})};var d={cache:void 0,equals:a,meta:void 0,strict:l};return function(p,x){return r(p,x,d)}}var N$e=ug();ug({strict:!0});ug({circular:!0});ug({circular:!0,strict:!0});ug({createInternalComparator:function(){return O_}});ug({strict:!0,createInternalComparator:function(){return O_}});ug({circular:!0,createInternalComparator:function(){return O_}});ug({circular:!0,createInternalComparator:function(){return O_},strict:!0});function ug(e){e===void 0&&(e={});var t=e.circular,r=t===void 0?!1:t,i=e.createInternalComparator,a=e.createState,l=e.strict,d=l===void 0?!1:l,s=_$e(e),p=b$e(s),x=i?i(p):w$e(p);return j$e({circular:r,comparator:p,createState:a,equals:x,strict:d})}function S$e(e){typeof requestAnimationFrame<"u"&&requestAnimationFrame(e)}function hW(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,i=function a(l){r<0&&(r=l),l-r>t?(e(l),r=-1):S$e(a)};requestAnimationFrame(i)}function ez(e){"@babel/helpers - typeof";return ez=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ez(e)}function C$e(e){return P$e(e)||k$e(e)||T$e(e)||A$e()}function A$e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function T$e(e,t){if(e){if(typeof e=="string")return mW(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return mW(e,t)}}function mW(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function k$e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function P$e(e){if(Array.isArray(e))return e}function E$e(){var e={},t=function(){return null},r=!1,i=function a(l){if(!r){if(Array.isArray(l)){if(!l.length)return;var d=l,s=C$e(d),p=s[0],x=s.slice(1);if(typeof p=="number"){hW(a.bind(null,x),p);return}a(p),hW(a.bind(null,x));return}ez(l)==="object"&&(e=l,t(e)),typeof l=="function"&&l()}};return{stop:function(){r=!0},start:function(l){r=!1,i(l)},subscribe:function(l){return t=l,function(){t=function(){return null}}}}}function q2(e){"@babel/helpers - typeof";return q2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},q2(e)}function fW(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,i)}return r}function pW(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?fW(Object(r),!0).forEach(function(i){Nse(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fW(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function Nse(e,t,r){return t=M$e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function M$e(e){var t=I$e(e,"string");return q2(t)==="symbol"?t:String(t)}function I$e(e,t){if(q2(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(q2(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var O$e=function(t,r){return[Object.keys(t),Object.keys(r)].reduce(function(i,a){return i.filter(function(l){return a.includes(l)})})},R$e=function(t){return t},D$e=function(t){return t.replace(/([A-Z])/g,function(r){return"-".concat(r.toLowerCase())})},Lj=function(t,r){return Object.keys(r).reduce(function(i,a){return pW(pW({},i),{},Nse({},a,t(a,r[a])))},{})},gW=function(t,r,i){return t.map(function(a){return"".concat(D$e(a)," ").concat(r,"ms ").concat(i)}).join(",")};function z$e(e,t){return B$e(e)||F$e(e,t)||Sse(e,t)||L$e()}function L$e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function F$e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var i,a,l,d,s=[],p=!0,x=!1;try{if(l=(r=r.call(e)).next,t!==0)for(;!(p=(i=l.call(r)).done)&&(s.push(i.value),s.length!==t);p=!0);}catch(w){x=!0,a=w}finally{try{if(!p&&r.return!=null&&(d=r.return(),Object(d)!==d))return}finally{if(x)throw a}}return s}}function B$e(e){if(Array.isArray(e))return e}function $$e(e){return G$e(e)||U$e(e)||Sse(e)||V$e()}function V$e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Sse(e,t){if(e){if(typeof e=="string")return tz(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tz(e,t)}}function U$e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function G$e(e){if(Array.isArray(e))return tz(e)}function tz(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}var Xk=1e-4,Cse=function(t,r){return[0,3*t,3*r-6*t,3*t-3*r+1]},Ase=function(t,r){return t.map(function(i,a){return i*Math.pow(r,a)}).reduce(function(i,a){return i+a})},xW=function(t,r){return function(i){var a=Cse(t,r);return Ase(a,i)}},H$e=function(t,r){return function(i){var a=Cse(t,r),l=[].concat($$e(a.map(function(d,s){return d*s}).slice(1)),[0]);return Ase(l,i)}},yW=function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];var a=r[0],l=r[1],d=r[2],s=r[3];if(r.length===1)switch(r[0]){case"linear":a=0,l=0,d=1,s=1;break;case"ease":a=.25,l=.1,d=.25,s=1;break;case"ease-in":a=.42,l=0,d=1,s=1;break;case"ease-out":a=.42,l=0,d=.58,s=1;break;case"ease-in-out":a=0,l=0,d=.58,s=1;break;default:{var p=r[0].split("(");if(p[0]==="cubic-bezier"&&p[1].split(")")[0].split(",").length===4){var x=p[1].split(")")[0].split(",").map(function(B){return parseFloat(B)}),w=z$e(x,4);a=w[0],l=w[1],d=w[2],s=w[3]}}}var j=xW(a,d),S=xW(l,s),P=H$e(a,d),F=function(V){return V>1?1:V<0?0:V},L=function(V){for(var $=V>1?1:V,G=$,W=0;W<8;++W){var Z=j(G)-$,se=P(G);if(Math.abs(Z-$)<Xk||se<Xk)return S(G);G=F(G-Z/se)}return S(G)};return L.isStepper=!1,L},q$e=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.stiff,i=r===void 0?100:r,a=t.damping,l=a===void 0?8:a,d=t.dt,s=d===void 0?17:d,p=function(w,j,S){var P=-(w-j)*i,F=S*l,L=S+(P-F)*s/1e3,B=S*s/1e3+w;return Math.abs(B-j)<Xk&&Math.abs(L)<Xk?[j,0]:[B,L]};return p.isStepper=!0,p.dt=s,p},W$e=function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];var a=r[0];if(typeof a=="string")switch(a){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return yW(a);case"spring":return q$e();default:if(a.split("(")[0]==="cubic-bezier")return yW(a)}return typeof a=="function"?a:null};function W2(e){"@babel/helpers - typeof";return W2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},W2(e)}function vW(e){return Y$e(e)||Z$e(e)||Tse(e)||K$e()}function K$e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Z$e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Y$e(e){if(Array.isArray(e))return nz(e)}function bW(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,i)}return r}function No(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?bW(Object(r),!0).forEach(function(i){rz(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):bW(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function rz(e,t,r){return t=X$e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function X$e(e){var t=J$e(e,"string");return W2(t)==="symbol"?t:String(t)}function J$e(e,t){if(W2(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(W2(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Q$e(e,t){return r8e(e)||t8e(e,t)||Tse(e,t)||e8e()}function e8e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Tse(e,t){if(e){if(typeof e=="string")return nz(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return nz(e,t)}}function nz(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function t8e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var i,a,l,d,s=[],p=!0,x=!1;try{if(l=(r=r.call(e)).next,t!==0)for(;!(p=(i=l.call(r)).done)&&(s.push(i.value),s.length!==t);p=!0);}catch(w){x=!0,a=w}finally{try{if(!p&&r.return!=null&&(d=r.return(),Object(d)!==d))return}finally{if(x)throw a}}return s}}function r8e(e){if(Array.isArray(e))return e}var Jk=function(t,r,i){return t+(r-t)*i},iz=function(t){var r=t.from,i=t.to;return r!==i},n8e=function e(t,r,i){var a=Lj(function(l,d){if(iz(d)){var s=t(d.from,d.to,d.velocity),p=Q$e(s,2),x=p[0],w=p[1];return No(No({},d),{},{from:x,velocity:w})}return d},r);return i<1?Lj(function(l,d){return iz(d)?No(No({},d),{},{velocity:Jk(d.velocity,a[l].velocity,i),from:Jk(d.from,a[l].from,i)}):d},r):e(t,a,i-1)};const i8e=function(e,t,r,i,a){var l=O$e(e,t),d=l.reduce(function(B,V){return No(No({},B),{},rz({},V,[e[V],t[V]]))},{}),s=l.reduce(function(B,V){return No(No({},B),{},rz({},V,{from:e[V],velocity:0,to:t[V]}))},{}),p=-1,x,w,j=function(){return null},S=function(){return Lj(function(V,$){return $.from},s)},P=function(){return!Object.values(s).filter(iz).length},F=function(V){x||(x=V);var $=V-x,G=$/r.dt;s=n8e(r,s,G),a(No(No(No({},e),t),S())),x=V,P()||(p=requestAnimationFrame(j))},L=function(V){w||(w=V);var $=(V-w)/i,G=Lj(function(Z,se){return Jk.apply(void 0,vW(se).concat([r($)]))},d);if(a(No(No(No({},e),t),G)),$<1)p=requestAnimationFrame(j);else{var W=Lj(function(Z,se){return Jk.apply(void 0,vW(se).concat([r(1)]))},d);a(No(No(No({},e),t),W))}};return j=r.isStepper?F:L,function(){return requestAnimationFrame(j),function(){cancelAnimationFrame(p)}}};function Sb(e){"@babel/helpers - typeof";return Sb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sb(e)}var s8e=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function a8e(e,t){if(e==null)return{};var r=o8e(e,t),i,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)i=l[a],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}function o8e(e,t){if(e==null)return{};var r={},i=Object.keys(e),a,l;for(l=0;l<i.length;l++)a=i[l],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}function HO(e){return d8e(e)||u8e(e)||c8e(e)||l8e()}function l8e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function c8e(e,t){if(e){if(typeof e=="string")return sz(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return sz(e,t)}}function u8e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function d8e(e){if(Array.isArray(e))return sz(e)}function sz(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function _W(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,i)}return r}function Qu(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_W(Object(r),!0).forEach(function(i){yj(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_W(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function yj(e,t,r){return t=kse(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function h8e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m8e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,kse(i.key),i)}}function f8e(e,t,r){return t&&m8e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function kse(e){var t=p8e(e,"string");return Sb(t)==="symbol"?t:String(t)}function p8e(e,t){if(Sb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(Sb(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function g8e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&az(e,t)}function az(e,t){return az=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,a){return i.__proto__=a,i},az(e,t)}function x8e(e){var t=y8e();return function(){var i=Qk(e),a;if(t){var l=Qk(this).constructor;a=Reflect.construct(i,arguments,l)}else a=i.apply(this,arguments);return oz(this,a)}}function oz(e,t){if(t&&(Sb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return lz(e)}function lz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y8e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Qk(e){return Qk=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Qk(e)}var Uc=function(e){g8e(r,e);var t=x8e(r);function r(i,a){var l;h8e(this,r),l=t.call(this,i,a);var d=l.props,s=d.isActive,p=d.attributeName,x=d.from,w=d.to,j=d.steps,S=d.children,P=d.duration;if(l.handleStyleChange=l.handleStyleChange.bind(lz(l)),l.changeStyle=l.changeStyle.bind(lz(l)),!s||P<=0)return l.state={style:{}},typeof S=="function"&&(l.state={style:w}),oz(l);if(j&&j.length)l.state={style:j[0].style};else if(x){if(typeof S=="function")return l.state={style:x},oz(l);l.state={style:p?yj({},p,x):x}}else l.state={style:{}};return l}return f8e(r,[{key:"componentDidMount",value:function(){var a=this.props,l=a.isActive,d=a.canBegin;this.mounted=!0,!(!l||!d)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(a){var l=this.props,d=l.isActive,s=l.canBegin,p=l.attributeName,x=l.shouldReAnimate,w=l.to,j=l.from,S=this.state.style;if(s){if(!d){var P={style:p?yj({},p,w):w};this.state&&S&&(p&&S[p]!==w||!p&&S!==w)&&this.setState(P);return}if(!(N$e(a.to,w)&&a.canBegin&&a.isActive)){var F=!a.canBegin||!a.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var L=F||x?j:a.to;if(this.state&&S){var B={style:p?yj({},p,L):L};(p&&S[p]!==L||!p&&S!==L)&&this.setState(B)}this.runAnimation(Qu(Qu({},this.props),{},{from:L,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var a=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),a&&a()}},{key:"handleStyleChange",value:function(a){this.changeStyle(a)}},{key:"changeStyle",value:function(a){this.mounted&&this.setState({style:a})}},{key:"runJSAnimation",value:function(a){var l=this,d=a.from,s=a.to,p=a.duration,x=a.easing,w=a.begin,j=a.onAnimationEnd,S=a.onAnimationStart,P=i8e(d,s,W$e(x),p,this.changeStyle),F=function(){l.stopJSAnimation=P()};this.manager.start([S,w,F,p,j])}},{key:"runStepAnimation",value:function(a){var l=this,d=a.steps,s=a.begin,p=a.onAnimationStart,x=d[0],w=x.style,j=x.duration,S=j===void 0?0:j,P=function(L,B,V){if(V===0)return L;var $=B.duration,G=B.easing,W=G===void 0?"ease":G,Z=B.style,se=B.properties,ae=B.onAnimationEnd,ce=V>0?d[V-1]:B,Pe=se||Object.keys(Z);if(typeof W=="function"||W==="spring")return[].concat(HO(L),[l.runJSAnimation.bind(l,{from:ce.style,to:Z,duration:$,easing:W}),$]);var we=gW(Pe,$,W),xe=Qu(Qu(Qu({},ce.style),Z),{},{transition:we});return[].concat(HO(L),[xe,$,ae]).filter(R$e)};return this.manager.start([p].concat(HO(d.reduce(P,[w,Math.max(S,s)])),[a.onAnimationEnd]))}},{key:"runAnimation",value:function(a){this.manager||(this.manager=E$e());var l=a.begin,d=a.duration,s=a.attributeName,p=a.to,x=a.easing,w=a.onAnimationStart,j=a.onAnimationEnd,S=a.steps,P=a.children,F=this.manager;if(this.unSubscribe=F.subscribe(this.handleStyleChange),typeof x=="function"||typeof P=="function"||x==="spring"){this.runJSAnimation(a);return}if(S.length>1){this.runStepAnimation(a);return}var L=s?yj({},s,p):p,B=gW(Object.keys(L),d,x);F.start([w,l,Qu(Qu({},L),{},{transition:B}),d,j])}},{key:"render",value:function(){var a=this.props,l=a.children;a.begin;var d=a.duration;a.attributeName,a.easing;var s=a.isActive;a.steps,a.from,a.to,a.canBegin,a.onAnimationEnd,a.shouldReAnimate,a.onAnimationReStart;var p=a8e(a,s8e),x=U.Children.count(l),w=this.state.style;if(typeof l=="function")return l(w);if(!s||x===0||d<=0)return l;var j=function(P){var F=P.props,L=F.style,B=L===void 0?{}:L,V=F.className,$=U.cloneElement(P,Qu(Qu({},p),{},{style:Qu(Qu({},B),w),className:V}));return $};return x===1?j(U.Children.only(l)):ke.createElement("div",null,U.Children.map(l,function(S){return j(S)}))}}]),r}(U.PureComponent);Uc.displayName="Animate";Uc.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};Uc.propTypes={from:ii.oneOfType([ii.object,ii.string]),to:ii.oneOfType([ii.object,ii.string]),attributeName:ii.string,duration:ii.number,begin:ii.number,easing:ii.oneOfType([ii.string,ii.func]),steps:ii.arrayOf(ii.shape({duration:ii.number.isRequired,style:ii.object.isRequired,easing:ii.oneOfType([ii.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),ii.func]),properties:ii.arrayOf("string"),onAnimationEnd:ii.func})),children:ii.oneOfType([ii.node,ii.func]),isActive:ii.bool,canBegin:ii.bool,onAnimationEnd:ii.func,shouldReAnimate:ii.bool,onAnimationStart:ii.func,onAnimationReStart:ii.func};ii.object,ii.object,ii.object,ii.element;ii.object,ii.object,ii.object,ii.oneOfType([ii.array,ii.element]),ii.any;function K2(e){"@babel/helpers - typeof";return K2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},K2(e)}function eP(){return eP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},eP.apply(this,arguments)}function v8e(e,t){return j8e(e)||w8e(e,t)||_8e(e,t)||b8e()}function b8e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _8e(e,t){if(e){if(typeof e=="string")return wW(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return wW(e,t)}}function wW(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function w8e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var i,a,l,d,s=[],p=!0,x=!1;try{if(l=(r=r.call(e)).next,t!==0)for(;!(p=(i=l.call(r)).done)&&(s.push(i.value),s.length!==t);p=!0);}catch(w){x=!0,a=w}finally{try{if(!p&&r.return!=null&&(d=r.return(),Object(d)!==d))return}finally{if(x)throw a}}return s}}function j8e(e){if(Array.isArray(e))return e}function jW(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,i)}return r}function NW(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?jW(Object(r),!0).forEach(function(i){N8e(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):jW(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function N8e(e,t,r){return t=S8e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function S8e(e){var t=C8e(e,"string");return K2(t)=="symbol"?t:t+""}function C8e(e,t){if(K2(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(K2(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var SW=function(t,r,i,a,l){var d=Math.min(Math.abs(i)/2,Math.abs(a)/2),s=a>=0?1:-1,p=i>=0?1:-1,x=a>=0&&i>=0||a<0&&i<0?1:0,w;if(d>0&&l instanceof Array){for(var j=[0,0,0,0],S=0,P=4;S<P;S++)j[S]=l[S]>d?d:l[S];w="M".concat(t,",").concat(r+s*j[0]),j[0]>0&&(w+="A ".concat(j[0],",").concat(j[0],",0,0,").concat(x,",").concat(t+p*j[0],",").concat(r)),w+="L ".concat(t+i-p*j[1],",").concat(r),j[1]>0&&(w+="A ".concat(j[1],",").concat(j[1],",0,0,").concat(x,`,
        `).concat(t+i,",").concat(r+s*j[1])),w+="L ".concat(t+i,",").concat(r+a-s*j[2]),j[2]>0&&(w+="A ".concat(j[2],",").concat(j[2],",0,0,").concat(x,`,
        `).concat(t+i-p*j[2],",").concat(r+a)),w+="L ".concat(t+p*j[3],",").concat(r+a),j[3]>0&&(w+="A ".concat(j[3],",").concat(j[3],",0,0,").concat(x,`,
        `).concat(t,",").concat(r+a-s*j[3])),w+="Z"}else if(d>0&&l===+l&&l>0){var F=Math.min(d,l);w="M ".concat(t,",").concat(r+s*F,`
            A `).concat(F,",").concat(F,",0,0,").concat(x,",").concat(t+p*F,",").concat(r,`
            L `).concat(t+i-p*F,",").concat(r,`
            A `).concat(F,",").concat(F,",0,0,").concat(x,",").concat(t+i,",").concat(r+s*F,`
            L `).concat(t+i,",").concat(r+a-s*F,`
            A `).concat(F,",").concat(F,",0,0,").concat(x,",").concat(t+i-p*F,",").concat(r+a,`
            L `).concat(t+p*F,",").concat(r+a,`
            A `).concat(F,",").concat(F,",0,0,").concat(x,",").concat(t,",").concat(r+a-s*F," Z")}else w="M ".concat(t,",").concat(r," h ").concat(i," v ").concat(a," h ").concat(-i," Z");return w},A8e=function(t,r){if(!t||!r)return!1;var i=t.x,a=t.y,l=r.x,d=r.y,s=r.width,p=r.height;if(Math.abs(s)>0&&Math.abs(p)>0){var x=Math.min(l,l+s),w=Math.max(l,l+s),j=Math.min(d,d+p),S=Math.max(d,d+p);return i>=x&&i<=w&&a>=j&&a<=S}return!1},T8e={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},f6=function(t){var r=NW(NW({},T8e),t),i=U.useRef(),a=U.useState(-1),l=v8e(a,2),d=l[0],s=l[1];U.useEffect(function(){if(i.current&&i.current.getTotalLength)try{var W=i.current.getTotalLength();W&&s(W)}catch{}},[]);var p=r.x,x=r.y,w=r.width,j=r.height,S=r.radius,P=r.className,F=r.animationEasing,L=r.animationDuration,B=r.animationBegin,V=r.isAnimationActive,$=r.isUpdateAnimationActive;if(p!==+p||x!==+x||w!==+w||j!==+j||w===0||j===0)return null;var G=zn("recharts-rectangle",P);return $?ke.createElement(Uc,{canBegin:d>0,from:{width:w,height:j,x:p,y:x},to:{width:w,height:j,x:p,y:x},duration:L,animationEasing:F,isActive:$},function(W){var Z=W.width,se=W.height,ae=W.x,ce=W.y;return ke.createElement(Uc,{canBegin:d>0,from:"0px ".concat(d===-1?1:d,"px"),to:"".concat(d,"px 0px"),attributeName:"strokeDasharray",begin:B,duration:L,isActive:V,easing:F},ke.createElement("path",eP({},en(r,!0),{className:G,d:SW(ae,ce,Z,se,S),ref:i})))}):ke.createElement("path",eP({},en(r,!0),{className:G,d:SW(p,x,w,j,S)}))},k8e=["points","className","baseLinePoints","connectNulls"];function wv(){return wv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},wv.apply(this,arguments)}function P8e(e,t){if(e==null)return{};var r=E8e(e,t),i,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)i=l[a],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}function E8e(e,t){if(e==null)return{};var r={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;r[i]=e[i]}return r}function CW(e){return R8e(e)||O8e(e)||I8e(e)||M8e()}function M8e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function I8e(e,t){if(e){if(typeof e=="string")return cz(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return cz(e,t)}}function O8e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function R8e(e){if(Array.isArray(e))return cz(e)}function cz(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}var AW=function(t){return t&&t.x===+t.x&&t.y===+t.y},D8e=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=[[]];return t.forEach(function(i){AW(i)?r[r.length-1].push(i):r[r.length-1].length>0&&r.push([])}),AW(t[0])&&r[r.length-1].push(t[0]),r[r.length-1].length<=0&&(r=r.slice(0,-1)),r},Fj=function(t,r){var i=D8e(t);r&&(i=[i.reduce(function(l,d){return[].concat(CW(l),CW(d))},[])]);var a=i.map(function(l){return l.reduce(function(d,s,p){return"".concat(d).concat(p===0?"M":"L").concat(s.x,",").concat(s.y)},"")}).join("");return i.length===1?"".concat(a,"Z"):a},z8e=function(t,r,i){var a=Fj(t,i);return"".concat(a.slice(-1)==="Z"?a.slice(0,-1):a,"L").concat(Fj(r.reverse(),i).slice(1))},Pse=function(t){var r=t.points,i=t.className,a=t.baseLinePoints,l=t.connectNulls,d=P8e(t,k8e);if(!r||!r.length)return null;var s=zn("recharts-polygon",i);if(a&&a.length){var p=d.stroke&&d.stroke!=="none",x=z8e(r,a,l);return ke.createElement("g",{className:s},ke.createElement("path",wv({},en(d,!0),{fill:x.slice(-1)==="Z"?d.fill:"none",stroke:"none",d:x})),p?ke.createElement("path",wv({},en(d,!0),{fill:"none",d:Fj(r,l)})):null,p?ke.createElement("path",wv({},en(d,!0),{fill:"none",d:Fj(a,l)})):null)}var w=Fj(r,l);return ke.createElement("path",wv({},en(d,!0),{fill:w.slice(-1)==="Z"?d.fill:"none",className:s,d:w}))};function uz(){return uz=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},uz.apply(this,arguments)}var R_=function(t){var r=t.cx,i=t.cy,a=t.r,l=t.className,d=zn("recharts-dot",l);return r===+r&&i===+i&&a===+a?ke.createElement("circle",uz({},en(t,!1),_k(t),{className:d,cx:r,cy:i,r:a})):null};function Z2(e){"@babel/helpers - typeof";return Z2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Z2(e)}var L8e=["x","y","top","left","width","height","className"];function dz(){return dz=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},dz.apply(this,arguments)}function TW(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,i)}return r}function F8e(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?TW(Object(r),!0).forEach(function(i){B8e(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):TW(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function B8e(e,t,r){return t=$8e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $8e(e){var t=V8e(e,"string");return Z2(t)=="symbol"?t:t+""}function V8e(e,t){if(Z2(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(Z2(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function U8e(e,t){if(e==null)return{};var r=G8e(e,t),i,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)i=l[a],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}function G8e(e,t){if(e==null)return{};var r={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;r[i]=e[i]}return r}var H8e=function(t,r,i,a,l,d){return"M".concat(t,",").concat(l,"v").concat(a,"M").concat(d,",").concat(r,"h").concat(i)},q8e=function(t){var r=t.x,i=r===void 0?0:r,a=t.y,l=a===void 0?0:a,d=t.top,s=d===void 0?0:d,p=t.left,x=p===void 0?0:p,w=t.width,j=w===void 0?0:w,S=t.height,P=S===void 0?0:S,F=t.className,L=U8e(t,L8e),B=F8e({x:i,y:l,top:s,left:x,width:j,height:P},L);return!kr(i)||!kr(l)||!kr(j)||!kr(P)||!kr(s)||!kr(x)?null:ke.createElement("path",dz({},en(B,!0),{className:zn("recharts-cross",F),d:H8e(i,l,j,P,s,x)}))},W8e=["cx","cy","innerRadius","outerRadius","gridType","radialLines"];function Y2(e){"@babel/helpers - typeof";return Y2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Y2(e)}function K8e(e,t){if(e==null)return{};var r=Z8e(e,t),i,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)i=l[a],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}function Z8e(e,t){if(e==null)return{};var r={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;r[i]=e[i]}return r}function Rm(){return Rm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},Rm.apply(this,arguments)}function kW(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,i)}return r}function X2(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?kW(Object(r),!0).forEach(function(i){Y8e(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):kW(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function Y8e(e,t,r){return t=X8e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function X8e(e){var t=J8e(e,"string");return Y2(t)=="symbol"?t:t+""}function J8e(e,t){if(Y2(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(Y2(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Q8e=function(t,r,i,a){var l="";return a.forEach(function(d,s){var p=Xi(r,i,t,d);s?l+="L ".concat(p.x,",").concat(p.y):l+="M ".concat(p.x,",").concat(p.y)}),l+="Z",l},eVe=function(t){var r=t.cx,i=t.cy,a=t.innerRadius,l=t.outerRadius,d=t.polarAngles,s=t.radialLines;if(!d||!d.length||!s)return null;var p=X2({stroke:"#ccc"},en(t,!1));return ke.createElement("g",{className:"recharts-polar-grid-angle"},d.map(function(x){var w=Xi(r,i,a,x),j=Xi(r,i,l,x);return ke.createElement("line",Rm({},p,{key:"line-".concat(x),x1:w.x,y1:w.y,x2:j.x,y2:j.y}))}))},tVe=function(t){var r=t.cx,i=t.cy,a=t.radius,l=t.index,d=X2(X2({stroke:"#ccc"},en(t,!1)),{},{fill:"none"});return ke.createElement("circle",Rm({},d,{className:zn("recharts-polar-grid-concentric-circle",t.className),key:"circle-".concat(l),cx:r,cy:i,r:a}))},rVe=function(t){var r=t.radius,i=t.index,a=X2(X2({stroke:"#ccc"},en(t,!1)),{},{fill:"none"});return ke.createElement("path",Rm({},a,{className:zn("recharts-polar-grid-concentric-polygon",t.className),key:"path-".concat(i),d:Q8e(r,t.cx,t.cy,t.polarAngles)}))},nVe=function(t){var r=t.polarRadius,i=t.gridType;return!r||!r.length?null:ke.createElement("g",{className:"recharts-polar-grid-concentric"},r.map(function(a,l){var d=l;return i==="circle"?ke.createElement(tVe,Rm({key:d},t,{radius:a,index:l})):ke.createElement(rVe,Rm({key:d},t,{radius:a,index:l}))}))},p6=function(t){var r=t.cx,i=r===void 0?0:r,a=t.cy,l=a===void 0?0:a,d=t.innerRadius,s=d===void 0?0:d,p=t.outerRadius,x=p===void 0?0:p,w=t.gridType,j=w===void 0?"polygon":w,S=t.radialLines,P=S===void 0?!0:S,F=K8e(t,W8e);return x<=0?null:ke.createElement("g",{className:"recharts-polar-grid"},ke.createElement(eVe,Rm({cx:i,cy:l,innerRadius:s,outerRadius:x,gridType:j,radialLines:P},F)),ke.createElement(nVe,Rm({cx:i,cy:l,innerRadius:s,outerRadius:x,gridType:j,radialLines:P},F)))};p6.displayName="PolarGrid";var iVe=jM,sVe=Lie,aVe=Ph;function oVe(e,t){return e&&e.length?iVe(e,aVe(t),sVe):void 0}var lVe=oVe;const cVe=Vi(lVe);var uVe=jM,dVe=Ph,hVe=Fie;function mVe(e,t){return e&&e.length?uVe(e,dVe(t),hVe):void 0}var fVe=mVe;const pVe=Vi(fVe);var gVe=["cx","cy","angle","ticks","axisLine"],xVe=["ticks","tick","angle","tickFormatter","stroke"];function Cb(e){"@babel/helpers - typeof";return Cb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cb(e)}function Bj(){return Bj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},Bj.apply(this,arguments)}function PW(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,i)}return r}function h0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?PW(Object(r),!0).forEach(function(i){AM(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):PW(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function EW(e,t){if(e==null)return{};var r=yVe(e,t),i,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)i=l[a],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}function yVe(e,t){if(e==null)return{};var r={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;r[i]=e[i]}return r}function vVe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function MW(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,Mse(i.key),i)}}function bVe(e,t,r){return t&&MW(e.prototype,t),r&&MW(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _Ve(e,t,r){return t=tP(t),wVe(e,Ese()?Reflect.construct(t,r||[],tP(e).constructor):t.apply(e,r))}function wVe(e,t){if(t&&(Cb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return jVe(e)}function jVe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ese(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Ese=function(){return!!e})()}function tP(e){return tP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},tP(e)}function NVe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&hz(e,t)}function hz(e,t){return hz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,a){return i.__proto__=a,i},hz(e,t)}function AM(e,t,r){return t=Mse(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Mse(e){var t=SVe(e,"string");return Cb(t)=="symbol"?t:t+""}function SVe(e,t){if(Cb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(Cb(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ax=function(e){function t(){return vVe(this,t),_Ve(this,t,arguments)}return NVe(t,e),bVe(t,[{key:"getTickValueCoord",value:function(i){var a=i.coordinate,l=this.props,d=l.angle,s=l.cx,p=l.cy;return Xi(s,p,a,d)}},{key:"getTickTextAnchor",value:function(){var i=this.props.orientation,a;switch(i){case"left":a="end";break;case"right":a="start";break;default:a="middle";break}return a}},{key:"getViewBox",value:function(){var i=this.props,a=i.cx,l=i.cy,d=i.angle,s=i.ticks,p=cVe(s,function(w){return w.coordinate||0}),x=pVe(s,function(w){return w.coordinate||0});return{cx:a,cy:l,startAngle:d,endAngle:d,innerRadius:x.coordinate||0,outerRadius:p.coordinate||0}}},{key:"renderAxisLine",value:function(){var i=this.props,a=i.cx,l=i.cy,d=i.angle,s=i.ticks,p=i.axisLine,x=EW(i,gVe),w=s.reduce(function(F,L){return[Math.min(F[0],L.coordinate),Math.max(F[1],L.coordinate)]},[1/0,-1/0]),j=Xi(a,l,w[0],d),S=Xi(a,l,w[1],d),P=h0(h0(h0({},en(x,!1)),{},{fill:"none"},en(p,!1)),{},{x1:j.x,y1:j.y,x2:S.x,y2:S.y});return ke.createElement("line",Bj({className:"recharts-polar-radius-axis-line"},P))}},{key:"renderTicks",value:function(){var i=this,a=this.props,l=a.ticks,d=a.tick,s=a.angle,p=a.tickFormatter,x=a.stroke,w=EW(a,xVe),j=this.getTickTextAnchor(),S=en(w,!1),P=en(d,!1),F=l.map(function(L,B){var V=i.getTickValueCoord(L),$=h0(h0(h0(h0({textAnchor:j,transform:"rotate(".concat(90-s,", ").concat(V.x,", ").concat(V.y,")")},S),{},{stroke:"none",fill:x},P),{},{index:B},V),{},{payload:L});return ke.createElement(Qn,Bj({className:zn("recharts-polar-radius-axis-tick",fse(d)),key:"tick-".concat(L.coordinate)},Wp(i.props,L,B)),t.renderTickItem(d,$,p?p(L.value,B):L.value))});return ke.createElement(Qn,{className:"recharts-polar-radius-axis-ticks"},F)}},{key:"render",value:function(){var i=this.props,a=i.ticks,l=i.axisLine,d=i.tick;return!a||!a.length?null:ke.createElement(Qn,{className:zn("recharts-polar-radius-axis",this.props.className)},l&&this.renderAxisLine(),d&&this.renderTicks(),ho.renderCallByParent(this.props,this.getViewBox()))}}],[{key:"renderTickItem",value:function(i,a,l){var d;return ke.isValidElement(i)?d=ke.cloneElement(i,a):Cn(i)?d=i(a):d=ke.createElement(ix,Bj({},a,{className:"recharts-polar-radius-axis-tick-value"}),l),d}}])}(U.PureComponent);AM(Ax,"displayName","PolarRadiusAxis");AM(Ax,"axisType","radiusAxis");AM(Ax,"defaultProps",{type:"number",radiusAxisId:0,cx:0,cy:0,angle:0,orientation:"right",stroke:"#ccc",axisLine:!0,tick:!0,tickCount:5,allowDataOverflow:!1,scale:"auto",allowDuplicatedCategory:!0});function Ab(e){"@babel/helpers - typeof";return Ab=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ab(e)}function S0(){return S0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},S0.apply(this,arguments)}function IW(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,i)}return r}function m0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?IW(Object(r),!0).forEach(function(i){TM(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):IW(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function CVe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function OW(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,Ose(i.key),i)}}function AVe(e,t,r){return t&&OW(e.prototype,t),r&&OW(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function TVe(e,t,r){return t=rP(t),kVe(e,Ise()?Reflect.construct(t,r||[],rP(e).constructor):t.apply(e,r))}function kVe(e,t){if(t&&(Ab(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return PVe(e)}function PVe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ise(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Ise=function(){return!!e})()}function rP(e){return rP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},rP(e)}function EVe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&mz(e,t)}function mz(e,t){return mz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,a){return i.__proto__=a,i},mz(e,t)}function TM(e,t,r){return t=Ose(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ose(e){var t=MVe(e,"string");return Ab(t)=="symbol"?t:t+""}function MVe(e,t){if(Ab(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(Ab(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var IVe=Math.PI/180,RW=1e-5,Tx=function(e){function t(){return CVe(this,t),TVe(this,t,arguments)}return EVe(t,e),AVe(t,[{key:"getTickLineCoord",value:function(i){var a=this.props,l=a.cx,d=a.cy,s=a.radius,p=a.orientation,x=a.tickSize,w=x||8,j=Xi(l,d,s,i.coordinate),S=Xi(l,d,s+(p==="inner"?-1:1)*w,i.coordinate);return{x1:j.x,y1:j.y,x2:S.x,y2:S.y}}},{key:"getTickTextAnchor",value:function(i){var a=this.props.orientation,l=Math.cos(-i.coordinate*IVe),d;return l>RW?d=a==="outer"?"start":"end":l<-RW?d=a==="outer"?"end":"start":d="middle",d}},{key:"renderAxisLine",value:function(){var i=this.props,a=i.cx,l=i.cy,d=i.radius,s=i.axisLine,p=i.axisLineType,x=m0(m0({},en(this.props,!1)),{},{fill:"none"},en(s,!1));if(p==="circle")return ke.createElement(R_,S0({className:"recharts-polar-angle-axis-line"},x,{cx:a,cy:l,r:d}));var w=this.props.ticks,j=w.map(function(S){return Xi(a,l,d,S.coordinate)});return ke.createElement(Pse,S0({className:"recharts-polar-angle-axis-line"},x,{points:j}))}},{key:"renderTicks",value:function(){var i=this,a=this.props,l=a.ticks,d=a.tick,s=a.tickLine,p=a.tickFormatter,x=a.stroke,w=en(this.props,!1),j=en(d,!1),S=m0(m0({},w),{},{fill:"none"},en(s,!1)),P=l.map(function(F,L){var B=i.getTickLineCoord(F),V=i.getTickTextAnchor(F),$=m0(m0(m0({textAnchor:V},w),{},{stroke:"none",fill:x},j),{},{index:L,payload:F,x:B.x2,y:B.y2});return ke.createElement(Qn,S0({className:zn("recharts-polar-angle-axis-tick",fse(d)),key:"tick-".concat(F.coordinate)},Wp(i.props,F,L)),s&&ke.createElement("line",S0({className:"recharts-polar-angle-axis-tick-line"},S,B)),d&&t.renderTickItem(d,$,p?p(F.value,L):F.value))});return ke.createElement(Qn,{className:"recharts-polar-angle-axis-ticks"},P)}},{key:"render",value:function(){var i=this.props,a=i.ticks,l=i.radius,d=i.axisLine;return l<=0||!a||!a.length?null:ke.createElement(Qn,{className:zn("recharts-polar-angle-axis",this.props.className)},d&&this.renderAxisLine(),this.renderTicks())}}],[{key:"renderTickItem",value:function(i,a,l){var d;return ke.isValidElement(i)?d=ke.cloneElement(i,a):Cn(i)?d=i(a):d=ke.createElement(ix,S0({},a,{className:"recharts-polar-angle-axis-tick-value"}),l),d}}])}(U.PureComponent);TM(Tx,"displayName","PolarAngleAxis");TM(Tx,"axisType","angleAxis");TM(Tx,"defaultProps",{type:"category",angleAxisId:0,scale:"auto",cx:0,cy:0,orientation:"outer",axisLine:!0,tickLine:!0,tickSize:8,tick:!0,hide:!1,allowDuplicatedCategory:!0});var OVe=Ene,RVe=OVe(Object.getPrototypeOf,Object),DVe=RVe,zVe=Fm,LVe=DVe,FVe=Bm,BVe="[object Object]",$Ve=Function.prototype,VVe=Object.prototype,Rse=$Ve.toString,UVe=VVe.hasOwnProperty,GVe=Rse.call(Object);function HVe(e){if(!FVe(e)||zVe(e)!=BVe)return!1;var t=LVe(e);if(t===null)return!0;var r=UVe.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&Rse.call(r)==GVe}var qVe=HVe;const WVe=Vi(qVe);var KVe=Fm,ZVe=Bm,YVe="[object Boolean]";function XVe(e){return e===!0||e===!1||ZVe(e)&&KVe(e)==YVe}var JVe=XVe;const QVe=Vi(JVe);function J2(e){"@babel/helpers - typeof";return J2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},J2(e)}function nP(){return nP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},nP.apply(this,arguments)}function e7e(e,t){return i7e(e)||n7e(e,t)||r7e(e,t)||t7e()}function t7e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function r7e(e,t){if(e){if(typeof e=="string")return DW(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return DW(e,t)}}function DW(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function n7e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var i,a,l,d,s=[],p=!0,x=!1;try{if(l=(r=r.call(e)).next,t!==0)for(;!(p=(i=l.call(r)).done)&&(s.push(i.value),s.length!==t);p=!0);}catch(w){x=!0,a=w}finally{try{if(!p&&r.return!=null&&(d=r.return(),Object(d)!==d))return}finally{if(x)throw a}}return s}}function i7e(e){if(Array.isArray(e))return e}function zW(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,i)}return r}function LW(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?zW(Object(r),!0).forEach(function(i){s7e(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zW(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function s7e(e,t,r){return t=a7e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a7e(e){var t=o7e(e,"string");return J2(t)=="symbol"?t:t+""}function o7e(e,t){if(J2(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(J2(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var FW=function(t,r,i,a,l){var d=i-a,s;return s="M ".concat(t,",").concat(r),s+="L ".concat(t+i,",").concat(r),s+="L ".concat(t+i-d/2,",").concat(r+l),s+="L ".concat(t+i-d/2-a,",").concat(r+l),s+="L ".concat(t,",").concat(r," Z"),s},l7e={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},c7e=function(t){var r=LW(LW({},l7e),t),i=U.useRef(),a=U.useState(-1),l=e7e(a,2),d=l[0],s=l[1];U.useEffect(function(){if(i.current&&i.current.getTotalLength)try{var G=i.current.getTotalLength();G&&s(G)}catch{}},[]);var p=r.x,x=r.y,w=r.upperWidth,j=r.lowerWidth,S=r.height,P=r.className,F=r.animationEasing,L=r.animationDuration,B=r.animationBegin,V=r.isUpdateAnimationActive;if(p!==+p||x!==+x||w!==+w||j!==+j||S!==+S||w===0&&j===0||S===0)return null;var $=zn("recharts-trapezoid",P);return V?ke.createElement(Uc,{canBegin:d>0,from:{upperWidth:0,lowerWidth:0,height:S,x:p,y:x},to:{upperWidth:w,lowerWidth:j,height:S,x:p,y:x},duration:L,animationEasing:F,isActive:V},function(G){var W=G.upperWidth,Z=G.lowerWidth,se=G.height,ae=G.x,ce=G.y;return ke.createElement(Uc,{canBegin:d>0,from:"0px ".concat(d===-1?1:d,"px"),to:"".concat(d,"px 0px"),attributeName:"strokeDasharray",begin:B,duration:L,easing:F},ke.createElement("path",nP({},en(r,!0),{className:$,d:FW(ae,ce,W,Z,se),ref:i})))}):ke.createElement("g",null,ke.createElement("path",nP({},en(r,!0),{className:$,d:FW(p,x,w,j,S)})))},u7e=["option","shapeType","propTransformer","activeClassName","isActive"];function Q2(e){"@babel/helpers - typeof";return Q2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Q2(e)}function d7e(e,t){if(e==null)return{};var r=h7e(e,t),i,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)i=l[a],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}function h7e(e,t){if(e==null)return{};var r={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;r[i]=e[i]}return r}function BW(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,i)}return r}function iP(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?BW(Object(r),!0).forEach(function(i){m7e(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):BW(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function m7e(e,t,r){return t=f7e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function f7e(e){var t=p7e(e,"string");return Q2(t)=="symbol"?t:t+""}function p7e(e,t){if(Q2(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(Q2(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function g7e(e,t){return iP(iP({},t),e)}function x7e(e,t){return e==="symbols"}function $W(e){var t=e.shapeType,r=e.elementProps;switch(t){case"rectangle":return ke.createElement(f6,r);case"trapezoid":return ke.createElement(c7e,r);case"sector":return ke.createElement(yse,r);case"symbols":if(x7e(t))return ke.createElement(mM,r);break;default:return null}}function y7e(e){return U.isValidElement(e)?e.props:e}function sP(e){var t=e.option,r=e.shapeType,i=e.propTransformer,a=i===void 0?g7e:i,l=e.activeClassName,d=l===void 0?"recharts-active-shape":l,s=e.isActive,p=d7e(e,u7e),x;if(U.isValidElement(t))x=U.cloneElement(t,iP(iP({},p),y7e(t)));else if(Cn(t))x=t(p);else if(WVe(t)&&!QVe(t)){var w=a(t,p);x=ke.createElement($W,{shapeType:r,elementProps:w})}else{var j=p;x=ke.createElement($W,{shapeType:r,elementProps:j})}return s?ke.createElement(Qn,{className:d},x):x}function kM(e,t){return t!=null&&"trapezoids"in e.props}function PM(e,t){return t!=null&&"sectors"in e.props}function eN(e,t){return t!=null&&"points"in e.props}function v7e(e,t){var r,i,a=e.x===(t==null||(r=t.labelViewBox)===null||r===void 0?void 0:r.x)||e.x===t.x,l=e.y===(t==null||(i=t.labelViewBox)===null||i===void 0?void 0:i.y)||e.y===t.y;return a&&l}function b7e(e,t){var r=e.endAngle===t.endAngle,i=e.startAngle===t.startAngle;return r&&i}function _7e(e,t){var r=e.x===t.x,i=e.y===t.y,a=e.z===t.z;return r&&i&&a}function w7e(e,t){var r;return kM(e,t)?r=v7e:PM(e,t)?r=b7e:eN(e,t)&&(r=_7e),r}function j7e(e,t){var r;return kM(e,t)?r="trapezoids":PM(e,t)?r="sectors":eN(e,t)&&(r="points"),r}function N7e(e,t){if(kM(e,t)){var r;return(r=t.tooltipPayload)===null||r===void 0||(r=r[0])===null||r===void 0||(r=r.payload)===null||r===void 0?void 0:r.payload}if(PM(e,t)){var i;return(i=t.tooltipPayload)===null||i===void 0||(i=i[0])===null||i===void 0||(i=i.payload)===null||i===void 0?void 0:i.payload}return eN(e,t)?t.payload:{}}function S7e(e){var t=e.activeTooltipItem,r=e.graphicalItem,i=e.itemData,a=j7e(r,t),l=N7e(r,t),d=i.filter(function(p,x){var w=Om(l,p),j=r.props[a].filter(function(F){var L=w7e(r,t);return L(F,t)}),S=r.props[a].indexOf(j[j.length-1]),P=x===S;return w&&P}),s=i.indexOf(d[d.length-1]);return s}var ET;function Tb(e){"@babel/helpers - typeof";return Tb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tb(e)}function jv(){return jv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},jv.apply(this,arguments)}function VW(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,i)}return r}function Cs(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?VW(Object(r),!0).forEach(function(i){fu(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):VW(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function C7e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function UW(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,zse(i.key),i)}}function A7e(e,t,r){return t&&UW(e.prototype,t),r&&UW(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function T7e(e,t,r){return t=aP(t),k7e(e,Dse()?Reflect.construct(t,r||[],aP(e).constructor):t.apply(e,r))}function k7e(e,t){if(t&&(Tb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return P7e(e)}function P7e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Dse(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Dse=function(){return!!e})()}function aP(e){return aP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},aP(e)}function E7e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fz(e,t)}function fz(e,t){return fz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,a){return i.__proto__=a,i},fz(e,t)}function fu(e,t,r){return t=zse(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zse(e){var t=M7e(e,"string");return Tb(t)=="symbol"?t:t+""}function M7e(e,t){if(Tb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(Tb(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Gc=function(e){function t(r){var i;return C7e(this,t),i=T7e(this,t,[r]),fu(i,"pieRef",null),fu(i,"sectorRefs",[]),fu(i,"id",og("recharts-pie-")),fu(i,"handleAnimationEnd",function(){var a=i.props.onAnimationEnd;i.setState({isAnimationFinished:!0}),Cn(a)&&a()}),fu(i,"handleAnimationStart",function(){var a=i.props.onAnimationStart;i.setState({isAnimationFinished:!1}),Cn(a)&&a()}),i.state={isAnimationFinished:!r.isAnimationActive,prevIsAnimationActive:r.isAnimationActive,prevAnimationId:r.animationId,sectorToFocus:0},i}return E7e(t,e),A7e(t,[{key:"isActiveIndex",value:function(i){var a=this.props.activeIndex;return Array.isArray(a)?a.indexOf(i)!==-1:i===a}},{key:"hasActiveIndex",value:function(){var i=this.props.activeIndex;return Array.isArray(i)?i.length!==0:i||i===0}},{key:"renderLabels",value:function(i){var a=this.props.isAnimationActive;if(a&&!this.state.isAnimationFinished)return null;var l=this.props,d=l.label,s=l.labelLine,p=l.dataKey,x=l.valueKey,w=en(this.props,!1),j=en(d,!1),S=en(s,!1),P=d&&d.offsetRadius||20,F=i.map(function(L,B){var V=(L.startAngle+L.endAngle)/2,$=Xi(L.cx,L.cy,L.outerRadius+P,V),G=Cs(Cs(Cs(Cs({},w),L),{},{stroke:"none"},j),{},{index:B,textAnchor:t.getTextAnchor($.x,L.cx)},$),W=Cs(Cs(Cs(Cs({},w),L),{},{fill:"none",stroke:L.fill},S),{},{index:B,points:[Xi(L.cx,L.cy,L.outerRadius,V),$]}),Z=p;return Tn(p)&&Tn(x)?Z="value":Tn(p)&&(Z=x),ke.createElement(Qn,{key:"label-".concat(L.startAngle,"-").concat(L.endAngle,"-").concat(L.midAngle,"-").concat(B)},s&&t.renderLabelLineItem(s,W,"line"),t.renderLabelItem(d,G,ys(L,Z)))});return ke.createElement(Qn,{className:"recharts-pie-labels"},F)}},{key:"renderSectorsStatically",value:function(i){var a=this,l=this.props,d=l.activeShape,s=l.blendStroke,p=l.inactiveShape;return i.map(function(x,w){if((x==null?void 0:x.startAngle)===0&&(x==null?void 0:x.endAngle)===0&&i.length!==1)return null;var j=a.isActiveIndex(w),S=p&&a.hasActiveIndex()?p:null,P=j?d:S,F=Cs(Cs({},x),{},{stroke:s?x.fill:x.stroke,tabIndex:-1});return ke.createElement(Qn,jv({ref:function(B){B&&!a.sectorRefs.includes(B)&&a.sectorRefs.push(B)},tabIndex:-1,className:"recharts-pie-sector"},Wp(a.props,x,w),{key:"sector-".concat(x==null?void 0:x.startAngle,"-").concat(x==null?void 0:x.endAngle,"-").concat(x.midAngle,"-").concat(w)}),ke.createElement(sP,jv({option:P,isActive:j,shapeType:"sector"},F)))})}},{key:"renderSectorsWithAnimation",value:function(){var i=this,a=this.props,l=a.sectors,d=a.isAnimationActive,s=a.animationBegin,p=a.animationDuration,x=a.animationEasing,w=a.animationId,j=this.state,S=j.prevSectors,P=j.prevIsAnimationActive;return ke.createElement(Uc,{begin:s,duration:p,isActive:d,easing:x,from:{t:0},to:{t:1},key:"pie-".concat(w,"-").concat(P),onAnimationStart:this.handleAnimationStart,onAnimationEnd:this.handleAnimationEnd},function(F){var L=F.t,B=[],V=l&&l[0],$=V.startAngle;return l.forEach(function(G,W){var Z=S&&S[W],se=W>0?Rc(G,"paddingAngle",0):0;if(Z){var ae=xs(Z.endAngle-Z.startAngle,G.endAngle-G.startAngle),ce=Cs(Cs({},G),{},{startAngle:$+se,endAngle:$+ae(L)+se});B.push(ce),$=ce.endAngle}else{var Pe=G.endAngle,we=G.startAngle,xe=xs(0,Pe-we),Ne=xe(L),ze=Cs(Cs({},G),{},{startAngle:$+se,endAngle:$+Ne+se});B.push(ze),$=ze.endAngle}}),ke.createElement(Qn,null,i.renderSectorsStatically(B))})}},{key:"attachKeyboardHandlers",value:function(i){var a=this;i.onkeydown=function(l){if(!l.altKey)switch(l.key){case"ArrowLeft":{var d=++a.state.sectorToFocus%a.sectorRefs.length;a.sectorRefs[d].focus(),a.setState({sectorToFocus:d});break}case"ArrowRight":{var s=--a.state.sectorToFocus<0?a.sectorRefs.length-1:a.state.sectorToFocus%a.sectorRefs.length;a.sectorRefs[s].focus(),a.setState({sectorToFocus:s});break}case"Escape":{a.sectorRefs[a.state.sectorToFocus].blur(),a.setState({sectorToFocus:0});break}}}}},{key:"renderSectors",value:function(){var i=this.props,a=i.sectors,l=i.isAnimationActive,d=this.state.prevSectors;return l&&a&&a.length&&(!d||!Om(d,a))?this.renderSectorsWithAnimation():this.renderSectorsStatically(a)}},{key:"componentDidMount",value:function(){this.pieRef&&this.attachKeyboardHandlers(this.pieRef)}},{key:"render",value:function(){var i=this,a=this.props,l=a.hide,d=a.sectors,s=a.className,p=a.label,x=a.cx,w=a.cy,j=a.innerRadius,S=a.outerRadius,P=a.isAnimationActive,F=this.state.isAnimationFinished;if(l||!d||!d.length||!kr(x)||!kr(w)||!kr(j)||!kr(S))return null;var L=zn("recharts-pie",s);return ke.createElement(Qn,{tabIndex:this.props.rootTabIndex,className:L,ref:function(V){i.pieRef=V}},this.renderSectors(),p&&this.renderLabels(d),ho.renderCallByParent(this.props,null,!1),(!P||F)&&_u.renderCallByParent(this.props,d,!1))}}],[{key:"getDerivedStateFromProps",value:function(i,a){return a.prevIsAnimationActive!==i.isAnimationActive?{prevIsAnimationActive:i.isAnimationActive,prevAnimationId:i.animationId,curSectors:i.sectors,prevSectors:[],isAnimationFinished:!0}:i.isAnimationActive&&i.animationId!==a.prevAnimationId?{prevAnimationId:i.animationId,curSectors:i.sectors,prevSectors:a.curSectors,isAnimationFinished:!0}:i.sectors!==a.curSectors?{curSectors:i.sectors,isAnimationFinished:!0}:null}},{key:"getTextAnchor",value:function(i,a){return i>a?"start":i<a?"end":"middle"}},{key:"renderLabelLineItem",value:function(i,a,l){if(ke.isValidElement(i))return ke.cloneElement(i,a);if(Cn(i))return i(a);var d=zn("recharts-pie-label-line",typeof i!="boolean"?i.className:"");return ke.createElement(Dp,jv({},a,{key:l,type:"linear",className:d}))}},{key:"renderLabelItem",value:function(i,a,l){if(ke.isValidElement(i))return ke.cloneElement(i,a);var d=l;if(Cn(i)&&(d=i(a),ke.isValidElement(d)))return d;var s=zn("recharts-pie-label-text",typeof i!="boolean"&&!Cn(i)?i.className:"");return ke.createElement(ix,jv({},a,{alignmentBaseline:"middle",className:s}),d)}}])}(U.PureComponent);ET=Gc;fu(Gc,"displayName","Pie");fu(Gc,"defaultProps",{stroke:"#fff",fill:"#808080",legendType:"rect",cx:"50%",cy:"50%",startAngle:0,endAngle:360,innerRadius:0,outerRadius:"80%",paddingAngle:0,labelLine:!0,hide:!1,minAngle:0,isAnimationActive:!Dc.isSsr,animationBegin:400,animationDuration:1500,animationEasing:"ease",nameKey:"name",blendStroke:!1,rootTabIndex:0});fu(Gc,"parseDeltaAngle",function(e,t){var r=bl(t-e),i=Math.min(Math.abs(t-e),360);return r*i});fu(Gc,"getRealPieData",function(e){var t=e.data,r=e.children,i=en(e,!1),a=Sl(r,jd);return t&&t.length?t.map(function(l,d){return Cs(Cs(Cs({payload:l},i),l),a&&a[d]&&a[d].props)}):a&&a.length?a.map(function(l){return Cs(Cs({},i),l.props)}):[]});fu(Gc,"parseCoordinateOfPie",function(e,t){var r=t.top,i=t.left,a=t.width,l=t.height,d=hse(a,l),s=i+_l(e.cx,a,a/2),p=r+_l(e.cy,l,l/2),x=_l(e.innerRadius,d,0),w=_l(e.outerRadius,d,d*.8),j=e.maxRadius||Math.sqrt(a*a+l*l)/2;return{cx:s,cy:p,innerRadius:x,outerRadius:w,maxRadius:j}});fu(Gc,"getComposedData",function(e){var t=e.item,r=e.offset,i=t.type.defaultProps!==void 0?Cs(Cs({},t.type.defaultProps),t.props):t.props,a=ET.getRealPieData(i);if(!a||!a.length)return null;var l=i.cornerRadius,d=i.startAngle,s=i.endAngle,p=i.paddingAngle,x=i.dataKey,w=i.nameKey,j=i.valueKey,S=i.tooltipType,P=Math.abs(i.minAngle),F=ET.parseCoordinateOfPie(i,r),L=ET.parseDeltaAngle(d,s),B=Math.abs(L),V=x;Tn(x)&&Tn(j)?(xd(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),V="value"):Tn(x)&&(xd(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),V=j);var $=a.filter(function(ce){return ys(ce,V,0)!==0}).length,G=(B>=360?$:$-1)*p,W=B-$*P-G,Z=a.reduce(function(ce,Pe){var we=ys(Pe,V,0);return ce+(kr(we)?we:0)},0),se;if(Z>0){var ae;se=a.map(function(ce,Pe){var we=ys(ce,V,0),xe=ys(ce,w,Pe),Ne=(kr(we)?we:0)/Z,ze;Pe?ze=ae.endAngle+bl(L)*p*(we!==0?1:0):ze=d;var ye=ze+bl(L)*((we!==0?P:0)+Ne*W),ve=(ze+ye)/2,_e=(F.innerRadius+F.outerRadius)/2,Ee=[{name:xe,value:we,payload:ce,dataKey:V,type:S}],je=Xi(F.cx,F.cy,_e,ve);return ae=Cs(Cs(Cs({percent:Ne,cornerRadius:l,name:xe,tooltipPayload:Ee,midAngle:ve,middleRadius:_e,tooltipPosition:je},ce),F),{},{value:ys(ce,V),startAngle:ze,endAngle:ye,payload:ce,paddingAngle:bl(L)*p}),ae})}return Cs(Cs({},F),{},{sectors:se,data:a})});function I7e(e){return e&&e.length?e[0]:void 0}var O7e=I7e,R7e=O7e;const D7e=Vi(R7e);var z7e=["key"];function kb(e){"@babel/helpers - typeof";return kb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kb(e)}function L7e(e,t){if(e==null)return{};var r=F7e(e,t),i,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)i=l[a],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}function F7e(e,t){if(e==null)return{};var r={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;r[i]=e[i]}return r}function oP(){return oP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},oP.apply(this,arguments)}function GW(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,i)}return r}function gl(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?GW(Object(r),!0).forEach(function(i){dm(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):GW(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function B7e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function HW(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,Fse(i.key),i)}}function $7e(e,t,r){return t&&HW(e.prototype,t),r&&HW(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function V7e(e,t,r){return t=lP(t),U7e(e,Lse()?Reflect.construct(t,r||[],lP(e).constructor):t.apply(e,r))}function U7e(e,t){if(t&&(kb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return G7e(e)}function G7e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Lse(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Lse=function(){return!!e})()}function lP(e){return lP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},lP(e)}function H7e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pz(e,t)}function pz(e,t){return pz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,a){return i.__proto__=a,i},pz(e,t)}function dm(e,t,r){return t=Fse(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Fse(e){var t=q7e(e,"string");return kb(t)=="symbol"?t:t+""}function q7e(e,t){if(kb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(kb(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var zp=function(e){function t(){var r;B7e(this,t);for(var i=arguments.length,a=new Array(i),l=0;l<i;l++)a[l]=arguments[l];return r=V7e(this,t,[].concat(a)),dm(r,"state",{isAnimationFinished:!1}),dm(r,"handleAnimationEnd",function(){var d=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),Cn(d)&&d()}),dm(r,"handleAnimationStart",function(){var d=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),Cn(d)&&d()}),dm(r,"handleMouseEnter",function(d){var s=r.props.onMouseEnter;s&&s(r.props,d)}),dm(r,"handleMouseLeave",function(d){var s=r.props.onMouseLeave;s&&s(r.props,d)}),r}return H7e(t,e),$7e(t,[{key:"renderDots",value:function(i){var a=this.props,l=a.dot,d=a.dataKey,s=en(this.props,!1),p=en(l,!0),x=i.map(function(w,j){var S=gl(gl(gl({key:"dot-".concat(j),r:3},s),p),{},{dataKey:d,cx:w.x,cy:w.y,index:j,payload:w});return t.renderDotItem(l,S)});return ke.createElement(Qn,{className:"recharts-radar-dots"},x)}},{key:"renderPolygonStatically",value:function(i){var a=this.props,l=a.shape,d=a.dot,s=a.isRange,p=a.baseLinePoints,x=a.connectNulls,w;return ke.isValidElement(l)?w=ke.cloneElement(l,gl(gl({},this.props),{},{points:i})):Cn(l)?w=l(gl(gl({},this.props),{},{points:i})):w=ke.createElement(Pse,oP({},en(this.props,!0),{onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,points:i,baseLinePoints:s?p:null,connectNulls:x})),ke.createElement(Qn,{className:"recharts-radar-polygon"},w,d?this.renderDots(i):null)}},{key:"renderPolygonWithAnimation",value:function(){var i=this,a=this.props,l=a.points,d=a.isAnimationActive,s=a.animationBegin,p=a.animationDuration,x=a.animationEasing,w=a.animationId,j=this.state.prevPoints;return ke.createElement(Uc,{begin:s,duration:p,isActive:d,easing:x,from:{t:0},to:{t:1},key:"radar-".concat(w),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(S){var P=S.t,F=j&&j.length/l.length,L=l.map(function(B,V){var $=j&&j[Math.floor(V*F)];if($){var G=xs($.x,B.x),W=xs($.y,B.y);return gl(gl({},B),{},{x:G(P),y:W(P)})}var Z=xs(B.cx,B.x),se=xs(B.cy,B.y);return gl(gl({},B),{},{x:Z(P),y:se(P)})});return i.renderPolygonStatically(L)})}},{key:"renderPolygon",value:function(){var i=this.props,a=i.points,l=i.isAnimationActive,d=i.isRange,s=this.state.prevPoints;return l&&a&&a.length&&!d&&(!s||!Om(s,a))?this.renderPolygonWithAnimation():this.renderPolygonStatically(a)}},{key:"render",value:function(){var i=this.props,a=i.hide,l=i.className,d=i.points,s=i.isAnimationActive;if(a||!d||!d.length)return null;var p=this.state.isAnimationFinished,x=zn("recharts-radar",l);return ke.createElement(Qn,{className:x},this.renderPolygon(),(!s||p)&&_u.renderCallByParent(this.props,d))}}],[{key:"getDerivedStateFromProps",value:function(i,a){return i.animationId!==a.prevAnimationId?{prevAnimationId:i.animationId,curPoints:i.points,prevPoints:a.curPoints}:i.points!==a.curPoints?{curPoints:i.points}:null}},{key:"renderDotItem",value:function(i,a){var l;if(ke.isValidElement(i))l=ke.cloneElement(i,a);else if(Cn(i))l=i(a);else{var d=a.key,s=L7e(a,z7e);l=ke.createElement(R_,oP({},s,{key:d,className:zn("recharts-radar-dot",typeof i!="boolean"?i.className:"")}))}return l}}])}(U.PureComponent);dm(zp,"displayName","Radar");dm(zp,"defaultProps",{angleAxisId:0,radiusAxisId:0,hide:!1,activeDot:!0,dot:!1,legendType:"rect",isAnimationActive:!Dc.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease"});dm(zp,"getComposedData",function(e){var t=e.radiusAxis,r=e.angleAxis,i=e.displayedData,a=e.dataKey,l=e.bandSize,d=r.cx,s=r.cy,p=!1,x=[],w=r.type!=="number"?l??0:0;i.forEach(function(S,P){var F=ys(S,r.dataKey,P),L=ys(S,a),B=r.scale(F)+w,V=Array.isArray(L)?gse(L):L,$=Tn(V)?void 0:t.scale(V);Array.isArray(L)&&L.length>=2&&(p=!0),x.push(gl(gl({},Xi(d,s,$,B)),{},{name:F,value:L,cx:d,cy:s,radius:$,angle:B,payload:S}))});var j=[];return p&&x.forEach(function(S){if(Array.isArray(S.value)){var P=D7e(S.value),F=Tn(P)?void 0:t.scale(P);j.push(gl(gl({},S),{},{radius:F},Xi(d,s,F,S.angle)))}else j.push(S)}),{points:x,isRange:p,baseLinePoints:j}});var W7e=Math.ceil,K7e=Math.max;function Z7e(e,t,r,i){for(var a=-1,l=K7e(W7e((t-e)/(r||1)),0),d=Array(l);l--;)d[i?l:++a]=e,e+=r;return d}var Y7e=Z7e,X7e=Yne,qW=1/0,J7e=17976931348623157e292;function Q7e(e){if(!e)return e===0?e:0;if(e=X7e(e),e===qW||e===-qW){var t=e<0?-1:1;return t*J7e}return e===e?e:0}var Bse=Q7e,eUe=Y7e,tUe=gM,qO=Bse;function rUe(e){return function(t,r,i){return i&&typeof i!="number"&&tUe(t,r,i)&&(r=i=void 0),t=qO(t),r===void 0?(r=t,t=0):r=qO(r),i=i===void 0?t<r?1:-1:qO(i),eUe(t,r,i,e)}}var nUe=rUe,iUe=nUe,sUe=iUe(),aUe=sUe;const cP=Vi(aUe);function tN(e){"@babel/helpers - typeof";return tN=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tN(e)}function WW(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,i)}return r}function KW(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?WW(Object(r),!0).forEach(function(i){$se(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):WW(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function $se(e,t,r){return t=oUe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oUe(e){var t=lUe(e,"string");return tN(t)=="symbol"?t:t+""}function lUe(e,t){if(tN(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(tN(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var cUe=["Webkit","Moz","O","ms"],uUe=function(t,r){var i=t.replace(/(\w)/,function(l){return l.toUpperCase()}),a=cUe.reduce(function(l,d){return KW(KW({},l),{},$se({},d+i,r))},{});return a[t]=r,a};function Pb(e){"@babel/helpers - typeof";return Pb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pb(e)}function uP(){return uP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},uP.apply(this,arguments)}function ZW(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,i)}return r}function WO(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ZW(Object(r),!0).forEach(function(i){vc(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ZW(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function dUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function YW(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,Use(i.key),i)}}function hUe(e,t,r){return t&&YW(e.prototype,t),r&&YW(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function mUe(e,t,r){return t=dP(t),fUe(e,Vse()?Reflect.construct(t,r||[],dP(e).constructor):t.apply(e,r))}function fUe(e,t){if(t&&(Pb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return pUe(e)}function pUe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Vse(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Vse=function(){return!!e})()}function dP(e){return dP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},dP(e)}function gUe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&gz(e,t)}function gz(e,t){return gz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,a){return i.__proto__=a,i},gz(e,t)}function vc(e,t,r){return t=Use(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Use(e){var t=xUe(e,"string");return Pb(t)=="symbol"?t:t+""}function xUe(e,t){if(Pb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(Pb(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var yUe=function(t){var r=t.data,i=t.startIndex,a=t.endIndex,l=t.x,d=t.width,s=t.travellerWidth;if(!r||!r.length)return{};var p=r.length,x=Dj().domain(cP(0,p)).range([l,l+d-s]),w=x.domain().map(function(j){return x(j)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:x(i),endX:x(a),scale:x,scaleValues:w}},XW=function(t){return t.changedTouches&&!!t.changedTouches.length},Eb=function(e){function t(r){var i;return dUe(this,t),i=mUe(this,t,[r]),vc(i,"handleDrag",function(a){i.leaveTimer&&(clearTimeout(i.leaveTimer),i.leaveTimer=null),i.state.isTravellerMoving?i.handleTravellerMove(a):i.state.isSlideMoving&&i.handleSlideDrag(a)}),vc(i,"handleTouchMove",function(a){a.changedTouches!=null&&a.changedTouches.length>0&&i.handleDrag(a.changedTouches[0])}),vc(i,"handleDragEnd",function(){i.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var a=i.props,l=a.endIndex,d=a.onDragEnd,s=a.startIndex;d==null||d({endIndex:l,startIndex:s})}),i.detachDragEndListener()}),vc(i,"handleLeaveWrapper",function(){(i.state.isTravellerMoving||i.state.isSlideMoving)&&(i.leaveTimer=window.setTimeout(i.handleDragEnd,i.props.leaveTimeOut))}),vc(i,"handleEnterSlideOrTraveller",function(){i.setState({isTextActive:!0})}),vc(i,"handleLeaveSlideOrTraveller",function(){i.setState({isTextActive:!1})}),vc(i,"handleSlideDragStart",function(a){var l=XW(a)?a.changedTouches[0]:a;i.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:l.pageX}),i.attachDragEndListener()}),i.travellerDragStartHandlers={startX:i.handleTravellerDragStart.bind(i,"startX"),endX:i.handleTravellerDragStart.bind(i,"endX")},i.state={},i}return gUe(t,e),hUe(t,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(i){var a=i.startX,l=i.endX,d=this.state.scaleValues,s=this.props,p=s.gap,x=s.data,w=x.length-1,j=Math.min(a,l),S=Math.max(a,l),P=t.getIndexInRange(d,j),F=t.getIndexInRange(d,S);return{startIndex:P-P%p,endIndex:F===w?w:F-F%p}}},{key:"getTextOfTick",value:function(i){var a=this.props,l=a.data,d=a.tickFormatter,s=a.dataKey,p=ys(l[i],s,i);return Cn(d)?d(p,i):p}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(i){var a=this.state,l=a.slideMoveStartX,d=a.startX,s=a.endX,p=this.props,x=p.x,w=p.width,j=p.travellerWidth,S=p.startIndex,P=p.endIndex,F=p.onChange,L=i.pageX-l;L>0?L=Math.min(L,x+w-j-s,x+w-j-d):L<0&&(L=Math.max(L,x-d,x-s));var B=this.getIndex({startX:d+L,endX:s+L});(B.startIndex!==S||B.endIndex!==P)&&F&&F(B),this.setState({startX:d+L,endX:s+L,slideMoveStartX:i.pageX})}},{key:"handleTravellerDragStart",value:function(i,a){var l=XW(a)?a.changedTouches[0]:a;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:i,brushMoveStartX:l.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(i){var a=this.state,l=a.brushMoveStartX,d=a.movingTravellerId,s=a.endX,p=a.startX,x=this.state[d],w=this.props,j=w.x,S=w.width,P=w.travellerWidth,F=w.onChange,L=w.gap,B=w.data,V={startX:this.state.startX,endX:this.state.endX},$=i.pageX-l;$>0?$=Math.min($,j+S-P-x):$<0&&($=Math.max($,j-x)),V[d]=x+$;var G=this.getIndex(V),W=G.startIndex,Z=G.endIndex,se=function(){var ce=B.length-1;return d==="startX"&&(s>p?W%L===0:Z%L===0)||s<p&&Z===ce||d==="endX"&&(s>p?Z%L===0:W%L===0)||s>p&&Z===ce};this.setState(vc(vc({},d,x+$),"brushMoveStartX",i.pageX),function(){F&&se()&&F(G)})}},{key:"handleTravellerMoveKeyboard",value:function(i,a){var l=this,d=this.state,s=d.scaleValues,p=d.startX,x=d.endX,w=this.state[a],j=s.indexOf(w);if(j!==-1){var S=j+i;if(!(S===-1||S>=s.length)){var P=s[S];a==="startX"&&P>=x||a==="endX"&&P<=p||this.setState(vc({},a,P),function(){l.props.onChange(l.getIndex({startX:l.state.startX,endX:l.state.endX}))})}}}},{key:"renderBackground",value:function(){var i=this.props,a=i.x,l=i.y,d=i.width,s=i.height,p=i.fill,x=i.stroke;return ke.createElement("rect",{stroke:x,fill:p,x:a,y:l,width:d,height:s})}},{key:"renderPanorama",value:function(){var i=this.props,a=i.x,l=i.y,d=i.width,s=i.height,p=i.data,x=i.children,w=i.padding,j=U.Children.only(x);return j?ke.cloneElement(j,{x:a,y:l,width:d,height:s,margin:w,compact:!0,data:p}):null}},{key:"renderTravellerLayer",value:function(i,a){var l,d,s=this,p=this.props,x=p.y,w=p.travellerWidth,j=p.height,S=p.traveller,P=p.ariaLabel,F=p.data,L=p.startIndex,B=p.endIndex,V=Math.max(i,this.props.x),$=WO(WO({},en(this.props,!1)),{},{x:V,y:x,width:w,height:j}),G=P||"Min value: ".concat((l=F[L])===null||l===void 0?void 0:l.name,", Max value: ").concat((d=F[B])===null||d===void 0?void 0:d.name);return ke.createElement(Qn,{tabIndex:0,role:"slider","aria-label":G,"aria-valuenow":i,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[a],onTouchStart:this.travellerDragStartHandlers[a],onKeyDown:function(Z){["ArrowLeft","ArrowRight"].includes(Z.key)&&(Z.preventDefault(),Z.stopPropagation(),s.handleTravellerMoveKeyboard(Z.key==="ArrowRight"?1:-1,a))},onFocus:function(){s.setState({isTravellerFocused:!0})},onBlur:function(){s.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},t.renderTraveller(S,$))}},{key:"renderSlide",value:function(i,a){var l=this.props,d=l.y,s=l.height,p=l.stroke,x=l.travellerWidth,w=Math.min(i,a)+x,j=Math.max(Math.abs(a-i)-x,0);return ke.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:p,fillOpacity:.2,x:w,y:d,width:j,height:s})}},{key:"renderText",value:function(){var i=this.props,a=i.startIndex,l=i.endIndex,d=i.y,s=i.height,p=i.travellerWidth,x=i.stroke,w=this.state,j=w.startX,S=w.endX,P=5,F={pointerEvents:"none",fill:x};return ke.createElement(Qn,{className:"recharts-brush-texts"},ke.createElement(ix,uP({textAnchor:"end",verticalAnchor:"middle",x:Math.min(j,S)-P,y:d+s/2},F),this.getTextOfTick(a)),ke.createElement(ix,uP({textAnchor:"start",verticalAnchor:"middle",x:Math.max(j,S)+p+P,y:d+s/2},F),this.getTextOfTick(l)))}},{key:"render",value:function(){var i=this.props,a=i.data,l=i.className,d=i.children,s=i.x,p=i.y,x=i.width,w=i.height,j=i.alwaysShowText,S=this.state,P=S.startX,F=S.endX,L=S.isTextActive,B=S.isSlideMoving,V=S.isTravellerMoving,$=S.isTravellerFocused;if(!a||!a.length||!kr(s)||!kr(p)||!kr(x)||!kr(w)||x<=0||w<=0)return null;var G=zn("recharts-brush",l),W=ke.Children.count(d)===1,Z=uUe("userSelect","none");return ke.createElement(Qn,{className:G,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:Z},this.renderBackground(),W&&this.renderPanorama(),this.renderSlide(P,F),this.renderTravellerLayer(P,"startX"),this.renderTravellerLayer(F,"endX"),(L||B||V||$||j)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(i){var a=i.x,l=i.y,d=i.width,s=i.height,p=i.stroke,x=Math.floor(l+s/2)-1;return ke.createElement(ke.Fragment,null,ke.createElement("rect",{x:a,y:l,width:d,height:s,fill:p,stroke:"none"}),ke.createElement("line",{x1:a+1,y1:x,x2:a+d-1,y2:x,fill:"none",stroke:"#fff"}),ke.createElement("line",{x1:a+1,y1:x+2,x2:a+d-1,y2:x+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(i,a){var l;return ke.isValidElement(i)?l=ke.cloneElement(i,a):Cn(i)?l=i(a):l=t.renderDefaultTraveller(a),l}},{key:"getDerivedStateFromProps",value:function(i,a){var l=i.data,d=i.width,s=i.x,p=i.travellerWidth,x=i.updateId,w=i.startIndex,j=i.endIndex;if(l!==a.prevData||x!==a.prevUpdateId)return WO({prevData:l,prevTravellerWidth:p,prevUpdateId:x,prevX:s,prevWidth:d},l&&l.length?yUe({data:l,width:d,x:s,travellerWidth:p,startIndex:w,endIndex:j}):{scale:null,scaleValues:null});if(a.scale&&(d!==a.prevWidth||s!==a.prevX||p!==a.prevTravellerWidth)){a.scale.range([s,s+d-p]);var S=a.scale.domain().map(function(P){return a.scale(P)});return{prevData:l,prevTravellerWidth:p,prevUpdateId:x,prevX:s,prevWidth:d,startX:a.scale(i.startIndex),endX:a.scale(i.endIndex),scaleValues:S}}return null}},{key:"getIndexInRange",value:function(i,a){for(var l=i.length,d=0,s=l-1;s-d>1;){var p=Math.floor((d+s)/2);i[p]>a?s=p:d=p}return a>=i[s]?s:d}}])}(U.PureComponent);vc(Eb,"displayName","Brush");vc(Eb,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var vUe=BB;function bUe(e,t){var r;return vUe(e,function(i,a,l){return r=t(i,a,l),!r}),!!r}var _Ue=bUe,wUe=jne,jUe=Ph,NUe=_Ue,SUe=ac,CUe=gM;function AUe(e,t,r){var i=SUe(e)?wUe:NUe;return r&&CUe(e,t,r)&&(t=void 0),i(e,jUe(t))}var TUe=AUe;const kUe=Vi(TUe);var ph=function(t,r){var i=t.alwaysShow,a=t.ifOverflow;return i&&(a="extendDomain"),a===r},JW=Hne;function PUe(e,t,r){t=="__proto__"&&JW?JW(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var EUe=PUe,MUe=EUe,IUe=Une,OUe=Ph;function RUe(e,t){var r={};return t=OUe(t),IUe(e,function(i,a,l){MUe(r,a,t(i,a,l))}),r}var DUe=RUe;const zUe=Vi(DUe);function LUe(e,t){for(var r=-1,i=e==null?0:e.length;++r<i;)if(!t(e[r],r,e))return!1;return!0}var FUe=LUe,BUe=BB;function $Ue(e,t){var r=!0;return BUe(e,function(i,a,l){return r=!!t(i,a,l),r}),r}var VUe=$Ue,UUe=FUe,GUe=VUe,HUe=Ph,qUe=ac,WUe=gM;function KUe(e,t,r){var i=qUe(e)?UUe:GUe;return r&&WUe(e,t,r)&&(t=void 0),i(e,HUe(t))}var ZUe=KUe;const Gse=Vi(ZUe);var YUe=["x","y"];function rN(e){"@babel/helpers - typeof";return rN=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rN(e)}function xz(){return xz=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},xz.apply(this,arguments)}function QW(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,i)}return r}function ij(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?QW(Object(r),!0).forEach(function(i){XUe(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):QW(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function XUe(e,t,r){return t=JUe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function JUe(e){var t=QUe(e,"string");return rN(t)=="symbol"?t:t+""}function QUe(e,t){if(rN(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(rN(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function e9e(e,t){if(e==null)return{};var r=t9e(e,t),i,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)i=l[a],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}function t9e(e,t){if(e==null)return{};var r={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;r[i]=e[i]}return r}function r9e(e,t){var r=e.x,i=e.y,a=e9e(e,YUe),l="".concat(r),d=parseInt(l,10),s="".concat(i),p=parseInt(s,10),x="".concat(t.height||a.height),w=parseInt(x,10),j="".concat(t.width||a.width),S=parseInt(j,10);return ij(ij(ij(ij(ij({},t),a),d?{x:d}:{}),p?{y:p}:{}),{},{height:w,width:S,name:t.name,radius:t.radius})}function eK(e){return ke.createElement(sP,xz({shapeType:"rectangle",propTransformer:r9e,activeClassName:"recharts-active-bar"},e))}var n9e=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(i,a){if(typeof t=="number")return t;var l=typeof i=="number";return l?t(i,a):(l||ox(),r)}},i9e=["value","background"],Hse;function Mb(e){"@babel/helpers - typeof";return Mb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mb(e)}function s9e(e,t){if(e==null)return{};var r=a9e(e,t),i,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)i=l[a],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}function a9e(e,t){if(e==null)return{};var r={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;r[i]=e[i]}return r}function hP(){return hP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},hP.apply(this,arguments)}function tK(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,i)}return r}function Oa(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?tK(Object(r),!0).forEach(function(i){wp(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tK(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function o9e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rK(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,Wse(i.key),i)}}function l9e(e,t,r){return t&&rK(e.prototype,t),r&&rK(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function c9e(e,t,r){return t=mP(t),u9e(e,qse()?Reflect.construct(t,r||[],mP(e).constructor):t.apply(e,r))}function u9e(e,t){if(t&&(Mb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return d9e(e)}function d9e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function qse(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(qse=function(){return!!e})()}function mP(e){return mP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},mP(e)}function h9e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&yz(e,t)}function yz(e,t){return yz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,a){return i.__proto__=a,i},yz(e,t)}function wp(e,t,r){return t=Wse(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Wse(e){var t=m9e(e,"string");return Mb(t)=="symbol"?t:t+""}function m9e(e,t){if(Mb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(Mb(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var pi=function(e){function t(){var r;o9e(this,t);for(var i=arguments.length,a=new Array(i),l=0;l<i;l++)a[l]=arguments[l];return r=c9e(this,t,[].concat(a)),wp(r,"state",{isAnimationFinished:!1}),wp(r,"id",og("recharts-bar-")),wp(r,"handleAnimationEnd",function(){var d=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),d&&d()}),wp(r,"handleAnimationStart",function(){var d=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),d&&d()}),r}return h9e(t,e),l9e(t,[{key:"renderRectanglesStatically",value:function(i){var a=this,l=this.props,d=l.shape,s=l.dataKey,p=l.activeIndex,x=l.activeBar,w=en(this.props,!1);return i&&i.map(function(j,S){var P=S===p,F=P?x:d,L=Oa(Oa(Oa({},w),j),{},{isActive:P,option:F,index:S,dataKey:s,onAnimationStart:a.handleAnimationStart,onAnimationEnd:a.handleAnimationEnd});return ke.createElement(Qn,hP({className:"recharts-bar-rectangle"},Wp(a.props,j,S),{key:"rectangle-".concat(j==null?void 0:j.x,"-").concat(j==null?void 0:j.y,"-").concat(j==null?void 0:j.value)}),ke.createElement(eK,L))})}},{key:"renderRectanglesWithAnimation",value:function(){var i=this,a=this.props,l=a.data,d=a.layout,s=a.isAnimationActive,p=a.animationBegin,x=a.animationDuration,w=a.animationEasing,j=a.animationId,S=this.state.prevData;return ke.createElement(Uc,{begin:p,duration:x,isActive:s,easing:w,from:{t:0},to:{t:1},key:"bar-".concat(j),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(P){var F=P.t,L=l.map(function(B,V){var $=S&&S[V];if($){var G=xs($.x,B.x),W=xs($.y,B.y),Z=xs($.width,B.width),se=xs($.height,B.height);return Oa(Oa({},B),{},{x:G(F),y:W(F),width:Z(F),height:se(F)})}if(d==="horizontal"){var ae=xs(0,B.height),ce=ae(F);return Oa(Oa({},B),{},{y:B.y+B.height-ce,height:ce})}var Pe=xs(0,B.width),we=Pe(F);return Oa(Oa({},B),{},{width:we})});return ke.createElement(Qn,null,i.renderRectanglesStatically(L))})}},{key:"renderRectangles",value:function(){var i=this.props,a=i.data,l=i.isAnimationActive,d=this.state.prevData;return l&&a&&a.length&&(!d||!Om(d,a))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(a)}},{key:"renderBackground",value:function(){var i=this,a=this.props,l=a.data,d=a.dataKey,s=a.activeIndex,p=en(this.props.background,!1);return l.map(function(x,w){x.value;var j=x.background,S=s9e(x,i9e);if(!j)return null;var P=Oa(Oa(Oa(Oa(Oa({},S),{},{fill:"#eee"},j),p),Wp(i.props,x,w)),{},{onAnimationStart:i.handleAnimationStart,onAnimationEnd:i.handleAnimationEnd,dataKey:d,index:w,className:"recharts-bar-background-rectangle"});return ke.createElement(eK,hP({key:"background-bar-".concat(w),option:i.props.background,isActive:w===s},P))})}},{key:"renderErrorBar",value:function(i,a){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var l=this.props,d=l.data,s=l.xAxis,p=l.yAxis,x=l.layout,w=l.children,j=Sl(w,I_);if(!j)return null;var S=x==="vertical"?d[0].height/2:d[0].width/2,P=function(B,V){var $=Array.isArray(B.value)?B.value[1]:B.value;return{x:B.x,y:B.y,value:$,errorVal:ys(B,V)}},F={clipPath:i?"url(#clipPath-".concat(a,")"):null};return ke.createElement(Qn,F,j.map(function(L){return ke.cloneElement(L,{key:"error-bar-".concat(a,"-").concat(L.props.dataKey),data:d,xAxis:s,yAxis:p,layout:x,offset:S,dataPointFormatter:P})}))}},{key:"render",value:function(){var i=this.props,a=i.hide,l=i.data,d=i.className,s=i.xAxis,p=i.yAxis,x=i.left,w=i.top,j=i.width,S=i.height,P=i.isAnimationActive,F=i.background,L=i.id;if(a||!l||!l.length)return null;var B=this.state.isAnimationFinished,V=zn("recharts-bar",d),$=s&&s.allowDataOverflow,G=p&&p.allowDataOverflow,W=$||G,Z=Tn(L)?this.id:L;return ke.createElement(Qn,{className:V},$||G?ke.createElement("defs",null,ke.createElement("clipPath",{id:"clipPath-".concat(Z)},ke.createElement("rect",{x:$?x:x-j/2,y:G?w:w-S/2,width:$?j:j*2,height:G?S:S*2}))):null,ke.createElement(Qn,{className:"recharts-bar-rectangles",clipPath:W?"url(#clipPath-".concat(Z,")"):null},F?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(W,Z),(!P||B)&&_u.renderCallByParent(this.props,l))}}],[{key:"getDerivedStateFromProps",value:function(i,a){return i.animationId!==a.prevAnimationId?{prevAnimationId:i.animationId,curData:i.data,prevData:a.curData}:i.data!==a.curData?{curData:i.data}:null}}])}(U.PureComponent);Hse=pi;wp(pi,"displayName","Bar");wp(pi,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!Dc.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});wp(pi,"getComposedData",function(e){var t=e.props,r=e.item,i=e.barPosition,a=e.bandSize,l=e.xAxis,d=e.yAxis,s=e.xAxisTicks,p=e.yAxisTicks,x=e.stackedData,w=e.dataStartIndex,j=e.displayedData,S=e.offset,P=RBe(i,r);if(!P)return null;var F=t.layout,L=r.type.defaultProps,B=L!==void 0?Oa(Oa({},L),r.props):r.props,V=B.dataKey,$=B.children,G=B.minPointSize,W=F==="horizontal"?d:l,Z=x?W.scale.domain():null,se=VBe({numericAxis:W}),ae=Sl($,jd),ce=j.map(function(Pe,we){var xe,Ne,ze,ye,ve,_e;x?xe=DBe(x[w+we],Z):(xe=ys(Pe,V),Array.isArray(xe)||(xe=[se,xe]));var Ee=n9e(G,Hse.defaultProps.minPointSize)(xe[1],we);if(F==="horizontal"){var je,Ce=[d.scale(xe[0]),d.scale(xe[1])],tt=Ce[0],it=Ce[1];Ne=Vq({axis:l,ticks:s,bandSize:a,offset:P.offset,entry:Pe,index:we}),ze=(je=it??tt)!==null&&je!==void 0?je:void 0,ye=P.size;var mt=tt-it;if(ve=Number.isNaN(mt)?0:mt,_e={x:Ne,y:d.y,width:ye,height:d.height},Math.abs(Ee)>0&&Math.abs(ve)<Math.abs(Ee)){var gt=bl(ve||Ee)*(Math.abs(Ee)-Math.abs(ve));ze-=gt,ve+=gt}}else{var qt=[l.scale(xe[0]),l.scale(xe[1])],yr=qt[0],tr=qt[1];if(Ne=yr,ze=Vq({axis:d,ticks:p,bandSize:a,offset:P.offset,entry:Pe,index:we}),ye=tr-yr,ve=P.size,_e={x:l.x,y:ze,width:l.width,height:ve},Math.abs(Ee)>0&&Math.abs(ye)<Math.abs(Ee)){var Ft=bl(ye||Ee)*(Math.abs(Ee)-Math.abs(ye));ye+=Ft}}return Oa(Oa(Oa({},Pe),{},{x:Ne,y:ze,width:ye,height:ve,value:x?xe:xe[1],payload:Pe,background:_e},ae&&ae[we]&&ae[we].props),{},{tooltipPayload:[use(r,Pe)],tooltipPosition:{x:Ne+ye/2,y:ze+ve/2}})});return Oa({data:ce,layout:F},S)});function nN(e){"@babel/helpers - typeof";return nN=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nN(e)}function f9e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nK(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,Kse(i.key),i)}}function p9e(e,t,r){return t&&nK(e.prototype,t),r&&nK(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function iK(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,i)}return r}function sd(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?iK(Object(r),!0).forEach(function(i){EM(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):iK(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function EM(e,t,r){return t=Kse(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Kse(e){var t=g9e(e,"string");return nN(t)=="symbol"?t:t+""}function g9e(e,t){if(nN(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(nN(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var MM=function(t,r,i,a,l){var d=t.width,s=t.height,p=t.layout,x=t.children,w=Object.keys(r),j={left:i.left,leftMirror:i.left,right:d-i.right,rightMirror:d-i.right,top:i.top,topMirror:i.top,bottom:s-i.bottom,bottomMirror:s-i.bottom},S=!!jc(x,pi);return w.reduce(function(P,F){var L=r[F],B=L.orientation,V=L.domain,$=L.padding,G=$===void 0?{}:$,W=L.mirror,Z=L.reversed,se="".concat(B).concat(W?"Mirror":""),ae,ce,Pe,we,xe;if(L.type==="number"&&(L.padding==="gap"||L.padding==="no-gap")){var Ne=V[1]-V[0],ze=1/0,ye=L.categoricalDomain.sort();if(ye.forEach(function(qt,yr){yr>0&&(ze=Math.min((qt||0)-(ye[yr-1]||0),ze))}),Number.isFinite(ze)){var ve=ze/Ne,_e=L.layout==="vertical"?i.height:i.width;if(L.padding==="gap"&&(ae=ve*_e/2),L.padding==="no-gap"){var Ee=_l(t.barCategoryGap,ve*_e),je=ve*_e/2;ae=je-Ee-(je-Ee)/_e*Ee}}}a==="xAxis"?ce=[i.left+(G.left||0)+(ae||0),i.left+i.width-(G.right||0)-(ae||0)]:a==="yAxis"?ce=p==="horizontal"?[i.top+i.height-(G.bottom||0),i.top+(G.top||0)]:[i.top+(G.top||0)+(ae||0),i.top+i.height-(G.bottom||0)-(ae||0)]:ce=L.range,Z&&(ce=[ce[1],ce[0]]);var Ce=ase(L,l,S),tt=Ce.scale,it=Ce.realScaleType;tt.domain(V).range(ce),ose(tt);var mt=lse(tt,sd(sd({},L),{},{realScaleType:it}));a==="xAxis"?(xe=B==="top"&&!W||B==="bottom"&&W,Pe=i.left,we=j[se]-xe*L.height):a==="yAxis"&&(xe=B==="left"&&!W||B==="right"&&W,Pe=j[se]-xe*L.width,we=i.top);var gt=sd(sd(sd({},L),mt),{},{realScaleType:it,x:Pe,y:we,scale:tt,width:a==="xAxis"?i.width:L.width,height:a==="yAxis"?i.height:L.height});return gt.bandSize=Kk(gt,mt),!L.hide&&a==="xAxis"?j[se]+=(xe?-1:1)*gt.height:L.hide||(j[se]+=(xe?-1:1)*gt.width),sd(sd({},P),{},EM({},F,gt))},{})},Zse=function(t,r){var i=t.x,a=t.y,l=r.x,d=r.y;return{x:Math.min(i,l),y:Math.min(a,d),width:Math.abs(l-i),height:Math.abs(d-a)}},x9e=function(t){var r=t.x1,i=t.y1,a=t.x2,l=t.y2;return Zse({x:r,y:i},{x:a,y:l})},Yse=function(){function e(t){f9e(this,e),this.scale=t}return p9e(e,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(r){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=i.bandAware,l=i.position;if(r!==void 0){if(l)switch(l){case"start":return this.scale(r);case"middle":{var d=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+d}case"end":{var s=this.bandwidth?this.bandwidth():0;return this.scale(r)+s}default:return this.scale(r)}if(a){var p=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+p}return this.scale(r)}}},{key:"isInRange",value:function(r){var i=this.range(),a=i[0],l=i[i.length-1];return a<=l?r>=a&&r<=l:r>=l&&r<=a}}],[{key:"create",value:function(r){return new e(r)}}])}();EM(Yse,"EPS",1e-4);var g6=function(t){var r=Object.keys(t).reduce(function(i,a){return sd(sd({},i),{},EM({},a,Yse.create(t[a])))},{});return sd(sd({},r),{},{apply:function(a){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},d=l.bandAware,s=l.position;return zUe(a,function(p,x){return r[x].apply(p,{bandAware:d,position:s})})},isInRange:function(a){return Gse(a,function(l,d){return r[d].isInRange(l)})}})};function y9e(e){return(e%180+180)%180}var v9e=function(t){var r=t.width,i=t.height,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,l=y9e(a),d=l*Math.PI/180,s=Math.atan(i/r),p=d>s&&d<Math.PI-s?i/Math.sin(d):r/Math.cos(d);return Math.abs(p)},b9e=Ph,_9e=nS,w9e=fM;function j9e(e){return function(t,r,i){var a=Object(t);if(!_9e(t)){var l=b9e(r);t=w9e(t),r=function(s){return l(a[s],s,a)}}var d=e(t,r,i);return d>-1?a[l?t[d]:d]:void 0}}var N9e=j9e,S9e=Bse;function C9e(e){var t=S9e(e),r=t%1;return t===t?r?t-r:t:0}var A9e=C9e,T9e=zne,k9e=Ph,P9e=A9e,E9e=Math.max;function M9e(e,t,r){var i=e==null?0:e.length;if(!i)return-1;var a=r==null?0:P9e(r);return a<0&&(a=E9e(i+a,0)),T9e(e,k9e(t),a)}var I9e=M9e,O9e=N9e,R9e=I9e,D9e=O9e(R9e),z9e=D9e;const L9e=Vi(z9e);var F9e=xAe(function(e){return{x:e.left,y:e.top,width:e.width,height:e.height}},function(e){return["l",e.left,"t",e.top,"w",e.width,"h",e.height].join("")}),x6=U.createContext(void 0),y6=U.createContext(void 0),Xse=U.createContext(void 0),Jse=U.createContext({}),Qse=U.createContext(void 0),eae=U.createContext(0),tae=U.createContext(0),sK=function(t){var r=t.state,i=r.xAxisMap,a=r.yAxisMap,l=r.offset,d=t.clipPathId,s=t.children,p=t.width,x=t.height,w=F9e(l);return ke.createElement(x6.Provider,{value:i},ke.createElement(y6.Provider,{value:a},ke.createElement(Jse.Provider,{value:l},ke.createElement(Xse.Provider,{value:w},ke.createElement(Qse.Provider,{value:d},ke.createElement(eae.Provider,{value:x},ke.createElement(tae.Provider,{value:p},s)))))))},B9e=function(){return U.useContext(Qse)},rae=function(t){var r=U.useContext(x6);r==null&&ox();var i=r[t];return i==null&&ox(),i},$9e=function(){var t=U.useContext(x6);return lp(t)},V9e=function(){var t=U.useContext(y6),r=L9e(t,function(i){return Gse(i.domain,Number.isFinite)});return r||lp(t)},nae=function(t){var r=U.useContext(y6);r==null&&ox();var i=r[t];return i==null&&ox(),i},U9e=function(){var t=U.useContext(Xse);return t},G9e=function(){return U.useContext(Jse)},v6=function(){return U.useContext(tae)},b6=function(){return U.useContext(eae)};function Ib(e){"@babel/helpers - typeof";return Ib=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ib(e)}function H9e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function q9e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,sae(i.key),i)}}function W9e(e,t,r){return t&&q9e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function K9e(e,t,r){return t=fP(t),Z9e(e,iae()?Reflect.construct(t,r||[],fP(e).constructor):t.apply(e,r))}function Z9e(e,t){if(t&&(Ib(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Y9e(e)}function Y9e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function iae(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(iae=function(){return!!e})()}function fP(e){return fP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},fP(e)}function X9e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&vz(e,t)}function vz(e,t){return vz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,a){return i.__proto__=a,i},vz(e,t)}function aK(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,i)}return r}function oK(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?aK(Object(r),!0).forEach(function(i){_6(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):aK(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function _6(e,t,r){return t=sae(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function sae(e){var t=J9e(e,"string");return Ib(t)=="symbol"?t:t+""}function J9e(e,t){if(Ib(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(Ib(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Q9e(e,t){return nGe(e)||rGe(e,t)||tGe(e,t)||eGe()}function eGe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tGe(e,t){if(e){if(typeof e=="string")return lK(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return lK(e,t)}}function lK(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function rGe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var i,a,l,d,s=[],p=!0,x=!1;try{if(l=(r=r.call(e)).next,t!==0)for(;!(p=(i=l.call(r)).done)&&(s.push(i.value),s.length!==t);p=!0);}catch(w){x=!0,a=w}finally{try{if(!p&&r.return!=null&&(d=r.return(),Object(d)!==d))return}finally{if(x)throw a}}return s}}function nGe(e){if(Array.isArray(e))return e}function bz(){return bz=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},bz.apply(this,arguments)}var iGe=function(t,r){var i;return ke.isValidElement(t)?i=ke.cloneElement(t,r):Cn(t)?i=t(r):i=ke.createElement("line",bz({},r,{className:"recharts-reference-line-line"})),i},sGe=function(t,r,i,a,l,d,s,p,x){var w=l.x,j=l.y,S=l.width,P=l.height;if(i){var F=x.y,L=t.y.apply(F,{position:d});if(ph(x,"discard")&&!t.y.isInRange(L))return null;var B=[{x:w+S,y:L},{x:w,y:L}];return p==="left"?B.reverse():B}if(r){var V=x.x,$=t.x.apply(V,{position:d});if(ph(x,"discard")&&!t.x.isInRange($))return null;var G=[{x:$,y:j+P},{x:$,y:j}];return s==="top"?G.reverse():G}if(a){var W=x.segment,Z=W.map(function(se){return t.apply(se,{position:d})});return ph(x,"discard")&&kUe(Z,function(se){return!t.isInRange(se)})?null:Z}return null};function aGe(e){var t=e.x,r=e.y,i=e.segment,a=e.xAxisId,l=e.yAxisId,d=e.shape,s=e.className,p=e.alwaysShow,x=B9e(),w=rae(a),j=nae(l),S=U9e();if(!x||!S)return null;xd(p===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var P=g6({x:w.scale,y:j.scale}),F=Qa(t),L=Qa(r),B=i&&i.length===2,V=sGe(P,F,L,B,S,e.position,w.orientation,j.orientation,e);if(!V)return null;var $=Q9e(V,2),G=$[0],W=G.x,Z=G.y,se=$[1],ae=se.x,ce=se.y,Pe=ph(e,"hidden")?"url(#".concat(x,")"):void 0,we=oK(oK({clipPath:Pe},en(e,!0)),{},{x1:W,y1:Z,x2:ae,y2:ce});return ke.createElement(Qn,{className:zn("recharts-reference-line",s)},iGe(d,we),ho.renderCallByParent(e,x9e({x1:W,y1:Z,x2:ae,y2:ce})))}var w6=function(e){function t(){return H9e(this,t),K9e(this,t,arguments)}return X9e(t,e),W9e(t,[{key:"render",value:function(){return ke.createElement(aGe,this.props)}}])}(ke.Component);_6(w6,"displayName","ReferenceLine");_6(w6,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function _z(){return _z=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},_z.apply(this,arguments)}function Ob(e){"@babel/helpers - typeof";return Ob=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ob(e)}function cK(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,i)}return r}function uK(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?cK(Object(r),!0).forEach(function(i){IM(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):cK(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function oGe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lGe(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,oae(i.key),i)}}function cGe(e,t,r){return t&&lGe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function uGe(e,t,r){return t=pP(t),dGe(e,aae()?Reflect.construct(t,r||[],pP(e).constructor):t.apply(e,r))}function dGe(e,t){if(t&&(Ob(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hGe(e)}function hGe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function aae(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(aae=function(){return!!e})()}function pP(e){return pP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},pP(e)}function mGe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&wz(e,t)}function wz(e,t){return wz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,a){return i.__proto__=a,i},wz(e,t)}function IM(e,t,r){return t=oae(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oae(e){var t=fGe(e,"string");return Ob(t)=="symbol"?t:t+""}function fGe(e,t){if(Ob(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(Ob(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var pGe=function(t){var r=t.x,i=t.y,a=t.xAxis,l=t.yAxis,d=g6({x:a.scale,y:l.scale}),s=d.apply({x:r,y:i},{bandAware:!0});return ph(t,"discard")&&!d.isInRange(s)?null:s},OM=function(e){function t(){return oGe(this,t),uGe(this,t,arguments)}return mGe(t,e),cGe(t,[{key:"render",value:function(){var i=this.props,a=i.x,l=i.y,d=i.r,s=i.alwaysShow,p=i.clipPathId,x=Qa(a),w=Qa(l);if(xd(s===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!x||!w)return null;var j=pGe(this.props);if(!j)return null;var S=j.x,P=j.y,F=this.props,L=F.shape,B=F.className,V=ph(this.props,"hidden")?"url(#".concat(p,")"):void 0,$=uK(uK({clipPath:V},en(this.props,!0)),{},{cx:S,cy:P});return ke.createElement(Qn,{className:zn("recharts-reference-dot",B)},t.renderDot(L,$),ho.renderCallByParent(this.props,{x:S-d,y:P-d,width:2*d,height:2*d}))}}])}(ke.Component);IM(OM,"displayName","ReferenceDot");IM(OM,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});IM(OM,"renderDot",function(e,t){var r;return ke.isValidElement(e)?r=ke.cloneElement(e,t):Cn(e)?r=e(t):r=ke.createElement(R_,_z({},t,{cx:t.cx,cy:t.cy,className:"recharts-reference-dot-dot"})),r});function jz(){return jz=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},jz.apply(this,arguments)}function Rb(e){"@babel/helpers - typeof";return Rb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rb(e)}function dK(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,i)}return r}function hK(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?dK(Object(r),!0).forEach(function(i){RM(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):dK(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function gGe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xGe(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,cae(i.key),i)}}function yGe(e,t,r){return t&&xGe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function vGe(e,t,r){return t=gP(t),bGe(e,lae()?Reflect.construct(t,r||[],gP(e).constructor):t.apply(e,r))}function bGe(e,t){if(t&&(Rb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _Ge(e)}function _Ge(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lae(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(lae=function(){return!!e})()}function gP(e){return gP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},gP(e)}function wGe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Nz(e,t)}function Nz(e,t){return Nz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,a){return i.__proto__=a,i},Nz(e,t)}function RM(e,t,r){return t=cae(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cae(e){var t=jGe(e,"string");return Rb(t)=="symbol"?t:t+""}function jGe(e,t){if(Rb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(Rb(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var NGe=function(t,r,i,a,l){var d=l.x1,s=l.x2,p=l.y1,x=l.y2,w=l.xAxis,j=l.yAxis;if(!w||!j)return null;var S=g6({x:w.scale,y:j.scale}),P={x:t?S.x.apply(d,{position:"start"}):S.x.rangeMin,y:i?S.y.apply(p,{position:"start"}):S.y.rangeMin},F={x:r?S.x.apply(s,{position:"end"}):S.x.rangeMax,y:a?S.y.apply(x,{position:"end"}):S.y.rangeMax};return ph(l,"discard")&&(!S.isInRange(P)||!S.isInRange(F))?null:Zse(P,F)},DM=function(e){function t(){return gGe(this,t),vGe(this,t,arguments)}return wGe(t,e),yGe(t,[{key:"render",value:function(){var i=this.props,a=i.x1,l=i.x2,d=i.y1,s=i.y2,p=i.className,x=i.alwaysShow,w=i.clipPathId;xd(x===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var j=Qa(a),S=Qa(l),P=Qa(d),F=Qa(s),L=this.props.shape;if(!j&&!S&&!P&&!F&&!L)return null;var B=NGe(j,S,P,F,this.props);if(!B&&!L)return null;var V=ph(this.props,"hidden")?"url(#".concat(w,")"):void 0;return ke.createElement(Qn,{className:zn("recharts-reference-area",p)},t.renderRect(L,hK(hK({clipPath:V},en(this.props,!0)),B)),ho.renderCallByParent(this.props,B))}}])}(ke.Component);RM(DM,"displayName","ReferenceArea");RM(DM,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});RM(DM,"renderRect",function(e,t){var r;return ke.isValidElement(e)?r=ke.cloneElement(e,t):Cn(e)?r=e(t):r=ke.createElement(f6,jz({},t,{className:"recharts-reference-area-rect"})),r});function uae(e,t,r){if(t<1)return[];if(t===1&&r===void 0)return e;for(var i=[],a=0;a<e.length;a+=t)i.push(e[a]);return i}function SGe(e,t,r){var i={width:e.width+t.width,height:e.height+t.height};return v9e(i,r)}function CGe(e,t,r){var i=r==="width",a=e.x,l=e.y,d=e.width,s=e.height;return t===1?{start:i?a:l,end:i?a+d:l+s}:{start:i?a+d:l+s,end:i?a:l}}function xP(e,t,r,i,a){if(e*t<e*i||e*t>e*a)return!1;var l=r();return e*(t-e*l/2-i)>=0&&e*(t+e*l/2-a)<=0}function AGe(e,t){return uae(e,t+1)}function TGe(e,t,r,i,a){for(var l=(i||[]).slice(),d=t.start,s=t.end,p=0,x=1,w=d,j=function(){var F=i==null?void 0:i[p];if(F===void 0)return{v:uae(i,x)};var L=p,B,V=function(){return B===void 0&&(B=r(F,L)),B},$=F.coordinate,G=p===0||xP(e,$,V,w,s);G||(p=0,w=d,x+=1),G&&(w=$+e*(V()/2+a),p+=x)},S;x<=l.length;)if(S=j(),S)return S.v;return[]}function iN(e){"@babel/helpers - typeof";return iN=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},iN(e)}function mK(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,i)}return r}function Ho(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?mK(Object(r),!0).forEach(function(i){kGe(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):mK(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function kGe(e,t,r){return t=PGe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function PGe(e){var t=EGe(e,"string");return iN(t)=="symbol"?t:t+""}function EGe(e,t){if(iN(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(iN(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function MGe(e,t,r,i,a){for(var l=(i||[]).slice(),d=l.length,s=t.start,p=t.end,x=function(S){var P=l[S],F,L=function(){return F===void 0&&(F=r(P,S)),F};if(S===d-1){var B=e*(P.coordinate+e*L()/2-p);l[S]=P=Ho(Ho({},P),{},{tickCoord:B>0?P.coordinate-B*e:P.coordinate})}else l[S]=P=Ho(Ho({},P),{},{tickCoord:P.coordinate});var V=xP(e,P.tickCoord,L,s,p);V&&(p=P.tickCoord-e*(L()/2+a),l[S]=Ho(Ho({},P),{},{isShow:!0}))},w=d-1;w>=0;w--)x(w);return l}function IGe(e,t,r,i,a,l){var d=(i||[]).slice(),s=d.length,p=t.start,x=t.end;if(l){var w=i[s-1],j=r(w,s-1),S=e*(w.coordinate+e*j/2-x);d[s-1]=w=Ho(Ho({},w),{},{tickCoord:S>0?w.coordinate-S*e:w.coordinate});var P=xP(e,w.tickCoord,function(){return j},p,x);P&&(x=w.tickCoord-e*(j/2+a),d[s-1]=Ho(Ho({},w),{},{isShow:!0}))}for(var F=l?s-1:s,L=function($){var G=d[$],W,Z=function(){return W===void 0&&(W=r(G,$)),W};if($===0){var se=e*(G.coordinate-e*Z()/2-p);d[$]=G=Ho(Ho({},G),{},{tickCoord:se<0?G.coordinate-se*e:G.coordinate})}else d[$]=G=Ho(Ho({},G),{},{tickCoord:G.coordinate});var ae=xP(e,G.tickCoord,Z,p,x);ae&&(p=G.tickCoord+e*(Z()/2+a),d[$]=Ho(Ho({},G),{},{isShow:!0}))},B=0;B<F;B++)L(B);return d}function j6(e,t,r){var i=e.tick,a=e.ticks,l=e.viewBox,d=e.minTickGap,s=e.orientation,p=e.interval,x=e.tickFormatter,w=e.unit,j=e.angle;if(!a||!a.length||!i)return[];if(kr(p)||Dc.isSsr)return AGe(a,typeof p=="number"&&kr(p)?p:0);var S=[],P=s==="top"||s==="bottom"?"width":"height",F=w&&P==="width"?Rj(w,{fontSize:t,letterSpacing:r}):{width:0,height:0},L=function(G,W){var Z=Cn(x)?x(G.value,W):G.value;return P==="width"?SGe(Rj(Z,{fontSize:t,letterSpacing:r}),F,j):Rj(Z,{fontSize:t,letterSpacing:r})[P]},B=a.length>=2?bl(a[1].coordinate-a[0].coordinate):1,V=CGe(l,B,P);return p==="equidistantPreserveStart"?TGe(B,V,L,a,d):(p==="preserveStart"||p==="preserveStartEnd"?S=IGe(B,V,L,a,d,p==="preserveStartEnd"):S=MGe(B,V,L,a,d),S.filter(function($){return $.isShow}))}var OGe=["viewBox"],RGe=["viewBox"],DGe=["ticks"];function Db(e){"@babel/helpers - typeof";return Db=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Db(e)}function Nv(){return Nv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},Nv.apply(this,arguments)}function fK(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,i)}return r}function fl(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?fK(Object(r),!0).forEach(function(i){N6(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fK(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function KO(e,t){if(e==null)return{};var r=zGe(e,t),i,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)i=l[a],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}function zGe(e,t){if(e==null)return{};var r={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;r[i]=e[i]}return r}function LGe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pK(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,hae(i.key),i)}}function FGe(e,t,r){return t&&pK(e.prototype,t),r&&pK(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function BGe(e,t,r){return t=yP(t),$Ge(e,dae()?Reflect.construct(t,r||[],yP(e).constructor):t.apply(e,r))}function $Ge(e,t){if(t&&(Db(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return VGe(e)}function VGe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dae(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(dae=function(){return!!e})()}function yP(e){return yP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},yP(e)}function UGe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Sz(e,t)}function Sz(e,t){return Sz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,a){return i.__proto__=a,i},Sz(e,t)}function N6(e,t,r){return t=hae(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function hae(e){var t=GGe(e,"string");return Db(t)=="symbol"?t:t+""}function GGe(e,t){if(Db(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(Db(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var D_=function(e){function t(r){var i;return LGe(this,t),i=BGe(this,t,[r]),i.state={fontSize:"",letterSpacing:""},i}return UGe(t,e),FGe(t,[{key:"shouldComponentUpdate",value:function(i,a){var l=i.viewBox,d=KO(i,OGe),s=this.props,p=s.viewBox,x=KO(s,RGe);return!Lv(l,p)||!Lv(d,x)||!Lv(a,this.state)}},{key:"componentDidMount",value:function(){var i=this.layerReference;if(i){var a=i.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];a&&this.setState({fontSize:window.getComputedStyle(a).fontSize,letterSpacing:window.getComputedStyle(a).letterSpacing})}}},{key:"getTickLineCoord",value:function(i){var a=this.props,l=a.x,d=a.y,s=a.width,p=a.height,x=a.orientation,w=a.tickSize,j=a.mirror,S=a.tickMargin,P,F,L,B,V,$,G=j?-1:1,W=i.tickSize||w,Z=kr(i.tickCoord)?i.tickCoord:i.coordinate;switch(x){case"top":P=F=i.coordinate,B=d+ +!j*p,L=B-G*W,$=L-G*S,V=Z;break;case"left":L=B=i.coordinate,F=l+ +!j*s,P=F-G*W,V=P-G*S,$=Z;break;case"right":L=B=i.coordinate,F=l+ +j*s,P=F+G*W,V=P+G*S,$=Z;break;default:P=F=i.coordinate,B=d+ +j*p,L=B+G*W,$=L+G*S,V=Z;break}return{line:{x1:P,y1:L,x2:F,y2:B},tick:{x:V,y:$}}}},{key:"getTickTextAnchor",value:function(){var i=this.props,a=i.orientation,l=i.mirror,d;switch(a){case"left":d=l?"start":"end";break;case"right":d=l?"end":"start";break;default:d="middle";break}return d}},{key:"getTickVerticalAnchor",value:function(){var i=this.props,a=i.orientation,l=i.mirror,d="end";switch(a){case"left":case"right":d="middle";break;case"top":d=l?"start":"end";break;default:d=l?"end":"start";break}return d}},{key:"renderAxisLine",value:function(){var i=this.props,a=i.x,l=i.y,d=i.width,s=i.height,p=i.orientation,x=i.mirror,w=i.axisLine,j=fl(fl(fl({},en(this.props,!1)),en(w,!1)),{},{fill:"none"});if(p==="top"||p==="bottom"){var S=+(p==="top"&&!x||p==="bottom"&&x);j=fl(fl({},j),{},{x1:a,y1:l+S*s,x2:a+d,y2:l+S*s})}else{var P=+(p==="left"&&!x||p==="right"&&x);j=fl(fl({},j),{},{x1:a+P*d,y1:l,x2:a+P*d,y2:l+s})}return ke.createElement("line",Nv({},j,{className:zn("recharts-cartesian-axis-line",Rc(w,"className"))}))}},{key:"renderTicks",value:function(i,a,l){var d=this,s=this.props,p=s.tickLine,x=s.stroke,w=s.tick,j=s.tickFormatter,S=s.unit,P=j6(fl(fl({},this.props),{},{ticks:i}),a,l),F=this.getTickTextAnchor(),L=this.getTickVerticalAnchor(),B=en(this.props,!1),V=en(w,!1),$=fl(fl({},B),{},{fill:"none"},en(p,!1)),G=P.map(function(W,Z){var se=d.getTickLineCoord(W),ae=se.line,ce=se.tick,Pe=fl(fl(fl(fl({textAnchor:F,verticalAnchor:L},B),{},{stroke:"none",fill:x},V),ce),{},{index:Z,payload:W,visibleTicksCount:P.length,tickFormatter:j});return ke.createElement(Qn,Nv({className:"recharts-cartesian-axis-tick",key:"tick-".concat(W.value,"-").concat(W.coordinate,"-").concat(W.tickCoord)},Wp(d.props,W,Z)),p&&ke.createElement("line",Nv({},$,ae,{className:zn("recharts-cartesian-axis-tick-line",Rc(p,"className"))})),w&&t.renderTickItem(w,Pe,"".concat(Cn(j)?j(W.value,Z):W.value).concat(S||"")))});return ke.createElement("g",{className:"recharts-cartesian-axis-ticks"},G)}},{key:"render",value:function(){var i=this,a=this.props,l=a.axisLine,d=a.width,s=a.height,p=a.ticksGenerator,x=a.className,w=a.hide;if(w)return null;var j=this.props,S=j.ticks,P=KO(j,DGe),F=S;return Cn(p)&&(F=S&&S.length>0?p(this.props):p(P)),d<=0||s<=0||!F||!F.length?null:ke.createElement(Qn,{className:zn("recharts-cartesian-axis",x),ref:function(B){i.layerReference=B}},l&&this.renderAxisLine(),this.renderTicks(F,this.state.fontSize,this.state.letterSpacing),ho.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(i,a,l){var d;return ke.isValidElement(i)?d=ke.cloneElement(i,a):Cn(i)?d=i(a):d=ke.createElement(ix,Nv({},a,{className:"recharts-cartesian-axis-tick-value"}),l),d}}])}(U.Component);N6(D_,"displayName","CartesianAxis");N6(D_,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var HGe=["x1","y1","x2","y2","key"],qGe=["offset"];function lx(e){"@babel/helpers - typeof";return lx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lx(e)}function gK(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,i)}return r}function Ko(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?gK(Object(r),!0).forEach(function(i){WGe(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):gK(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function WGe(e,t,r){return t=KGe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function KGe(e){var t=ZGe(e,"string");return lx(t)=="symbol"?t:t+""}function ZGe(e,t){if(lx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(lx(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function I0(){return I0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},I0.apply(this,arguments)}function xK(e,t){if(e==null)return{};var r=YGe(e,t),i,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)i=l[a],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}function YGe(e,t){if(e==null)return{};var r={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;r[i]=e[i]}return r}var XGe=function(t){var r=t.fill;if(!r||r==="none")return null;var i=t.fillOpacity,a=t.x,l=t.y,d=t.width,s=t.height,p=t.ry;return ke.createElement("rect",{x:a,y:l,ry:p,width:d,height:s,stroke:"none",fill:r,fillOpacity:i,className:"recharts-cartesian-grid-bg"})};function mae(e,t){var r;if(ke.isValidElement(e))r=ke.cloneElement(e,t);else if(Cn(e))r=e(t);else{var i=t.x1,a=t.y1,l=t.x2,d=t.y2,s=t.key,p=xK(t,HGe),x=en(p,!1);x.offset;var w=xK(x,qGe);r=ke.createElement("line",I0({},w,{x1:i,y1:a,x2:l,y2:d,fill:"none",key:s}))}return r}function JGe(e){var t=e.x,r=e.width,i=e.horizontal,a=i===void 0?!0:i,l=e.horizontalPoints;if(!a||!l||!l.length)return null;var d=l.map(function(s,p){var x=Ko(Ko({},e),{},{x1:t,y1:s,x2:t+r,y2:s,key:"line-".concat(p),index:p});return mae(a,x)});return ke.createElement("g",{className:"recharts-cartesian-grid-horizontal"},d)}function QGe(e){var t=e.y,r=e.height,i=e.vertical,a=i===void 0?!0:i,l=e.verticalPoints;if(!a||!l||!l.length)return null;var d=l.map(function(s,p){var x=Ko(Ko({},e),{},{x1:s,y1:t,x2:s,y2:t+r,key:"line-".concat(p),index:p});return mae(a,x)});return ke.createElement("g",{className:"recharts-cartesian-grid-vertical"},d)}function eHe(e){var t=e.horizontalFill,r=e.fillOpacity,i=e.x,a=e.y,l=e.width,d=e.height,s=e.horizontalPoints,p=e.horizontal,x=p===void 0?!0:p;if(!x||!t||!t.length)return null;var w=s.map(function(S){return Math.round(S+a-a)}).sort(function(S,P){return S-P});a!==w[0]&&w.unshift(0);var j=w.map(function(S,P){var F=!w[P+1],L=F?a+d-S:w[P+1]-S;if(L<=0)return null;var B=P%t.length;return ke.createElement("rect",{key:"react-".concat(P),y:S,x:i,height:L,width:l,stroke:"none",fill:t[B],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return ke.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},j)}function tHe(e){var t=e.vertical,r=t===void 0?!0:t,i=e.verticalFill,a=e.fillOpacity,l=e.x,d=e.y,s=e.width,p=e.height,x=e.verticalPoints;if(!r||!i||!i.length)return null;var w=x.map(function(S){return Math.round(S+l-l)}).sort(function(S,P){return S-P});l!==w[0]&&w.unshift(0);var j=w.map(function(S,P){var F=!w[P+1],L=F?l+s-S:w[P+1]-S;if(L<=0)return null;var B=P%i.length;return ke.createElement("rect",{key:"react-".concat(P),x:S,y:d,width:L,height:p,stroke:"none",fill:i[B],fillOpacity:a,className:"recharts-cartesian-grid-bg"})});return ke.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},j)}var rHe=function(t,r){var i=t.xAxis,a=t.width,l=t.height,d=t.offset;return sse(j6(Ko(Ko(Ko({},D_.defaultProps),i),{},{ticks:xm(i,!0),viewBox:{x:0,y:0,width:a,height:l}})),d.left,d.left+d.width,r)},nHe=function(t,r){var i=t.yAxis,a=t.width,l=t.height,d=t.offset;return sse(j6(Ko(Ko(Ko({},D_.defaultProps),i),{},{ticks:xm(i,!0),viewBox:{x:0,y:0,width:a,height:l}})),d.top,d.top+d.height,r)},Ky={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function $s(e){var t,r,i,a,l,d,s=v6(),p=b6(),x=G9e(),w=Ko(Ko({},e),{},{stroke:(t=e.stroke)!==null&&t!==void 0?t:Ky.stroke,fill:(r=e.fill)!==null&&r!==void 0?r:Ky.fill,horizontal:(i=e.horizontal)!==null&&i!==void 0?i:Ky.horizontal,horizontalFill:(a=e.horizontalFill)!==null&&a!==void 0?a:Ky.horizontalFill,vertical:(l=e.vertical)!==null&&l!==void 0?l:Ky.vertical,verticalFill:(d=e.verticalFill)!==null&&d!==void 0?d:Ky.verticalFill,x:kr(e.x)?e.x:x.left,y:kr(e.y)?e.y:x.top,width:kr(e.width)?e.width:x.width,height:kr(e.height)?e.height:x.height}),j=w.x,S=w.y,P=w.width,F=w.height,L=w.syncWithTicks,B=w.horizontalValues,V=w.verticalValues,$=$9e(),G=V9e();if(!kr(P)||P<=0||!kr(F)||F<=0||!kr(j)||j!==+j||!kr(S)||S!==+S)return null;var W=w.verticalCoordinatesGenerator||rHe,Z=w.horizontalCoordinatesGenerator||nHe,se=w.horizontalPoints,ae=w.verticalPoints;if((!se||!se.length)&&Cn(Z)){var ce=B&&B.length,Pe=Z({yAxis:G?Ko(Ko({},G),{},{ticks:ce?B:G.ticks}):void 0,width:s,height:p,offset:x},ce?!0:L);xd(Array.isArray(Pe),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(lx(Pe),"]")),Array.isArray(Pe)&&(se=Pe)}if((!ae||!ae.length)&&Cn(W)){var we=V&&V.length,xe=W({xAxis:$?Ko(Ko({},$),{},{ticks:we?V:$.ticks}):void 0,width:s,height:p,offset:x},we?!0:L);xd(Array.isArray(xe),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(lx(xe),"]")),Array.isArray(xe)&&(ae=xe)}return ke.createElement("g",{className:"recharts-cartesian-grid"},ke.createElement(XGe,{fill:w.fill,fillOpacity:w.fillOpacity,x:w.x,y:w.y,width:w.width,height:w.height,ry:w.ry}),ke.createElement(JGe,I0({},w,{offset:x,horizontalPoints:se,xAxis:$,yAxis:G})),ke.createElement(QGe,I0({},w,{offset:x,verticalPoints:ae,xAxis:$,yAxis:G})),ke.createElement(eHe,I0({},w,{horizontalPoints:se})),ke.createElement(tHe,I0({},w,{verticalPoints:ae})))}$s.displayName="CartesianGrid";var iHe=["type","layout","connectNulls","ref"],sHe=["key"];function zb(e){"@babel/helpers - typeof";return zb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zb(e)}function yK(e,t){if(e==null)return{};var r=aHe(e,t),i,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)i=l[a],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}function aHe(e,t){if(e==null)return{};var r={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;r[i]=e[i]}return r}function $j(){return $j=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},$j.apply(this,arguments)}function vK(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,i)}return r}function xc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?vK(Object(r),!0).forEach(function(i){ad(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vK(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function Zy(e){return uHe(e)||cHe(e)||lHe(e)||oHe()}function oHe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lHe(e,t){if(e){if(typeof e=="string")return Cz(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Cz(e,t)}}function cHe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function uHe(e){if(Array.isArray(e))return Cz(e)}function Cz(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function dHe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bK(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,pae(i.key),i)}}function hHe(e,t,r){return t&&bK(e.prototype,t),r&&bK(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function mHe(e,t,r){return t=vP(t),fHe(e,fae()?Reflect.construct(t,r||[],vP(e).constructor):t.apply(e,r))}function fHe(e,t){if(t&&(zb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return pHe(e)}function pHe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fae(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(fae=function(){return!!e})()}function vP(e){return vP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},vP(e)}function gHe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Az(e,t)}function Az(e,t){return Az=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,a){return i.__proto__=a,i},Az(e,t)}function ad(e,t,r){return t=pae(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pae(e){var t=xHe(e,"string");return zb(t)=="symbol"?t:t+""}function xHe(e,t){if(zb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(zb(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var jl=function(e){function t(){var r;dHe(this,t);for(var i=arguments.length,a=new Array(i),l=0;l<i;l++)a[l]=arguments[l];return r=mHe(this,t,[].concat(a)),ad(r,"state",{isAnimationFinished:!0,totalLength:0}),ad(r,"generateSimpleStrokeDasharray",function(d,s){return"".concat(s,"px ").concat(d-s,"px")}),ad(r,"getStrokeDasharray",function(d,s,p){var x=p.reduce(function(V,$){return V+$});if(!x)return r.generateSimpleStrokeDasharray(s,d);for(var w=Math.floor(d/x),j=d%x,S=s-d,P=[],F=0,L=0;F<p.length;L+=p[F],++F)if(L+p[F]>j){P=[].concat(Zy(p.slice(0,F)),[j-L]);break}var B=P.length%2===0?[0,S]:[S];return[].concat(Zy(t.repeat(p,w)),Zy(P),B).map(function(V){return"".concat(V,"px")}).join(", ")}),ad(r,"id",og("recharts-line-")),ad(r,"pathRef",function(d){r.mainCurve=d}),ad(r,"handleAnimationEnd",function(){r.setState({isAnimationFinished:!0}),r.props.onAnimationEnd&&r.props.onAnimationEnd()}),ad(r,"handleAnimationStart",function(){r.setState({isAnimationFinished:!1}),r.props.onAnimationStart&&r.props.onAnimationStart()}),r}return gHe(t,e),hHe(t,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var i=this.getTotalLength();this.setState({totalLength:i})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var i=this.getTotalLength();i!==this.state.totalLength&&this.setState({totalLength:i})}}},{key:"getTotalLength",value:function(){var i=this.mainCurve;try{return i&&i.getTotalLength&&i.getTotalLength()||0}catch{return 0}}},{key:"renderErrorBar",value:function(i,a){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var l=this.props,d=l.points,s=l.xAxis,p=l.yAxis,x=l.layout,w=l.children,j=Sl(w,I_);if(!j)return null;var S=function(L,B){return{x:L.x,y:L.y,value:L.value,errorVal:ys(L.payload,B)}},P={clipPath:i?"url(#clipPath-".concat(a,")"):null};return ke.createElement(Qn,P,j.map(function(F){return ke.cloneElement(F,{key:"bar-".concat(F.props.dataKey),data:d,xAxis:s,yAxis:p,layout:x,dataPointFormatter:S})}))}},{key:"renderDots",value:function(i,a,l){var d=this.props.isAnimationActive;if(d&&!this.state.isAnimationFinished)return null;var s=this.props,p=s.dot,x=s.points,w=s.dataKey,j=en(this.props,!1),S=en(p,!0),P=x.map(function(L,B){var V=xc(xc(xc({key:"dot-".concat(B),r:3},j),S),{},{value:L.value,dataKey:w,cx:L.x,cy:L.y,index:B,payload:L.payload});return t.renderDotItem(p,V)}),F={clipPath:i?"url(#clipPath-".concat(a?"":"dots-").concat(l,")"):null};return ke.createElement(Qn,$j({className:"recharts-line-dots",key:"dots"},F),P)}},{key:"renderCurveStatically",value:function(i,a,l,d){var s=this.props,p=s.type,x=s.layout,w=s.connectNulls;s.ref;var j=yK(s,iHe),S=xc(xc(xc({},en(j,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:a?"url(#clipPath-".concat(l,")"):null,points:i},d),{},{type:p,layout:x,connectNulls:w});return ke.createElement(Dp,$j({},S,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(i,a){var l=this,d=this.props,s=d.points,p=d.strokeDasharray,x=d.isAnimationActive,w=d.animationBegin,j=d.animationDuration,S=d.animationEasing,P=d.animationId,F=d.animateNewValues,L=d.width,B=d.height,V=this.state,$=V.prevPoints,G=V.totalLength;return ke.createElement(Uc,{begin:w,duration:j,isActive:x,easing:S,from:{t:0},to:{t:1},key:"line-".concat(P),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(W){var Z=W.t;if($){var se=$.length/s.length,ae=s.map(function(Ne,ze){var ye=Math.floor(ze*se);if($[ye]){var ve=$[ye],_e=xs(ve.x,Ne.x),Ee=xs(ve.y,Ne.y);return xc(xc({},Ne),{},{x:_e(Z),y:Ee(Z)})}if(F){var je=xs(L*2,Ne.x),Ce=xs(B/2,Ne.y);return xc(xc({},Ne),{},{x:je(Z),y:Ce(Z)})}return xc(xc({},Ne),{},{x:Ne.x,y:Ne.y})});return l.renderCurveStatically(ae,i,a)}var ce=xs(0,G),Pe=ce(Z),we;if(p){var xe="".concat(p).split(/[,\s]+/gim).map(function(Ne){return parseFloat(Ne)});we=l.getStrokeDasharray(Pe,G,xe)}else we=l.generateSimpleStrokeDasharray(G,Pe);return l.renderCurveStatically(s,i,a,{strokeDasharray:we})})}},{key:"renderCurve",value:function(i,a){var l=this.props,d=l.points,s=l.isAnimationActive,p=this.state,x=p.prevPoints,w=p.totalLength;return s&&d&&d.length&&(!x&&w>0||!Om(x,d))?this.renderCurveWithAnimation(i,a):this.renderCurveStatically(d,i,a)}},{key:"render",value:function(){var i,a=this.props,l=a.hide,d=a.dot,s=a.points,p=a.className,x=a.xAxis,w=a.yAxis,j=a.top,S=a.left,P=a.width,F=a.height,L=a.isAnimationActive,B=a.id;if(l||!s||!s.length)return null;var V=this.state.isAnimationFinished,$=s.length===1,G=zn("recharts-line",p),W=x&&x.allowDataOverflow,Z=w&&w.allowDataOverflow,se=W||Z,ae=Tn(B)?this.id:B,ce=(i=en(d,!1))!==null&&i!==void 0?i:{r:3,strokeWidth:2},Pe=ce.r,we=Pe===void 0?3:Pe,xe=ce.strokeWidth,Ne=xe===void 0?2:xe,ze=Kre(d)?d:{},ye=ze.clipDot,ve=ye===void 0?!0:ye,_e=we*2+Ne;return ke.createElement(Qn,{className:G},W||Z?ke.createElement("defs",null,ke.createElement("clipPath",{id:"clipPath-".concat(ae)},ke.createElement("rect",{x:W?S:S-P/2,y:Z?j:j-F/2,width:W?P:P*2,height:Z?F:F*2})),!ve&&ke.createElement("clipPath",{id:"clipPath-dots-".concat(ae)},ke.createElement("rect",{x:S-_e/2,y:j-_e/2,width:P+_e,height:F+_e}))):null,!$&&this.renderCurve(se,ae),this.renderErrorBar(se,ae),($||d)&&this.renderDots(se,ve,ae),(!L||V)&&_u.renderCallByParent(this.props,s))}}],[{key:"getDerivedStateFromProps",value:function(i,a){return i.animationId!==a.prevAnimationId?{prevAnimationId:i.animationId,curPoints:i.points,prevPoints:a.curPoints}:i.points!==a.curPoints?{curPoints:i.points}:null}},{key:"repeat",value:function(i,a){for(var l=i.length%2!==0?[].concat(Zy(i),[0]):i,d=[],s=0;s<a;++s)d=[].concat(Zy(d),Zy(l));return d}},{key:"renderDotItem",value:function(i,a){var l;if(ke.isValidElement(i))l=ke.cloneElement(i,a);else if(Cn(i))l=i(a);else{var d=a.key,s=yK(a,sHe),p=zn("recharts-line-dot",typeof i!="boolean"?i.className:"");l=ke.createElement(R_,$j({key:d},s,{className:p}))}return l}}])}(U.PureComponent);ad(jl,"displayName","Line");ad(jl,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!Dc.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});ad(jl,"getComposedData",function(e){var t=e.props,r=e.xAxis,i=e.yAxis,a=e.xAxisTicks,l=e.yAxisTicks,d=e.dataKey,s=e.bandSize,p=e.displayedData,x=e.offset,w=t.layout,j=p.map(function(S,P){var F=ys(S,d);return w==="horizontal"?{x:Nb({axis:r,ticks:a,bandSize:s,entry:S,index:P}),y:Tn(F)?null:i.scale(F),value:F,payload:S}:{x:Tn(F)?null:r.scale(F),y:Nb({axis:i,ticks:l,bandSize:s,entry:S,index:P}),value:F,payload:S}});return xc({points:j,layout:w},x)});var yHe=["layout","type","stroke","connectNulls","isRange","ref"],vHe=["key"],gae;function Lb(e){"@babel/helpers - typeof";return Lb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lb(e)}function xae(e,t){if(e==null)return{};var r=bHe(e,t),i,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)i=l[a],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}function bHe(e,t){if(e==null)return{};var r={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;r[i]=e[i]}return r}function O0(){return O0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},O0.apply(this,arguments)}function _K(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,i)}return r}function Yf(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_K(Object(r),!0).forEach(function(i){ih(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_K(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function _He(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wK(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,vae(i.key),i)}}function wHe(e,t,r){return t&&wK(e.prototype,t),r&&wK(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function jHe(e,t,r){return t=bP(t),NHe(e,yae()?Reflect.construct(t,r||[],bP(e).constructor):t.apply(e,r))}function NHe(e,t){if(t&&(Lb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return SHe(e)}function SHe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yae(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(yae=function(){return!!e})()}function bP(e){return bP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},bP(e)}function CHe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Tz(e,t)}function Tz(e,t){return Tz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,a){return i.__proto__=a,i},Tz(e,t)}function ih(e,t,r){return t=vae(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vae(e){var t=AHe(e,"string");return Lb(t)=="symbol"?t:t+""}function AHe(e,t){if(Lb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(Lb(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Zo=function(e){function t(){var r;_He(this,t);for(var i=arguments.length,a=new Array(i),l=0;l<i;l++)a[l]=arguments[l];return r=jHe(this,t,[].concat(a)),ih(r,"state",{isAnimationFinished:!0}),ih(r,"id",og("recharts-area-")),ih(r,"handleAnimationEnd",function(){var d=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),Cn(d)&&d()}),ih(r,"handleAnimationStart",function(){var d=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),Cn(d)&&d()}),r}return CHe(t,e),wHe(t,[{key:"renderDots",value:function(i,a,l){var d=this.props.isAnimationActive,s=this.state.isAnimationFinished;if(d&&!s)return null;var p=this.props,x=p.dot,w=p.points,j=p.dataKey,S=en(this.props,!1),P=en(x,!0),F=w.map(function(B,V){var $=Yf(Yf(Yf({key:"dot-".concat(V),r:3},S),P),{},{index:V,cx:B.x,cy:B.y,dataKey:j,value:B.value,payload:B.payload,points:w});return t.renderDotItem(x,$)}),L={clipPath:i?"url(#clipPath-".concat(a?"":"dots-").concat(l,")"):null};return ke.createElement(Qn,O0({className:"recharts-area-dots"},L),F)}},{key:"renderHorizontalRect",value:function(i){var a=this.props,l=a.baseLine,d=a.points,s=a.strokeWidth,p=d[0].x,x=d[d.length-1].x,w=i*Math.abs(p-x),j=_p(d.map(function(S){return S.y||0}));return kr(l)&&typeof l=="number"?j=Math.max(l,j):l&&Array.isArray(l)&&l.length&&(j=Math.max(_p(l.map(function(S){return S.y||0})),j)),kr(j)?ke.createElement("rect",{x:p<x?p:p-w,y:0,width:w,height:Math.floor(j+(s?parseInt("".concat(s),10):1))}):null}},{key:"renderVerticalRect",value:function(i){var a=this.props,l=a.baseLine,d=a.points,s=a.strokeWidth,p=d[0].y,x=d[d.length-1].y,w=i*Math.abs(p-x),j=_p(d.map(function(S){return S.x||0}));return kr(l)&&typeof l=="number"?j=Math.max(l,j):l&&Array.isArray(l)&&l.length&&(j=Math.max(_p(l.map(function(S){return S.x||0})),j)),kr(j)?ke.createElement("rect",{x:0,y:p<x?p:p-w,width:j+(s?parseInt("".concat(s),10):1),height:Math.floor(w)}):null}},{key:"renderClipRect",value:function(i){var a=this.props.layout;return a==="vertical"?this.renderVerticalRect(i):this.renderHorizontalRect(i)}},{key:"renderAreaStatically",value:function(i,a,l,d){var s=this.props,p=s.layout,x=s.type,w=s.stroke,j=s.connectNulls,S=s.isRange;s.ref;var P=xae(s,yHe);return ke.createElement(Qn,{clipPath:l?"url(#clipPath-".concat(d,")"):null},ke.createElement(Dp,O0({},en(P,!0),{points:i,connectNulls:j,type:x,baseLine:a,layout:p,stroke:"none",className:"recharts-area-area"})),w!=="none"&&ke.createElement(Dp,O0({},en(this.props,!1),{className:"recharts-area-curve",layout:p,type:x,connectNulls:j,fill:"none",points:i})),w!=="none"&&S&&ke.createElement(Dp,O0({},en(this.props,!1),{className:"recharts-area-curve",layout:p,type:x,connectNulls:j,fill:"none",points:a})))}},{key:"renderAreaWithAnimation",value:function(i,a){var l=this,d=this.props,s=d.points,p=d.baseLine,x=d.isAnimationActive,w=d.animationBegin,j=d.animationDuration,S=d.animationEasing,P=d.animationId,F=this.state,L=F.prevPoints,B=F.prevBaseLine;return ke.createElement(Uc,{begin:w,duration:j,isActive:x,easing:S,from:{t:0},to:{t:1},key:"area-".concat(P),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(V){var $=V.t;if(L){var G=L.length/s.length,W=s.map(function(ce,Pe){var we=Math.floor(Pe*G);if(L[we]){var xe=L[we],Ne=xs(xe.x,ce.x),ze=xs(xe.y,ce.y);return Yf(Yf({},ce),{},{x:Ne($),y:ze($)})}return ce}),Z;if(kr(p)&&typeof p=="number"){var se=xs(B,p);Z=se($)}else if(Tn(p)||A_(p)){var ae=xs(B,0);Z=ae($)}else Z=p.map(function(ce,Pe){var we=Math.floor(Pe*G);if(B[we]){var xe=B[we],Ne=xs(xe.x,ce.x),ze=xs(xe.y,ce.y);return Yf(Yf({},ce),{},{x:Ne($),y:ze($)})}return ce});return l.renderAreaStatically(W,Z,i,a)}return ke.createElement(Qn,null,ke.createElement("defs",null,ke.createElement("clipPath",{id:"animationClipPath-".concat(a)},l.renderClipRect($))),ke.createElement(Qn,{clipPath:"url(#animationClipPath-".concat(a,")")},l.renderAreaStatically(s,p,i,a)))})}},{key:"renderArea",value:function(i,a){var l=this.props,d=l.points,s=l.baseLine,p=l.isAnimationActive,x=this.state,w=x.prevPoints,j=x.prevBaseLine,S=x.totalLength;return p&&d&&d.length&&(!w&&S>0||!Om(w,d)||!Om(j,s))?this.renderAreaWithAnimation(i,a):this.renderAreaStatically(d,s,i,a)}},{key:"render",value:function(){var i,a=this.props,l=a.hide,d=a.dot,s=a.points,p=a.className,x=a.top,w=a.left,j=a.xAxis,S=a.yAxis,P=a.width,F=a.height,L=a.isAnimationActive,B=a.id;if(l||!s||!s.length)return null;var V=this.state.isAnimationFinished,$=s.length===1,G=zn("recharts-area",p),W=j&&j.allowDataOverflow,Z=S&&S.allowDataOverflow,se=W||Z,ae=Tn(B)?this.id:B,ce=(i=en(d,!1))!==null&&i!==void 0?i:{r:3,strokeWidth:2},Pe=ce.r,we=Pe===void 0?3:Pe,xe=ce.strokeWidth,Ne=xe===void 0?2:xe,ze=Kre(d)?d:{},ye=ze.clipDot,ve=ye===void 0?!0:ye,_e=we*2+Ne;return ke.createElement(Qn,{className:G},W||Z?ke.createElement("defs",null,ke.createElement("clipPath",{id:"clipPath-".concat(ae)},ke.createElement("rect",{x:W?w:w-P/2,y:Z?x:x-F/2,width:W?P:P*2,height:Z?F:F*2})),!ve&&ke.createElement("clipPath",{id:"clipPath-dots-".concat(ae)},ke.createElement("rect",{x:w-_e/2,y:x-_e/2,width:P+_e,height:F+_e}))):null,$?null:this.renderArea(se,ae),(d||$)&&this.renderDots(se,ve,ae),(!L||V)&&_u.renderCallByParent(this.props,s))}}],[{key:"getDerivedStateFromProps",value:function(i,a){return i.animationId!==a.prevAnimationId?{prevAnimationId:i.animationId,curPoints:i.points,curBaseLine:i.baseLine,prevPoints:a.curPoints,prevBaseLine:a.curBaseLine}:i.points!==a.curPoints||i.baseLine!==a.curBaseLine?{curPoints:i.points,curBaseLine:i.baseLine}:null}}])}(U.PureComponent);gae=Zo;ih(Zo,"displayName","Area");ih(Zo,"defaultProps",{stroke:"#3182bd",fill:"#3182bd",fillOpacity:.6,xAxisId:0,yAxisId:0,legendType:"line",connectNulls:!1,points:[],dot:!1,activeDot:!0,hide:!1,isAnimationActive:!Dc.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease"});ih(Zo,"getBaseValue",function(e,t,r,i){var a=e.layout,l=e.baseValue,d=t.props.baseValue,s=d??l;if(kr(s)&&typeof s=="number")return s;var p=a==="horizontal"?i:r,x=p.scale.domain();if(p.type==="number"){var w=Math.max(x[0],x[1]),j=Math.min(x[0],x[1]);return s==="dataMin"?j:s==="dataMax"||w<0?w:Math.max(Math.min(x[0],x[1]),0)}return s==="dataMin"?x[0]:s==="dataMax"?x[1]:x[0]});ih(Zo,"getComposedData",function(e){var t=e.props,r=e.item,i=e.xAxis,a=e.yAxis,l=e.xAxisTicks,d=e.yAxisTicks,s=e.bandSize,p=e.dataKey,x=e.stackedData,w=e.dataStartIndex,j=e.displayedData,S=e.offset,P=t.layout,F=x&&x.length,L=gae.getBaseValue(t,r,i,a),B=P==="horizontal",V=!1,$=j.map(function(W,Z){var se;F?se=x[w+Z]:(se=ys(W,p),Array.isArray(se)?V=!0:se=[L,se]);var ae=se[1]==null||F&&ys(W,p)==null;return B?{x:Nb({axis:i,ticks:l,bandSize:s,entry:W,index:Z}),y:ae?null:a.scale(se[1]),value:se,payload:W}:{x:ae?null:i.scale(se[1]),y:Nb({axis:a,ticks:d,bandSize:s,entry:W,index:Z}),value:se,payload:W}}),G;return F||V?G=$.map(function(W){var Z=Array.isArray(W.value)?W.value[0]:null;return B?{x:W.x,y:Z!=null&&W.y!=null?a.scale(Z):null}:{x:Z!=null?i.scale(Z):null,y:W.y}}):G=B?a.scale(L):i.scale(L),Yf({points:$,baseLine:G,layout:P,isRange:V},S)});ih(Zo,"renderDotItem",function(e,t){var r;if(ke.isValidElement(e))r=ke.cloneElement(e,t);else if(Cn(e))r=e(t);else{var i=zn("recharts-area-dot",typeof e!="boolean"?e.className:""),a=t.key,l=xae(t,vHe);r=ke.createElement(R_,O0({},l,{key:a,className:i}))}return r});function Fb(e){"@babel/helpers - typeof";return Fb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fb(e)}function THe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kHe(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,wae(i.key),i)}}function PHe(e,t,r){return t&&kHe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function EHe(e,t,r){return t=_P(t),MHe(e,bae()?Reflect.construct(t,r||[],_P(e).constructor):t.apply(e,r))}function MHe(e,t){if(t&&(Fb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return IHe(e)}function IHe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bae(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(bae=function(){return!!e})()}function _P(e){return _P=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_P(e)}function OHe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&kz(e,t)}function kz(e,t){return kz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,a){return i.__proto__=a,i},kz(e,t)}function _ae(e,t,r){return t=wae(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wae(e){var t=RHe(e,"string");return Fb(t)=="symbol"?t:t+""}function RHe(e,t){if(Fb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(Fb(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var lS=function(e){function t(){return THe(this,t),EHe(this,t,arguments)}return OHe(t,e),PHe(t,[{key:"render",value:function(){return null}}])}(ke.Component);_ae(lS,"displayName","ZAxis");_ae(lS,"defaultProps",{zAxisId:0,range:[64,64],scale:"auto",type:"number"});var DHe=["option","isActive"];function Vj(){return Vj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},Vj.apply(this,arguments)}function zHe(e,t){if(e==null)return{};var r=LHe(e,t),i,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)i=l[a],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}function LHe(e,t){if(e==null)return{};var r={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;r[i]=e[i]}return r}function FHe(e){var t=e.option,r=e.isActive,i=zHe(e,DHe);return typeof t=="string"?ke.createElement(sP,Vj({option:ke.createElement(mM,Vj({type:t},i)),isActive:r,shapeType:"symbols"},i)):ke.createElement(sP,Vj({option:t,isActive:r,shapeType:"symbols"},i))}function Bb(e){"@babel/helpers - typeof";return Bb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bb(e)}function Uj(){return Uj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},Uj.apply(this,arguments)}function jK(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,i)}return r}function cu(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?jK(Object(r),!0).forEach(function(i){jp(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):jK(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function BHe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function NK(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,Nae(i.key),i)}}function $He(e,t,r){return t&&NK(e.prototype,t),r&&NK(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function VHe(e,t,r){return t=wP(t),UHe(e,jae()?Reflect.construct(t,r||[],wP(e).constructor):t.apply(e,r))}function UHe(e,t){if(t&&(Bb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return GHe(e)}function GHe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jae(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(jae=function(){return!!e})()}function wP(e){return wP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},wP(e)}function HHe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Pz(e,t)}function Pz(e,t){return Pz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,a){return i.__proto__=a,i},Pz(e,t)}function jp(e,t,r){return t=Nae(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Nae(e){var t=qHe(e,"string");return Bb(t)=="symbol"?t:t+""}function qHe(e,t){if(Bb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(Bb(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var cS=function(e){function t(){var r;BHe(this,t);for(var i=arguments.length,a=new Array(i),l=0;l<i;l++)a[l]=arguments[l];return r=VHe(this,t,[].concat(a)),jp(r,"state",{isAnimationFinished:!1}),jp(r,"handleAnimationEnd",function(){r.setState({isAnimationFinished:!0})}),jp(r,"handleAnimationStart",function(){r.setState({isAnimationFinished:!1})}),jp(r,"id",og("recharts-scatter-")),r}return HHe(t,e),$He(t,[{key:"renderSymbolsStatically",value:function(i){var a=this,l=this.props,d=l.shape,s=l.activeShape,p=l.activeIndex,x=en(this.props,!1);return i.map(function(w,j){var S=p===j,P=S?s:d,F=cu(cu({},x),w);return ke.createElement(Qn,Uj({className:"recharts-scatter-symbol",key:"symbol-".concat(w==null?void 0:w.cx,"-").concat(w==null?void 0:w.cy,"-").concat(w==null?void 0:w.size,"-").concat(j)},Wp(a.props,w,j),{role:"img"}),ke.createElement(FHe,Uj({option:P,isActive:S,key:"symbol-".concat(j)},F)))})}},{key:"renderSymbolsWithAnimation",value:function(){var i=this,a=this.props,l=a.points,d=a.isAnimationActive,s=a.animationBegin,p=a.animationDuration,x=a.animationEasing,w=a.animationId,j=this.state.prevPoints;return ke.createElement(Uc,{begin:s,duration:p,isActive:d,easing:x,from:{t:0},to:{t:1},key:"pie-".concat(w),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(S){var P=S.t,F=l.map(function(L,B){var V=j&&j[B];if(V){var $=xs(V.cx,L.cx),G=xs(V.cy,L.cy),W=xs(V.size,L.size);return cu(cu({},L),{},{cx:$(P),cy:G(P),size:W(P)})}var Z=xs(0,L.size);return cu(cu({},L),{},{size:Z(P)})});return ke.createElement(Qn,null,i.renderSymbolsStatically(F))})}},{key:"renderSymbols",value:function(){var i=this.props,a=i.points,l=i.isAnimationActive,d=this.state.prevPoints;return l&&a&&a.length&&(!d||!Om(d,a))?this.renderSymbolsWithAnimation():this.renderSymbolsStatically(a)}},{key:"renderErrorBar",value:function(){var i=this.props.isAnimationActive;if(i&&!this.state.isAnimationFinished)return null;var a=this.props,l=a.points,d=a.xAxis,s=a.yAxis,p=a.children,x=Sl(p,I_);return x?x.map(function(w,j){var S=w.props,P=S.direction,F=S.dataKey;return ke.cloneElement(w,{key:"".concat(P,"-").concat(F,"-").concat(l[j]),data:l,xAxis:d,yAxis:s,layout:P==="x"?"vertical":"horizontal",dataPointFormatter:function(B,V){return{x:B.cx,y:B.cy,value:P==="x"?+B.node.x:+B.node.y,errorVal:ys(B,V)}}})}):null}},{key:"renderLine",value:function(){var i=this.props,a=i.points,l=i.line,d=i.lineType,s=i.lineJointType,p=en(this.props,!1),x=en(l,!1),w,j;if(d==="joint")w=a.map(function(G){return{x:G.cx,y:G.cy}});else if(d==="fitting"){var S=fTe(a),P=S.xmin,F=S.xmax,L=S.a,B=S.b,V=function(W){return L*W+B};w=[{x:P,y:V(P)},{x:F,y:V(F)}]}var $=cu(cu(cu({},p),{},{fill:"none",stroke:p&&p.fill},x),{},{points:w});return ke.isValidElement(l)?j=ke.cloneElement(l,$):Cn(l)?j=l($):j=ke.createElement(Dp,Uj({},$,{type:s})),ke.createElement(Qn,{className:"recharts-scatter-line",key:"recharts-scatter-line"},j)}},{key:"render",value:function(){var i=this.props,a=i.hide,l=i.points,d=i.line,s=i.className,p=i.xAxis,x=i.yAxis,w=i.left,j=i.top,S=i.width,P=i.height,F=i.id,L=i.isAnimationActive;if(a||!l||!l.length)return null;var B=this.state.isAnimationFinished,V=zn("recharts-scatter",s),$=p&&p.allowDataOverflow,G=x&&x.allowDataOverflow,W=$||G,Z=Tn(F)?this.id:F;return ke.createElement(Qn,{className:V,clipPath:W?"url(#clipPath-".concat(Z,")"):null},$||G?ke.createElement("defs",null,ke.createElement("clipPath",{id:"clipPath-".concat(Z)},ke.createElement("rect",{x:$?w:w-S/2,y:G?j:j-P/2,width:$?S:S*2,height:G?P:P*2}))):null,d&&this.renderLine(),this.renderErrorBar(),ke.createElement(Qn,{key:"recharts-scatter-symbols"},this.renderSymbols()),(!L||B)&&_u.renderCallByParent(this.props,l))}}],[{key:"getDerivedStateFromProps",value:function(i,a){return i.animationId!==a.prevAnimationId?{prevAnimationId:i.animationId,curPoints:i.points,prevPoints:a.curPoints}:i.points!==a.curPoints?{curPoints:i.points}:null}}])}(U.PureComponent);jp(cS,"displayName","Scatter");jp(cS,"defaultProps",{xAxisId:0,yAxisId:0,zAxisId:0,legendType:"circle",lineType:"joint",lineJointType:"linear",data:[],shape:"circle",hide:!1,isAnimationActive:!Dc.isSsr,animationBegin:0,animationDuration:400,animationEasing:"linear"});jp(cS,"getComposedData",function(e){var t=e.xAxis,r=e.yAxis,i=e.zAxis,a=e.item,l=e.displayedData,d=e.xAxisTicks,s=e.yAxisTicks,p=e.offset,x=a.props.tooltipType,w=Sl(a.props.children,jd),j=Tn(t.dataKey)?a.props.dataKey:t.dataKey,S=Tn(r.dataKey)?a.props.dataKey:r.dataKey,P=i&&i.dataKey,F=i?i.range:lS.defaultProps.range,L=F&&F[0],B=t.scale.bandwidth?t.scale.bandwidth():0,V=r.scale.bandwidth?r.scale.bandwidth():0,$=l.map(function(G,W){var Z=ys(G,j),se=ys(G,S),ae=!Tn(P)&&ys(G,P)||"-",ce=[{name:Tn(t.dataKey)?a.props.name:t.name||t.dataKey,unit:t.unit||"",value:Z,payload:G,dataKey:j,type:x},{name:Tn(r.dataKey)?a.props.name:r.name||r.dataKey,unit:r.unit||"",value:se,payload:G,dataKey:S,type:x}];ae!=="-"&&ce.push({name:i.name||i.dataKey,unit:i.unit||"",value:ae,payload:G,dataKey:P,type:x});var Pe=Nb({axis:t,ticks:d,bandSize:B,entry:G,index:W,dataKey:j}),we=Nb({axis:r,ticks:s,bandSize:V,entry:G,index:W,dataKey:S}),xe=ae!=="-"?i.scale(ae):L,Ne=Math.sqrt(Math.max(xe,0)/Math.PI);return cu(cu({},G),{},{cx:Pe,cy:we,x:Pe-Ne,y:we-Ne,xAxis:t,yAxis:r,zAxis:i,width:2*Ne,height:2*Ne,size:xe,node:{x:Z,y:se,z:ae},tooltipPayload:ce,tooltipPosition:{x:Pe,y:we},payload:G},w&&w[W]&&w[W].props)});return cu({points:$},p)});function $b(e){"@babel/helpers - typeof";return $b=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$b(e)}function WHe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function KHe(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,Aae(i.key),i)}}function ZHe(e,t,r){return t&&KHe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function YHe(e,t,r){return t=jP(t),XHe(e,Sae()?Reflect.construct(t,r||[],jP(e).constructor):t.apply(e,r))}function XHe(e,t){if(t&&($b(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return JHe(e)}function JHe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Sae(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Sae=function(){return!!e})()}function jP(e){return jP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},jP(e)}function QHe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ez(e,t)}function Ez(e,t){return Ez=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,a){return i.__proto__=a,i},Ez(e,t)}function Cae(e,t,r){return t=Aae(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Aae(e){var t=eqe(e,"string");return $b(t)=="symbol"?t:t+""}function eqe(e,t){if($b(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if($b(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Mz(){return Mz=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},Mz.apply(this,arguments)}function tqe(e){var t=e.xAxisId,r=v6(),i=b6(),a=rae(t);return a==null?null:ke.createElement(D_,Mz({},a,{className:zn("recharts-".concat(a.axisType," ").concat(a.axisType),a.className),viewBox:{x:0,y:0,width:r,height:i},ticksGenerator:function(d){return xm(d,!0)}}))}var is=function(e){function t(){return WHe(this,t),YHe(this,t,arguments)}return QHe(t,e),ZHe(t,[{key:"render",value:function(){return ke.createElement(tqe,this.props)}}])}(ke.Component);Cae(is,"displayName","XAxis");Cae(is,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function Vb(e){"@babel/helpers - typeof";return Vb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vb(e)}function rqe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nqe(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,Pae(i.key),i)}}function iqe(e,t,r){return t&&nqe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function sqe(e,t,r){return t=NP(t),aqe(e,Tae()?Reflect.construct(t,r||[],NP(e).constructor):t.apply(e,r))}function aqe(e,t){if(t&&(Vb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return oqe(e)}function oqe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Tae(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Tae=function(){return!!e})()}function NP(e){return NP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},NP(e)}function lqe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Iz(e,t)}function Iz(e,t){return Iz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,a){return i.__proto__=a,i},Iz(e,t)}function kae(e,t,r){return t=Pae(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Pae(e){var t=cqe(e,"string");return Vb(t)=="symbol"?t:t+""}function cqe(e,t){if(Vb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(Vb(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Oz(){return Oz=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},Oz.apply(this,arguments)}var uqe=function(t){var r=t.yAxisId,i=v6(),a=b6(),l=nae(r);return l==null?null:ke.createElement(D_,Oz({},l,{className:zn("recharts-".concat(l.axisType," ").concat(l.axisType),l.className),viewBox:{x:0,y:0,width:i,height:a},ticksGenerator:function(s){return xm(s,!0)}}))},Gi=function(e){function t(){return rqe(this,t),sqe(this,t,arguments)}return lqe(t,e),iqe(t,[{key:"render",value:function(){return ke.createElement(uqe,this.props)}}])}(ke.Component);kae(Gi,"displayName","YAxis");kae(Gi,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function SK(e){return fqe(e)||mqe(e)||hqe(e)||dqe()}function dqe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hqe(e,t){if(e){if(typeof e=="string")return Rz(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Rz(e,t)}}function mqe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function fqe(e){if(Array.isArray(e))return Rz(e)}function Rz(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}var Dz=function(t,r,i,a,l){var d=Sl(t,w6),s=Sl(t,OM),p=[].concat(SK(d),SK(s)),x=Sl(t,DM),w="".concat(a,"Id"),j=a[0],S=r;if(p.length&&(S=p.reduce(function(L,B){if(B.props[w]===i&&ph(B.props,"extendDomain")&&kr(B.props[j])){var V=B.props[j];return[Math.min(L[0],V),Math.max(L[1],V)]}return L},S)),x.length){var P="".concat(j,"1"),F="".concat(j,"2");S=x.reduce(function(L,B){if(B.props[w]===i&&ph(B.props,"extendDomain")&&kr(B.props[P])&&kr(B.props[F])){var V=B.props[P],$=B.props[F];return[Math.min(L[0],V,$),Math.max(L[1],V,$)]}return L},S)}return l&&l.length&&(S=l.reduce(function(L,B){return kr(B)?[Math.min(L[0],B),Math.max(L[1],B)]:L},S)),S},Eae={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,r="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(r=!1));function a(p,x,w){this.fn=p,this.context=x,this.once=w||!1}function l(p,x,w,j,S){if(typeof w!="function")throw new TypeError("The listener must be a function");var P=new a(w,j||p,S),F=r?r+x:x;return p._events[F]?p._events[F].fn?p._events[F]=[p._events[F],P]:p._events[F].push(P):(p._events[F]=P,p._eventsCount++),p}function d(p,x){--p._eventsCount===0?p._events=new i:delete p._events[x]}function s(){this._events=new i,this._eventsCount=0}s.prototype.eventNames=function(){var x=[],w,j;if(this._eventsCount===0)return x;for(j in w=this._events)t.call(w,j)&&x.push(r?j.slice(1):j);return Object.getOwnPropertySymbols?x.concat(Object.getOwnPropertySymbols(w)):x},s.prototype.listeners=function(x){var w=r?r+x:x,j=this._events[w];if(!j)return[];if(j.fn)return[j.fn];for(var S=0,P=j.length,F=new Array(P);S<P;S++)F[S]=j[S].fn;return F},s.prototype.listenerCount=function(x){var w=r?r+x:x,j=this._events[w];return j?j.fn?1:j.length:0},s.prototype.emit=function(x,w,j,S,P,F){var L=r?r+x:x;if(!this._events[L])return!1;var B=this._events[L],V=arguments.length,$,G;if(B.fn){switch(B.once&&this.removeListener(x,B.fn,void 0,!0),V){case 1:return B.fn.call(B.context),!0;case 2:return B.fn.call(B.context,w),!0;case 3:return B.fn.call(B.context,w,j),!0;case 4:return B.fn.call(B.context,w,j,S),!0;case 5:return B.fn.call(B.context,w,j,S,P),!0;case 6:return B.fn.call(B.context,w,j,S,P,F),!0}for(G=1,$=new Array(V-1);G<V;G++)$[G-1]=arguments[G];B.fn.apply(B.context,$)}else{var W=B.length,Z;for(G=0;G<W;G++)switch(B[G].once&&this.removeListener(x,B[G].fn,void 0,!0),V){case 1:B[G].fn.call(B[G].context);break;case 2:B[G].fn.call(B[G].context,w);break;case 3:B[G].fn.call(B[G].context,w,j);break;case 4:B[G].fn.call(B[G].context,w,j,S);break;default:if(!$)for(Z=1,$=new Array(V-1);Z<V;Z++)$[Z-1]=arguments[Z];B[G].fn.apply(B[G].context,$)}}return!0},s.prototype.on=function(x,w,j){return l(this,x,w,j,!1)},s.prototype.once=function(x,w,j){return l(this,x,w,j,!0)},s.prototype.removeListener=function(x,w,j,S){var P=r?r+x:x;if(!this._events[P])return this;if(!w)return d(this,P),this;var F=this._events[P];if(F.fn)F.fn===w&&(!S||F.once)&&(!j||F.context===j)&&d(this,P);else{for(var L=0,B=[],V=F.length;L<V;L++)(F[L].fn!==w||S&&!F[L].once||j&&F[L].context!==j)&&B.push(F[L]);B.length?this._events[P]=B.length===1?B[0]:B:d(this,P)}return this},s.prototype.removeAllListeners=function(x){var w;return x?(w=r?r+x:x,this._events[w]&&d(this,w)):(this._events=new i,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=r,s.EventEmitter=s,e.exports=s})(Eae);var pqe=Eae.exports;const gqe=Vi(pqe);var ZO=new gqe,YO="recharts.syncMouseEvents";function sN(e){"@babel/helpers - typeof";return sN=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sN(e)}function xqe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yqe(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,Mae(i.key),i)}}function vqe(e,t,r){return t&&yqe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function XO(e,t,r){return t=Mae(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Mae(e){var t=bqe(e,"string");return sN(t)=="symbol"?t:t+""}function bqe(e,t){if(sN(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t);if(sN(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var _qe=function(){function e(){xqe(this,e),XO(this,"activeIndex",0),XO(this,"coordinateList",[]),XO(this,"layout","horizontal")}return vqe(e,[{key:"setDetails",value:function(r){var i,a=r.coordinateList,l=a===void 0?null:a,d=r.container,s=d===void 0?null:d,p=r.layout,x=p===void 0?null:p,w=r.offset,j=w===void 0?null:w,S=r.mouseHandlerCallback,P=S===void 0?null:S;this.coordinateList=(i=l??this.coordinateList)!==null&&i!==void 0?i:[],this.container=s??this.container,this.layout=x??this.layout,this.offset=j??this.offset,this.mouseHandlerCallback=P??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(r){if(this.coordinateList.length!==0)switch(r.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(r){this.activeIndex=r}},{key:"spoofMouse",value:function(){var r,i;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var a=this.container.getBoundingClientRect(),l=a.x,d=a.y,s=a.height,p=this.coordinateList[this.activeIndex].coordinate,x=((r=window)===null||r===void 0?void 0:r.scrollX)||0,w=((i=window)===null||i===void 0?void 0:i.scrollY)||0,j=l+p+x,S=d+this.offset.top+s/2+w;this.mouseHandlerCallback({pageX:j,pageY:S})}}}])}();function wqe(e,t,r){if(r==="number"&&t===!0&&Array.isArray(e)){var i=e==null?void 0:e[0],a=e==null?void 0:e[1];if(i&&a&&kr(i)&&kr(a))return!0}return!1}function jqe(e,t,r,i){var a=i/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-a:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-a,width:e==="horizontal"?i:r.width-1,height:e==="horizontal"?r.height-1:i}}function Iae(e){var t=e.cx,r=e.cy,i=e.radius,a=e.startAngle,l=e.endAngle,d=Xi(t,r,i,a),s=Xi(t,r,i,l);return{points:[d,s],cx:t,cy:r,radius:i,startAngle:a,endAngle:l}}function Nqe(e,t,r){var i,a,l,d;if(e==="horizontal")i=t.x,l=i,a=r.top,d=r.top+r.height;else if(e==="vertical")a=t.y,d=a,i=r.left,l=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var s=t.cx,p=t.cy,x=t.innerRadius,w=t.outerRadius,j=t.angle,S=Xi(s,p,x,j),P=Xi(s,p,w,j);i=S.x,a=S.y,l=P.x,d=P.y}else return Iae(t);return[{x:i,y:a},{x:l,y:d}]}function aN(e){"@babel/helpers - typeof";return aN=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},aN(e)}function CK(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,i)}return r}function QA(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?CK(Object(r),!0).forEach(function(i){Sqe(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):CK(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function Sqe(e,t,r){return t=Cqe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Cqe(e){var t=Aqe(e,"string");return aN(t)=="symbol"?t:t+""}function Aqe(e,t){if(aN(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(aN(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Tqe(e){var t,r,i=e.element,a=e.tooltipEventType,l=e.isActive,d=e.activeCoordinate,s=e.activePayload,p=e.offset,x=e.activeTooltipIndex,w=e.tooltipAxisBandSize,j=e.layout,S=e.chartName,P=(t=i.props.cursor)!==null&&t!==void 0?t:(r=i.type.defaultProps)===null||r===void 0?void 0:r.cursor;if(!i||!P||!l||!d||S!=="ScatterChart"&&a!=="axis")return null;var F,L=Dp;if(S==="ScatterChart")F=d,L=q8e;else if(S==="BarChart")F=jqe(j,d,p,w),L=f6;else if(j==="radial"){var B=Iae(d),V=B.cx,$=B.cy,G=B.radius,W=B.startAngle,Z=B.endAngle;F={cx:V,cy:$,startAngle:W,endAngle:Z,innerRadius:G,outerRadius:G},L=yse}else F={points:Nqe(j,d,p)},L=Dp;var se=QA(QA(QA(QA({stroke:"#ccc",pointerEvents:"none"},p),F),en(P,!1)),{},{payload:s,payloadIndex:x,className:zn("recharts-tooltip-cursor",P.className)});return U.isValidElement(P)?U.cloneElement(P,se):U.createElement(L,se)}var kqe=["item"],Pqe=["children","className","width","height","style","compact","title","desc"];function Ub(e){"@babel/helpers - typeof";return Ub=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ub(e)}function Gj(){return Gj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},Gj.apply(this,arguments)}function AK(e,t){return Iqe(e)||Mqe(e,t)||Rae(e,t)||Eqe()}function Eqe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Mqe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var i,a,l,d,s=[],p=!0,x=!1;try{if(l=(r=r.call(e)).next,t!==0)for(;!(p=(i=l.call(r)).done)&&(s.push(i.value),s.length!==t);p=!0);}catch(w){x=!0,a=w}finally{try{if(!p&&r.return!=null&&(d=r.return(),Object(d)!==d))return}finally{if(x)throw a}}return s}}function Iqe(e){if(Array.isArray(e))return e}function TK(e,t){if(e==null)return{};var r=Oqe(e,t),i,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)i=l[a],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}function Oqe(e,t){if(e==null)return{};var r={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;r[i]=e[i]}return r}function Rqe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Dqe(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,Dae(i.key),i)}}function zqe(e,t,r){return t&&Dqe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Lqe(e,t,r){return t=SP(t),Fqe(e,Oae()?Reflect.construct(t,r||[],SP(e).constructor):t.apply(e,r))}function Fqe(e,t){if(t&&(Ub(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Bqe(e)}function Bqe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Oae(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Oae=function(){return!!e})()}function SP(e){return SP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},SP(e)}function $qe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&zz(e,t)}function zz(e,t){return zz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,a){return i.__proto__=a,i},zz(e,t)}function Gb(e){return Gqe(e)||Uqe(e)||Rae(e)||Vqe()}function Vqe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Rae(e,t){if(e){if(typeof e=="string")return Lz(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Lz(e,t)}}function Uqe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Gqe(e){if(Array.isArray(e))return Lz(e)}function Lz(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function kK(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,i)}return r}function Xt(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?kK(Object(r),!0).forEach(function(i){Gn(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):kK(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function Gn(e,t,r){return t=Dae(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Dae(e){var t=Hqe(e,"string");return Ub(t)=="symbol"?t:t+""}function Hqe(e,t){if(Ub(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(Ub(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var qqe={xAxis:["bottom","top"],yAxis:["left","right"]},Wqe={width:"100%",height:"100%"},zae={x:0,y:0};function eT(e){return e}var Kqe=function(t,r){return r==="horizontal"?t.x:r==="vertical"?t.y:r==="centric"?t.angle:t.radius},Zqe=function(t,r,i,a){var l=r.find(function(w){return w&&w.index===i});if(l){if(t==="horizontal")return{x:l.coordinate,y:a.y};if(t==="vertical")return{x:a.x,y:l.coordinate};if(t==="centric"){var d=l.coordinate,s=a.radius;return Xt(Xt(Xt({},a),Xi(a.cx,a.cy,s,d)),{},{angle:d,radius:s})}var p=l.coordinate,x=a.angle;return Xt(Xt(Xt({},a),Xi(a.cx,a.cy,p,x)),{},{angle:x,radius:p})}return zae},zM=function(t,r){var i=r.graphicalItems,a=r.dataStartIndex,l=r.dataEndIndex,d=(i??[]).reduce(function(s,p){var x=p.props.data;return x&&x.length?[].concat(Gb(s),Gb(x)):s},[]);return d.length>0?d:t&&t.length&&kr(a)&&kr(l)?t.slice(a,l+1):[]};function Lae(e){return e==="number"?[0,"auto"]:void 0}var Fz=function(t,r,i,a){var l=t.graphicalItems,d=t.tooltipAxis,s=zM(r,t);return i<0||!l||!l.length||i>=s.length?null:l.reduce(function(p,x){var w,j=(w=x.props.data)!==null&&w!==void 0?w:r;j&&t.dataStartIndex+t.dataEndIndex!==0&&t.dataEndIndex-t.dataStartIndex>=i&&(j=j.slice(t.dataStartIndex,t.dataEndIndex+1));var S;if(d.dataKey&&!d.allowDuplicatedCategory){var P=j===void 0?s:j;S=bk(P,d.dataKey,a)}else S=j&&j[i]||s[i];return S?[].concat(Gb(p),[use(x,S)]):p},[])},PK=function(t,r,i,a){var l=a||{x:t.chartX,y:t.chartY},d=Kqe(l,i),s=t.orderedTooltipTicks,p=t.tooltipAxis,x=t.tooltipTicks,w=kBe(d,s,x,p);if(w>=0&&x){var j=x[w]&&x[w].value,S=Fz(t,r,w,j),P=Zqe(i,s,w,l);return{activeTooltipIndex:w,activeLabel:j,activePayload:S,activeCoordinate:P}}return null},Yqe=function(t,r){var i=r.axes,a=r.graphicalItems,l=r.axisType,d=r.axisIdKey,s=r.stackGroups,p=r.dataStartIndex,x=r.dataEndIndex,w=t.layout,j=t.children,S=t.stackOffset,P=ise(w,l);return i.reduce(function(F,L){var B,V=L.type.defaultProps!==void 0?Xt(Xt({},L.type.defaultProps),L.props):L.props,$=V.type,G=V.dataKey,W=V.allowDataOverflow,Z=V.allowDuplicatedCategory,se=V.scale,ae=V.ticks,ce=V.includeHidden,Pe=V[d];if(F[Pe])return F;var we=zM(t.data,{graphicalItems:a.filter(function(mt){var gt,qt=d in mt.props?mt.props[d]:(gt=mt.type.defaultProps)===null||gt===void 0?void 0:gt[d];return qt===Pe}),dataStartIndex:p,dataEndIndex:x}),xe=we.length,Ne,ze,ye;wqe(V.domain,W,$)&&(Ne=Z5(V.domain,null,W),P&&($==="number"||se!=="auto")&&(ye=zj(we,G,"category")));var ve=Lae($);if(!Ne||Ne.length===0){var _e,Ee=(_e=V.domain)!==null&&_e!==void 0?_e:ve;if(G){if(Ne=zj(we,G,$),$==="category"&&P){var je=mTe(Ne);Z&&je?(ze=Ne,Ne=cP(0,xe)):Z||(Ne=Hq(Ee,Ne,L).reduce(function(mt,gt){return mt.indexOf(gt)>=0?mt:[].concat(Gb(mt),[gt])},[]))}else if($==="category")Z?Ne=Ne.filter(function(mt){return mt!==""&&!Tn(mt)}):Ne=Hq(Ee,Ne,L).reduce(function(mt,gt){return mt.indexOf(gt)>=0||gt===""||Tn(gt)?mt:[].concat(Gb(mt),[gt])},[]);else if($==="number"){var Ce=OBe(we,a.filter(function(mt){var gt,qt,yr=d in mt.props?mt.props[d]:(gt=mt.type.defaultProps)===null||gt===void 0?void 0:gt[d],tr="hide"in mt.props?mt.props.hide:(qt=mt.type.defaultProps)===null||qt===void 0?void 0:qt.hide;return yr===Pe&&(ce||!tr)}),G,l,w);Ce&&(Ne=Ce)}P&&($==="number"||se!=="auto")&&(ye=zj(we,G,"category"))}else P?Ne=cP(0,xe):s&&s[Pe]&&s[Pe].hasStack&&$==="number"?Ne=S==="expand"?[0,1]:cse(s[Pe].stackGroups,p,x):Ne=nse(we,a.filter(function(mt){var gt=d in mt.props?mt.props[d]:mt.type.defaultProps[d],qt="hide"in mt.props?mt.props.hide:mt.type.defaultProps.hide;return gt===Pe&&(ce||!qt)}),$,w,!0);if($==="number")Ne=Dz(j,Ne,Pe,l,ae),Ee&&(Ne=Z5(Ee,Ne,W));else if($==="category"&&Ee){var tt=Ee,it=Ne.every(function(mt){return tt.indexOf(mt)>=0});it&&(Ne=tt)}}return Xt(Xt({},F),{},Gn({},Pe,Xt(Xt({},V),{},{axisType:l,domain:Ne,categoricalDomain:ye,duplicateDomain:ze,originalDomain:(B=V.domain)!==null&&B!==void 0?B:ve,isCategorical:P,layout:w})))},{})},Xqe=function(t,r){var i=r.graphicalItems,a=r.Axis,l=r.axisType,d=r.axisIdKey,s=r.stackGroups,p=r.dataStartIndex,x=r.dataEndIndex,w=t.layout,j=t.children,S=zM(t.data,{graphicalItems:i,dataStartIndex:p,dataEndIndex:x}),P=S.length,F=ise(w,l),L=-1;return i.reduce(function(B,V){var $=V.type.defaultProps!==void 0?Xt(Xt({},V.type.defaultProps),V.props):V.props,G=$[d],W=Lae("number");if(!B[G]){L++;var Z;return F?Z=cP(0,P):s&&s[G]&&s[G].hasStack?(Z=cse(s[G].stackGroups,p,x),Z=Dz(j,Z,G,l)):(Z=Z5(W,nse(S,i.filter(function(se){var ae,ce,Pe=d in se.props?se.props[d]:(ae=se.type.defaultProps)===null||ae===void 0?void 0:ae[d],we="hide"in se.props?se.props.hide:(ce=se.type.defaultProps)===null||ce===void 0?void 0:ce.hide;return Pe===G&&!we}),"number",w),a.defaultProps.allowDataOverflow),Z=Dz(j,Z,G,l)),Xt(Xt({},B),{},Gn({},G,Xt(Xt({axisType:l},a.defaultProps),{},{hide:!0,orientation:Rc(qqe,"".concat(l,".").concat(L%2),null),domain:Z,originalDomain:W,isCategorical:F,layout:w})))}return B},{})},Jqe=function(t,r){var i=r.axisType,a=i===void 0?"xAxis":i,l=r.AxisComp,d=r.graphicalItems,s=r.stackGroups,p=r.dataStartIndex,x=r.dataEndIndex,w=t.children,j="".concat(a,"Id"),S=Sl(w,l),P={};return S&&S.length?P=Yqe(t,{axes:S,graphicalItems:d,axisType:a,axisIdKey:j,stackGroups:s,dataStartIndex:p,dataEndIndex:x}):d&&d.length&&(P=Xqe(t,{Axis:l,graphicalItems:d,axisType:a,axisIdKey:j,stackGroups:s,dataStartIndex:p,dataEndIndex:x})),P},Qqe=function(t){var r=lp(t),i=xm(r,!1,!0);return{tooltipTicks:i,orderedTooltipTicks:$B(i,function(a){return a.coordinate}),tooltipAxis:r,tooltipAxisBandSize:Kk(r,i)}},EK=function(t){var r=t.children,i=t.defaultShowTooltip,a=jc(r,Eb),l=0,d=0;return t.data&&t.data.length!==0&&(d=t.data.length-1),a&&a.props&&(a.props.startIndex>=0&&(l=a.props.startIndex),a.props.endIndex>=0&&(d=a.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:l,dataEndIndex:d,activeTooltipIndex:-1,isTooltipActive:!!i}},eWe=function(t){return!t||!t.length?!1:t.some(function(r){var i=wm(r&&r.type);return i&&i.indexOf("Bar")>=0})},MK=function(t){return t==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:t==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:t==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},tWe=function(t,r){var i=t.props,a=t.graphicalItems,l=t.xAxisMap,d=l===void 0?{}:l,s=t.yAxisMap,p=s===void 0?{}:s,x=i.width,w=i.height,j=i.children,S=i.margin||{},P=jc(j,Eb),F=jc(j,xa),L=Object.keys(p).reduce(function(Z,se){var ae=p[se],ce=ae.orientation;return!ae.mirror&&!ae.hide?Xt(Xt({},Z),{},Gn({},ce,Z[ce]+ae.width)):Z},{left:S.left||0,right:S.right||0}),B=Object.keys(d).reduce(function(Z,se){var ae=d[se],ce=ae.orientation;return!ae.mirror&&!ae.hide?Xt(Xt({},Z),{},Gn({},ce,Rc(Z,"".concat(ce))+ae.height)):Z},{top:S.top||0,bottom:S.bottom||0}),V=Xt(Xt({},B),L),$=V.bottom;P&&(V.bottom+=P.props.height||Eb.defaultProps.height),F&&r&&(V=MBe(V,a,i,r));var G=x-V.left-V.right,W=w-V.top-V.bottom;return Xt(Xt({brushBottom:$},V),{},{width:Math.max(G,0),height:Math.max(W,0)})},rWe=function(t,r){if(r==="xAxis")return t[r].width;if(r==="yAxis")return t[r].height},z_=function(t){var r=t.chartName,i=t.GraphicalChild,a=t.defaultTooltipEventType,l=a===void 0?"axis":a,d=t.validateTooltipEventTypes,s=d===void 0?["axis"]:d,p=t.axisComponents,x=t.legendContent,w=t.formatAxisMap,j=t.defaultProps,S=function(B,V){var $=V.graphicalItems,G=V.stackGroups,W=V.offset,Z=V.updateId,se=V.dataStartIndex,ae=V.dataEndIndex,ce=B.barSize,Pe=B.layout,we=B.barGap,xe=B.barCategoryGap,Ne=B.maxBarSize,ze=MK(Pe),ye=ze.numericAxisName,ve=ze.cateAxisName,_e=eWe($),Ee=[];return $.forEach(function(je,Ce){var tt=zM(B.data,{graphicalItems:[je],dataStartIndex:se,dataEndIndex:ae}),it=je.type.defaultProps!==void 0?Xt(Xt({},je.type.defaultProps),je.props):je.props,mt=it.dataKey,gt=it.maxBarSize,qt=it["".concat(ye,"Id")],yr=it["".concat(ve,"Id")],tr={},Ft=p.reduce(function(zt,Nr){var br=V["".concat(Nr.axisType,"Map")],hr=it["".concat(Nr.axisType,"Id")];br&&br[hr]||Nr.axisType==="zAxis"||ox();var rr=br[hr];return Xt(Xt({},zt),{},Gn(Gn({},Nr.axisType,rr),"".concat(Nr.axisType,"Ticks"),xm(rr)))},tr),er=Ft[ve],Dt=Ft["".concat(ve,"Ticks")],ge=G&&G[qt]&&G[qt].hasStack&&UBe(je,G[qt].stackGroups),sr=wm(je.type).indexOf("Bar")>=0,St=Kk(er,Dt),jr=[],dt=_e&&PBe({barSize:ce,stackGroups:G,totalSize:rWe(Ft,ve)});if(sr){var Yr,Vr,Yn=Tn(gt)?Ne:gt,Ye=(Yr=(Vr=Kk(er,Dt,!0))!==null&&Vr!==void 0?Vr:Yn)!==null&&Yr!==void 0?Yr:0;jr=EBe({barGap:we,barCategoryGap:xe,bandSize:Ye!==St?Ye:St,sizeList:dt[yr],maxBarSize:Yn}),Ye!==St&&(jr=jr.map(function(zt){return Xt(Xt({},zt),{},{position:Xt(Xt({},zt.position),{},{offset:zt.position.offset-Ye/2})})}))}var Nt=je&&je.type&&je.type.getComposedData;Nt&&Ee.push({props:Xt(Xt({},Nt(Xt(Xt({},Ft),{},{displayedData:tt,props:B,dataKey:mt,item:je,bandSize:St,barPosition:jr,offset:W,stackedData:ge,layout:Pe,dataStartIndex:se,dataEndIndex:ae}))),{},Gn(Gn(Gn({key:je.key||"item-".concat(Ce)},ye,Ft[ye]),ve,Ft[ve]),"animationId",Z)),childIndex:STe(je,B.children),item:je})}),Ee},P=function(B,V){var $=B.props,G=B.dataStartIndex,W=B.dataEndIndex,Z=B.updateId;if(!LG({props:$}))return null;var se=$.children,ae=$.layout,ce=$.stackOffset,Pe=$.data,we=$.reverseStackOrder,xe=MK(ae),Ne=xe.numericAxisName,ze=xe.cateAxisName,ye=Sl(se,i),ve=$Be(Pe,ye,"".concat(Ne,"Id"),"".concat(ze,"Id"),ce,we),_e=p.reduce(function(it,mt){var gt="".concat(mt.axisType,"Map");return Xt(Xt({},it),{},Gn({},gt,Jqe($,Xt(Xt({},mt),{},{graphicalItems:ye,stackGroups:mt.axisType===Ne&&ve,dataStartIndex:G,dataEndIndex:W}))))},{}),Ee=tWe(Xt(Xt({},_e),{},{props:$,graphicalItems:ye}),V==null?void 0:V.legendBBox);Object.keys(_e).forEach(function(it){_e[it]=w($,_e[it],Ee,it.replace("Map",""),r)});var je=_e["".concat(ze,"Map")],Ce=Qqe(je),tt=S($,Xt(Xt({},_e),{},{dataStartIndex:G,dataEndIndex:W,updateId:Z,graphicalItems:ye,stackGroups:ve,offset:Ee}));return Xt(Xt({formattedGraphicalItems:tt,graphicalItems:ye,offset:Ee,stackGroups:ve},Ce),_e)},F=function(L){function B(V){var $,G,W;return Rqe(this,B),W=Lqe(this,B,[V]),Gn(W,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),Gn(W,"accessibilityManager",new _qe),Gn(W,"handleLegendBBoxUpdate",function(Z){if(Z){var se=W.state,ae=se.dataStartIndex,ce=se.dataEndIndex,Pe=se.updateId;W.setState(Xt({legendBBox:Z},P({props:W.props,dataStartIndex:ae,dataEndIndex:ce,updateId:Pe},Xt(Xt({},W.state),{},{legendBBox:Z}))))}}),Gn(W,"handleReceiveSyncEvent",function(Z,se,ae){if(W.props.syncId===Z){if(ae===W.eventEmitterSymbol&&typeof W.props.syncMethod!="function")return;W.applySyncEvent(se)}}),Gn(W,"handleBrushChange",function(Z){var se=Z.startIndex,ae=Z.endIndex;if(se!==W.state.dataStartIndex||ae!==W.state.dataEndIndex){var ce=W.state.updateId;W.setState(function(){return Xt({dataStartIndex:se,dataEndIndex:ae},P({props:W.props,dataStartIndex:se,dataEndIndex:ae,updateId:ce},W.state))}),W.triggerSyncEvent({dataStartIndex:se,dataEndIndex:ae})}}),Gn(W,"handleMouseEnter",function(Z){var se=W.getMouseInfo(Z);if(se){var ae=Xt(Xt({},se),{},{isTooltipActive:!0});W.setState(ae),W.triggerSyncEvent(ae);var ce=W.props.onMouseEnter;Cn(ce)&&ce(ae,Z)}}),Gn(W,"triggeredAfterMouseMove",function(Z){var se=W.getMouseInfo(Z),ae=se?Xt(Xt({},se),{},{isTooltipActive:!0}):{isTooltipActive:!1};W.setState(ae),W.triggerSyncEvent(ae);var ce=W.props.onMouseMove;Cn(ce)&&ce(ae,Z)}),Gn(W,"handleItemMouseEnter",function(Z){W.setState(function(){return{isTooltipActive:!0,activeItem:Z,activePayload:Z.tooltipPayload,activeCoordinate:Z.tooltipPosition||{x:Z.cx,y:Z.cy}}})}),Gn(W,"handleItemMouseLeave",function(){W.setState(function(){return{isTooltipActive:!1}})}),Gn(W,"handleMouseMove",function(Z){Z.persist(),W.throttleTriggeredAfterMouseMove(Z)}),Gn(W,"handleMouseLeave",function(Z){W.throttleTriggeredAfterMouseMove.cancel();var se={isTooltipActive:!1};W.setState(se),W.triggerSyncEvent(se);var ae=W.props.onMouseLeave;Cn(ae)&&ae(se,Z)}),Gn(W,"handleOuterEvent",function(Z){var se=NTe(Z),ae=Rc(W.props,"".concat(se));if(se&&Cn(ae)){var ce,Pe;/.*touch.*/i.test(se)?Pe=W.getMouseInfo(Z.changedTouches[0]):Pe=W.getMouseInfo(Z),ae((ce=Pe)!==null&&ce!==void 0?ce:{},Z)}}),Gn(W,"handleClick",function(Z){var se=W.getMouseInfo(Z);if(se){var ae=Xt(Xt({},se),{},{isTooltipActive:!0});W.setState(ae),W.triggerSyncEvent(ae);var ce=W.props.onClick;Cn(ce)&&ce(ae,Z)}}),Gn(W,"handleMouseDown",function(Z){var se=W.props.onMouseDown;if(Cn(se)){var ae=W.getMouseInfo(Z);se(ae,Z)}}),Gn(W,"handleMouseUp",function(Z){var se=W.props.onMouseUp;if(Cn(se)){var ae=W.getMouseInfo(Z);se(ae,Z)}}),Gn(W,"handleTouchMove",function(Z){Z.changedTouches!=null&&Z.changedTouches.length>0&&W.throttleTriggeredAfterMouseMove(Z.changedTouches[0])}),Gn(W,"handleTouchStart",function(Z){Z.changedTouches!=null&&Z.changedTouches.length>0&&W.handleMouseDown(Z.changedTouches[0])}),Gn(W,"handleTouchEnd",function(Z){Z.changedTouches!=null&&Z.changedTouches.length>0&&W.handleMouseUp(Z.changedTouches[0])}),Gn(W,"triggerSyncEvent",function(Z){W.props.syncId!==void 0&&ZO.emit(YO,W.props.syncId,Z,W.eventEmitterSymbol)}),Gn(W,"applySyncEvent",function(Z){var se=W.props,ae=se.layout,ce=se.syncMethod,Pe=W.state.updateId,we=Z.dataStartIndex,xe=Z.dataEndIndex;if(Z.dataStartIndex!==void 0||Z.dataEndIndex!==void 0)W.setState(Xt({dataStartIndex:we,dataEndIndex:xe},P({props:W.props,dataStartIndex:we,dataEndIndex:xe,updateId:Pe},W.state)));else if(Z.activeTooltipIndex!==void 0){var Ne=Z.chartX,ze=Z.chartY,ye=Z.activeTooltipIndex,ve=W.state,_e=ve.offset,Ee=ve.tooltipTicks;if(!_e)return;if(typeof ce=="function")ye=ce(Ee,Z);else if(ce==="value"){ye=-1;for(var je=0;je<Ee.length;je++)if(Ee[je].value===Z.activeLabel){ye=je;break}}var Ce=Xt(Xt({},_e),{},{x:_e.left,y:_e.top}),tt=Math.min(Ne,Ce.x+Ce.width),it=Math.min(ze,Ce.y+Ce.height),mt=Ee[ye]&&Ee[ye].value,gt=Fz(W.state,W.props.data,ye),qt=Ee[ye]?{x:ae==="horizontal"?Ee[ye].coordinate:tt,y:ae==="horizontal"?it:Ee[ye].coordinate}:zae;W.setState(Xt(Xt({},Z),{},{activeLabel:mt,activeCoordinate:qt,activePayload:gt,activeTooltipIndex:ye}))}else W.setState(Z)}),Gn(W,"renderCursor",function(Z){var se,ae=W.state,ce=ae.isTooltipActive,Pe=ae.activeCoordinate,we=ae.activePayload,xe=ae.offset,Ne=ae.activeTooltipIndex,ze=ae.tooltipAxisBandSize,ye=W.getTooltipEventType(),ve=(se=Z.props.active)!==null&&se!==void 0?se:ce,_e=W.props.layout,Ee=Z.key||"_recharts-cursor";return ke.createElement(Tqe,{key:Ee,activeCoordinate:Pe,activePayload:we,activeTooltipIndex:Ne,chartName:r,element:Z,isActive:ve,layout:_e,offset:xe,tooltipAxisBandSize:ze,tooltipEventType:ye})}),Gn(W,"renderPolarAxis",function(Z,se,ae){var ce=Rc(Z,"type.axisType"),Pe=Rc(W.state,"".concat(ce,"Map")),we=Z.type.defaultProps,xe=we!==void 0?Xt(Xt({},we),Z.props):Z.props,Ne=Pe&&Pe[xe["".concat(ce,"Id")]];return U.cloneElement(Z,Xt(Xt({},Ne),{},{className:zn(ce,Ne.className),key:Z.key||"".concat(se,"-").concat(ae),ticks:xm(Ne,!0)}))}),Gn(W,"renderPolarGrid",function(Z){var se=Z.props,ae=se.radialLines,ce=se.polarAngles,Pe=se.polarRadius,we=W.state,xe=we.radiusAxisMap,Ne=we.angleAxisMap,ze=lp(xe),ye=lp(Ne),ve=ye.cx,_e=ye.cy,Ee=ye.innerRadius,je=ye.outerRadius;return U.cloneElement(Z,{polarAngles:Array.isArray(ce)?ce:xm(ye,!0).map(function(Ce){return Ce.coordinate}),polarRadius:Array.isArray(Pe)?Pe:xm(ze,!0).map(function(Ce){return Ce.coordinate}),cx:ve,cy:_e,innerRadius:Ee,outerRadius:je,key:Z.key||"polar-grid",radialLines:ae})}),Gn(W,"renderLegend",function(){var Z=W.state.formattedGraphicalItems,se=W.props,ae=se.children,ce=se.width,Pe=se.height,we=W.props.margin||{},xe=ce-(we.left||0)-(we.right||0),Ne=tse({children:ae,formattedGraphicalItems:Z,legendWidth:xe,legendContent:x});if(!Ne)return null;var ze=Ne.item,ye=TK(Ne,kqe);return U.cloneElement(ze,Xt(Xt({},ye),{},{chartWidth:ce,chartHeight:Pe,margin:we,onBBoxUpdate:W.handleLegendBBoxUpdate}))}),Gn(W,"renderTooltip",function(){var Z,se=W.props,ae=se.children,ce=se.accessibilityLayer,Pe=jc(ae,yi);if(!Pe)return null;var we=W.state,xe=we.isTooltipActive,Ne=we.activeCoordinate,ze=we.activePayload,ye=we.activeLabel,ve=we.offset,_e=(Z=Pe.props.active)!==null&&Z!==void 0?Z:xe;return U.cloneElement(Pe,{viewBox:Xt(Xt({},ve),{},{x:ve.left,y:ve.top}),active:_e,label:ye,payload:_e?ze:[],coordinate:Ne,accessibilityLayer:ce})}),Gn(W,"renderBrush",function(Z){var se=W.props,ae=se.margin,ce=se.data,Pe=W.state,we=Pe.offset,xe=Pe.dataStartIndex,Ne=Pe.dataEndIndex,ze=Pe.updateId;return U.cloneElement(Z,{key:Z.key||"_recharts-brush",onChange:ZA(W.handleBrushChange,Z.props.onChange),data:ce,x:kr(Z.props.x)?Z.props.x:we.left,y:kr(Z.props.y)?Z.props.y:we.top+we.height+we.brushBottom-(ae.bottom||0),width:kr(Z.props.width)?Z.props.width:we.width,startIndex:xe,endIndex:Ne,updateId:"brush-".concat(ze)})}),Gn(W,"renderReferenceElement",function(Z,se,ae){if(!Z)return null;var ce=W,Pe=ce.clipPathId,we=W.state,xe=we.xAxisMap,Ne=we.yAxisMap,ze=we.offset,ye=Z.type.defaultProps||{},ve=Z.props,_e=ve.xAxisId,Ee=_e===void 0?ye.xAxisId:_e,je=ve.yAxisId,Ce=je===void 0?ye.yAxisId:je;return U.cloneElement(Z,{key:Z.key||"".concat(se,"-").concat(ae),xAxis:xe[Ee],yAxis:Ne[Ce],viewBox:{x:ze.left,y:ze.top,width:ze.width,height:ze.height},clipPathId:Pe})}),Gn(W,"renderActivePoints",function(Z){var se=Z.item,ae=Z.activePoint,ce=Z.basePoint,Pe=Z.childIndex,we=Z.isRange,xe=[],Ne=se.props.key,ze=se.item.type.defaultProps!==void 0?Xt(Xt({},se.item.type.defaultProps),se.item.props):se.item.props,ye=ze.activeDot,ve=ze.dataKey,_e=Xt(Xt({index:Pe,dataKey:ve,cx:ae.x,cy:ae.y,r:4,fill:m6(se.item),strokeWidth:2,stroke:"#fff",payload:ae.payload,value:ae.value},en(ye,!1)),_k(ye));return xe.push(B.renderActiveDot(ye,_e,"".concat(Ne,"-activePoint-").concat(Pe))),ce?xe.push(B.renderActiveDot(ye,Xt(Xt({},_e),{},{cx:ce.x,cy:ce.y}),"".concat(Ne,"-basePoint-").concat(Pe))):we&&xe.push(null),xe}),Gn(W,"renderGraphicChild",function(Z,se,ae){var ce=W.filterFormatItem(Z,se,ae);if(!ce)return null;var Pe=W.getTooltipEventType(),we=W.state,xe=we.isTooltipActive,Ne=we.tooltipAxis,ze=we.activeTooltipIndex,ye=we.activeLabel,ve=W.props.children,_e=jc(ve,yi),Ee=ce.props,je=Ee.points,Ce=Ee.isRange,tt=Ee.baseLine,it=ce.item.type.defaultProps!==void 0?Xt(Xt({},ce.item.type.defaultProps),ce.item.props):ce.item.props,mt=it.activeDot,gt=it.hide,qt=it.activeBar,yr=it.activeShape,tr=!!(!gt&&xe&&_e&&(mt||qt||yr)),Ft={};Pe!=="axis"&&_e&&_e.props.trigger==="click"?Ft={onClick:ZA(W.handleItemMouseEnter,Z.props.onClick)}:Pe!=="axis"&&(Ft={onMouseLeave:ZA(W.handleItemMouseLeave,Z.props.onMouseLeave),onMouseEnter:ZA(W.handleItemMouseEnter,Z.props.onMouseEnter)});var er=U.cloneElement(Z,Xt(Xt({},ce.props),Ft));function Dt(Nr){return typeof Ne.dataKey=="function"?Ne.dataKey(Nr.payload):null}if(tr)if(ze>=0){var ge,sr;if(Ne.dataKey&&!Ne.allowDuplicatedCategory){var St=typeof Ne.dataKey=="function"?Dt:"payload.".concat(Ne.dataKey.toString());ge=bk(je,St,ye),sr=Ce&&tt&&bk(tt,St,ye)}else ge=je==null?void 0:je[ze],sr=Ce&&tt&&tt[ze];if(yr||qt){var jr=Z.props.activeIndex!==void 0?Z.props.activeIndex:ze;return[U.cloneElement(Z,Xt(Xt(Xt({},ce.props),Ft),{},{activeIndex:jr})),null,null]}if(!Tn(ge))return[er].concat(Gb(W.renderActivePoints({item:ce,activePoint:ge,basePoint:sr,childIndex:ze,isRange:Ce})))}else{var dt,Yr=(dt=W.getItemByXY(W.state.activeCoordinate))!==null&&dt!==void 0?dt:{graphicalItem:er},Vr=Yr.graphicalItem,Yn=Vr.item,Ye=Yn===void 0?Z:Yn,Nt=Vr.childIndex,zt=Xt(Xt(Xt({},ce.props),Ft),{},{activeIndex:Nt});return[U.cloneElement(Ye,zt),null,null]}return Ce?[er,null,null]:[er,null]}),Gn(W,"renderCustomized",function(Z,se,ae){return U.cloneElement(Z,Xt(Xt({key:"recharts-customized-".concat(ae)},W.props),W.state))}),Gn(W,"renderMap",{CartesianGrid:{handler:eT,once:!0},ReferenceArea:{handler:W.renderReferenceElement},ReferenceLine:{handler:eT},ReferenceDot:{handler:W.renderReferenceElement},XAxis:{handler:eT},YAxis:{handler:eT},Brush:{handler:W.renderBrush,once:!0},Bar:{handler:W.renderGraphicChild},Line:{handler:W.renderGraphicChild},Area:{handler:W.renderGraphicChild},Radar:{handler:W.renderGraphicChild},RadialBar:{handler:W.renderGraphicChild},Scatter:{handler:W.renderGraphicChild},Pie:{handler:W.renderGraphicChild},Funnel:{handler:W.renderGraphicChild},Tooltip:{handler:W.renderCursor,once:!0},PolarGrid:{handler:W.renderPolarGrid,once:!0},PolarAngleAxis:{handler:W.renderPolarAxis},PolarRadiusAxis:{handler:W.renderPolarAxis},Customized:{handler:W.renderCustomized}}),W.clipPathId="".concat(($=V.id)!==null&&$!==void 0?$:og("recharts"),"-clip"),W.throttleTriggeredAfterMouseMove=Xne(W.triggeredAfterMouseMove,(G=V.throttleDelay)!==null&&G!==void 0?G:1e3/60),W.state={},W}return $qe(B,L),zqe(B,[{key:"componentDidMount",value:function(){var $,G;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:($=this.props.margin.left)!==null&&$!==void 0?$:0,top:(G=this.props.margin.top)!==null&&G!==void 0?G:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var $=this.props,G=$.children,W=$.data,Z=$.height,se=$.layout,ae=jc(G,yi);if(ae){var ce=ae.props.defaultIndex;if(!(typeof ce!="number"||ce<0||ce>this.state.tooltipTicks.length-1)){var Pe=this.state.tooltipTicks[ce]&&this.state.tooltipTicks[ce].value,we=Fz(this.state,W,ce,Pe),xe=this.state.tooltipTicks[ce].coordinate,Ne=(this.state.offset.top+Z)/2,ze=se==="horizontal",ye=ze?{x:xe,y:Ne}:{y:xe,x:Ne},ve=this.state.formattedGraphicalItems.find(function(Ee){var je=Ee.item;return je.type.name==="Scatter"});ve&&(ye=Xt(Xt({},ye),ve.props.points[ce].tooltipPosition),we=ve.props.points[ce].tooltipPayload);var _e={activeTooltipIndex:ce,isTooltipActive:!0,activeLabel:Pe,activePayload:we,activeCoordinate:ye};this.setState(_e),this.renderCursor(ae),this.accessibilityManager.setIndex(ce)}}}},{key:"getSnapshotBeforeUpdate",value:function($,G){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==G.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==$.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==$.margin){var W,Z;this.accessibilityManager.setDetails({offset:{left:(W=this.props.margin.left)!==null&&W!==void 0?W:0,top:(Z=this.props.margin.top)!==null&&Z!==void 0?Z:0}})}return null}},{key:"componentDidUpdate",value:function($){c5([jc($.children,yi)],[jc(this.props.children,yi)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var $=jc(this.props.children,yi);if($&&typeof $.props.shared=="boolean"){var G=$.props.shared?"axis":"item";return s.indexOf(G)>=0?G:l}return l}},{key:"getMouseInfo",value:function($){if(!this.container)return null;var G=this.container,W=G.getBoundingClientRect(),Z=XDe(W),se={chartX:Math.round($.pageX-Z.left),chartY:Math.round($.pageY-Z.top)},ae=W.width/G.offsetWidth||1,ce=this.inRange(se.chartX,se.chartY,ae);if(!ce)return null;var Pe=this.state,we=Pe.xAxisMap,xe=Pe.yAxisMap,Ne=this.getTooltipEventType();if(Ne!=="axis"&&we&&xe){var ze=lp(we).scale,ye=lp(xe).scale,ve=ze&&ze.invert?ze.invert(se.chartX):null,_e=ye&&ye.invert?ye.invert(se.chartY):null;return Xt(Xt({},se),{},{xValue:ve,yValue:_e})}var Ee=PK(this.state,this.props.data,this.props.layout,ce);return Ee?Xt(Xt({},se),Ee):null}},{key:"inRange",value:function($,G){var W=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,Z=this.props.layout,se=$/W,ae=G/W;if(Z==="horizontal"||Z==="vertical"){var ce=this.state.offset,Pe=se>=ce.left&&se<=ce.left+ce.width&&ae>=ce.top&&ae<=ce.top+ce.height;return Pe?{x:se,y:ae}:null}var we=this.state,xe=we.angleAxisMap,Ne=we.radiusAxisMap;if(xe&&Ne){var ze=lp(xe);return Kq({x:se,y:ae},ze)}return null}},{key:"parseEventsOfWrapper",value:function(){var $=this.props.children,G=this.getTooltipEventType(),W=jc($,yi),Z={};W&&G==="axis"&&(W.props.trigger==="click"?Z={onClick:this.handleClick}:Z={onMouseEnter:this.handleMouseEnter,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd});var se=_k(this.props,this.handleOuterEvent);return Xt(Xt({},se),Z)}},{key:"addListener",value:function(){ZO.on(YO,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){ZO.removeListener(YO,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function($,G,W){for(var Z=this.state.formattedGraphicalItems,se=0,ae=Z.length;se<ae;se++){var ce=Z[se];if(ce.item===$||ce.props.key===$.key||G===wm(ce.item.type)&&W===ce.childIndex)return ce}return null}},{key:"renderClipPath",value:function(){var $=this.clipPathId,G=this.state.offset,W=G.left,Z=G.top,se=G.height,ae=G.width;return ke.createElement("defs",null,ke.createElement("clipPath",{id:$},ke.createElement("rect",{x:W,y:Z,height:se,width:ae})))}},{key:"getXScales",value:function(){var $=this.state.xAxisMap;return $?Object.entries($).reduce(function(G,W){var Z=AK(W,2),se=Z[0],ae=Z[1];return Xt(Xt({},G),{},Gn({},se,ae.scale))},{}):null}},{key:"getYScales",value:function(){var $=this.state.yAxisMap;return $?Object.entries($).reduce(function(G,W){var Z=AK(W,2),se=Z[0],ae=Z[1];return Xt(Xt({},G),{},Gn({},se,ae.scale))},{}):null}},{key:"getXScaleByAxisId",value:function($){var G;return(G=this.state.xAxisMap)===null||G===void 0||(G=G[$])===null||G===void 0?void 0:G.scale}},{key:"getYScaleByAxisId",value:function($){var G;return(G=this.state.yAxisMap)===null||G===void 0||(G=G[$])===null||G===void 0?void 0:G.scale}},{key:"getItemByXY",value:function($){var G=this.state,W=G.formattedGraphicalItems,Z=G.activeItem;if(W&&W.length)for(var se=0,ae=W.length;se<ae;se++){var ce=W[se],Pe=ce.props,we=ce.item,xe=we.type.defaultProps!==void 0?Xt(Xt({},we.type.defaultProps),we.props):we.props,Ne=wm(we.type);if(Ne==="Bar"){var ze=(Pe.data||[]).find(function(Ee){return A8e($,Ee)});if(ze)return{graphicalItem:ce,payload:ze}}else if(Ne==="RadialBar"){var ye=(Pe.data||[]).find(function(Ee){return Kq($,Ee)});if(ye)return{graphicalItem:ce,payload:ye}}else if(kM(ce,Z)||PM(ce,Z)||eN(ce,Z)){var ve=S7e({graphicalItem:ce,activeTooltipItem:Z,itemData:xe.data}),_e=xe.activeIndex===void 0?ve:xe.activeIndex;return{graphicalItem:Xt(Xt({},ce),{},{childIndex:_e}),payload:eN(ce,Z)?xe.data[ve]:ce.props.data[ve]}}}return null}},{key:"render",value:function(){var $=this;if(!LG(this))return null;var G=this.props,W=G.children,Z=G.className,se=G.width,ae=G.height,ce=G.style,Pe=G.compact,we=G.title,xe=G.desc,Ne=TK(G,Pqe),ze=en(Ne,!1);if(Pe)return ke.createElement(sK,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},ke.createElement(d5,Gj({},ze,{width:se,height:ae,title:we,desc:xe}),this.renderClipPath(),BG(W,this.renderMap)));if(this.props.accessibilityLayer){var ye,ve;ze.tabIndex=(ye=this.props.tabIndex)!==null&&ye!==void 0?ye:0,ze.role=(ve=this.props.role)!==null&&ve!==void 0?ve:"application",ze.onKeyDown=function(Ee){$.accessibilityManager.keyboardEvent(Ee)},ze.onFocus=function(){$.accessibilityManager.focus()}}var _e=this.parseEventsOfWrapper();return ke.createElement(sK,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},ke.createElement("div",Gj({className:zn("recharts-wrapper",Z),style:Xt({position:"relative",cursor:"default",width:se,height:ae},ce)},_e,{ref:function(je){$.container=je}}),ke.createElement(d5,Gj({},ze,{width:se,height:ae,title:we,desc:xe,style:Wqe}),this.renderClipPath(),BG(W,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(U.Component);return Gn(F,"displayName",r),Gn(F,"defaultProps",Xt({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},j)),Gn(F,"getDerivedStateFromProps",function(L,B){var V=L.dataKey,$=L.data,G=L.children,W=L.width,Z=L.height,se=L.layout,ae=L.stackOffset,ce=L.margin,Pe=B.dataStartIndex,we=B.dataEndIndex;if(B.updateId===void 0){var xe=EK(L);return Xt(Xt(Xt({},xe),{},{updateId:0},P(Xt(Xt({props:L},xe),{},{updateId:0}),B)),{},{prevDataKey:V,prevData:$,prevWidth:W,prevHeight:Z,prevLayout:se,prevStackOffset:ae,prevMargin:ce,prevChildren:G})}if(V!==B.prevDataKey||$!==B.prevData||W!==B.prevWidth||Z!==B.prevHeight||se!==B.prevLayout||ae!==B.prevStackOffset||!Lv(ce,B.prevMargin)){var Ne=EK(L),ze={chartX:B.chartX,chartY:B.chartY,isTooltipActive:B.isTooltipActive},ye=Xt(Xt({},PK(B,$,se)),{},{updateId:B.updateId+1}),ve=Xt(Xt(Xt({},Ne),ze),ye);return Xt(Xt(Xt({},ve),P(Xt({props:L},ve),B)),{},{prevDataKey:V,prevData:$,prevWidth:W,prevHeight:Z,prevLayout:se,prevStackOffset:ae,prevMargin:ce,prevChildren:G})}if(!c5(G,B.prevChildren)){var _e,Ee,je,Ce,tt=jc(G,Eb),it=tt&&(_e=(Ee=tt.props)===null||Ee===void 0?void 0:Ee.startIndex)!==null&&_e!==void 0?_e:Pe,mt=tt&&(je=(Ce=tt.props)===null||Ce===void 0?void 0:Ce.endIndex)!==null&&je!==void 0?je:we,gt=it!==Pe||mt!==we,qt=!Tn($),yr=qt&&!gt?B.updateId:B.updateId+1;return Xt(Xt({updateId:yr},P(Xt(Xt({props:L},B),{},{updateId:yr,dataStartIndex:it,dataEndIndex:mt}),B)),{},{prevChildren:G,dataStartIndex:it,dataEndIndex:mt})}return null}),Gn(F,"renderActiveDot",function(L,B,V){var $;return U.isValidElement(L)?$=U.cloneElement(L,B):Cn(L)?$=L(B):$=ke.createElement(R_,B),ke.createElement(Qn,{className:"recharts-active-dot",key:V},$)}),function(B){return ke.createElement(F,B)}},LM=z_({chartName:"LineChart",GraphicalChild:jl,axisComponents:[{axisType:"xAxis",AxisComp:is},{axisType:"yAxis",AxisComp:Gi}],formatAxisMap:MM}),nc=z_({chartName:"BarChart",GraphicalChild:pi,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:is},{axisType:"yAxis",AxisComp:Gi}],formatAxisMap:MM}),oN=z_({chartName:"PieChart",GraphicalChild:Gc,validateTooltipEventTypes:["item"],defaultTooltipEventType:"item",legendContent:"children",axisComponents:[{axisType:"angleAxis",AxisComp:Tx},{axisType:"radiusAxis",AxisComp:Ax}],formatAxisMap:mse,defaultProps:{layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}}),Fae=z_({chartName:"RadarChart",GraphicalChild:zp,axisComponents:[{axisType:"angleAxis",AxisComp:Tx},{axisType:"radiusAxis",AxisComp:Ax}],formatAxisMap:mse,defaultProps:{layout:"centric",startAngle:90,endAngle:-270,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}}),nWe=z_({chartName:"ScatterChart",GraphicalChild:cS,defaultTooltipEventType:"item",validateTooltipEventTypes:["item"],axisComponents:[{axisType:"xAxis",AxisComp:is},{axisType:"yAxis",AxisComp:Gi},{axisType:"zAxis",AxisComp:lS}],formatAxisMap:MM}),uS=z_({chartName:"AreaChart",GraphicalChild:Zo,axisComponents:[{axisType:"xAxis",AxisComp:is},{axisType:"yAxis",AxisComp:Gi}],formatAxisMap:MM});const IK=[{name:"Jan",satisfaction:85,accuracy:82,responseTime:1.8},{name:"Feb",satisfaction:87,accuracy:84,responseTime:1.6},{name:"Mar",satisfaction:89,accuracy:86,responseTime:1.5},{name:"Apr",satisfaction:86,accuracy:85,responseTime:1.4},{name:"May",satisfaction:90,accuracy:88,responseTime:1.3},{name:"Jun",satisfaction:92,accuracy:89,responseTime:1.2}],iWe=[{name:"Mon",queries:245,success:230,errors:15},{name:"Tue",queries:320,success:310,errors:10},{name:"Wed",queries:280,success:270,errors:10},{name:"Thu",queries:305,success:290,errors:15},{name:"Fri",queries:370,success:360,errors:10},{name:"Sat",queries:180,success:175,errors:5},{name:"Sun",queries:150,success:145,errors:5}],sWe=[{subject:"Accuracy",A:89,fullMark:100},{subject:"Helpfulness",A:92,fullMark:100},{subject:"Speed",A:95,fullMark:100},{subject:"Consistency",A:87,fullMark:100},{subject:"Reasoning",A:83,fullMark:100},{subject:"Creativity",A:80,fullMark:100}],aWe=[{name:"Response Time",value:1.2,benchmark:1.5,unit:"s"},{name:"Accuracy",value:89,benchmark:85,unit:"%"},{name:"User Satisfaction",value:92,benchmark:88,unit:"%"},{name:"Task Completion",value:94,benchmark:90,unit:"%"},{name:"Error Rate",value:3,benchmark:5,unit:"%"}],f0=({title:e,value:t,change:r,changeText:i,icon:a,unit:l="",className:d=""})=>{const s=typeof r=="number"?r>0:!1,p=typeof r=="number"?r<0:!1;return n.jsxs("div",{className:`glass-panel p-4 flex flex-col ${d}`,children:[n.jsxs("div",{className:"flex justify-between items-start mb-2",children:[n.jsx("span",{className:"text-gray-400 text-sm",children:e}),n.jsx("div",{className:"p-2 rounded-full bg-beam-blue/20",children:a})]}),n.jsxs("div",{className:"flex items-baseline gap-2",children:[n.jsxs("span",{className:"text-2xl font-bold text-white",children:[t,l]}),r!==void 0&&n.jsxs("div",{className:`flex items-center text-xs ${s?"text-green-400":p?"text-red-400":"text-gray-400"}`,children:[s&&n.jsx(Hye,{size:14}),p&&n.jsx(Gye,{size:14}),n.jsxs("span",{children:[Math.abs(r),l," ",i||""]})]})]})]})};function oWe(){const[e,t]=U.useState("month");return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("h2",{className:"text-xl font-medium text-white",children:"Performance Metrics"}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{onClick:()=>t("day"),className:`px-3 py-1 text-sm rounded-md ${e==="day"?"bg-beam-blue text-white":"text-gray-400 hover:bg-white/5"}`,children:"Day"}),n.jsx("button",{onClick:()=>t("week"),className:`px-3 py-1 text-sm rounded-md ${e==="week"?"bg-beam-blue text-white":"text-gray-400 hover:bg-white/5"}`,children:"Week"}),n.jsx("button",{onClick:()=>t("month"),className:`px-3 py-1 text-sm rounded-md ${e==="month"?"bg-beam-blue text-white":"text-gray-400 hover:bg-white/5"}`,children:"Month"}),n.jsx("button",{onClick:()=>t("quarter"),className:`px-3 py-1 text-sm rounded-md ${e==="quarter"?"bg-beam-blue text-white":"text-gray-400 hover:bg-white/5"}`,children:"Quarter"})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[n.jsx(f0,{title:"AI Effectiveness Score",value:87,unit:"%",change:3,changeText:"this month",icon:n.jsx(ti,{size:18,className:"text-beam-blue"}),className:"col-span-2 md:col-span-1"}),n.jsx(f0,{title:"User Satisfaction",value:92,unit:"%",change:4,icon:n.jsx($N,{size:18,className:"text-green-400"})}),n.jsx(f0,{title:"Accuracy Rate",value:89,unit:"%",change:2,icon:n.jsx(hh,{size:18,className:"text-blue-400"})}),n.jsx(f0,{title:"Avg. Response Time",value:1.2,unit:"s",change:-.3,icon:n.jsx(Yi,{size:18,className:"text-amber-400"})})]}),n.jsxs($i,{defaultValue:"trends",className:"w-full",children:[n.jsxs(Di,{className:"bg-beam-dark-accent/30 w-full justify-start mb-4",children:[n.jsx(Jt,{value:"trends",className:"data-[state=active]:bg-beam-blue data-[state=active]:text-white",children:"Trends"}),n.jsx(Jt,{value:"usage",className:"data-[state=active]:bg-beam-blue data-[state=active]:text-white",children:"Usage"}),n.jsx(Jt,{value:"capabilities",className:"data-[state=active]:bg-beam-blue data-[state=active]:text-white",children:"Capabilities"}),n.jsx(Jt,{value:"benchmarks",className:"data-[state=active]:bg-beam-blue data-[state=active]:text-white",children:"Benchmarks"})]}),n.jsxs(ur,{value:"trends",className:"space-y-4",children:[n.jsxs("div",{className:"glass-panel p-4",children:[n.jsx("h3",{className:"text-white font-medium mb-4",children:"Performance Trends"}),n.jsx("div",{className:"h-64",children:n.jsx(ms,{width:"100%",height:"100%",children:n.jsxs(LM,{data:IK,margin:{top:5,right:30,left:20,bottom:5},children:[n.jsx($s,{strokeDasharray:"3 3",stroke:"#2a2a2a"}),n.jsx(is,{dataKey:"name",stroke:"#6b7280"}),n.jsx(Gi,{stroke:"#6b7280",domain:[0,100]}),n.jsx(yi,{contentStyle:{backgroundColor:"#1f1f1f",borderColor:"#333",color:"#fff"}}),n.jsx(xa,{}),n.jsx(jl,{type:"monotone",dataKey:"satisfaction",name:"User Satisfaction (%)",stroke:"#34d399",activeDot:{r:8}}),n.jsx(jl,{type:"monotone",dataKey:"accuracy",name:"Accuracy (%)",stroke:"#3b82f6"})]})})})]}),n.jsxs("div",{className:"glass-panel p-4",children:[n.jsx("h3",{className:"text-white font-medium mb-4",children:"Response Time"}),n.jsx("div",{className:"h-64",children:n.jsx(ms,{width:"100%",height:"100%",children:n.jsxs(uS,{data:IK,margin:{top:5,right:30,left:20,bottom:5},children:[n.jsx($s,{strokeDasharray:"3 3",stroke:"#2a2a2a"}),n.jsx(is,{dataKey:"name",stroke:"#6b7280"}),n.jsx(Gi,{stroke:"#6b7280"}),n.jsx(yi,{contentStyle:{backgroundColor:"#1f1f1f",borderColor:"#333",color:"#fff"}}),n.jsx(Zo,{type:"monotone",dataKey:"responseTime",name:"Response Time (s)",stroke:"#f59e0b",fill:"#f59e0b33"})]})})})]})]}),n.jsxs(ur,{value:"usage",className:"space-y-4",children:[n.jsxs("div",{className:"glass-panel p-4",children:[n.jsx("h3",{className:"text-white font-medium mb-4",children:"Daily Usage Metrics"}),n.jsx("div",{className:"h-64",children:n.jsx(ms,{width:"100%",height:"100%",children:n.jsxs(nc,{data:iWe,margin:{top:5,right:30,left:20,bottom:5},children:[n.jsx($s,{strokeDasharray:"3 3",stroke:"#2a2a2a"}),n.jsx(is,{dataKey:"name",stroke:"#6b7280"}),n.jsx(Gi,{stroke:"#6b7280"}),n.jsx(yi,{contentStyle:{backgroundColor:"#1f1f1f",borderColor:"#333",color:"#fff"}}),n.jsx(xa,{}),n.jsx(pi,{dataKey:"queries",name:"Total Queries",fill:"#9b87f5"}),n.jsx(pi,{dataKey:"success",name:"Successful",fill:"#34d399"}),n.jsx(pi,{dataKey:"errors",name:"Errors",fill:"#ef4444"})]})})})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[n.jsx(f0,{title:"Total Queries",value:"1,850",change:12.5,changeText:"%",icon:n.jsx(En,{size:18,className:"text-beam-blue"})}),n.jsx(f0,{title:"Avg. Session Length",value:4.7,unit:"min",change:.8,icon:n.jsx($a,{size:18,className:"text-blue-400"})}),n.jsx(f0,{title:"Error Rate",value:3.2,unit:"%",change:-.7,icon:n.jsx(ub,{size:18,className:"text-red-400"})})]})]}),n.jsx(ur,{value:"capabilities",className:"space-y-4",children:n.jsxs("div",{className:"glass-panel p-4",children:[n.jsx("h3",{className:"text-white font-medium mb-4",children:"Agent Capabilities"}),n.jsx("div",{className:"h-80",children:n.jsx(ms,{width:"100%",height:"100%",children:n.jsxs(Fae,{cx:"50%",cy:"50%",outerRadius:"80%",data:sWe,children:[n.jsx(p6,{stroke:"#2a2a2a"}),n.jsx(Tx,{dataKey:"subject",stroke:"#6b7280"}),n.jsx(Ax,{angle:30,domain:[0,100],stroke:"#6b7280"}),n.jsx(zp,{name:"Agent Performance",dataKey:"A",stroke:"#9b87f5",fill:"#9b87f5",fillOpacity:.6}),n.jsx(yi,{contentStyle:{backgroundColor:"#1f1f1f",borderColor:"#333",color:"#fff"}}),n.jsx(xa,{})]})})})]})}),n.jsx(ur,{value:"benchmarks",className:"space-y-4",children:n.jsxs("div",{className:"glass-panel p-4",children:[n.jsx("h3",{className:"text-white font-medium mb-4",children:"Performance Benchmarks"}),n.jsx("div",{className:"space-y-6",children:aWe.map(i=>n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("span",{className:"text-white text-sm",children:i.name}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("span",{className:"text-sm font-medium text-white",children:[i.value,i.unit]}),n.jsx("span",{className:`text-xs ${(i.name==="Error Rate"?i.value<i.benchmark:i.value>i.benchmark)?"text-green-400":"text-red-400"}`,children:(i.name==="Error Rate"?i.value<i.benchmark:i.value>i.benchmark)?n.jsx(En,{size:14}):n.jsx(tx,{size:14})})]})]}),n.jsxs("div",{className:"relative h-2 w-full bg-white/10 rounded-full overflow-hidden",children:[n.jsx("div",{className:"h-full bg-beam-blue rounded-full",style:{width:`${i.value/(i.benchmark*1.5)*100}%`}}),n.jsx("div",{className:"absolute top-0 h-full w-0.5 bg-white/50",style:{left:`${i.benchmark/(i.benchmark*1.5)*100}%`}})]}),n.jsxs("div",{className:"flex justify-between text-xs text-gray-400",children:[n.jsxs("span",{children:["0",i.unit]}),n.jsxs("span",{children:["Benchmark: ",i.benchmark,i.unit]}),n.jsxs("span",{children:[i.benchmark*1.5,i.unit]})]})]},i.name))})]})})]})]})}const lWe=({selectedAgent:e,subView:t,setSubView:r})=>n.jsx(jt,{className:"bg-beam-dark-accent/70 border-gray-700",children:n.jsxs(wr,{className:"pb-0",children:[n.jsx(fr,{className:"text-xl text-white",children:e.name}),n.jsx(Ii,{className:"text-gray-400",children:e.owner}),n.jsxs($i,{value:t,onValueChange:r,className:"mt-4",children:[n.jsxs(Di,{className:"bg-beam-dark-accent/80 border-b border-gray-700",children:[n.jsx(Jt,{value:"overview",className:"data-[state=active]:text-beam-blue data-[state=active]:bg-beam-dark-accent/40",children:"Overview"}),n.jsx(Jt,{value:"performance",className:"data-[state=active]:text-beam-blue data-[state=active]:bg-beam-dark-accent/40",children:"Performance"}),n.jsx(Jt,{value:"guardrails",className:"data-[state=active]:text-beam-blue data-[state=active]:bg-beam-dark-accent/40",children:"Guardrails"})]}),n.jsxs(Ht,{className:"pt-4",children:[n.jsx(ur,{value:"overview",className:"mt-0",children:n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsx(jO,{title:"Tools & Capabilities",children:n.jsx("ul",{className:"space-y-2 text-sm text-gray-300",children:e.tools.map((i,a)=>n.jsxs("li",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"h-2 w-2 rounded-full bg-beam-blue"}),n.jsx("span",{children:i})]},a))})}),n.jsx(jO,{title:"Data Accessibility",children:n.jsx("ul",{className:"space-y-2 text-sm text-gray-300",children:e.data.map((i,a)=>n.jsxs("li",{className:"flex items-center gap-2",children:[n.jsx(ln,{size:14,className:"text-beam-blue"}),n.jsx("span",{children:i})]},a))})})]})}),n.jsx(ur,{value:"performance",className:"mt-0",children:n.jsx(oWe,{})}),n.jsx(ur,{value:"guardrails",className:"mt-0",children:n.jsx(jO,{title:"Guardrails",children:n.jsx("ul",{className:"space-y-2 text-sm text-gray-300",children:e.guardrails.map((i,a)=>n.jsxs("li",{className:"flex items-center gap-2",children:[n.jsx(NE,{size:14,className:"text-beam-blue"}),n.jsx("span",{children:i})]},a))})})})]})]})]})}),cWe=rg("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function Tt({className:e,variant:t,...r}){return n.jsx("div",{className:Yt(cWe({variant:t}),e),...r})}const uWe=({agents:e})=>{const t=e.filter(r=>r.model&&r.modelMetadata);return n.jsxs(jt,{className:"bg-beam-dark-accent/70 border-gray-700",children:[n.jsx(wr,{className:"pb-2",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ws,{size:18,className:"text-beam-blue"}),n.jsx(fr,{className:"text-xl text-white",children:"Agent Model Metadata"})]})}),n.jsx(Ht,{children:n.jsx("div",{className:"overflow-x-auto",children:n.jsxs(Mc,{children:[n.jsx(Ic,{children:n.jsxs(Fs,{className:"hover:bg-white/5",children:[n.jsx(Or,{className:"text-white",children:"Agent"}),n.jsx(Or,{className:"text-white",children:"Model"}),n.jsx(Or,{className:"text-white",children:"Provider"}),n.jsx(Or,{className:"text-white",children:"Size"}),n.jsx(Or,{className:"text-white",children:"Context Length"}),n.jsx(Or,{className:"text-white",children:"Cost"}),n.jsx(Or,{className:"text-white",children:"Capabilities"})]})}),n.jsx(Oc,{children:t.map(r=>{var i,a,l,d,s;return n.jsxs(Fs,{className:"hover:bg-white/5 border-white/10",children:[n.jsx(Rr,{className:"font-medium text-white",children:r.name}),n.jsx(Rr,{children:n.jsx("div",{className:"flex items-center gap-2",children:n.jsx(Tt,{className:"bg-beam-blue/30 text-beam-blue-light",children:r.model})})}),n.jsx(Rr,{className:"text-gray-300",children:((i=r.modelMetadata)==null?void 0:i.provider)||"OpenAI"}),n.jsx(Rr,{className:"text-gray-300",children:((a=r.modelMetadata)==null?void 0:a.size)||"175B parameters"}),n.jsx(Rr,{className:"text-gray-300",children:((l=r.modelMetadata)==null?void 0:l.contextLength)||"8K tokens"}),n.jsx(Rr,{className:"text-gray-300",children:((d=r.modelMetadata)==null?void 0:d.costPerToken)||"$0.002/1K tokens"}),n.jsx(Rr,{className:"text-gray-300",children:(s=r.modelMetadata)!=null&&s.capabilities?n.jsx("div",{className:"flex flex-wrap gap-1",children:r.modelMetadata.capabilities.map((p,x)=>n.jsx(Tt,{variant:"outline",className:"text-xs bg-gray-800/50 border-gray-700 text-gray-300",children:p},x))}):"N/A"})]},r.id)})})]})})})]})};function dWe(){const[e,t]=U.useState(wO[0]),[r,i]=U.useState("overview"),a=l=>{t(l)};return n.jsxs("div",{className:"flex flex-col gap-6 max-w-full min-w-0",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[n.jsx(jt,{className:"bg-beam-dark-accent/70 border-gray-700 text-white",children:n.jsxs(Ht,{className:"p-4",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx(Co,{size:18,className:"text-beam-blue"}),n.jsx(fr,{className:"text-base font-medium",children:"Active Agents"})]}),n.jsx("div",{className:"text-3xl font-bold",children:"24"}),n.jsx(Ii,{className:"text-gray-400",children:"Across 5 departments"})]})}),n.jsx(jt,{className:"bg-beam-dark-accent/70 border-gray-700 text-white",children:n.jsxs(Ht,{className:"p-4",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx(dn,{size:18,className:"text-beam-blue"}),n.jsx(fr,{className:"text-base font-medium",children:"Governance Status"})]}),n.jsx("div",{className:"text-3xl font-bold text-green-400",children:"Strong"}),n.jsx(Ii,{className:"text-gray-400",children:"All policies enforced"})]})}),n.jsx(jt,{className:"bg-beam-dark-accent/70 border-gray-700 text-white",children:n.jsxs(Ht,{className:"p-4",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx(fs,{size:18,className:"text-beam-blue"}),n.jsx(fr,{className:"text-base font-medium",children:"Issues"})]}),n.jsx("div",{className:"text-3xl font-bold text-amber-400",children:"2"}),n.jsx(Ii,{className:"text-gray-400",children:"Require attention"})]})})]}),n.jsx(uWe,{agents:wO}),n.jsx(ENe,{agents:wO,selectedAgent:e,setSelectedAgent:a}),e&&n.jsx(lWe,{selectedAgent:e,subView:r,setSubView:i})]})}const hWe=()=>n.jsx(Ia,{children:n.jsx(dWe,{})});function Va(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let r=0,i;r<e.length;r++)(i=Va(e[r]))!==""&&(t+=(t&&" ")+i);else for(let r in e)e[r]&&(t+=(t&&" ")+r);return t}var mWe={value:()=>{}};function FM(){for(var e=0,t=arguments.length,r={},i;e<t;++e){if(!(i=arguments[e]+"")||i in r||/[\s.]/.test(i))throw new Error("illegal type: "+i);r[i]=[]}return new MT(r)}function MT(e){this._=e}function fWe(e,t){return e.trim().split(/^|\s+/).map(function(r){var i="",a=r.indexOf(".");if(a>=0&&(i=r.slice(a+1),r=r.slice(0,a)),r&&!t.hasOwnProperty(r))throw new Error("unknown type: "+r);return{type:r,name:i}})}MT.prototype=FM.prototype={constructor:MT,on:function(e,t){var r=this._,i=fWe(e+"",r),a,l=-1,d=i.length;if(arguments.length<2){for(;++l<d;)if((a=(e=i[l]).type)&&(a=pWe(r[a],e.name)))return a;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++l<d;)if(a=(e=i[l]).type)r[a]=OK(r[a],e.name,t);else if(t==null)for(a in r)r[a]=OK(r[a],e.name,null);return this},copy:function(){var e={},t=this._;for(var r in t)e[r]=t[r].slice();return new MT(e)},call:function(e,t){if((a=arguments.length-2)>0)for(var r=new Array(a),i=0,a,l;i<a;++i)r[i]=arguments[i+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(l=this._[e],i=0,a=l.length;i<a;++i)l[i].value.apply(t,r)},apply:function(e,t,r){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var i=this._[e],a=0,l=i.length;a<l;++a)i[a].value.apply(t,r)}};function pWe(e,t){for(var r=0,i=e.length,a;r<i;++r)if((a=e[r]).name===t)return a.value}function OK(e,t,r){for(var i=0,a=e.length;i<a;++i)if(e[i].name===t){e[i]=mWe,e=e.slice(0,i).concat(e.slice(i+1));break}return r!=null&&e.push({name:t,value:r}),e}var Bz="http://www.w3.org/1999/xhtml";const RK={svg:"http://www.w3.org/2000/svg",xhtml:Bz,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function BM(e){var t=e+="",r=t.indexOf(":");return r>=0&&(t=e.slice(0,r))!=="xmlns"&&(e=e.slice(r+1)),RK.hasOwnProperty(t)?{space:RK[t],local:e}:e}function gWe(e){return function(){var t=this.ownerDocument,r=this.namespaceURI;return r===Bz&&t.documentElement.namespaceURI===Bz?t.createElement(e):t.createElementNS(r,e)}}function xWe(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Bae(e){var t=BM(e);return(t.local?xWe:gWe)(t)}function yWe(){}function S6(e){return e==null?yWe:function(){return this.querySelector(e)}}function vWe(e){typeof e!="function"&&(e=S6(e));for(var t=this._groups,r=t.length,i=new Array(r),a=0;a<r;++a)for(var l=t[a],d=l.length,s=i[a]=new Array(d),p,x,w=0;w<d;++w)(p=l[w])&&(x=e.call(p,p.__data__,w,l))&&("__data__"in p&&(x.__data__=p.__data__),s[w]=x);return new Hc(i,this._parents)}function bWe(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function _We(){return[]}function $ae(e){return e==null?_We:function(){return this.querySelectorAll(e)}}function wWe(e){return function(){return bWe(e.apply(this,arguments))}}function jWe(e){typeof e=="function"?e=wWe(e):e=$ae(e);for(var t=this._groups,r=t.length,i=[],a=[],l=0;l<r;++l)for(var d=t[l],s=d.length,p,x=0;x<s;++x)(p=d[x])&&(i.push(e.call(p,p.__data__,x,d)),a.push(p));return new Hc(i,a)}function Vae(e){return function(){return this.matches(e)}}function Uae(e){return function(t){return t.matches(e)}}var NWe=Array.prototype.find;function SWe(e){return function(){return NWe.call(this.children,e)}}function CWe(){return this.firstElementChild}function AWe(e){return this.select(e==null?CWe:SWe(typeof e=="function"?e:Uae(e)))}var TWe=Array.prototype.filter;function kWe(){return Array.from(this.children)}function PWe(e){return function(){return TWe.call(this.children,e)}}function EWe(e){return this.selectAll(e==null?kWe:PWe(typeof e=="function"?e:Uae(e)))}function MWe(e){typeof e!="function"&&(e=Vae(e));for(var t=this._groups,r=t.length,i=new Array(r),a=0;a<r;++a)for(var l=t[a],d=l.length,s=i[a]=[],p,x=0;x<d;++x)(p=l[x])&&e.call(p,p.__data__,x,l)&&s.push(p);return new Hc(i,this._parents)}function Gae(e){return new Array(e.length)}function IWe(){return new Hc(this._enter||this._groups.map(Gae),this._parents)}function CP(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}CP.prototype={constructor:CP,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function OWe(e){return function(){return e}}function RWe(e,t,r,i,a,l){for(var d=0,s,p=t.length,x=l.length;d<x;++d)(s=t[d])?(s.__data__=l[d],i[d]=s):r[d]=new CP(e,l[d]);for(;d<p;++d)(s=t[d])&&(a[d]=s)}function DWe(e,t,r,i,a,l,d){var s,p,x=new Map,w=t.length,j=l.length,S=new Array(w),P;for(s=0;s<w;++s)(p=t[s])&&(S[s]=P=d.call(p,p.__data__,s,t)+"",x.has(P)?a[s]=p:x.set(P,p));for(s=0;s<j;++s)P=d.call(e,l[s],s,l)+"",(p=x.get(P))?(i[s]=p,p.__data__=l[s],x.delete(P)):r[s]=new CP(e,l[s]);for(s=0;s<w;++s)(p=t[s])&&x.get(S[s])===p&&(a[s]=p)}function zWe(e){return e.__data__}function LWe(e,t){if(!arguments.length)return Array.from(this,zWe);var r=t?DWe:RWe,i=this._parents,a=this._groups;typeof e!="function"&&(e=OWe(e));for(var l=a.length,d=new Array(l),s=new Array(l),p=new Array(l),x=0;x<l;++x){var w=i[x],j=a[x],S=j.length,P=FWe(e.call(w,w&&w.__data__,x,i)),F=P.length,L=s[x]=new Array(F),B=d[x]=new Array(F),V=p[x]=new Array(S);r(w,j,L,B,V,P,t);for(var $=0,G=0,W,Z;$<F;++$)if(W=L[$]){for($>=G&&(G=$+1);!(Z=B[G])&&++G<F;);W._next=Z||null}}return d=new Hc(d,i),d._enter=s,d._exit=p,d}function FWe(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function BWe(){return new Hc(this._exit||this._groups.map(Gae),this._parents)}function $We(e,t,r){var i=this.enter(),a=this,l=this.exit();return typeof e=="function"?(i=e(i),i&&(i=i.selection())):i=i.append(e+""),t!=null&&(a=t(a),a&&(a=a.selection())),r==null?l.remove():r(l),i&&a?i.merge(a).order():a}function VWe(e){for(var t=e.selection?e.selection():e,r=this._groups,i=t._groups,a=r.length,l=i.length,d=Math.min(a,l),s=new Array(a),p=0;p<d;++p)for(var x=r[p],w=i[p],j=x.length,S=s[p]=new Array(j),P,F=0;F<j;++F)(P=x[F]||w[F])&&(S[F]=P);for(;p<a;++p)s[p]=r[p];return new Hc(s,this._parents)}function UWe(){for(var e=this._groups,t=-1,r=e.length;++t<r;)for(var i=e[t],a=i.length-1,l=i[a],d;--a>=0;)(d=i[a])&&(l&&d.compareDocumentPosition(l)^4&&l.parentNode.insertBefore(d,l),l=d);return this}function GWe(e){e||(e=HWe);function t(j,S){return j&&S?e(j.__data__,S.__data__):!j-!S}for(var r=this._groups,i=r.length,a=new Array(i),l=0;l<i;++l){for(var d=r[l],s=d.length,p=a[l]=new Array(s),x,w=0;w<s;++w)(x=d[w])&&(p[w]=x);p.sort(t)}return new Hc(a,this._parents).order()}function HWe(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function qWe(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function WWe(){return Array.from(this)}function KWe(){for(var e=this._groups,t=0,r=e.length;t<r;++t)for(var i=e[t],a=0,l=i.length;a<l;++a){var d=i[a];if(d)return d}return null}function ZWe(){let e=0;for(const t of this)++e;return e}function YWe(){return!this.node()}function XWe(e){for(var t=this._groups,r=0,i=t.length;r<i;++r)for(var a=t[r],l=0,d=a.length,s;l<d;++l)(s=a[l])&&e.call(s,s.__data__,l,a);return this}function JWe(e){return function(){this.removeAttribute(e)}}function QWe(e){return function(){this.removeAttributeNS(e.space,e.local)}}function eKe(e,t){return function(){this.setAttribute(e,t)}}function tKe(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function rKe(e,t){return function(){var r=t.apply(this,arguments);r==null?this.removeAttribute(e):this.setAttribute(e,r)}}function nKe(e,t){return function(){var r=t.apply(this,arguments);r==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,r)}}function iKe(e,t){var r=BM(e);if(arguments.length<2){var i=this.node();return r.local?i.getAttributeNS(r.space,r.local):i.getAttribute(r)}return this.each((t==null?r.local?QWe:JWe:typeof t=="function"?r.local?nKe:rKe:r.local?tKe:eKe)(r,t))}function Hae(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function sKe(e){return function(){this.style.removeProperty(e)}}function aKe(e,t,r){return function(){this.style.setProperty(e,t,r)}}function oKe(e,t,r){return function(){var i=t.apply(this,arguments);i==null?this.style.removeProperty(e):this.style.setProperty(e,i,r)}}function lKe(e,t,r){return arguments.length>1?this.each((t==null?sKe:typeof t=="function"?oKe:aKe)(e,t,r??"")):Hb(this.node(),e)}function Hb(e,t){return e.style.getPropertyValue(t)||Hae(e).getComputedStyle(e,null).getPropertyValue(t)}function cKe(e){return function(){delete this[e]}}function uKe(e,t){return function(){this[e]=t}}function dKe(e,t){return function(){var r=t.apply(this,arguments);r==null?delete this[e]:this[e]=r}}function hKe(e,t){return arguments.length>1?this.each((t==null?cKe:typeof t=="function"?dKe:uKe)(e,t)):this.node()[e]}function qae(e){return e.trim().split(/^|\s+/)}function C6(e){return e.classList||new Wae(e)}function Wae(e){this._node=e,this._names=qae(e.getAttribute("class")||"")}Wae.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function Kae(e,t){for(var r=C6(e),i=-1,a=t.length;++i<a;)r.add(t[i])}function Zae(e,t){for(var r=C6(e),i=-1,a=t.length;++i<a;)r.remove(t[i])}function mKe(e){return function(){Kae(this,e)}}function fKe(e){return function(){Zae(this,e)}}function pKe(e,t){return function(){(t.apply(this,arguments)?Kae:Zae)(this,e)}}function gKe(e,t){var r=qae(e+"");if(arguments.length<2){for(var i=C6(this.node()),a=-1,l=r.length;++a<l;)if(!i.contains(r[a]))return!1;return!0}return this.each((typeof t=="function"?pKe:t?mKe:fKe)(r,t))}function xKe(){this.textContent=""}function yKe(e){return function(){this.textContent=e}}function vKe(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function bKe(e){return arguments.length?this.each(e==null?xKe:(typeof e=="function"?vKe:yKe)(e)):this.node().textContent}function _Ke(){this.innerHTML=""}function wKe(e){return function(){this.innerHTML=e}}function jKe(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function NKe(e){return arguments.length?this.each(e==null?_Ke:(typeof e=="function"?jKe:wKe)(e)):this.node().innerHTML}function SKe(){this.nextSibling&&this.parentNode.appendChild(this)}function CKe(){return this.each(SKe)}function AKe(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function TKe(){return this.each(AKe)}function kKe(e){var t=typeof e=="function"?e:Bae(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function PKe(){return null}function EKe(e,t){var r=typeof e=="function"?e:Bae(e),i=t==null?PKe:typeof t=="function"?t:S6(t);return this.select(function(){return this.insertBefore(r.apply(this,arguments),i.apply(this,arguments)||null)})}function MKe(){var e=this.parentNode;e&&e.removeChild(this)}function IKe(){return this.each(MKe)}function OKe(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function RKe(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function DKe(e){return this.select(e?RKe:OKe)}function zKe(e){return arguments.length?this.property("__data__",e):this.node().__data__}function LKe(e){return function(t){e.call(this,t,this.__data__)}}function FKe(e){return e.trim().split(/^|\s+/).map(function(t){var r="",i=t.indexOf(".");return i>=0&&(r=t.slice(i+1),t=t.slice(0,i)),{type:t,name:r}})}function BKe(e){return function(){var t=this.__on;if(t){for(var r=0,i=-1,a=t.length,l;r<a;++r)l=t[r],(!e.type||l.type===e.type)&&l.name===e.name?this.removeEventListener(l.type,l.listener,l.options):t[++i]=l;++i?t.length=i:delete this.__on}}}function $Ke(e,t,r){return function(){var i=this.__on,a,l=LKe(t);if(i){for(var d=0,s=i.length;d<s;++d)if((a=i[d]).type===e.type&&a.name===e.name){this.removeEventListener(a.type,a.listener,a.options),this.addEventListener(a.type,a.listener=l,a.options=r),a.value=t;return}}this.addEventListener(e.type,l,r),a={type:e.type,name:e.name,value:t,listener:l,options:r},i?i.push(a):this.__on=[a]}}function VKe(e,t,r){var i=FKe(e+""),a,l=i.length,d;if(arguments.length<2){var s=this.node().__on;if(s){for(var p=0,x=s.length,w;p<x;++p)for(a=0,w=s[p];a<l;++a)if((d=i[a]).type===w.type&&d.name===w.name)return w.value}return}for(s=t?$Ke:BKe,a=0;a<l;++a)this.each(s(i[a],t,r));return this}function Yae(e,t,r){var i=Hae(e),a=i.CustomEvent;typeof a=="function"?a=new a(t,r):(a=i.document.createEvent("Event"),r?(a.initEvent(t,r.bubbles,r.cancelable),a.detail=r.detail):a.initEvent(t,!1,!1)),e.dispatchEvent(a)}function UKe(e,t){return function(){return Yae(this,e,t)}}function GKe(e,t){return function(){return Yae(this,e,t.apply(this,arguments))}}function HKe(e,t){return this.each((typeof t=="function"?GKe:UKe)(e,t))}function*qKe(){for(var e=this._groups,t=0,r=e.length;t<r;++t)for(var i=e[t],a=0,l=i.length,d;a<l;++a)(d=i[a])&&(yield d)}var Xae=[null];function Hc(e,t){this._groups=e,this._parents=t}function dS(){return new Hc([[document.documentElement]],Xae)}function WKe(){return this}Hc.prototype=dS.prototype={constructor:Hc,select:vWe,selectAll:jWe,selectChild:AWe,selectChildren:EWe,filter:MWe,data:LWe,enter:IWe,exit:BWe,join:$We,merge:VWe,selection:WKe,order:UWe,sort:GWe,call:qWe,nodes:WWe,node:KWe,size:ZWe,empty:YWe,each:XWe,attr:iKe,style:lKe,property:hKe,classed:gKe,text:bKe,html:NKe,raise:CKe,lower:TKe,append:kKe,insert:EKe,remove:IKe,clone:DKe,datum:zKe,on:VKe,dispatch:HKe,[Symbol.iterator]:qKe};function Cc(e){return typeof e=="string"?new Hc([[document.querySelector(e)]],[document.documentElement]):new Hc([[e]],Xae)}function KKe(e){let t;for(;t=e.sourceEvent;)e=t;return e}function od(e,t){if(e=KKe(e),t===void 0&&(t=e.currentTarget),t){var r=t.ownerSVGElement||t;if(r.createSVGPoint){var i=r.createSVGPoint();return i.x=e.clientX,i.y=e.clientY,i=i.matrixTransform(t.getScreenCTM().inverse()),[i.x,i.y]}if(t.getBoundingClientRect){var a=t.getBoundingClientRect();return[e.clientX-a.left-t.clientLeft,e.clientY-a.top-t.clientTop]}}return[e.pageX,e.pageY]}const ZKe={passive:!1},lN={capture:!0,passive:!1};function JO(e){e.stopImmediatePropagation()}function $v(e){e.preventDefault(),e.stopImmediatePropagation()}function Jae(e){var t=e.document.documentElement,r=Cc(e).on("dragstart.drag",$v,lN);"onselectstart"in t?r.on("selectstart.drag",$v,lN):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function Qae(e,t){var r=e.document.documentElement,i=Cc(e).on("dragstart.drag",null);t&&(i.on("click.drag",$v,lN),setTimeout(function(){i.on("click.drag",null)},0)),"onselectstart"in r?i.on("selectstart.drag",null):(r.style.MozUserSelect=r.__noselect,delete r.__noselect)}const tT=e=>()=>e;function $z(e,{sourceEvent:t,subject:r,target:i,identifier:a,active:l,x:d,y:s,dx:p,dy:x,dispatch:w}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:r,enumerable:!0,configurable:!0},target:{value:i,enumerable:!0,configurable:!0},identifier:{value:a,enumerable:!0,configurable:!0},active:{value:l,enumerable:!0,configurable:!0},x:{value:d,enumerable:!0,configurable:!0},y:{value:s,enumerable:!0,configurable:!0},dx:{value:p,enumerable:!0,configurable:!0},dy:{value:x,enumerable:!0,configurable:!0},_:{value:w}})}$z.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function YKe(e){return!e.ctrlKey&&!e.button}function XKe(){return this.parentNode}function JKe(e,t){return t??{x:e.x,y:e.y}}function QKe(){return navigator.maxTouchPoints||"ontouchstart"in this}function eoe(){var e=YKe,t=XKe,r=JKe,i=QKe,a={},l=FM("start","drag","end"),d=0,s,p,x,w,j=0;function S(W){W.on("mousedown.drag",P).filter(i).on("touchstart.drag",B).on("touchmove.drag",V,ZKe).on("touchend.drag touchcancel.drag",$).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function P(W,Z){if(!(w||!e.call(this,W,Z))){var se=G(this,t.call(this,W,Z),W,Z,"mouse");se&&(Cc(W.view).on("mousemove.drag",F,lN).on("mouseup.drag",L,lN),Jae(W.view),JO(W),x=!1,s=W.clientX,p=W.clientY,se("start",W))}}function F(W){if($v(W),!x){var Z=W.clientX-s,se=W.clientY-p;x=Z*Z+se*se>j}a.mouse("drag",W)}function L(W){Cc(W.view).on("mousemove.drag mouseup.drag",null),Qae(W.view,x),$v(W),a.mouse("end",W)}function B(W,Z){if(e.call(this,W,Z)){var se=W.changedTouches,ae=t.call(this,W,Z),ce=se.length,Pe,we;for(Pe=0;Pe<ce;++Pe)(we=G(this,ae,W,Z,se[Pe].identifier,se[Pe]))&&(JO(W),we("start",W,se[Pe]))}}function V(W){var Z=W.changedTouches,se=Z.length,ae,ce;for(ae=0;ae<se;++ae)(ce=a[Z[ae].identifier])&&($v(W),ce("drag",W,Z[ae]))}function $(W){var Z=W.changedTouches,se=Z.length,ae,ce;for(w&&clearTimeout(w),w=setTimeout(function(){w=null},500),ae=0;ae<se;++ae)(ce=a[Z[ae].identifier])&&(JO(W),ce("end",W,Z[ae]))}function G(W,Z,se,ae,ce,Pe){var we=l.copy(),xe=od(Pe||se,Z),Ne,ze,ye;if((ye=r.call(W,new $z("beforestart",{sourceEvent:se,target:S,identifier:ce,active:d,x:xe[0],y:xe[1],dx:0,dy:0,dispatch:we}),ae))!=null)return Ne=ye.x-xe[0]||0,ze=ye.y-xe[1]||0,function ve(_e,Ee,je){var Ce=xe,tt;switch(_e){case"start":a[ce]=ve,tt=d++;break;case"end":delete a[ce],--d;case"drag":xe=od(je||Ee,Z),tt=d;break}we.call(_e,W,new $z(_e,{sourceEvent:Ee,subject:ye,target:S,identifier:ce,active:tt,x:xe[0]+Ne,y:xe[1]+ze,dx:xe[0]-Ce[0],dy:xe[1]-Ce[1],dispatch:we}),ae)}}return S.filter=function(W){return arguments.length?(e=typeof W=="function"?W:tT(!!W),S):e},S.container=function(W){return arguments.length?(t=typeof W=="function"?W:tT(W),S):t},S.subject=function(W){return arguments.length?(r=typeof W=="function"?W:tT(W),S):r},S.touchable=function(W){return arguments.length?(i=typeof W=="function"?W:tT(!!W),S):i},S.on=function(){var W=l.on.apply(l,arguments);return W===l?S:W},S.clickDistance=function(W){return arguments.length?(j=(W=+W)*W,S):Math.sqrt(j)},S}var qb=0,vj=0,sj=0,toe=1e3,AP,bj,TP=0,cx=0,$M=0,cN=typeof performance=="object"&&performance.now?performance:Date,roe=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function A6(){return cx||(roe(eZe),cx=cN.now()+$M)}function eZe(){cx=0}function kP(){this._call=this._time=this._next=null}kP.prototype=noe.prototype={constructor:kP,restart:function(e,t,r){if(typeof e!="function")throw new TypeError("callback is not a function");r=(r==null?A6():+r)+(t==null?0:+t),!this._next&&bj!==this&&(bj?bj._next=this:AP=this,bj=this),this._call=e,this._time=r,Vz()},stop:function(){this._call&&(this._call=null,this._time=1/0,Vz())}};function noe(e,t,r){var i=new kP;return i.restart(e,t,r),i}function tZe(){A6(),++qb;for(var e=AP,t;e;)(t=cx-e._time)>=0&&e._call.call(void 0,t),e=e._next;--qb}function DK(){cx=(TP=cN.now())+$M,qb=vj=0;try{tZe()}finally{qb=0,nZe(),cx=0}}function rZe(){var e=cN.now(),t=e-TP;t>toe&&($M-=t,TP=e)}function nZe(){for(var e,t=AP,r,i=1/0;t;)t._call?(i>t._time&&(i=t._time),e=t,t=t._next):(r=t._next,t._next=null,t=e?e._next=r:AP=r);bj=e,Vz(i)}function Vz(e){if(!qb){vj&&(vj=clearTimeout(vj));var t=e-cx;t>24?(e<1/0&&(vj=setTimeout(DK,e-cN.now()-$M)),sj&&(sj=clearInterval(sj))):(sj||(TP=cN.now(),sj=setInterval(rZe,toe)),qb=1,roe(DK))}}function zK(e,t,r){var i=new kP;return t=t==null?0:+t,i.restart(a=>{i.stop(),e(a+t)},t,r),i}var iZe=FM("start","end","cancel","interrupt"),sZe=[],ioe=0,LK=1,Uz=2,IT=3,FK=4,Gz=5,OT=6;function VM(e,t,r,i,a,l){var d=e.__transition;if(!d)e.__transition={};else if(r in d)return;aZe(e,r,{name:t,index:i,group:a,on:iZe,tween:sZe,time:l.time,delay:l.delay,duration:l.duration,ease:l.ease,timer:null,state:ioe})}function T6(e,t){var r=kd(e,t);if(r.state>ioe)throw new Error("too late; already scheduled");return r}function Eh(e,t){var r=kd(e,t);if(r.state>IT)throw new Error("too late; already running");return r}function kd(e,t){var r=e.__transition;if(!r||!(r=r[t]))throw new Error("transition not found");return r}function aZe(e,t,r){var i=e.__transition,a;i[t]=r,r.timer=noe(l,0,r.time);function l(x){r.state=LK,r.timer.restart(d,r.delay,r.time),r.delay<=x&&d(x-r.delay)}function d(x){var w,j,S,P;if(r.state!==LK)return p();for(w in i)if(P=i[w],P.name===r.name){if(P.state===IT)return zK(d);P.state===FK?(P.state=OT,P.timer.stop(),P.on.call("interrupt",e,e.__data__,P.index,P.group),delete i[w]):+w<t&&(P.state=OT,P.timer.stop(),P.on.call("cancel",e,e.__data__,P.index,P.group),delete i[w])}if(zK(function(){r.state===IT&&(r.state=FK,r.timer.restart(s,r.delay,r.time),s(x))}),r.state=Uz,r.on.call("start",e,e.__data__,r.index,r.group),r.state===Uz){for(r.state=IT,a=new Array(S=r.tween.length),w=0,j=-1;w<S;++w)(P=r.tween[w].value.call(e,e.__data__,r.index,r.group))&&(a[++j]=P);a.length=j+1}}function s(x){for(var w=x<r.duration?r.ease.call(null,x/r.duration):(r.timer.restart(p),r.state=Gz,1),j=-1,S=a.length;++j<S;)a[j].call(e,w);r.state===Gz&&(r.on.call("end",e,e.__data__,r.index,r.group),p())}function p(){r.state=OT,r.timer.stop(),delete i[t];for(var x in i)return;delete e.__transition}}function RT(e,t){var r=e.__transition,i,a,l=!0,d;if(r){t=t==null?null:t+"";for(d in r){if((i=r[d]).name!==t){l=!1;continue}a=i.state>Uz&&i.state<Gz,i.state=OT,i.timer.stop(),i.on.call(a?"interrupt":"cancel",e,e.__data__,i.index,i.group),delete r[d]}l&&delete e.__transition}}function oZe(e){return this.each(function(){RT(this,e)})}function lZe(e,t){var r,i;return function(){var a=Eh(this,e),l=a.tween;if(l!==r){i=r=l;for(var d=0,s=i.length;d<s;++d)if(i[d].name===t){i=i.slice(),i.splice(d,1);break}}a.tween=i}}function cZe(e,t,r){var i,a;if(typeof r!="function")throw new Error;return function(){var l=Eh(this,e),d=l.tween;if(d!==i){a=(i=d).slice();for(var s={name:t,value:r},p=0,x=a.length;p<x;++p)if(a[p].name===t){a[p]=s;break}p===x&&a.push(s)}l.tween=a}}function uZe(e,t){var r=this._id;if(e+="",arguments.length<2){for(var i=kd(this.node(),r).tween,a=0,l=i.length,d;a<l;++a)if((d=i[a]).name===e)return d.value;return null}return this.each((t==null?lZe:cZe)(r,e,t))}function k6(e,t,r){var i=e._id;return e.each(function(){var a=Eh(this,i);(a.value||(a.value={}))[t]=r.apply(this,arguments)}),function(a){return kd(a,i).value[t]}}function soe(e,t){var r;return(typeof t=="number"?ud:t instanceof sx?Lk:(r=sx(t))?(t=r,Lk):cie)(e,t)}function dZe(e){return function(){this.removeAttribute(e)}}function hZe(e){return function(){this.removeAttributeNS(e.space,e.local)}}function mZe(e,t,r){var i,a=r+"",l;return function(){var d=this.getAttribute(e);return d===a?null:d===i?l:l=t(i=d,r)}}function fZe(e,t,r){var i,a=r+"",l;return function(){var d=this.getAttributeNS(e.space,e.local);return d===a?null:d===i?l:l=t(i=d,r)}}function pZe(e,t,r){var i,a,l;return function(){var d,s=r(this),p;return s==null?void this.removeAttribute(e):(d=this.getAttribute(e),p=s+"",d===p?null:d===i&&p===a?l:(a=p,l=t(i=d,s)))}}function gZe(e,t,r){var i,a,l;return function(){var d,s=r(this),p;return s==null?void this.removeAttributeNS(e.space,e.local):(d=this.getAttributeNS(e.space,e.local),p=s+"",d===p?null:d===i&&p===a?l:(a=p,l=t(i=d,s)))}}function xZe(e,t){var r=BM(e),i=r==="transform"?oze:soe;return this.attrTween(e,typeof t=="function"?(r.local?gZe:pZe)(r,i,k6(this,"attr."+e,t)):t==null?(r.local?hZe:dZe)(r):(r.local?fZe:mZe)(r,i,t))}function yZe(e,t){return function(r){this.setAttribute(e,t.call(this,r))}}function vZe(e,t){return function(r){this.setAttributeNS(e.space,e.local,t.call(this,r))}}function bZe(e,t){var r,i;function a(){var l=t.apply(this,arguments);return l!==i&&(r=(i=l)&&vZe(e,l)),r}return a._value=t,a}function _Ze(e,t){var r,i;function a(){var l=t.apply(this,arguments);return l!==i&&(r=(i=l)&&yZe(e,l)),r}return a._value=t,a}function wZe(e,t){var r="attr."+e;if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;var i=BM(e);return this.tween(r,(i.local?bZe:_Ze)(i,t))}function jZe(e,t){return function(){T6(this,e).delay=+t.apply(this,arguments)}}function NZe(e,t){return t=+t,function(){T6(this,e).delay=t}}function SZe(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?jZe:NZe)(t,e)):kd(this.node(),t).delay}function CZe(e,t){return function(){Eh(this,e).duration=+t.apply(this,arguments)}}function AZe(e,t){return t=+t,function(){Eh(this,e).duration=t}}function TZe(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?CZe:AZe)(t,e)):kd(this.node(),t).duration}function kZe(e,t){if(typeof t!="function")throw new Error;return function(){Eh(this,e).ease=t}}function PZe(e){var t=this._id;return arguments.length?this.each(kZe(t,e)):kd(this.node(),t).ease}function EZe(e,t){return function(){var r=t.apply(this,arguments);if(typeof r!="function")throw new Error;Eh(this,e).ease=r}}function MZe(e){if(typeof e!="function")throw new Error;return this.each(EZe(this._id,e))}function IZe(e){typeof e!="function"&&(e=Vae(e));for(var t=this._groups,r=t.length,i=new Array(r),a=0;a<r;++a)for(var l=t[a],d=l.length,s=i[a]=[],p,x=0;x<d;++x)(p=l[x])&&e.call(p,p.__data__,x,l)&&s.push(p);return new Dm(i,this._parents,this._name,this._id)}function OZe(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,r=e._groups,i=t.length,a=r.length,l=Math.min(i,a),d=new Array(i),s=0;s<l;++s)for(var p=t[s],x=r[s],w=p.length,j=d[s]=new Array(w),S,P=0;P<w;++P)(S=p[P]||x[P])&&(j[P]=S);for(;s<i;++s)d[s]=t[s];return new Dm(d,this._parents,this._name,this._id)}function RZe(e){return(e+"").trim().split(/^|\s+/).every(function(t){var r=t.indexOf(".");return r>=0&&(t=t.slice(0,r)),!t||t==="start"})}function DZe(e,t,r){var i,a,l=RZe(t)?T6:Eh;return function(){var d=l(this,e),s=d.on;s!==i&&(a=(i=s).copy()).on(t,r),d.on=a}}function zZe(e,t){var r=this._id;return arguments.length<2?kd(this.node(),r).on.on(e):this.each(DZe(r,e,t))}function LZe(e){return function(){var t=this.parentNode;for(var r in this.__transition)if(+r!==e)return;t&&t.removeChild(this)}}function FZe(){return this.on("end.remove",LZe(this._id))}function BZe(e){var t=this._name,r=this._id;typeof e!="function"&&(e=S6(e));for(var i=this._groups,a=i.length,l=new Array(a),d=0;d<a;++d)for(var s=i[d],p=s.length,x=l[d]=new Array(p),w,j,S=0;S<p;++S)(w=s[S])&&(j=e.call(w,w.__data__,S,s))&&("__data__"in w&&(j.__data__=w.__data__),x[S]=j,VM(x[S],t,r,S,x,kd(w,r)));return new Dm(l,this._parents,t,r)}function $Ze(e){var t=this._name,r=this._id;typeof e!="function"&&(e=$ae(e));for(var i=this._groups,a=i.length,l=[],d=[],s=0;s<a;++s)for(var p=i[s],x=p.length,w,j=0;j<x;++j)if(w=p[j]){for(var S=e.call(w,w.__data__,j,p),P,F=kd(w,r),L=0,B=S.length;L<B;++L)(P=S[L])&&VM(P,t,r,L,S,F);l.push(S),d.push(w)}return new Dm(l,d,t,r)}var VZe=dS.prototype.constructor;function UZe(){return new VZe(this._groups,this._parents)}function GZe(e,t){var r,i,a;return function(){var l=Hb(this,e),d=(this.style.removeProperty(e),Hb(this,e));return l===d?null:l===r&&d===i?a:a=t(r=l,i=d)}}function aoe(e){return function(){this.style.removeProperty(e)}}function HZe(e,t,r){var i,a=r+"",l;return function(){var d=Hb(this,e);return d===a?null:d===i?l:l=t(i=d,r)}}function qZe(e,t,r){var i,a,l;return function(){var d=Hb(this,e),s=r(this),p=s+"";return s==null&&(p=s=(this.style.removeProperty(e),Hb(this,e))),d===p?null:d===i&&p===a?l:(a=p,l=t(i=d,s))}}function WZe(e,t){var r,i,a,l="style."+t,d="end."+l,s;return function(){var p=Eh(this,e),x=p.on,w=p.value[l]==null?s||(s=aoe(t)):void 0;(x!==r||a!==w)&&(i=(r=x).copy()).on(d,a=w),p.on=i}}function KZe(e,t,r){var i=(e+="")=="transform"?aze:soe;return t==null?this.styleTween(e,GZe(e,i)).on("end.style."+e,aoe(e)):typeof t=="function"?this.styleTween(e,qZe(e,i,k6(this,"style."+e,t))).each(WZe(this._id,e)):this.styleTween(e,HZe(e,i,t),r).on("end.style."+e,null)}function ZZe(e,t,r){return function(i){this.style.setProperty(e,t.call(this,i),r)}}function YZe(e,t,r){var i,a;function l(){var d=t.apply(this,arguments);return d!==a&&(i=(a=d)&&ZZe(e,d,r)),i}return l._value=t,l}function XZe(e,t,r){var i="style."+(e+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(t==null)return this.tween(i,null);if(typeof t!="function")throw new Error;return this.tween(i,YZe(e,t,r??""))}function JZe(e){return function(){this.textContent=e}}function QZe(e){return function(){var t=e(this);this.textContent=t??""}}function eYe(e){return this.tween("text",typeof e=="function"?QZe(k6(this,"text",e)):JZe(e==null?"":e+""))}function tYe(e){return function(t){this.textContent=e.call(this,t)}}function rYe(e){var t,r;function i(){var a=e.apply(this,arguments);return a!==r&&(t=(r=a)&&tYe(a)),t}return i._value=e,i}function nYe(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,rYe(e))}function iYe(){for(var e=this._name,t=this._id,r=ooe(),i=this._groups,a=i.length,l=0;l<a;++l)for(var d=i[l],s=d.length,p,x=0;x<s;++x)if(p=d[x]){var w=kd(p,t);VM(p,e,r,x,d,{time:w.time+w.delay+w.duration,delay:0,duration:w.duration,ease:w.ease})}return new Dm(i,this._parents,e,r)}function sYe(){var e,t,r=this,i=r._id,a=r.size();return new Promise(function(l,d){var s={value:d},p={value:function(){--a===0&&l()}};r.each(function(){var x=Eh(this,i),w=x.on;w!==e&&(t=(e=w).copy(),t._.cancel.push(s),t._.interrupt.push(s),t._.end.push(p)),x.on=t}),a===0&&l()})}var aYe=0;function Dm(e,t,r,i){this._groups=e,this._parents=t,this._name=r,this._id=i}function ooe(){return++aYe}var em=dS.prototype;Dm.prototype={constructor:Dm,select:BZe,selectAll:$Ze,selectChild:em.selectChild,selectChildren:em.selectChildren,filter:IZe,merge:OZe,selection:UZe,transition:iYe,call:em.call,nodes:em.nodes,node:em.node,size:em.size,empty:em.empty,each:em.each,on:zZe,attr:xZe,attrTween:wZe,style:KZe,styleTween:XZe,text:eYe,textTween:nYe,remove:FZe,tween:uZe,delay:SZe,duration:TZe,ease:PZe,easeVarying:MZe,end:sYe,[Symbol.iterator]:em[Symbol.iterator]};function oYe(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var lYe={time:null,delay:0,duration:250,ease:oYe};function cYe(e,t){for(var r;!(r=e.__transition)||!(r=r[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return r}function uYe(e){var t,r;e instanceof Dm?(t=e._id,e=e._name):(t=ooe(),(r=lYe).time=A6(),e=e==null?null:e+"");for(var i=this._groups,a=i.length,l=0;l<a;++l)for(var d=i[l],s=d.length,p,x=0;x<s;++x)(p=d[x])&&VM(p,e,t,x,d,r||cYe(p,t));return new Dm(i,this._parents,e,t)}dS.prototype.interrupt=oZe;dS.prototype.transition=uYe;const rT=e=>()=>e;function dYe(e,{sourceEvent:t,target:r,transform:i,dispatch:a}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},transform:{value:i,enumerable:!0,configurable:!0},_:{value:a}})}function ym(e,t,r){this.k=e,this.x=t,this.y=r}ym.prototype={constructor:ym,scale:function(e){return e===1?this:new ym(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new ym(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var UM=new ym(1,0,0);loe.prototype=ym.prototype;function loe(e){for(;!e.__zoom;)if(!(e=e.parentNode))return UM;return e.__zoom}function QO(e){e.stopImmediatePropagation()}function aj(e){e.preventDefault(),e.stopImmediatePropagation()}function hYe(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function mYe(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function BK(){return this.__zoom||UM}function fYe(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function pYe(){return navigator.maxTouchPoints||"ontouchstart"in this}function gYe(e,t,r){var i=e.invertX(t[0][0])-r[0][0],a=e.invertX(t[1][0])-r[1][0],l=e.invertY(t[0][1])-r[0][1],d=e.invertY(t[1][1])-r[1][1];return e.translate(a>i?(i+a)/2:Math.min(0,i)||Math.max(0,a),d>l?(l+d)/2:Math.min(0,l)||Math.max(0,d))}function coe(){var e=hYe,t=mYe,r=gYe,i=fYe,a=pYe,l=[0,1/0],d=[[-1/0,-1/0],[1/0,1/0]],s=250,p=PT,x=FM("start","zoom","end"),w,j,S,P=500,F=150,L=0,B=10;function V(ye){ye.property("__zoom",BK).on("wheel.zoom",ce,{passive:!1}).on("mousedown.zoom",Pe).on("dblclick.zoom",we).filter(a).on("touchstart.zoom",xe).on("touchmove.zoom",Ne).on("touchend.zoom touchcancel.zoom",ze).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}V.transform=function(ye,ve,_e,Ee){var je=ye.selection?ye.selection():ye;je.property("__zoom",BK),ye!==je?Z(ye,ve,_e,Ee):je.interrupt().each(function(){se(this,arguments).event(Ee).start().zoom(null,typeof ve=="function"?ve.apply(this,arguments):ve).end()})},V.scaleBy=function(ye,ve,_e,Ee){V.scaleTo(ye,function(){var je=this.__zoom.k,Ce=typeof ve=="function"?ve.apply(this,arguments):ve;return je*Ce},_e,Ee)},V.scaleTo=function(ye,ve,_e,Ee){V.transform(ye,function(){var je=t.apply(this,arguments),Ce=this.__zoom,tt=_e==null?W(je):typeof _e=="function"?_e.apply(this,arguments):_e,it=Ce.invert(tt),mt=typeof ve=="function"?ve.apply(this,arguments):ve;return r(G($(Ce,mt),tt,it),je,d)},_e,Ee)},V.translateBy=function(ye,ve,_e,Ee){V.transform(ye,function(){return r(this.__zoom.translate(typeof ve=="function"?ve.apply(this,arguments):ve,typeof _e=="function"?_e.apply(this,arguments):_e),t.apply(this,arguments),d)},null,Ee)},V.translateTo=function(ye,ve,_e,Ee,je){V.transform(ye,function(){var Ce=t.apply(this,arguments),tt=this.__zoom,it=Ee==null?W(Ce):typeof Ee=="function"?Ee.apply(this,arguments):Ee;return r(UM.translate(it[0],it[1]).scale(tt.k).translate(typeof ve=="function"?-ve.apply(this,arguments):-ve,typeof _e=="function"?-_e.apply(this,arguments):-_e),Ce,d)},Ee,je)};function $(ye,ve){return ve=Math.max(l[0],Math.min(l[1],ve)),ve===ye.k?ye:new ym(ve,ye.x,ye.y)}function G(ye,ve,_e){var Ee=ve[0]-_e[0]*ye.k,je=ve[1]-_e[1]*ye.k;return Ee===ye.x&&je===ye.y?ye:new ym(ye.k,Ee,je)}function W(ye){return[(+ye[0][0]+ +ye[1][0])/2,(+ye[0][1]+ +ye[1][1])/2]}function Z(ye,ve,_e,Ee){ye.on("start.zoom",function(){se(this,arguments).event(Ee).start()}).on("interrupt.zoom end.zoom",function(){se(this,arguments).event(Ee).end()}).tween("zoom",function(){var je=this,Ce=arguments,tt=se(je,Ce).event(Ee),it=t.apply(je,Ce),mt=_e==null?W(it):typeof _e=="function"?_e.apply(je,Ce):_e,gt=Math.max(it[1][0]-it[0][0],it[1][1]-it[0][1]),qt=je.__zoom,yr=typeof ve=="function"?ve.apply(je,Ce):ve,tr=p(qt.invert(mt).concat(gt/qt.k),yr.invert(mt).concat(gt/yr.k));return function(Ft){if(Ft===1)Ft=yr;else{var er=tr(Ft),Dt=gt/er[2];Ft=new ym(Dt,mt[0]-er[0]*Dt,mt[1]-er[1]*Dt)}tt.zoom(null,Ft)}})}function se(ye,ve,_e){return!_e&&ye.__zooming||new ae(ye,ve)}function ae(ye,ve){this.that=ye,this.args=ve,this.active=0,this.sourceEvent=null,this.extent=t.apply(ye,ve),this.taps=0}ae.prototype={event:function(ye){return ye&&(this.sourceEvent=ye),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(ye,ve){return this.mouse&&ye!=="mouse"&&(this.mouse[1]=ve.invert(this.mouse[0])),this.touch0&&ye!=="touch"&&(this.touch0[1]=ve.invert(this.touch0[0])),this.touch1&&ye!=="touch"&&(this.touch1[1]=ve.invert(this.touch1[0])),this.that.__zoom=ve,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(ye){var ve=Cc(this.that).datum();x.call(ye,this.that,new dYe(ye,{sourceEvent:this.sourceEvent,target:V,type:ye,transform:this.that.__zoom,dispatch:x}),ve)}};function ce(ye,...ve){if(!e.apply(this,arguments))return;var _e=se(this,ve).event(ye),Ee=this.__zoom,je=Math.max(l[0],Math.min(l[1],Ee.k*Math.pow(2,i.apply(this,arguments)))),Ce=od(ye);if(_e.wheel)(_e.mouse[0][0]!==Ce[0]||_e.mouse[0][1]!==Ce[1])&&(_e.mouse[1]=Ee.invert(_e.mouse[0]=Ce)),clearTimeout(_e.wheel);else{if(Ee.k===je)return;_e.mouse=[Ce,Ee.invert(Ce)],RT(this),_e.start()}aj(ye),_e.wheel=setTimeout(tt,F),_e.zoom("mouse",r(G($(Ee,je),_e.mouse[0],_e.mouse[1]),_e.extent,d));function tt(){_e.wheel=null,_e.end()}}function Pe(ye,...ve){if(S||!e.apply(this,arguments))return;var _e=ye.currentTarget,Ee=se(this,ve,!0).event(ye),je=Cc(ye.view).on("mousemove.zoom",mt,!0).on("mouseup.zoom",gt,!0),Ce=od(ye,_e),tt=ye.clientX,it=ye.clientY;Jae(ye.view),QO(ye),Ee.mouse=[Ce,this.__zoom.invert(Ce)],RT(this),Ee.start();function mt(qt){if(aj(qt),!Ee.moved){var yr=qt.clientX-tt,tr=qt.clientY-it;Ee.moved=yr*yr+tr*tr>L}Ee.event(qt).zoom("mouse",r(G(Ee.that.__zoom,Ee.mouse[0]=od(qt,_e),Ee.mouse[1]),Ee.extent,d))}function gt(qt){je.on("mousemove.zoom mouseup.zoom",null),Qae(qt.view,Ee.moved),aj(qt),Ee.event(qt).end()}}function we(ye,...ve){if(e.apply(this,arguments)){var _e=this.__zoom,Ee=od(ye.changedTouches?ye.changedTouches[0]:ye,this),je=_e.invert(Ee),Ce=_e.k*(ye.shiftKey?.5:2),tt=r(G($(_e,Ce),Ee,je),t.apply(this,ve),d);aj(ye),s>0?Cc(this).transition().duration(s).call(Z,tt,Ee,ye):Cc(this).call(V.transform,tt,Ee,ye)}}function xe(ye,...ve){if(e.apply(this,arguments)){var _e=ye.touches,Ee=_e.length,je=se(this,ve,ye.changedTouches.length===Ee).event(ye),Ce,tt,it,mt;for(QO(ye),tt=0;tt<Ee;++tt)it=_e[tt],mt=od(it,this),mt=[mt,this.__zoom.invert(mt),it.identifier],je.touch0?!je.touch1&&je.touch0[2]!==mt[2]&&(je.touch1=mt,je.taps=0):(je.touch0=mt,Ce=!0,je.taps=1+!!w);w&&(w=clearTimeout(w)),Ce&&(je.taps<2&&(j=mt[0],w=setTimeout(function(){w=null},P)),RT(this),je.start())}}function Ne(ye,...ve){if(this.__zooming){var _e=se(this,ve).event(ye),Ee=ye.changedTouches,je=Ee.length,Ce,tt,it,mt;for(aj(ye),Ce=0;Ce<je;++Ce)tt=Ee[Ce],it=od(tt,this),_e.touch0&&_e.touch0[2]===tt.identifier?_e.touch0[0]=it:_e.touch1&&_e.touch1[2]===tt.identifier&&(_e.touch1[0]=it);if(tt=_e.that.__zoom,_e.touch1){var gt=_e.touch0[0],qt=_e.touch0[1],yr=_e.touch1[0],tr=_e.touch1[1],Ft=(Ft=yr[0]-gt[0])*Ft+(Ft=yr[1]-gt[1])*Ft,er=(er=tr[0]-qt[0])*er+(er=tr[1]-qt[1])*er;tt=$(tt,Math.sqrt(Ft/er)),it=[(gt[0]+yr[0])/2,(gt[1]+yr[1])/2],mt=[(qt[0]+tr[0])/2,(qt[1]+tr[1])/2]}else if(_e.touch0)it=_e.touch0[0],mt=_e.touch0[1];else return;_e.zoom("touch",r(G(tt,it,mt),_e.extent,d))}}function ze(ye,...ve){if(this.__zooming){var _e=se(this,ve).event(ye),Ee=ye.changedTouches,je=Ee.length,Ce,tt;for(QO(ye),S&&clearTimeout(S),S=setTimeout(function(){S=null},P),Ce=0;Ce<je;++Ce)tt=Ee[Ce],_e.touch0&&_e.touch0[2]===tt.identifier?delete _e.touch0:_e.touch1&&_e.touch1[2]===tt.identifier&&delete _e.touch1;if(_e.touch1&&!_e.touch0&&(_e.touch0=_e.touch1,delete _e.touch1),_e.touch0)_e.touch0[1]=this.__zoom.invert(_e.touch0[0]);else if(_e.end(),_e.taps===2&&(tt=od(tt,this),Math.hypot(j[0]-tt[0],j[1]-tt[1])<B)){var it=Cc(this).on("dblclick.zoom");it&&it.apply(this,arguments)}}}return V.wheelDelta=function(ye){return arguments.length?(i=typeof ye=="function"?ye:rT(+ye),V):i},V.filter=function(ye){return arguments.length?(e=typeof ye=="function"?ye:rT(!!ye),V):e},V.touchable=function(ye){return arguments.length?(a=typeof ye=="function"?ye:rT(!!ye),V):a},V.extent=function(ye){return arguments.length?(t=typeof ye=="function"?ye:rT([[+ye[0][0],+ye[0][1]],[+ye[1][0],+ye[1][1]]]),V):t},V.scaleExtent=function(ye){return arguments.length?(l[0]=+ye[0],l[1]=+ye[1],V):[l[0],l[1]]},V.translateExtent=function(ye){return arguments.length?(d[0][0]=+ye[0][0],d[1][0]=+ye[1][0],d[0][1]=+ye[0][1],d[1][1]=+ye[1][1],V):[[d[0][0],d[0][1]],[d[1][0],d[1][1]]]},V.constrain=function(ye){return arguments.length?(r=ye,V):r},V.duration=function(ye){return arguments.length?(s=+ye,V):s},V.interpolate=function(ye){return arguments.length?(p=ye,V):p},V.on=function(){var ye=x.on.apply(x,arguments);return ye===x?V:ye},V.clickDistance=function(ye){return arguments.length?(L=(ye=+ye)*ye,V):Math.sqrt(L)},V.tapDistance=function(ye){return arguments.length?(B=+ye,V):B},V}const bh={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,{id:t,sourceHandle:r,targetHandle:i})=>`Couldn't create edge for ${e} handle id: "${e==="source"?r:i}", edge id: ${t}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(e="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${e}/dist/style.css' or base.css to make sure everything is working properly.`,error014:()=>"useNodeConnections: No node ID found. Call useNodeConnections inside a custom Node or provide a node ID.",error015:()=>"It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs."},uN=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],uoe=["Enter"," ","Escape"],doe={"node.a11yDescription.default":"Press enter or space to select a node. Press delete to remove it and escape to cancel.","node.a11yDescription.keyboardDisabled":"Press enter or space to select a node. You can then use the arrow keys to move the node around. Press delete to remove it and escape to cancel.","node.a11yDescription.ariaLiveMessage":({direction:e,x:t,y:r})=>`Moved selected node ${e}. New position, x: ${t}, y: ${r}`,"edge.a11yDescription.default":"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel.","controls.ariaLabel":"Control Panel","controls.zoomIn.ariaLabel":"Zoom In","controls.zoomOut.ariaLabel":"Zoom Out","controls.fitView.ariaLabel":"Fit View","controls.interactive.ariaLabel":"Toggle Interactivity","minimap.ariaLabel":"Mini Map","handle.ariaLabel":"Handle"};var Wb;(function(e){e.Strict="strict",e.Loose="loose"})(Wb||(Wb={}));var H0;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(H0||(H0={}));var dN;(function(e){e.Partial="partial",e.Full="full"})(dN||(dN={}));const hoe={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null};var cp;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(cp||(cp={}));var PP;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(PP||(PP={}));var cn;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(cn||(cn={}));const $K={[cn.Left]:cn.Right,[cn.Right]:cn.Left,[cn.Top]:cn.Bottom,[cn.Bottom]:cn.Top};function moe(e){return e===null?null:e?"valid":"invalid"}const foe=e=>"id"in e&&"source"in e&&"target"in e,xYe=e=>"id"in e&&"position"in e&&!("source"in e)&&!("target"in e),P6=e=>"id"in e&&"internals"in e&&!("source"in e)&&!("target"in e),hS=(e,t=[0,0])=>{const{width:r,height:i}=Vm(e),a=e.origin??t,l=r*a[0],d=i*a[1];return{x:e.position.x-l,y:e.position.y-d}},yYe=(e,t={nodeOrigin:[0,0]})=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const r=e.reduce((i,a)=>{const l=typeof a=="string";let d=!t.nodeLookup&&!l?a:void 0;t.nodeLookup&&(d=l?t.nodeLookup.get(a):P6(a)?a:t.nodeLookup.get(a.id));const s=d?EP(d,t.nodeOrigin):{x:0,y:0,x2:0,y2:0};return GM(i,s)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return HM(r)},mS=(e,t={})=>{if(e.size===0)return{x:0,y:0,width:0,height:0};let r={x:1/0,y:1/0,x2:-1/0,y2:-1/0};return e.forEach(i=>{if(t.filter===void 0||t.filter(i)){const a=EP(i);r=GM(r,a)}}),HM(r)},E6=(e,t,[r,i,a]=[0,0,1],l=!1,d=!1)=>{const s={...fS(t,[r,i,a]),width:t.width/a,height:t.height/a},p=[];for(const x of e.values()){const{measured:w,selectable:j=!0,hidden:S=!1}=x;if(d&&!j||S)continue;const P=w.width??x.width??x.initialWidth??null,F=w.height??x.height??x.initialHeight??null,L=hN(s,Zb(x)),B=(P??0)*(F??0),V=l&&L>0;(!x.internals.handleBounds||V||L>=B||x.dragging)&&p.push(x)}return p},vYe=(e,t)=>{const r=new Set;return e.forEach(i=>{r.add(i.id)}),t.filter(i=>r.has(i.source)||r.has(i.target))};function bYe(e,t){const r=new Map,i=t!=null&&t.nodes?new Set(t.nodes.map(a=>a.id)):null;return e.forEach(a=>{a.measured.width&&a.measured.height&&((t==null?void 0:t.includeHiddenNodes)||!a.hidden)&&(!i||i.has(a.id))&&r.set(a.id,a)}),r}async function _Ye({nodes:e,width:t,height:r,panZoom:i,minZoom:a,maxZoom:l},d){if(e.size===0)return Promise.resolve(!0);const s=bYe(e,d),p=mS(s),x=M6(p,t,r,(d==null?void 0:d.minZoom)??a,(d==null?void 0:d.maxZoom)??l,(d==null?void 0:d.padding)??.1);return await i.setViewport(x,{duration:d==null?void 0:d.duration,ease:d==null?void 0:d.ease,interpolate:d==null?void 0:d.interpolate}),Promise.resolve(!0)}function poe({nodeId:e,nextPosition:t,nodeLookup:r,nodeOrigin:i=[0,0],nodeExtent:a,onError:l}){const d=r.get(e),s=d.parentId?r.get(d.parentId):void 0,{x:p,y:x}=s?s.internals.positionAbsolute:{x:0,y:0},w=d.origin??i;let j=a;if(d.extent==="parent"&&!d.expandParent)if(!s)l==null||l("005",bh.error005());else{const P=s.measured.width,F=s.measured.height;P&&F&&(j=[[p,x],[p+P,x+F]])}else s&&Yb(d.extent)&&(j=[[d.extent[0][0]+p,d.extent[0][1]+x],[d.extent[1][0]+p,d.extent[1][1]+x]]);const S=Yb(j)?ux(t,j,d.measured):t;return(d.measured.width===void 0||d.measured.height===void 0)&&(l==null||l("015",bh.error015())),{position:{x:S.x-p+(d.measured.width??0)*w[0],y:S.y-x+(d.measured.height??0)*w[1]},positionAbsolute:S}}async function wYe({nodesToRemove:e=[],edgesToRemove:t=[],nodes:r,edges:i,onBeforeDelete:a}){const l=new Set(e.map(S=>S.id)),d=[];for(const S of r){if(S.deletable===!1)continue;const P=l.has(S.id),F=!P&&S.parentId&&d.find(L=>L.id===S.parentId);(P||F)&&d.push(S)}const s=new Set(t.map(S=>S.id)),p=i.filter(S=>S.deletable!==!1),w=vYe(d,p);for(const S of p)s.has(S.id)&&!w.find(F=>F.id===S.id)&&w.push(S);if(!a)return{edges:w,nodes:d};const j=await a({nodes:d,edges:w});return typeof j=="boolean"?j?{edges:w,nodes:d}:{edges:[],nodes:[]}:j}const Kb=(e,t=0,r=1)=>Math.min(Math.max(e,t),r),ux=(e={x:0,y:0},t,r)=>({x:Kb(e.x,t[0][0],t[1][0]-((r==null?void 0:r.width)??0)),y:Kb(e.y,t[0][1],t[1][1]-((r==null?void 0:r.height)??0))});function goe(e,t,r){const{width:i,height:a}=Vm(r),{x:l,y:d}=r.internals.positionAbsolute;return ux(e,[[l,d],[l+i,d+a]],t)}const VK=(e,t,r)=>e<t?Kb(Math.abs(e-t),1,t)/t:e>r?-Kb(Math.abs(e-r),1,t)/t:0,xoe=(e,t,r=15,i=40)=>{const a=VK(e.x,i,t.width-i)*r,l=VK(e.y,i,t.height-i)*r;return[a,l]},GM=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),Hz=({x:e,y:t,width:r,height:i})=>({x:e,y:t,x2:e+r,y2:t+i}),HM=({x:e,y:t,x2:r,y2:i})=>({x:e,y:t,width:r-e,height:i-t}),Zb=(e,t=[0,0])=>{var a,l;const{x:r,y:i}=P6(e)?e.internals.positionAbsolute:hS(e,t);return{x:r,y:i,width:((a=e.measured)==null?void 0:a.width)??e.width??e.initialWidth??0,height:((l=e.measured)==null?void 0:l.height)??e.height??e.initialHeight??0}},EP=(e,t=[0,0])=>{var a,l;const{x:r,y:i}=P6(e)?e.internals.positionAbsolute:hS(e,t);return{x:r,y:i,x2:r+(((a=e.measured)==null?void 0:a.width)??e.width??e.initialWidth??0),y2:i+(((l=e.measured)==null?void 0:l.height)??e.height??e.initialHeight??0)}},yoe=(e,t)=>HM(GM(Hz(e),Hz(t))),hN=(e,t)=>{const r=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),i=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(r*i)},UK=e=>md(e.width)&&md(e.height)&&md(e.x)&&md(e.y),md=e=>!isNaN(e)&&isFinite(e),jYe=(e,t)=>{},qM=(e,t=[1,1])=>({x:t[0]*Math.round(e.x/t[0]),y:t[1]*Math.round(e.y/t[1])}),fS=({x:e,y:t},[r,i,a],l=!1,d=[1,1])=>{const s={x:(e-r)/a,y:(t-i)/a};return l?qM(s,d):s},MP=({x:e,y:t},[r,i,a])=>({x:e*a+r,y:t*a+i});function Yy(e,t){if(typeof e=="number")return Math.floor((t-t/(1+e))*.5);if(typeof e=="string"&&e.endsWith("px")){const r=parseFloat(e);if(!Number.isNaN(r))return Math.floor(r)}if(typeof e=="string"&&e.endsWith("%")){const r=parseFloat(e);if(!Number.isNaN(r))return Math.floor(t*r*.01)}return console.error(`[React Flow] The padding value "${e}" is invalid. Please provide a number or a string with a valid unit (px or %).`),0}function NYe(e,t,r){if(typeof e=="string"||typeof e=="number"){const i=Yy(e,r),a=Yy(e,t);return{top:i,right:a,bottom:i,left:a,x:a*2,y:i*2}}if(typeof e=="object"){const i=Yy(e.top??e.y??0,r),a=Yy(e.bottom??e.y??0,r),l=Yy(e.left??e.x??0,t),d=Yy(e.right??e.x??0,t);return{top:i,right:d,bottom:a,left:l,x:l+d,y:i+a}}return{top:0,right:0,bottom:0,left:0,x:0,y:0}}function SYe(e,t,r,i,a,l){const{x:d,y:s}=MP(e,[t,r,i]),{x:p,y:x}=MP({x:e.x+e.width,y:e.y+e.height},[t,r,i]),w=a-p,j=l-x;return{left:Math.floor(d),top:Math.floor(s),right:Math.floor(w),bottom:Math.floor(j)}}const M6=(e,t,r,i,a,l)=>{const d=NYe(l,t,r),s=(t-d.x)/e.width,p=(r-d.y)/e.height,x=Math.min(s,p),w=Kb(x,i,a),j=e.x+e.width/2,S=e.y+e.height/2,P=t/2-j*w,F=r/2-S*w,L=SYe(e,P,F,w,t,r),B={left:Math.min(L.left-d.left,0),top:Math.min(L.top-d.top,0),right:Math.min(L.right-d.right,0),bottom:Math.min(L.bottom-d.bottom,0)};return{x:P-B.left+B.right,y:F-B.top+B.bottom,zoom:w}},IP=()=>{var e;return typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)==null?void 0:e.indexOf("Mac"))>=0};function Yb(e){return e!==void 0&&e!=="parent"}function Vm(e){var t,r;return{width:((t=e.measured)==null?void 0:t.width)??e.width??e.initialWidth??0,height:((r=e.measured)==null?void 0:r.height)??e.height??e.initialHeight??0}}function voe(e){var t,r;return(((t=e.measured)==null?void 0:t.width)??e.width??e.initialWidth)!==void 0&&(((r=e.measured)==null?void 0:r.height)??e.height??e.initialHeight)!==void 0}function boe(e,t={width:0,height:0},r,i,a){const l={...e},d=i.get(r);if(d){const s=d.origin||a;l.x+=d.internals.positionAbsolute.x-(t.width??0)*s[0],l.y+=d.internals.positionAbsolute.y-(t.height??0)*s[1]}return l}function GK(e,t){if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0}function CYe(){let e,t;return{promise:new Promise((i,a)=>{e=i,t=a}),resolve:e,reject:t}}function AYe(e){return{...doe,...e||{}}}function Hj(e,{snapGrid:t=[0,0],snapToGrid:r=!1,transform:i,containerBounds:a}){const{x:l,y:d}=sh(e),s=fS({x:l-((a==null?void 0:a.left)??0),y:d-((a==null?void 0:a.top)??0)},i),{x:p,y:x}=r?qM(s,t):s;return{xSnapped:p,ySnapped:x,...s}}const I6=e=>({width:e.offsetWidth,height:e.offsetHeight}),_oe=e=>{var t;return((t=e==null?void 0:e.getRootNode)==null?void 0:t.call(e))||(window==null?void 0:window.document)},TYe=["INPUT","SELECT","TEXTAREA"];function woe(e){var i,a;const t=((a=(i=e.composedPath)==null?void 0:i.call(e))==null?void 0:a[0])||e.target;return(t==null?void 0:t.nodeType)!==1?!1:TYe.includes(t.nodeName)||t.hasAttribute("contenteditable")||!!t.closest(".nokey")}const joe=e=>"clientX"in e,sh=(e,t)=>{var l,d;const r=joe(e),i=r?e.clientX:(l=e.touches)==null?void 0:l[0].clientX,a=r?e.clientY:(d=e.touches)==null?void 0:d[0].clientY;return{x:i-((t==null?void 0:t.left)??0),y:a-((t==null?void 0:t.top)??0)}},HK=(e,t,r,i,a)=>{const l=t.querySelectorAll(`.${e}`);return!l||!l.length?null:Array.from(l).map(d=>{const s=d.getBoundingClientRect();return{id:d.getAttribute("data-handleid"),type:e,nodeId:a,position:d.getAttribute("data-handlepos"),x:(s.left-r.left)/i,y:(s.top-r.top)/i,...I6(d)}})};function Noe({sourceX:e,sourceY:t,targetX:r,targetY:i,sourceControlX:a,sourceControlY:l,targetControlX:d,targetControlY:s}){const p=e*.125+a*.375+d*.375+r*.125,x=t*.125+l*.375+s*.375+i*.125,w=Math.abs(p-e),j=Math.abs(x-t);return[p,x,w,j]}function nT(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function qK({pos:e,x1:t,y1:r,x2:i,y2:a,c:l}){switch(e){case cn.Left:return[t-nT(t-i,l),r];case cn.Right:return[t+nT(i-t,l),r];case cn.Top:return[t,r-nT(r-a,l)];case cn.Bottom:return[t,r+nT(a-r,l)]}}function O6({sourceX:e,sourceY:t,sourcePosition:r=cn.Bottom,targetX:i,targetY:a,targetPosition:l=cn.Top,curvature:d=.25}){const[s,p]=qK({pos:r,x1:e,y1:t,x2:i,y2:a,c:d}),[x,w]=qK({pos:l,x1:i,y1:a,x2:e,y2:t,c:d}),[j,S,P,F]=Noe({sourceX:e,sourceY:t,targetX:i,targetY:a,sourceControlX:s,sourceControlY:p,targetControlX:x,targetControlY:w});return[`M${e},${t} C${s},${p} ${x},${w} ${i},${a}`,j,S,P,F]}function Soe({sourceX:e,sourceY:t,targetX:r,targetY:i}){const a=Math.abs(r-e)/2,l=r<e?r+a:r-a,d=Math.abs(i-t)/2,s=i<t?i+d:i-d;return[l,s,a,d]}function kYe({sourceNode:e,targetNode:t,selected:r=!1,zIndex:i,elevateOnSelect:a=!1}){if(i!==void 0)return i;const l=a&&r?1e3:0,d=Math.max(e.parentId?e.internals.z:0,t.parentId?t.internals.z:0);return l+d}function PYe({sourceNode:e,targetNode:t,width:r,height:i,transform:a}){const l=GM(EP(e),EP(t));l.x===l.x2&&(l.x2+=1),l.y===l.y2&&(l.y2+=1);const d={x:-a[0]/a[2],y:-a[1]/a[2],width:r/a[2],height:i/a[2]};return hN(d,HM(l))>0}const EYe=({source:e,sourceHandle:t,target:r,targetHandle:i})=>`xy-edge__${e}${t||""}-${r}${i||""}`,MYe=(e,t)=>t.some(r=>r.source===e.source&&r.target===e.target&&(r.sourceHandle===e.sourceHandle||!r.sourceHandle&&!e.sourceHandle)&&(r.targetHandle===e.targetHandle||!r.targetHandle&&!e.targetHandle)),pS=(e,t)=>{if(!e.source||!e.target)return t;let r;return foe(e)?r={...e}:r={...e,id:EYe(e)},MYe(r,t)?t:(r.sourceHandle===null&&delete r.sourceHandle,r.targetHandle===null&&delete r.targetHandle,t.concat(r))};function Coe({sourceX:e,sourceY:t,targetX:r,targetY:i}){const[a,l,d,s]=Soe({sourceX:e,sourceY:t,targetX:r,targetY:i});return[`M ${e},${t}L ${r},${i}`,a,l,d,s]}const WK={[cn.Left]:{x:-1,y:0},[cn.Right]:{x:1,y:0},[cn.Top]:{x:0,y:-1},[cn.Bottom]:{x:0,y:1}},IYe=({source:e,sourcePosition:t=cn.Bottom,target:r})=>t===cn.Left||t===cn.Right?e.x<r.x?{x:1,y:0}:{x:-1,y:0}:e.y<r.y?{x:0,y:1}:{x:0,y:-1},KK=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function OYe({source:e,sourcePosition:t=cn.Bottom,target:r,targetPosition:i=cn.Top,center:a,offset:l}){const d=WK[t],s=WK[i],p={x:e.x+d.x*l,y:e.y+d.y*l},x={x:r.x+s.x*l,y:r.y+s.y*l},w=IYe({source:p,sourcePosition:t,target:x}),j=w.x!==0?"x":"y",S=w[j];let P=[],F,L;const B={x:0,y:0},V={x:0,y:0},[$,G,W,Z]=Soe({sourceX:e.x,sourceY:e.y,targetX:r.x,targetY:r.y});if(d[j]*s[j]===-1){F=a.x??$,L=a.y??G;const ae=[{x:F,y:p.y},{x:F,y:x.y}],ce=[{x:p.x,y:L},{x:x.x,y:L}];d[j]===S?P=j==="x"?ae:ce:P=j==="x"?ce:ae}else{const ae=[{x:p.x,y:x.y}],ce=[{x:x.x,y:p.y}];if(j==="x"?P=d.x===S?ce:ae:P=d.y===S?ae:ce,t===i){const ze=Math.abs(e[j]-r[j]);if(ze<=l){const ye=Math.min(l-1,l-ze);d[j]===S?B[j]=(p[j]>e[j]?-1:1)*ye:V[j]=(x[j]>r[j]?-1:1)*ye}}if(t!==i){const ze=j==="x"?"y":"x",ye=d[j]===s[ze],ve=p[ze]>x[ze],_e=p[ze]<x[ze];(d[j]===1&&(!ye&&ve||ye&&_e)||d[j]!==1&&(!ye&&_e||ye&&ve))&&(P=j==="x"?ae:ce)}const Pe={x:p.x+B.x,y:p.y+B.y},we={x:x.x+V.x,y:x.y+V.y},xe=Math.max(Math.abs(Pe.x-P[0].x),Math.abs(we.x-P[0].x)),Ne=Math.max(Math.abs(Pe.y-P[0].y),Math.abs(we.y-P[0].y));xe>=Ne?(F=(Pe.x+we.x)/2,L=P[0].y):(F=P[0].x,L=(Pe.y+we.y)/2)}return[[e,{x:p.x+B.x,y:p.y+B.y},...P,{x:x.x+V.x,y:x.y+V.y},r],F,L,W,Z]}function RYe(e,t,r,i){const a=Math.min(KK(e,t)/2,KK(t,r)/2,i),{x:l,y:d}=t;if(e.x===l&&l===r.x||e.y===d&&d===r.y)return`L${l} ${d}`;if(e.y===d){const x=e.x<r.x?-1:1,w=e.y<r.y?1:-1;return`L ${l+a*x},${d}Q ${l},${d} ${l},${d+a*w}`}const s=e.x<r.x?1:-1,p=e.y<r.y?-1:1;return`L ${l},${d+a*p}Q ${l},${d} ${l+a*s},${d}`}function qz({sourceX:e,sourceY:t,sourcePosition:r=cn.Bottom,targetX:i,targetY:a,targetPosition:l=cn.Top,borderRadius:d=5,centerX:s,centerY:p,offset:x=20}){const[w,j,S,P,F]=OYe({source:{x:e,y:t},sourcePosition:r,target:{x:i,y:a},targetPosition:l,center:{x:s,y:p},offset:x});return[w.reduce((B,V,$)=>{let G="";return $>0&&$<w.length-1?G=RYe(w[$-1],V,w[$+1],d):G=`${$===0?"M":"L"}${V.x} ${V.y}`,B+=G,B},""),j,S,P,F]}function ZK(e){var t;return e&&!!(e.internals.handleBounds||(t=e.handles)!=null&&t.length)&&!!(e.measured.width||e.width||e.initialWidth)}function DYe(e){var j;const{sourceNode:t,targetNode:r}=e;if(!ZK(t)||!ZK(r))return null;const i=t.internals.handleBounds||YK(t.handles),a=r.internals.handleBounds||YK(r.handles),l=XK((i==null?void 0:i.source)??[],e.sourceHandle),d=XK(e.connectionMode===Wb.Strict?(a==null?void 0:a.target)??[]:((a==null?void 0:a.target)??[]).concat((a==null?void 0:a.source)??[]),e.targetHandle);if(!l||!d)return(j=e.onError)==null||j.call(e,"008",bh.error008(l?"target":"source",{id:e.id,sourceHandle:e.sourceHandle,targetHandle:e.targetHandle})),null;const s=(l==null?void 0:l.position)||cn.Bottom,p=(d==null?void 0:d.position)||cn.Top,x=mN(t,l,s),w=mN(r,d,p);return{sourceX:x.x,sourceY:x.y,targetX:w.x,targetY:w.y,sourcePosition:s,targetPosition:p}}function YK(e){if(!e)return null;const t=[],r=[];for(const i of e)i.width=i.width??1,i.height=i.height??1,i.type==="source"?t.push(i):i.type==="target"&&r.push(i);return{source:t,target:r}}function mN(e,t,r=cn.Left,i=!1){const a=((t==null?void 0:t.x)??0)+e.internals.positionAbsolute.x,l=((t==null?void 0:t.y)??0)+e.internals.positionAbsolute.y,{width:d,height:s}=t??Vm(e);if(i)return{x:a+d/2,y:l+s/2};switch((t==null?void 0:t.position)??r){case cn.Top:return{x:a+d/2,y:l};case cn.Right:return{x:a+d,y:l+s/2};case cn.Bottom:return{x:a+d/2,y:l+s};case cn.Left:return{x:a,y:l+s/2}}}function XK(e,t){return e&&(t?e.find(r=>r.id===t):e[0])||null}function Wz(e,t){return e?typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(i=>`${i}=${e[i]}`).join("&")}`:""}function zYe(e,{id:t,defaultColor:r,defaultMarkerStart:i,defaultMarkerEnd:a}){const l=new Set;return e.reduce((d,s)=>([s.markerStart||i,s.markerEnd||a].forEach(p=>{if(p&&typeof p=="object"){const x=Wz(p,t);l.has(x)||(d.push({id:x,color:p.color||r,...p}),l.add(x))}}),d),[]).sort((d,s)=>d.id.localeCompare(s.id))}const R6={nodeOrigin:[0,0],nodeExtent:uN,elevateNodesOnSelect:!0,defaults:{}},LYe={...R6,checkEquality:!0};function D6(e,t){const r={...e};for(const i in t)t[i]!==void 0&&(r[i]=t[i]);return r}function FYe(e,t,r){const i=D6(R6,r);for(const a of e.values())if(a.parentId)z6(a,e,t,i);else{const l=hS(a,i.nodeOrigin),d=Yb(a.extent)?a.extent:i.nodeExtent,s=ux(l,d,Vm(a));a.internals.positionAbsolute=s}}function Kz(e,t,r,i){var p,x;const a=D6(LYe,i);let l=e.length>0;const d=new Map(t),s=a!=null&&a.elevateNodesOnSelect?1e3:0;t.clear(),r.clear();for(const w of e){let j=d.get(w.id);if(a.checkEquality&&w===(j==null?void 0:j.internals.userNode))t.set(w.id,j);else{const S=hS(w,a.nodeOrigin),P=Yb(w.extent)?w.extent:a.nodeExtent,F=ux(S,P,Vm(w));j={...a.defaults,...w,measured:{width:(p=w.measured)==null?void 0:p.width,height:(x=w.measured)==null?void 0:x.height},internals:{positionAbsolute:F,handleBounds:w.measured?j==null?void 0:j.internals.handleBounds:void 0,z:Aoe(w,s),userNode:w}},t.set(w.id,j)}(j.measured===void 0||j.measured.width===void 0||j.measured.height===void 0)&&!j.hidden&&(l=!1),w.parentId&&z6(j,t,r,i)}return l}function BYe(e,t){if(!e.parentId)return;const r=t.get(e.parentId);r?r.set(e.id,e):t.set(e.parentId,new Map([[e.id,e]]))}function z6(e,t,r,i){const{elevateNodesOnSelect:a,nodeOrigin:l,nodeExtent:d}=D6(R6,i),s=e.parentId,p=t.get(s);if(!p){console.warn(`Parent node ${s} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}BYe(e,r);const x=a?1e3:0,{x:w,y:j,z:S}=$Ye(e,p,l,d,x),{positionAbsolute:P}=e.internals,F=w!==P.x||j!==P.y;(F||S!==e.internals.z)&&t.set(e.id,{...e,internals:{...e.internals,positionAbsolute:F?{x:w,y:j}:P,z:S}})}function Aoe(e,t){return(md(e.zIndex)?e.zIndex:0)+(e.selected?t:0)}function $Ye(e,t,r,i,a){const{x:l,y:d}=t.internals.positionAbsolute,s=Vm(e),p=hS(e,r),x=Yb(e.extent)?ux(p,e.extent,s):p;let w=ux({x:l+x.x,y:d+x.y},i,s);e.extent==="parent"&&(w=goe(w,s,t));const j=Aoe(e,a),S=t.internals.z??0;return{x:w.x,y:w.y,z:S>=j?S+1:j}}function L6(e,t,r,i=[0,0]){var d;const a=[],l=new Map;for(const s of e){const p=t.get(s.parentId);if(!p)continue;const x=((d=l.get(s.parentId))==null?void 0:d.expandedRect)??Zb(p),w=yoe(x,s.rect);l.set(s.parentId,{expandedRect:w,parent:p})}return l.size>0&&l.forEach(({expandedRect:s,parent:p},x)=>{var G;const w=p.internals.positionAbsolute,j=Vm(p),S=p.origin??i,P=s.x<w.x?Math.round(Math.abs(w.x-s.x)):0,F=s.y<w.y?Math.round(Math.abs(w.y-s.y)):0,L=Math.max(j.width,Math.round(s.width)),B=Math.max(j.height,Math.round(s.height)),V=(L-j.width)*S[0],$=(B-j.height)*S[1];(P>0||F>0||V||$)&&(a.push({id:x,type:"position",position:{x:p.position.x-P+V,y:p.position.y-F+$}}),(G=r.get(x))==null||G.forEach(W=>{e.some(Z=>Z.id===W.id)||a.push({id:W.id,type:"position",position:{x:W.position.x+P,y:W.position.y+F}})})),(j.width<s.width||j.height<s.height||P||F)&&a.push({id:x,type:"dimensions",setAttributes:!0,dimensions:{width:L+(P?S[0]*P-V:0),height:B+(F?S[1]*F-$:0)}})}),a}function VYe(e,t,r,i,a,l){const d=i==null?void 0:i.querySelector(".xyflow__viewport");let s=!1;if(!d)return{changes:[],updatedInternals:s};const p=[],x=window.getComputedStyle(d),{m22:w}=new window.DOMMatrixReadOnly(x.transform),j=[];for(const S of e.values()){const P=t.get(S.id);if(!P)continue;if(P.hidden){t.set(P.id,{...P,internals:{...P.internals,handleBounds:void 0}}),s=!0;continue}const F=I6(S.nodeElement),L=P.measured.width!==F.width||P.measured.height!==F.height;if(!!(F.width&&F.height&&(L||!P.internals.handleBounds||S.force))){const V=S.nodeElement.getBoundingClientRect(),$=Yb(P.extent)?P.extent:l;let{positionAbsolute:G}=P.internals;P.parentId&&P.extent==="parent"?G=goe(G,F,t.get(P.parentId)):$&&(G=ux(G,$,F));const W={...P,measured:F,internals:{...P.internals,positionAbsolute:G,handleBounds:{source:HK("source",S.nodeElement,V,w,P.id),target:HK("target",S.nodeElement,V,w,P.id)}}};t.set(P.id,W),P.parentId&&z6(W,t,r,{nodeOrigin:a}),s=!0,L&&(p.push({id:P.id,type:"dimensions",dimensions:F}),P.expandParent&&P.parentId&&j.push({id:P.id,parentId:P.parentId,rect:Zb(W,a)}))}}if(j.length>0){const S=L6(j,t,r,a);p.push(...S)}return{changes:p,updatedInternals:s}}async function UYe({delta:e,panZoom:t,transform:r,translateExtent:i,width:a,height:l}){if(!t||!e.x&&!e.y)return Promise.resolve(!1);const d=await t.setViewportConstrained({x:r[0]+e.x,y:r[1]+e.y,zoom:r[2]},[[0,0],[a,l]],i),s=!!d&&(d.x!==r[0]||d.y!==r[1]||d.k!==r[2]);return Promise.resolve(s)}function JK(e,t,r,i,a,l){let d=a;const s=i.get(d)||new Map;i.set(d,s.set(r,t)),d=`${a}-${e}`;const p=i.get(d)||new Map;if(i.set(d,p.set(r,t)),l){d=`${a}-${e}-${l}`;const x=i.get(d)||new Map;i.set(d,x.set(r,t))}}function Toe(e,t,r){e.clear(),t.clear();for(const i of r){const{source:a,target:l,sourceHandle:d=null,targetHandle:s=null}=i,p={edgeId:i.id,source:a,target:l,sourceHandle:d,targetHandle:s},x=`${a}-${d}--${l}-${s}`,w=`${l}-${s}--${a}-${d}`;JK("source",p,w,e,a,d),JK("target",p,x,e,l,s),t.set(i.id,i)}}function koe(e,t){if(!e.parentId)return!1;const r=t.get(e.parentId);return r?r.selected?!0:koe(r,t):!1}function QK(e,t,r){var a;let i=e;do{if((a=i==null?void 0:i.matches)!=null&&a.call(i,t))return!0;if(i===r)return!1;i=i==null?void 0:i.parentElement}while(i);return!1}function GYe(e,t,r,i){const a=new Map;for(const[l,d]of e)if((d.selected||d.id===i)&&(!d.parentId||!koe(d,e))&&(d.draggable||t&&typeof d.draggable>"u")){const s=e.get(l);s&&a.set(l,{id:l,position:s.position||{x:0,y:0},distance:{x:r.x-s.internals.positionAbsolute.x,y:r.y-s.internals.positionAbsolute.y},extent:s.extent,parentId:s.parentId,origin:s.origin,expandParent:s.expandParent,internals:{positionAbsolute:s.internals.positionAbsolute||{x:0,y:0}},measured:{width:s.measured.width??0,height:s.measured.height??0}})}return a}function eR({nodeId:e,dragItems:t,nodeLookup:r,dragging:i=!0}){var d,s,p;const a=[];for(const[x,w]of t){const j=(d=r.get(x))==null?void 0:d.internals.userNode;j&&a.push({...j,position:w.position,dragging:i})}if(!e)return[a[0],a];const l=(s=r.get(e))==null?void 0:s.internals.userNode;return[l?{...l,position:((p=t.get(e))==null?void 0:p.position)||l.position,dragging:i}:a[0],a]}function HYe({onNodeMouseDown:e,getStoreItems:t,onDragStart:r,onDrag:i,onDragStop:a}){let l={x:null,y:null},d=0,s=new Map,p=!1,x={x:0,y:0},w=null,j=!1,S=null,P=!1,F=!1;function L({noDragClassName:V,handleSelector:$,domNode:G,isSelectable:W,nodeId:Z,nodeClickDistance:se=0}){S=Cc(G);function ae({x:xe,y:Ne},ze){const{nodeLookup:ye,nodeExtent:ve,snapGrid:_e,snapToGrid:Ee,nodeOrigin:je,onNodeDrag:Ce,onSelectionDrag:tt,onError:it,updateNodePositions:mt}=t();l={x:xe,y:Ne};let gt=!1,qt={x:0,y:0,x2:0,y2:0};if(s.size>1&&ve){const yr=mS(s);qt=Hz(yr)}for(const[yr,tr]of s){if(!ye.has(yr))continue;let Ft={x:xe-tr.distance.x,y:Ne-tr.distance.y};Ee&&(Ft=qM(Ft,_e));let er=[[ve[0][0],ve[0][1]],[ve[1][0],ve[1][1]]];if(s.size>1&&ve&&!tr.extent){const{positionAbsolute:sr}=tr.internals,St=sr.x-qt.x+ve[0][0],jr=sr.x+tr.measured.width-qt.x2+ve[1][0],dt=sr.y-qt.y+ve[0][1],Yr=sr.y+tr.measured.height-qt.y2+ve[1][1];er=[[St,dt],[jr,Yr]]}const{position:Dt,positionAbsolute:ge}=poe({nodeId:yr,nextPosition:Ft,nodeLookup:ye,nodeExtent:er,nodeOrigin:je,onError:it});gt=gt||tr.position.x!==Dt.x||tr.position.y!==Dt.y,tr.position=Dt,tr.internals.positionAbsolute=ge}if(F=F||gt,!!gt&&(mt(s,!0),ze&&(i||Ce||!Z&&tt))){const[yr,tr]=eR({nodeId:Z,dragItems:s,nodeLookup:ye});i==null||i(ze,s,yr,tr),Ce==null||Ce(ze,yr,tr),Z||tt==null||tt(ze,tr)}}async function ce(){if(!w)return;const{transform:xe,panBy:Ne,autoPanSpeed:ze,autoPanOnNodeDrag:ye}=t();if(!ye){p=!1,cancelAnimationFrame(d);return}const[ve,_e]=xoe(x,w,ze);(ve!==0||_e!==0)&&(l.x=(l.x??0)-ve/xe[2],l.y=(l.y??0)-_e/xe[2],await Ne({x:ve,y:_e})&&ae(l,null)),d=requestAnimationFrame(ce)}function Pe(xe){var gt;const{nodeLookup:Ne,multiSelectionActive:ze,nodesDraggable:ye,transform:ve,snapGrid:_e,snapToGrid:Ee,selectNodesOnDrag:je,onNodeDragStart:Ce,onSelectionDragStart:tt,unselectNodesAndEdges:it}=t();j=!0,(!je||!W)&&!ze&&Z&&((gt=Ne.get(Z))!=null&&gt.selected||it()),W&&je&&Z&&(e==null||e(Z));const mt=Hj(xe.sourceEvent,{transform:ve,snapGrid:_e,snapToGrid:Ee,containerBounds:w});if(l=mt,s=GYe(Ne,ye,mt,Z),s.size>0&&(r||Ce||!Z&&tt)){const[qt,yr]=eR({nodeId:Z,dragItems:s,nodeLookup:Ne});r==null||r(xe.sourceEvent,s,qt,yr),Ce==null||Ce(xe.sourceEvent,qt,yr),Z||tt==null||tt(xe.sourceEvent,yr)}}const we=eoe().clickDistance(se).on("start",xe=>{const{domNode:Ne,nodeDragThreshold:ze,transform:ye,snapGrid:ve,snapToGrid:_e}=t();w=(Ne==null?void 0:Ne.getBoundingClientRect())||null,P=!1,F=!1,ze===0&&Pe(xe),l=Hj(xe.sourceEvent,{transform:ye,snapGrid:ve,snapToGrid:_e,containerBounds:w}),x=sh(xe.sourceEvent,w)}).on("drag",xe=>{const{autoPanOnNodeDrag:Ne,transform:ze,snapGrid:ye,snapToGrid:ve,nodeDragThreshold:_e,nodeLookup:Ee}=t(),je=Hj(xe.sourceEvent,{transform:ze,snapGrid:ye,snapToGrid:ve,containerBounds:w});if((xe.sourceEvent.type==="touchmove"&&xe.sourceEvent.touches.length>1||Z&&!Ee.has(Z))&&(P=!0),!P){if(!p&&Ne&&j&&(p=!0,ce()),!j){const Ce=je.xSnapped-(l.x??0),tt=je.ySnapped-(l.y??0);Math.sqrt(Ce*Ce+tt*tt)>_e&&Pe(xe)}(l.x!==je.xSnapped||l.y!==je.ySnapped)&&s&&j&&(x=sh(xe.sourceEvent,w),ae(je,xe.sourceEvent))}}).on("end",xe=>{if(!(!j||P)&&(p=!1,j=!1,cancelAnimationFrame(d),s.size>0)){const{nodeLookup:Ne,updateNodePositions:ze,onNodeDragStop:ye,onSelectionDragStop:ve}=t();if(F&&(ze(s,!1),F=!1),a||ye||!Z&&ve){const[_e,Ee]=eR({nodeId:Z,dragItems:s,nodeLookup:Ne,dragging:!1});a==null||a(xe.sourceEvent,s,_e,Ee),ye==null||ye(xe.sourceEvent,_e,Ee),Z||ve==null||ve(xe.sourceEvent,Ee)}}}).filter(xe=>{const Ne=xe.target;return!xe.button&&(!V||!QK(Ne,`.${V}`,G))&&(!$||QK(Ne,$,G))});S.call(we)}function B(){S==null||S.on(".drag",null)}return{update:L,destroy:B}}function qYe(e,t,r){const i=[],a={x:e.x-r,y:e.y-r,width:r*2,height:r*2};for(const l of t.values())hN(a,Zb(l))>0&&i.push(l);return i}const WYe=250;function KYe(e,t,r,i){var s,p;let a=[],l=1/0;const d=qYe(e,r,t+WYe);for(const x of d){const w=[...((s=x.internals.handleBounds)==null?void 0:s.source)??[],...((p=x.internals.handleBounds)==null?void 0:p.target)??[]];for(const j of w){if(i.nodeId===j.nodeId&&i.type===j.type&&i.id===j.id)continue;const{x:S,y:P}=mN(x,j,j.position,!0),F=Math.sqrt(Math.pow(S-e.x,2)+Math.pow(P-e.y,2));F>t||(F<l?(a=[{...j,x:S,y:P}],l=F):F===l&&a.push({...j,x:S,y:P}))}}if(!a.length)return null;if(a.length>1){const x=i.type==="source"?"target":"source";return a.find(w=>w.type===x)??a[0]}return a[0]}function Poe(e,t,r,i,a,l=!1){var x,w,j;const d=i.get(e);if(!d)return null;const s=a==="strict"?(x=d.internals.handleBounds)==null?void 0:x[t]:[...((w=d.internals.handleBounds)==null?void 0:w.source)??[],...((j=d.internals.handleBounds)==null?void 0:j.target)??[]],p=(r?s==null?void 0:s.find(S=>S.id===r):s==null?void 0:s[0])??null;return p&&l?{...p,...mN(d,p,p.position,!0)}:p}function Eoe(e,t){return e||(t!=null&&t.classList.contains("target")?"target":t!=null&&t.classList.contains("source")?"source":null)}function ZYe(e,t){let r=null;return t?r=!0:e&&!t&&(r=!1),r}const Moe=()=>!0;function YYe(e,{connectionMode:t,connectionRadius:r,handleId:i,nodeId:a,edgeUpdaterType:l,isTarget:d,domNode:s,nodeLookup:p,lib:x,autoPanOnConnect:w,flowId:j,panBy:S,cancelConnection:P,onConnectStart:F,onConnect:L,onConnectEnd:B,isValidConnection:V=Moe,onReconnectEnd:$,updateConnection:G,getTransform:W,getFromHandle:Z,autoPanSpeed:se,dragThreshold:ae=1}){const ce=_oe(e.target);let Pe=0,we;const{x:xe,y:Ne}=sh(e),ze=ce==null?void 0:ce.elementFromPoint(xe,Ne),ye=Eoe(l,ze),ve=s==null?void 0:s.getBoundingClientRect();let _e=!1;if(!ve||!ye)return;const Ee=Poe(a,ye,i,p,t);if(!Ee)return;let je=sh(e,ve),Ce=!1,tt=null,it=!1,mt=null;function gt(){if(!w||!ve)return;const[sr,St]=xoe(je,ve,se);S({x:sr,y:St}),Pe=requestAnimationFrame(gt)}const qt={...Ee,nodeId:a,type:ye,position:Ee.position},yr=p.get(a);let Ft={inProgress:!0,isValid:null,from:mN(yr,qt,cn.Left,!0),fromHandle:qt,fromPosition:qt.position,fromNode:yr,to:je,toHandle:null,toPosition:$K[qt.position],toNode:null};function er(){_e=!0,G(Ft),F==null||F(e,{nodeId:a,handleId:i,handleType:ye})}ae===0&&er();function Dt(sr){if(!_e){const{x:Yr,y:Vr}=sh(sr),Yn=Yr-xe,Ye=Vr-Ne;if(!(Yn*Yn+Ye*Ye>ae*ae))return;er()}if(!Z()||!qt){ge(sr);return}const St=W();je=sh(sr,ve),we=KYe(fS(je,St,!1,[1,1]),r,p,qt),Ce||(gt(),Ce=!0);const jr=Ioe(sr,{handle:we,connectionMode:t,fromNodeId:a,fromHandleId:i,fromType:d?"target":"source",isValidConnection:V,doc:ce,lib:x,flowId:j,nodeLookup:p});mt=jr.handleDomNode,tt=jr.connection,it=ZYe(!!we,jr.isValid);const dt={...Ft,isValid:it,to:jr.toHandle&&it?MP({x:jr.toHandle.x,y:jr.toHandle.y},St):je,toHandle:jr.toHandle,toPosition:it&&jr.toHandle?jr.toHandle.position:$K[qt.position],toNode:jr.toHandle?p.get(jr.toHandle.nodeId):null};it&&we&&Ft.toHandle&&dt.toHandle&&Ft.toHandle.type===dt.toHandle.type&&Ft.toHandle.nodeId===dt.toHandle.nodeId&&Ft.toHandle.id===dt.toHandle.id&&Ft.to.x===dt.to.x&&Ft.to.y===dt.to.y||(G(dt),Ft=dt)}function ge(sr){if(_e){(we||mt)&&tt&&it&&(L==null||L(tt));const{inProgress:St,...jr}=Ft,dt={...jr,toPosition:Ft.toHandle?Ft.toPosition:null};B==null||B(sr,dt),l&&($==null||$(sr,dt))}P(),cancelAnimationFrame(Pe),Ce=!1,it=!1,tt=null,mt=null,ce.removeEventListener("mousemove",Dt),ce.removeEventListener("mouseup",ge),ce.removeEventListener("touchmove",Dt),ce.removeEventListener("touchend",ge)}ce.addEventListener("mousemove",Dt),ce.addEventListener("mouseup",ge),ce.addEventListener("touchmove",Dt),ce.addEventListener("touchend",ge)}function Ioe(e,{handle:t,connectionMode:r,fromNodeId:i,fromHandleId:a,fromType:l,doc:d,lib:s,flowId:p,isValidConnection:x=Moe,nodeLookup:w}){const j=l==="target",S=t?d.querySelector(`.${s}-flow__handle[data-id="${p}-${t==null?void 0:t.nodeId}-${t==null?void 0:t.id}-${t==null?void 0:t.type}"]`):null,{x:P,y:F}=sh(e),L=d.elementFromPoint(P,F),B=L!=null&&L.classList.contains(`${s}-flow__handle`)?L:S,V={handleDomNode:B,isValid:!1,connection:null,toHandle:null};if(B){const $=Eoe(void 0,B),G=B.getAttribute("data-nodeid"),W=B.getAttribute("data-handleid"),Z=B.classList.contains("connectable"),se=B.classList.contains("connectableend");if(!G||!$)return V;const ae={source:j?G:i,sourceHandle:j?W:a,target:j?i:G,targetHandle:j?a:W};V.connection=ae;const Pe=Z&&se&&(r===Wb.Strict?j&&$==="source"||!j&&$==="target":G!==i||W!==a);V.isValid=Pe&&x(ae),V.toHandle=Poe(G,$,W,w,r,!0)}return V}const Zz={onPointerDown:YYe,isValid:Ioe};function XYe({domNode:e,panZoom:t,getTransform:r,getViewScale:i}){const a=Cc(e);function l({translateExtent:s,width:p,height:x,zoomStep:w=10,pannable:j=!0,zoomable:S=!0,inversePan:P=!1}){const F=G=>{const W=r();if(G.sourceEvent.type!=="wheel"||!t)return;const Z=-G.sourceEvent.deltaY*(G.sourceEvent.deltaMode===1?.05:G.sourceEvent.deltaMode?1:.002)*w,se=W[2]*Math.pow(2,Z);t.scaleTo(se)};let L=[0,0];const B=G=>{(G.sourceEvent.type==="mousedown"||G.sourceEvent.type==="touchstart")&&(L=[G.sourceEvent.clientX??G.sourceEvent.touches[0].clientX,G.sourceEvent.clientY??G.sourceEvent.touches[0].clientY])},V=G=>{const W=r();if(G.sourceEvent.type!=="mousemove"&&G.sourceEvent.type!=="touchmove"||!t)return;const Z=[G.sourceEvent.clientX??G.sourceEvent.touches[0].clientX,G.sourceEvent.clientY??G.sourceEvent.touches[0].clientY],se=[Z[0]-L[0],Z[1]-L[1]];L=Z;const ae=i()*Math.max(W[2],Math.log(W[2]))*(P?-1:1),ce={x:W[0]-se[0]*ae,y:W[1]-se[1]*ae},Pe=[[0,0],[p,x]];t.setViewportConstrained({x:ce.x,y:ce.y,zoom:W[2]},Pe,s)},$=coe().on("start",B).on("zoom",j?V:null).on("zoom.wheel",S?F:null);a.call($,{})}function d(){a.on("zoom",null)}return{update:l,destroy:d,pointer:od}}const JYe=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,WM=e=>({x:e.x,y:e.y,zoom:e.k}),tR=({x:e,y:t,zoom:r})=>UM.translate(e,t).scale(r),Sv=(e,t)=>e.target.closest(`.${t}`),Ooe=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),QYe=e=>((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2,rR=(e,t=0,r=QYe,i=()=>{})=>{const a=typeof t=="number"&&t>0;return a||i(),a?e.transition().duration(t).ease(r).on("end",i):e},Roe=e=>{const t=e.ctrlKey&&IP()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t};function eXe({zoomPanValues:e,noWheelClassName:t,d3Selection:r,d3Zoom:i,panOnScrollMode:a,panOnScrollSpeed:l,zoomOnPinch:d,onPanZoomStart:s,onPanZoom:p,onPanZoomEnd:x}){return w=>{if(Sv(w,t))return!1;w.preventDefault(),w.stopImmediatePropagation();const j=r.property("__zoom").k||1;if(w.ctrlKey&&d){const B=od(w),V=Roe(w),$=j*Math.pow(2,V);i.scaleTo(r,$,B,w);return}const S=w.deltaMode===1?20:1;let P=a===H0.Vertical?0:w.deltaX*S,F=a===H0.Horizontal?0:w.deltaY*S;!IP()&&w.shiftKey&&a!==H0.Vertical&&(P=w.deltaY*S,F=0),i.translateBy(r,-(P/j)*l,-(F/j)*l,{internal:!0});const L=WM(r.property("__zoom"));clearTimeout(e.panScrollTimeout),e.isPanScrolling||(e.isPanScrolling=!0,s==null||s(w,L)),e.isPanScrolling&&(p==null||p(w,L),e.panScrollTimeout=setTimeout(()=>{x==null||x(w,L),e.isPanScrolling=!1},150))}}function tXe({noWheelClassName:e,preventScrolling:t,d3ZoomHandler:r}){return function(i,a){const l=i.type==="wheel",d=!t&&l&&!i.ctrlKey,s=Sv(i,e);if(i.ctrlKey&&l&&s&&i.preventDefault(),d||s)return null;i.preventDefault(),r.call(this,i,a)}}function rXe({zoomPanValues:e,onDraggingChange:t,onPanZoomStart:r}){return i=>{var l,d,s;if((l=i.sourceEvent)!=null&&l.internal)return;const a=WM(i.transform);e.mouseButton=((d=i.sourceEvent)==null?void 0:d.button)||0,e.isZoomingOrPanning=!0,e.prevViewport=a,((s=i.sourceEvent)==null?void 0:s.type)==="mousedown"&&t(!0),r&&(r==null||r(i.sourceEvent,a))}}function nXe({zoomPanValues:e,panOnDrag:t,onPaneContextMenu:r,onTransformChange:i,onPanZoom:a}){return l=>{var d,s;e.usedRightMouseButton=!!(r&&Ooe(t,e.mouseButton??0)),(d=l.sourceEvent)!=null&&d.sync||i([l.transform.x,l.transform.y,l.transform.k]),a&&!((s=l.sourceEvent)!=null&&s.internal)&&(a==null||a(l.sourceEvent,WM(l.transform)))}}function iXe({zoomPanValues:e,panOnDrag:t,panOnScroll:r,onDraggingChange:i,onPanZoomEnd:a,onPaneContextMenu:l}){return d=>{var s;if(!((s=d.sourceEvent)!=null&&s.internal)&&(e.isZoomingOrPanning=!1,l&&Ooe(t,e.mouseButton??0)&&!e.usedRightMouseButton&&d.sourceEvent&&l(d.sourceEvent),e.usedRightMouseButton=!1,i(!1),a&&JYe(e.prevViewport,d.transform))){const p=WM(d.transform);e.prevViewport=p,clearTimeout(e.timerId),e.timerId=setTimeout(()=>{a==null||a(d.sourceEvent,p)},r?150:0)}}}function sXe({zoomActivationKeyPressed:e,zoomOnScroll:t,zoomOnPinch:r,panOnDrag:i,panOnScroll:a,zoomOnDoubleClick:l,userSelectionActive:d,noWheelClassName:s,noPanClassName:p,lib:x}){return w=>{var F;const j=e||t,S=r&&w.ctrlKey;if(w.button===1&&w.type==="mousedown"&&(Sv(w,`${x}-flow__node`)||Sv(w,`${x}-flow__edge`)))return!0;if(!i&&!j&&!a&&!l&&!r||d||Sv(w,s)&&w.type==="wheel"||Sv(w,p)&&(w.type!=="wheel"||a&&w.type==="wheel"&&!e)||!r&&w.ctrlKey&&w.type==="wheel")return!1;if(!r&&w.type==="touchstart"&&((F=w.touches)==null?void 0:F.length)>1)return w.preventDefault(),!1;if(!j&&!a&&!S&&w.type==="wheel"||!i&&(w.type==="mousedown"||w.type==="touchstart")||Array.isArray(i)&&!i.includes(w.button)&&w.type==="mousedown")return!1;const P=Array.isArray(i)&&i.includes(w.button)||!w.button||w.button<=1;return(!w.ctrlKey||w.type==="wheel")&&P}}function aXe({domNode:e,minZoom:t,maxZoom:r,paneClickDistance:i,translateExtent:a,viewport:l,onPanZoom:d,onPanZoomStart:s,onPanZoomEnd:p,onDraggingChange:x}){const w={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{x:0,y:0,zoom:0},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},j=e.getBoundingClientRect(),S=coe().clickDistance(!md(i)||i<0?0:i).scaleExtent([t,r]).translateExtent(a),P=Cc(e).call(S);G({x:l.x,y:l.y,zoom:Kb(l.zoom,t,r)},[[0,0],[j.width,j.height]],a);const F=P.on("wheel.zoom"),L=P.on("dblclick.zoom");S.wheelDelta(Roe);function B(Ne,ze){return P?new Promise(ye=>{S==null||S.interpolate((ze==null?void 0:ze.interpolate)==="linear"?jm:PT).transform(rR(P,ze==null?void 0:ze.duration,ze==null?void 0:ze.ease,()=>ye(!0)),Ne)}):Promise.resolve(!1)}function V({noWheelClassName:Ne,noPanClassName:ze,onPaneContextMenu:ye,userSelectionActive:ve,panOnScroll:_e,panOnDrag:Ee,panOnScrollMode:je,panOnScrollSpeed:Ce,preventScrolling:tt,zoomOnPinch:it,zoomOnScroll:mt,zoomOnDoubleClick:gt,zoomActivationKeyPressed:qt,lib:yr,onTransformChange:tr}){ve&&!w.isZoomingOrPanning&&$();const er=_e&&!qt&&!ve?eXe({zoomPanValues:w,noWheelClassName:Ne,d3Selection:P,d3Zoom:S,panOnScrollMode:je,panOnScrollSpeed:Ce,zoomOnPinch:it,onPanZoomStart:s,onPanZoom:d,onPanZoomEnd:p}):tXe({noWheelClassName:Ne,preventScrolling:tt,d3ZoomHandler:F});if(P.on("wheel.zoom",er,{passive:!1}),!ve){const ge=rXe({zoomPanValues:w,onDraggingChange:x,onPanZoomStart:s});S.on("start",ge);const sr=nXe({zoomPanValues:w,panOnDrag:Ee,onPaneContextMenu:!!ye,onPanZoom:d,onTransformChange:tr});S.on("zoom",sr);const St=iXe({zoomPanValues:w,panOnDrag:Ee,panOnScroll:_e,onPaneContextMenu:ye,onPanZoomEnd:p,onDraggingChange:x});S.on("end",St)}const Dt=sXe({zoomActivationKeyPressed:qt,panOnDrag:Ee,zoomOnScroll:mt,panOnScroll:_e,zoomOnDoubleClick:gt,zoomOnPinch:it,userSelectionActive:ve,noPanClassName:ze,noWheelClassName:Ne,lib:yr});S.filter(Dt),gt?P.on("dblclick.zoom",L):P.on("dblclick.zoom",null)}function $(){S.on("zoom",null)}async function G(Ne,ze,ye){const ve=tR(Ne),_e=S==null?void 0:S.constrain()(ve,ze,ye);return _e&&await B(_e),new Promise(Ee=>Ee(_e))}async function W(Ne,ze){const ye=tR(Ne);return await B(ye,ze),new Promise(ve=>ve(ye))}function Z(Ne){if(P){const ze=tR(Ne),ye=P.property("__zoom");(ye.k!==Ne.zoom||ye.x!==Ne.x||ye.y!==Ne.y)&&(S==null||S.transform(P,ze,null,{sync:!0}))}}function se(){const Ne=P?loe(P.node()):{x:0,y:0,k:1};return{x:Ne.x,y:Ne.y,zoom:Ne.k}}function ae(Ne,ze){return P?new Promise(ye=>{S==null||S.interpolate((ze==null?void 0:ze.interpolate)==="linear"?jm:PT).scaleTo(rR(P,ze==null?void 0:ze.duration,ze==null?void 0:ze.ease,()=>ye(!0)),Ne)}):Promise.resolve(!1)}function ce(Ne,ze){return P?new Promise(ye=>{S==null||S.interpolate((ze==null?void 0:ze.interpolate)==="linear"?jm:PT).scaleBy(rR(P,ze==null?void 0:ze.duration,ze==null?void 0:ze.ease,()=>ye(!0)),Ne)}):Promise.resolve(!1)}function Pe(Ne){S==null||S.scaleExtent(Ne)}function we(Ne){S==null||S.translateExtent(Ne)}function xe(Ne){const ze=!md(Ne)||Ne<0?0:Ne;S==null||S.clickDistance(ze)}return{update:V,destroy:$,setViewport:W,setViewportConstrained:G,getViewport:se,scaleTo:ae,scaleBy:ce,setScaleExtent:Pe,setTranslateExtent:we,syncViewport:Z,setClickDistance:xe}}var Xb;(function(e){e.Line="line",e.Handle="handle"})(Xb||(Xb={}));function oXe({width:e,prevWidth:t,height:r,prevHeight:i,affectsX:a,affectsY:l}){const d=e-t,s=r-i,p=[d>0?1:d<0?-1:0,s>0?1:s<0?-1:0];return d&&a&&(p[0]=p[0]*-1),s&&l&&(p[1]=p[1]*-1),p}function lXe(e){const t=e.includes("right")||e.includes("left"),r=e.includes("bottom")||e.includes("top"),i=e.includes("left"),a=e.includes("top");return{isHorizontal:t,isVertical:r,affectsX:i,affectsY:a}}function Hf(e,t){return Math.max(0,t-e)}function qf(e,t){return Math.max(0,e-t)}function iT(e,t,r){return Math.max(0,t-e,e-r)}function eZ(e,t){return e?!t:t}function cXe(e,t,r,i,a,l,d,s){let{affectsX:p,affectsY:x}=t;const{isHorizontal:w,isVertical:j}=t,S=w&&j,{xSnapped:P,ySnapped:F}=r,{minWidth:L,maxWidth:B,minHeight:V,maxHeight:$}=i,{x:G,y:W,width:Z,height:se,aspectRatio:ae}=e;let ce=Math.floor(w?P-e.pointerX:0),Pe=Math.floor(j?F-e.pointerY:0);const we=Z+(p?-ce:ce),xe=se+(x?-Pe:Pe),Ne=-l[0]*Z,ze=-l[1]*se;let ye=iT(we,L,B),ve=iT(xe,V,$);if(d){let je=0,Ce=0;p&&ce<0?je=Hf(G+ce+Ne,d[0][0]):!p&&ce>0&&(je=qf(G+we+Ne,d[1][0])),x&&Pe<0?Ce=Hf(W+Pe+ze,d[0][1]):!x&&Pe>0&&(Ce=qf(W+xe+ze,d[1][1])),ye=Math.max(ye,je),ve=Math.max(ve,Ce)}if(s){let je=0,Ce=0;p&&ce>0?je=qf(G+ce,s[0][0]):!p&&ce<0&&(je=Hf(G+we,s[1][0])),x&&Pe>0?Ce=qf(W+Pe,s[0][1]):!x&&Pe<0&&(Ce=Hf(W+xe,s[1][1])),ye=Math.max(ye,je),ve=Math.max(ve,Ce)}if(a){if(w){const je=iT(we/ae,V,$)*ae;if(ye=Math.max(ye,je),d){let Ce=0;!p&&!x||p&&!x&&S?Ce=qf(W+ze+we/ae,d[1][1])*ae:Ce=Hf(W+ze+(p?ce:-ce)/ae,d[0][1])*ae,ye=Math.max(ye,Ce)}if(s){let Ce=0;!p&&!x||p&&!x&&S?Ce=Hf(W+we/ae,s[1][1])*ae:Ce=qf(W+(p?ce:-ce)/ae,s[0][1])*ae,ye=Math.max(ye,Ce)}}if(j){const je=iT(xe*ae,L,B)/ae;if(ve=Math.max(ve,je),d){let Ce=0;!p&&!x||x&&!p&&S?Ce=qf(G+xe*ae+Ne,d[1][0])/ae:Ce=Hf(G+(x?Pe:-Pe)*ae+Ne,d[0][0])/ae,ve=Math.max(ve,Ce)}if(s){let Ce=0;!p&&!x||x&&!p&&S?Ce=Hf(G+xe*ae,s[1][0])/ae:Ce=qf(G+(x?Pe:-Pe)*ae,s[0][0])/ae,ve=Math.max(ve,Ce)}}}Pe=Pe+(Pe<0?ve:-ve),ce=ce+(ce<0?ye:-ye),a&&(S?we>xe*ae?Pe=(eZ(p,x)?-ce:ce)/ae:ce=(eZ(p,x)?-Pe:Pe)*ae:w?(Pe=ce/ae,x=p):(ce=Pe*ae,p=x));const _e=p?G+ce:G,Ee=x?W+Pe:W;return{width:Z+(p?-ce:ce),height:se+(x?-Pe:Pe),x:l[0]*ce*(p?-1:1)+_e,y:l[1]*Pe*(x?-1:1)+Ee}}const Doe={width:0,height:0,x:0,y:0},uXe={...Doe,pointerX:0,pointerY:0,aspectRatio:1};function dXe(e){return[[0,0],[e.measured.width,e.measured.height]]}function hXe(e,t,r){const i=t.position.x+e.position.x,a=t.position.y+e.position.y,l=e.measured.width??0,d=e.measured.height??0,s=r[0]*l,p=r[1]*d;return[[i-s,a-p],[i+l-s,a+d-p]]}function mXe({domNode:e,nodeId:t,getStoreItems:r,onChange:i,onEnd:a}){const l=Cc(e);function d({controlPosition:p,boundaries:x,keepAspectRatio:w,resizeDirection:j,onResizeStart:S,onResize:P,onResizeEnd:F,shouldResize:L}){let B={...Doe},V={...uXe};const $=lXe(p);let G,W=null,Z=[],se,ae,ce;const Pe=eoe().on("start",we=>{const{nodeLookup:xe,transform:Ne,snapGrid:ze,snapToGrid:ye,nodeOrigin:ve,paneDomNode:_e}=r();if(G=xe.get(t),!G)return;W=(_e==null?void 0:_e.getBoundingClientRect())??null;const{xSnapped:Ee,ySnapped:je}=Hj(we.sourceEvent,{transform:Ne,snapGrid:ze,snapToGrid:ye,containerBounds:W});B={width:G.measured.width??0,height:G.measured.height??0,x:G.position.x??0,y:G.position.y??0},V={...B,pointerX:Ee,pointerY:je,aspectRatio:B.width/B.height},se=void 0,G.parentId&&(G.extent==="parent"||G.expandParent)&&(se=xe.get(G.parentId),ae=se&&G.extent==="parent"?dXe(se):void 0),Z=[],ce=void 0;for(const[Ce,tt]of xe)if(tt.parentId===t&&(Z.push({id:Ce,position:{...tt.position},extent:tt.extent}),tt.extent==="parent"||tt.expandParent)){const it=hXe(tt,G,tt.origin??ve);ce?ce=[[Math.min(it[0][0],ce[0][0]),Math.min(it[0][1],ce[0][1])],[Math.max(it[1][0],ce[1][0]),Math.max(it[1][1],ce[1][1])]]:ce=it}S==null||S(we,{...B})}).on("drag",we=>{const{transform:xe,snapGrid:Ne,snapToGrid:ze,nodeOrigin:ye}=r(),ve=Hj(we.sourceEvent,{transform:xe,snapGrid:Ne,snapToGrid:ze,containerBounds:W}),_e=[];if(!G)return;const{x:Ee,y:je,width:Ce,height:tt}=B,it={},mt=G.origin??ye,{width:gt,height:qt,x:yr,y:tr}=cXe(V,$,ve,x,w,mt,ae,ce),Ft=gt!==Ce,er=qt!==tt,Dt=yr!==Ee&&Ft,ge=tr!==je&&er;if(!Dt&&!ge&&!Ft&&!er)return;if((Dt||ge||mt[0]===1||mt[1]===1)&&(it.x=Dt?yr:B.x,it.y=ge?tr:B.y,B.x=it.x,B.y=it.y,Z.length>0)){const dt=yr-Ee,Yr=tr-je;for(const Vr of Z)Vr.position={x:Vr.position.x-dt+mt[0]*(gt-Ce),y:Vr.position.y-Yr+mt[1]*(qt-tt)},_e.push(Vr)}if((Ft||er)&&(it.width=Ft&&(!j||j==="horizontal")?gt:B.width,it.height=er&&(!j||j==="vertical")?qt:B.height,B.width=it.width,B.height=it.height),se&&G.expandParent){const dt=mt[0]*(it.width??0);it.x&&it.x<dt&&(B.x=dt,V.x=V.x-(it.x-dt));const Yr=mt[1]*(it.height??0);it.y&&it.y<Yr&&(B.y=Yr,V.y=V.y-(it.y-Yr))}const sr=oXe({width:B.width,prevWidth:Ce,height:B.height,prevHeight:tt,affectsX:$.affectsX,affectsY:$.affectsY}),St={...B,direction:sr};(L==null?void 0:L(we,St))!==!1&&(P==null||P(we,St),i(it,_e))}).on("end",we=>{F==null||F(we,{...B}),a==null||a({...B})});l.call(Pe)}function s(){l.on(".drag",null)}return{update:d,destroy:s}}var zoe={exports:{}},Loe={},Foe={exports:{}},Boe={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Jb=U;function fXe(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var pXe=typeof Object.is=="function"?Object.is:fXe,gXe=Jb.useState,xXe=Jb.useEffect,yXe=Jb.useLayoutEffect,vXe=Jb.useDebugValue;function bXe(e,t){var r=t(),i=gXe({inst:{value:r,getSnapshot:t}}),a=i[0].inst,l=i[1];return yXe(function(){a.value=r,a.getSnapshot=t,nR(a)&&l({inst:a})},[e,r,t]),xXe(function(){return nR(a)&&l({inst:a}),e(function(){nR(a)&&l({inst:a})})},[e]),vXe(r),r}function nR(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!pXe(e,r)}catch{return!0}}function _Xe(e,t){return t()}var wXe=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?_Xe:bXe;Boe.useSyncExternalStore=Jb.useSyncExternalStore!==void 0?Jb.useSyncExternalStore:wXe;Foe.exports=Boe;var jXe=Foe.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var KM=U,NXe=jXe;function SXe(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var CXe=typeof Object.is=="function"?Object.is:SXe,AXe=NXe.useSyncExternalStore,TXe=KM.useRef,kXe=KM.useEffect,PXe=KM.useMemo,EXe=KM.useDebugValue;Loe.useSyncExternalStoreWithSelector=function(e,t,r,i,a){var l=TXe(null);if(l.current===null){var d={hasValue:!1,value:null};l.current=d}else d=l.current;l=PXe(function(){function p(P){if(!x){if(x=!0,w=P,P=i(P),a!==void 0&&d.hasValue){var F=d.value;if(a(F,P))return j=F}return j=P}if(F=j,CXe(w,P))return F;var L=i(P);return a!==void 0&&a(F,L)?(w=P,F):(w=P,j=L)}var x=!1,w,j,S=r===void 0?null:r;return[function(){return p(t())},S===null?void 0:function(){return p(S())}]},[t,r,i,a]);var s=AXe(e,l[0],l[1]);return kXe(function(){d.hasValue=!0,d.value=s},[s]),EXe(s),s};zoe.exports=Loe;var MXe=zoe.exports;const IXe=Vi(MXe),OXe={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1},tZ=e=>{let t;const r=new Set,i=(w,j)=>{const S=typeof w=="function"?w(t):w;if(!Object.is(S,t)){const P=t;t=j??(typeof S!="object"||S===null)?S:Object.assign({},t,S),r.forEach(F=>F(t,P))}},a=()=>t,p={setState:i,getState:a,getInitialState:()=>x,subscribe:w=>(r.add(w),()=>r.delete(w)),destroy:()=>{(OXe?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},x=t=e(i,a,p);return p},RXe=e=>e?tZ(e):tZ,{useDebugValue:DXe}=ke,{useSyncExternalStoreWithSelector:zXe}=IXe,LXe=e=>e;function $oe(e,t=LXe,r){const i=zXe(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,r);return DXe(i),i}const rZ=(e,t)=>{const r=RXe(e),i=(a,l=t)=>$oe(r,a,l);return Object.assign(i,r),i},FXe=(e,t)=>e?rZ(e,t):rZ;function aa(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[i,a]of e)if(!Object.is(a,t.get(i)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const i of e)if(!t.has(i))return!1;return!0}const r=Object.keys(e);if(r.length!==Object.keys(t).length)return!1;for(const i of r)if(!Object.prototype.hasOwnProperty.call(t,i)||!Object.is(e[i],t[i]))return!1;return!0}const ZM=U.createContext(null),BXe=ZM.Provider,Voe=bh.error001();function Si(e,t){const r=U.useContext(ZM);if(r===null)throw new Error(Voe);return $oe(r,e,t)}function Ys(){const e=U.useContext(ZM);if(e===null)throw new Error(Voe);return U.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe}),[e])}const nZ={display:"none"},$Xe={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},Uoe="react-flow__node-desc",Goe="react-flow__edge-desc",VXe="react-flow__aria-live",UXe=e=>e.ariaLiveMessage,GXe=e=>e.ariaLabelConfig;function HXe({rfId:e}){const t=Si(UXe);return n.jsx("div",{id:`${VXe}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:$Xe,children:t})}function qXe({rfId:e,disableKeyboardA11y:t}){const r=Si(GXe);return n.jsxs(n.Fragment,{children:[n.jsx("div",{id:`${Uoe}-${e}`,style:nZ,children:t?r["node.a11yDescription.default"]:r["node.a11yDescription.keyboardDisabled"]}),n.jsx("div",{id:`${Goe}-${e}`,style:nZ,children:r["edge.a11yDescription.default"]}),!t&&n.jsx(HXe,{rfId:e})]})}const YM=U.forwardRef(({position:e="top-left",children:t,className:r,style:i,...a},l)=>{const d=`${e}`.split("-");return n.jsx("div",{className:Va(["react-flow__panel",r,...d]),style:i,ref:l,...a,children:t})});YM.displayName="Panel";function WXe({proOptions:e,position:t="bottom-right"}){return e!=null&&e.hideAttribution?null:n.jsx(YM,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:n.jsx("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}const KXe=e=>{const t=[],r=[];for(const[,i]of e.nodeLookup)i.selected&&t.push(i.internals.userNode);for(const[,i]of e.edgeLookup)i.selected&&r.push(i);return{selectedNodes:t,selectedEdges:r}},sT=e=>e.id;function ZXe(e,t){return aa(e.selectedNodes.map(sT),t.selectedNodes.map(sT))&&aa(e.selectedEdges.map(sT),t.selectedEdges.map(sT))}function YXe({onSelectionChange:e}){const t=Ys(),{selectedNodes:r,selectedEdges:i}=Si(KXe,ZXe);return U.useEffect(()=>{const a={nodes:r,edges:i};e==null||e(a),t.getState().onSelectionChangeHandlers.forEach(l=>l(a))},[r,i,e]),null}const XXe=e=>!!e.onSelectionChangeHandlers;function JXe({onSelectionChange:e}){const t=Si(XXe);return e||t?n.jsx(YXe,{onSelectionChange:e}):null}const Hoe=[0,0],QXe={x:0,y:0,zoom:1},eJe=["nodes","edges","defaultNodes","defaultEdges","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","nodesDraggable","autoPanOnNodeFocus","nodesConnectable","nodesFocusable","edgesFocusable","edgesReconnectable","elevateNodesOnSelect","elevateEdgesOnSelect","minZoom","maxZoom","nodeExtent","onNodesChange","onEdgesChange","elementsSelectable","connectionMode","snapGrid","snapToGrid","translateExtent","connectOnClick","defaultEdgeOptions","fitView","fitViewOptions","onNodesDelete","onEdgesDelete","onDelete","onNodeDrag","onNodeDragStart","onNodeDragStop","onSelectionDrag","onSelectionDragStart","onSelectionDragStop","onMoveStart","onMove","onMoveEnd","noPanClassName","nodeOrigin","autoPanOnConnect","autoPanOnNodeDrag","onError","connectionRadius","isValidConnection","selectNodesOnDrag","nodeDragThreshold","connectionDragThreshold","onBeforeDelete","debug","autoPanSpeed","paneClickDistance","ariaLabelConfig"],iZ=[...eJe,"rfId"],tJe=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setPaneClickDistance:e.setPaneClickDistance}),sZ={translateExtent:uN,nodeOrigin:Hoe,minZoom:.5,maxZoom:2,elementsSelectable:!0,noPanClassName:"nopan",rfId:"1",paneClickDistance:0};function rJe(e){const{setNodes:t,setEdges:r,setMinZoom:i,setMaxZoom:a,setTranslateExtent:l,setNodeExtent:d,reset:s,setDefaultNodesAndEdges:p,setPaneClickDistance:x}=Si(tJe,aa),w=Ys();U.useEffect(()=>(p(e.defaultNodes,e.defaultEdges),()=>{j.current=sZ,s()}),[]);const j=U.useRef(sZ);return U.useEffect(()=>{for(const S of iZ){const P=e[S],F=j.current[S];P!==F&&(typeof e[S]>"u"||(S==="nodes"?t(P):S==="edges"?r(P):S==="minZoom"?i(P):S==="maxZoom"?a(P):S==="translateExtent"?l(P):S==="nodeExtent"?d(P):S==="paneClickDistance"?x(P):S==="ariaLabelConfig"?w.setState({ariaLabelConfig:AYe(P)}):S==="fitView"?w.setState({fitViewQueued:P}):S==="fitViewOptions"?w.setState({fitViewOptions:P}):w.setState({[S]:P})))}j.current=e},iZ.map(S=>e[S])),null}function aZ(){return typeof window>"u"||!window.matchMedia?null:window.matchMedia("(prefers-color-scheme: dark)")}function nJe(e){var i;const[t,r]=U.useState(e==="system"?null:e);return U.useEffect(()=>{if(e!=="system"){r(e);return}const a=aZ(),l=()=>r(a!=null&&a.matches?"dark":"light");return l(),a==null||a.addEventListener("change",l),()=>{a==null||a.removeEventListener("change",l)}},[e]),t!==null?t:(i=aZ())!=null&&i.matches?"dark":"light"}const oZ=typeof document<"u"?document:null;function fN(e=null,t={target:oZ,actInsideInputWithModifier:!0}){const[r,i]=U.useState(!1),a=U.useRef(!1),l=U.useRef(new Set([])),[d,s]=U.useMemo(()=>{if(e!==null){const x=(Array.isArray(e)?e:[e]).filter(j=>typeof j=="string").map(j=>j.replace("+",`
`).replace(`

`,`
+`).split(`
`)),w=x.reduce((j,S)=>j.concat(...S),[]);return[x,w]}return[[],[]]},[e]);return U.useEffect(()=>{const p=(t==null?void 0:t.target)??oZ,x=(t==null?void 0:t.actInsideInputWithModifier)??!0;if(e!==null){const w=P=>{var B,V;if(a.current=P.ctrlKey||P.metaKey||P.shiftKey||P.altKey,(!a.current||a.current&&!x)&&woe(P))return!1;const L=cZ(P.code,s);if(l.current.add(P[L]),lZ(d,l.current,!1)){const $=((V=(B=P.composedPath)==null?void 0:B.call(P))==null?void 0:V[0])||P.target,G=($==null?void 0:$.nodeName)==="BUTTON"||($==null?void 0:$.nodeName)==="A";t.preventDefault!==!1&&(a.current||!G)&&P.preventDefault(),i(!0)}},j=P=>{const F=cZ(P.code,s);lZ(d,l.current,!0)?(i(!1),l.current.clear()):l.current.delete(P[F]),P.key==="Meta"&&l.current.clear(),a.current=!1},S=()=>{l.current.clear(),i(!1)};return p==null||p.addEventListener("keydown",w),p==null||p.addEventListener("keyup",j),window.addEventListener("blur",S),window.addEventListener("contextmenu",S),()=>{p==null||p.removeEventListener("keydown",w),p==null||p.removeEventListener("keyup",j),window.removeEventListener("blur",S),window.removeEventListener("contextmenu",S)}}},[e,i]),r}function lZ(e,t,r){return e.filter(i=>r||i.length===t.size).some(i=>i.every(a=>t.has(a)))}function cZ(e,t){return t.includes(e)?"code":"key"}const iJe=()=>{const e=Ys();return U.useMemo(()=>({zoomIn:t=>{const{panZoom:r}=e.getState();return r?r.scaleBy(1.2,{duration:t==null?void 0:t.duration}):Promise.resolve(!1)},zoomOut:t=>{const{panZoom:r}=e.getState();return r?r.scaleBy(1/1.2,{duration:t==null?void 0:t.duration}):Promise.resolve(!1)},zoomTo:(t,r)=>{const{panZoom:i}=e.getState();return i?i.scaleTo(t,{duration:r==null?void 0:r.duration}):Promise.resolve(!1)},getZoom:()=>e.getState().transform[2],setViewport:async(t,r)=>{const{transform:[i,a,l],panZoom:d}=e.getState();return d?(await d.setViewport({x:t.x??i,y:t.y??a,zoom:t.zoom??l},r),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>{const[t,r,i]=e.getState().transform;return{x:t,y:r,zoom:i}},setCenter:async(t,r,i)=>e.getState().setCenter(t,r,i),fitBounds:async(t,r)=>{const{width:i,height:a,minZoom:l,maxZoom:d,panZoom:s}=e.getState(),p=M6(t,i,a,l,d,(r==null?void 0:r.padding)??.1);return s?(await s.setViewport(p,{duration:r==null?void 0:r.duration,ease:r==null?void 0:r.ease,interpolate:r==null?void 0:r.interpolate}),Promise.resolve(!0)):Promise.resolve(!1)},screenToFlowPosition:(t,r={})=>{const{transform:i,snapGrid:a,snapToGrid:l,domNode:d}=e.getState();if(!d)return t;const{x:s,y:p}=d.getBoundingClientRect(),x={x:t.x-s,y:t.y-p},w=r.snapGrid??a,j=r.snapToGrid??l;return fS(x,i,j,w)},flowToScreenPosition:t=>{const{transform:r,domNode:i}=e.getState();if(!i)return t;const{x:a,y:l}=i.getBoundingClientRect(),d=MP(t,r);return{x:d.x+a,y:d.y+l}}}),[])};function qoe(e,t){const r=[],i=new Map,a=[];for(const l of e)if(l.type==="add"){a.push(l);continue}else if(l.type==="remove"||l.type==="replace")i.set(l.id,[l]);else{const d=i.get(l.id);d?d.push(l):i.set(l.id,[l])}for(const l of t){const d=i.get(l.id);if(!d){r.push(l);continue}if(d[0].type==="remove")continue;if(d[0].type==="replace"){r.push({...d[0].item});continue}const s={...l};for(const p of d)sJe(p,s);r.push(s)}return a.length&&a.forEach(l=>{l.index!==void 0?r.splice(l.index,0,{...l.item}):r.push({...l.item})}),r}function sJe(e,t){switch(e.type){case"select":{t.selected=e.selected;break}case"position":{typeof e.position<"u"&&(t.position=e.position),typeof e.dragging<"u"&&(t.dragging=e.dragging);break}case"dimensions":{typeof e.dimensions<"u"&&(t.measured??(t.measured={}),t.measured.width=e.dimensions.width,t.measured.height=e.dimensions.height,e.setAttributes&&((e.setAttributes===!0||e.setAttributes==="width")&&(t.width=e.dimensions.width),(e.setAttributes===!0||e.setAttributes==="height")&&(t.height=e.dimensions.height))),typeof e.resizing=="boolean"&&(t.resizing=e.resizing);break}}}function Woe(e,t){return qoe(e,t)}function Koe(e,t){return qoe(e,t)}function w0(e,t){return{id:e,type:"select",selected:t}}function Cv(e,t=new Set,r=!1){const i=[];for(const[a,l]of e){const d=t.has(a);!(l.selected===void 0&&!d)&&l.selected!==d&&(r&&(l.selected=d),i.push(w0(l.id,d)))}return i}function uZ({items:e=[],lookup:t}){var a;const r=[],i=new Map(e.map(l=>[l.id,l]));for(const[l,d]of e.entries()){const s=t.get(d.id),p=((a=s==null?void 0:s.internals)==null?void 0:a.userNode)??s;p!==void 0&&p!==d&&r.push({id:d.id,item:d,type:"replace"}),p===void 0&&r.push({item:d,type:"add",index:l})}for(const[l]of t)i.get(l)===void 0&&r.push({id:l,type:"remove"});return r}function dZ(e){return{id:e.id,type:"remove"}}const hZ=e=>xYe(e),aJe=e=>foe(e);function Zoe(e){return U.forwardRef(e)}const oJe=typeof window<"u"?U.useLayoutEffect:U.useEffect;function mZ(e){const[t,r]=U.useState(BigInt(0)),[i]=U.useState(()=>lJe(()=>r(a=>a+BigInt(1))));return oJe(()=>{const a=i.get();a.length&&(e(a),i.reset())},[t]),i}function lJe(e){let t=[];return{get:()=>t,reset:()=>{t=[]},push:r=>{t.push(r),e()}}}const Yoe=U.createContext(null);function cJe({children:e}){const t=Ys(),r=U.useCallback(s=>{const{nodes:p=[],setNodes:x,hasDefaultNodes:w,onNodesChange:j,nodeLookup:S,fitViewQueued:P}=t.getState();let F=p;for(const B of s)F=typeof B=="function"?B(F):B;const L=uZ({items:F,lookup:S});w&&x(F),L.length>0?j==null||j(L):P&&window.requestAnimationFrame(()=>{const{fitViewQueued:B,nodes:V,setNodes:$}=t.getState();B&&$(V)})},[]),i=mZ(r),a=U.useCallback(s=>{const{edges:p=[],setEdges:x,hasDefaultEdges:w,onEdgesChange:j,edgeLookup:S}=t.getState();let P=p;for(const F of s)P=typeof F=="function"?F(P):F;w?x(P):j&&j(uZ({items:P,lookup:S}))},[]),l=mZ(a),d=U.useMemo(()=>({nodeQueue:i,edgeQueue:l}),[]);return n.jsx(Yoe.Provider,{value:d,children:e})}function uJe(){const e=U.useContext(Yoe);if(!e)throw new Error("useBatchContext must be used within a BatchProvider");return e}const dJe=e=>!!e.panZoom;function F6(){const e=iJe(),t=Ys(),r=uJe(),i=Si(dJe),a=U.useMemo(()=>{const l=j=>t.getState().nodeLookup.get(j),d=j=>{r.nodeQueue.push(j)},s=j=>{r.edgeQueue.push(j)},p=j=>{var V,$;const{nodeLookup:S,nodeOrigin:P}=t.getState(),F=hZ(j)?j:S.get(j.id),L=F.parentId?boe(F.position,F.measured,F.parentId,S,P):F.position,B={...F,position:L,width:((V=F.measured)==null?void 0:V.width)??F.width,height:(($=F.measured)==null?void 0:$.height)??F.height};return Zb(B)},x=(j,S,P={replace:!1})=>{d(F=>F.map(L=>{if(L.id===j){const B=typeof S=="function"?S(L):S;return P.replace&&hZ(B)?B:{...L,...B}}return L}))},w=(j,S,P={replace:!1})=>{s(F=>F.map(L=>{if(L.id===j){const B=typeof S=="function"?S(L):S;return P.replace&&aJe(B)?B:{...L,...B}}return L}))};return{getNodes:()=>t.getState().nodes.map(j=>({...j})),getNode:j=>{var S;return(S=l(j))==null?void 0:S.internals.userNode},getInternalNode:l,getEdges:()=>{const{edges:j=[]}=t.getState();return j.map(S=>({...S}))},getEdge:j=>t.getState().edgeLookup.get(j),setNodes:d,setEdges:s,addNodes:j=>{const S=Array.isArray(j)?j:[j];r.nodeQueue.push(P=>[...P,...S])},addEdges:j=>{const S=Array.isArray(j)?j:[j];r.edgeQueue.push(P=>[...P,...S])},toObject:()=>{const{nodes:j=[],edges:S=[],transform:P}=t.getState(),[F,L,B]=P;return{nodes:j.map(V=>({...V})),edges:S.map(V=>({...V})),viewport:{x:F,y:L,zoom:B}}},deleteElements:async({nodes:j=[],edges:S=[]})=>{const{nodes:P,edges:F,onNodesDelete:L,onEdgesDelete:B,triggerNodeChanges:V,triggerEdgeChanges:$,onDelete:G,onBeforeDelete:W}=t.getState(),{nodes:Z,edges:se}=await wYe({nodesToRemove:j,edgesToRemove:S,nodes:P,edges:F,onBeforeDelete:W}),ae=se.length>0,ce=Z.length>0;if(ae){const Pe=se.map(dZ);B==null||B(se),$(Pe)}if(ce){const Pe=Z.map(dZ);L==null||L(Z),V(Pe)}return(ce||ae)&&(G==null||G({nodes:Z,edges:se})),{deletedNodes:Z,deletedEdges:se}},getIntersectingNodes:(j,S=!0,P)=>{const F=UK(j),L=F?j:p(j),B=P!==void 0;return L?(P||t.getState().nodes).filter(V=>{const $=t.getState().nodeLookup.get(V.id);if($&&!F&&(V.id===j.id||!$.internals.positionAbsolute))return!1;const G=Zb(B?V:$),W=hN(G,L);return S&&W>0||W>=L.width*L.height}):[]},isNodeIntersecting:(j,S,P=!0)=>{const L=UK(j)?j:p(j);if(!L)return!1;const B=hN(L,S);return P&&B>0||B>=L.width*L.height},updateNode:x,updateNodeData:(j,S,P={replace:!1})=>{x(j,F=>{const L=typeof S=="function"?S(F):S;return P.replace?{...F,data:L}:{...F,data:{...F.data,...L}}},P)},updateEdge:w,updateEdgeData:(j,S,P={replace:!1})=>{w(j,F=>{const L=typeof S=="function"?S(F):S;return P.replace?{...F,data:L}:{...F,data:{...F.data,...L}}},P)},getNodesBounds:j=>{const{nodeLookup:S,nodeOrigin:P}=t.getState();return yYe(j,{nodeLookup:S,nodeOrigin:P})},getHandleConnections:({type:j,id:S,nodeId:P})=>{var F;return Array.from(((F=t.getState().connectionLookup.get(`${P}-${j}${S?`-${S}`:""}`))==null?void 0:F.values())??[])},getNodeConnections:({type:j,handleId:S,nodeId:P})=>{var F;return Array.from(((F=t.getState().connectionLookup.get(`${P}${j?S?`-${j}-${S}`:`-${j}`:""}`))==null?void 0:F.values())??[])},fitView:async j=>{const S=t.getState().fitViewResolver??CYe();return t.setState({fitViewQueued:!0,fitViewOptions:j,fitViewResolver:S}),r.nodeQueue.push(P=>[...P]),S.promise}}},[]);return U.useMemo(()=>({...a,...e,viewportInitialized:i}),[i])}const fZ=e=>e.selected,hJe=typeof window<"u"?window:void 0;function mJe({deleteKeyCode:e,multiSelectionKeyCode:t}){const r=Ys(),{deleteElements:i}=F6(),a=fN(e,{actInsideInputWithModifier:!1}),l=fN(t,{target:hJe});U.useEffect(()=>{if(a){const{edges:d,nodes:s}=r.getState();i({nodes:s.filter(fZ),edges:d.filter(fZ)}),r.setState({nodesSelectionActive:!1})}},[a]),U.useEffect(()=>{r.setState({multiSelectionActive:l})},[l])}function fJe(e){const t=Ys();U.useEffect(()=>{const r=()=>{var a,l;if(!e.current)return!1;const i=I6(e.current);(i.height===0||i.width===0)&&((l=(a=t.getState()).onError)==null||l.call(a,"004",bh.error004())),t.setState({width:i.width||500,height:i.height||500})};if(e.current){r(),window.addEventListener("resize",r);const i=new ResizeObserver(()=>r());return i.observe(e.current),()=>{window.removeEventListener("resize",r),i&&e.current&&i.unobserve(e.current)}}},[])}const XM={position:"absolute",width:"100%",height:"100%",top:0,left:0},pJe=e=>({userSelectionActive:e.userSelectionActive,lib:e.lib});function gJe({onPaneContextMenu:e,zoomOnScroll:t=!0,zoomOnPinch:r=!0,panOnScroll:i=!1,panOnScrollSpeed:a=.5,panOnScrollMode:l=H0.Free,zoomOnDoubleClick:d=!0,panOnDrag:s=!0,defaultViewport:p,translateExtent:x,minZoom:w,maxZoom:j,zoomActivationKeyCode:S,preventScrolling:P=!0,children:F,noWheelClassName:L,noPanClassName:B,onViewportChange:V,isControlledViewport:$,paneClickDistance:G}){const W=Ys(),Z=U.useRef(null),{userSelectionActive:se,lib:ae}=Si(pJe,aa),ce=fN(S),Pe=U.useRef();fJe(Z);const we=U.useCallback(xe=>{V==null||V({x:xe[0],y:xe[1],zoom:xe[2]}),$||W.setState({transform:xe})},[V,$]);return U.useEffect(()=>{if(Z.current){Pe.current=aXe({domNode:Z.current,minZoom:w,maxZoom:j,translateExtent:x,viewport:p,paneClickDistance:G,onDraggingChange:ye=>W.setState({paneDragging:ye}),onPanZoomStart:(ye,ve)=>{const{onViewportChangeStart:_e,onMoveStart:Ee}=W.getState();Ee==null||Ee(ye,ve),_e==null||_e(ve)},onPanZoom:(ye,ve)=>{const{onViewportChange:_e,onMove:Ee}=W.getState();Ee==null||Ee(ye,ve),_e==null||_e(ve)},onPanZoomEnd:(ye,ve)=>{const{onViewportChangeEnd:_e,onMoveEnd:Ee}=W.getState();Ee==null||Ee(ye,ve),_e==null||_e(ve)}});const{x:xe,y:Ne,zoom:ze}=Pe.current.getViewport();return W.setState({panZoom:Pe.current,transform:[xe,Ne,ze],domNode:Z.current.closest(".react-flow")}),()=>{var ye;(ye=Pe.current)==null||ye.destroy()}}},[]),U.useEffect(()=>{var xe;(xe=Pe.current)==null||xe.update({onPaneContextMenu:e,zoomOnScroll:t,zoomOnPinch:r,panOnScroll:i,panOnScrollSpeed:a,panOnScrollMode:l,zoomOnDoubleClick:d,panOnDrag:s,zoomActivationKeyPressed:ce,preventScrolling:P,noPanClassName:B,userSelectionActive:se,noWheelClassName:L,lib:ae,onTransformChange:we})},[e,t,r,i,a,l,d,s,ce,P,B,se,L,ae,we]),n.jsx("div",{className:"react-flow__renderer",ref:Z,style:XM,children:F})}const xJe=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function yJe(){const{userSelectionActive:e,userSelectionRect:t}=Si(xJe,aa);return e&&t?n.jsx("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}const iR=(e,t)=>r=>{r.target===t.current&&(e==null||e(r))},vJe=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,connectionInProgress:e.connection.inProgress,dragging:e.paneDragging});function bJe({isSelecting:e,selectionKeyPressed:t,selectionMode:r=dN.Full,panOnDrag:i,selectionOnDrag:a,onSelectionStart:l,onSelectionEnd:d,onPaneClick:s,onPaneContextMenu:p,onPaneScroll:x,onPaneMouseEnter:w,onPaneMouseMove:j,onPaneMouseLeave:S,children:P}){const F=Ys(),{userSelectionActive:L,elementsSelectable:B,dragging:V,connectionInProgress:$}=Si(vJe,aa),G=B&&(e||L),W=U.useRef(null),Z=U.useRef(),se=U.useRef(new Set),ae=U.useRef(new Set),ce=U.useRef(!1),Pe=U.useRef(!1),we=Ee=>{if(ce.current||$){ce.current=!1;return}s==null||s(Ee),F.getState().resetSelectedElements(),F.setState({nodesSelectionActive:!1})},xe=Ee=>{if(Array.isArray(i)&&(i!=null&&i.includes(2))){Ee.preventDefault();return}p==null||p(Ee)},Ne=x?Ee=>x(Ee):void 0,ze=Ee=>{var mt,gt;const{resetSelectedElements:je,domNode:Ce}=F.getState();if(Z.current=Ce==null?void 0:Ce.getBoundingClientRect(),!B||!e||Ee.button!==0||Ee.target!==W.current||!Z.current)return;(gt=(mt=Ee.target)==null?void 0:mt.setPointerCapture)==null||gt.call(mt,Ee.pointerId),Pe.current=!0,ce.current=!1;const{x:tt,y:it}=sh(Ee.nativeEvent,Z.current);je(),F.setState({userSelectionRect:{width:0,height:0,startX:tt,startY:it,x:tt,y:it}}),l==null||l(Ee)},ye=Ee=>{const{userSelectionRect:je,transform:Ce,nodeLookup:tt,edgeLookup:it,connectionLookup:mt,triggerNodeChanges:gt,triggerEdgeChanges:qt,defaultEdgeOptions:yr}=F.getState();if(!Z.current||!je)return;ce.current=!0;const{x:tr,y:Ft}=sh(Ee.nativeEvent,Z.current),{startX:er,startY:Dt}=je,ge={startX:er,startY:Dt,x:tr<er?tr:er,y:Ft<Dt?Ft:Dt,width:Math.abs(tr-er),height:Math.abs(Ft-Dt)},sr=se.current,St=ae.current;se.current=new Set(E6(tt,ge,Ce,r===dN.Partial,!0).map(dt=>dt.id)),ae.current=new Set;const jr=(yr==null?void 0:yr.selectable)??!0;for(const dt of se.current){const Yr=mt.get(dt);if(Yr)for(const{edgeId:Vr}of Yr.values()){const Yn=it.get(Vr);Yn&&(Yn.selectable??jr)&&ae.current.add(Vr)}}if(!GK(sr,se.current)){const dt=Cv(tt,se.current,!0);gt(dt)}if(!GK(St,ae.current)){const dt=Cv(it,ae.current);qt(dt)}F.setState({userSelectionRect:ge,userSelectionActive:!0,nodesSelectionActive:!1})},ve=Ee=>{var Ce,tt;if(Ee.button!==0||!Pe.current)return;(tt=(Ce=Ee.target)==null?void 0:Ce.releasePointerCapture)==null||tt.call(Ce,Ee.pointerId);const{userSelectionRect:je}=F.getState();!L&&je&&Ee.target===W.current&&(we==null||we(Ee)),F.setState({userSelectionActive:!1,userSelectionRect:null,nodesSelectionActive:se.current.size>0}),d==null||d(Ee),(t||a)&&(ce.current=!1),Pe.current=!1},_e=i===!0||Array.isArray(i)&&i.includes(0);return n.jsxs("div",{className:Va(["react-flow__pane",{draggable:_e,dragging:V,selection:e}]),onClick:G?void 0:iR(we,W),onContextMenu:iR(xe,W),onWheel:iR(Ne,W),onPointerEnter:G?void 0:w,onPointerDown:G?ze:j,onPointerMove:G?ye:j,onPointerUp:G?ve:void 0,onPointerLeave:S,ref:W,style:XM,children:[P,n.jsx(yJe,{})]})}function Yz({id:e,store:t,unselect:r=!1,nodeRef:i}){const{addSelectedNodes:a,unselectNodesAndEdges:l,multiSelectionActive:d,nodeLookup:s,onError:p}=t.getState(),x=s.get(e);if(!x){p==null||p("012",bh.error012(e));return}t.setState({nodesSelectionActive:!1}),x.selected?(r||x.selected&&d)&&(l({nodes:[x],edges:[]}),requestAnimationFrame(()=>{var w;return(w=i==null?void 0:i.current)==null?void 0:w.blur()})):a([e])}function Xoe({nodeRef:e,disabled:t=!1,noDragClassName:r,handleSelector:i,nodeId:a,isSelectable:l,nodeClickDistance:d}){const s=Ys(),[p,x]=U.useState(!1),w=U.useRef();return U.useEffect(()=>{w.current=HYe({getStoreItems:()=>s.getState(),onNodeMouseDown:j=>{Yz({id:j,store:s,nodeRef:e})},onDragStart:()=>{x(!0)},onDragStop:()=>{x(!1)}})},[]),U.useEffect(()=>{var j,S;if(t)(j=w.current)==null||j.destroy();else if(e.current)return(S=w.current)==null||S.update({noDragClassName:r,handleSelector:i,domNode:e.current,isSelectable:l,nodeId:a,nodeClickDistance:d}),()=>{var P;(P=w.current)==null||P.destroy()}},[r,i,t,l,e,a]),p}const _Je=e=>t=>t.selected&&(t.draggable||e&&typeof t.draggable>"u");function Joe(){const e=Ys();return U.useCallback(r=>{const{nodeExtent:i,snapToGrid:a,snapGrid:l,nodesDraggable:d,onError:s,updateNodePositions:p,nodeLookup:x,nodeOrigin:w}=e.getState(),j=new Map,S=_Je(d),P=a?l[0]:5,F=a?l[1]:5,L=r.direction.x*P*r.factor,B=r.direction.y*F*r.factor;for(const[,V]of x){if(!S(V))continue;let $={x:V.internals.positionAbsolute.x+L,y:V.internals.positionAbsolute.y+B};a&&($=qM($,l));const{position:G,positionAbsolute:W}=poe({nodeId:V.id,nextPosition:$,nodeLookup:x,nodeExtent:i,nodeOrigin:w,onError:s});V.position=G,V.internals.positionAbsolute=W,j.set(V.id,V)}p(j)},[])}const B6=U.createContext(null),wJe=B6.Provider;B6.Consumer;const Qoe=()=>U.useContext(B6),jJe=e=>({connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName,rfId:e.rfId}),NJe=(e,t,r)=>i=>{const{connectionClickStartHandle:a,connectionMode:l,connection:d}=i,{fromHandle:s,toHandle:p,isValid:x}=d,w=(p==null?void 0:p.nodeId)===e&&(p==null?void 0:p.id)===t&&(p==null?void 0:p.type)===r;return{connectingFrom:(s==null?void 0:s.nodeId)===e&&(s==null?void 0:s.id)===t&&(s==null?void 0:s.type)===r,connectingTo:w,clickConnecting:(a==null?void 0:a.nodeId)===e&&(a==null?void 0:a.id)===t&&(a==null?void 0:a.type)===r,isPossibleEndHandle:l===Wb.Strict?(s==null?void 0:s.type)!==r:e!==(s==null?void 0:s.nodeId)||t!==(s==null?void 0:s.id),connectionInProcess:!!s,clickConnectionInProcess:!!a,valid:w&&x}};function SJe({type:e="source",position:t=cn.Top,isValidConnection:r,isConnectable:i=!0,isConnectableStart:a=!0,isConnectableEnd:l=!0,id:d,onConnect:s,children:p,className:x,onMouseDown:w,onTouchStart:j,...S},P){var ve,_e;const F=d||null,L=e==="target",B=Ys(),V=Qoe(),{connectOnClick:$,noPanClassName:G,rfId:W}=Si(jJe,aa),{connectingFrom:Z,connectingTo:se,clickConnecting:ae,isPossibleEndHandle:ce,connectionInProcess:Pe,clickConnectionInProcess:we,valid:xe}=Si(NJe(V,F,e),aa);V||(_e=(ve=B.getState()).onError)==null||_e.call(ve,"010",bh.error010());const Ne=Ee=>{const{defaultEdgeOptions:je,onConnect:Ce,hasDefaultEdges:tt}=B.getState(),it={...je,...Ee};if(tt){const{edges:mt,setEdges:gt}=B.getState();gt(pS(it,mt))}Ce==null||Ce(it),s==null||s(it)},ze=Ee=>{if(!V)return;const je=joe(Ee.nativeEvent);if(a&&(je&&Ee.button===0||!je)){const Ce=B.getState();Zz.onPointerDown(Ee.nativeEvent,{autoPanOnConnect:Ce.autoPanOnConnect,connectionMode:Ce.connectionMode,connectionRadius:Ce.connectionRadius,domNode:Ce.domNode,nodeLookup:Ce.nodeLookup,lib:Ce.lib,isTarget:L,handleId:F,nodeId:V,flowId:Ce.rfId,panBy:Ce.panBy,cancelConnection:Ce.cancelConnection,onConnectStart:Ce.onConnectStart,onConnectEnd:Ce.onConnectEnd,updateConnection:Ce.updateConnection,onConnect:Ne,isValidConnection:r||Ce.isValidConnection,getTransform:()=>B.getState().transform,getFromHandle:()=>B.getState().connection.fromHandle,autoPanSpeed:Ce.autoPanSpeed,dragThreshold:Ce.connectionDragThreshold})}je?w==null||w(Ee):j==null||j(Ee)},ye=Ee=>{const{onClickConnectStart:je,onClickConnectEnd:Ce,connectionClickStartHandle:tt,connectionMode:it,isValidConnection:mt,lib:gt,rfId:qt,nodeLookup:yr,connection:tr}=B.getState();if(!V||!tt&&!a)return;if(!tt){je==null||je(Ee.nativeEvent,{nodeId:V,handleId:F,handleType:e}),B.setState({connectionClickStartHandle:{nodeId:V,type:e,id:F}});return}const Ft=_oe(Ee.target),er=r||mt,{connection:Dt,isValid:ge}=Zz.isValid(Ee.nativeEvent,{handle:{nodeId:V,id:F,type:e},connectionMode:it,fromNodeId:tt.nodeId,fromHandleId:tt.id||null,fromType:tt.type,isValidConnection:er,flowId:qt,doc:Ft,lib:gt,nodeLookup:yr});ge&&Dt&&Ne(Dt);const sr=structuredClone(tr);delete sr.inProgress,sr.toPosition=sr.toHandle?sr.toHandle.position:null,Ce==null||Ce(Ee,sr),B.setState({connectionClickStartHandle:null})};return n.jsx("div",{"data-handleid":F,"data-nodeid":V,"data-handlepos":t,"data-id":`${W}-${V}-${F}-${e}`,className:Va(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",G,x,{source:!L,target:L,connectable:i,connectablestart:a,connectableend:l,clickconnecting:ae,connectingfrom:Z,connectingto:se,valid:xe,connectionindicator:i&&(!Pe||ce)&&(Pe||we?l:a)}]),onMouseDown:ze,onTouchStart:ze,onClick:$?ye:void 0,ref:P,...S,children:p})}const zc=U.memo(Zoe(SJe));function CJe({data:e,isConnectable:t,sourcePosition:r=cn.Bottom}){return n.jsxs(n.Fragment,{children:[e==null?void 0:e.label,n.jsx(zc,{type:"source",position:r,isConnectable:t})]})}function AJe({data:e,isConnectable:t,targetPosition:r=cn.Top,sourcePosition:i=cn.Bottom}){return n.jsxs(n.Fragment,{children:[n.jsx(zc,{type:"target",position:r,isConnectable:t}),e==null?void 0:e.label,n.jsx(zc,{type:"source",position:i,isConnectable:t})]})}function TJe(){return null}function kJe({data:e,isConnectable:t,targetPosition:r=cn.Top}){return n.jsxs(n.Fragment,{children:[n.jsx(zc,{type:"target",position:r,isConnectable:t}),e==null?void 0:e.label]})}const OP={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},pZ={input:CJe,default:AJe,output:kJe,group:TJe};function PJe(e){var t,r,i,a;return e.internals.handleBounds===void 0?{width:e.width??e.initialWidth??((t=e.style)==null?void 0:t.width),height:e.height??e.initialHeight??((r=e.style)==null?void 0:r.height)}:{width:e.width??((i=e.style)==null?void 0:i.width),height:e.height??((a=e.style)==null?void 0:a.height)}}const EJe=e=>{const{width:t,height:r,x:i,y:a}=mS(e.nodeLookup,{filter:l=>!!l.selected});return{width:md(t)?t:null,height:md(r)?r:null,userSelectionActive:e.userSelectionActive,transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]}) translate(${i}px,${a}px)`}};function MJe({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:r}){const i=Ys(),{width:a,height:l,transformString:d,userSelectionActive:s}=Si(EJe,aa),p=Joe(),x=U.useRef(null);if(U.useEffect(()=>{var S;r||(S=x.current)==null||S.focus({preventScroll:!0})},[r]),Xoe({nodeRef:x}),s||!a||!l)return null;const w=e?S=>{const P=i.getState().nodes.filter(F=>F.selected);e(S,P)}:void 0,j=S=>{Object.prototype.hasOwnProperty.call(OP,S.key)&&(S.preventDefault(),p({direction:OP[S.key],factor:S.shiftKey?4:1}))};return n.jsx("div",{className:Va(["react-flow__nodesselection","react-flow__container",t]),style:{transform:d},children:n.jsx("div",{ref:x,className:"react-flow__nodesselection-rect",onContextMenu:w,tabIndex:r?void 0:-1,onKeyDown:r?void 0:j,style:{width:a,height:l}})})}const gZ=typeof window<"u"?window:void 0,IJe=e=>({nodesSelectionActive:e.nodesSelectionActive,userSelectionActive:e.userSelectionActive});function ele({children:e,onPaneClick:t,onPaneMouseEnter:r,onPaneMouseMove:i,onPaneMouseLeave:a,onPaneContextMenu:l,onPaneScroll:d,paneClickDistance:s,deleteKeyCode:p,selectionKeyCode:x,selectionOnDrag:w,selectionMode:j,onSelectionStart:S,onSelectionEnd:P,multiSelectionKeyCode:F,panActivationKeyCode:L,zoomActivationKeyCode:B,elementsSelectable:V,zoomOnScroll:$,zoomOnPinch:G,panOnScroll:W,panOnScrollSpeed:Z,panOnScrollMode:se,zoomOnDoubleClick:ae,panOnDrag:ce,defaultViewport:Pe,translateExtent:we,minZoom:xe,maxZoom:Ne,preventScrolling:ze,onSelectionContextMenu:ye,noWheelClassName:ve,noPanClassName:_e,disableKeyboardA11y:Ee,onViewportChange:je,isControlledViewport:Ce}){const{nodesSelectionActive:tt,userSelectionActive:it}=Si(IJe),mt=fN(x,{target:gZ}),gt=fN(L,{target:gZ}),qt=gt||ce,yr=gt||W,tr=w&&qt!==!0,Ft=mt||it||tr;return mJe({deleteKeyCode:p,multiSelectionKeyCode:F}),n.jsx(gJe,{onPaneContextMenu:l,elementsSelectable:V,zoomOnScroll:$,zoomOnPinch:G,panOnScroll:yr,panOnScrollSpeed:Z,panOnScrollMode:se,zoomOnDoubleClick:ae,panOnDrag:!mt&&qt,defaultViewport:Pe,translateExtent:we,minZoom:xe,maxZoom:Ne,zoomActivationKeyCode:B,preventScrolling:ze,noWheelClassName:ve,noPanClassName:_e,onViewportChange:je,isControlledViewport:Ce,paneClickDistance:s,children:n.jsxs(bJe,{onSelectionStart:S,onSelectionEnd:P,onPaneClick:t,onPaneMouseEnter:r,onPaneMouseMove:i,onPaneMouseLeave:a,onPaneContextMenu:l,onPaneScroll:d,panOnDrag:qt,isSelecting:!!Ft,selectionMode:j,selectionKeyPressed:mt,selectionOnDrag:tr,children:[e,tt&&n.jsx(MJe,{onSelectionContextMenu:ye,noPanClassName:_e,disableKeyboardA11y:Ee})]})})}ele.displayName="FlowRenderer";const OJe=U.memo(ele),RJe=e=>t=>e?E6(t.nodeLookup,{x:0,y:0,width:t.width,height:t.height},t.transform,!0).map(r=>r.id):Array.from(t.nodeLookup.keys());function DJe(e){return Si(U.useCallback(RJe(e),[e]),aa)}const zJe=e=>e.updateNodeInternals;function LJe(){const e=Si(zJe),[t]=U.useState(()=>typeof ResizeObserver>"u"?null:new ResizeObserver(r=>{const i=new Map;r.forEach(a=>{const l=a.target.getAttribute("data-id");i.set(l,{id:l,nodeElement:a.target,force:!0})}),e(i)}));return U.useEffect(()=>()=>{t==null||t.disconnect()},[t]),t}function FJe({node:e,nodeType:t,hasDimensions:r,resizeObserver:i}){const a=Ys(),l=U.useRef(null),d=U.useRef(null),s=U.useRef(e.sourcePosition),p=U.useRef(e.targetPosition),x=U.useRef(t),w=r&&!!e.internals.handleBounds;return U.useEffect(()=>{l.current&&!e.hidden&&(!w||d.current!==l.current)&&(d.current&&(i==null||i.unobserve(d.current)),i==null||i.observe(l.current),d.current=l.current)},[w,e.hidden]),U.useEffect(()=>()=>{d.current&&(i==null||i.unobserve(d.current),d.current=null)},[]),U.useEffect(()=>{if(l.current){const j=x.current!==t,S=s.current!==e.sourcePosition,P=p.current!==e.targetPosition;(j||S||P)&&(x.current=t,s.current=e.sourcePosition,p.current=e.targetPosition,a.getState().updateNodeInternals(new Map([[e.id,{id:e.id,nodeElement:l.current,force:!0}]])))}},[e.id,t,e.sourcePosition,e.targetPosition]),l}function BJe({id:e,onClick:t,onMouseEnter:r,onMouseMove:i,onMouseLeave:a,onContextMenu:l,onDoubleClick:d,nodesDraggable:s,elementsSelectable:p,nodesConnectable:x,nodesFocusable:w,resizeObserver:j,noDragClassName:S,noPanClassName:P,disableKeyboardA11y:F,rfId:L,nodeTypes:B,nodeClickDistance:V,onError:$}){const{node:G,internals:W,isParent:Z}=Si(er=>{const Dt=er.nodeLookup.get(e),ge=er.parentLookup.has(e);return{node:Dt,internals:Dt.internals,isParent:ge}},aa);let se=G.type||"default",ae=(B==null?void 0:B[se])||pZ[se];ae===void 0&&($==null||$("003",bh.error003(se)),se="default",ae=pZ.default);const ce=!!(G.draggable||s&&typeof G.draggable>"u"),Pe=!!(G.selectable||p&&typeof G.selectable>"u"),we=!!(G.connectable||x&&typeof G.connectable>"u"),xe=!!(G.focusable||w&&typeof G.focusable>"u"),Ne=Ys(),ze=voe(G),ye=FJe({node:G,nodeType:se,hasDimensions:ze,resizeObserver:j}),ve=Xoe({nodeRef:ye,disabled:G.hidden||!ce,noDragClassName:S,handleSelector:G.dragHandle,nodeId:e,isSelectable:Pe,nodeClickDistance:V}),_e=Joe();if(G.hidden)return null;const Ee=Vm(G),je=PJe(G),Ce=Pe||ce||t||r||i||a,tt=r?er=>r(er,{...W.userNode}):void 0,it=i?er=>i(er,{...W.userNode}):void 0,mt=a?er=>a(er,{...W.userNode}):void 0,gt=l?er=>l(er,{...W.userNode}):void 0,qt=d?er=>d(er,{...W.userNode}):void 0,yr=er=>{const{selectNodesOnDrag:Dt,nodeDragThreshold:ge}=Ne.getState();Pe&&(!Dt||!ce||ge>0)&&Yz({id:e,store:Ne,nodeRef:ye}),t&&t(er,{...W.userNode})},tr=er=>{if(!(woe(er.nativeEvent)||F)){if(uoe.includes(er.key)&&Pe){const Dt=er.key==="Escape";Yz({id:e,store:Ne,unselect:Dt,nodeRef:ye})}else if(ce&&G.selected&&Object.prototype.hasOwnProperty.call(OP,er.key)){er.preventDefault();const{ariaLabelConfig:Dt}=Ne.getState();Ne.setState({ariaLiveMessage:Dt["node.a11yDescription.ariaLiveMessage"]({direction:er.key.replace("Arrow","").toLowerCase(),x:~~W.positionAbsolute.x,y:~~W.positionAbsolute.y})}),_e({direction:OP[er.key],factor:er.shiftKey?4:1})}}},Ft=()=>{var dt;if(F||!((dt=ye.current)!=null&&dt.matches(":focus-visible")))return;const{transform:er,width:Dt,height:ge,autoPanOnNodeFocus:sr,setCenter:St}=Ne.getState();if(!sr)return;E6(new Map([[e,G]]),{x:0,y:0,width:Dt,height:ge},er,!0).length>0||St(G.position.x+Ee.width/2,G.position.y+Ee.height/2,{zoom:er[2]})};return n.jsx("div",{className:Va(["react-flow__node",`react-flow__node-${se}`,{[P]:ce},G.className,{selected:G.selected,selectable:Pe,parent:Z,draggable:ce,dragging:ve}]),ref:ye,style:{zIndex:W.z,transform:`translate(${W.positionAbsolute.x}px,${W.positionAbsolute.y}px)`,pointerEvents:Ce?"all":"none",visibility:ze?"visible":"hidden",...G.style,...je},"data-id":e,"data-testid":`rf__node-${e}`,onMouseEnter:tt,onMouseMove:it,onMouseLeave:mt,onContextMenu:gt,onClick:yr,onDoubleClick:qt,onKeyDown:xe?tr:void 0,tabIndex:xe?0:void 0,onFocus:xe?Ft:void 0,role:G.ariaRole??(xe?"group":void 0),"aria-roledescription":"node","aria-describedby":F?void 0:`${Uoe}-${L}`,"aria-label":G.ariaLabel,...G.domAttributes,children:n.jsx(wJe,{value:e,children:n.jsx(ae,{id:e,data:G.data,type:se,positionAbsoluteX:W.positionAbsolute.x,positionAbsoluteY:W.positionAbsolute.y,selected:G.selected??!1,selectable:Pe,draggable:ce,deletable:G.deletable??!0,isConnectable:we,sourcePosition:G.sourcePosition,targetPosition:G.targetPosition,dragging:ve,dragHandle:G.dragHandle,zIndex:W.z,parentId:G.parentId,...Ee})})})}const $Je=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,onError:e.onError});function tle(e){const{nodesDraggable:t,nodesConnectable:r,nodesFocusable:i,elementsSelectable:a,onError:l}=Si($Je,aa),d=DJe(e.onlyRenderVisibleElements),s=LJe();return n.jsx("div",{className:"react-flow__nodes",style:XM,children:d.map(p=>n.jsx(BJe,{id:p,nodeTypes:e.nodeTypes,nodeExtent:e.nodeExtent,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,resizeObserver:s,nodesDraggable:t,nodesConnectable:r,nodesFocusable:i,elementsSelectable:a,nodeClickDistance:e.nodeClickDistance,onError:l},p))})}tle.displayName="NodeRenderer";const VJe=U.memo(tle);function UJe(e){return Si(U.useCallback(r=>{if(!e)return r.edges.map(a=>a.id);const i=[];if(r.width&&r.height)for(const a of r.edges){const l=r.nodeLookup.get(a.source),d=r.nodeLookup.get(a.target);l&&d&&PYe({sourceNode:l,targetNode:d,width:r.width,height:r.height,transform:r.transform})&&i.push(a.id)}return i},[e]),aa)}const GJe=({color:e="none",strokeWidth:t=1})=>n.jsx("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),HJe=({color:e="none",strokeWidth:t=1})=>n.jsx("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),xZ={[PP.Arrow]:GJe,[PP.ArrowClosed]:HJe};function qJe(e){const t=Ys();return U.useMemo(()=>{var a,l;return Object.prototype.hasOwnProperty.call(xZ,e)?xZ[e]:((l=(a=t.getState()).onError)==null||l.call(a,"009",bh.error009(e)),null)},[e])}const WJe=({id:e,type:t,color:r,width:i=12.5,height:a=12.5,markerUnits:l="strokeWidth",strokeWidth:d,orient:s="auto-start-reverse"})=>{const p=qJe(t);return p?n.jsx("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${i}`,markerHeight:`${a}`,viewBox:"-10 -10 20 20",markerUnits:l,orient:s,refX:"0",refY:"0",children:n.jsx(p,{color:r,strokeWidth:d})}):null},rle=({defaultColor:e,rfId:t})=>{const r=Si(l=>l.edges),i=Si(l=>l.defaultEdgeOptions),a=U.useMemo(()=>zYe(r,{id:t,defaultColor:e,defaultMarkerStart:i==null?void 0:i.markerStart,defaultMarkerEnd:i==null?void 0:i.markerEnd}),[r,i,t,e]);return a.length?n.jsx("svg",{className:"react-flow__marker","aria-hidden":"true",children:n.jsx("defs",{children:a.map(l=>n.jsx(WJe,{id:l.id,type:l.type,color:l.color,width:l.width,height:l.height,markerUnits:l.markerUnits,strokeWidth:l.strokeWidth,orient:l.orient},l.id))})}):null};rle.displayName="MarkerDefinitions";var KJe=U.memo(rle);function nle({x:e,y:t,label:r,labelStyle:i,labelShowBg:a=!0,labelBgStyle:l,labelBgPadding:d=[2,4],labelBgBorderRadius:s=2,children:p,className:x,...w}){const[j,S]=U.useState({x:1,y:0,width:0,height:0}),P=Va(["react-flow__edge-textwrapper",x]),F=U.useRef(null);return U.useEffect(()=>{if(F.current){const L=F.current.getBBox();S({x:L.x,y:L.y,width:L.width,height:L.height})}},[r]),r?n.jsxs("g",{transform:`translate(${e-j.width/2} ${t-j.height/2})`,className:P,visibility:j.width?"visible":"hidden",...w,children:[a&&n.jsx("rect",{width:j.width+2*d[0],x:-d[0],y:-d[1],height:j.height+2*d[1],className:"react-flow__edge-textbg",style:l,rx:s,ry:s}),n.jsx("text",{className:"react-flow__edge-text",y:j.height/2,dy:"0.3em",ref:F,style:i,children:r}),p]}):null}nle.displayName="EdgeText";const ZJe=U.memo(nle);function gS({path:e,labelX:t,labelY:r,label:i,labelStyle:a,labelShowBg:l,labelBgStyle:d,labelBgPadding:s,labelBgBorderRadius:p,interactionWidth:x=20,...w}){return n.jsxs(n.Fragment,{children:[n.jsx("path",{...w,d:e,fill:"none",className:Va(["react-flow__edge-path",w.className])}),x&&n.jsx("path",{d:e,fill:"none",strokeOpacity:0,strokeWidth:x,className:"react-flow__edge-interaction"}),i&&md(t)&&md(r)?n.jsx(ZJe,{x:t,y:r,label:i,labelStyle:a,labelShowBg:l,labelBgStyle:d,labelBgPadding:s,labelBgBorderRadius:p}):null]})}function yZ({pos:e,x1:t,y1:r,x2:i,y2:a}){return e===cn.Left||e===cn.Right?[.5*(t+i),r]:[t,.5*(r+a)]}function ile({sourceX:e,sourceY:t,sourcePosition:r=cn.Bottom,targetX:i,targetY:a,targetPosition:l=cn.Top}){const[d,s]=yZ({pos:r,x1:e,y1:t,x2:i,y2:a}),[p,x]=yZ({pos:l,x1:i,y1:a,x2:e,y2:t}),[w,j,S,P]=Noe({sourceX:e,sourceY:t,targetX:i,targetY:a,sourceControlX:d,sourceControlY:s,targetControlX:p,targetControlY:x});return[`M${e},${t} C${d},${s} ${p},${x} ${i},${a}`,w,j,S,P]}function sle(e){return U.memo(({id:t,sourceX:r,sourceY:i,targetX:a,targetY:l,sourcePosition:d,targetPosition:s,label:p,labelStyle:x,labelShowBg:w,labelBgStyle:j,labelBgPadding:S,labelBgBorderRadius:P,style:F,markerEnd:L,markerStart:B,interactionWidth:V})=>{const[$,G,W]=ile({sourceX:r,sourceY:i,sourcePosition:d,targetX:a,targetY:l,targetPosition:s}),Z=e.isInternal?void 0:t;return n.jsx(gS,{id:Z,path:$,labelX:G,labelY:W,label:p,labelStyle:x,labelShowBg:w,labelBgStyle:j,labelBgPadding:S,labelBgBorderRadius:P,style:F,markerEnd:L,markerStart:B,interactionWidth:V})})}const YJe=sle({isInternal:!1}),ale=sle({isInternal:!0});YJe.displayName="SimpleBezierEdge";ale.displayName="SimpleBezierEdgeInternal";function ole(e){return U.memo(({id:t,sourceX:r,sourceY:i,targetX:a,targetY:l,label:d,labelStyle:s,labelShowBg:p,labelBgStyle:x,labelBgPadding:w,labelBgBorderRadius:j,style:S,sourcePosition:P=cn.Bottom,targetPosition:F=cn.Top,markerEnd:L,markerStart:B,pathOptions:V,interactionWidth:$})=>{const[G,W,Z]=qz({sourceX:r,sourceY:i,sourcePosition:P,targetX:a,targetY:l,targetPosition:F,borderRadius:V==null?void 0:V.borderRadius,offset:V==null?void 0:V.offset}),se=e.isInternal?void 0:t;return n.jsx(gS,{id:se,path:G,labelX:W,labelY:Z,label:d,labelStyle:s,labelShowBg:p,labelBgStyle:x,labelBgPadding:w,labelBgBorderRadius:j,style:S,markerEnd:L,markerStart:B,interactionWidth:$})})}const lle=ole({isInternal:!1}),cle=ole({isInternal:!0});lle.displayName="SmoothStepEdge";cle.displayName="SmoothStepEdgeInternal";function ule(e){return U.memo(({id:t,...r})=>{var a;const i=e.isInternal?void 0:t;return n.jsx(lle,{...r,id:i,pathOptions:U.useMemo(()=>{var l;return{borderRadius:0,offset:(l=r.pathOptions)==null?void 0:l.offset}},[(a=r.pathOptions)==null?void 0:a.offset])})})}const XJe=ule({isInternal:!1}),dle=ule({isInternal:!0});XJe.displayName="StepEdge";dle.displayName="StepEdgeInternal";function hle(e){return U.memo(({id:t,sourceX:r,sourceY:i,targetX:a,targetY:l,label:d,labelStyle:s,labelShowBg:p,labelBgStyle:x,labelBgPadding:w,labelBgBorderRadius:j,style:S,markerEnd:P,markerStart:F,interactionWidth:L})=>{const[B,V,$]=Coe({sourceX:r,sourceY:i,targetX:a,targetY:l}),G=e.isInternal?void 0:t;return n.jsx(gS,{id:G,path:B,labelX:V,labelY:$,label:d,labelStyle:s,labelShowBg:p,labelBgStyle:x,labelBgPadding:w,labelBgBorderRadius:j,style:S,markerEnd:P,markerStart:F,interactionWidth:L})})}const JJe=hle({isInternal:!1}),mle=hle({isInternal:!0});JJe.displayName="StraightEdge";mle.displayName="StraightEdgeInternal";function fle(e){return U.memo(({id:t,sourceX:r,sourceY:i,targetX:a,targetY:l,sourcePosition:d=cn.Bottom,targetPosition:s=cn.Top,label:p,labelStyle:x,labelShowBg:w,labelBgStyle:j,labelBgPadding:S,labelBgBorderRadius:P,style:F,markerEnd:L,markerStart:B,pathOptions:V,interactionWidth:$})=>{const[G,W,Z]=O6({sourceX:r,sourceY:i,sourcePosition:d,targetX:a,targetY:l,targetPosition:s,curvature:V==null?void 0:V.curvature}),se=e.isInternal?void 0:t;return n.jsx(gS,{id:se,path:G,labelX:W,labelY:Z,label:p,labelStyle:x,labelShowBg:w,labelBgStyle:j,labelBgPadding:S,labelBgBorderRadius:P,style:F,markerEnd:L,markerStart:B,interactionWidth:$})})}const QJe=fle({isInternal:!1}),ple=fle({isInternal:!0});QJe.displayName="BezierEdge";ple.displayName="BezierEdgeInternal";const vZ={default:ple,straight:mle,step:dle,smoothstep:cle,simplebezier:ale},bZ={sourceX:null,sourceY:null,targetX:null,targetY:null,sourcePosition:null,targetPosition:null},eQe=(e,t,r)=>r===cn.Left?e-t:r===cn.Right?e+t:e,tQe=(e,t,r)=>r===cn.Top?e-t:r===cn.Bottom?e+t:e,_Z="react-flow__edgeupdater";function wZ({position:e,centerX:t,centerY:r,radius:i=10,onMouseDown:a,onMouseEnter:l,onMouseOut:d,type:s}){return n.jsx("circle",{onMouseDown:a,onMouseEnter:l,onMouseOut:d,className:Va([_Z,`${_Z}-${s}`]),cx:eQe(t,i,e),cy:tQe(r,i,e),r:i,stroke:"transparent",fill:"transparent"})}function rQe({isReconnectable:e,reconnectRadius:t,edge:r,sourceX:i,sourceY:a,targetX:l,targetY:d,sourcePosition:s,targetPosition:p,onReconnect:x,onReconnectStart:w,onReconnectEnd:j,setReconnecting:S,setUpdateHover:P}){const F=Ys(),L=(W,Z)=>{if(W.button!==0)return;const{autoPanOnConnect:se,domNode:ae,isValidConnection:ce,connectionMode:Pe,connectionRadius:we,lib:xe,onConnectStart:Ne,onConnectEnd:ze,cancelConnection:ye,nodeLookup:ve,rfId:_e,panBy:Ee,updateConnection:je}=F.getState(),Ce=Z.type==="target",tt=(gt,qt)=>{S(!1),j==null||j(gt,r,Z.type,qt)},it=gt=>x==null?void 0:x(r,gt),mt=(gt,qt)=>{S(!0),w==null||w(W,r,Z.type),Ne==null||Ne(gt,qt)};Zz.onPointerDown(W.nativeEvent,{autoPanOnConnect:se,connectionMode:Pe,connectionRadius:we,domNode:ae,handleId:Z.id,nodeId:Z.nodeId,nodeLookup:ve,isTarget:Ce,edgeUpdaterType:Z.type,lib:xe,flowId:_e,cancelConnection:ye,panBy:Ee,isValidConnection:ce,onConnect:it,onConnectStart:mt,onConnectEnd:ze,onReconnectEnd:tt,updateConnection:je,getTransform:()=>F.getState().transform,getFromHandle:()=>F.getState().connection.fromHandle,dragThreshold:F.getState().connectionDragThreshold})},B=W=>L(W,{nodeId:r.target,id:r.targetHandle??null,type:"target"}),V=W=>L(W,{nodeId:r.source,id:r.sourceHandle??null,type:"source"}),$=()=>P(!0),G=()=>P(!1);return n.jsxs(n.Fragment,{children:[(e===!0||e==="source")&&n.jsx(wZ,{position:s,centerX:i,centerY:a,radius:t,onMouseDown:B,onMouseEnter:$,onMouseOut:G,type:"source"}),(e===!0||e==="target")&&n.jsx(wZ,{position:p,centerX:l,centerY:d,radius:t,onMouseDown:V,onMouseEnter:$,onMouseOut:G,type:"target"})]})}function nQe({id:e,edgesFocusable:t,edgesReconnectable:r,elementsSelectable:i,onClick:a,onDoubleClick:l,onContextMenu:d,onMouseEnter:s,onMouseMove:p,onMouseLeave:x,reconnectRadius:w,onReconnect:j,onReconnectStart:S,onReconnectEnd:P,rfId:F,edgeTypes:L,noPanClassName:B,onError:V,disableKeyboardA11y:$}){let G=Si(St=>St.edgeLookup.get(e));const W=Si(St=>St.defaultEdgeOptions);G=W?{...W,...G}:G;let Z=G.type||"default",se=(L==null?void 0:L[Z])||vZ[Z];se===void 0&&(V==null||V("011",bh.error011(Z)),Z="default",se=vZ.default);const ae=!!(G.focusable||t&&typeof G.focusable>"u"),ce=typeof j<"u"&&(G.reconnectable||r&&typeof G.reconnectable>"u"),Pe=!!(G.selectable||i&&typeof G.selectable>"u"),we=U.useRef(null),[xe,Ne]=U.useState(!1),[ze,ye]=U.useState(!1),ve=Ys(),{zIndex:_e,sourceX:Ee,sourceY:je,targetX:Ce,targetY:tt,sourcePosition:it,targetPosition:mt}=Si(U.useCallback(St=>{const jr=St.nodeLookup.get(G.source),dt=St.nodeLookup.get(G.target);if(!jr||!dt)return{zIndex:G.zIndex,...bZ};const Yr=DYe({id:e,sourceNode:jr,targetNode:dt,sourceHandle:G.sourceHandle||null,targetHandle:G.targetHandle||null,connectionMode:St.connectionMode,onError:V});return{zIndex:kYe({selected:G.selected,zIndex:G.zIndex,sourceNode:jr,targetNode:dt,elevateOnSelect:St.elevateEdgesOnSelect}),...Yr||bZ}},[G.source,G.target,G.sourceHandle,G.targetHandle,G.selected,G.zIndex]),aa),gt=U.useMemo(()=>G.markerStart?`url('#${Wz(G.markerStart,F)}')`:void 0,[G.markerStart,F]),qt=U.useMemo(()=>G.markerEnd?`url('#${Wz(G.markerEnd,F)}')`:void 0,[G.markerEnd,F]);if(G.hidden||Ee===null||je===null||Ce===null||tt===null)return null;const yr=St=>{var Vr;const{addSelectedEdges:jr,unselectNodesAndEdges:dt,multiSelectionActive:Yr}=ve.getState();Pe&&(ve.setState({nodesSelectionActive:!1}),G.selected&&Yr?(dt({nodes:[],edges:[G]}),(Vr=we.current)==null||Vr.blur()):jr([e])),a&&a(St,G)},tr=l?St=>{l(St,{...G})}:void 0,Ft=d?St=>{d(St,{...G})}:void 0,er=s?St=>{s(St,{...G})}:void 0,Dt=p?St=>{p(St,{...G})}:void 0,ge=x?St=>{x(St,{...G})}:void 0,sr=St=>{var jr;if(!$&&uoe.includes(St.key)&&Pe){const{unselectNodesAndEdges:dt,addSelectedEdges:Yr}=ve.getState();St.key==="Escape"?((jr=we.current)==null||jr.blur(),dt({edges:[G]})):Yr([e])}};return n.jsx("svg",{style:{zIndex:_e},children:n.jsxs("g",{className:Va(["react-flow__edge",`react-flow__edge-${Z}`,G.className,B,{selected:G.selected,animated:G.animated,inactive:!Pe&&!a,updating:xe,selectable:Pe}]),onClick:yr,onDoubleClick:tr,onContextMenu:Ft,onMouseEnter:er,onMouseMove:Dt,onMouseLeave:ge,onKeyDown:ae?sr:void 0,tabIndex:ae?0:void 0,role:G.ariaRole??(ae?"group":"img"),"aria-roledescription":"edge","data-id":e,"data-testid":`rf__edge-${e}`,"aria-label":G.ariaLabel===null?void 0:G.ariaLabel||`Edge from ${G.source} to ${G.target}`,"aria-describedby":ae?`${Goe}-${F}`:void 0,ref:we,...G.domAttributes,children:[!ze&&n.jsx(se,{id:e,source:G.source,target:G.target,type:G.type,selected:G.selected,animated:G.animated,selectable:Pe,deletable:G.deletable??!0,label:G.label,labelStyle:G.labelStyle,labelShowBg:G.labelShowBg,labelBgStyle:G.labelBgStyle,labelBgPadding:G.labelBgPadding,labelBgBorderRadius:G.labelBgBorderRadius,sourceX:Ee,sourceY:je,targetX:Ce,targetY:tt,sourcePosition:it,targetPosition:mt,data:G.data,style:G.style,sourceHandleId:G.sourceHandle,targetHandleId:G.targetHandle,markerStart:gt,markerEnd:qt,pathOptions:"pathOptions"in G?G.pathOptions:void 0,interactionWidth:G.interactionWidth}),ce&&n.jsx(rQe,{edge:G,isReconnectable:ce,reconnectRadius:w,onReconnect:j,onReconnectStart:S,onReconnectEnd:P,sourceX:Ee,sourceY:je,targetX:Ce,targetY:tt,sourcePosition:it,targetPosition:mt,setUpdateHover:Ne,setReconnecting:ye})]})})}const iQe=e=>({edgesFocusable:e.edgesFocusable,edgesReconnectable:e.edgesReconnectable,elementsSelectable:e.elementsSelectable,connectionMode:e.connectionMode,onError:e.onError});function gle({defaultMarkerColor:e,onlyRenderVisibleElements:t,rfId:r,edgeTypes:i,noPanClassName:a,onReconnect:l,onEdgeContextMenu:d,onEdgeMouseEnter:s,onEdgeMouseMove:p,onEdgeMouseLeave:x,onEdgeClick:w,reconnectRadius:j,onEdgeDoubleClick:S,onReconnectStart:P,onReconnectEnd:F,disableKeyboardA11y:L}){const{edgesFocusable:B,edgesReconnectable:V,elementsSelectable:$,onError:G}=Si(iQe,aa),W=UJe(t);return n.jsxs("div",{className:"react-flow__edges",children:[n.jsx(KJe,{defaultColor:e,rfId:r}),W.map(Z=>n.jsx(nQe,{id:Z,edgesFocusable:B,edgesReconnectable:V,elementsSelectable:$,noPanClassName:a,onReconnect:l,onContextMenu:d,onMouseEnter:s,onMouseMove:p,onMouseLeave:x,onClick:w,reconnectRadius:j,onDoubleClick:S,onReconnectStart:P,onReconnectEnd:F,rfId:r,onError:G,edgeTypes:i,disableKeyboardA11y:L},Z))]})}gle.displayName="EdgeRenderer";const sQe=U.memo(gle),aQe=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function oQe({children:e}){const t=Si(aQe);return n.jsx("div",{className:"react-flow__viewport xyflow__viewport react-flow__container",style:{transform:t},children:e})}function lQe(e){const t=F6(),r=U.useRef(!1);U.useEffect(()=>{!r.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),r.current=!0)},[e,t.viewportInitialized])}const cQe=e=>{var t;return(t=e.panZoom)==null?void 0:t.syncViewport};function uQe(e){const t=Si(cQe),r=Ys();return U.useEffect(()=>{e&&(t==null||t(e),r.setState({transform:[e.x,e.y,e.zoom]}))},[e,t]),null}function dQe(e){return e.connection.inProgress?{...e.connection,to:fS(e.connection.to,e.transform)}:{...e.connection}}function hQe(e){return dQe}function mQe(e){const t=hQe();return Si(t,aa)}const fQe=e=>({nodesConnectable:e.nodesConnectable,isValid:e.connection.isValid,inProgress:e.connection.inProgress,width:e.width,height:e.height});function pQe({containerStyle:e,style:t,type:r,component:i}){const{nodesConnectable:a,width:l,height:d,isValid:s,inProgress:p}=Si(fQe,aa);return!(l&&a&&p)?null:n.jsx("svg",{style:e,width:l,height:d,className:"react-flow__connectionline react-flow__container",children:n.jsx("g",{className:Va(["react-flow__connection",moe(s)]),children:n.jsx(xle,{style:t,type:r,CustomComponent:i,isValid:s})})})}const xle=({style:e,type:t=cp.Bezier,CustomComponent:r,isValid:i})=>{const{inProgress:a,from:l,fromNode:d,fromHandle:s,fromPosition:p,to:x,toNode:w,toHandle:j,toPosition:S}=mQe();if(!a)return;if(r)return n.jsx(r,{connectionLineType:t,connectionLineStyle:e,fromNode:d,fromHandle:s,fromX:l.x,fromY:l.y,toX:x.x,toY:x.y,fromPosition:p,toPosition:S,connectionStatus:moe(i),toNode:w,toHandle:j});let P="";const F={sourceX:l.x,sourceY:l.y,sourcePosition:p,targetX:x.x,targetY:x.y,targetPosition:S};switch(t){case cp.Bezier:[P]=O6(F);break;case cp.SimpleBezier:[P]=ile(F);break;case cp.Step:[P]=qz({...F,borderRadius:0});break;case cp.SmoothStep:[P]=qz(F);break;default:[P]=Coe(F)}return n.jsx("path",{d:P,fill:"none",className:"react-flow__connection-path",style:e})};xle.displayName="ConnectionLine";const gQe={};function jZ(e=gQe){U.useRef(e),Ys(),U.useEffect(()=>{},[e])}function xQe(){Ys(),U.useRef(!1),U.useEffect(()=>{},[])}function yle({nodeTypes:e,edgeTypes:t,onInit:r,onNodeClick:i,onEdgeClick:a,onNodeDoubleClick:l,onEdgeDoubleClick:d,onNodeMouseEnter:s,onNodeMouseMove:p,onNodeMouseLeave:x,onNodeContextMenu:w,onSelectionContextMenu:j,onSelectionStart:S,onSelectionEnd:P,connectionLineType:F,connectionLineStyle:L,connectionLineComponent:B,connectionLineContainerStyle:V,selectionKeyCode:$,selectionOnDrag:G,selectionMode:W,multiSelectionKeyCode:Z,panActivationKeyCode:se,zoomActivationKeyCode:ae,deleteKeyCode:ce,onlyRenderVisibleElements:Pe,elementsSelectable:we,defaultViewport:xe,translateExtent:Ne,minZoom:ze,maxZoom:ye,preventScrolling:ve,defaultMarkerColor:_e,zoomOnScroll:Ee,zoomOnPinch:je,panOnScroll:Ce,panOnScrollSpeed:tt,panOnScrollMode:it,zoomOnDoubleClick:mt,panOnDrag:gt,onPaneClick:qt,onPaneMouseEnter:yr,onPaneMouseMove:tr,onPaneMouseLeave:Ft,onPaneScroll:er,onPaneContextMenu:Dt,paneClickDistance:ge,nodeClickDistance:sr,onEdgeContextMenu:St,onEdgeMouseEnter:jr,onEdgeMouseMove:dt,onEdgeMouseLeave:Yr,reconnectRadius:Vr,onReconnect:Yn,onReconnectStart:Ye,onReconnectEnd:Nt,noDragClassName:zt,noWheelClassName:Nr,noPanClassName:br,disableKeyboardA11y:hr,nodeExtent:rr,rfId:an,viewport:ai,onViewportChange:ri}){return jZ(e),jZ(t),xQe(),lQe(r),uQe(ai),n.jsx(OJe,{onPaneClick:qt,onPaneMouseEnter:yr,onPaneMouseMove:tr,onPaneMouseLeave:Ft,onPaneContextMenu:Dt,onPaneScroll:er,paneClickDistance:ge,deleteKeyCode:ce,selectionKeyCode:$,selectionOnDrag:G,selectionMode:W,onSelectionStart:S,onSelectionEnd:P,multiSelectionKeyCode:Z,panActivationKeyCode:se,zoomActivationKeyCode:ae,elementsSelectable:we,zoomOnScroll:Ee,zoomOnPinch:je,zoomOnDoubleClick:mt,panOnScroll:Ce,panOnScrollSpeed:tt,panOnScrollMode:it,panOnDrag:gt,defaultViewport:xe,translateExtent:Ne,minZoom:ze,maxZoom:ye,onSelectionContextMenu:j,preventScrolling:ve,noDragClassName:zt,noWheelClassName:Nr,noPanClassName:br,disableKeyboardA11y:hr,onViewportChange:ri,isControlledViewport:!!ai,children:n.jsxs(oQe,{children:[n.jsx(sQe,{edgeTypes:t,onEdgeClick:a,onEdgeDoubleClick:d,onReconnect:Yn,onReconnectStart:Ye,onReconnectEnd:Nt,onlyRenderVisibleElements:Pe,onEdgeContextMenu:St,onEdgeMouseEnter:jr,onEdgeMouseMove:dt,onEdgeMouseLeave:Yr,reconnectRadius:Vr,defaultMarkerColor:_e,noPanClassName:br,disableKeyboardA11y:hr,rfId:an}),n.jsx(pQe,{style:L,type:F,component:B,containerStyle:V}),n.jsx("div",{className:"react-flow__edgelabel-renderer"}),n.jsx(VJe,{nodeTypes:e,onNodeClick:i,onNodeDoubleClick:l,onNodeMouseEnter:s,onNodeMouseMove:p,onNodeMouseLeave:x,onNodeContextMenu:w,nodeClickDistance:sr,onlyRenderVisibleElements:Pe,noPanClassName:br,noDragClassName:zt,disableKeyboardA11y:hr,nodeExtent:rr,rfId:an}),n.jsx("div",{className:"react-flow__viewport-portal"})]})})}yle.displayName="GraphView";const yQe=U.memo(yle),NZ=({nodes:e,edges:t,defaultNodes:r,defaultEdges:i,width:a,height:l,fitView:d,fitViewOptions:s,minZoom:p=.5,maxZoom:x=2,nodeOrigin:w,nodeExtent:j}={})=>{const S=new Map,P=new Map,F=new Map,L=new Map,B=i??t??[],V=r??e??[],$=w??[0,0],G=j??uN;Toe(F,L,B);const W=Kz(V,S,P,{nodeOrigin:$,nodeExtent:G,elevateNodesOnSelect:!1});let Z=[0,0,1];if(d&&a&&l){const se=mS(S,{filter:we=>!!((we.width||we.initialWidth)&&(we.height||we.initialHeight))}),{x:ae,y:ce,zoom:Pe}=M6(se,a,l,p,x,(s==null?void 0:s.padding)??.1);Z=[ae,ce,Pe]}return{rfId:"1",width:0,height:0,transform:Z,nodes:V,nodesInitialized:W,nodeLookup:S,parentLookup:P,edges:B,edgeLookup:L,connectionLookup:F,onNodesChange:null,onEdgesChange:null,hasDefaultNodes:r!==void 0,hasDefaultEdges:i!==void 0,panZoom:null,minZoom:p,maxZoom:x,translateExtent:uN,nodeExtent:G,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionMode:Wb.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:$,nodeDragThreshold:1,connectionDragThreshold:1,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesReconnectable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,elevateEdgesOnSelect:!1,selectNodesOnDrag:!0,multiSelectionActive:!1,fitViewQueued:d??!1,fitViewOptions:s,fitViewResolver:null,connection:{...hoe},connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,autoPanOnNodeFocus:!0,autoPanSpeed:15,connectionRadius:20,onError:jYe,isValidConnection:void 0,onSelectionChangeHandlers:[],lib:"react",debug:!1,ariaLabelConfig:doe}},vQe=({nodes:e,edges:t,defaultNodes:r,defaultEdges:i,width:a,height:l,fitView:d,fitViewOptions:s,minZoom:p,maxZoom:x,nodeOrigin:w,nodeExtent:j})=>FXe((S,P)=>{async function F(){const{nodeLookup:L,panZoom:B,fitViewOptions:V,fitViewResolver:$,width:G,height:W,minZoom:Z,maxZoom:se}=P();B&&(await _Ye({nodes:L,width:G,height:W,panZoom:B,minZoom:Z,maxZoom:se},V),$==null||$.resolve(!0),S({fitViewResolver:null}))}return{...NZ({nodes:e,edges:t,width:a,height:l,fitView:d,fitViewOptions:s,minZoom:p,maxZoom:x,nodeOrigin:w,nodeExtent:j,defaultNodes:r,defaultEdges:i}),setNodes:L=>{const{nodeLookup:B,parentLookup:V,nodeOrigin:$,elevateNodesOnSelect:G,fitViewQueued:W}=P(),Z=Kz(L,B,V,{nodeOrigin:$,nodeExtent:j,elevateNodesOnSelect:G,checkEquality:!0});W&&Z?(F(),S({nodes:L,nodesInitialized:Z,fitViewQueued:!1,fitViewOptions:void 0})):S({nodes:L,nodesInitialized:Z})},setEdges:L=>{const{connectionLookup:B,edgeLookup:V}=P();Toe(B,V,L),S({edges:L})},setDefaultNodesAndEdges:(L,B)=>{if(L){const{setNodes:V}=P();V(L),S({hasDefaultNodes:!0})}if(B){const{setEdges:V}=P();V(B),S({hasDefaultEdges:!0})}},updateNodeInternals:L=>{const{triggerNodeChanges:B,nodeLookup:V,parentLookup:$,domNode:G,nodeOrigin:W,nodeExtent:Z,debug:se,fitViewQueued:ae}=P(),{changes:ce,updatedInternals:Pe}=VYe(L,V,$,G,W,Z);Pe&&(FYe(V,$,{nodeOrigin:W,nodeExtent:Z}),ae?(F(),S({fitViewQueued:!1,fitViewOptions:void 0})):S({}),(ce==null?void 0:ce.length)>0&&(se&&console.log("React Flow: trigger node changes",ce),B==null||B(ce)))},updateNodePositions:(L,B=!1)=>{const V=[],$=[],{nodeLookup:G,triggerNodeChanges:W}=P();for(const[Z,se]of L){const ae=G.get(Z),ce=!!(ae!=null&&ae.expandParent&&(ae!=null&&ae.parentId)&&(se!=null&&se.position)),Pe={id:Z,type:"position",position:ce?{x:Math.max(0,se.position.x),y:Math.max(0,se.position.y)}:se.position,dragging:B};ce&&ae.parentId&&V.push({id:Z,parentId:ae.parentId,rect:{...se.internals.positionAbsolute,width:se.measured.width??0,height:se.measured.height??0}}),$.push(Pe)}if(V.length>0){const{parentLookup:Z,nodeOrigin:se}=P(),ae=L6(V,G,Z,se);$.push(...ae)}W($)},triggerNodeChanges:L=>{const{onNodesChange:B,setNodes:V,nodes:$,hasDefaultNodes:G,debug:W}=P();if(L!=null&&L.length){if(G){const Z=Woe(L,$);V(Z)}W&&console.log("React Flow: trigger node changes",L),B==null||B(L)}},triggerEdgeChanges:L=>{const{onEdgesChange:B,setEdges:V,edges:$,hasDefaultEdges:G,debug:W}=P();if(L!=null&&L.length){if(G){const Z=Koe(L,$);V(Z)}W&&console.log("React Flow: trigger edge changes",L),B==null||B(L)}},addSelectedNodes:L=>{const{multiSelectionActive:B,edgeLookup:V,nodeLookup:$,triggerNodeChanges:G,triggerEdgeChanges:W}=P();if(B){const Z=L.map(se=>w0(se,!0));G(Z);return}G(Cv($,new Set([...L]),!0)),W(Cv(V))},addSelectedEdges:L=>{const{multiSelectionActive:B,edgeLookup:V,nodeLookup:$,triggerNodeChanges:G,triggerEdgeChanges:W}=P();if(B){const Z=L.map(se=>w0(se,!0));W(Z);return}W(Cv(V,new Set([...L]))),G(Cv($,new Set,!0))},unselectNodesAndEdges:({nodes:L,edges:B}={})=>{const{edges:V,nodes:$,nodeLookup:G,triggerNodeChanges:W,triggerEdgeChanges:Z}=P(),se=L||$,ae=B||V,ce=se.map(we=>{const xe=G.get(we.id);return xe&&(xe.selected=!1),w0(we.id,!1)}),Pe=ae.map(we=>w0(we.id,!1));W(ce),Z(Pe)},setMinZoom:L=>{const{panZoom:B,maxZoom:V}=P();B==null||B.setScaleExtent([L,V]),S({minZoom:L})},setMaxZoom:L=>{const{panZoom:B,minZoom:V}=P();B==null||B.setScaleExtent([V,L]),S({maxZoom:L})},setTranslateExtent:L=>{var B;(B=P().panZoom)==null||B.setTranslateExtent(L),S({translateExtent:L})},setPaneClickDistance:L=>{var B;(B=P().panZoom)==null||B.setClickDistance(L)},resetSelectedElements:()=>{const{edges:L,nodes:B,triggerNodeChanges:V,triggerEdgeChanges:$,elementsSelectable:G}=P();if(!G)return;const W=B.reduce((se,ae)=>ae.selected?[...se,w0(ae.id,!1)]:se,[]),Z=L.reduce((se,ae)=>ae.selected?[...se,w0(ae.id,!1)]:se,[]);V(W),$(Z)},setNodeExtent:L=>{const{nodes:B,nodeLookup:V,parentLookup:$,nodeOrigin:G,elevateNodesOnSelect:W,nodeExtent:Z}=P();L[0][0]===Z[0][0]&&L[0][1]===Z[0][1]&&L[1][0]===Z[1][0]&&L[1][1]===Z[1][1]||(Kz(B,V,$,{nodeOrigin:G,nodeExtent:L,elevateNodesOnSelect:W,checkEquality:!1}),S({nodeExtent:L}))},panBy:L=>{const{transform:B,width:V,height:$,panZoom:G,translateExtent:W}=P();return UYe({delta:L,panZoom:G,transform:B,translateExtent:W,width:V,height:$})},setCenter:async(L,B,V)=>{const{width:$,height:G,maxZoom:W,panZoom:Z}=P();if(!Z)return Promise.resolve(!1);const se=typeof(V==null?void 0:V.zoom)<"u"?V.zoom:W;return await Z.setViewport({x:$/2-L*se,y:G/2-B*se,zoom:se},{duration:V==null?void 0:V.duration,ease:V==null?void 0:V.ease,interpolate:V==null?void 0:V.interpolate}),Promise.resolve(!0)},cancelConnection:()=>{S({connection:{...hoe}})},updateConnection:L=>{S({connection:L})},reset:()=>S({...NZ()})}},Object.is);function bQe({initialNodes:e,initialEdges:t,defaultNodes:r,defaultEdges:i,initialWidth:a,initialHeight:l,initialMinZoom:d,initialMaxZoom:s,initialFitViewOptions:p,fitView:x,nodeOrigin:w,nodeExtent:j,children:S}){const[P]=U.useState(()=>vQe({nodes:e,edges:t,defaultNodes:r,defaultEdges:i,width:a,height:l,fitView:x,minZoom:d,maxZoom:s,fitViewOptions:p,nodeOrigin:w,nodeExtent:j}));return n.jsx(BXe,{value:P,children:n.jsx(cJe,{children:S})})}function _Qe({children:e,nodes:t,edges:r,defaultNodes:i,defaultEdges:a,width:l,height:d,fitView:s,fitViewOptions:p,minZoom:x,maxZoom:w,nodeOrigin:j,nodeExtent:S}){return U.useContext(ZM)?n.jsx(n.Fragment,{children:e}):n.jsx(bQe,{initialNodes:t,initialEdges:r,defaultNodes:i,defaultEdges:a,initialWidth:l,initialHeight:d,fitView:s,initialFitViewOptions:p,initialMinZoom:x,initialMaxZoom:w,nodeOrigin:j,nodeExtent:S,children:e})}const wQe={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0};function jQe({nodes:e,edges:t,defaultNodes:r,defaultEdges:i,className:a,nodeTypes:l,edgeTypes:d,onNodeClick:s,onEdgeClick:p,onInit:x,onMove:w,onMoveStart:j,onMoveEnd:S,onConnect:P,onConnectStart:F,onConnectEnd:L,onClickConnectStart:B,onClickConnectEnd:V,onNodeMouseEnter:$,onNodeMouseMove:G,onNodeMouseLeave:W,onNodeContextMenu:Z,onNodeDoubleClick:se,onNodeDragStart:ae,onNodeDrag:ce,onNodeDragStop:Pe,onNodesDelete:we,onEdgesDelete:xe,onDelete:Ne,onSelectionChange:ze,onSelectionDragStart:ye,onSelectionDrag:ve,onSelectionDragStop:_e,onSelectionContextMenu:Ee,onSelectionStart:je,onSelectionEnd:Ce,onBeforeDelete:tt,connectionMode:it,connectionLineType:mt=cp.Bezier,connectionLineStyle:gt,connectionLineComponent:qt,connectionLineContainerStyle:yr,deleteKeyCode:tr="Backspace",selectionKeyCode:Ft="Shift",selectionOnDrag:er=!1,selectionMode:Dt=dN.Full,panActivationKeyCode:ge="Space",multiSelectionKeyCode:sr=IP()?"Meta":"Control",zoomActivationKeyCode:St=IP()?"Meta":"Control",snapToGrid:jr,snapGrid:dt,onlyRenderVisibleElements:Yr=!1,selectNodesOnDrag:Vr,nodesDraggable:Yn,autoPanOnNodeFocus:Ye,nodesConnectable:Nt,nodesFocusable:zt,nodeOrigin:Nr=Hoe,edgesFocusable:br,edgesReconnectable:hr,elementsSelectable:rr=!0,defaultViewport:an=QXe,minZoom:ai=.5,maxZoom:ri=2,translateExtent:Ui=uN,preventScrolling:oa=!0,nodeExtent:Xs,defaultMarkerColor:rl="#b1b1b7",zoomOnScroll:Il=!0,zoomOnPinch:xo=!0,panOnScroll:nl=!1,panOnScrollSpeed:Vs=.5,panOnScrollMode:Ua=H0.Free,zoomOnDoubleClick:_i=!0,panOnDrag:Ir=!0,onPaneClick:wi,onPaneMouseEnter:gi,onPaneMouseMove:Ji,onPaneMouseLeave:la,onPaneScroll:Ol,onPaneContextMenu:Kc,paneClickDistance:Ih=0,nodeClickDistance:Hm=0,children:Oh,onReconnect:bt,onReconnectStart:pe,onReconnectEnd:be,onEdgeContextMenu:De,onEdgeDoubleClick:qe,onEdgeMouseEnter:Ue,onEdgeMouseMove:Xe,onEdgeMouseLeave:ht,reconnectRadius:et=10,onNodesChange:xt,onEdgesChange:wt,noDragClassName:vt="nodrag",noWheelClassName:$t="nowheel",noPanClassName:nr="nopan",fitView:or,fitViewOptions:Ur,connectOnClick:Jr,attributionPosition:Qr,proOptions:nn,defaultEdgeOptions:di,elevateNodesOnSelect:Ci,elevateEdgesOnSelect:hn,disableKeyboardA11y:Ln=!1,autoPanOnConnect:Wn,autoPanOnNodeDrag:Kn,autoPanSpeed:Qi,connectionRadius:Us,isValidConnection:ya,onError:Io,style:Ca,id:Ps,nodeDragThreshold:Js,connectionDragThreshold:Pd,viewport:Oo,onViewportChange:Rl,width:xg,height:qm,colorMode:Rh="light",debug:Ed,onScroll:Md,ariaLabelConfig:Px,...Ex},yg){const Zc=Ps||"1",yo=nJe(Rh),il=U.useCallback(oc=>{oc.currentTarget.scrollTo({top:0,left:0,behavior:"instant"}),Md==null||Md(oc)},[Md]);return n.jsx("div",{"data-testid":"rf__wrapper",...Ex,onScroll:il,style:{...Ca,...wQe},ref:yg,className:Va(["react-flow",a,yo]),id:Ps,role:"application",children:n.jsxs(_Qe,{nodes:e,edges:t,width:xg,height:qm,fitView:or,fitViewOptions:Ur,minZoom:ai,maxZoom:ri,nodeOrigin:Nr,nodeExtent:Xs,children:[n.jsx(yQe,{onInit:x,onNodeClick:s,onEdgeClick:p,onNodeMouseEnter:$,onNodeMouseMove:G,onNodeMouseLeave:W,onNodeContextMenu:Z,onNodeDoubleClick:se,nodeTypes:l,edgeTypes:d,connectionLineType:mt,connectionLineStyle:gt,connectionLineComponent:qt,connectionLineContainerStyle:yr,selectionKeyCode:Ft,selectionOnDrag:er,selectionMode:Dt,deleteKeyCode:tr,multiSelectionKeyCode:sr,panActivationKeyCode:ge,zoomActivationKeyCode:St,onlyRenderVisibleElements:Yr,defaultViewport:an,translateExtent:Ui,minZoom:ai,maxZoom:ri,preventScrolling:oa,zoomOnScroll:Il,zoomOnPinch:xo,zoomOnDoubleClick:_i,panOnScroll:nl,panOnScrollSpeed:Vs,panOnScrollMode:Ua,panOnDrag:Ir,onPaneClick:wi,onPaneMouseEnter:gi,onPaneMouseMove:Ji,onPaneMouseLeave:la,onPaneScroll:Ol,onPaneContextMenu:Kc,paneClickDistance:Ih,nodeClickDistance:Hm,onSelectionContextMenu:Ee,onSelectionStart:je,onSelectionEnd:Ce,onReconnect:bt,onReconnectStart:pe,onReconnectEnd:be,onEdgeContextMenu:De,onEdgeDoubleClick:qe,onEdgeMouseEnter:Ue,onEdgeMouseMove:Xe,onEdgeMouseLeave:ht,reconnectRadius:et,defaultMarkerColor:rl,noDragClassName:vt,noWheelClassName:$t,noPanClassName:nr,rfId:Zc,disableKeyboardA11y:Ln,nodeExtent:Xs,viewport:Oo,onViewportChange:Rl}),n.jsx(rJe,{nodes:e,edges:t,defaultNodes:r,defaultEdges:i,onConnect:P,onConnectStart:F,onConnectEnd:L,onClickConnectStart:B,onClickConnectEnd:V,nodesDraggable:Yn,autoPanOnNodeFocus:Ye,nodesConnectable:Nt,nodesFocusable:zt,edgesFocusable:br,edgesReconnectable:hr,elementsSelectable:rr,elevateNodesOnSelect:Ci,elevateEdgesOnSelect:hn,minZoom:ai,maxZoom:ri,nodeExtent:Xs,onNodesChange:xt,onEdgesChange:wt,snapToGrid:jr,snapGrid:dt,connectionMode:it,translateExtent:Ui,connectOnClick:Jr,defaultEdgeOptions:di,fitView:or,fitViewOptions:Ur,onNodesDelete:we,onEdgesDelete:xe,onDelete:Ne,onNodeDragStart:ae,onNodeDrag:ce,onNodeDragStop:Pe,onSelectionDrag:ve,onSelectionDragStart:ye,onSelectionDragStop:_e,onMove:w,onMoveStart:j,onMoveEnd:S,noPanClassName:nr,nodeOrigin:Nr,rfId:Zc,autoPanOnConnect:Wn,autoPanOnNodeDrag:Kn,autoPanSpeed:Qi,onError:Io,connectionRadius:Us,isValidConnection:ya,selectNodesOnDrag:Vr,nodeDragThreshold:Js,connectionDragThreshold:Pd,onBeforeDelete:tt,paneClickDistance:Ih,debug:Ed,ariaLabelConfig:Px}),n.jsx(JXe,{onSelectionChange:ze}),Oh,n.jsx(WXe,{proOptions:nn,position:Qr}),n.jsx(qXe,{rfId:Zc,disableKeyboardA11y:Ln})]})})}var JM=Zoe(jQe);const NQe=e=>{var t;return(t=e.domNode)==null?void 0:t.querySelector(".react-flow__edgelabel-renderer")};function SQe({children:e}){const t=Si(NQe);return t?tg.createPortal(e,t):null}function QM(e){const[t,r]=U.useState(e),i=U.useCallback(a=>r(l=>Woe(a,l)),[]);return[t,r,i]}function e3(e){const[t,r]=U.useState(e),i=U.useCallback(a=>r(l=>Koe(a,l)),[]);return[t,r,i]}function CQe({dimensions:e,lineWidth:t,variant:r,className:i}){return n.jsx("path",{strokeWidth:t,d:`M${e[0]/2} 0 V${e[1]} M0 ${e[1]/2} H${e[0]}`,className:Va(["react-flow__background-pattern",r,i])})}function AQe({radius:e,className:t}){return n.jsx("circle",{cx:e,cy:e,r:e,className:Va(["react-flow__background-pattern","dots",t])})}var Lp;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(Lp||(Lp={}));const TQe={[Lp.Dots]:1,[Lp.Lines]:1,[Lp.Cross]:6},kQe=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function vle({id:e,variant:t=Lp.Dots,gap:r=20,size:i,lineWidth:a=1,offset:l=0,color:d,bgColor:s,style:p,className:x,patternClassName:w}){const j=U.useRef(null),{transform:S,patternId:P}=Si(kQe,aa),F=i||TQe[t],L=t===Lp.Dots,B=t===Lp.Cross,V=Array.isArray(r)?r:[r,r],$=[V[0]*S[2]||1,V[1]*S[2]||1],G=F*S[2],W=Array.isArray(l)?l:[l,l],Z=B?[G,G]:$,se=[W[0]*S[2]||1+Z[0]/2,W[1]*S[2]||1+Z[1]/2],ae=`${P}${e||""}`;return n.jsxs("svg",{className:Va(["react-flow__background",x]),style:{...p,...XM,"--xy-background-color-props":s,"--xy-background-pattern-color-props":d},ref:j,"data-testid":"rf__background",children:[n.jsx("pattern",{id:ae,x:S[0]%$[0],y:S[1]%$[1],width:$[0],height:$[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${se[0]},-${se[1]})`,children:L?n.jsx(AQe,{radius:G/2,className:w}):n.jsx(CQe,{dimensions:Z,lineWidth:a,variant:t,className:w})}),n.jsx("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${ae})`})]})}vle.displayName="Background";const t3=U.memo(vle);function PQe(){return n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:n.jsx("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"})})}function EQe(){return n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5",children:n.jsx("path",{d:"M0 0h32v4.2H0z"})})}function MQe(){return n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30",children:n.jsx("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"})})}function IQe(){return n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:n.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"})})}function OQe(){return n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:n.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"})})}function aT({children:e,className:t,...r}){return n.jsx("button",{type:"button",className:Va(["react-flow__controls-button",t]),...r,children:e})}const RQe=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom,ariaLabelConfig:e.ariaLabelConfig});function ble({style:e,showZoom:t=!0,showFitView:r=!0,showInteractive:i=!0,fitViewOptions:a,onZoomIn:l,onZoomOut:d,onFitView:s,onInteractiveChange:p,className:x,children:w,position:j="bottom-left",orientation:S="vertical","aria-label":P}){const F=Ys(),{isInteractive:L,minZoomReached:B,maxZoomReached:V,ariaLabelConfig:$}=Si(RQe,aa),{zoomIn:G,zoomOut:W,fitView:Z}=F6(),se=()=>{G(),l==null||l()},ae=()=>{W(),d==null||d()},ce=()=>{Z(a),s==null||s()},Pe=()=>{F.setState({nodesDraggable:!L,nodesConnectable:!L,elementsSelectable:!L}),p==null||p(!L)},we=S==="horizontal"?"horizontal":"vertical";return n.jsxs(YM,{className:Va(["react-flow__controls",we,x]),position:j,style:e,"data-testid":"rf__controls","aria-label":P??$["controls.ariaLabel"],children:[t&&n.jsxs(n.Fragment,{children:[n.jsx(aT,{onClick:se,className:"react-flow__controls-zoomin",title:$["controls.zoomIn.ariaLabel"],"aria-label":$["controls.zoomIn.ariaLabel"],disabled:V,children:n.jsx(PQe,{})}),n.jsx(aT,{onClick:ae,className:"react-flow__controls-zoomout",title:$["controls.zoomOut.ariaLabel"],"aria-label":$["controls.zoomOut.ariaLabel"],disabled:B,children:n.jsx(EQe,{})})]}),r&&n.jsx(aT,{className:"react-flow__controls-fitview",onClick:ce,title:$["controls.fitView.ariaLabel"],"aria-label":$["controls.fitView.ariaLabel"],children:n.jsx(MQe,{})}),i&&n.jsx(aT,{className:"react-flow__controls-interactive",onClick:Pe,title:$["controls.interactive.ariaLabel"],"aria-label":$["controls.interactive.ariaLabel"],children:L?n.jsx(OQe,{}):n.jsx(IQe,{})}),w]})}ble.displayName="Controls";const r3=U.memo(ble);function DQe({id:e,x:t,y:r,width:i,height:a,style:l,color:d,strokeColor:s,strokeWidth:p,className:x,borderRadius:w,shapeRendering:j,selected:S,onClick:P}){const{background:F,backgroundColor:L}=l||{},B=d||F||L;return n.jsx("rect",{className:Va(["react-flow__minimap-node",{selected:S},x]),x:t,y:r,rx:w,ry:w,width:i,height:a,style:{fill:B,stroke:s,strokeWidth:p},shapeRendering:j,onClick:P?V=>P(V,e):void 0})}const zQe=U.memo(DQe),LQe=e=>e.nodes.map(t=>t.id),sR=e=>e instanceof Function?e:()=>e;function FQe({nodeStrokeColor:e,nodeColor:t,nodeClassName:r="",nodeBorderRadius:i=5,nodeStrokeWidth:a,nodeComponent:l=zQe,onClick:d}){const s=Si(LQe,aa),p=sR(t),x=sR(e),w=sR(r),j=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return n.jsx(n.Fragment,{children:s.map(S=>n.jsx($Qe,{id:S,nodeColorFunc:p,nodeStrokeColorFunc:x,nodeClassNameFunc:w,nodeBorderRadius:i,nodeStrokeWidth:a,NodeComponent:l,onClick:d,shapeRendering:j},S))})}function BQe({id:e,nodeColorFunc:t,nodeStrokeColorFunc:r,nodeClassNameFunc:i,nodeBorderRadius:a,nodeStrokeWidth:l,shapeRendering:d,NodeComponent:s,onClick:p}){const{node:x,x:w,y:j,width:S,height:P}=Si(F=>{const{internals:L}=F.nodeLookup.get(e),B=L.userNode,{x:V,y:$}=L.positionAbsolute,{width:G,height:W}=Vm(B);return{node:B,x:V,y:$,width:G,height:W}},aa);return!x||x.hidden||!voe(x)?null:n.jsx(s,{x:w,y:j,width:S,height:P,style:x.style,selected:!!x.selected,className:i(x),color:t(x),borderRadius:a,strokeColor:r(x),strokeWidth:l,shapeRendering:d,onClick:p,id:x.id})}const $Qe=U.memo(BQe);var VQe=U.memo(FQe);const UQe=200,GQe=150,HQe=e=>!e.hidden,qQe=e=>{const t={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:t,boundingRect:e.nodeLookup.size>0?yoe(mS(e.nodeLookup,{filter:HQe}),t):t,rfId:e.rfId,panZoom:e.panZoom,translateExtent:e.translateExtent,flowWidth:e.width,flowHeight:e.height,ariaLabelConfig:e.ariaLabelConfig}},WQe="react-flow__minimap-desc";function _le({style:e,className:t,nodeStrokeColor:r,nodeColor:i,nodeClassName:a="",nodeBorderRadius:l=5,nodeStrokeWidth:d,nodeComponent:s,bgColor:p,maskColor:x,maskStrokeColor:w,maskStrokeWidth:j,position:S="bottom-right",onClick:P,onNodeClick:F,pannable:L=!1,zoomable:B=!1,ariaLabel:V,inversePan:$,zoomStep:G=10,offsetScale:W=5}){const Z=Ys(),se=U.useRef(null),{boundingRect:ae,viewBB:ce,rfId:Pe,panZoom:we,translateExtent:xe,flowWidth:Ne,flowHeight:ze,ariaLabelConfig:ye}=Si(qQe,aa),ve=(e==null?void 0:e.width)??UQe,_e=(e==null?void 0:e.height)??GQe,Ee=ae.width/ve,je=ae.height/_e,Ce=Math.max(Ee,je),tt=Ce*ve,it=Ce*_e,mt=W*Ce,gt=ae.x-(tt-ae.width)/2-mt,qt=ae.y-(it-ae.height)/2-mt,yr=tt+mt*2,tr=it+mt*2,Ft=`${WQe}-${Pe}`,er=U.useRef(0),Dt=U.useRef();er.current=Ce,U.useEffect(()=>{if(se.current&&we)return Dt.current=XYe({domNode:se.current,panZoom:we,getTransform:()=>Z.getState().transform,getViewScale:()=>er.current}),()=>{var jr;(jr=Dt.current)==null||jr.destroy()}},[we]),U.useEffect(()=>{var jr;(jr=Dt.current)==null||jr.update({translateExtent:xe,width:Ne,height:ze,inversePan:$,pannable:L,zoomStep:G,zoomable:B})},[L,B,$,G,xe,Ne,ze]);const ge=P?jr=>{var Vr;const[dt,Yr]=((Vr=Dt.current)==null?void 0:Vr.pointer(jr))||[0,0];P(jr,{x:dt,y:Yr})}:void 0,sr=F?U.useCallback((jr,dt)=>{const Yr=Z.getState().nodeLookup.get(dt).internals.userNode;F(jr,Yr)},[]):void 0,St=V??ye["minimap.ariaLabel"];return n.jsx(YM,{position:S,style:{...e,"--xy-minimap-background-color-props":typeof p=="string"?p:void 0,"--xy-minimap-mask-background-color-props":typeof x=="string"?x:void 0,"--xy-minimap-mask-stroke-color-props":typeof w=="string"?w:void 0,"--xy-minimap-mask-stroke-width-props":typeof j=="number"?j*Ce:void 0,"--xy-minimap-node-background-color-props":typeof i=="string"?i:void 0,"--xy-minimap-node-stroke-color-props":typeof r=="string"?r:void 0,"--xy-minimap-node-stroke-width-props":typeof d=="number"?d:void 0},className:Va(["react-flow__minimap",t]),"data-testid":"rf__minimap",children:n.jsxs("svg",{width:ve,height:_e,viewBox:`${gt} ${qt} ${yr} ${tr}`,className:"react-flow__minimap-svg",role:"img","aria-labelledby":Ft,ref:se,onClick:ge,children:[St&&n.jsx("title",{id:Ft,children:St}),n.jsx(VQe,{onClick:sr,nodeColor:i,nodeStrokeColor:r,nodeBorderRadius:l,nodeClassName:a,nodeStrokeWidth:d,nodeComponent:s}),n.jsx("path",{className:"react-flow__minimap-mask",d:`M${gt-mt},${qt-mt}h${yr+mt*2}v${tr+mt*2}h${-yr-mt*2}z
        M${ce.x},${ce.y}h${ce.width}v${ce.height}h${-ce.width}z`,fillRule:"evenodd",pointerEvents:"none"})]})})}_le.displayName="MiniMap";const n3=U.memo(_le),KQe=e=>t=>e?`${Math.max(1/t.transform[2],1)}`:void 0,ZQe={[Xb.Line]:"right",[Xb.Handle]:"bottom-right"};function YQe({nodeId:e,position:t,variant:r=Xb.Handle,className:i,style:a=void 0,children:l,color:d,minWidth:s=10,minHeight:p=10,maxWidth:x=Number.MAX_VALUE,maxHeight:w=Number.MAX_VALUE,keepAspectRatio:j=!1,resizeDirection:S,autoScale:P=!0,shouldResize:F,onResizeStart:L,onResize:B,onResizeEnd:V}){const $=Qoe(),G=typeof e=="string"?e:$,W=Ys(),Z=U.useRef(null),se=r===Xb.Handle,ae=Si(U.useCallback(KQe(se&&P),[se,P]),aa),ce=U.useRef(null),Pe=t??ZQe[r];U.useEffect(()=>{if(!(!Z.current||!G))return ce.current||(ce.current=mXe({domNode:Z.current,nodeId:G,getStoreItems:()=>{const{nodeLookup:xe,transform:Ne,snapGrid:ze,snapToGrid:ye,nodeOrigin:ve,domNode:_e}=W.getState();return{nodeLookup:xe,transform:Ne,snapGrid:ze,snapToGrid:ye,nodeOrigin:ve,paneDomNode:_e}},onChange:(xe,Ne)=>{const{triggerNodeChanges:ze,nodeLookup:ye,parentLookup:ve,nodeOrigin:_e}=W.getState(),Ee=[],je={x:xe.x,y:xe.y},Ce=ye.get(G);if(Ce&&Ce.expandParent&&Ce.parentId){const tt=Ce.origin??_e,it=xe.width??Ce.measured.width??0,mt=xe.height??Ce.measured.height??0,gt={id:Ce.id,parentId:Ce.parentId,rect:{width:it,height:mt,...boe({x:xe.x??Ce.position.x,y:xe.y??Ce.position.y},{width:it,height:mt},Ce.parentId,ye,tt)}},qt=L6([gt],ye,ve,_e);Ee.push(...qt),je.x=xe.x?Math.max(tt[0]*it,xe.x):void 0,je.y=xe.y?Math.max(tt[1]*mt,xe.y):void 0}if(je.x!==void 0&&je.y!==void 0){const tt={id:G,type:"position",position:{...je}};Ee.push(tt)}if(xe.width!==void 0&&xe.height!==void 0){const it={id:G,type:"dimensions",resizing:!0,setAttributes:S?S==="horizontal"?"width":"height":!0,dimensions:{width:xe.width,height:xe.height}};Ee.push(it)}for(const tt of Ne){const it={...tt,type:"position"};Ee.push(it)}ze(Ee)},onEnd:({width:xe,height:Ne})=>{const ze={id:G,type:"dimensions",resizing:!1,dimensions:{width:xe,height:Ne}};W.getState().triggerNodeChanges([ze])}})),ce.current.update({controlPosition:Pe,boundaries:{minWidth:s,minHeight:p,maxWidth:x,maxHeight:w},keepAspectRatio:j,resizeDirection:S,onResizeStart:L,onResize:B,onResizeEnd:V,shouldResize:F}),()=>{var xe;(xe=ce.current)==null||xe.destroy()}},[Pe,s,p,x,w,j,L,B,V,F]);const we=Pe.split("-");return n.jsx("div",{className:Va(["react-flow__resize-control","nodrag",...we,r,i]),ref:Z,style:{...a,scale:ae,...d&&{[se?"backgroundColor":"borderColor"]:d}},children:l})}U.memo(YQe);const i3=()=>n.jsxs("div",{className:"h-10 bg-slate-800/40 backdrop-blur-sm border-b border-slate-600/30 flex items-center justify-between px-3 shadow-sm",children:[n.jsx("div",{className:"flex items-center gap-3",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"p-1.5 bg-gradient-to-br from-cyan-400 to-purple-500 rounded-lg",children:n.jsx(p_,{className:"h-3 w-3 text-white"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-sm font-bold text-slate-100",children:"Multi Agent Workspace"}),n.jsx("p",{className:"text-[10px] text-slate-400",children:"Banking workflows"})]})]})}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs(lt,{variant:"outline",size:"sm",className:"h-7 px-2 bg-slate-800/40 backdrop-blur-sm border-slate-600/30 text-slate-300 hover:bg-slate-700/50 text-xs",children:[n.jsx(LQ,{className:"h-3 w-3 mr-1"}),"Save"]}),n.jsxs(lt,{variant:"outline",size:"sm",className:"h-7 px-2 bg-slate-800/40 backdrop-blur-sm border-slate-600/30 text-slate-300 hover:bg-slate-700/50 text-xs",children:[n.jsx(FQ,{className:"h-3 w-3 mr-1"}),"Share"]}),n.jsxs(lt,{size:"sm",className:"h-7 px-2 bg-gradient-to-r from-cyan-500 to-purple-500 hover:from-cyan-400 hover:to-purple-400 text-white shadow-lg text-xs",children:[n.jsx($Q,{className:"h-3 w-3 mr-1"}),"Deploy"]})]})]}),XQe=()=>{const[e,t]=U.useState(!1),r=[{name:"AI Market Research Agent",icon:$c,description:"Continuously scans global markets, news, and economic indicators",status:"active",color:"text-green-400",bgColor:"bg-green-900/20",borderColor:"border-green-700/30",model:"GPT-4o + Web Research",capabilities:["Real-time News Analysis","Economic Data Mining","Sentiment Analysis","Risk Detection"]},{name:"Predictive Trend Analyzer",icon:to,description:"Uses machine learning to identify market patterns and predict future trends",status:"analyzing",color:"text-blue-400",bgColor:"bg-blue-900/20",borderColor:"border-blue-700/30",model:"Claude 3 Opus + ML Models",capabilities:["Pattern Recognition","Predictive Analytics","Cross-Asset Analysis","Volatility Forecasting"]},{name:"Personalized Investment Advisor",icon:En,description:"Analyzes complete financial profile and generates personalized recommendations",status:"active",color:"text-purple-400",bgColor:"bg-purple-900/20",borderColor:"border-purple-700/30",model:"GPT-4o",capabilities:["Portfolio Analysis","Risk Assessment","Tax Optimization","Goal-Based Planning"]},{name:"AI Risk Sentinel",icon:dn,description:"Advanced risk monitoring system that analyzes global events",status:"monitoring",color:"text-amber-400",bgColor:"bg-amber-900/20",borderColor:"border-amber-700/30",model:"Claude 3 Opus + Risk Models",capabilities:["Geopolitical Analysis","Correlation Monitoring","Stress Testing","Black Swan Detection"]},{name:"Web Intelligence Aggregator",icon:Zs,description:"Crawls financial websites, forums, and social media for market intelligence",status:"active",color:"text-cyan-400",bgColor:"bg-cyan-900/20",borderColor:"border-cyan-700/30",model:"GPT-4o + Web Crawling",capabilities:["Social Sentiment","Forum Analysis","Insider Tracking","Regulatory Monitoring"]},{name:"Proactive Wealth Optimizer",icon:bs,description:"Monitors overall financial health and identifies optimization opportunities",status:"optimizing",color:"text-green-500",bgColor:"bg-green-900/20",borderColor:"border-green-700/30",model:"GPT-4 Turbo",capabilities:["Multi-Account Analysis","Tax Loss Harvesting","Rebalancing","Cash Management"]}],i=a=>{switch(a){case"active":return n.jsx(Tt,{className:"bg-green-900/20 text-green-300 border-green-700/30",children:"Active"});case"monitoring":return n.jsx(Tt,{className:"bg-blue-900/20 text-blue-300 border-blue-700/30",children:"Monitoring"});case"analyzing":return n.jsx(Tt,{className:"bg-purple-900/20 text-purple-300 border-purple-700/30",children:"Analyzing"});case"optimizing":return n.jsx(Tt,{className:"bg-amber-900/20 text-amber-300 border-amber-700/30",children:"Optimizing"});default:return n.jsx(Tt,{variant:"outline",children:"Inactive"})}};return e?n.jsx("div",{className:"w-12 bg-slate-800/40 backdrop-blur-lg border-r border-purple-400/20 p-2",children:n.jsx("button",{onClick:()=>t(!1),className:"w-full p-2 text-purple-400 hover:text-white transition-colors rounded",children:n.jsx(ti,{className:"h-5 w-5"})})}):n.jsxs("div",{className:"w-80 bg-slate-800/40 backdrop-blur-lg border-r border-purple-400/20 flex flex-col",children:[n.jsxs("div",{className:"p-4 border-b border-purple-400/20",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ti,{className:"h-5 w-5 text-purple-400"}),n.jsx("h2",{className:"text-lg font-semibold text-white",children:"Wealth Agents"})]}),n.jsx("button",{onClick:()=>t(!0),className:"text-purple-400 hover:text-white transition-colors",children:"←"})]}),n.jsx("p",{className:"text-sm text-purple-300/70 mt-1",children:"AI agents managing your wealth"})]}),n.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:r.map(a=>{const l=a.icon;return n.jsxs(jt,{className:`p-3 bg-slate-800/30 border ${a.borderColor} hover:border-purple-400/50 transition-all duration-200 hover:shadow-lg cursor-default`,children:[n.jsx("div",{className:"flex items-start justify-between mb-2",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("div",{className:`p-2 rounded-lg ${a.bgColor} relative`,children:[n.jsx(l,{className:`h-4 w-4 ${a.color}`}),a.status==="active"&&n.jsx("div",{className:"absolute -top-1 -right-1 h-3 w-3 bg-green-500 rounded-full animate-pulse"})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-white text-xs",children:a.name}),i(a.status)]})]})}),n.jsx("p",{className:"text-slate-400 text-xs mb-2",children:a.description}),n.jsxs("div",{className:"text-xs text-slate-500 mb-2",children:["Model: ",n.jsx("span",{className:"text-slate-300",children:a.model})]}),n.jsxs("div",{className:"flex flex-wrap gap-1",children:[a.capabilities.slice(0,2).map((d,s)=>n.jsx(Tt,{variant:"outline",className:"text-xs py-0 px-1 border-slate-600 text-slate-400",children:d},s)),a.capabilities.length>2&&n.jsxs(Tt,{variant:"outline",className:"text-xs py-0 px-1 border-slate-600 text-slate-400",children:["+",a.capabilities.length-2]})]})]},a.name)})}),n.jsx("div",{className:"p-4 border-t border-purple-400/20",children:n.jsxs("div",{className:"text-xs text-slate-400 space-y-1",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{children:"Active Agents:"}),n.jsx("span",{className:"text-green-400",children:"6/6"})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{children:"Workflow Status:"}),n.jsx("span",{className:"text-purple-400",children:"Running"})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{children:"Performance:"}),n.jsx("span",{className:"text-blue-400",children:"96%"})]})]})})]})};var JQe="Label",wle=U.forwardRef((e,t)=>n.jsx(Hr.label,{...e,ref:t,onMouseDown:r=>{var a;r.target.closest("button, input, select, textarea")||((a=e.onMouseDown)==null||a.call(e,r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));wle.displayName=JQe;var jle=wle;const QQe=rg("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),mr=U.forwardRef(({className:e,...t},r)=>n.jsx(jle,{ref:r,className:Yt(QQe(),e),...t}));mr.displayName=jle.displayName;const po=U.forwardRef(({className:e,...t},r)=>n.jsx("textarea",{className:Yt("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:r,...t}));po.displayName="Textarea";function pN(e,[t,r]){return Math.min(r,Math.max(t,e))}function s3(e){const t=U.useRef({value:e,previous:e});return U.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var eet=[" ","Enter","ArrowUp","ArrowDown"],tet=[" ","Enter"],xS="Select",[a3,o3,ret]=d_(xS),[L_,aft]=Jo(xS,[ret,ig]),l3=ig(),[net,dg]=L_(xS),[iet,set]=L_(xS),Nle=e=>{const{__scopeSelect:t,children:r,open:i,defaultOpen:a,onOpenChange:l,value:d,defaultValue:s,onValueChange:p,dir:x,name:w,autoComplete:j,disabled:S,required:P,form:F}=e,L=l3(t),[B,V]=U.useState(null),[$,G]=U.useState(null),[W,Z]=U.useState(!1),se=sg(x),[ae=!1,ce]=fo({prop:i,defaultProp:a,onChange:l}),[Pe,we]=fo({prop:d,defaultProp:s,onChange:p}),xe=U.useRef(null),Ne=B?F||!!B.closest("form"):!0,[ze,ye]=U.useState(new Set),ve=Array.from(ze).map(_e=>_e.props.value).join(";");return n.jsx(kE,{...L,children:n.jsxs(net,{required:P,scope:t,trigger:B,onTriggerChange:V,valueNode:$,onValueNodeChange:G,valueNodeHasChildren:W,onValueNodeHasChildrenChange:Z,contentId:rc(),value:Pe,onValueChange:we,open:ae,onOpenChange:ce,dir:se,triggerPointerDownPosRef:xe,disabled:S,children:[n.jsx(a3.Provider,{scope:t,children:n.jsx(iet,{scope:e.__scopeSelect,onNativeOptionAdd:U.useCallback(_e=>{ye(Ee=>new Set(Ee).add(_e))},[]),onNativeOptionRemove:U.useCallback(_e=>{ye(Ee=>{const je=new Set(Ee);return je.delete(_e),je})},[]),children:r})}),Ne?n.jsxs(Zle,{"aria-hidden":!0,required:P,tabIndex:-1,name:w,autoComplete:j,value:Pe,onChange:_e=>we(_e.target.value),disabled:S,form:F,children:[Pe===void 0?n.jsx("option",{value:""}):null,Array.from(ze)]},ve):null]})})};Nle.displayName=xS;var Sle="SelectTrigger",Cle=U.forwardRef((e,t)=>{const{__scopeSelect:r,disabled:i=!1,...a}=e,l=l3(r),d=dg(Sle,r),s=d.disabled||i,p=Mn(t,d.onTriggerChange),x=o3(r),w=U.useRef("touch"),[j,S,P]=Yle(L=>{const B=x().filter(G=>!G.disabled),V=B.find(G=>G.value===d.value),$=Xle(B,L,V);$!==void 0&&d.onValueChange($.value)}),F=L=>{s||(d.onOpenChange(!0),P()),L&&(d.triggerPointerDownPosRef.current={x:Math.round(L.pageX),y:Math.round(L.pageY)})};return n.jsx(UN,{asChild:!0,...l,children:n.jsx(Hr.button,{type:"button",role:"combobox","aria-controls":d.contentId,"aria-expanded":d.open,"aria-required":d.required,"aria-autocomplete":"none",dir:d.dir,"data-state":d.open?"open":"closed",disabled:s,"data-disabled":s?"":void 0,"data-placeholder":Kle(d.value)?"":void 0,...a,ref:p,onClick:_r(a.onClick,L=>{L.currentTarget.focus(),w.current!=="mouse"&&F(L)}),onPointerDown:_r(a.onPointerDown,L=>{w.current=L.pointerType;const B=L.target;B.hasPointerCapture(L.pointerId)&&B.releasePointerCapture(L.pointerId),L.button===0&&L.ctrlKey===!1&&L.pointerType==="mouse"&&(F(L),L.preventDefault())}),onKeyDown:_r(a.onKeyDown,L=>{const B=j.current!=="";!(L.ctrlKey||L.altKey||L.metaKey)&&L.key.length===1&&S(L.key),!(B&&L.key===" ")&&eet.includes(L.key)&&(F(),L.preventDefault())})})})});Cle.displayName=Sle;var Ale="SelectValue",Tle=U.forwardRef((e,t)=>{const{__scopeSelect:r,className:i,style:a,children:l,placeholder:d="",...s}=e,p=dg(Ale,r),{onValueNodeHasChildrenChange:x}=p,w=l!==void 0,j=Mn(t,p.onValueNodeChange);return Ba(()=>{x(w)},[x,w]),n.jsx(Hr.span,{...s,ref:j,style:{pointerEvents:"none"},children:Kle(p.value)?n.jsx(n.Fragment,{children:d}):l})});Tle.displayName=Ale;var aet="SelectIcon",kle=U.forwardRef((e,t)=>{const{__scopeSelect:r,children:i,...a}=e;return n.jsx(Hr.span,{"aria-hidden":!0,...a,ref:t,children:i||"▼"})});kle.displayName=aet;var oet="SelectPortal",Ple=e=>n.jsx(h_,{asChild:!0,...e});Ple.displayName=oet;var dx="SelectContent",Ele=U.forwardRef((e,t)=>{const r=dg(dx,e.__scopeSelect),[i,a]=U.useState();if(Ba(()=>{a(new DocumentFragment)},[]),!r.open){const l=i;return l?tg.createPortal(n.jsx(Mle,{scope:e.__scopeSelect,children:n.jsx(a3.Slot,{scope:e.__scopeSelect,children:n.jsx("div",{children:e.children})})}),l):null}return n.jsx(Ile,{...e,ref:t})});Ele.displayName=dx;var ed=10,[Mle,hg]=L_(dx),cet="SelectContentImpl",Ile=U.forwardRef((e,t)=>{const{__scopeSelect:r,position:i="item-aligned",onCloseAutoFocus:a,onEscapeKeyDown:l,onPointerDownOutside:d,side:s,sideOffset:p,align:x,alignOffset:w,arrowPadding:j,collisionBoundary:S,collisionPadding:P,sticky:F,hideWhenDetached:L,avoidCollisions:B,...V}=e,$=dg(dx,r),[G,W]=U.useState(null),[Z,se]=U.useState(null),ae=Mn(t,Ft=>W(Ft)),[ce,Pe]=U.useState(null),[we,xe]=U.useState(null),Ne=o3(r),[ze,ye]=U.useState(!1),ve=U.useRef(!1);U.useEffect(()=>{if(G)return $E(G)},[G]),FE();const _e=U.useCallback(Ft=>{const[er,...Dt]=Ne().map(St=>St.ref.current),[ge]=Dt.slice(-1),sr=document.activeElement;for(const St of Ft)if(St===sr||(St==null||St.scrollIntoView({block:"nearest"}),St===er&&Z&&(Z.scrollTop=0),St===ge&&Z&&(Z.scrollTop=Z.scrollHeight),St==null||St.focus(),document.activeElement!==sr))return},[Ne,Z]),Ee=U.useCallback(()=>_e([ce,G]),[_e,ce,G]);U.useEffect(()=>{ze&&Ee()},[ze,Ee]);const{onOpenChange:je,triggerPointerDownPosRef:Ce}=$;U.useEffect(()=>{if(G){let Ft={x:0,y:0};const er=ge=>{var sr,St;Ft={x:Math.abs(Math.round(ge.pageX)-(((sr=Ce.current)==null?void 0:sr.x)??0)),y:Math.abs(Math.round(ge.pageY)-(((St=Ce.current)==null?void 0:St.y)??0))}},Dt=ge=>{Ft.x<=10&&Ft.y<=10?ge.preventDefault():G.contains(ge.target)||je(!1),document.removeEventListener("pointermove",er),Ce.current=null};return Ce.current!==null&&(document.addEventListener("pointermove",er),document.addEventListener("pointerup",Dt,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",er),document.removeEventListener("pointerup",Dt,{capture:!0})}}},[G,je,Ce]),U.useEffect(()=>{const Ft=()=>je(!1);return window.addEventListener("blur",Ft),window.addEventListener("resize",Ft),()=>{window.removeEventListener("blur",Ft),window.removeEventListener("resize",Ft)}},[je]);const[tt,it]=Yle(Ft=>{const er=Ne().filter(sr=>!sr.disabled),Dt=er.find(sr=>sr.ref.current===document.activeElement),ge=Xle(er,Ft,Dt);ge&&setTimeout(()=>ge.ref.current.focus())}),mt=U.useCallback((Ft,er,Dt)=>{const ge=!ve.current&&!Dt;($.value!==void 0&&$.value===er||ge)&&(Pe(Ft),ge&&(ve.current=!0))},[$.value]),gt=U.useCallback(()=>G==null?void 0:G.focus(),[G]),qt=U.useCallback((Ft,er,Dt)=>{const ge=!ve.current&&!Dt;($.value!==void 0&&$.value===er||ge)&&xe(Ft)},[$.value]),yr=i==="popper"?Xz:Ole,tr=yr===Xz?{side:s,sideOffset:p,align:x,alignOffset:w,arrowPadding:j,collisionBoundary:S,collisionPadding:P,sticky:F,hideWhenDetached:L,avoidCollisions:B}:{};return n.jsx(Mle,{scope:r,content:G,viewport:Z,onViewportChange:se,itemRefCallback:mt,selectedItem:ce,onItemLeave:gt,itemTextRefCallback:qt,focusSelectedItem:Ee,selectedItemText:we,position:i,isPositioned:ze,searchRef:tt,children:n.jsx(KN,{as:Al,allowPinchZoom:!0,children:n.jsx(WN,{asChild:!0,trapped:$.open,onMountAutoFocus:Ft=>{Ft.preventDefault()},onUnmountAutoFocus:_r(a,Ft=>{var er;(er=$.trigger)==null||er.focus({preventScroll:!0}),Ft.preventDefault()}),children:n.jsx(yx,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:l,onPointerDownOutside:d,onFocusOutside:Ft=>Ft.preventDefault(),onDismiss:()=>$.onOpenChange(!1),children:n.jsx(yr,{role:"listbox",id:$.contentId,"data-state":$.open?"open":"closed",dir:$.dir,onContextMenu:Ft=>Ft.preventDefault(),...V,...tr,onPlaced:()=>ye(!0),ref:ae,style:{display:"flex",flexDirection:"column",outline:"none",...V.style},onKeyDown:_r(V.onKeyDown,Ft=>{const er=Ft.ctrlKey||Ft.altKey||Ft.metaKey;if(Ft.key==="Tab"&&Ft.preventDefault(),!er&&Ft.key.length===1&&it(Ft.key),["ArrowUp","ArrowDown","Home","End"].includes(Ft.key)){let ge=Ne().filter(sr=>!sr.disabled).map(sr=>sr.ref.current);if(["ArrowUp","End"].includes(Ft.key)&&(ge=ge.slice().reverse()),["ArrowUp","ArrowDown"].includes(Ft.key)){const sr=Ft.target,St=ge.indexOf(sr);ge=ge.slice(St+1)}setTimeout(()=>_e(ge)),Ft.preventDefault()}})})})})})})});Ile.displayName=cet;var uet="SelectItemAlignedPosition",Ole=U.forwardRef((e,t)=>{const{__scopeSelect:r,onPlaced:i,...a}=e,l=dg(dx,r),d=hg(dx,r),[s,p]=U.useState(null),[x,w]=U.useState(null),j=Mn(t,ae=>w(ae)),S=o3(r),P=U.useRef(!1),F=U.useRef(!0),{viewport:L,selectedItem:B,selectedItemText:V,focusSelectedItem:$}=d,G=U.useCallback(()=>{if(l.trigger&&l.valueNode&&s&&x&&L&&B&&V){const ae=l.trigger.getBoundingClientRect(),ce=x.getBoundingClientRect(),Pe=l.valueNode.getBoundingClientRect(),we=V.getBoundingClientRect();if(l.dir!=="rtl"){const sr=we.left-ce.left,St=Pe.left-sr,jr=ae.left-St,dt=ae.width+jr,Yr=Math.max(dt,ce.width),Vr=window.innerWidth-ed,Yn=pN(St,[ed,Math.max(ed,Vr-Yr)]);s.style.minWidth=dt+"px",s.style.left=Yn+"px"}else{const sr=ce.right-we.right,St=window.innerWidth-Pe.right-sr,jr=window.innerWidth-ae.right-St,dt=ae.width+jr,Yr=Math.max(dt,ce.width),Vr=window.innerWidth-ed,Yn=pN(St,[ed,Math.max(ed,Vr-Yr)]);s.style.minWidth=dt+"px",s.style.right=Yn+"px"}const xe=S(),Ne=window.innerHeight-ed*2,ze=L.scrollHeight,ye=window.getComputedStyle(x),ve=parseInt(ye.borderTopWidth,10),_e=parseInt(ye.paddingTop,10),Ee=parseInt(ye.borderBottomWidth,10),je=parseInt(ye.paddingBottom,10),Ce=ve+_e+ze+je+Ee,tt=Math.min(B.offsetHeight*5,Ce),it=window.getComputedStyle(L),mt=parseInt(it.paddingTop,10),gt=parseInt(it.paddingBottom,10),qt=ae.top+ae.height/2-ed,yr=Ne-qt,tr=B.offsetHeight/2,Ft=B.offsetTop+tr,er=ve+_e+Ft,Dt=Ce-er;if(er<=qt){const sr=xe.length>0&&B===xe[xe.length-1].ref.current;s.style.bottom="0px";const St=x.clientHeight-L.offsetTop-L.offsetHeight,jr=Math.max(yr,tr+(sr?gt:0)+St+Ee),dt=er+jr;s.style.height=dt+"px"}else{const sr=xe.length>0&&B===xe[0].ref.current;s.style.top="0px";const jr=Math.max(qt,ve+L.offsetTop+(sr?mt:0)+tr)+Dt;s.style.height=jr+"px",L.scrollTop=er-qt+L.offsetTop}s.style.margin=`${ed}px 0`,s.style.minHeight=tt+"px",s.style.maxHeight=Ne+"px",i==null||i(),requestAnimationFrame(()=>P.current=!0)}},[S,l.trigger,l.valueNode,s,x,L,B,V,l.dir,i]);Ba(()=>G(),[G]);const[W,Z]=U.useState();Ba(()=>{x&&Z(window.getComputedStyle(x).zIndex)},[x]);const se=U.useCallback(ae=>{ae&&F.current===!0&&(G(),$==null||$(),F.current=!1)},[G,$]);return n.jsx(het,{scope:r,contentWrapper:s,shouldExpandOnScrollRef:P,onScrollButtonChange:se,children:n.jsx("div",{ref:p,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:W},children:n.jsx(Hr.div,{...a,ref:j,style:{boxSizing:"border-box",maxHeight:"100%",...a.style}})})})});Ole.displayName=uet;var det="SelectPopperPosition",Xz=U.forwardRef((e,t)=>{const{__scopeSelect:r,align:i="start",collisionPadding:a=ed,...l}=e,d=l3(r);return n.jsx(PE,{...d,...l,ref:t,align:i,collisionPadding:a,style:{boxSizing:"border-box",...l.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});Xz.displayName=det;var[het,$6]=L_(dx,{}),Jz="SelectViewport",Rle=U.forwardRef((e,t)=>{const{__scopeSelect:r,nonce:i,...a}=e,l=hg(Jz,r),d=$6(Jz,r),s=Mn(t,l.onViewportChange),p=U.useRef(0);return n.jsxs(n.Fragment,{children:[n.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:i}),n.jsx(a3.Slot,{scope:r,children:n.jsx(Hr.div,{"data-radix-select-viewport":"",role:"presentation",...a,ref:s,style:{position:"relative",flex:1,overflow:"hidden auto",...a.style},onScroll:_r(a.onScroll,x=>{const w=x.currentTarget,{contentWrapper:j,shouldExpandOnScrollRef:S}=d;if(S!=null&&S.current&&j){const P=Math.abs(p.current-w.scrollTop);if(P>0){const F=window.innerHeight-ed*2,L=parseFloat(j.style.minHeight),B=parseFloat(j.style.height),V=Math.max(L,B);if(V<F){const $=V+P,G=Math.min(F,$),W=$-G;j.style.height=G+"px",j.style.bottom==="0px"&&(w.scrollTop=W>0?W:0,j.style.justifyContent="flex-end")}}}p.current=w.scrollTop})})})]})});Rle.displayName=Jz;var Dle="SelectGroup",[met,fet]=L_(Dle),pet=U.forwardRef((e,t)=>{const{__scopeSelect:r,...i}=e,a=rc();return n.jsx(met,{scope:r,id:a,children:n.jsx(Hr.div,{role:"group","aria-labelledby":a,...i,ref:t})})});pet.displayName=Dle;var zle="SelectLabel",Lle=U.forwardRef((e,t)=>{const{__scopeSelect:r,...i}=e,a=fet(zle,r);return n.jsx(Hr.div,{id:a.id,...i,ref:t})});Lle.displayName=zle;var RP="SelectItem",[get,Fle]=L_(RP),Ble=U.forwardRef((e,t)=>{const{__scopeSelect:r,value:i,disabled:a=!1,textValue:l,...d}=e,s=dg(RP,r),p=hg(RP,r),x=s.value===i,[w,j]=U.useState(l??""),[S,P]=U.useState(!1),F=Mn(t,$=>{var G;return(G=p.itemRefCallback)==null?void 0:G.call(p,$,i,a)}),L=rc(),B=U.useRef("touch"),V=()=>{a||(s.onValueChange(i),s.onOpenChange(!1))};if(i==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return n.jsx(get,{scope:r,value:i,disabled:a,textId:L,isSelected:x,onItemTextChange:U.useCallback($=>{j(G=>G||(($==null?void 0:$.textContent)??"").trim())},[]),children:n.jsx(a3.ItemSlot,{scope:r,value:i,disabled:a,textValue:w,children:n.jsx(Hr.div,{role:"option","aria-labelledby":L,"data-highlighted":S?"":void 0,"aria-selected":x&&S,"data-state":x?"checked":"unchecked","aria-disabled":a||void 0,"data-disabled":a?"":void 0,tabIndex:a?void 0:-1,...d,ref:F,onFocus:_r(d.onFocus,()=>P(!0)),onBlur:_r(d.onBlur,()=>P(!1)),onClick:_r(d.onClick,()=>{B.current!=="mouse"&&V()}),onPointerUp:_r(d.onPointerUp,()=>{B.current==="mouse"&&V()}),onPointerDown:_r(d.onPointerDown,$=>{B.current=$.pointerType}),onPointerMove:_r(d.onPointerMove,$=>{var G;B.current=$.pointerType,a?(G=p.onItemLeave)==null||G.call(p):B.current==="mouse"&&$.currentTarget.focus({preventScroll:!0})}),onPointerLeave:_r(d.onPointerLeave,$=>{var G;$.currentTarget===document.activeElement&&((G=p.onItemLeave)==null||G.call(p))}),onKeyDown:_r(d.onKeyDown,$=>{var W;((W=p.searchRef)==null?void 0:W.current)!==""&&$.key===" "||(tet.includes($.key)&&V(),$.key===" "&&$.preventDefault())})})})})});Ble.displayName=RP;var _j="SelectItemText",$le=U.forwardRef((e,t)=>{const{__scopeSelect:r,className:i,style:a,...l}=e,d=dg(_j,r),s=hg(_j,r),p=Fle(_j,r),x=set(_j,r),[w,j]=U.useState(null),S=Mn(t,V=>j(V),p.onItemTextChange,V=>{var $;return($=s.itemTextRefCallback)==null?void 0:$.call(s,V,p.value,p.disabled)}),P=w==null?void 0:w.textContent,F=U.useMemo(()=>n.jsx("option",{value:p.value,disabled:p.disabled,children:P},p.value),[p.disabled,p.value,P]),{onNativeOptionAdd:L,onNativeOptionRemove:B}=x;return Ba(()=>(L(F),()=>B(F)),[L,B,F]),n.jsxs(n.Fragment,{children:[n.jsx(Hr.span,{id:p.textId,...l,ref:S}),p.isSelected&&d.valueNode&&!d.valueNodeHasChildren?tg.createPortal(l.children,d.valueNode):null]})});$le.displayName=_j;var Vle="SelectItemIndicator",Ule=U.forwardRef((e,t)=>{const{__scopeSelect:r,...i}=e;return Fle(Vle,r).isSelected?n.jsx(Hr.span,{"aria-hidden":!0,...i,ref:t}):null});Ule.displayName=Vle;var Qz="SelectScrollUpButton",Gle=U.forwardRef((e,t)=>{const r=hg(Qz,e.__scopeSelect),i=$6(Qz,e.__scopeSelect),[a,l]=U.useState(!1),d=Mn(t,i.onScrollButtonChange);return Ba(()=>{if(r.viewport&&r.isPositioned){let s=function(){const x=p.scrollTop>0;l(x)};const p=r.viewport;return s(),p.addEventListener("scroll",s),()=>p.removeEventListener("scroll",s)}},[r.viewport,r.isPositioned]),a?n.jsx(qle,{...e,ref:d,onAutoScroll:()=>{const{viewport:s,selectedItem:p}=r;s&&p&&(s.scrollTop=s.scrollTop-p.offsetHeight)}}):null});Gle.displayName=Qz;var eL="SelectScrollDownButton",Hle=U.forwardRef((e,t)=>{const r=hg(eL,e.__scopeSelect),i=$6(eL,e.__scopeSelect),[a,l]=U.useState(!1),d=Mn(t,i.onScrollButtonChange);return Ba(()=>{if(r.viewport&&r.isPositioned){let s=function(){const x=p.scrollHeight-p.clientHeight,w=Math.ceil(p.scrollTop)<x;l(w)};const p=r.viewport;return s(),p.addEventListener("scroll",s),()=>p.removeEventListener("scroll",s)}},[r.viewport,r.isPositioned]),a?n.jsx(qle,{...e,ref:d,onAutoScroll:()=>{const{viewport:s,selectedItem:p}=r;s&&p&&(s.scrollTop=s.scrollTop+p.offsetHeight)}}):null});Hle.displayName=eL;var qle=U.forwardRef((e,t)=>{const{__scopeSelect:r,onAutoScroll:i,...a}=e,l=hg("SelectScrollButton",r),d=U.useRef(null),s=o3(r),p=U.useCallback(()=>{d.current!==null&&(window.clearInterval(d.current),d.current=null)},[]);return U.useEffect(()=>()=>p(),[p]),Ba(()=>{var w;const x=s().find(j=>j.ref.current===document.activeElement);(w=x==null?void 0:x.ref.current)==null||w.scrollIntoView({block:"nearest"})},[s]),n.jsx(Hr.div,{"aria-hidden":!0,...a,ref:t,style:{flexShrink:0,...a.style},onPointerDown:_r(a.onPointerDown,()=>{d.current===null&&(d.current=window.setInterval(i,50))}),onPointerMove:_r(a.onPointerMove,()=>{var x;(x=l.onItemLeave)==null||x.call(l),d.current===null&&(d.current=window.setInterval(i,50))}),onPointerLeave:_r(a.onPointerLeave,()=>{p()})})}),xet="SelectSeparator",Wle=U.forwardRef((e,t)=>{const{__scopeSelect:r,...i}=e;return n.jsx(Hr.div,{"aria-hidden":!0,...i,ref:t})});Wle.displayName=xet;var tL="SelectArrow",yet=U.forwardRef((e,t)=>{const{__scopeSelect:r,...i}=e,a=l3(r),l=dg(tL,r),d=hg(tL,r);return l.open&&d.position==="popper"?n.jsx(EE,{...a,...i,ref:t}):null});yet.displayName=tL;function Kle(e){return e===""||e===void 0}var Zle=U.forwardRef((e,t)=>{const{value:r,...i}=e,a=U.useRef(null),l=Mn(t,a),d=s3(r);return U.useEffect(()=>{const s=a.current,p=window.HTMLSelectElement.prototype,w=Object.getOwnPropertyDescriptor(p,"value").set;if(d!==r&&w){const j=new Event("change",{bubbles:!0});w.call(s,r),s.dispatchEvent(j)}},[d,r]),n.jsx(FN,{asChild:!0,children:n.jsx("select",{...i,ref:l,defaultValue:r})})});Zle.displayName="BubbleSelect";function Yle(e){const t=Ws(e),r=U.useRef(""),i=U.useRef(0),a=U.useCallback(d=>{const s=r.current+d;t(s),function p(x){r.current=x,window.clearTimeout(i.current),x!==""&&(i.current=window.setTimeout(()=>p(""),1e3))}(s)},[t]),l=U.useCallback(()=>{r.current="",window.clearTimeout(i.current)},[]);return U.useEffect(()=>()=>window.clearTimeout(i.current),[]),[r,a,l]}function Xle(e,t,r){const a=t.length>1&&Array.from(t).every(x=>x===t[0])?t[0]:t,l=r?e.indexOf(r):-1;let d=vet(e,Math.max(l,0));a.length===1&&(d=d.filter(x=>x!==r));const p=d.find(x=>x.textValue.toLowerCase().startsWith(a.toLowerCase()));return p!==r?p:void 0}function vet(e,t){return e.map((r,i)=>e[(t+i)%e.length])}var bet=Nle,Jle=Cle,_et=Tle,wet=kle,jet=Ple,Qle=Ele,Net=Rle,ece=Lle,tce=Ble,Cet=$le,Aet=Ule,rce=Gle,nce=Hle,ice=Wle;const _n=bet,wn=_et,xn=U.forwardRef(({className:e,children:t,...r},i)=>n.jsxs(Jle,{ref:i,className:Yt("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...r,children:[t,n.jsx(wet,{asChild:!0,children:n.jsx(Na,{className:"h-4 w-4 opacity-50"})})]}));xn.displayName=Jle.displayName;const sce=U.forwardRef(({className:e,...t},r)=>n.jsx(rce,{ref:r,className:Yt("flex cursor-default items-center justify-center py-1",e),...t,children:n.jsx(x2,{className:"h-4 w-4"})}));sce.displayName=rce.displayName;const ace=U.forwardRef(({className:e,...t},r)=>n.jsx(nce,{ref:r,className:Yt("flex cursor-default items-center justify-center py-1",e),...t,children:n.jsx(Na,{className:"h-4 w-4"})}));ace.displayName=nce.displayName;const yn=U.forwardRef(({className:e,children:t,position:r="popper",...i},a)=>n.jsx(jet,{children:n.jsxs(Qle,{ref:a,className:Yt("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:r,...i,children:[n.jsx(sce,{}),n.jsx(Net,{className:Yt("p-1",r==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),n.jsx(ace,{})]})}));yn.displayName=Qle.displayName;const Tet=U.forwardRef(({className:e,...t},r)=>n.jsx(ece,{ref:r,className:Yt("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...t}));Tet.displayName=ece.displayName;const yt=U.forwardRef(({className:e,children:t,...r},i)=>n.jsxs(tce,{ref:i,className:Yt("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...r,children:[n.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:n.jsx(Aet,{children:n.jsx(hh,{className:"h-4 w-4"})})}),n.jsx(Cet,{children:t})]}));yt.displayName=tce.displayName;const ket=U.forwardRef(({className:e,...t},r)=>n.jsx(ice,{ref:r,className:Yt("-mx-1 my-1 h-px bg-muted",e),...t}));ket.displayName=ice.displayName;var V6="Switch",[Pet,oft]=Jo(V6),[Eet,Met]=Pet(V6),oce=U.forwardRef((e,t)=>{const{__scopeSwitch:r,name:i,checked:a,defaultChecked:l,required:d,disabled:s,value:p="on",onCheckedChange:x,form:w,...j}=e,[S,P]=U.useState(null),F=Mn(t,G=>P(G)),L=U.useRef(!1),B=S?w||!!S.closest("form"):!0,[V=!1,$]=fo({prop:a,defaultProp:l,onChange:x});return n.jsxs(Eet,{scope:r,checked:V,disabled:s,children:[n.jsx(Hr.button,{type:"button",role:"switch","aria-checked":V,"aria-required":d,"data-state":uce(V),"data-disabled":s?"":void 0,disabled:s,value:p,...j,ref:F,onClick:_r(e.onClick,G=>{$(W=>!W),B&&(L.current=G.isPropagationStopped(),L.current||G.stopPropagation())})}),B&&n.jsx(Iet,{control:S,bubbles:!L.current,name:i,value:p,checked:V,required:d,disabled:s,form:w,style:{transform:"translateX(-100%)"}})]})});oce.displayName=V6;var lce="SwitchThumb",cce=U.forwardRef((e,t)=>{const{__scopeSwitch:r,...i}=e,a=Met(lce,r);return n.jsx(Hr.span,{"data-state":uce(a.checked),"data-disabled":a.disabled?"":void 0,...i,ref:t})});cce.displayName=lce;var Iet=e=>{const{control:t,checked:r,bubbles:i=!0,...a}=e,l=U.useRef(null),d=s3(r),s=TE(t);return U.useEffect(()=>{const p=l.current,x=window.HTMLInputElement.prototype,j=Object.getOwnPropertyDescriptor(x,"checked").set;if(d!==r&&j){const S=new Event("click",{bubbles:i});j.call(p,r),p.dispatchEvent(S)}},[d,r,i]),n.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:r,...a,tabIndex:-1,ref:l,style:{...e.style,...s,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function uce(e){return e?"checked":"unchecked"}var dce=oce,Oet=cce;const ko=U.forwardRef(({className:e,...t},r)=>n.jsx(dce,{className:Yt("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",e),...t,ref:r,children:n.jsx(Oet,{className:Yt("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));ko.displayName=dce.displayName;function Ret(e,t=[]){let r=[];function i(l,d){const s=U.createContext(d),p=r.length;r=[...r,d];function x(j){const{scope:S,children:P,...F}=j,L=(S==null?void 0:S[e][p])||s,B=U.useMemo(()=>F,Object.values(F));return n.jsx(L.Provider,{value:B,children:P})}function w(j,S){const P=(S==null?void 0:S[e][p])||s,F=U.useContext(P);if(F)return F;if(d!==void 0)return d;throw new Error(`\`${j}\` must be used within \`${l}\``)}return x.displayName=l+"Provider",[x,w]}const a=()=>{const l=r.map(d=>U.createContext(d));return function(s){const p=(s==null?void 0:s[e])||l;return U.useMemo(()=>({[`__scope${e}`]:{...s,[e]:p}}),[s,p])}};return a.scopeName=e,[i,Det(a,...t)]}function Det(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const i=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(l){const d=i.reduce((s,{useScope:p,scopeName:x})=>{const j=p(l)[`__scope${x}`];return{...s,...j}},{});return U.useMemo(()=>({[`__scope${t.scopeName}`]:d}),[d])}};return r.scopeName=t.scopeName,r}var U6="Progress",G6=100,[zet,lft]=Ret(U6),[Let,Fet]=zet(U6),hce=U.forwardRef((e,t)=>{const{__scopeProgress:r,value:i=null,max:a,getValueLabel:l=Bet,...d}=e;(a||a===0)&&!SZ(a)&&console.error($et(`${a}`,"Progress"));const s=SZ(a)?a:G6;i!==null&&!CZ(i,s)&&console.error(Vet(`${i}`,"Progress"));const p=CZ(i,s)?i:null,x=DP(p)?l(p,s):void 0;return n.jsx(Let,{scope:r,value:p,max:s,children:n.jsx(Hr.div,{"aria-valuemax":s,"aria-valuemin":0,"aria-valuenow":DP(p)?p:void 0,"aria-valuetext":x,role:"progressbar","data-state":pce(p,s),"data-value":p??void 0,"data-max":s,...d,ref:t})})});hce.displayName=U6;var mce="ProgressIndicator",fce=U.forwardRef((e,t)=>{const{__scopeProgress:r,...i}=e,a=Fet(mce,r);return n.jsx(Hr.div,{"data-state":pce(a.value,a.max),"data-value":a.value??void 0,"data-max":a.max,...i,ref:t})});fce.displayName=mce;function Bet(e,t){return`${Math.round(e/t*100)}%`}function pce(e,t){return e==null?"indeterminate":e===t?"complete":"loading"}function DP(e){return typeof e=="number"}function SZ(e){return DP(e)&&!isNaN(e)&&e>0}function CZ(e,t){return DP(e)&&!isNaN(e)&&e<=t&&e>=0}function $et(e,t){return`Invalid prop \`max\` of value \`${e}\` supplied to \`${t}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${G6}\`.`}function Vet(e,t){return`Invalid prop \`value\` of value \`${e}\` supplied to \`${t}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${G6} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var gce=hce,Uet=fce;const vn=U.forwardRef(({className:e,value:t,...r},i)=>n.jsx(gce,{ref:i,className:Yt("relative h-4 w-full overflow-hidden rounded-full bg-gray-700",e),...r,children:n.jsx(Uet,{className:"h-full w-full flex-1 bg-gradient-to-r from-beam-blue to-blue-600 transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})}));vn.displayName=gce.displayName;const Get=({node:e,onUpdateNode:t,onClose:r})=>{const[i,a]=U.useState(e.data),l=(B,V)=>{const $={...i,[B]:V};a($),t(e.id,$)},s=(()=>{const B={"market-research-agent":{systemPrompt:`You are an AI Market Research Agent specializing in financial markets. Your role is to:
- Continuously monitor global markets, news, and economic indicators
- Identify emerging investment opportunities and potential risks
- Analyze market sentiment and economic data
- Provide real-time market intelligence to other agents

You have access to real-time financial data sources and must prioritize accuracy and timeliness in your analysis.`,tools:["Real-time News Analysis","Economic Data Mining","Sentiment Analysis","Risk Detection"],guardrails:["Data Source Verification","Market Hours Validation","Information Accuracy Checks"],memoryConfig:{type:"episodic",size:500,retention:7},taskCompletionCriteria:"Market data processed, trends identified, alerts generated"},"trend-analysis-agent":{systemPrompt:`You are a Predictive Trend Analyzer using advanced machine learning to identify market patterns. Your responsibilities:
- Analyze historical and real-time market data for patterns
- Generate predictive models for future market movements
- Provide confidence scores for predictions
- Identify cross-asset correlations and volatility patterns

Use statistical models and machine learning algorithms to ensure high-accuracy predictions.`,tools:["Pattern Recognition","Predictive Analytics","Cross-Asset Analysis","Volatility Forecasting"],guardrails:["Model Validation","Confidence Thresholds","Backtesting Requirements"],memoryConfig:{type:"semantic",size:1e3,retention:30},taskCompletionCriteria:"Patterns identified, predictions generated with confidence scores"},"investment-advisor":{systemPrompt:`You are a Personalized Investment Advisor focused on client-specific recommendations. Your mission:
- Analyze complete financial profiles of clients
- Generate personalized investment strategies
- Optimize portfolios for tax efficiency and risk tolerance
- Ensure recommendations align with client goals and regulations

Always prioritize fiduciary duty and regulatory compliance in your recommendations.`,tools:["Portfolio Analysis","Risk Assessment","Tax Optimization","Goal-Based Planning"],guardrails:["Suitability Checks","Regulatory Compliance","Risk Tolerance Validation"],memoryConfig:{type:"long-term",size:800,retention:365},taskCompletionCriteria:"Portfolio analyzed, recommendations generated, compliance verified"},"risk-sentinel":{systemPrompt:`You are an AI Risk Sentinel responsible for comprehensive risk monitoring. Your duties:
- Monitor global events and their potential market impact
- Analyze portfolio correlations and concentration risks
- Detect black swan events and stress test scenarios
- Generate real-time risk alerts and mitigation strategies

Maintain constant vigilance and provide early warning systems for all risk factors.`,tools:["Geopolitical Analysis","Correlation Monitoring","Stress Testing","Black Swan Detection"],guardrails:["Risk Limit Enforcement","Alert Threshold Management","False Positive Reduction"],memoryConfig:{type:"episodic",size:600,retention:90},taskCompletionCriteria:"Risk factors monitored, alerts generated, mitigation strategies provided"},"web-intelligence-agent":{systemPrompt:`You are a Web Intelligence Aggregator gathering market sentiment and intelligence. Your scope:
- Crawl financial websites, forums, and social media for market sentiment
- Track insider trading patterns and unusual market activity
- Monitor regulatory announcements and policy changes
- Analyze social sentiment and its market impact

Ensure data quality and source reliability in all intelligence gathering.`,tools:["Social Sentiment Analysis","Forum Monitoring","Insider Activity Tracking","Regulatory Monitoring"],guardrails:["Source Reliability Checks","Information Quality Validation","Legal Compliance"],memoryConfig:{type:"short-term",size:300,retention:14},taskCompletionCriteria:"Intelligence gathered, sentiment analyzed, signals generated"},"financial-health":{systemPrompt:`You are a Proactive Wealth Optimizer managing overall financial health. Your objectives:
- Monitor client portfolios across all accounts and assets
- Identify tax loss harvesting and optimization opportunities
- Implement automated rebalancing strategies
- Optimize cash management and asset allocation

Focus on maximizing after-tax returns while maintaining appropriate risk levels.`,tools:["Multi-Account Analysis","Tax Loss Harvesting","Automated Rebalancing","Cash Management"],guardrails:["Portfolio Limit Enforcement","Tax Compliance","Rebalancing Thresholds"],memoryConfig:{type:"long-term",size:1200,retention:365},taskCompletionCriteria:"Optimization opportunities identified, actions executed, performance tracked"}};return B[e.id]||B["market-research-agent"]})(),p={...s,...i},x=()=>n.jsx("div",{className:"space-y-4",children:n.jsxs(jt,{className:"bg-slate-800/30 border-purple-400/20",children:[n.jsx(wr,{className:"pb-3",children:n.jsxs(fr,{className:"text-sm text-white flex items-center gap-2",children:[n.jsx(Hi,{className:"h-4 w-4 text-purple-400"}),"Agent Overview"]})}),n.jsxs(Ht,{className:"space-y-3",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("div",{children:[n.jsx(mr,{className:"text-xs text-slate-400",children:"Status"}),n.jsx(Tt,{className:`mt-1 ${p.status==="active"?"bg-green-900/20 text-green-300":p.status==="analyzing"?"bg-blue-900/20 text-blue-300":"bg-amber-900/20 text-amber-300"}`,children:p.status||"Active"})]}),n.jsxs("div",{children:[n.jsx(mr,{className:"text-xs text-slate-400",children:"Model"}),n.jsx("p",{className:"text-xs text-white mt-1",children:p.model||"GPT-4o"})]})]}),n.jsxs("div",{children:[n.jsx(mr,{className:"text-xs text-slate-400",children:"Description"}),n.jsx("p",{className:"text-xs text-slate-300 mt-1",children:p.description})]}),p.confidence&&n.jsxs("div",{children:[n.jsx(mr,{className:"text-xs text-slate-400",children:"Confidence Score"}),n.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[n.jsx(vn,{value:p.confidence,className:"flex-1 h-2"}),n.jsxs("span",{className:"text-xs text-green-400",children:[p.confidence,"%"]})]})]})]})]})}),w=()=>n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx(mr,{className:"text-sm text-white",children:"System Prompt"}),n.jsx(po,{value:p.systemPrompt||s.systemPrompt,onChange:B=>l("systemPrompt",B.target.value),className:"bg-slate-800/30 border-purple-400/20 text-white text-xs mt-2 min-h-[200px]",placeholder:"Define the agent's role and behavior..."})]}),n.jsxs("div",{children:[n.jsx(mr,{className:"text-sm text-white",children:"Reasoning Strategy"}),n.jsxs(_n,{value:p.reasoning||"chain-of-thought",onValueChange:B=>l("reasoning",B),children:[n.jsx(xn,{className:"bg-slate-800/30 border-purple-400/20 text-white mt-2",children:n.jsx(wn,{})}),n.jsxs(yn,{className:"bg-slate-800 border-purple-400/20",children:[n.jsx(yt,{value:"chain-of-thought",children:"Chain of Thought"}),n.jsx(yt,{value:"tree-of-thought",children:"Tree of Thought"}),n.jsx(yt,{value:"analytical",children:"Analytical Reasoning"}),n.jsx(yt,{value:"predictive",children:"Predictive Analysis"}),n.jsx(yt,{value:"risk-aware",children:"Risk-Aware Reasoning"}),n.jsx(yt,{value:"optimization",children:"Optimization-Focused"})]})]})]})]}),j=()=>n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx(mr,{className:"text-sm text-white mb-3 block",children:"Available Tools"}),n.jsx("div",{className:"space-y-2",children:(p.tools||s.tools||[]).map((B,V)=>n.jsxs("div",{className:"flex items-center justify-between p-2 bg-slate-800/30 rounded border border-purple-400/20",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Bc,{className:"h-4 w-4 text-purple-400"}),n.jsx("span",{className:"text-xs text-white",children:B})]}),n.jsx(ko,{checked:!0})]},V))})]}),n.jsxs("div",{children:[n.jsx(mr,{className:"text-sm text-white",children:"Tool Execution Timeout (seconds)"}),n.jsx(An,{type:"number",value:p.toolTimeout||30,onChange:B=>l("toolTimeout",parseInt(B.target.value)),className:"bg-slate-800/30 border-purple-400/20 text-white mt-2"})]})]}),S=()=>{var B,V,$;return n.jsx("div",{className:"space-y-4",children:n.jsxs(jt,{className:"bg-slate-800/30 border-purple-400/20",children:[n.jsx(wr,{className:"pb-3",children:n.jsxs(fr,{className:"text-sm text-white flex items-center gap-2",children:[n.jsx(ln,{className:"h-4 w-4 text-blue-400"}),"Memory Configuration"]})}),n.jsxs(Ht,{className:"space-y-3",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("div",{children:[n.jsx(mr,{className:"text-xs text-slate-400",children:"Type"}),n.jsxs(_n,{value:((B=p.memoryConfig)==null?void 0:B.type)||s.memoryConfig.type,onValueChange:G=>l("memoryConfig",{...p.memoryConfig,type:G}),children:[n.jsx(xn,{className:"bg-slate-700/30 border-slate-600 text-white text-xs mt-1",children:n.jsx(wn,{})}),n.jsxs(yn,{className:"bg-slate-800 border-slate-600",children:[n.jsx(yt,{value:"short-term",children:"Short-term"}),n.jsx(yt,{value:"long-term",children:"Long-term"}),n.jsx(yt,{value:"episodic",children:"Episodic"}),n.jsx(yt,{value:"semantic",children:"Semantic"})]})]})]}),n.jsxs("div",{children:[n.jsx(mr,{className:"text-xs text-slate-400",children:"Size (MB)"}),n.jsx(An,{type:"number",value:((V=p.memoryConfig)==null?void 0:V.size)||s.memoryConfig.size,onChange:G=>l("memoryConfig",{...p.memoryConfig,size:parseInt(G.target.value)}),className:"bg-slate-700/30 border-slate-600 text-white text-xs mt-1"})]})]}),n.jsxs("div",{children:[n.jsx(mr,{className:"text-xs text-slate-400",children:"Retention (days)"}),n.jsx(An,{type:"number",value:(($=p.memoryConfig)==null?void 0:$.retention)||s.memoryConfig.retention,onChange:G=>l("memoryConfig",{...p.memoryConfig,retention:parseInt(G.target.value)}),className:"bg-slate-700/30 border-slate-600 text-white text-xs mt-1"})]}),n.jsxs("div",{className:"flex items-center justify-between pt-2",children:[n.jsx(mr,{className:"text-xs text-slate-400",children:"Persistent Storage"}),n.jsx(ko,{checked:p.memory||!0,onCheckedChange:G=>l("memory",G)})]})]})]})})},P=()=>n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx(mr,{className:"text-sm text-white mb-3 block",children:"Active Guardrails"}),n.jsx("div",{className:"space-y-2",children:(p.guardrails||s.guardrails||[]).map((B,V)=>n.jsxs("div",{className:"flex items-center justify-between p-2 bg-slate-800/30 rounded border border-amber-400/20",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(dn,{className:"h-4 w-4 text-amber-400"}),n.jsx("span",{className:"text-xs text-white",children:B})]}),n.jsx(Tt,{className:"bg-green-900/20 text-green-300 text-xs",children:"Active"})]},V))})]}),n.jsxs(jt,{className:"bg-slate-800/30 border-amber-400/20",children:[n.jsx(wr,{className:"pb-2",children:n.jsx(fr,{className:"text-xs text-white",children:"Enforcement Level"})}),n.jsx(Ht,{children:n.jsxs(_n,{value:p.enforcementLevel||"strict",onValueChange:B=>l("enforcementLevel",B),children:[n.jsx(xn,{className:"bg-slate-700/30 border-slate-600 text-white text-xs",children:n.jsx(wn,{})}),n.jsxs(yn,{className:"bg-slate-800 border-slate-600",children:[n.jsx(yt,{value:"advisory",children:"Advisory"}),n.jsx(yt,{value:"moderate",children:"Moderate"}),n.jsx(yt,{value:"strict",children:"Strict"}),n.jsx(yt,{value:"critical",children:"Critical"})]})]})})]})]}),F=()=>n.jsxs("div",{className:"space-y-4",children:[n.jsxs(jt,{className:"bg-slate-800/30 border-green-400/20",children:[n.jsx(wr,{className:"pb-3",children:n.jsxs(fr,{className:"text-sm text-white flex items-center gap-2",children:[n.jsx(Ch,{className:"h-4 w-4 text-green-400"}),"Task Completion Design"]})}),n.jsxs(Ht,{className:"space-y-3",children:[n.jsxs("div",{children:[n.jsx(mr,{className:"text-xs text-slate-400",children:"Completion Criteria"}),n.jsx(po,{value:p.taskCompletionCriteria||s.taskCompletionCriteria,onChange:B=>l("taskCompletionCriteria",B.target.value),className:"bg-slate-700/30 border-slate-600 text-white text-xs mt-1 min-h-[60px]",placeholder:"Define when the task is considered complete..."})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("div",{children:[n.jsx(mr,{className:"text-xs text-slate-400",children:"Max Execution Time (min)"}),n.jsx(An,{type:"number",value:p.maxExecutionTime||15,onChange:B=>l("maxExecutionTime",parseInt(B.target.value)),className:"bg-slate-700/30 border-slate-600 text-white text-xs mt-1"})]}),n.jsxs("div",{children:[n.jsx(mr,{className:"text-xs text-slate-400",children:"Retry Attempts"}),n.jsx(An,{type:"number",value:p.maxRetries||3,onChange:B=>l("maxRetries",parseInt(B.target.value)),className:"bg-slate-700/30 border-slate-600 text-white text-xs mt-1"})]})]}),n.jsxs("div",{className:"flex items-center justify-between pt-2",children:[n.jsx(mr,{className:"text-xs text-slate-400",children:"Auto-restart on Failure"}),n.jsx(ko,{checked:p.autoRestart||!1,onCheckedChange:B=>l("autoRestart",B)})]})]})]}),n.jsxs("div",{children:[n.jsx(mr,{className:"text-sm text-white",children:"Success Metrics"}),n.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-2",children:[n.jsxs("div",{className:"text-center p-2 bg-green-900/20 rounded border border-green-400/20",children:[n.jsx("div",{className:"text-lg font-bold text-green-400",children:"96%"}),n.jsx("div",{className:"text-xs text-green-300",children:"Success Rate"})]}),n.jsxs("div",{className:"text-center p-2 bg-blue-900/20 rounded border border-blue-400/20",children:[n.jsx("div",{className:"text-lg font-bold text-blue-400",children:"0.8s"}),n.jsx("div",{className:"text-xs text-blue-300",children:"Avg Response"})]})]})]})]}),L=()=>{const V={"market-research-agent":$c,"trend-analysis-agent":to,"investment-advisor":En,"risk-sentinel":dn,"web-intelligence-agent":Zs,"financial-health":bs,"wealth-decision-hub":ti,"wealth-memory-core":ln,"compliance-guardrail":dn}[e.id]||Hi;return n.jsx(V,{className:"h-5 w-5 text-purple-400"})};return n.jsxs("div",{className:"w-96 bg-slate-800/40 backdrop-blur-lg border-l border-purple-400/20 flex flex-col",children:[n.jsx("div",{className:"p-4 border-b border-purple-400/20",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[L(),n.jsxs("div",{children:[n.jsx("h2",{className:"text-sm font-semibold text-white",children:p.label}),n.jsxs("p",{className:"text-xs text-purple-300",children:[e.type," configuration"]})]})]}),n.jsx(lt,{variant:"ghost",size:"sm",onClick:r,className:"text-purple-400 hover:text-white",children:n.jsx(Pc,{className:"h-4 w-4"})})]})}),n.jsx("div",{className:"flex-1 overflow-y-auto",children:n.jsxs($i,{defaultValue:"overview",className:"w-full",children:[n.jsxs(Di,{className:"grid w-full grid-cols-3 bg-slate-700/30 m-2",children:[n.jsx(Jt,{value:"overview",className:"text-xs",children:"Overview"}),n.jsx(Jt,{value:"config",className:"text-xs",children:"Config"}),n.jsx(Jt,{value:"performance",className:"text-xs",children:"Tasks"})]}),n.jsxs("div",{className:"p-4",children:[n.jsx(ur,{value:"overview",className:"mt-0",children:x()}),n.jsx(ur,{value:"config",className:"mt-0",children:n.jsxs($i,{defaultValue:"prompt",className:"w-full",children:[n.jsxs(Di,{className:"grid w-full grid-cols-4 bg-slate-700/30 mb-4",children:[n.jsx(Jt,{value:"prompt",className:"text-xs",children:"Prompt"}),n.jsx(Jt,{value:"tools",className:"text-xs",children:"Tools"}),n.jsx(Jt,{value:"memory",className:"text-xs",children:"Memory"}),n.jsx(Jt,{value:"guards",className:"text-xs",children:"Guards"})]}),n.jsx(ur,{value:"prompt",children:w()}),n.jsx(ur,{value:"tools",children:j()}),n.jsx(ur,{value:"memory",children:S()}),n.jsx(ur,{value:"guards",children:P()})]})}),n.jsx(ur,{value:"performance",className:"mt-0",children:F()})]})]})})]})},xce=({isRunning:e,onRun:t,onStop:r,onExport:i,nodeCount:a,connectionCount:l,metrics:d,onShowCompliance:s,onShowRiskAssessment:p})=>{const x=j=>{switch(j){case"Low":return"text-green-400 bg-green-900/30 border-green-600";case"Medium":return"text-yellow-400 bg-yellow-900/30 border-yellow-600";case"High":return"text-red-400 bg-red-900/30 border-red-600";default:return"text-gray-400 bg-gray-900/30 border-gray-600"}},w=j=>j>=90?"text-green-400":j>=70?"text-yellow-400":"text-red-400";return n.jsx("div",{className:"absolute top-1 left-1 z-10 bg-slate-800/40 backdrop-blur-sm border border-slate-600/30 rounded-lg p-1.5 shadow-lg min-w-[500px]",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("div",{className:"flex items-center gap-1.5",children:[e?n.jsxs(lt,{onClick:r,size:"sm",className:"h-7 px-2",variant:"destructive",children:[n.jsx(LF,{className:"h-3 w-3 mr-1"}),"Stop"]}):n.jsxs(lt,{onClick:t,size:"sm",className:"h-7 px-2 bg-emerald-600 hover:bg-emerald-700 text-white shadow-md text-xs",disabled:a===0,children:[n.jsx(Sh,{className:"h-3 w-3 mr-1"}),"Run"]}),n.jsxs(lt,{size:"sm",variant:"outline",className:"h-7 px-2 border-slate-600/30 text-slate-300 hover:bg-slate-700/50 bg-slate-800/40 shadow-sm text-xs",children:[n.jsx(vx,{className:"h-3 w-3 mr-1"}),"Reset"]})]}),n.jsx(Da,{orientation:"vertical",className:"h-5 bg-slate-600/30"}),n.jsxs("div",{className:"flex items-center gap-1.5",children:[n.jsxs(lt,{onClick:s,size:"sm",variant:"outline",className:"h-7 px-2 border-slate-600/30 text-slate-300 hover:bg-slate-700/50 bg-slate-800/40 shadow-sm text-xs",children:[n.jsx(dn,{className:"h-3 w-3 mr-1"}),"Compliance"]}),n.jsxs(lt,{onClick:p,size:"sm",variant:"outline",className:"h-7 px-2 border-slate-600/30 text-slate-300 hover:bg-slate-700/50 bg-slate-800/40 shadow-sm text-xs",children:[n.jsx(En,{className:"h-3 w-3 mr-1"}),"Risk"]}),n.jsxs(lt,{onClick:i,size:"sm",variant:"outline",className:"h-7 px-2 border-slate-600/30 text-slate-300 hover:bg-slate-700/50 bg-slate-800/40 shadow-sm text-xs",children:[n.jsx(Nu,{className:"h-3 w-3 mr-1"}),"Export"]})]})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs("div",{className:"flex items-center gap-2 text-[10px]",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(TQ,{className:"h-2.5 w-2.5 text-emerald-400"}),n.jsx("span",{className:"text-slate-300",children:"Compliance:"}),n.jsxs("span",{className:w(d.complianceScore),children:[d.complianceScore,"%"]})]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(En,{className:"h-2.5 w-2.5 text-amber-400"}),n.jsx("span",{className:"text-slate-300",children:"Risk:"}),n.jsx(Tt,{className:`${x(d.riskLevel)} text-[9px] px-1 py-0`,children:d.riskLevel})]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(to,{className:"h-2.5 w-2.5 text-cyan-400"}),n.jsx("span",{className:"text-slate-300",children:"Audit:"}),n.jsxs("span",{className:w(d.auditReadiness),children:[d.auditReadiness,"%"]})]})]}),n.jsx(Da,{orientation:"vertical",className:"h-5 bg-slate-600/30"}),n.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-slate-300",children:[n.jsxs("span",{children:[a," Agents"]}),n.jsxs("span",{children:[l," Connections"]}),e&&n.jsxs("span",{className:"flex items-center gap-1 text-emerald-400",children:[n.jsx("div",{className:"w-1 h-1 bg-emerald-400 rounded-full animate-pulse"}),"Running"]})]})]})]})})},c3=({data:e,selected:t})=>{var a,l;const r=d=>{switch(d){case"KYC Agent":return n.jsx(Hi,{className:"h-3 w-3 text-cyan-400"});case"AML Agent":return n.jsx(dn,{className:"h-3 w-3 text-emerald-400"});case"Credit Underwriting Agent":return n.jsx(ln,{className:"h-3 w-3 text-purple-400"});case"Fraud Detection Agent":return n.jsx(bs,{className:"h-3 w-3 text-red-400"});case"Regulatory Reporting Agent":return n.jsx(ws,{className:"h-3 w-3 text-yellow-400"});case"Customer Service Agent":return n.jsx(ti,{className:"h-3 w-3 text-pink-400"});default:return n.jsx(Hi,{className:"h-3 w-3 text-cyan-400"})}},i=d=>{switch(d){case"running":return"bg-emerald-500";case"error":return"bg-red-500";case"paused":return"bg-yellow-500";default:return"bg-gray-500"}};return n.jsxs("div",{className:`relative backdrop-blur-lg bg-gradient-to-br from-slate-800/40 to-slate-900/60 border border-slate-600/30 rounded-lg shadow-lg transition-all duration-300 w-[90px] min-h-[60px] ${t?"border-cyan-400/60 shadow-cyan-400/20 shadow-xl ring-1 ring-cyan-400/30":"border-slate-600/30 hover:border-slate-500/50 hover:shadow-lg"}`,children:[n.jsx("div",{className:"absolute inset-0 rounded-lg bg-gradient-to-br from-cyan-400/5 to-purple-400/5 opacity-60"}),n.jsx(zc,{type:"target",position:cn.Top,className:"w-2 h-2 bg-cyan-400 border border-slate-800 shadow-md shadow-cyan-400/30"}),n.jsxs("div",{className:"relative p-2 space-y-1",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("div",{className:"p-1 rounded bg-slate-700/50 backdrop-blur-sm",children:r(e.agentType)}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("h3",{className:"text-[10px] font-medium text-slate-100 truncate leading-tight",children:(e.label||"Agent").substring(0,8)}),n.jsx("p",{className:"text-[8px] text-slate-400 truncate leading-tight",children:(e.agentType||"AI Agent").substring(0,10)})]}),n.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${i(e.status)} shadow-sm`})]}),n.jsxs("div",{className:"space-y-1",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-[8px] text-slate-400",children:"Model"}),n.jsx("span",{className:"text-[7px] font-mono text-slate-300 bg-slate-700/30 px-1 py-0.5 rounded",children:(e.model||"GPT-4").substring(0,4)})]}),n.jsxs("div",{className:"flex items-center gap-1",children:[e.memory&&n.jsx("div",{className:"w-4 h-4 bg-emerald-500/20 rounded flex items-center justify-center backdrop-blur-sm",children:n.jsx(ln,{className:"h-2 w-2 text-emerald-400"})}),((a=e.guardrails)==null?void 0:a.length)>0&&n.jsx("div",{className:"w-4 h-4 bg-amber-500/20 rounded flex items-center justify-center backdrop-blur-sm",children:n.jsx(dn,{className:"h-2 w-2 text-amber-400"})}),((l=e.tools)==null?void 0:l.length)>0&&n.jsx("span",{className:"text-[7px] bg-cyan-500/20 text-cyan-400 px-1 py-0.5 rounded backdrop-blur-sm",children:e.tools.length})]})]})]}),n.jsx(zc,{type:"source",position:cn.Bottom,className:"w-2 h-2 bg-cyan-400 border border-slate-800 shadow-md shadow-cyan-400/30"})]})},u3=({data:e,selected:t})=>{const r=i=>{switch(i){case"running":return"bg-emerald-500";case"error":return"bg-red-500";case"paused":return"bg-yellow-500";default:return"bg-gray-500"}};return n.jsxs("div",{className:`relative backdrop-blur-lg bg-gradient-to-br from-slate-800/40 to-slate-900/60 border border-slate-600/30 rounded-lg shadow-lg transition-all duration-300 w-[90px] min-h-[60px] ${t?"border-amber-400/60 shadow-amber-400/20 shadow-xl ring-1 ring-amber-400/30":"border-slate-600/30 hover:border-slate-500/50 hover:shadow-lg"}`,children:[n.jsx("div",{className:"absolute inset-0 rounded-lg bg-gradient-to-br from-amber-400/5 to-orange-400/5 opacity-60"}),n.jsx(zc,{type:"target",position:cn.Top,className:"w-2 h-2 bg-amber-400 border border-slate-800 shadow-md shadow-amber-400/30"}),n.jsxs("div",{className:"relative p-2 space-y-1",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("div",{className:"p-1 rounded bg-slate-700/50 backdrop-blur-sm",children:n.jsx(Q0,{className:"h-3 w-3 text-amber-400"})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("h3",{className:"text-[10px] font-medium text-slate-100 truncate leading-tight",children:(e.label||"Decision").substring(0,8)}),n.jsx("p",{className:"text-[8px] text-slate-400 truncate leading-tight",children:"Logic Gate"})]}),n.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${r(e.status)} shadow-sm`})]}),n.jsxs("div",{className:"space-y-1",children:[n.jsxs("div",{className:"flex items-center justify-between text-[7px]",children:[n.jsx("span",{className:"text-slate-400",children:"Condition"}),n.jsx("span",{className:"text-slate-300 font-mono",children:e.condition||"If/Else"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("div",{className:"w-1.5 h-1.5 bg-green-400 rounded-full shadow-sm"}),n.jsx("span",{className:"text-[7px] text-slate-400",children:"True"})]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("div",{className:"w-1.5 h-1.5 bg-red-400 rounded-full shadow-sm"}),n.jsx("span",{className:"text-[7px] text-slate-400",children:"False"})]})]})]})]}),n.jsx(zc,{type:"source",position:cn.Bottom,id:"true",className:"w-2 h-2 bg-green-400 border border-slate-800 shadow-md shadow-green-400/30",style:{left:"30%",bottom:"-4px"}}),n.jsx(zc,{type:"source",position:cn.Bottom,id:"false",className:"w-2 h-2 bg-red-400 border border-slate-800 shadow-md shadow-red-400/30",style:{left:"70%",bottom:"-4px"}})]})},d3=({data:e,selected:t})=>{const r=s=>{switch(s){case"short-term":return{icon:n.jsx(ln,{className:"h-3 w-3 text-cyan-400"}),label:"Cache",description:"Fast access",color:"from-cyan-400/20 to-blue-400/20"};case"long-term":return{icon:n.jsx(eo,{className:"h-3 w-3 text-emerald-400"}),label:"Store",description:"Persistent",color:"from-emerald-400/20 to-green-400/20"};case"episodic":return{icon:n.jsx(ln,{className:"h-3 w-3 text-purple-400"}),label:"Events",description:"Contextual",color:"from-purple-400/20 to-violet-400/20"};case"semantic":return{icon:n.jsx(dve,{className:"h-3 w-3 text-amber-400"}),label:"Facts",description:"Knowledge",color:"from-amber-400/20 to-yellow-400/20"};default:return{icon:n.jsx(ln,{className:"h-3 w-3 text-emerald-400"}),label:"Memory",description:"Storage",color:"from-emerald-400/20 to-green-400/20"}}},i=s=>{switch(s){case"running":return"bg-emerald-500";case"error":return"bg-red-500";case"paused":return"bg-yellow-500";default:return"bg-gray-500"}},a=r(e.memoryType||"short-term"),l=e.usage||45,d=e.retentionDays||30;return n.jsxs("div",{className:`relative backdrop-blur-lg bg-gradient-to-br from-slate-800/40 to-slate-900/60 border border-slate-600/30 rounded-lg shadow-lg transition-all duration-300 w-[90px] min-h-[65px] ${t?"border-emerald-400/60 shadow-emerald-400/20 shadow-xl ring-1 ring-emerald-400/30":"border-slate-600/30 hover:border-slate-500/50 hover:shadow-lg"}`,children:[n.jsx("div",{className:`absolute inset-0 rounded-lg bg-gradient-to-br ${a.color} opacity-60`}),n.jsx(zc,{type:"target",position:cn.Top,className:"w-2 h-2 bg-emerald-400 border border-slate-800 shadow-md shadow-emerald-400/30"}),n.jsxs("div",{className:"relative p-2 space-y-1",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("div",{className:"p-1 rounded bg-slate-700/50 backdrop-blur-sm",children:a.icon}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("h3",{className:"text-[10px] font-medium text-slate-100 truncate leading-tight",children:a.label}),n.jsx("p",{className:"text-[8px] text-slate-400 truncate leading-tight",children:a.description})]}),n.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${i(e.status)} shadow-sm`})]}),n.jsxs("div",{className:"space-y-1",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-[8px] text-slate-400",children:"Capacity"}),n.jsxs("span",{className:"text-[7px] font-mono text-slate-300 bg-slate-700/30 px-1 py-0.5 rounded",children:[e.memorySize||100,"MB"]})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-[8px] text-slate-400",children:"Retention"}),n.jsxs("span",{className:"text-[7px] font-mono text-slate-300 bg-slate-700/30 px-1 py-0.5 rounded",children:[d,"d"]})]}),e.agentContext&&n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-[8px] text-slate-400",children:"Context"}),n.jsx("span",{className:"text-[7px] font-mono text-cyan-400 bg-cyan-900/30 px-1 py-0.5 rounded",children:e.agentContext.substring(0,6)})]}),n.jsxs("div",{className:"space-y-0.5",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-[8px] text-slate-400",children:"Usage"}),n.jsxs("span",{className:"text-[7px] text-slate-300",children:[l,"%"]})]}),n.jsx("div",{className:"w-full bg-slate-700/50 rounded-full h-1",children:n.jsx("div",{className:`h-1 rounded-full transition-all duration-300 ${l>80?"bg-red-400":l>60?"bg-yellow-400":"bg-emerald-400"}`,style:{width:`${l}%`}})})]})]})]}),n.jsx(zc,{type:"source",position:cn.Bottom,className:"w-2 h-2 bg-emerald-400 border border-slate-800 shadow-md shadow-emerald-400/30"})]})},h3=({data:e,selected:t})=>{var l;const r=d=>{switch(d){case"content-filter":return n.jsx(dn,{className:"h-3 w-3 text-emerald-400"});case"pii-protection":return n.jsx(dn,{className:"h-3 w-3 text-blue-400"});case"bias-detection":return n.jsx(dn,{className:"h-3 w-3 text-purple-400"});case"toxicity-check":return n.jsx(dn,{className:"h-3 w-3 text-red-400"});default:return n.jsx(dn,{className:"h-3 w-3 text-emerald-400"})}},i=d=>{switch(d){case"running":return"bg-emerald-500";case"error":return"bg-red-500";case"paused":return"bg-yellow-500";default:return"bg-gray-500"}},a=d=>{switch(d){case"critical":return"text-red-400 bg-red-900/30";case"high":return"text-orange-400 bg-orange-900/30";case"medium":return"text-yellow-400 bg-yellow-900/30";case"low":return"text-green-400 bg-green-900/30";default:return"text-slate-400 bg-slate-700/30"}};return n.jsxs("div",{className:`relative backdrop-blur-lg bg-gradient-to-br from-slate-800/40 to-slate-900/60 border border-slate-600/30 rounded-lg shadow-lg transition-all duration-300 w-[90px] min-h-[60px] ${t?"border-emerald-400/60 shadow-emerald-400/20 shadow-xl ring-1 ring-emerald-400/30":"border-slate-600/30 hover:border-slate-500/50 hover:shadow-lg"}`,children:[n.jsx("div",{className:"absolute inset-0 rounded-lg bg-gradient-to-br from-emerald-400/5 to-teal-400/5 opacity-60"}),n.jsx(zc,{type:"target",position:cn.Top,className:"w-2 h-2 bg-emerald-400 border border-slate-800 shadow-md shadow-emerald-400/30"}),n.jsxs("div",{className:"relative p-2 space-y-1",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("div",{className:"p-1 rounded bg-slate-700/50 backdrop-blur-sm",children:r(e.guardrailType)}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("h3",{className:"text-[10px] font-medium text-slate-100 truncate leading-tight",children:(e.label||"Guardrail").substring(0,8)}),n.jsx("p",{className:"text-[8px] text-slate-400 truncate leading-tight",children:(e.guardrailType||"Filter").substring(0,8)})]}),n.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${i(e.status)} shadow-sm`})]}),n.jsxs("div",{className:"space-y-1",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-[8px] text-slate-400",children:"Type"}),n.jsx("span",{className:"text-[7px] font-mono text-slate-300 bg-slate-700/30 px-1 py-0.5 rounded",children:(e.guardrailType||"filter").split("-")[0].substring(0,4)})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-[8px] text-slate-400",children:"Level"}),n.jsx("span",{className:`text-[7px] px-1 py-0.5 rounded ${a(e.severity)} font-mono`,children:(e.severity||"medium").substring(0,3)})]}),n.jsxs("div",{className:"flex items-center gap-1",children:[((l=e.guardrails)==null?void 0:l.length)>0&&n.jsx("div",{className:"w-4 h-4 bg-emerald-500/20 rounded flex items-center justify-center backdrop-blur-sm",children:n.jsx(dn,{className:"h-2 w-2 text-emerald-400"})}),n.jsx("span",{className:"text-[7px] bg-emerald-500/20 text-emerald-400 px-1 py-0.5 rounded backdrop-blur-sm",children:"Active"})]})]})]}),n.jsx(zc,{type:"source",position:cn.Bottom,className:"w-2 h-2 bg-emerald-400 border border-slate-800 shadow-md shadow-emerald-400/30"})]})},m3=({id:e,sourceX:t,sourceY:r,targetX:i,targetY:a,sourcePosition:l,targetPosition:d,style:s={},markerEnd:p,data:x})=>{const[w,j]=U.useState(!1),[S,P]=U.useState(!1),[F,L,B]=O6({sourceX:t,sourceY:r,sourcePosition:l,targetX:i,targetY:a,targetPosition:d}),V=()=>{const Z={strokeWidth:2,...s};switch(x==null?void 0:x.type){case"data":return{...Z,stroke:(x==null?void 0:x.status)==="active"?"#10b981":"#6b7280",strokeDasharray:(x==null?void 0:x.status)==="active"?"5,5":"none"};case"control":return{...Z,stroke:"#f59e0b",strokeDasharray:"10,5"};case"event":return{...Z,stroke:"#8b5cf6",strokeDasharray:"2,3"};case"error":return{...Z,stroke:"#ef4444",strokeDasharray:"8,3,2,3"};default:return{...Z,stroke:"#6b7280"}}},$=()=>{switch(x==null?void 0:x.type){case"data":return n.jsx(ln,{className:"h-3 w-3"});case"control":return n.jsx(Q0,{className:"h-3 w-3"});case"event":return n.jsx(Yi,{className:"h-3 w-3"});case"error":return n.jsx(fs,{className:"h-3 w-3"});default:return n.jsx(cb,{className:"h-3 w-3"})}},G=()=>{switch(x==null?void 0:x.status){case"active":return"bg-green-500/20 border-green-500 text-green-400";case"success":return"bg-blue-500/20 border-blue-500 text-blue-400";case"error":return"bg-red-500/20 border-red-500 text-red-400";default:return"bg-gray-500/20 border-gray-500 text-gray-400"}},W=()=>{switch(x==null?void 0:x.type){case"data":return"Data Flow";case"control":return"Control Flow";case"event":return"Event Trigger";case"error":return"Error Handler";default:return"Connection"}};return n.jsxs(n.Fragment,{children:[n.jsx(gS,{path:F,markerEnd:p,style:V(),className:(x==null?void 0:x.status)==="active"?"animate-pulse":""}),n.jsx(SQe,{children:n.jsxs("div",{style:{position:"absolute",transform:`translate(-50%, -50%) translate(${L}px,${B}px)`,pointerEvents:"all"},className:"nodrag nopan",onMouseEnter:()=>j(!0),onMouseLeave:()=>j(!1),children:[n.jsxs("div",{className:`
            ${G()} 
            border rounded-full px-2 py-1 
            flex items-center gap-1 
            shadow-lg backdrop-blur-sm
            transition-all duration-200
            ${w?"scale-110":"scale-100"}
            font-sans
          `,children:[$(),n.jsx("span",{className:"text-xs font-medium truncate max-w-[80px]",children:(x==null?void 0:x.label)||W()}),(x==null?void 0:x.status)==="active"&&n.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-pulse"}),n.jsx(lt,{variant:"ghost",size:"sm",className:"h-4 w-4 p-0 hover:bg-white/20",onClick:()=>P(!S),children:n.jsx(ws,{className:"h-2.5 w-2.5"})})]}),(x==null?void 0:x.condition)&&n.jsx("div",{className:"absolute -top-6 left-1/2 transform -translate-x-1/2",children:n.jsx(Tt,{variant:"outline",className:"text-xs bg-amber-500/20 border-amber-500 text-amber-400 font-mono",children:x.condition})}),S&&n.jsx("div",{className:"absolute top-8 left-1/2 transform -translate-x-1/2 z-50",children:n.jsx("div",{className:"bg-beam-dark-accent border border-gray-600 rounded-lg p-3 shadow-xl min-w-[200px] font-sans",children:n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-xs font-medium text-gray-300",children:"Connection Type"}),n.jsx(Tt,{variant:"outline",className:"text-xs",children:W()})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-xs font-medium text-gray-300",children:"Status"}),n.jsxs("div",{className:"flex items-center gap-1",children:[(x==null?void 0:x.status)==="active"&&n.jsx(Sh,{className:"h-3 w-3 text-green-400"}),(x==null?void 0:x.status)==="success"&&n.jsx($a,{className:"h-3 w-3 text-blue-400"}),(x==null?void 0:x.status)==="error"&&n.jsx(fs,{className:"h-3 w-3 text-red-400"}),n.jsx("span",{className:"text-xs capitalize",children:(x==null?void 0:x.status)||"idle"})]})]}),(x==null?void 0:x.metrics)&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-xs font-medium text-gray-300",children:"Executions"}),n.jsx("span",{className:"text-xs font-mono",children:x.metrics.executionCount})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-xs font-medium text-gray-300",children:"Avg Duration"}),n.jsxs("span",{className:"text-xs font-mono",children:[x.metrics.avgDuration,"ms"]})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-xs font-medium text-gray-300",children:"Success Rate"}),n.jsxs("span",{className:`text-xs font-mono ${x.metrics.successRate>90?"text-green-400":x.metrics.successRate>70?"text-yellow-400":"text-red-400"}`,children:[x.metrics.successRate,"%"]})]})]}),(x==null?void 0:x.condition)&&n.jsxs("div",{className:"border-t border-gray-600 pt-2 mt-2",children:[n.jsx("span",{className:"text-xs font-medium text-gray-300",children:"Condition"}),n.jsx("pre",{className:"text-xs font-mono text-amber-400 bg-gray-800 p-1 rounded mt-1",children:x.condition})]})]})})})]})})]})},Het={agent:c3,decision:u3,memory:d3,guardrail:h3},qet={enhanced:m3},Wet=[{id:"market-research-agent",type:"agent",position:{x:100,y:100},data:{label:"AI Market Research Agent",agentType:"AI Market Research Agent",model:"GPT-4o + Web Research",tools:["Real-time News Analysis","Economic Data Mining","Sentiment Analysis","Risk Detection"],guardrails:["Data Privacy","Source Verification"],memory:!0,reasoning:"chain-of-thought",status:"active",description:"Continuously scans global markets, news, and economic indicators",capabilities:["Real-time News Analysis","Economic Data Mining","Sentiment Analysis","Risk Detection"],researchSources:["Reuters","Bloomberg","SEC Filings","Fed Reports"]}},{id:"trend-analysis-agent",type:"agent",position:{x:500,y:100},data:{label:"Predictive Trend Analyzer",agentType:"Predictive Trend Analyzer",model:"Claude 3 Opus + ML Models",tools:["Pattern Recognition","Predictive Analytics","Cross-Asset Analysis","Volatility Forecasting"],guardrails:["Model Validation","Confidence Thresholds"],memory:!0,reasoning:"analytical",status:"analyzing",description:"Uses machine learning to identify market patterns and predict future trends",confidence:94}},{id:"investment-advisor",type:"agent",position:{x:900,y:100},data:{label:"Personalized Investment Advisor",agentType:"Personalized Investment Advisor",model:"GPT-4o",tools:["Portfolio Analysis","Risk Assessment","Tax Optimization","Goal-Based Planning"],guardrails:["Suitability Checks","Compliance Rules"],memory:!0,reasoning:"personalized",status:"active",description:"Analyzes complete financial profile and generates personalized recommendations"}},{id:"risk-sentinel",type:"agent",position:{x:100,y:400},data:{label:"AI Risk Sentinel",agentType:"AI Risk Sentinel",model:"Claude 3 Opus + Risk Models",tools:["Geopolitical Analysis","Correlation Monitoring","Stress Testing","Black Swan Detection"],guardrails:["Risk Limits","Alert Protocols"],memory:!0,reasoning:"risk-aware",status:"monitoring",description:"Advanced risk monitoring system that analyzes global events",riskFactors:247}},{id:"web-intelligence-agent",type:"agent",position:{x:500,y:400},data:{label:"Web Intelligence Aggregator",agentType:"Web Intelligence Aggregator",model:"GPT-4o + Web Crawling",tools:["Social Sentiment","Forum Analysis","Insider Tracking","Regulatory Monitoring"],guardrails:["Source Reliability","Information Quality"],memory:!0,reasoning:"sentiment-analysis",status:"active",description:"Crawls financial websites, forums, and social media for market intelligence",signalStrength:"High"}},{id:"financial-health",type:"agent",position:{x:900,y:400},data:{label:"Proactive Wealth Optimizer",agentType:"Proactive Wealth Optimizer",model:"GPT-4 Turbo",tools:["Multi-Account Analysis","Tax Loss Harvesting","Rebalancing","Cash Management"],guardrails:["Portfolio Limits","Tax Compliance"],memory:!0,reasoning:"optimization",status:"optimizing",description:"Monitors overall financial health and identifies optimization opportunities",potentialSavings:"$12,400"}},{id:"wealth-decision-hub",type:"decision",position:{x:500,y:250},data:{label:"Wealth Decision Hub",config:{conditions:["Risk Tolerance","Market Conditions","Client Goals"],thresholds:{risk:.7,confidence:.8}},status:"idle"}},{id:"wealth-memory-core",type:"memory",position:{x:300,y:550},data:{label:"Wealth Memory Core",config:{type:"shared-memory",persistence:!0,retention:"365 days"},status:"active"}},{id:"compliance-guardrail",type:"guardrail",position:{x:700,y:550},data:{label:"Compliance Guardrail",config:{rules:["SEC Regulations","FINRA Rules","Fiduciary Duty"],enforcement:"strict"},status:"monitoring"}}],Ket=[{id:"e1",source:"market-research-agent",target:"trend-analysis-agent",type:"enhanced",animated:!0,data:{type:"data",label:"Market Data Feed",status:"active"}},{id:"e2",source:"trend-analysis-agent",target:"investment-advisor",type:"enhanced",animated:!0,data:{type:"data",label:"Trend Insights",status:"active"}},{id:"e3",source:"market-research-agent",target:"wealth-decision-hub",type:"enhanced",animated:!0,data:{type:"control",label:"Market Intelligence",status:"active"}},{id:"e4",source:"risk-sentinel",target:"wealth-decision-hub",type:"enhanced",animated:!0,data:{type:"event",label:"Risk Alerts",status:"monitoring"}},{id:"e5",source:"web-intelligence-agent",target:"risk-sentinel",type:"enhanced",animated:!0,data:{type:"data",label:"Market Sentiment",status:"active"}},{id:"e6",source:"wealth-decision-hub",target:"investment-advisor",type:"enhanced",animated:!0,data:{type:"control",label:"Investment Decisions",status:"active"}},{id:"e7",source:"wealth-decision-hub",target:"financial-health",type:"enhanced",animated:!0,data:{type:"control",label:"Optimization Triggers",status:"active"}},{id:"e8",source:"investment-advisor",target:"wealth-memory-core",type:"enhanced",data:{type:"data",label:"Client Data",status:"active"}},{id:"e9",source:"financial-health",target:"wealth-memory-core",type:"enhanced",data:{type:"data",label:"Portfolio State",status:"active"}},{id:"e10",source:"investment-advisor",target:"compliance-guardrail",type:"enhanced",data:{type:"event",label:"Compliance Check",status:"monitoring"}},{id:"e11",source:"financial-health",target:"compliance-guardrail",type:"enhanced",data:{type:"event",label:"Regulatory Validation",status:"monitoring"}}],Zet=()=>{const[e,t,r]=QM(Wet),[i,a,l]=e3(Ket),[d,s]=U.useState(null),[p,x]=U.useState(!1),[w,j]=U.useState(!1),[S,P]=U.useState({complianceScore:98,riskLevel:"Low",auditReadiness:94,performanceScore:96,validationErrors:[]});U.useEffect(()=>{const $=setInterval(()=>{a(G=>G.map(W=>{var Z,se;return{...W,animated:Math.random()>.3,data:{...W.data,metrics:{executionCount:(((se=(Z=W.data)==null?void 0:Z.metrics)==null?void 0:se.executionCount)||0)+1,avgDuration:Math.random()*500+100,successRate:Math.random()*20+80}}}}))},2e3);return()=>clearInterval($)},[a]);const F=U.useCallback($=>{const G={...$,type:"enhanced",animated:!0,data:{type:"data",label:"Custom Connection",status:"active"}};a(W=>pS(G,W))},[a]),L=U.useCallback(($,G)=>{s(G),x(!0)},[]),B=U.useCallback(($,G)=>{t(W=>W.map(Z=>Z.id===$?{...Z,data:{...Z.data,...G}}:Z))},[t]),V=U.useCallback(()=>{j(!0),a($=>$.map(G=>({...G,animated:!0,data:{...G.data,status:"active"}}))),setTimeout(()=>{P($=>({...$,complianceScore:Math.floor(Math.random()*10)+90,performanceScore:Math.floor(Math.random()*15)+85})),a($=>$.map(G=>({...G,data:{...G.data,status:"success"}}))),j(!1)},3e3)},[a]);return n.jsxs("div",{className:"h-screen max-w-7xl mx-auto flex flex-col bg-gradient-to-br from-slate-900 via-purple-900 to-blue-900 text-slate-100 overflow-hidden",children:[n.jsx(i3,{}),n.jsxs("div",{className:"flex-1 flex w-full h-full overflow-hidden",children:[n.jsx(XQe,{}),n.jsxs("div",{className:"flex-1 relative overflow-hidden",children:[n.jsx(xce,{isRunning:w,onRun:V,onStop:()=>j(!1),onExport:()=>{},nodeCount:e.length,connectionCount:i.length,metrics:S,onShowCompliance:()=>{},onShowRiskAssessment:()=>{}}),n.jsxs(JM,{nodes:e,edges:i,onNodesChange:r,onEdgesChange:l,onConnect:F,onNodeClick:L,nodeTypes:Het,edgeTypes:qet,fitView:!0,className:"bg-gradient-to-br from-slate-900/50 via-purple-900/30 to-blue-900/50",style:{backgroundColor:"transparent"},children:[n.jsx(t3,{color:"rgba(147, 51, 234, 0.1)",gap:40,size:1,style:{backgroundColor:"transparent",opacity:.3}}),n.jsx(r3,{className:"bg-slate-800/40 backdrop-blur-lg border border-purple-400/20 shadow-lg rounded-xl",style:{background:"rgba(30, 41, 59, 0.4)",border:"1px solid rgba(147, 51, 234, 0.2)"}}),n.jsx(n3,{className:"bg-slate-800/40 backdrop-blur-lg border border-purple-400/20 shadow-lg rounded-xl",style:{background:"rgba(30, 41, 59, 0.4)",border:"1px solid rgba(147, 51, 234, 0.2)"},nodeColor:"#9333ea",maskColor:"rgba(30, 41, 59, 0.6)"})]})]}),p&&d&&n.jsx(Get,{node:d,onUpdateNode:B,onClose:()=>x(!1)})]})]})},Yet=()=>{const[e,t]=U.useState(!1),r=[{name:"Customer Journey Mapper",icon:$c,description:"Maps complete customer journeys across touchpoints and identifies friction points",status:"active",color:"text-blue-400",bgColor:"bg-blue-900/20",borderColor:"border-blue-700/30",model:"GPT-4o + Journey Analytics",capabilities:["Journey Mapping","Touchpoint Analysis","Friction Detection","Experience Optimization"]},{name:"CLV Prediction Engine",icon:En,description:"Predicts customer lifetime value and identifies high-value segments",status:"analyzing",color:"text-green-400",bgColor:"bg-green-900/20",borderColor:"border-green-700/30",model:"Claude 3 Opus + ML Models",capabilities:["CLV Forecasting","Value Segmentation","Growth Potential","Risk Assessment"]},{name:"Next Best Action Agent",icon:Ch,description:"Recommends personalized next best actions for each customer interaction",status:"active",color:"text-purple-400",bgColor:"bg-purple-900/20",borderColor:"border-purple-700/30",model:"GPT-4o + Decision Trees",capabilities:["Action Recommendations","Personalization","Timing Optimization","Channel Selection"]},{name:"Churn Prevention Agent",icon:fs,description:"Identifies at-risk customers and executes automated retention campaigns",status:"monitoring",color:"text-red-400",bgColor:"bg-red-900/20",borderColor:"border-red-700/30",model:"Claude 3 Opus + Risk Models",capabilities:["Churn Scoring","Retention Campaigns","Win-back Strategies","Proactive Intervention"]},{name:"Revenue Optimization Agent",icon:sc,description:"Optimizes pricing, upselling, and cross-selling opportunities in real-time",status:"optimizing",color:"text-yellow-400",bgColor:"bg-yellow-900/20",borderColor:"border-yellow-700/30",model:"GPT-4o + Financial Models",capabilities:["Dynamic Pricing","Upsell Triggers","Cross-sell Matching","Revenue Maximization"]},{name:"Campaign Performance Agent",icon:to,description:"Monitors campaign performance and optimizes marketing spend in real-time",status:"active",color:"text-cyan-400",bgColor:"bg-cyan-900/20",borderColor:"border-cyan-700/30",model:"GPT-4 Turbo + Analytics",capabilities:["Performance Tracking","Budget Optimization","ROI Analysis","Attribution Modeling"]},{name:"Customer Sentiment Agent",icon:ti,description:"Analyzes customer sentiment across all channels and predicts satisfaction trends",status:"active",color:"text-indigo-400",bgColor:"bg-indigo-900/20",borderColor:"border-indigo-700/30",model:"Claude 3 Opus + NLP",capabilities:["Sentiment Analysis","Social Listening","Satisfaction Prediction","Issue Detection"]},{name:"Data Enrichment Agent",icon:ln,description:"Enriches customer profiles with external data and behavioral insights",status:"processing",color:"text-emerald-400",bgColor:"bg-emerald-900/20",borderColor:"border-emerald-700/30",model:"GPT-4o + Data Pipeline",capabilities:["Data Enrichment","Profile Building","External Integration","Quality Validation"]}],i=a=>{switch(a){case"active":return n.jsx(Tt,{className:"bg-green-900/20 text-green-300 border-green-700/30",children:"Active"});case"monitoring":return n.jsx(Tt,{className:"bg-blue-900/20 text-blue-300 border-blue-700/30",children:"Monitoring"});case"analyzing":return n.jsx(Tt,{className:"bg-purple-900/20 text-purple-300 border-purple-700/30",children:"Analyzing"});case"optimizing":return n.jsx(Tt,{className:"bg-amber-900/20 text-amber-300 border-amber-700/30",children:"Optimizing"});case"processing":return n.jsx(Tt,{className:"bg-emerald-900/20 text-emerald-300 border-emerald-700/30",children:"Processing"});default:return n.jsx(Tt,{variant:"outline",children:"Inactive"})}};return e?n.jsx("div",{className:"w-12 bg-slate-800/40 backdrop-blur-lg border-r border-green-400/20 p-2",children:n.jsx("button",{onClick:()=>t(!1),className:"w-full p-2 text-green-400 hover:text-white transition-colors rounded",children:n.jsx(qi,{className:"h-5 w-5"})})}):n.jsxs("div",{className:"w-80 bg-slate-800/40 backdrop-blur-lg border-r border-green-400/20 flex flex-col",children:[n.jsxs("div",{className:"p-4 border-b border-green-400/20",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(qi,{className:"h-5 w-5 text-green-400"}),n.jsx("h2",{className:"text-lg font-semibold text-white",children:"CVM Agents"})]}),n.jsx("button",{onClick:()=>t(!0),className:"text-green-400 hover:text-white transition-colors",children:"←"})]}),n.jsx("p",{className:"text-sm text-green-300/70 mt-1",children:"Customer Value Management AI"})]}),n.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:r.map(a=>{const l=a.icon;return n.jsxs(jt,{className:`p-3 bg-slate-800/30 border ${a.borderColor} hover:border-green-400/50 transition-all duration-200 hover:shadow-lg cursor-default`,children:[n.jsx("div",{className:"flex items-start justify-between mb-2",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("div",{className:`p-2 rounded-lg ${a.bgColor} relative`,children:[n.jsx(l,{className:`h-4 w-4 ${a.color}`}),a.status==="active"&&n.jsx("div",{className:"absolute -top-1 -right-1 h-3 w-3 bg-green-500 rounded-full animate-pulse"})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-white text-xs",children:a.name}),i(a.status)]})]})}),n.jsx("p",{className:"text-slate-400 text-xs mb-2",children:a.description}),n.jsxs("div",{className:"text-xs text-slate-500 mb-2",children:["Model: ",n.jsx("span",{className:"text-slate-300",children:a.model})]}),n.jsxs("div",{className:"flex flex-wrap gap-1",children:[a.capabilities.slice(0,2).map((d,s)=>n.jsx(Tt,{variant:"outline",className:"text-xs py-0 px-1 border-slate-600 text-slate-400",children:d},s)),a.capabilities.length>2&&n.jsxs(Tt,{variant:"outline",className:"text-xs py-0 px-1 border-slate-600 text-slate-400",children:["+",a.capabilities.length-2]})]})]},a.name)})}),n.jsx("div",{className:"p-4 border-t border-green-400/20",children:n.jsxs("div",{className:"text-xs text-slate-400 space-y-1",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{children:"Active Agents:"}),n.jsx("span",{className:"text-green-400",children:"8/8"})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{children:"Workflow Status:"}),n.jsx("span",{className:"text-green-400",children:"Running"})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{children:"Performance:"}),n.jsx("span",{className:"text-cyan-400",children:"94%"})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{children:"Revenue Impact:"}),n.jsx("span",{className:"text-yellow-400",children:"+$2.4M"})]})]})})]})},AZ={"customer-data-agent":ln,"segmentation-agent":Ch,"campaign-optimizer":En,"churn-predictor":fs,"revenue-optimizer":sc,"performance-analyst":to,"cvm-memory":ti,"compliance-guardrail":dn,"insight-engine":$c,default:Hi},Xet=({node:e,onClose:t,onUpdateNode:r})=>{var S,P,F,L,B,V;const[i,a]=U.useState(e.data),l=AZ[i.agentType]||AZ.default,d=()=>{r(e.id,i),t()},s=$=>{switch($){case"active":return"text-green-400 bg-green-900/20 border-green-400/30";case"inactive":return"text-red-400 bg-red-900/20 border-red-400/30";case"warning":return"text-yellow-400 bg-yellow-900/20 border-yellow-400/30";default:return"text-gray-400 bg-gray-900/20 border-gray-400/30"}},p=$=>({"customer-journey-mapper":"You are a Customer Journey Mapping agent specialized in analyzing customer touchpoints and interactions. Map comprehensive customer journeys, identify pain points, and optimize experience flows.","clv-prediction-engine":"You are a Customer Lifetime Value prediction agent. Analyze customer data to predict CLV, identify high-value segments, and recommend retention strategies.","next-best-action":"You are a Next Best Action recommendation agent. Analyze customer context and behavior to suggest optimal actions that maximize engagement and revenue.","churn-prevention":"You are a Churn Prevention agent. Identify at-risk customers, analyze churn indicators, and recommend proactive retention strategies.","revenue-optimization":"You are a Revenue Optimization agent. Analyze pricing strategies, upselling opportunities, and revenue streams to maximize customer value.","campaign-performance":"You are a Campaign Performance analysis agent. Track campaign metrics, analyze effectiveness, and optimize marketing strategies.","customer-sentiment":"You are a Customer Sentiment analysis agent. Process customer feedback, social media, and interactions to gauge sentiment and satisfaction.","data-enrichment":"You are a Data Enrichment agent. Collect, validate, and enhance customer data from multiple sources to create comprehensive profiles."})[$]||"You are an AI agent designed to assist with customer value management tasks.",x=$=>({"customer-journey-mapper":["Journey Analyzer","Touchpoint Tracker","Experience Mapper","Pain Point Detector"],"clv-prediction-engine":["ML Predictor","Cohort Analyzer","Value Calculator","Segment Profiler"],"next-best-action":["Recommendation Engine","Context Analyzer","Action Optimizer","Engagement Tracker"],"churn-prevention":["Risk Scorer","Pattern Detector","Retention Calculator","Alert System"],"revenue-optimization":["Pricing Optimizer","Upsell Detector","Revenue Tracker","Opportunity Finder"],"campaign-performance":["Metrics Tracker","A/B Tester","ROI Calculator","Performance Analyzer"],"customer-sentiment":["Sentiment Analyzer","Text Processor","Social Monitor","Feedback Aggregator"],"data-enrichment":["Data Validator","Source Integrator","Profile Builder","Quality Checker"]})[$]||["Generic Tool","Data Processor","Analytics Engine","Report Generator"],w=$=>({"customer-journey-mapper":["PII Protection","Data Anonymization","Access Control","Journey Privacy"],"clv-prediction-engine":["Bias Detection","Fair Modeling","Data Quality","Prediction Bounds"],"next-best-action":["Ethical Recommendations","Customer Consent","Action Validation","Outcome Monitoring"],"churn-prevention":["Privacy Compliance","Intervention Ethics","Data Retention","Customer Rights"],"revenue-optimization":["Fair Pricing","Customer Value","Transparent Offers","Revenue Ethics"],"campaign-performance":["Audience Protection","Content Moderation","Targeting Ethics","Performance Bounds"],"customer-sentiment":["Sentiment Privacy","Content Security","Bias Monitoring","Response Ethics"],"data-enrichment":["Source Validation","Data Accuracy","Privacy Shield","Quality Assurance"]})[$]||["Data Protection","Privacy Compliance","Security Control","Ethics Monitor"],j=()=>{var $,G,W;return e.type==="memory"?n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"bg-slate-700/30 p-3 rounded-lg",children:[n.jsx("div",{className:"text-sm text-slate-400",children:"Storage Size"}),n.jsx("div",{className:"text-lg font-semibold text-white",children:i.size||"N/A"})]}),n.jsxs("div",{className:"bg-slate-700/30 p-3 rounded-lg",children:[n.jsx("div",{className:"text-sm text-slate-400",children:"Entries"}),n.jsx("div",{className:"text-lg font-semibold text-white",children:(($=i.entries)==null?void 0:$.toLocaleString())||"N/A"})]})]}):e.type==="guardrail"?n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"bg-slate-700/30 p-3 rounded-lg",children:[n.jsx("div",{className:"text-sm text-slate-400",children:"Violations"}),n.jsx("div",{className:"text-lg font-semibold text-green-400",children:i.violations||0})]}),n.jsxs("div",{className:"bg-slate-700/30 p-3 rounded-lg",children:[n.jsx("div",{className:"text-sm text-slate-400",children:"Last Check"}),n.jsx("div",{className:"text-sm text-white",children:i.lastCheck?new Date(i.lastCheck).toLocaleTimeString():"N/A"})]})]}):n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"bg-slate-700/30 p-3 rounded-lg",children:[n.jsx("div",{className:"text-sm text-slate-400",children:"Success Rate"}),n.jsxs("div",{className:"text-lg font-semibold text-green-400",children:[((G=i.metrics)==null?void 0:G.success)||0,"%"]})]}),n.jsxs("div",{className:"bg-slate-700/30 p-3 rounded-lg",children:[n.jsx("div",{className:"text-sm text-slate-400",children:"Avg Response"}),n.jsxs("div",{className:"text-lg font-semibold text-blue-400",children:[((W=i.metrics)==null?void 0:W.responseTime)||0,"ms"]})]})]})};return n.jsxs("div",{className:"w-80 bg-slate-800/40 backdrop-blur-lg border-l border-green-400/20 flex flex-col text-white overflow-y-auto",children:[n.jsx("div",{className:"p-4 border-b border-green-400/20",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"p-2 bg-slate-700/30 rounded-lg",children:n.jsx(l,{className:"h-5 w-5 text-green-400"})}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-lg font-semibold text-white",children:i.label}),n.jsx(Tt,{className:s(i.status),children:i.status})]})]}),n.jsx(lt,{variant:"ghost",size:"sm",onClick:t,className:"text-slate-400 hover:text-white",children:n.jsx(Pc,{className:"h-4 w-4"})})]})}),n.jsxs("div",{className:"flex-1 p-4",children:[n.jsxs($i,{defaultValue:"overview",className:"w-full",children:[n.jsxs(Di,{className:"grid w-full grid-cols-5 bg-slate-700/30",children:[n.jsx(Jt,{value:"overview",className:"text-xs",children:"Overview"}),n.jsx(Jt,{value:"prompt",className:"text-xs",children:"Prompt"}),n.jsx(Jt,{value:"tools",className:"text-xs",children:"Tools"}),n.jsx(Jt,{value:"memory",className:"text-xs",children:"Memory"}),n.jsx(Jt,{value:"guardrails",className:"text-xs",children:"Guards"})]}),n.jsxs(ur,{value:"overview",className:"space-y-4 mt-4",children:[n.jsxs("div",{children:[n.jsx(mr,{htmlFor:"label",children:"Agent Name"}),n.jsx(An,{id:"label",value:i.label,onChange:$=>a({...i,label:$.target.value}),className:"bg-slate-700 border-slate-600 text-white"})]}),n.jsxs("div",{children:[n.jsx(mr,{htmlFor:"description",children:"Description"}),n.jsx(po,{id:"description",value:i.description,onChange:$=>a({...i,description:$.target.value}),className:"bg-slate-700 border-slate-600 text-white",rows:3})]}),n.jsx(Da,{className:"bg-slate-700"}),n.jsxs("div",{children:[n.jsx(mr,{className:"text-sm font-medium text-slate-300",children:"Performance Metrics"}),n.jsx("div",{className:"mt-2",children:j()})]})]}),n.jsxs(ur,{value:"prompt",className:"space-y-4 mt-4",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[n.jsx(_s,{className:"h-4 w-4 text-green-400"}),n.jsx(mr,{className:"text-sm font-medium text-slate-300",children:"System Prompt"})]}),n.jsx(po,{value:i.prompt||p(i.agentType),onChange:$=>a({...i,prompt:$.target.value}),className:"bg-slate-700 border-slate-600 text-white min-h-[120px]",placeholder:"Enter the system prompt for this agent..."}),n.jsx("div",{className:"text-xs text-slate-400",children:"Define the agent's role, capabilities, and behavior patterns."})]}),n.jsxs(ur,{value:"tools",className:"space-y-4 mt-4",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[n.jsx(Vc,{className:"h-4 w-4 text-blue-400"}),n.jsx(mr,{className:"text-sm font-medium text-slate-300",children:"Available Tools"})]}),n.jsx("div",{className:"grid grid-cols-2 gap-2",children:x(i.agentType).map(($,G)=>n.jsxs("div",{className:"flex items-center gap-2 p-2 bg-slate-700/30 rounded border border-slate-600",children:[n.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full"}),n.jsx("span",{className:"text-sm text-slate-300",children:$})]},G))}),n.jsx(Da,{className:"bg-slate-700"}),n.jsxs("div",{children:[n.jsx(mr,{htmlFor:"model",className:"text-sm",children:"LLM Model"}),n.jsx(An,{id:"model",value:((S=i.config)==null?void 0:S.model)||"gpt-4",onChange:$=>a({...i,config:{...i.config||{},model:$.target.value}}),className:"bg-slate-700 border-slate-600 text-white mt-1"})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[n.jsxs("div",{children:[n.jsx(mr,{htmlFor:"temperature",className:"text-xs",children:"Temperature"}),n.jsx(An,{id:"temperature",type:"number",step:"0.1",min:"0",max:"2",value:((P=i.config)==null?void 0:P.temperature)||.3,onChange:$=>a({...i,config:{...i.config||{},temperature:parseFloat($.target.value)}}),className:"bg-slate-700 border-slate-600 text-white mt-1"})]}),n.jsxs("div",{children:[n.jsx(mr,{htmlFor:"maxTokens",className:"text-xs",children:"Max Tokens"}),n.jsx(An,{id:"maxTokens",type:"number",value:((F=i.config)==null?void 0:F.maxTokens)||2e3,onChange:$=>a({...i,config:{...i.config||{},maxTokens:parseInt($.target.value)}}),className:"bg-slate-700 border-slate-600 text-white mt-1"})]})]})]}),n.jsxs(ur,{value:"memory",className:"space-y-4 mt-4",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[n.jsx(ti,{className:"h-4 w-4 text-purple-400"}),n.jsx(mr,{className:"text-sm font-medium text-slate-300",children:"Memory Configuration"})]}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{children:[n.jsx(mr,{htmlFor:"memoryType",className:"text-sm",children:"Memory Type"}),n.jsx(An,{id:"memoryType",value:((L=i.memory)==null?void 0:L.type)||"Vector Store",onChange:$=>a({...i,memory:{...i.memory||{type:"Vector Store",size:"512MB",retention:"30 days"},type:$.target.value}}),className:"bg-slate-700 border-slate-600 text-white mt-1"})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[n.jsxs("div",{children:[n.jsx(mr,{htmlFor:"memorySize",className:"text-sm",children:"Size"}),n.jsx(An,{id:"memorySize",value:((B=i.memory)==null?void 0:B.size)||"512MB",onChange:$=>a({...i,memory:{...i.memory||{type:"Vector Store",size:"512MB",retention:"30 days"},size:$.target.value}}),className:"bg-slate-700 border-slate-600 text-white mt-1"})]}),n.jsxs("div",{children:[n.jsx(mr,{htmlFor:"retention",className:"text-sm",children:"Retention"}),n.jsx(An,{id:"retention",value:((V=i.memory)==null?void 0:V.retention)||"30 days",onChange:$=>a({...i,memory:{...i.memory||{type:"Vector Store",size:"512MB",retention:"30 days"},retention:$.target.value}}),className:"bg-slate-700 border-slate-600 text-white mt-1"})]})]})]}),n.jsxs("div",{className:"bg-slate-700/30 p-3 rounded-lg",children:[n.jsx("div",{className:"text-sm text-slate-400 mb-2",children:"Memory Usage"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"flex-1 bg-slate-600 rounded-full h-2",children:n.jsx("div",{className:"bg-purple-400 h-2 rounded-full",style:{width:"68%"}})}),n.jsx("span",{className:"text-sm text-slate-300",children:"68%"})]})]})]}),n.jsxs(ur,{value:"guardrails",className:"space-y-4 mt-4",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[n.jsx(dn,{className:"h-4 w-4 text-yellow-400"}),n.jsx(mr,{className:"text-sm font-medium text-slate-300",children:"Safety Guardrails"})]}),n.jsx("div",{className:"space-y-2",children:w(i.agentType).map(($,G)=>n.jsxs("div",{className:"flex items-center justify-between p-2 bg-slate-700/30 rounded border border-slate-600",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(NE,{className:"h-3 w-3 text-yellow-400"}),n.jsx("span",{className:"text-sm text-slate-300",children:$})]}),n.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full"})]},G))}),n.jsx(Da,{className:"bg-slate-700"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"bg-slate-700/30 p-3 rounded-lg text-center",children:[n.jsx(dn,{className:"h-5 w-5 text-green-400 mx-auto mb-1"}),n.jsx("div",{className:"text-xs text-slate-400",children:"Violations"}),n.jsx("div",{className:"text-lg font-bold text-green-400",children:i.violations||0})]}),n.jsxs("div",{className:"bg-slate-700/30 p-3 rounded-lg text-center",children:[n.jsx(ro,{className:"h-5 w-5 text-blue-400 mx-auto mb-1"}),n.jsx("div",{className:"text-xs text-slate-400",children:"Compliance"}),n.jsx("div",{className:"text-lg font-bold text-blue-400",children:"98.7%"})]})]})]})]}),n.jsxs("div",{className:"flex gap-2 mt-6",children:[n.jsx(lt,{onClick:d,className:"flex-1 bg-green-600 hover:bg-green-700",children:"Save Changes"}),n.jsx(lt,{onClick:t,variant:"outline",className:"flex-1 border-slate-600 text-slate-300",children:"Cancel"})]})]})]})},Jet=({isRunning:e,onRun:t,onStop:r,onExport:i,nodeCount:a,connectionCount:l,metrics:d,onShowCompliance:s,onShowRiskAssessment:p})=>{const x=j=>{switch(j){case"Low":return"text-green-400 bg-green-900/30 border-green-600";case"Medium":return"text-yellow-400 bg-yellow-900/30 border-yellow-600";case"High":return"text-red-400 bg-red-900/30 border-red-600";default:return"text-gray-400 bg-gray-900/30 border-gray-600"}},w=j=>j>=90?"text-green-400":j>=70?"text-yellow-400":"text-red-400";return n.jsx("div",{className:"absolute top-1 left-1 z-10 bg-slate-800/40 backdrop-blur-sm border border-slate-600/30 rounded-lg p-1.5 shadow-lg min-w-[600px]",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("div",{className:"flex items-center gap-1.5",children:[e?n.jsxs(lt,{onClick:r,size:"sm",className:"h-7 px-2",variant:"destructive",children:[n.jsx(LF,{className:"h-3 w-3 mr-1"}),"Stop"]}):n.jsxs(lt,{onClick:t,size:"sm",className:"h-7 px-2 bg-emerald-600 hover:bg-emerald-700 text-white shadow-md text-xs",disabled:a===0,children:[n.jsx(Sh,{className:"h-3 w-3 mr-1"}),"Run CVM"]}),n.jsxs(lt,{size:"sm",variant:"outline",className:"h-7 px-2 border-slate-600/30 text-slate-300 hover:bg-slate-700/50 bg-slate-800/40 shadow-sm text-xs",children:[n.jsx(vx,{className:"h-3 w-3 mr-1"}),"Reset"]})]}),n.jsx(Da,{orientation:"vertical",className:"h-5 bg-slate-600/30"}),n.jsxs("div",{className:"flex items-center gap-1.5",children:[n.jsxs(lt,{onClick:s,size:"sm",variant:"outline",className:"h-7 px-2 border-slate-600/30 text-slate-300 hover:bg-slate-700/50 bg-slate-800/40 shadow-sm text-xs",children:[n.jsx(dn,{className:"h-3 w-3 mr-1"}),"Compliance"]}),n.jsxs(lt,{onClick:p,size:"sm",variant:"outline",className:"h-7 px-2 border-slate-600/30 text-slate-300 hover:bg-slate-700/50 bg-slate-800/40 shadow-sm text-xs",children:[n.jsx(En,{className:"h-3 w-3 mr-1"}),"Churn Risk"]}),n.jsxs(lt,{onClick:i,size:"sm",variant:"outline",className:"h-7 px-2 border-slate-600/30 text-slate-300 hover:bg-slate-700/50 bg-slate-800/40 shadow-sm text-xs",children:[n.jsx(Nu,{className:"h-3 w-3 mr-1"}),"Export"]})]})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs("div",{className:"flex items-center gap-2 text-[10px]",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(TQ,{className:"h-2.5 w-2.5 text-emerald-400"}),n.jsx("span",{className:"text-slate-300",children:"Compliance:"}),n.jsxs("span",{className:w(d.complianceScore),children:[d.complianceScore,"%"]})]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(En,{className:"h-2.5 w-2.5 text-amber-400"}),n.jsx("span",{className:"text-slate-300",children:"Risk:"}),n.jsx(Tt,{className:`${x(d.riskLevel)} text-[9px] px-1 py-0`,children:d.riskLevel})]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(sc,{className:"h-2.5 w-2.5 text-green-400"}),n.jsx("span",{className:"text-slate-300",children:"Revenue:"}),n.jsx("span",{className:"text-green-400",children:d.revenueImpact})]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(qi,{className:"h-2.5 w-2.5 text-cyan-400"}),n.jsx("span",{className:"text-slate-300",children:"Customers:"}),n.jsx("span",{className:"text-cyan-400",children:d.customersAnalyzed.toLocaleString()})]})]}),n.jsx(Da,{orientation:"vertical",className:"h-5 bg-slate-600/30"}),n.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-slate-300",children:[n.jsxs("span",{children:[a," Agents"]}),n.jsxs("span",{children:[l," Connections"]}),n.jsxs("span",{children:[d.campaignsOptimized," Campaigns"]}),e&&n.jsxs("span",{className:"flex items-center gap-1 text-emerald-400",children:[n.jsx("div",{className:"w-1 h-1 bg-emerald-400 rounded-full animate-pulse"}),"Running"]})]})]})]})})},Qet={agent:c3,decision:u3,guardrail:h3,memory:d3},ett={enhanced:m3},ttt=[{id:"customer-data-agent",type:"agent",position:{x:100,y:100},data:{label:"Customer Data Aggregator",agentType:"Customer Data Aggregator",model:"GPT-4o + Data Pipeline",tools:["Data Integration","Real-time Processing","Quality Validation","Customer Profiling"],guardrails:["Data Privacy","GDPR Compliance"],memory:!0,reasoning:"data-centric",status:"active",description:"Aggregates customer data from billing, usage, and touchpoints",capabilities:["Data Integration","Real-time Processing","Quality Validation","Customer Profiling"],dataSources:["Billing System","Usage Analytics","CRM","Support Tickets"]}},{id:"segmentation-agent",type:"agent",position:{x:500,y:100},data:{label:"Dynamic Segmentation Engine",agentType:"Dynamic Segmentation Engine",model:"Claude 3 Opus + ML Models",tools:["Behavioral Analysis","Segment Discovery","Profile Building","Pattern Recognition"],guardrails:["Model Validation","Bias Prevention"],memory:!0,reasoning:"analytical",status:"analyzing",description:"Performs dynamic customer segmentation and behavioral analysis",confidence:94,segments:12}},{id:"campaign-optimizer",type:"agent",position:{x:900,y:100},data:{label:"Campaign Optimization Engine",agentType:"Campaign Optimization Engine",model:"GPT-4o + Optimization",tools:["A/B Testing","Channel Optimization","Performance Tracking","Budget Allocation"],guardrails:["Spending Limits","Regulatory Compliance"],memory:!0,reasoning:"optimization",status:"active",description:"Optimizes marketing campaigns and channel selection for maximum ROI",campaignsActive:8,roi:"247%"}},{id:"churn-predictor",type:"agent",position:{x:100,y:400},data:{label:"AI Churn Prevention",agentType:"AI Churn Prevention",model:"Claude 3 Opus + Risk Models",tools:["Risk Scoring","Retention Strategies","Early Warning","Intervention Planning"],guardrails:["Risk Thresholds","Customer Privacy"],memory:!0,reasoning:"predictive",status:"monitoring",description:"Predicts customer churn risk and recommends retention strategies",riskCustomers:1247,accuracy:"89%"}},{id:"revenue-optimizer",type:"agent",position:{x:500,y:400},data:{label:"Revenue Intelligence Hub",agentType:"Revenue Intelligence Hub",model:"GPT-4o + Financial Models",tools:["Price Optimization","Upsell Detection","Revenue Forecasting","Margin Analysis"],guardrails:["Pricing Rules","Market Compliance"],memory:!0,reasoning:"financial",status:"optimizing",description:"Identifies revenue optimization opportunities and pricing strategies",potentialIncrease:"$2.4M",opportunities:342}},{id:"performance-analyst",type:"agent",position:{x:900,y:400},data:{label:"CVM Performance Monitor",agentType:"CVM Performance Monitor",model:"GPT-4 Turbo + Analytics",tools:["KPI Monitoring","Trend Analysis","Report Generation","Dashboard Updates"],guardrails:["Data Accuracy","Performance Standards"],memory:!0,reasoning:"analytical",status:"active",description:"Monitors CVM KPIs and provides actionable insights",metricsTracked:47,alertsActive:3}},{id:"cvm-decision-hub",type:"decision",position:{x:500,y:250},data:{label:"CVM Decision Hub",config:{conditions:["Customer Value","Churn Risk","Revenue Potential"],thresholds:{value:.8,risk:.3,revenue:.7}},status:"active"}},{id:"cvm-memory-core",type:"memory",position:{x:300,y:550},data:{label:"CVM Memory Core",config:{type:"shared-memory",persistence:!0,retention:"2 years"},status:"active",size:"2.1GB",entries:45678}},{id:"compliance-guardrail",type:"guardrail",position:{x:700,y:550},data:{label:"Telco Compliance Guard",config:{rules:["GDPR","Telecom Regulations","Marketing Laws"],enforcement:"strict"},status:"monitoring",violations:0,lastCheck:new Date().toISOString()}}],rtt=[{id:"e1",source:"customer-data-agent",target:"segmentation-agent",type:"enhanced",animated:!0,data:{type:"data",label:"Customer Data Feed",status:"active"}},{id:"e2",source:"segmentation-agent",target:"campaign-optimizer",type:"enhanced",animated:!0,data:{type:"data",label:"Segment Insights",status:"active"}},{id:"e3",source:"customer-data-agent",target:"cvm-decision-hub",type:"enhanced",animated:!0,data:{type:"control",label:"Customer Intelligence",status:"active"}},{id:"e4",source:"churn-predictor",target:"cvm-decision-hub",type:"enhanced",animated:!0,data:{type:"event",label:"Churn Alerts",status:"monitoring"}},{id:"e5",source:"segmentation-agent",target:"churn-predictor",type:"enhanced",animated:!0,data:{type:"data",label:"Behavioral Patterns",status:"active"}},{id:"e6",source:"cvm-decision-hub",target:"campaign-optimizer",type:"enhanced",animated:!0,data:{type:"control",label:"Campaign Triggers",status:"active"}},{id:"e7",source:"cvm-decision-hub",target:"revenue-optimizer",type:"enhanced",animated:!0,data:{type:"control",label:"Revenue Opportunities",status:"active"}},{id:"e8",source:"campaign-optimizer",target:"cvm-memory-core",type:"enhanced",data:{type:"data",label:"Campaign Results",status:"active"}},{id:"e9",source:"revenue-optimizer",target:"cvm-memory-core",type:"enhanced",data:{type:"data",label:"Revenue Data",status:"active"}},{id:"e10",source:"campaign-optimizer",target:"compliance-guardrail",type:"enhanced",data:{type:"event",label:"Compliance Check",status:"monitoring"}},{id:"e11",source:"revenue-optimizer",target:"compliance-guardrail",type:"enhanced",data:{type:"event",label:"Pricing Validation",status:"monitoring"}},{id:"e12",source:"performance-analyst",target:"cvm-memory-core",type:"enhanced",data:{type:"data",label:"Performance Metrics",status:"active"}}],ntt=()=>{const[e,t,r]=QM(ttt),[i,a,l]=e3(rtt),[d,s]=U.useState(null),[p,x]=U.useState(!1),[w,j]=U.useState(!1),[S,P]=U.useState({complianceScore:98,riskLevel:"Low",auditReadiness:94,performanceScore:96,validationErrors:[],revenueImpact:"$2.4M",customersAnalyzed:45678,campaignsOptimized:12});U.useEffect(()=>{const $=setInterval(()=>{a(G=>G.map(W=>{var Z,se;return{...W,animated:Math.random()>.3,data:{...W.data,metrics:{executionCount:(((se=(Z=W.data)==null?void 0:Z.metrics)==null?void 0:se.executionCount)||0)+1,avgDuration:Math.random()*500+100,successRate:Math.random()*20+80}}}})),P(G=>({...G,customersAnalyzed:G.customersAnalyzed+Math.floor(Math.random()*10),campaignsOptimized:G.campaignsOptimized+(Math.random()>.8?1:0)}))},2e3);return()=>clearInterval($)},[a]);const F=U.useCallback($=>{const G={...$,type:"enhanced",animated:!0,data:{type:"data",label:"Custom Connection",status:"active"}};a(W=>pS(G,W))},[a]),L=U.useCallback(($,G)=>{s(G),x(!0)},[]),B=U.useCallback(($,G)=>{t(W=>W.map(Z=>Z.id===$?{...Z,data:{...Z.data,...G}}:Z))},[t]),V=U.useCallback(()=>{j(!0),a($=>$.map(G=>({...G,animated:!0,data:{...G.data,status:"active"}}))),setTimeout(()=>{P($=>({...$,complianceScore:Math.floor(Math.random()*10)+90,performanceScore:Math.floor(Math.random()*15)+85,revenueImpact:`$${(Math.random()*2+2).toFixed(1)}M`})),a($=>$.map(G=>({...G,data:{...G.data,status:"success"}}))),j(!1)},3e3)},[a]);return n.jsxs("div",{className:"h-screen max-w-7xl mx-auto flex flex-col bg-gradient-to-br from-slate-900 via-green-900 to-blue-900 text-slate-100 overflow-hidden",children:[n.jsx(i3,{}),n.jsxs("div",{className:"flex-1 flex w-full h-full overflow-hidden",children:[n.jsx(Yet,{}),n.jsxs("div",{className:"flex-1 relative overflow-hidden",children:[n.jsx(Jet,{isRunning:w,onRun:V,onStop:()=>j(!1),onExport:()=>{},nodeCount:e.length,connectionCount:i.length,metrics:S,onShowCompliance:()=>{},onShowRiskAssessment:()=>{}}),n.jsxs(JM,{nodes:e,edges:i,onNodesChange:r,onEdgesChange:l,onConnect:F,onNodeClick:L,nodeTypes:Qet,edgeTypes:ett,fitView:!0,className:"bg-gradient-to-br from-slate-900/50 via-green-900/30 to-blue-900/50",style:{backgroundColor:"transparent"},children:[n.jsx(t3,{color:"rgba(34, 197, 94, 0.1)",gap:40,size:1,style:{backgroundColor:"transparent",opacity:.3}}),n.jsx(r3,{className:"bg-slate-800/40 backdrop-blur-lg border border-green-400/20 shadow-lg rounded-xl",style:{background:"rgba(30, 41, 59, 0.4)",border:"1px solid rgba(34, 197, 94, 0.2)"}}),n.jsx(n3,{className:"bg-slate-800/40 backdrop-blur-lg border border-green-400/20 shadow-lg rounded-xl",style:{background:"rgba(30, 41, 59, 0.4)",border:"1px solid rgba(34, 197, 94, 0.2)"},nodeColor:"#22c55e",maskColor:"rgba(30, 41, 59, 0.6)"})]})]}),p&&d&&n.jsx(Xet,{node:d,onUpdateNode:B,onClose:()=>x(!1)})]})]})},itt=()=>{const[e,t]=U.useState(!1),r=[{name:"RAN Intelligence Agent",icon:wve,description:"Monitors and optimizes radio access network performance in real-time",status:"active",color:"text-blue-400",bgColor:"bg-blue-900/20",borderColor:"border-blue-700/30",model:"GPT-4o + RF Analytics",capabilities:["Signal Optimization","Coverage Analysis","Interference Detection","Capacity Planning"]},{name:"Network Performance Monitor",icon:bs,description:"Tracks KPIs across all cell sites and identifies performance degradation",status:"monitoring",color:"text-green-400",bgColor:"bg-green-900/20",borderColor:"border-green-700/30",model:"Claude 3 Opus + Time Series",capabilities:["KPI Monitoring","Anomaly Detection","Performance Trending","Alert Generation"]},{name:"Predictive Maintenance Agent",icon:ws,description:"Predicts equipment failures and schedules optimal maintenance windows",status:"analyzing",color:"text-purple-400",bgColor:"bg-purple-900/20",borderColor:"border-purple-700/30",model:"GPT-4o + Predictive Models",capabilities:["Failure Prediction","Maintenance Scheduling","Resource Planning","Cost Optimization"]},{name:"Coverage Optimization Agent",icon:ex,description:"Optimizes cell site placement and coverage patterns for maximum efficiency",status:"optimizing",color:"text-cyan-400",bgColor:"bg-cyan-900/20",borderColor:"border-cyan-700/30",model:"Claude 3 Opus + Geospatial",capabilities:["Site Planning","Coverage Modeling","Interference Mitigation","Capacity Allocation"]},{name:"Traffic Flow Optimizer",icon:En,description:"Analyzes and optimizes network traffic patterns for peak performance",status:"active",color:"text-yellow-400",bgColor:"bg-yellow-900/20",borderColor:"border-yellow-700/30",model:"GPT-4o + Traffic Analytics",capabilities:["Load Balancing","Congestion Management","QoS Optimization","Bandwidth Allocation"]},{name:"Fault Detection Agent",icon:fs,description:"Detects network faults and initiates automated recovery procedures",status:"monitoring",color:"text-red-400",bgColor:"bg-red-900/20",borderColor:"border-red-700/30",model:"Claude 3 Opus + Fault Analytics",capabilities:["Fault Detection","Root Cause Analysis","Auto Recovery","Escalation Management"]},{name:"Security Monitoring Agent",icon:dn,description:"Monitors network security and detects potential threats or breaches",status:"active",color:"text-orange-400",bgColor:"bg-orange-900/20",borderColor:"border-orange-700/30",model:"GPT-4 Turbo + Security Analytics",capabilities:["Threat Detection","Security Scanning","Compliance Monitoring","Incident Response"]},{name:"Energy Efficiency Agent",icon:Yi,description:"Optimizes power consumption across network infrastructure for sustainability",status:"optimizing",color:"text-emerald-400",bgColor:"bg-emerald-900/20",borderColor:"border-emerald-700/30",model:"GPT-4o + Energy Models",capabilities:["Power Optimization","Green Operations","Carbon Tracking","Cost Reduction"]}],i=a=>{switch(a){case"active":return n.jsx(Tt,{className:"bg-green-900/20 text-green-300 border-green-700/30",children:"Active"});case"monitoring":return n.jsx(Tt,{className:"bg-blue-900/20 text-blue-300 border-blue-700/30",children:"Monitoring"});case"analyzing":return n.jsx(Tt,{className:"bg-purple-900/20 text-purple-300 border-purple-700/30",children:"Analyzing"});case"optimizing":return n.jsx(Tt,{className:"bg-amber-900/20 text-amber-300 border-amber-700/30",children:"Optimizing"});default:return n.jsx(Tt,{variant:"outline",children:"Inactive"})}};return e?n.jsx("div",{className:"w-12 bg-slate-800/40 backdrop-blur-lg border-r border-blue-400/20 p-2",children:n.jsx("button",{onClick:()=>t(!1),className:"w-full p-2 text-blue-400 hover:text-white transition-colors rounded",children:n.jsx(kc,{className:"h-5 w-5"})})}):n.jsxs("div",{className:"w-80 bg-slate-800/40 backdrop-blur-lg border-r border-blue-400/20 flex flex-col",children:[n.jsxs("div",{className:"p-4 border-b border-blue-400/20",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(kc,{className:"h-5 w-5 text-blue-400"}),n.jsx("h2",{className:"text-lg font-semibold text-white",children:"Network Agents"})]}),n.jsx("button",{onClick:()=>t(!0),className:"text-blue-400 hover:text-white transition-colors",children:"←"})]}),n.jsx("p",{className:"text-sm text-blue-300/70 mt-1",children:"Digital Twin Network AI"})]}),n.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:r.map(a=>{const l=a.icon;return n.jsxs(jt,{className:`p-3 bg-slate-800/30 border ${a.borderColor} hover:border-blue-400/50 transition-all duration-200 hover:shadow-lg cursor-default`,children:[n.jsx("div",{className:"flex items-start justify-between mb-2",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("div",{className:`p-2 rounded-lg ${a.bgColor} relative`,children:[n.jsx(l,{className:`h-4 w-4 ${a.color}`}),a.status==="active"&&n.jsx("div",{className:"absolute -top-1 -right-1 h-3 w-3 bg-green-500 rounded-full animate-pulse"})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-white text-xs",children:a.name}),i(a.status)]})]})}),n.jsx("p",{className:"text-slate-400 text-xs mb-2",children:a.description}),n.jsxs("div",{className:"text-xs text-slate-500 mb-2",children:["Model: ",n.jsx("span",{className:"text-slate-300",children:a.model})]}),n.jsxs("div",{className:"flex flex-wrap gap-1",children:[a.capabilities.slice(0,2).map((d,s)=>n.jsx(Tt,{variant:"outline",className:"text-xs py-0 px-1 border-slate-600 text-slate-400",children:d},s)),a.capabilities.length>2&&n.jsxs(Tt,{variant:"outline",className:"text-xs py-0 px-1 border-slate-600 text-slate-400",children:["+",a.capabilities.length-2]})]})]},a.name)})}),n.jsx("div",{className:"p-4 border-t border-blue-400/20",children:n.jsxs("div",{className:"text-xs text-slate-400 space-y-1",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{children:"Active Agents:"}),n.jsx("span",{className:"text-blue-400",children:"8/8"})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{children:"Network Status:"}),n.jsx("span",{className:"text-green-400",children:"Optimal"})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{children:"Coverage:"}),n.jsx("span",{className:"text-cyan-400",children:"94.2%"})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{children:"Energy Savings:"}),n.jsx("span",{className:"text-yellow-400",children:"18.7%"})]})]})})]})},stt=({node:e,onUpdateNode:t,onClose:r})=>{const[i,a]=U.useState(e.data),d=(P=>{switch(P){case"RAN Intelligence Agent":return kc;case"Network Performance Monitor":return bs;case"Predictive Maintenance Agent":return ws;case"Coverage Optimization Agent":return ex;case"Fault Detection Agent":return fs;case"Traffic Flow Optimizer":return En;default:return kc}})(i.agentType||""),s=()=>{t(e.id,i),r()},p=(P,F)=>{a(L=>({...L,[P]:F}))},x=P=>{switch(P){case"active":return"text-green-400 bg-green-900/20 border-green-700/30";case"monitoring":return"text-blue-400 bg-blue-900/20 border-blue-700/30";case"analyzing":return"text-purple-400 bg-purple-900/20 border-purple-700/30";case"optimizing":return"text-amber-400 bg-amber-900/20 border-amber-700/30";default:return"text-gray-400 bg-gray-900/20 border-gray-700/30"}},w=P=>({"RAN Intelligence Agent":"You are a RAN Intelligence agent specialized in radio access network optimization. Monitor network performance, analyze coverage patterns, and optimize radio resources for maximum efficiency.","Network Performance Monitor":"You are a Network Performance monitoring agent. Track network KPIs, detect performance anomalies, and provide real-time insights into network health and quality of service.","Predictive Maintenance Agent":"You are a Predictive Maintenance agent for telecom networks. Analyze equipment health data, predict potential failures, and recommend proactive maintenance actions.","Coverage Optimization Agent":"You are a Coverage Optimization agent. Analyze signal strength patterns, identify coverage gaps, and recommend antenna adjustments and site placements.","Fault Detection Agent":"You are a Fault Detection agent. Monitor network elements for failures, classify fault types, and trigger appropriate remediation workflows.","Traffic Flow Optimizer":"You are a Traffic Flow optimization agent. Analyze network traffic patterns, predict congestion, and optimize routing and load balancing strategies."})[P]||"You are a Network Twin AI agent designed to assist with telecommunications network management and optimization.",j=P=>({"RAN Intelligence Agent":["RAN Analyzer","Coverage Mapper","Signal Optimizer","Interference Detector"],"Network Performance Monitor":["KPI Tracker","Latency Analyzer","Throughput Monitor","Quality Assessor"],"Predictive Maintenance Agent":["Health Monitor","Failure Predictor","Maintenance Scheduler","Equipment Tracker"],"Coverage Optimization Agent":["Signal Analyzer","Coverage Planner","Antenna Optimizer","Site Selector"],"Fault Detection Agent":["Fault Scanner","Alert Generator","Root Cause Analyzer","Recovery Planner"],"Traffic Flow Optimizer":["Traffic Analyzer","Load Balancer","Route Optimizer","Congestion Predictor"]})[P]||["Network Scanner","Data Processor","Analytics Engine","Report Generator"],S=P=>({"RAN Intelligence Agent":["RF Safety Limits","Interference Protection","Power Control","Spectrum Compliance"],"Network Performance Monitor":["Alert Thresholds","Data Privacy","Monitoring Bounds","Quality Gates"],"Predictive Maintenance Agent":["Safety Protocols","Maintenance Windows","Equipment Limits","Service Continuity"],"Coverage Optimization Agent":["RF Exposure Limits","Environmental Impact","Zoning Compliance","Neighbor Impact"],"Fault Detection Agent":["False Positive Control","Escalation Rules","Service Protection","Recovery Bounds"],"Traffic Flow Optimizer":["QoS Protection","Fair Usage","Network Stability","Service Level Agreements"]})[P]||["Network Protection","Safety Compliance","Service Quality","Performance Bounds"];return n.jsxs("div",{className:"w-96 bg-slate-800/40 backdrop-blur-lg border-l border-blue-400/20 flex flex-col",children:[n.jsx("div",{className:"p-4 border-b border-blue-400/20",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"p-2 rounded-lg bg-blue-900/20",children:n.jsx(d,{className:"h-5 w-5 text-blue-400"})}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-lg font-semibold text-white",children:i.label}),n.jsx(Tt,{className:x(i.status),children:i.status})]})]}),n.jsx(lt,{variant:"ghost",size:"sm",onClick:r,className:"text-slate-400 hover:text-white",children:n.jsx(Pc,{className:"h-4 w-4"})})]})}),n.jsx("div",{className:"flex-1 p-4",children:n.jsxs($i,{defaultValue:"overview",className:"w-full",children:[n.jsxs(Di,{className:"grid w-full grid-cols-5 bg-slate-700/30",children:[n.jsx(Jt,{value:"overview",className:"text-xs",children:"Overview"}),n.jsx(Jt,{value:"prompt",className:"text-xs",children:"Prompt"}),n.jsx(Jt,{value:"tools",className:"text-xs",children:"Tools"}),n.jsx(Jt,{value:"memory",className:"text-xs",children:"Memory"}),n.jsx(Jt,{value:"guardrails",className:"text-xs",children:"Guards"})]}),n.jsxs(ur,{value:"overview",className:"space-y-4 mt-4",children:[n.jsxs("div",{children:[n.jsx(mr,{htmlFor:"label",children:"Agent Name"}),n.jsx(An,{id:"label",value:i.label||"",onChange:P=>p("label",P.target.value),className:"bg-slate-700 border-slate-600 text-white"})]}),n.jsxs("div",{children:[n.jsx(mr,{htmlFor:"description",children:"Description"}),n.jsx(po,{id:"description",value:i.description||"",onChange:P=>p("description",P.target.value),className:"bg-slate-700 border-slate-600 text-white",rows:3})]}),n.jsx(Da,{className:"bg-slate-700"}),n.jsxs("div",{children:[n.jsx(mr,{className:"text-sm font-medium text-slate-300",children:"Network Metrics"}),n.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-4",children:[i.activeSites&&n.jsxs("div",{className:"bg-slate-700/30 p-3 rounded-lg",children:[n.jsx("div",{className:"text-sm text-slate-400",children:"Active Sites"}),n.jsx("div",{className:"text-lg font-semibold text-white",children:i.activeSites})]}),i.coverageScore&&n.jsxs("div",{className:"bg-slate-700/30 p-3 rounded-lg",children:[n.jsx("div",{className:"text-sm text-slate-400",children:"Coverage Score"}),n.jsxs("div",{className:"text-lg font-semibold text-green-400",children:[i.coverageScore,"%"]})]}),i.kpisTracked&&n.jsxs("div",{className:"bg-slate-700/30 p-3 rounded-lg",children:[n.jsx("div",{className:"text-sm text-slate-400",children:"KPIs Tracked"}),n.jsx("div",{className:"text-lg font-semibold text-white",children:i.kpisTracked})]}),i.alertsActive&&n.jsxs("div",{className:"bg-slate-700/30 p-3 rounded-lg",children:[n.jsx("div",{className:"text-sm text-slate-400",children:"Active Alerts"}),n.jsx("div",{className:"text-lg font-semibold text-yellow-400",children:i.alertsActive})]})]})]}),i.capabilities&&Array.isArray(i.capabilities)&&n.jsxs("div",{children:[n.jsx(mr,{className:"text-sm font-medium text-slate-300",children:"Capabilities"}),n.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:i.capabilities.map((P,F)=>n.jsx(Tt,{variant:"outline",className:"border-slate-600 text-slate-400",children:P},F))})]})]}),n.jsxs(ur,{value:"prompt",className:"space-y-4 mt-4",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[n.jsx(_s,{className:"h-4 w-4 text-blue-400"}),n.jsx(mr,{className:"text-sm font-medium text-slate-300",children:"System Prompt"})]}),n.jsx(po,{value:i.prompt||w(i.agentType||""),onChange:P=>p("prompt",P.target.value),className:"bg-slate-700 border-slate-600 text-white min-h-[120px]",placeholder:"Enter the system prompt for this agent..."}),n.jsx("div",{className:"text-xs text-slate-400",children:"Define the agent's role, capabilities, and behavior patterns for network management."})]}),n.jsxs(ur,{value:"tools",className:"space-y-4 mt-4",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[n.jsx(Vc,{className:"h-4 w-4 text-blue-400"}),n.jsx(mr,{className:"text-sm font-medium text-slate-300",children:"Available Tools"})]}),n.jsx("div",{className:"grid grid-cols-2 gap-2",children:j(i.agentType||"").map((P,F)=>n.jsxs("div",{className:"flex items-center gap-2 p-2 bg-slate-700/30 rounded border border-slate-600",children:[n.jsx("div",{className:"w-2 h-2 bg-blue-400 rounded-full"}),n.jsx("span",{className:"text-sm text-slate-300",children:P})]},F))}),n.jsx(Da,{className:"bg-slate-700"}),n.jsxs("div",{children:[n.jsx(mr,{htmlFor:"model",className:"text-sm",children:"AI Model"}),n.jsx(An,{id:"model",value:i.model||"gpt-4",onChange:P=>p("model",P.target.value),className:"bg-slate-700 border-slate-600 text-white mt-1"})]})]}),n.jsxs(ur,{value:"memory",className:"space-y-4 mt-4",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[n.jsx(ti,{className:"h-4 w-4 text-purple-400"}),n.jsx(mr,{className:"text-sm font-medium text-slate-300",children:"Memory Configuration"})]}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx(mr,{htmlFor:"memoryEnabled",className:"text-slate-300",children:"Memory Enabled"}),n.jsx(ko,{id:"memoryEnabled",checked:i.memory||!1,onCheckedChange:P=>p("memory",P)})]}),n.jsxs("div",{children:[n.jsx(mr,{htmlFor:"memoryType",className:"text-sm",children:"Memory Type"}),n.jsx(An,{id:"memoryType",value:i.memoryType||"Network Vector Store",onChange:P=>p("memoryType",P.target.value),className:"bg-slate-700 border-slate-600 text-white mt-1"})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[n.jsxs("div",{children:[n.jsx(mr,{htmlFor:"memorySize",className:"text-sm",children:"Size"}),n.jsx(An,{id:"memorySize",value:i.memorySize||"1GB",onChange:P=>p("memorySize",P.target.value),className:"bg-slate-700 border-slate-600 text-white mt-1"})]}),n.jsxs("div",{children:[n.jsx(mr,{htmlFor:"retention",className:"text-sm",children:"Retention"}),n.jsx(An,{id:"retention",value:i.retention||"90 days",onChange:P=>p("retention",P.target.value),className:"bg-slate-700 border-slate-600 text-white mt-1"})]})]})]}),n.jsxs("div",{className:"bg-slate-700/30 p-3 rounded-lg",children:[n.jsx("div",{className:"text-sm text-slate-400 mb-2",children:"Memory Usage"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"flex-1 bg-slate-600 rounded-full h-2",children:n.jsx("div",{className:"bg-purple-400 h-2 rounded-full",style:{width:"45%"}})}),n.jsx("span",{className:"text-sm text-slate-300",children:"45%"})]})]})]}),n.jsxs(ur,{value:"guardrails",className:"space-y-4 mt-4",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[n.jsx(dn,{className:"h-4 w-4 text-yellow-400"}),n.jsx(mr,{className:"text-sm font-medium text-slate-300",children:"Network Guardrails"})]}),n.jsx("div",{className:"space-y-2",children:S(i.agentType||"").map((P,F)=>n.jsxs("div",{className:"flex items-center gap-2 p-2 bg-slate-700/30 rounded border border-slate-600",children:[n.jsx("div",{className:"w-2 h-2 bg-yellow-400 rounded-full"}),n.jsx("span",{className:"text-sm text-slate-300",children:P})]},F))}),n.jsxs("div",{className:"bg-slate-700/30 p-3 rounded-lg",children:[n.jsx("div",{className:"text-sm text-slate-400 mb-2",children:"Guardrail Status"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full"}),n.jsx("span",{className:"text-sm text-slate-300",children:"All guardrails active"})]})]})]})]})}),n.jsx(Da,{className:"bg-blue-400/20"}),n.jsxs("div",{className:"p-4 space-y-3",children:[n.jsx(lt,{onClick:s,className:"w-full bg-blue-600 hover:bg-blue-700",children:"Save Changes"}),n.jsx(lt,{variant:"outline",onClick:r,className:"w-full border-slate-600 text-slate-300",children:"Cancel"})]})]})},att=({isRunning:e,onRun:t,onStop:r,onExport:i,nodeCount:a,connectionCount:l,metrics:d,onShowCompliance:s,onShowRiskAssessment:p})=>n.jsxs("div",{className:"absolute top-4 left-4 right-4 z-10 flex flex-wrap gap-4",children:[n.jsx(jt,{className:"bg-slate-800/40 backdrop-blur-lg border-blue-400/20 p-3",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(kc,{className:"h-4 w-4 text-blue-400"}),n.jsx("span",{className:"text-sm font-medium text-white",children:"Network Twin Workflow"})]}),n.jsx("div",{className:"h-4 w-px bg-blue-400/20"}),n.jsxs("div",{className:"flex items-center gap-2",children:[e?n.jsxs(lt,{onClick:r,size:"sm",variant:"destructive",children:[n.jsx(LF,{className:"h-3 w-3 mr-1"}),"Stop"]}):n.jsxs(lt,{onClick:t,size:"sm",className:"bg-blue-600 hover:bg-blue-700 text-white",children:[n.jsx(Sh,{className:"h-3 w-3 mr-1"}),"Run"]}),n.jsxs(lt,{onClick:i,size:"sm",variant:"outline",className:"border-slate-600 text-slate-300 hover:text-white",children:[n.jsx(Nu,{className:"h-3 w-3 mr-1"}),"Export"]})]}),n.jsx("div",{className:"h-4 w-px bg-blue-400/20"}),n.jsxs("div",{className:"text-xs text-slate-400",children:[a," agents • ",l," connections"]})]})}),n.jsx(jt,{className:"bg-slate-800/40 backdrop-blur-lg border-blue-400/20 p-3 flex-1 min-w-0",children:n.jsxs("div",{className:"flex items-center justify-between gap-4",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(bs,{className:"h-4 w-4 text-green-400"}),n.jsxs("div",{children:[n.jsx("div",{className:"text-xs text-slate-400",children:"Network Health"}),n.jsxs("div",{className:"text-sm font-semibold text-green-400",children:[d.networkHealth,"%"]})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(kc,{className:"h-4 w-4 text-blue-400"}),n.jsxs("div",{children:[n.jsx("div",{className:"text-xs text-slate-400",children:"Coverage"}),n.jsx("div",{className:"text-sm font-semibold text-blue-400",children:d.coverageLevel})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(fs,{className:"h-4 w-4 text-yellow-400"}),n.jsxs("div",{children:[n.jsx("div",{className:"text-xs text-slate-400",children:"Active Faults"}),n.jsx("div",{className:"text-sm font-semibold text-yellow-400",children:d.faultCount})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(dn,{className:"h-4 w-4 text-purple-400"}),n.jsxs("div",{children:[n.jsx("div",{className:"text-xs text-slate-400",children:"Energy Savings"}),n.jsx("div",{className:"text-sm font-semibold text-purple-400",children:d.energySavings})]})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Tt,{className:`${e?"bg-green-900/20 text-green-300 border-green-700/30":"bg-slate-900/20 text-slate-300 border-slate-700/30"}`,children:e?"Running":"Idle"}),n.jsx(lt,{onClick:s,size:"sm",variant:"outline",className:"border-slate-600 text-slate-300 hover:text-white text-xs",children:"Compliance"}),n.jsx(lt,{onClick:p,size:"sm",variant:"outline",className:"border-slate-600 text-slate-300 hover:text-white text-xs",children:"Risk Assessment"})]})]})}),n.jsx(jt,{className:"bg-slate-800/40 backdrop-blur-lg border-blue-400/20 p-3",children:n.jsxs("div",{className:"flex items-center gap-4 text-xs",children:[n.jsxs("div",{className:"text-slate-400",children:["Sites: ",n.jsx("span",{className:"text-white font-semibold",children:d.sitesMonitored})]}),n.jsxs("div",{className:"text-slate-400",children:["Performance: ",n.jsxs("span",{className:"text-cyan-400 font-semibold",children:[d.performanceScore,"%"]})]}),n.jsxs("div",{className:"text-slate-400",children:["Maintenance: ",n.jsx("span",{className:"text-amber-400 font-semibold",children:d.maintenanceScheduled})]})]})})]}),ott={agent:c3,decision:u3,guardrail:h3,memory:d3},ltt={enhanced:m3},ctt=[{id:"ran-intelligence",type:"agent",position:{x:100,y:100},data:{label:"RAN Intelligence Agent",agentType:"RAN Intelligence Agent",model:"GPT-4o + RF Analytics",tools:["Signal Optimization","Coverage Analysis","Interference Detection","Capacity Planning"],guardrails:["RF Safety","Regulatory Compliance"],memory:!0,reasoning:"analytical",status:"active",description:"Monitors and optimizes radio access network performance",capabilities:["Signal Optimization","Coverage Analysis","Interference Detection","Capacity Planning"],activeSites:420,coverageScore:94}},{id:"performance-monitor",type:"agent",position:{x:500,y:100},data:{label:"Network Performance Monitor",agentType:"Network Performance Monitor",model:"Claude 3 Opus + Time Series",tools:["KPI Monitoring","Anomaly Detection","Performance Trending","Alert Generation"],guardrails:["Performance Thresholds","Alert Limits"],memory:!0,reasoning:"monitoring",status:"active",description:"Tracks KPIs across all cell sites and identifies performance issues",kpisTracked:47,alertsActive:3}},{id:"maintenance-predictor",type:"agent",position:{x:900,y:100},data:{label:"Predictive Maintenance Agent",agentType:"Predictive Maintenance Agent",model:"GPT-4o + Predictive Models",tools:["Failure Prediction","Maintenance Scheduling","Resource Planning","Cost Optimization"],guardrails:["Safety Protocols","Maintenance Windows"],memory:!0,reasoning:"predictive",status:"analyzing",description:"Predicts equipment failures and schedules maintenance",predictedFailures:12,maintenanceScheduled:8}},{id:"coverage-optimizer",type:"agent",position:{x:100,y:400},data:{label:"Coverage Optimization Agent",agentType:"Coverage Optimization Agent",model:"Claude 3 Opus + Geospatial",tools:["Site Planning","Coverage Modeling","Interference Mitigation","Capacity Allocation"],guardrails:["Zoning Laws","Environmental Impact"],memory:!0,reasoning:"optimization",status:"optimizing",description:"Optimizes cell site placement and coverage patterns",optimizationScore:87,newSitesRecommended:5}},{id:"traffic-optimizer",type:"agent",position:{x:500,y:400},data:{label:"Traffic Flow Optimizer",agentType:"Traffic Flow Optimizer",model:"GPT-4o + Traffic Analytics",tools:["Load Balancing","Congestion Management","QoS Optimization","Bandwidth Allocation"],guardrails:["SLA Requirements","QoS Standards"],memory:!0,reasoning:"optimization",status:"active",description:"Analyzes and optimizes network traffic patterns",congestionReduced:"23%",trafficOptimized:2.4}},{id:"fault-detector",type:"agent",position:{x:900,y:400},data:{label:"Fault Detection Agent",agentType:"Fault Detection Agent",model:"Claude 3 Opus + Fault Analytics",tools:["Fault Detection","Root Cause Analysis","Auto Recovery","Escalation Management"],guardrails:["Recovery Protocols","Escalation Rules"],memory:!0,reasoning:"diagnostic",status:"monitoring",description:"Detects network faults and initiates recovery procedures",faultsDetected:7,autoRecovered:5}},{id:"network-decision-hub",type:"decision",position:{x:500,y:250},data:{label:"Network Decision Hub",config:{conditions:["Performance Score","Coverage Level","Fault Status"],thresholds:{performance:.85,coverage:.9,faults:.05}},status:"active"}},{id:"network-memory-core",type:"memory",position:{x:300,y:550},data:{label:"Network Memory Core",config:{type:"time-series-memory",persistence:!0,retention:"1 year"},status:"active",size:"5.2GB",entries:124567}},{id:"telecom-compliance-guard",type:"guardrail",position:{x:700,y:550},data:{label:"Telecom Compliance Guard",config:{rules:["RF Safety","Telecom Regulations","Environmental Laws"],enforcement:"strict"},status:"monitoring",violations:0,lastCheck:new Date().toISOString()}}],utt=[{id:"e1",source:"ran-intelligence",target:"performance-monitor",type:"enhanced",animated:!0,data:{type:"data",label:"RF Performance Data",status:"active"}},{id:"e2",source:"performance-monitor",target:"network-decision-hub",type:"enhanced",animated:!0,data:{type:"data",label:"KPI Metrics",status:"active"}},{id:"e3",source:"ran-intelligence",target:"coverage-optimizer",type:"enhanced",animated:!0,data:{type:"data",label:"Coverage Analysis",status:"active"}},{id:"e4",source:"maintenance-predictor",target:"network-decision-hub",type:"enhanced",animated:!0,data:{type:"event",label:"Maintenance Alerts",status:"monitoring"}},{id:"e5",source:"coverage-optimizer",target:"traffic-optimizer",type:"enhanced",animated:!0,data:{type:"data",label:"Coverage Patterns",status:"active"}},{id:"e6",source:"network-decision-hub",target:"traffic-optimizer",type:"enhanced",animated:!0,data:{type:"control",label:"Traffic Control",status:"active"}},{id:"e7",source:"fault-detector",target:"network-decision-hub",type:"enhanced",animated:!0,data:{type:"event",label:"Fault Alerts",status:"monitoring"}},{id:"e8",source:"performance-monitor",target:"network-memory-core",type:"enhanced",data:{type:"data",label:"Performance History",status:"active"}},{id:"e9",source:"maintenance-predictor",target:"network-memory-core",type:"enhanced",data:{type:"data",label:"Maintenance Records",status:"active"}},{id:"e10",source:"ran-intelligence",target:"telecom-compliance-guard",type:"enhanced",data:{type:"event",label:"RF Safety Check",status:"monitoring"}},{id:"e11",source:"coverage-optimizer",target:"telecom-compliance-guard",type:"enhanced",data:{type:"event",label:"Zoning Compliance",status:"monitoring"}},{id:"e12",source:"traffic-optimizer",target:"network-memory-core",type:"enhanced",data:{type:"data",label:"Traffic Patterns",status:"active"}}],dtt=()=>{const[e,t,r]=QM(ctt),[i,a,l]=e3(utt),[d,s]=U.useState(null),[p,x]=U.useState(!1),[w,j]=U.useState(!1),[S,P]=U.useState({networkHealth:94,coverageLevel:"Excellent",performanceScore:87,faultCount:2,validationErrors:[],energySavings:"18.7%",sitesMonitored:420,maintenanceScheduled:8});U.useEffect(()=>{const $=setInterval(()=>{a(G=>G.map(W=>{var Z,se;return{...W,animated:Math.random()>.3,data:{...W.data,metrics:{executionCount:(((se=(Z=W.data)==null?void 0:Z.metrics)==null?void 0:se.executionCount)||0)+1,avgDuration:Math.random()*500+100,successRate:Math.random()*20+80}}}})),P(G=>({...G,sitesMonitored:G.sitesMonitored+Math.floor(Math.random()*5),faultCount:Math.max(0,G.faultCount+(Math.random()>.9?1:-1))}))},2e3);return()=>clearInterval($)},[a]);const F=U.useCallback($=>{const G={...$,type:"enhanced",animated:!0,data:{type:"data",label:"Custom Connection",status:"active"}};a(W=>pS(G,W))},[a]),L=U.useCallback(($,G)=>{s(G),x(!0)},[]),B=U.useCallback(($,G)=>{t(W=>W.map(Z=>Z.id===$?{...Z,data:{...Z.data,...G}}:Z))},[t]),V=U.useCallback(()=>{j(!0),a($=>$.map(G=>({...G,animated:!0,data:{...G.data,status:"active"}}))),setTimeout(()=>{P($=>({...$,networkHealth:Math.floor(Math.random()*10)+90,performanceScore:Math.floor(Math.random()*15)+85,energySavings:`${(Math.random()*10+15).toFixed(1)}%`})),a($=>$.map(G=>({...G,data:{...G.data,status:"success"}}))),j(!1)},3e3)},[a]);return n.jsxs("div",{className:"h-screen max-w-7xl mx-auto flex flex-col bg-gradient-to-br from-slate-900 via-blue-900 to-indigo-900 text-slate-100 overflow-hidden",children:[n.jsx(i3,{}),n.jsxs("div",{className:"flex-1 flex w-full h-full overflow-hidden",children:[n.jsx(itt,{}),n.jsxs("div",{className:"flex-1 relative overflow-hidden",children:[n.jsx(att,{isRunning:w,onRun:V,onStop:()=>j(!1),onExport:()=>{},nodeCount:e.length,connectionCount:i.length,metrics:S,onShowCompliance:()=>{},onShowRiskAssessment:()=>{}}),n.jsxs(JM,{nodes:e,edges:i,onNodesChange:r,onEdgesChange:l,onConnect:F,onNodeClick:L,nodeTypes:ott,edgeTypes:ltt,fitView:!0,className:"bg-gradient-to-br from-slate-900/50 via-blue-900/30 to-indigo-900/50",style:{backgroundColor:"transparent"},children:[n.jsx(t3,{color:"rgba(59, 130, 246, 0.1)",gap:40,size:1,style:{backgroundColor:"transparent",opacity:.3}}),n.jsx(r3,{className:"bg-slate-800/40 backdrop-blur-lg border border-blue-400/20 shadow-lg rounded-xl",style:{background:"rgba(30, 41, 59, 0.4)",border:"1px solid rgba(59, 130, 246, 0.2)"}}),n.jsx(n3,{className:"bg-slate-800/40 backdrop-blur-lg border border-blue-400/20 shadow-lg rounded-xl",style:{background:"rgba(30, 41, 59, 0.4)",border:"1px solid rgba(59, 130, 246, 0.2)"},nodeColor:"#3b82f6",maskColor:"rgba(30, 41, 59, 0.6)"})]})]}),p&&d&&n.jsx(stt,{node:d,onUpdateNode:B,onClose:()=>x(!1)})]})]})};class htt{constructor(t="http://localhost:7860",r){u0(this,"baseUrl");u0(this,"apiKey");u0(this,"servers",[]);u0(this,"tools",[]);this.baseUrl=t,this.apiKey=r,this.loadFromStorage()}loadFromStorage(){try{const t=localStorage.getItem("mcp-gateway-servers"),r=localStorage.getItem("mcp-gateway-tools");t?this.servers=JSON.parse(t):(this.servers=this.getMockServers(),this.saveToStorage()),r?this.tools=JSON.parse(r):this.refreshToolsFromServers()}catch(t){console.error("Failed to load from storage:",t),this.servers=this.getMockServers(),this.refreshToolsFromServers()}}saveToStorage(){try{localStorage.setItem("mcp-gateway-servers",JSON.stringify(this.servers)),localStorage.setItem("mcp-gateway-tools",JSON.stringify(this.tools))}catch(t){console.error("Failed to save to storage:",t)}}refreshToolsFromServers(){this.tools=[];for(const t of this.servers)if(t.status==="connected"){const r=this.getMockToolsForServer(t.id);this.tools=[...this.tools,...r]}this.saveToStorage()}async getServers(){try{return[...this.servers]}catch(t){throw console.error("Failed to fetch MCP servers:",t),t}}async getTools(t){try{let r=[...this.tools];return t&&(r=this.filterTools(r,t)),r}catch(r){throw console.error("Failed to fetch MCP tools:",r),r}}async searchTools(t,r){try{return(await this.getTools(r)).filter(l=>l.name.toLowerCase().includes(t.toLowerCase())||l.description.toLowerCase().includes(t.toLowerCase())||l.category.toLowerCase().includes(t.toLowerCase())).sort((l,d)=>d.popularity-l.popularity)}catch(i){throw console.error("Failed to search MCP tools:",i),i}}async getServerTools(t){try{return this.getMockToolsForServer(t)}catch(r){throw console.error(`Failed to fetch tools for server ${t}:`,r),r}}async testServerConnection(t){try{return await new Promise(r=>setTimeout(r,1e3)),Math.random()>.1}catch(r){return console.error(`Failed to test connection to server ${t}:`,r),!1}}async registerServer(t){try{const r={id:Date.now().toString(),name:t.name||"Unnamed Server",description:t.description||"",url:t.url||"",status:"disconnected",type:t.type||"remote",transport:t.transport||"auto",supportedTransports:t.supportedTransports||["streamable-http"],toolCount:0,categories:t.categories||[],tags:t.tags||[],stars:0,license:t.license||"Unknown",isPython:t.isPython||!1,enabled:t.enabled!==!1,authentication:t.authentication||{type:"none"},agentCompatibility:t.agentCompatibility,lastHealthCheck:new Date};return this.servers.push(r),this.saveToStorage(),r}catch(r){throw console.error("Failed to register MCP server:",r),r}}async updateServer(t,r){try{const i=this.servers.findIndex(a=>a.id===t);if(i===-1)throw new Error("Server not found");return this.servers[i]={...this.servers[i],...r},this.saveToStorage(),this.servers[i]}catch(i){throw console.error("Failed to update MCP server:",i),i}}async deleteServer(t){try{this.servers=this.servers.filter(r=>r.id!==t),this.tools=this.tools.filter(r=>r.serverId!==t),this.saveToStorage()}catch(r){throw console.error("Failed to delete MCP server:",r),r}}async createTool(t,r){try{const i=this.servers.find(l=>l.id===t);if(!i)throw new Error("Server not found");const a={id:Date.now().toString(),name:r.name||"Unnamed Tool",description:r.description||"",parameters:r.parameters||{},category:r.category||"other",serverId:t,serverName:i.name,popularity:r.popularity||0,verified:r.verified||!1,agentRecommended:r.agentRecommended||!1,usageComplexity:r.usageComplexity||"simple",requiredPermissions:r.requiredPermissions||[]};return this.tools.push(a),i.toolCount=this.tools.filter(l=>l.serverId===t).length,this.saveToStorage(),a}catch(i){throw console.error("Failed to create MCP tool:",i),i}}async updateTool(t,r){try{const i=this.tools.findIndex(a=>a.id===t);if(i===-1)throw new Error("Tool not found");return this.tools[i]={...this.tools[i],...r},this.saveToStorage(),this.tools[i]}catch(i){throw console.error("Failed to update MCP tool:",i),i}}async deleteTool(t){try{const r=this.tools.find(i=>i.id===t);if(r){this.tools=this.tools.filter(a=>a.id!==t);const i=this.servers.find(a=>a.id===r.serverId);i&&(i.toolCount=this.tools.filter(a=>a.serverId===r.serverId).length),this.saveToStorage()}}catch(r){throw console.error("Failed to delete MCP tool:",r),r}}async createAgentToolBindings(t,r){try{const i=[];for(const a of r){const l=await this.getToolById(a.toolId,a.serverId);if(l){const d={agentId:t,toolId:a.toolId,serverId:a.serverId,permissions:l.requiredPermissions||[],enabled:!0,createdAt:new Date};i.push(d)}}return i}catch(i){throw console.error("Failed to create agent tool bindings:",i),i}}async getRecommendedTools(t){try{return(await this.getTools()).filter(i=>i.agentRecommended).sort((i,a)=>a.popularity-i.popularity).slice(0,10)}catch(r){throw console.error("Failed to get recommended tools:",r),r}}async getToolById(t,r){return(await this.getServerTools(r)).find(a=>a.id===t)||null}filterTools(t,r){return t.filter(i=>!(r.category&&r.category!=="all"&&i.category!==r.category||r.verified!==void 0&&i.verified!==r.verified||r.agentRecommended!==void 0&&i.agentRecommended!==r.agentRecommended||r.complexity&&i.usageComplexity!==r.complexity||r.minPopularity&&i.popularity<r.minPopularity))}getMockServers(){return[{id:"aws-agentcore-1",name:"AWS AgentCore Gateway",description:"Enterprise AWS services through MCP protocol with Cognito authentication",url:"https://gateway.aws.agentcore.com/mcp",status:"connected",type:"aws",transport:"streamable-http",supportedTransports:["streamable-http","sse"],toolCount:15,categories:["aws","cloud","database","storage"],tags:["enterprise","verified","aws","production"],stars:4.8,license:"Apache-2.0",isPython:!1,enabled:!0,authentication:{type:"cognito"},agentCompatibility:{frameworks:["agentcore","strands","custom"],minVersion:"1.0.0",maxConcurrency:10},lastHealthCheck:new Date},{id:"github-enterprise-1",name:"GitHub Enterprise Tools",description:"GitHub API access with enterprise authentication and advanced workflows",url:"https://mcp.github.enterprise.com/api",status:"connected",type:"remote",transport:"sse",supportedTransports:["sse","streamable-http"],toolCount:8,categories:["git","collaboration","api","workflow"],tags:["github","enterprise","verified","collaboration"],stars:4.6,license:"MIT",isPython:!1,enabled:!0,authentication:{type:"oauth2"},agentCompatibility:{frameworks:["agentcore","strands","custom"],minVersion:"1.2.0",maxConcurrency:5},lastHealthCheck:new Date},{id:"local-dev-tools-1",name:"Local Development Tools",description:"Local development utilities with secure file system access",url:"http://localhost:3001/mcp",status:"connected",type:"local",transport:"auto",supportedTransports:["sse","streamable-http"],toolCount:12,categories:["filesystem","development","utilities","testing"],tags:["local","development","testing","utilities"],stars:4.2,license:"MIT",isPython:!0,enabled:!0,authentication:{type:"none"},agentCompatibility:{frameworks:["agentcore","strands","custom"],minVersion:"0.9.0",maxConcurrency:3},lastHealthCheck:new Date}]}getMockToolsForServer(t){return{"aws-agentcore-1":[{id:"aws-s3-upload",name:"S3 File Upload",description:"Upload files to AWS S3 with enterprise security and automatic encryption",parameters:{bucket:"string",key:"string",file:"binary",metadata:"object"},category:"aws",serverId:"aws-agentcore-1",serverName:"AWS AgentCore Gateway",popularity:95,verified:!0,agentRecommended:!0,usageComplexity:"simple",requiredPermissions:["s3:PutObject","s3:PutObjectAcl"]},{id:"aws-dynamodb-query",name:"DynamoDB Query",description:"Query DynamoDB tables with advanced filtering and pagination",parameters:{tableName:"string",keyCondition:"object",filterExpression:"string"},category:"aws",serverId:"aws-agentcore-1",serverName:"AWS AgentCore Gateway",popularity:88,verified:!0,agentRecommended:!0,usageComplexity:"moderate",requiredPermissions:["dynamodb:Query","dynamodb:GetItem"]},{id:"aws-lambda-invoke",name:"Lambda Function Invoke",description:"Invoke AWS Lambda functions with payload and async support",parameters:{functionName:"string",payload:"object",invocationType:"string"},category:"aws",serverId:"aws-agentcore-1",serverName:"AWS AgentCore Gateway",popularity:82,verified:!0,agentRecommended:!1,usageComplexity:"advanced",requiredPermissions:["lambda:InvokeFunction"]}],"github-enterprise-1":[{id:"github-create-pr",name:"Create Pull Request",description:"Create pull requests with automated workflows and review assignments",parameters:{repo:"string",title:"string",body:"string",base:"string",head:"string"},category:"git",serverId:"github-enterprise-1",serverName:"GitHub Enterprise Tools",popularity:92,verified:!0,agentRecommended:!0,usageComplexity:"moderate",requiredPermissions:["repo:write","pull_requests:write"]},{id:"github-search-code",name:"Search Code",description:"Search code across repositories with advanced filters and syntax highlighting",parameters:{query:"string",repo:"string",language:"string",path:"string"},category:"git",serverId:"github-enterprise-1",serverName:"GitHub Enterprise Tools",popularity:78,verified:!0,agentRecommended:!1,usageComplexity:"simple",requiredPermissions:["repo:read"]}],"local-dev-tools-1":[{id:"file-read-secure",name:"Secure File Read",description:"Read local files with permission checks and content validation",parameters:{path:"string",encoding:"string",maxSize:"number"},category:"filesystem",serverId:"local-dev-tools-1",serverName:"Local Development Tools",popularity:76,verified:!1,agentRecommended:!0,usageComplexity:"simple",requiredPermissions:["file:read"]},{id:"run-tests",name:"Run Test Suite",description:"Execute test suites with coverage reporting and result analysis",parameters:{testPath:"string",framework:"string",coverage:"boolean"},category:"development",serverId:"local-dev-tools-1",serverName:"Local Development Tools",popularity:84,verified:!1,agentRecommended:!0,usageComplexity:"moderate",requiredPermissions:["exec:test"]}]}[t]||[]}}const ah=new htt,mtt=({onAddAgent:e,onAddUtility:t,onSelectMCPTool:r})=>{const[i,a]=U.useState(!1),[l,d]=U.useState([]),[s,p]=U.useState(!1);U.useEffect(()=>{(async()=>{try{p(!0);const P=await ah.getTools();d(P)}catch(P){console.error("Failed to load MCP tools:",P)}finally{p(!1)}})()},[]);const x=[{name:"Researcher Agent",icon:$c,description:"Researches and gathers information"},{name:"Coder Agent",icon:Bc,description:"Writes and reviews code"},{name:"Writer Agent",icon:Nh,description:"Creates content and documentation"},{name:"Analyst Agent",icon:Xye,description:"Analyzes data and provides insights"},{name:"Coordinator Agent",icon:Hi,description:"Orchestrates other agents"},{name:"Chat Agent",icon:_s,description:"Handles conversations"}],w=[{name:"decision",icon:Q0,description:"Decision point in workflow"},{name:"memory",icon:ln,description:"Shared memory storage"},{name:"guardrail",icon:dn,description:"Safety and compliance checks"}],j=S=>{switch(S){case"aws":return ln;case"git":return Bc;case"filesystem":return eo;case"api":return Zs;case"text":return Yi;default:return ws}};return i?n.jsx("div",{className:"w-12 bg-beam-dark-accent border-r border-gray-700 p-2",children:n.jsx(lt,{variant:"ghost",size:"sm",onClick:()=>a(!1),className:"w-full p-2 text-gray-400 hover:text-white",children:n.jsx(Hi,{className:"h-5 w-5"})})}):n.jsxs("div",{className:"w-80 bg-beam-dark-accent border-r border-gray-700 flex flex-col",children:[n.jsx("div",{className:"p-4 border-b border-gray-700",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("h2",{className:"text-lg font-semibold text-white",children:"Agent Palette"}),n.jsx(lt,{variant:"ghost",size:"sm",onClick:()=>a(!0),className:"text-gray-400 hover:text-white",children:"←"})]})}),n.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:n.jsxs($i,{defaultValue:"agents",className:"w-full",children:[n.jsxs(Di,{className:"grid w-full grid-cols-3 bg-beam-dark",children:[n.jsx(Jt,{value:"agents",className:"text-gray-300 data-[state=active]:text-white text-xs",children:"Agents"}),n.jsx(Jt,{value:"utilities",className:"text-gray-300 data-[state=active]:text-white text-xs",children:"Utilities"}),n.jsx(Jt,{value:"mcp-tools",className:"text-gray-300 data-[state=active]:text-white text-xs",children:"MCP Tools"})]}),n.jsx(ur,{value:"agents",className:"space-y-3 mt-4",children:x.map(S=>n.jsx(jt,{className:"p-3 bg-beam-dark border-gray-700 hover:border-beam-blue cursor-pointer transition-colors",onClick:()=>e(S.name),children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx(S.icon,{className:"h-6 w-6 text-beam-blue mt-0.5"}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-sm font-medium text-white",children:S.name}),n.jsx("p",{className:"text-xs text-gray-400 mt-1",children:S.description})]})]})},S.name))}),n.jsx(ur,{value:"utilities",className:"space-y-3 mt-4",children:w.map(S=>n.jsx(jt,{className:"p-3 bg-beam-dark border-gray-700 hover:border-beam-blue cursor-pointer transition-colors",onClick:()=>t(S.name),children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx(S.icon,{className:"h-6 w-6 text-amber-400 mt-0.5"}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-sm font-medium text-white capitalize",children:S.name}),n.jsx("p",{className:"text-xs text-gray-400 mt-1",children:S.description})]})]})},S.name))}),n.jsx(ur,{value:"mcp-tools",className:"space-y-3 mt-4",children:s?n.jsxs("div",{className:"text-center py-8",children:[n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-beam-blue mx-auto"}),n.jsx("p",{className:"text-gray-400 text-sm mt-2",children:"Loading MCP tools..."})]}):l.length===0?n.jsxs("div",{className:"text-center py-8",children:[n.jsx(eo,{className:"h-12 w-12 text-gray-500 mx-auto mb-2"}),n.jsx("p",{className:"text-gray-400 text-sm",children:"No MCP tools available"}),n.jsx("p",{className:"text-gray-500 text-xs mt-1",children:"Connect to MCP Gateway first"})]}):n.jsxs("div",{className:"space-y-2",children:[n.jsx("div",{className:"text-xs text-gray-400 mb-3",children:"Drag tools to agents to add capabilities"}),l.map(S=>{const P=j(S.category);return n.jsx(jt,{className:"p-2 bg-beam-dark border-gray-700 hover:border-beam-blue cursor-grab active:cursor-grabbing transition-colors",draggable:!0,onDragStart:F=>{F.dataTransfer.setData("application/json",JSON.stringify({type:"mcp-tool",tool:S}))},onClick:()=>r==null?void 0:r(S),children:n.jsxs("div",{className:"flex items-start gap-2",children:[n.jsx(P,{className:"h-4 w-4 text-blue-400 mt-0.5 flex-shrink-0"}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[n.jsx("h3",{className:"text-xs font-medium text-white truncate",children:S.name}),S.verified&&n.jsx(Tt,{variant:"outline",className:"text-xs px-1 py-0 h-4 bg-green-500/20 text-green-400 border-green-500/30",children:"✓"})]}),n.jsx("p",{className:"text-xs text-gray-400 line-clamp-2",children:S.description}),n.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[n.jsx(Tt,{variant:"outline",className:"text-xs px-1 py-0 h-4",children:S.category}),n.jsx(Tt,{variant:"outline",className:"text-xs px-1 py-0 h-4",children:S.usageComplexity})]})]})]})},`${S.serverId}-${S.id}`)})]})})]})})]})},ftt=({node:e,onUpdateNode:t,onClose:r})=>{const[i,a]=U.useState(e.data),l=()=>{t(e.id,i)},d=(P,F)=>{const L={...i,[P]:F};a(L),t(e.id,L)},s=P=>{switch(P){case"aws":return ln;case"git":return Bc;case"filesystem":return eo;case"api":return Zs;case"text":return Yi;default:return ws}},p=(P,F)=>{const B=(i.mcpTools||[]).filter(V=>!(V.id===P&&V.serverId===F));d("mcpTools",B)},x=()=>n.jsxs($i,{defaultValue:"general",className:"w-full",children:[n.jsxs(Di,{className:"grid w-full grid-cols-2 bg-beam-dark",children:[n.jsx(Jt,{value:"general",className:"text-gray-300 data-[state=active]:text-white text-xs",children:"General"}),n.jsx(Jt,{value:"mcp-tools",className:"text-gray-300 data-[state=active]:text-white text-xs",children:"MCP Tools"})]}),n.jsxs(ur,{value:"general",className:"space-y-4 mt-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(mr,{className:"text-white text-sm",children:"Agent Name"}),n.jsx(An,{value:i.label||"",onChange:P=>d("label",P.target.value),className:"bg-beam-dark border-gray-600 text-white text-sm",placeholder:"Enter agent name"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(mr,{className:"text-white text-sm",children:"Model"}),n.jsxs(_n,{value:i.model||"gpt-4",onValueChange:P=>d("model",P),children:[n.jsx(xn,{className:"bg-beam-dark border-gray-600 text-white text-sm",children:n.jsx(wn,{})}),n.jsxs(yn,{className:"bg-beam-dark border-gray-600",children:[n.jsx(yt,{value:"gpt-4",children:"GPT-4"}),n.jsx(yt,{value:"gpt-4-turbo",children:"GPT-4 Turbo"}),n.jsx(yt,{value:"claude-3-opus",children:"Claude 3 Opus"}),n.jsx(yt,{value:"claude-3-sonnet",children:"Claude 3 Sonnet"})]})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(mr,{className:"text-white text-sm",children:"System Prompt"}),n.jsx(po,{value:i.systemPrompt||"",onChange:P=>d("systemPrompt",P.target.value),className:"bg-beam-dark border-gray-600 text-white text-sm min-h-[80px]",placeholder:"Define the agent's role and behavior..."})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(mr,{className:"text-white text-sm",children:"Reasoning Strategy"}),n.jsxs(_n,{value:i.reasoning||"chain-of-thought",onValueChange:P=>d("reasoning",P),children:[n.jsx(xn,{className:"bg-beam-dark border-gray-600 text-white text-sm",children:n.jsx(wn,{})}),n.jsxs(yn,{className:"bg-beam-dark border-gray-600",children:[n.jsx(yt,{value:"chain-of-thought",children:"Chain of Thought"}),n.jsx(yt,{value:"tree-of-thought",children:"Tree of Thought"}),n.jsx(yt,{value:"reflection",children:"Reflection"}),n.jsx(yt,{value:"planning",children:"Planning"})]})]})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx(mr,{className:"text-white text-sm",children:"Enable Memory"}),n.jsx(ko,{checked:i.memory||!1,onCheckedChange:P=>d("memory",P)})]})]}),n.jsxs(ur,{value:"mcp-tools",className:"space-y-3 mt-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsxs(mr,{className:"text-white text-sm",children:["MCP Tools (",(i.mcpTools||[]).length,")"]}),n.jsx("p",{className:"text-xs text-gray-400",children:"Drag tools from the palette or manage existing ones"})]}),n.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:(i.mcpTools||[]).length===0?n.jsxs("div",{className:"text-center py-6",children:[n.jsx(eo,{className:"h-8 w-8 text-gray-500 mx-auto mb-2"}),n.jsx("p",{className:"text-gray-400 text-xs",children:"No MCP tools added"}),n.jsx("p",{className:"text-gray-500 text-xs mt-1",children:"Drag tools from the MCP Tools tab"})]}):(i.mcpTools||[]).map((P,F)=>{const L=s(P.category);return n.jsx(jt,{className:"p-2 bg-beam-dark border-gray-700",children:n.jsxs("div",{className:"flex items-start gap-2",children:[n.jsx(L,{className:"h-4 w-4 text-blue-400 mt-0.5 flex-shrink-0"}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[n.jsx("h4",{className:"text-xs font-medium text-white truncate",children:P.name}),P.verified&&n.jsx(Tt,{variant:"outline",className:"text-xs px-1 py-0 h-4 bg-green-500/20 text-green-400 border-green-500/30",children:"✓"})]}),n.jsx("p",{className:"text-xs text-gray-400 line-clamp-2",children:P.description}),n.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[n.jsx(Tt,{variant:"outline",className:"text-xs px-1 py-0 h-4",children:P.category}),n.jsx(Tt,{variant:"outline",className:"text-xs px-1 py-0 h-4",children:P.serverName})]})]}),n.jsx(lt,{variant:"ghost",size:"sm",onClick:()=>p(P.id,P.serverId),className:"h-6 w-6 p-0 text-red-400 hover:text-red-300 hover:bg-red-400/10",children:n.jsx(BN,{className:"h-3 w-3"})})]})},`${P.serverId}-${P.id}-${F}`)})})]})]}),w=()=>n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(mr,{className:"text-white text-sm",children:"Memory Type"}),n.jsxs(_n,{value:i.memoryType||"short-term",onValueChange:P=>d("memoryType",P),children:[n.jsx(xn,{className:"bg-beam-dark border-gray-600 text-white text-sm",children:n.jsx(wn,{})}),n.jsxs(yn,{className:"bg-beam-dark border-gray-600",children:[n.jsx(yt,{value:"short-term",children:"Short-term (Cache)"}),n.jsx(yt,{value:"long-term",children:"Long-term (Persistent)"}),n.jsx(yt,{value:"episodic",children:"Episodic (Events)"}),n.jsx(yt,{value:"semantic",children:"Semantic (Knowledge)"})]})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(mr,{className:"text-white text-sm",children:"Memory Size (MB)"}),n.jsx(An,{type:"number",value:i.memorySize||100,onChange:P=>d("memorySize",parseInt(P.target.value)),className:"bg-beam-dark border-gray-600 text-white text-sm"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(mr,{className:"text-white text-sm",children:"Retention Period (Days)"}),n.jsx(An,{type:"number",value:i.retentionDays||30,onChange:P=>d("retentionDays",parseInt(P.target.value)),className:"bg-beam-dark border-gray-600 text-white text-sm"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(mr,{className:"text-white text-sm",children:"Agent Context"}),n.jsx(An,{value:i.agentContext||"",onChange:P=>d("agentContext",P.target.value),className:"bg-beam-dark border-gray-600 text-white text-sm",placeholder:"e.g., KYC, AML, Credit..."})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx(mr,{className:"text-white text-sm",children:"Encryption"}),n.jsx(ko,{checked:i.encryption||!0,onCheckedChange:P=>d("encryption",P)})]})]}),j=()=>n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"space-y-3",children:[n.jsx(mr,{className:"text-white",children:"Guardrail Type"}),n.jsxs(_n,{value:i.guardrailType||"content-filter",onValueChange:P=>d("guardrailType",P),children:[n.jsx(xn,{className:"bg-beam-dark border-gray-600 text-white",children:n.jsx(wn,{})}),n.jsxs(yn,{className:"bg-beam-dark border-gray-600",children:[n.jsx(yt,{value:"content-filter",children:"Content Filter"}),n.jsx(yt,{value:"pii-protection",children:"PII Protection"}),n.jsx(yt,{value:"bias-detection",children:"Bias Detection"}),n.jsx(yt,{value:"toxicity-check",children:"Toxicity Check"})]})]})]}),n.jsxs("div",{className:"space-y-3",children:[n.jsx(mr,{className:"text-white",children:"Severity Level"}),n.jsxs(_n,{value:i.severity||"medium",onValueChange:P=>d("severity",P),children:[n.jsx(xn,{className:"bg-beam-dark border-gray-600 text-white",children:n.jsx(wn,{})}),n.jsxs(yn,{className:"bg-beam-dark border-gray-600",children:[n.jsx(yt,{value:"low",children:"Low"}),n.jsx(yt,{value:"medium",children:"Medium"}),n.jsx(yt,{value:"high",children:"High"}),n.jsx(yt,{value:"critical",children:"Critical"})]})]})]})]}),S=()=>{switch(e.type){case"agent":return n.jsx(Hi,{className:"h-5 w-5 text-beam-blue"});case"memory":return n.jsx(ln,{className:"h-5 w-5 text-green-400"});case"guardrail":return n.jsx(dn,{className:"h-5 w-5 text-amber-400"});case"compliance":return n.jsx(cve,{className:"h-5 w-5 text-amber-400"});case"risk":return n.jsx(En,{className:"h-5 w-5 text-blue-400"});case"audit":return n.jsx($c,{className:"h-5 w-5 text-purple-400"});default:return n.jsx(ws,{className:"h-5 w-5 text-gray-400"})}};return n.jsxs("div",{className:"w-60 bg-beam-dark-accent border-l border-gray-700 flex flex-col",children:[n.jsxs("div",{className:"p-2 border-b border-gray-700",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[S(),n.jsx("h2",{className:"text-sm font-semibold text-white",children:"Properties"})]}),n.jsx(lt,{variant:"ghost",size:"sm",onClick:r,className:"text-gray-400 hover:text-white",children:n.jsx(Pc,{className:"h-4 w-4"})})]}),n.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["Configure ",e.type," settings"]})]}),n.jsxs("div",{className:"flex-1 overflow-y-auto p-2",children:[e.type==="agent"&&x(),e.type==="memory"&&w(),e.type==="guardrail"&&j(),(e.type==="compliance"||e.type==="risk"||e.type==="audit")&&n.jsxs("div",{className:"text-center text-gray-400 py-6",children:[n.jsxs("p",{className:"text-sm",children:["Banking-specific ",e.type," configuration"]}),n.jsx("p",{className:"text-xs mt-1",children:"Advanced settings available in full version"})]})]}),n.jsx("div",{className:"p-2 border-t border-gray-700",children:n.jsxs("div",{className:"flex gap-2",children:[n.jsx(lt,{onClick:l,className:"flex-1 bg-beam-blue hover:bg-beam-blue/90 text-sm py-1",children:"Save"}),n.jsx(lt,{variant:"outline",onClick:r,className:"border-gray-600 text-gray-300 hover:bg-beam-dark text-sm py-1",children:"Cancel"})]})})]})},ptt={agent:c3,decision:u3,memory:d3,guardrail:h3},gtt={enhanced:m3},xtt=[],ytt=[],TZ=()=>{const[e,t,r]=QM(xtt),[i,a,l]=e3(ytt),[d,s]=U.useState(null),[p,x]=U.useState(!1),[w,j]=U.useState(!1),[,S]=U.useState(null),[P]=U.useState({complianceScore:100,riskLevel:"Low",auditReadiness:100,performanceScore:100,validationErrors:[]}),F=U.useCallback(Z=>{const se={...Z,type:"enhanced",animated:!0,data:{type:"data",label:"Data Flow",status:"idle"}};a(ae=>pS(se,ae))},[a]),L=U.useCallback((Z,se)=>{s(se),x(!0)},[]),B=U.useCallback((Z,se)=>{t(ae=>ae.map(ce=>ce.id===Z?{...ce,data:{...ce.data,...se}}:ce))},[t]),V=U.useCallback(Z=>{const se={id:`${Z.toLowerCase().replace(" ","-")}-${Date.now()}`,type:"agent",position:{x:Math.random()*400+100,y:Math.random()*300+100},data:{label:Z,agentType:Z,model:"gpt-4",tools:[],mcpTools:[],guardrails:[],memory:!0,reasoning:"chain-of-thought",status:"idle"}};t(ae=>ae.concat(se))},[t]),$=U.useCallback(Z=>{if(S(Z),d&&d.type==="agent"){const se=d.data.mcpTools||[];if(!se.some(ce=>ce.id===Z.id&&ce.serverId===Z.serverId)){const ce=[...se,Z];B(d.id,{mcpTools:ce})}}},[d,B]),G=U.useCallback(Z=>{const se={id:`${Z}-${Date.now()}`,type:Z,position:{x:Math.random()*400+100,y:Math.random()*300+100},data:{label:Z.charAt(0).toUpperCase()+Z.slice(1),config:{},status:"idle"}};t(ae=>ae.concat(se))},[t]),W=U.useCallback(()=>{j(!0),a(Z=>Z.map(se=>({...se,animated:!0,data:{...se.data,status:"active"}}))),setTimeout(()=>{a(Z=>Z.map(se=>({...se,data:{...se.data,status:"success"}}))),j(!1)},3e3)},[a]);return n.jsxs("div",{className:"h-screen flex flex-col bg-gradient-to-br from-slate-900 via-blue-900 to-purple-900 text-slate-100 overflow-hidden",children:[n.jsx(i3,{}),n.jsxs("div",{className:"flex-1 flex w-full h-full overflow-hidden",children:[n.jsx(mtt,{onAddAgent:V,onAddUtility:G,onSelectMCPTool:$}),n.jsxs("div",{className:"flex-1 relative overflow-hidden",children:[n.jsx(xce,{isRunning:w,onRun:W,onStop:()=>j(!1),onExport:()=>{},nodeCount:e.length,connectionCount:i.length,metrics:P,onShowCompliance:()=>{},onShowRiskAssessment:()=>{}}),n.jsxs(JM,{nodes:e,edges:i,onNodesChange:r,onEdgesChange:l,onConnect:F,onNodeClick:L,nodeTypes:ptt,edgeTypes:gtt,fitView:!0,className:"bg-gradient-to-br from-slate-900/50 via-blue-900/30 to-purple-900/50",style:{backgroundColor:"transparent"},onDrop:Z=>{Z.preventDefault();const se=Z.dataTransfer.getData("application/json");if(se)try{const ae=JSON.parse(se);if(ae.type==="mcp-tool"){const ce=Z.currentTarget.getBoundingClientRect(),Pe=Z.clientX-ce.left,we=Z.clientY-ce.top,xe=e.find(Ne=>{const ze=document.querySelector(`[data-id="${Ne.id}"]`);if(ze){const ye=ze.getBoundingClientRect(),ve={left:ye.left-ce.left,top:ye.top-ce.top,right:ye.right-ce.left,bottom:ye.bottom-ce.top};return Pe>=ve.left&&Pe<=ve.right&&we>=ve.top&&we<=ve.bottom}return!1});if(xe&&xe.type==="agent"){const Ne=xe.data.mcpTools||[];if(!Ne.some(ye=>ye.id===ae.tool.id&&ye.serverId===ae.tool.serverId)){const ye=[...Ne,ae.tool];B(xe.id,{mcpTools:ye})}}}}catch(ae){console.error("Failed to parse drop data:",ae)}},onDragOver:Z=>{Z.preventDefault(),Z.dataTransfer.dropEffect="copy"},children:[n.jsx(t3,{color:"rgba(100, 200, 255, 0.1)",gap:40,size:1,style:{backgroundColor:"transparent",opacity:.3}}),n.jsx(r3,{className:"bg-slate-800/40 backdrop-blur-lg border border-cyan-400/20 shadow-lg rounded-xl",style:{background:"rgba(30, 41, 59, 0.8)",border:"1px solid rgba(34, 211, 238, 0.2)",zIndex:1e3}}),n.jsx(n3,{className:"bg-slate-800/40 backdrop-blur-lg border border-cyan-400/20 shadow-lg rounded-xl",style:{background:"rgba(30, 41, 59, 0.8)",border:"1px solid rgba(34, 211, 238, 0.2)",zIndex:1e3},nodeColor:"#22d3ee",maskColor:"rgba(30, 41, 59, 0.6)"})]}),e.length===0&&n.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"w-24 h-24 mx-auto mb-4 bg-slate-800/40 rounded-full flex items-center justify-center border-2 border-dashed border-slate-600",children:n.jsx(Mo,{className:"w-12 h-12 text-slate-500"})}),n.jsx("h3",{className:"text-xl font-medium text-slate-300 mb-2",children:"Start Building Your Workflow"}),n.jsx("p",{className:"text-slate-500 max-w-md",children:"Drag agents from the palette to create your multi-agent orchestration. Connect them to define relationships and data flow."})]})})]}),p&&d&&n.jsx(ftt,{node:d,onUpdateNode:B,onClose:()=>x(!1)})]})]})},vtt=({onSelectProject:e})=>{var s;const[t,r]=U.useState(null),i=[{id:"cvm-management",title:"Telco CVM Management Centre",description:"Complete Customer Value Management workflow with 6 specialized AI agents for customer segmentation, campaign optimization, and revenue growth.",icon:qi,color:"text-green-400",bgColor:"bg-green-900/20",borderColor:"border-green-400/30",status:"completed",agents:6,connections:12,features:["Customer Segmentation","Campaign Management","Churn Prediction","Revenue Optimization"],preview:"/placeholder-cvm.jpg"},{id:"wealth-management",title:"AI Wealth Management Centre",description:"Complete wealth management workflow with 6 specialized AI agents for market research, risk analysis, and investment optimization.",icon:En,color:"text-purple-400",bgColor:"bg-purple-900/20",borderColor:"border-purple-400/30",status:"completed",agents:6,connections:11,features:["Real-time Market Research","Risk Monitoring","Portfolio Optimization","Compliance Checks"],preview:"/placeholder-wealth.jpg"},{id:"network-twin",title:"Network Twin Digital Centre",description:"Complete network digital twin workflow with 8 specialized AI agents for RAN optimization, predictive maintenance, and coverage analysis.",icon:kc,color:"text-blue-400",bgColor:"bg-blue-900/20",borderColor:"border-blue-400/30",status:"completed",agents:8,connections:12,features:["RAN Intelligence","Predictive Maintenance","Coverage Optimization","Energy Efficiency"],preview:"/placeholder-network.jpg"},{id:"customer-service",title:"Customer Service Hub",description:"Multi-agent customer service workflow with sentiment analysis, ticket routing, and automated responses.",icon:qi,color:"text-cyan-400",bgColor:"bg-cyan-900/20",borderColor:"border-cyan-400/30",status:"template",agents:4,connections:8,features:["Sentiment Analysis","Ticket Routing","Knowledge Base","Escalation Management"],preview:"/placeholder-service.jpg"},{id:"content-creation",title:"Content Creation Pipeline",description:"Automated content generation workflow with research agents, writers, editors, and quality assurance.",icon:Hi,color:"text-emerald-400",bgColor:"bg-emerald-900/20",borderColor:"border-emerald-400/30",status:"template",agents:5,connections:9,features:["Research & Analysis","Content Generation","Quality Review","SEO Optimization"],preview:"/placeholder-content.jpg"}],a=p=>{r(p)},l=()=>{t&&e(t)},d=()=>{e("new-workflow")};return n.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-blue-900 text-white p-6",children:n.jsxs("div",{className:"max-w-6xl mx-auto",children:[n.jsxs("div",{className:"text-center mb-8",children:[n.jsx("h1",{className:"text-4xl font-bold mb-4 bg-gradient-to-r from-purple-400 to-blue-400 bg-clip-text text-transparent",children:"Multi-Agent Workspace"}),n.jsx("p",{className:"text-slate-300 text-lg",children:"Choose a project template or create a new multi-agent workflow from scratch"})]}),n.jsx(jt,{className:`mb-8 cursor-pointer transition-all duration-200 bg-slate-800/40 backdrop-blur-lg border-2 hover:border-cyan-400/50 ${t==="new"?"border-cyan-400 shadow-lg shadow-cyan-400/20":"border-slate-600/30"}`,onClick:()=>a("new"),children:n.jsx(Ht,{className:"p-6",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"p-4 bg-cyan-900/20 rounded-xl border border-cyan-400/30",children:n.jsx(Mo,{className:"h-8 w-8 text-cyan-400"})}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-xl font-semibold text-white mb-1",children:"Create New Workflow"}),n.jsx("p",{className:"text-slate-400",children:"Start with a blank canvas and build your custom multi-agent orchestration"})]})]}),n.jsxs(lt,{onClick:p=>{p.stopPropagation(),d()},className:"bg-cyan-600 hover:bg-cyan-700 text-white",children:["Create New",n.jsx(cb,{className:"ml-2 h-4 w-4"})]})]})})}),n.jsxs("div",{className:"mb-8",children:[n.jsxs("h2",{className:"text-2xl font-semibold mb-6 flex items-center gap-2",children:[n.jsx(p_,{className:"h-6 w-6 text-purple-400"}),"Project Templates"]}),n.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6",children:i.map(p=>{const x=p.icon,w=t===p.id;return n.jsxs(jt,{className:`cursor-pointer transition-all duration-200 bg-slate-800/40 backdrop-blur-lg border-2 hover:border-purple-400/50 ${w?"border-purple-400 shadow-lg shadow-purple-400/20":"border-slate-600/30"}`,onClick:()=>a(p.id),children:[n.jsxs(wr,{className:"pb-3",children:[n.jsxs("div",{className:"flex items-start justify-between",children:[n.jsx("div",{className:`p-3 rounded-lg ${p.bgColor} border ${p.borderColor}`,children:n.jsx(x,{className:`h-6 w-6 ${p.color}`})}),n.jsxs("div",{className:"flex flex-col gap-1",children:[n.jsx(Tt,{className:`${p.status==="completed"?"bg-green-900/20 text-green-300 border-green-700/30":"bg-blue-900/20 text-blue-300 border-blue-700/30"}`,children:p.status==="completed"?"Ready":"Template"}),p.status==="completed"&&n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(FF,{className:"h-3 w-3 text-yellow-400 fill-yellow-400"}),n.jsx("span",{className:"text-xs text-yellow-400",children:"Featured"})]})]})]}),n.jsx(fr,{className:"text-lg text-white mt-3",children:p.title})]}),n.jsxs(Ht,{className:"space-y-4",children:[n.jsx("p",{className:"text-slate-400 text-sm",children:p.description}),n.jsxs("div",{className:"flex gap-4 text-xs text-slate-500",children:[n.jsxs("span",{children:[p.agents," Agents"]}),n.jsx("span",{children:"•"}),n.jsxs("span",{children:[p.connections," Connections"]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx("p",{className:"text-xs font-medium text-slate-300",children:"Key Features:"}),n.jsxs("div",{className:"flex flex-wrap gap-1",children:[p.features.slice(0,2).map((j,S)=>n.jsx(Tt,{variant:"outline",className:"text-xs py-0 px-2 border-slate-600 text-slate-400",children:j},S)),p.features.length>2&&n.jsxs(Tt,{variant:"outline",className:"text-xs py-0 px-2 border-slate-600 text-slate-400",children:["+",p.features.length-2," more"]})]})]})]})]},p.id)})})]}),t&&t!=="new"&&n.jsx("div",{className:"flex justify-center",children:n.jsxs(lt,{onClick:l,size:"lg",className:"bg-purple-600 hover:bg-purple-700 text-white px-8",children:["Open ",(s=i.find(p=>p.id===t))==null?void 0:s.title,n.jsx(cb,{className:"ml-2 h-5 w-5"})]})})]})})},btt=()=>{const[e,t]=U.useState(null),r=i=>{t(i)};return e?e==="cvm-management"?n.jsx(ntt,{}):e==="wealth-management"?n.jsx(Zet,{}):e==="network-twin"?n.jsx(dtt,{}):e==="new-workflow"?n.jsx(TZ,{}):n.jsx(TZ,{}):n.jsx(vtt,{onSelectProject:r})},Ml=sB,F_=hte,_tt=aB,yce=U.forwardRef(({className:e,...t},r)=>n.jsx(ZN,{ref:r,className:Yt("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));yce.displayName=ZN.displayName;const Qo=U.forwardRef(({className:e,children:t,...r},i)=>n.jsxs(_tt,{children:[n.jsx(yce,{}),n.jsxs(YN,{ref:i,className:Yt("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...r,children:[t,n.jsxs(VE,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[n.jsx(Pc,{className:"h-4 w-4"}),n.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Qo.displayName=YN.displayName;const el=({className:e,...t})=>n.jsx("div",{className:Yt("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});el.displayName="DialogHeader";const mg=({className:e,...t})=>n.jsx("div",{className:Yt("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});mg.displayName="DialogFooter";const tl=U.forwardRef(({className:e,...t},r)=>n.jsx(XN,{ref:r,className:Yt("text-lg font-semibold leading-none tracking-tight",e),...t}));tl.displayName=XN.displayName;const fg=U.forwardRef(({className:e,...t},r)=>n.jsx(JN,{ref:r,className:Yt("text-sm text-muted-foreground",e),...t}));fg.displayName=JN.displayName;const wtt=({value:e,onChange:t})=>n.jsxs("div",{className:"space-y-2",children:[n.jsx(mr,{className:"text-white",children:"Agent Name"}),n.jsx(An,{placeholder:"Enter agent name",className:"bg-beam-dark border-gray-700 text-white",value:e,onChange:r=>t(r.target.value),required:!0}),n.jsx("p",{className:"text-gray-400 text-sm",children:"This will be the display name for your agent"})]});var H6="Popover",[vce,cft]=Jo(H6,[ig]),yS=ig(),[jtt,pg]=vce(H6),bce=e=>{const{__scopePopover:t,children:r,open:i,defaultOpen:a,onOpenChange:l,modal:d=!1}=e,s=yS(t),p=U.useRef(null),[x,w]=U.useState(!1),[j=!1,S]=fo({prop:i,defaultProp:a,onChange:l});return n.jsx(kE,{...s,children:n.jsx(jtt,{scope:t,contentId:rc(),triggerRef:p,open:j,onOpenChange:S,onOpenToggle:U.useCallback(()=>S(P=>!P),[S]),hasCustomAnchor:x,onCustomAnchorAdd:U.useCallback(()=>w(!0),[]),onCustomAnchorRemove:U.useCallback(()=>w(!1),[]),modal:d,children:r})})};bce.displayName=H6;var _ce="PopoverAnchor",Ntt=U.forwardRef((e,t)=>{const{__scopePopover:r,...i}=e,a=pg(_ce,r),l=yS(r),{onCustomAnchorAdd:d,onCustomAnchorRemove:s}=a;return U.useEffect(()=>(d(),()=>s()),[d,s]),n.jsx(UN,{...l,...i,ref:t})});Ntt.displayName=_ce;var wce="PopoverTrigger",jce=U.forwardRef((e,t)=>{const{__scopePopover:r,...i}=e,a=pg(wce,r),l=yS(r),d=Mn(t,a.triggerRef),s=n.jsx(Hr.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":Tce(a.open),...i,ref:d,onClick:_r(e.onClick,a.onOpenToggle)});return a.hasCustomAnchor?s:n.jsx(UN,{asChild:!0,...l,children:s})});jce.displayName=wce;var q6="PopoverPortal",[Stt,Ctt]=vce(q6,{forceMount:void 0}),Nce=e=>{const{__scopePopover:t,forceMount:r,children:i,container:a}=e,l=pg(q6,t);return n.jsx(Stt,{scope:t,forceMount:r,children:n.jsx(io,{present:r||l.open,children:n.jsx(h_,{asChild:!0,container:a,children:i})})})};Nce.displayName=q6;var Qb="PopoverContent",Sce=U.forwardRef((e,t)=>{const r=Ctt(Qb,e.__scopePopover),{forceMount:i=r.forceMount,...a}=e,l=pg(Qb,e.__scopePopover);return n.jsx(io,{present:i||l.open,children:l.modal?n.jsx(Att,{...a,ref:t}):n.jsx(Ttt,{...a,ref:t})})});Sce.displayName=Qb;var Att=U.forwardRef((e,t)=>{const r=pg(Qb,e.__scopePopover),i=U.useRef(null),a=Mn(t,i),l=U.useRef(!1);return U.useEffect(()=>{const d=i.current;if(d)return $E(d)},[]),n.jsx(KN,{as:Al,allowPinchZoom:!0,children:n.jsx(Cce,{...e,ref:a,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:_r(e.onCloseAutoFocus,d=>{var s;d.preventDefault(),l.current||(s=r.triggerRef.current)==null||s.focus()}),onPointerDownOutside:_r(e.onPointerDownOutside,d=>{const s=d.detail.originalEvent,p=s.button===0&&s.ctrlKey===!0,x=s.button===2||p;l.current=x},{checkForDefaultPrevented:!1}),onFocusOutside:_r(e.onFocusOutside,d=>d.preventDefault(),{checkForDefaultPrevented:!1})})})}),Ttt=U.forwardRef((e,t)=>{const r=pg(Qb,e.__scopePopover),i=U.useRef(!1),a=U.useRef(!1);return n.jsx(Cce,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:l=>{var d,s;(d=e.onCloseAutoFocus)==null||d.call(e,l),l.defaultPrevented||(i.current||(s=r.triggerRef.current)==null||s.focus(),l.preventDefault()),i.current=!1,a.current=!1},onInteractOutside:l=>{var p,x;(p=e.onInteractOutside)==null||p.call(e,l),l.defaultPrevented||(i.current=!0,l.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const d=l.target;((x=r.triggerRef.current)==null?void 0:x.contains(d))&&l.preventDefault(),l.detail.originalEvent.type==="focusin"&&a.current&&l.preventDefault()}})}),Cce=U.forwardRef((e,t)=>{const{__scopePopover:r,trapFocus:i,onOpenAutoFocus:a,onCloseAutoFocus:l,disableOutsidePointerEvents:d,onEscapeKeyDown:s,onPointerDownOutside:p,onFocusOutside:x,onInteractOutside:w,...j}=e,S=pg(Qb,r),P=yS(r);return FE(),n.jsx(WN,{asChild:!0,loop:!0,trapped:i,onMountAutoFocus:a,onUnmountAutoFocus:l,children:n.jsx(yx,{asChild:!0,disableOutsidePointerEvents:d,onInteractOutside:w,onEscapeKeyDown:s,onPointerDownOutside:p,onFocusOutside:x,onDismiss:()=>S.onOpenChange(!1),children:n.jsx(PE,{"data-state":Tce(S.open),role:"dialog",id:S.contentId,...P,...j,ref:t,style:{...j.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),Ace="PopoverClose",ktt=U.forwardRef((e,t)=>{const{__scopePopover:r,...i}=e,a=pg(Ace,r);return n.jsx(Hr.button,{type:"button",...i,ref:t,onClick:_r(e.onClick,()=>a.onOpenChange(!1))})});ktt.displayName=Ace;var Ptt="PopoverArrow",Ett=U.forwardRef((e,t)=>{const{__scopePopover:r,...i}=e,a=yS(r);return n.jsx(EE,{...a,...i,ref:t})});Ett.displayName=Ptt;function Tce(e){return e?"open":"closed"}var Mtt=bce,Itt=jce,Ott=Nce,kce=Sce;const rL=Mtt,nL=Itt,zP=U.forwardRef(({className:e,align:t="center",sideOffset:r=4,...i},a)=>n.jsx(Ott,{children:n.jsx(kce,{ref:a,align:t,sideOffset:r,className:Yt("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...i})}));zP.displayName=kce.displayName;const Rtt=({selectedProvider:e,handleProviderChange:t})=>n.jsx($i,{defaultValue:e,value:e,onValueChange:t,className:"w-full",children:n.jsxs(Di,{className:"bg-beam-dark w-full grid grid-cols-5 gap-1",children:[n.jsx(Jt,{value:"openai",className:"data-[state=active]:bg-beam-blue/30 data-[state=active]:text-beam-blue-light",children:"OpenAI"}),n.jsx(Jt,{value:"anthropic",className:"data-[state=active]:bg-beam-blue/30 data-[state=active]:text-beam-blue-light",children:"Anthropic"}),n.jsx(Jt,{value:"meta",className:"data-[state=active]:bg-beam-blue/30 data-[state=active]:text-beam-blue-light",children:"Meta"}),n.jsx(Jt,{value:"deepseek",className:"data-[state=active]:bg-beam-blue/30 data-[state=active]:text-beam-blue-light",children:"DeepSeek"}),n.jsx(Jt,{value:"amazon",className:"data-[state=active]:bg-beam-blue/30 data-[state=active]:text-beam-blue-light",children:"Amazon"})]})}),kZ=({score:e,max:t=10})=>n.jsx("div",{className:"w-full bg-gray-700 h-2 rounded-full overflow-hidden",children:n.jsx("div",{className:"h-full bg-gradient-to-r from-blue-400 to-blue-600",style:{width:`${e/t*100}%`}})}),Dtt=({model:e,isSelected:t,onSelect:r})=>{const i=a=>{a.preventDefault(),a.stopPropagation(),r()};return n.jsxs("button",{type:"button",className:"w-full text-left flex flex-col p-3 border-b border-gray-700 hover:bg-beam-blue/10 focus:outline-none focus:bg-beam-blue/20",onClick:i,children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(bd,{size:16,className:"text-beam-blue"}),n.jsx("span",{className:"font-medium",children:e.name}),e.badge&&n.jsx("span",{className:"bg-blue-500/20 text-blue-400 text-xs px-2 py-0.5 rounded-full",children:e.badge})]}),t&&n.jsx(hh,{size:16,className:"text-green-400"})]}),n.jsx("p",{className:"text-sm text-gray-300 mt-1",children:e.description}),n.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-300 mb-1",children:[n.jsx(RF,{size:12,className:"text-yellow-400"}),"Reasoning"]}),n.jsx(kZ,{score:e.capabilities.reasoning})]}),n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-300 mb-1",children:[n.jsx(Yi,{size:12,className:"text-blue-400"}),"Speed"]}),n.jsx(kZ,{score:e.capabilities.speed})]}),n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-300 mb-1",children:[n.jsx(sc,{size:12,className:"text-green-400"}),"Cost"]}),n.jsx("div",{className:"flex items-center",children:Array.from({length:5}).map((a,l)=>n.jsx(sc,{size:12,className:l<e.cost/2?"text-green-400":"text-gray-600"},l))})]}),n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-300 mb-1",children:[n.jsx(EQ,{size:12,className:"text-purple-400"}),"Multimodal"]}),n.jsx("div",{className:"text-xs",children:e.capabilities.multimodal?n.jsx("span",{className:"text-green-400",children:"Supported"}):n.jsx("span",{className:"text-red-400",children:"Not supported"})})]})]})]})},ztt=({selectedModel:e,setSelectedModel:t,selectedProvider:r,handleProviderChange:i,handleModelChange:a,AIModels:l})=>{var s;const d=p=>{t(p),a(p.id)};return n.jsxs("div",{className:"space-y-4",children:[n.jsx(mr,{className:"text-white block",children:"AI Provider"}),n.jsx(Rtt,{selectedProvider:r,handleProviderChange:i}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(mr,{className:"text-white",children:"AI Model"}),n.jsxs(rL,{children:[n.jsx(nL,{asChild:!0,children:n.jsxs(lt,{type:"button",variant:"outline",role:"combobox",className:`w-full justify-between bg-beam-dark border-gray-700 text-left ${e?"text-white":"text-gray-400"}`,children:[e?n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(bd,{size:16,className:"text-beam-blue"}),e.name,e.badge&&n.jsx("span",{className:"bg-blue-500/20 text-blue-400 text-xs px-2 py-0.5 rounded-full",children:e.badge})]}):"Select a model (optional)",n.jsx(Na,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),n.jsx(zP,{className:"w-[300px] p-0 bg-beam-dark-accent border-gray-700 text-white",sideOffset:4,align:"start",children:n.jsx("div",{className:"max-h-[300px] overflow-y-auto",children:(s=l[r])==null?void 0:s.map(p=>n.jsx(Dtt,{model:p,isSelected:(e==null?void 0:e.id)===p.id,onSelect:()=>d(p)},p.id))})})]}),n.jsx("p",{className:"text-gray-400 text-sm",children:"Select the AI model that best fits your use case (optional)"})]})]})},Ltt=({roles:e,handleRoleSelect:t,selectedRole:r,description:i,onDescriptionChange:a})=>n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(mr,{className:"text-white",children:"Agent Role"}),n.jsx("div",{className:"grid grid-cols-2 gap-3 mt-2",children:e.map(l=>n.jsxs("button",{type:"button",onClick:()=>t(l.id),className:`p-4 rounded-lg border text-left transition-all ${r===l.id?"border-beam-blue bg-beam-blue/10 text-white":"border-gray-700 bg-beam-dark hover:border-gray-600 text-gray-300 hover:text-white"}`,children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("span",{className:"text-lg",children:l.icon}),n.jsx("span",{className:"font-medium",children:l.name})]}),n.jsx("p",{className:"text-sm text-gray-400",children:l.description})]},l.id))}),n.jsx("p",{className:"text-gray-400 text-sm",children:"Choose a role that best describes your agent's purpose"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(mr,{className:"text-white",children:"Description"}),n.jsx(po,{placeholder:"Describe your agent's specific capabilities and purpose...",className:"bg-beam-dark border-gray-700 text-white min-h-[100px]",value:i,onChange:l=>a(l.target.value)}),n.jsx("p",{className:"text-gray-400 text-sm",children:"Provide a detailed description of what your agent should do"})]})]}),Ftt=({handleMemoryToggle:e,memory:t})=>{const r=[{id:"shortTerm",name:"Short-Term Memory",description:"Stores recent interactions for immediate context within a conversation.",icon:n.jsx(Eve,{className:"text-blue-400",size:24})},{id:"longTerm",name:"Long-Term Memory",description:"Preserves information across multiple sessions for persistent knowledge.",icon:n.jsx($a,{className:"text-green-400",size:24})},{id:"summary",name:"Summary Memory",description:"Creates condensed summaries of conversations for efficient storage.",icon:n.jsx(Nh,{className:"text-yellow-400",size:24})},{id:"entity",name:"Entity Memory",description:"Tracks and remembers specific entities, people, and relationships.",icon:n.jsx($N,{className:"text-purple-400",size:24})}];return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[n.jsx(ti,{className:"text-beam-blue",size:24}),n.jsx("h3",{className:"text-white text-lg font-medium",children:"Memory Configuration"})]}),n.jsx("div",{className:"grid gap-4",children:r.map(i=>n.jsx(jt,{className:"bg-beam-dark border-gray-700",children:n.jsx(wr,{className:"pb-3",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[i.icon,n.jsxs("div",{children:[n.jsx(fr,{className:"text-white text-base",children:i.name}),n.jsx(Ii,{className:"text-gray-400 text-sm",children:i.description})]})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(ko,{id:i.id,checked:t[i.id],onCheckedChange:a=>e(i.id,a)}),n.jsx(mr,{htmlFor:i.id,className:"sr-only",children:i.name})]})]})})},i.id))})]})};function Btt(e,t){return U.useReducer((r,i)=>t[r][i]??r,e)}var W6="ScrollArea",[Pce,uft]=Jo(W6),[$tt,Tu]=Pce(W6),Ece=U.forwardRef((e,t)=>{const{__scopeScrollArea:r,type:i="hover",dir:a,scrollHideDelay:l=600,...d}=e,[s,p]=U.useState(null),[x,w]=U.useState(null),[j,S]=U.useState(null),[P,F]=U.useState(null),[L,B]=U.useState(null),[V,$]=U.useState(0),[G,W]=U.useState(0),[Z,se]=U.useState(!1),[ae,ce]=U.useState(!1),Pe=Mn(t,xe=>p(xe)),we=sg(a);return n.jsx($tt,{scope:r,type:i,dir:we,scrollHideDelay:l,scrollArea:s,viewport:x,onViewportChange:w,content:j,onContentChange:S,scrollbarX:P,onScrollbarXChange:F,scrollbarXEnabled:Z,onScrollbarXEnabledChange:se,scrollbarY:L,onScrollbarYChange:B,scrollbarYEnabled:ae,onScrollbarYEnabledChange:ce,onCornerWidthChange:$,onCornerHeightChange:W,children:n.jsx(Hr.div,{dir:we,...d,ref:Pe,style:{position:"relative","--radix-scroll-area-corner-width":V+"px","--radix-scroll-area-corner-height":G+"px",...e.style}})})});Ece.displayName=W6;var Mce="ScrollAreaViewport",Ice=U.forwardRef((e,t)=>{const{__scopeScrollArea:r,children:i,asChild:a,nonce:l,...d}=e,s=Tu(Mce,r),p=U.useRef(null),x=Mn(t,p,s.onViewportChange);return n.jsxs(n.Fragment,{children:[n.jsx("style",{dangerouslySetInnerHTML:{__html:`
[data-radix-scroll-area-viewport] {
  scrollbar-width: none;
  -ms-overflow-style: none;
  -webkit-overflow-scrolling: touch;
}
[data-radix-scroll-area-viewport]::-webkit-scrollbar {
  display: none;
}
:where([data-radix-scroll-area-viewport]) {
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
:where([data-radix-scroll-area-content]) {
  flex-grow: 1;
}
`},nonce:l}),n.jsx(Hr.div,{"data-radix-scroll-area-viewport":"",...d,asChild:a,ref:x,style:{overflowX:s.scrollbarXEnabled?"scroll":"hidden",overflowY:s.scrollbarYEnabled?"scroll":"hidden",...e.style},children:Xtt({asChild:a,children:i},w=>n.jsx("div",{"data-radix-scroll-area-content":"",ref:s.onContentChange,style:{minWidth:s.scrollbarXEnabled?"fit-content":void 0},children:w}))})]})});Ice.displayName=Mce;var Mh="ScrollAreaScrollbar",K6=U.forwardRef((e,t)=>{const{forceMount:r,...i}=e,a=Tu(Mh,e.__scopeScrollArea),{onScrollbarXEnabledChange:l,onScrollbarYEnabledChange:d}=a,s=e.orientation==="horizontal";return U.useEffect(()=>(s?l(!0):d(!0),()=>{s?l(!1):d(!1)}),[s,l,d]),a.type==="hover"?n.jsx(Vtt,{...i,ref:t,forceMount:r}):a.type==="scroll"?n.jsx(Utt,{...i,ref:t,forceMount:r}):a.type==="auto"?n.jsx(Oce,{...i,ref:t,forceMount:r}):a.type==="always"?n.jsx(Z6,{...i,ref:t}):null});K6.displayName=Mh;var Vtt=U.forwardRef((e,t)=>{const{forceMount:r,...i}=e,a=Tu(Mh,e.__scopeScrollArea),[l,d]=U.useState(!1);return U.useEffect(()=>{const s=a.scrollArea;let p=0;if(s){const x=()=>{window.clearTimeout(p),d(!0)},w=()=>{p=window.setTimeout(()=>d(!1),a.scrollHideDelay)};return s.addEventListener("pointerenter",x),s.addEventListener("pointerleave",w),()=>{window.clearTimeout(p),s.removeEventListener("pointerenter",x),s.removeEventListener("pointerleave",w)}}},[a.scrollArea,a.scrollHideDelay]),n.jsx(io,{present:r||l,children:n.jsx(Oce,{"data-state":l?"visible":"hidden",...i,ref:t})})}),Utt=U.forwardRef((e,t)=>{const{forceMount:r,...i}=e,a=Tu(Mh,e.__scopeScrollArea),l=e.orientation==="horizontal",d=p3(()=>p("SCROLL_END"),100),[s,p]=Btt("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return U.useEffect(()=>{if(s==="idle"){const x=window.setTimeout(()=>p("HIDE"),a.scrollHideDelay);return()=>window.clearTimeout(x)}},[s,a.scrollHideDelay,p]),U.useEffect(()=>{const x=a.viewport,w=l?"scrollLeft":"scrollTop";if(x){let j=x[w];const S=()=>{const P=x[w];j!==P&&(p("SCROLL"),d()),j=P};return x.addEventListener("scroll",S),()=>x.removeEventListener("scroll",S)}},[a.viewport,l,p,d]),n.jsx(io,{present:r||s!=="hidden",children:n.jsx(Z6,{"data-state":s==="hidden"?"hidden":"visible",...i,ref:t,onPointerEnter:_r(e.onPointerEnter,()=>p("POINTER_ENTER")),onPointerLeave:_r(e.onPointerLeave,()=>p("POINTER_LEAVE"))})})}),Oce=U.forwardRef((e,t)=>{const r=Tu(Mh,e.__scopeScrollArea),{forceMount:i,...a}=e,[l,d]=U.useState(!1),s=e.orientation==="horizontal",p=p3(()=>{if(r.viewport){const x=r.viewport.offsetWidth<r.viewport.scrollWidth,w=r.viewport.offsetHeight<r.viewport.scrollHeight;d(s?x:w)}},10);return e_(r.viewport,p),e_(r.content,p),n.jsx(io,{present:i||l,children:n.jsx(Z6,{"data-state":l?"visible":"hidden",...a,ref:t})})}),Z6=U.forwardRef((e,t)=>{const{orientation:r="vertical",...i}=e,a=Tu(Mh,e.__scopeScrollArea),l=U.useRef(null),d=U.useRef(0),[s,p]=U.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),x=Fce(s.viewport,s.content),w={...i,sizes:s,onSizesChange:p,hasThumb:x>0&&x<1,onThumbChange:S=>l.current=S,onThumbPointerUp:()=>d.current=0,onThumbPointerDown:S=>d.current=S};function j(S,P){return Ztt(S,d.current,s,P)}return r==="horizontal"?n.jsx(Gtt,{...w,ref:t,onThumbPositionChange:()=>{if(a.viewport&&l.current){const S=a.viewport.scrollLeft,P=PZ(S,s,a.dir);l.current.style.transform=`translate3d(${P}px, 0, 0)`}},onWheelScroll:S=>{a.viewport&&(a.viewport.scrollLeft=S)},onDragScroll:S=>{a.viewport&&(a.viewport.scrollLeft=j(S,a.dir))}}):r==="vertical"?n.jsx(Htt,{...w,ref:t,onThumbPositionChange:()=>{if(a.viewport&&l.current){const S=a.viewport.scrollTop,P=PZ(S,s);l.current.style.transform=`translate3d(0, ${P}px, 0)`}},onWheelScroll:S=>{a.viewport&&(a.viewport.scrollTop=S)},onDragScroll:S=>{a.viewport&&(a.viewport.scrollTop=j(S))}}):null}),Gtt=U.forwardRef((e,t)=>{const{sizes:r,onSizesChange:i,...a}=e,l=Tu(Mh,e.__scopeScrollArea),[d,s]=U.useState(),p=U.useRef(null),x=Mn(t,p,l.onScrollbarXChange);return U.useEffect(()=>{p.current&&s(getComputedStyle(p.current))},[p]),n.jsx(Dce,{"data-orientation":"horizontal",...a,ref:x,sizes:r,style:{bottom:0,left:l.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:l.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":f3(r)+"px",...e.style},onThumbPointerDown:w=>e.onThumbPointerDown(w.x),onDragScroll:w=>e.onDragScroll(w.x),onWheelScroll:(w,j)=>{if(l.viewport){const S=l.viewport.scrollLeft+w.deltaX;e.onWheelScroll(S),$ce(S,j)&&w.preventDefault()}},onResize:()=>{p.current&&l.viewport&&d&&i({content:l.viewport.scrollWidth,viewport:l.viewport.offsetWidth,scrollbar:{size:p.current.clientWidth,paddingStart:FP(d.paddingLeft),paddingEnd:FP(d.paddingRight)}})}})}),Htt=U.forwardRef((e,t)=>{const{sizes:r,onSizesChange:i,...a}=e,l=Tu(Mh,e.__scopeScrollArea),[d,s]=U.useState(),p=U.useRef(null),x=Mn(t,p,l.onScrollbarYChange);return U.useEffect(()=>{p.current&&s(getComputedStyle(p.current))},[p]),n.jsx(Dce,{"data-orientation":"vertical",...a,ref:x,sizes:r,style:{top:0,right:l.dir==="ltr"?0:void 0,left:l.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":f3(r)+"px",...e.style},onThumbPointerDown:w=>e.onThumbPointerDown(w.y),onDragScroll:w=>e.onDragScroll(w.y),onWheelScroll:(w,j)=>{if(l.viewport){const S=l.viewport.scrollTop+w.deltaY;e.onWheelScroll(S),$ce(S,j)&&w.preventDefault()}},onResize:()=>{p.current&&l.viewport&&d&&i({content:l.viewport.scrollHeight,viewport:l.viewport.offsetHeight,scrollbar:{size:p.current.clientHeight,paddingStart:FP(d.paddingTop),paddingEnd:FP(d.paddingBottom)}})}})}),[qtt,Rce]=Pce(Mh),Dce=U.forwardRef((e,t)=>{const{__scopeScrollArea:r,sizes:i,hasThumb:a,onThumbChange:l,onThumbPointerUp:d,onThumbPointerDown:s,onThumbPositionChange:p,onDragScroll:x,onWheelScroll:w,onResize:j,...S}=e,P=Tu(Mh,r),[F,L]=U.useState(null),B=Mn(t,Pe=>L(Pe)),V=U.useRef(null),$=U.useRef(""),G=P.viewport,W=i.content-i.viewport,Z=Ws(w),se=Ws(p),ae=p3(j,10);function ce(Pe){if(V.current){const we=Pe.clientX-V.current.left,xe=Pe.clientY-V.current.top;x({x:we,y:xe})}}return U.useEffect(()=>{const Pe=we=>{const xe=we.target;(F==null?void 0:F.contains(xe))&&Z(we,W)};return document.addEventListener("wheel",Pe,{passive:!1}),()=>document.removeEventListener("wheel",Pe,{passive:!1})},[G,F,W,Z]),U.useEffect(se,[i,se]),e_(F,ae),e_(P.content,ae),n.jsx(qtt,{scope:r,scrollbar:F,hasThumb:a,onThumbChange:Ws(l),onThumbPointerUp:Ws(d),onThumbPositionChange:se,onThumbPointerDown:Ws(s),children:n.jsx(Hr.div,{...S,ref:B,style:{position:"absolute",...S.style},onPointerDown:_r(e.onPointerDown,Pe=>{Pe.button===0&&(Pe.target.setPointerCapture(Pe.pointerId),V.current=F.getBoundingClientRect(),$.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",P.viewport&&(P.viewport.style.scrollBehavior="auto"),ce(Pe))}),onPointerMove:_r(e.onPointerMove,ce),onPointerUp:_r(e.onPointerUp,Pe=>{const we=Pe.target;we.hasPointerCapture(Pe.pointerId)&&we.releasePointerCapture(Pe.pointerId),document.body.style.webkitUserSelect=$.current,P.viewport&&(P.viewport.style.scrollBehavior=""),V.current=null})})})}),LP="ScrollAreaThumb",zce=U.forwardRef((e,t)=>{const{forceMount:r,...i}=e,a=Rce(LP,e.__scopeScrollArea);return n.jsx(io,{present:r||a.hasThumb,children:n.jsx(Wtt,{ref:t,...i})})}),Wtt=U.forwardRef((e,t)=>{const{__scopeScrollArea:r,style:i,...a}=e,l=Tu(LP,r),d=Rce(LP,r),{onThumbPositionChange:s}=d,p=Mn(t,j=>d.onThumbChange(j)),x=U.useRef(),w=p3(()=>{x.current&&(x.current(),x.current=void 0)},100);return U.useEffect(()=>{const j=l.viewport;if(j){const S=()=>{if(w(),!x.current){const P=Ytt(j,s);x.current=P,s()}};return s(),j.addEventListener("scroll",S),()=>j.removeEventListener("scroll",S)}},[l.viewport,w,s]),n.jsx(Hr.div,{"data-state":d.hasThumb?"visible":"hidden",...a,ref:p,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...i},onPointerDownCapture:_r(e.onPointerDownCapture,j=>{const P=j.target.getBoundingClientRect(),F=j.clientX-P.left,L=j.clientY-P.top;d.onThumbPointerDown({x:F,y:L})}),onPointerUp:_r(e.onPointerUp,d.onThumbPointerUp)})});zce.displayName=LP;var Y6="ScrollAreaCorner",Lce=U.forwardRef((e,t)=>{const r=Tu(Y6,e.__scopeScrollArea),i=!!(r.scrollbarX&&r.scrollbarY);return r.type!=="scroll"&&i?n.jsx(Ktt,{...e,ref:t}):null});Lce.displayName=Y6;var Ktt=U.forwardRef((e,t)=>{const{__scopeScrollArea:r,...i}=e,a=Tu(Y6,r),[l,d]=U.useState(0),[s,p]=U.useState(0),x=!!(l&&s);return e_(a.scrollbarX,()=>{var j;const w=((j=a.scrollbarX)==null?void 0:j.offsetHeight)||0;a.onCornerHeightChange(w),p(w)}),e_(a.scrollbarY,()=>{var j;const w=((j=a.scrollbarY)==null?void 0:j.offsetWidth)||0;a.onCornerWidthChange(w),d(w)}),x?n.jsx(Hr.div,{...i,ref:t,style:{width:l,height:s,position:"absolute",right:a.dir==="ltr"?0:void 0,left:a.dir==="rtl"?0:void 0,bottom:0,...e.style}}):null});function FP(e){return e?parseInt(e,10):0}function Fce(e,t){const r=e/t;return isNaN(r)?0:r}function f3(e){const t=Fce(e.viewport,e.content),r=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,i=(e.scrollbar.size-r)*t;return Math.max(i,18)}function Ztt(e,t,r,i="ltr"){const a=f3(r),l=a/2,d=t||l,s=a-d,p=r.scrollbar.paddingStart+d,x=r.scrollbar.size-r.scrollbar.paddingEnd-s,w=r.content-r.viewport,j=i==="ltr"?[0,w]:[w*-1,0];return Bce([p,x],j)(e)}function PZ(e,t,r="ltr"){const i=f3(t),a=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,l=t.scrollbar.size-a,d=t.content-t.viewport,s=l-i,p=r==="ltr"?[0,d]:[d*-1,0],x=pN(e,p);return Bce([0,d],[0,s])(x)}function Bce(e,t){return r=>{if(e[0]===e[1]||t[0]===t[1])return t[0];const i=(t[1]-t[0])/(e[1]-e[0]);return t[0]+i*(r-e[0])}}function $ce(e,t){return e>0&&e<t}var Ytt=(e,t=()=>{})=>{let r={left:e.scrollLeft,top:e.scrollTop},i=0;return function a(){const l={left:e.scrollLeft,top:e.scrollTop},d=r.left!==l.left,s=r.top!==l.top;(d||s)&&t(),r=l,i=window.requestAnimationFrame(a)}(),()=>window.cancelAnimationFrame(i)};function p3(e,t){const r=Ws(e),i=U.useRef(0);return U.useEffect(()=>()=>window.clearTimeout(i.current),[]),U.useCallback(()=>{window.clearTimeout(i.current),i.current=window.setTimeout(r,t)},[r,t])}function e_(e,t){const r=Ws(t);Ba(()=>{let i=0;if(e){const a=new ResizeObserver(()=>{cancelAnimationFrame(i),i=window.requestAnimationFrame(r)});return a.observe(e),()=>{window.cancelAnimationFrame(i),a.unobserve(e)}}},[e,r])}function Xtt(e,t){const{asChild:r,children:i}=e;if(!r)return typeof t=="function"?t(i):t;const a=U.Children.only(i);return U.cloneElement(a,{children:typeof t=="function"?t(a.props.children):t})}var Vce=Ece,Jtt=Ice,Qtt=Lce;const Cl=U.forwardRef(({className:e,children:t,...r},i)=>n.jsxs(Vce,{ref:i,className:Yt("relative overflow-hidden",e),...r,children:[n.jsx(Jtt,{className:"h-full w-full rounded-[inherit]",children:t}),n.jsx(Uce,{}),n.jsx(Qtt,{})]}));Cl.displayName=Vce.displayName;const Uce=U.forwardRef(({className:e,orientation:t="vertical",...r},i)=>n.jsx(K6,{ref:i,orientation:t,className:Yt("flex touch-none select-none transition-colors",t==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",t==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",e),...r,children:n.jsx(zce,{className:"relative flex-1 rounded-full bg-border"})}));Uce.displayName=K6.displayName;var X6="Checkbox",[ert,dft]=Jo(X6),[trt,rrt]=ert(X6),Gce=U.forwardRef((e,t)=>{const{__scopeCheckbox:r,name:i,checked:a,defaultChecked:l,required:d,disabled:s,value:p="on",onCheckedChange:x,form:w,...j}=e,[S,P]=U.useState(null),F=Mn(t,W=>P(W)),L=U.useRef(!1),B=S?w||!!S.closest("form"):!0,[V=!1,$]=fo({prop:a,defaultProp:l,onChange:x}),G=U.useRef(V);return U.useEffect(()=>{const W=S==null?void 0:S.form;if(W){const Z=()=>$(G.current);return W.addEventListener("reset",Z),()=>W.removeEventListener("reset",Z)}},[S,$]),n.jsxs(trt,{scope:r,state:V,disabled:s,children:[n.jsx(Hr.button,{type:"button",role:"checkbox","aria-checked":Fp(V)?"mixed":V,"aria-required":d,"data-state":Wce(V),"data-disabled":s?"":void 0,disabled:s,value:p,...j,ref:F,onKeyDown:_r(e.onKeyDown,W=>{W.key==="Enter"&&W.preventDefault()}),onClick:_r(e.onClick,W=>{$(Z=>Fp(Z)?!0:!Z),B&&(L.current=W.isPropagationStopped(),L.current||W.stopPropagation())})}),B&&n.jsx(nrt,{control:S,bubbles:!L.current,name:i,value:p,checked:V,required:d,disabled:s,form:w,style:{transform:"translateX(-100%)"},defaultChecked:Fp(l)?!1:l})]})});Gce.displayName=X6;var Hce="CheckboxIndicator",qce=U.forwardRef((e,t)=>{const{__scopeCheckbox:r,forceMount:i,...a}=e,l=rrt(Hce,r);return n.jsx(io,{present:i||Fp(l.state)||l.state===!0,children:n.jsx(Hr.span,{"data-state":Wce(l.state),"data-disabled":l.disabled?"":void 0,...a,ref:t,style:{pointerEvents:"none",...e.style}})})});qce.displayName=Hce;var nrt=e=>{const{control:t,checked:r,bubbles:i=!0,defaultChecked:a,...l}=e,d=U.useRef(null),s=s3(r),p=TE(t);U.useEffect(()=>{const w=d.current,j=window.HTMLInputElement.prototype,P=Object.getOwnPropertyDescriptor(j,"checked").set;if(s!==r&&P){const F=new Event("click",{bubbles:i});w.indeterminate=Fp(r),P.call(w,Fp(r)?!1:r),w.dispatchEvent(F)}},[s,r,i]);const x=U.useRef(Fp(r)?!1:r);return n.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:a??x.current,...l,tabIndex:-1,ref:d,style:{...e.style,...p,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function Fp(e){return e==="indeterminate"}function Wce(e){return Fp(e)?"indeterminate":e?"checked":"unchecked"}var Kce=Gce,irt=qce;const yu=U.forwardRef(({className:e,...t},r)=>n.jsx(Kce,{ref:r,className:Yt("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...t,children:n.jsx(irt,{className:Yt("flex items-center justify-center text-current"),children:n.jsx(hh,{className:"h-4 w-4"})})}));yu.displayName=Kce.displayName;const srt=({tools:e,handleToolToggle:t,selectedTools:r,guardrails:i,onGuardrailToggle:a,databaseAccess:l,onDatabaseAccessToggle:d})=>n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{children:[n.jsx(mr,{className:"text-white text-lg mb-4 block",children:"Available Tools"}),n.jsx(Cl,{className:"h-[200px] w-full rounded-md border border-gray-700 bg-beam-dark p-4",children:n.jsx("div",{className:"space-y-3",children:e.map(s=>n.jsxs("div",{className:"flex items-start space-x-3",children:[n.jsx(yu,{id:s.id,checked:r.includes(s.id),onCheckedChange:p=>t(s.id,p),className:"mt-1"}),n.jsxs("div",{className:"flex-1",children:[n.jsx("label",{htmlFor:s.id,className:"text-white font-medium cursor-pointer",children:s.name}),n.jsx("p",{className:"text-gray-400 text-sm mt-1",children:s.description})]})]},s.id))})})]}),n.jsx(Da,{className:"bg-gray-700"}),n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[n.jsx(dn,{className:"text-yellow-400",size:20}),n.jsx(mr,{className:"text-white text-lg",children:"Safety Guardrails"})]}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx(yu,{id:"global-guardrails",checked:i.global,onCheckedChange:s=>a("global",s)}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:"global-guardrails",className:"text-white font-medium cursor-pointer",children:"Global Guardrails"}),n.jsx("p",{className:"text-gray-400 text-sm",children:"Apply system-wide safety measures and content filtering"})]})]}),n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx(yu,{id:"local-guardrails",checked:i.local,onCheckedChange:s=>a("local",s)}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:"local-guardrails",className:"text-white font-medium cursor-pointer",children:"Local Guardrails"}),n.jsx("p",{className:"text-gray-400 text-sm",children:"Apply context-specific safety rules for this agent"})]})]})]})]}),n.jsx(Da,{className:"bg-gray-700"}),n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[n.jsx(ln,{className:"text-blue-400",size:20}),n.jsx(mr,{className:"text-white text-lg",children:"Database Access"})]}),n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx(yu,{id:"database-access",checked:l,onCheckedChange:s=>d(s)}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:"database-access",className:"text-white font-medium cursor-pointer",children:"Enable Database Access"}),n.jsx("p",{className:"text-gray-400 text-sm",children:"Allow agent to query and interact with connected databases"})]})]})]})]}),art=({selectedMCPTools:e,onMCPToolToggle:t})=>{const[r,i]=U.useState(""),[a,l]=U.useState("all");U.useState(!1);const d=[{id:"aws-server",name:"AWS Tools",status:"connected",toolCount:15},{id:"git-server",name:"Git Tools",status:"connected",toolCount:8},{id:"filesystem-server",name:"File System",status:"connected",toolCount:12}],s=[{id:"aws-s3-list",name:"S3 List Objects",description:"List objects in an S3 bucket",category:"aws",serverId:"aws-server",serverName:"AWS Tools",popularity:95,verified:!0,usageComplexity:"simple"},{id:"git-status",name:"Git Status",description:"Check the status of a git repository",category:"git",serverId:"git-server",serverName:"Git Tools",popularity:88,verified:!0,usageComplexity:"simple"},{id:"file-read",name:"Read File",description:"Read contents of a file",category:"filesystem",serverId:"filesystem-server",serverName:"File System",popularity:92,verified:!0,usageComplexity:"simple"},{id:"aws-lambda-invoke",name:"Lambda Invoke",description:"Invoke an AWS Lambda function",category:"aws",serverId:"aws-server",serverName:"AWS Tools",popularity:78,verified:!0,usageComplexity:"moderate"},{id:"git-commit",name:"Git Commit",description:"Create a git commit with changes",category:"git",serverId:"git-server",serverName:"Git Tools",popularity:85,verified:!0,usageComplexity:"moderate"}],p=L=>{switch(L){case"aws":return n.jsx(ln,{className:"h-4 w-4 text-orange-400"});case"git":return n.jsx(Bc,{className:"h-4 w-4 text-purple-400"});case"filesystem":return n.jsx(eo,{className:"h-4 w-4 text-green-400"});case"api":return n.jsx(Zs,{className:"h-4 w-4 text-blue-400"});case"text":return n.jsx(Yi,{className:"h-4 w-4 text-yellow-400"});default:return n.jsx(ws,{className:"h-4 w-4 text-gray-400"})}},x=[{id:"all",label:"All",icon:ws},{id:"aws",label:"AWS",icon:ln},{id:"git",label:"Git",icon:Bc},{id:"api",label:"API",icon:Zs},{id:"filesystem",label:"Files",icon:eo}],w=()=>{let L=s;return a!=="all"&&(L=L.filter(B=>B.category===a)),r&&(L=L.filter(B=>B.name.toLowerCase().includes(r.toLowerCase())||B.description.toLowerCase().includes(r.toLowerCase())||B.serverName.toLowerCase().includes(r.toLowerCase()))),L.sort((B,V)=>V.popularity-B.popularity)},j=(L,B)=>e.some(V=>V.toolId===L&&V.serverId===B),S=L=>{switch(L){case"simple":return"bg-green-500/20 text-green-400 border-green-500/30";case"moderate":return"bg-yellow-500/20 text-yellow-400 border-yellow-500/30";case"advanced":return"bg-red-500/20 text-red-400 border-red-500/30";default:return"bg-gray-500/20 text-gray-400 border-gray-500/30"}},P=w(),F=d.filter(L=>L.status==="connected");return n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"text-center",children:[n.jsx(mr,{className:"text-white text-lg block mb-2",children:"MCP Gateway Tools"}),n.jsxs("p",{className:"text-sm text-gray-400",children:["Select tools from ",F.length," connected server",F.length!==1?"s":""]})]}),n.jsxs("div",{className:"relative",children:[n.jsx($c,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),n.jsx(An,{value:r,onChange:L=>i(L.target.value),placeholder:"Search tools...",className:"bg-beam-dark border-gray-700 text-white pl-10"}),r&&n.jsx("button",{onClick:()=>i(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-white",children:n.jsx(Pc,{className:"h-4 w-4"})})]}),n.jsx("div",{className:"flex gap-1 p-1 bg-beam-dark rounded-lg",children:x.map(L=>{const B=L.icon,V=a===L.id,$=L.id==="all"?s.length:s.filter(G=>G.category===L.id).length;return n.jsxs("button",{onClick:()=>l(L.id),className:`flex-1 flex items-center justify-center gap-2 px-3 py-2 rounded-md text-sm font-medium transition-all ${V?"bg-beam-blue text-white":"text-gray-400 hover:text-white hover:bg-gray-700"}`,children:[n.jsx(B,{className:"h-4 w-4"}),n.jsx("span",{className:"hidden sm:inline",children:L.label}),n.jsx(Tt,{variant:"outline",className:"text-xs",children:$})]},L.id)})}),n.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:P.length===0?n.jsxs("div",{className:"text-center py-8 text-gray-400",children:[n.jsx($c,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),n.jsx("p",{children:"No tools found"})]}):P.map(L=>{const B=j(L.id,L.serverId);return n.jsxs("div",{onClick:()=>t(L.id,L.serverId,!B),className:`flex items-center justify-between p-3 rounded-lg border cursor-pointer transition-all ${B?"bg-beam-blue/10 border-beam-blue/30":"bg-beam-dark border-gray-700 hover:bg-gray-700 hover:border-gray-600"}`,children:[n.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[n.jsx("div",{className:`p-2 rounded-lg ${B?"bg-beam-blue/20":"bg-gray-700/50"}`,children:p(L.category)}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx("h4",{className:"font-medium text-white truncate",children:L.name}),L.verified&&n.jsx(ro,{className:"h-3 w-3 text-green-400"})]}),n.jsx("p",{className:"text-sm text-gray-400 truncate",children:L.description}),n.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[n.jsx(Tt,{className:`text-xs ${S(L.usageComplexity)}`,children:L.usageComplexity}),n.jsx("span",{className:"text-xs text-gray-500",children:L.serverName})]})]})]}),n.jsx("div",{className:`p-1 rounded-full transition-colors ${B?"bg-beam-blue":"bg-gray-700 hover:bg-gray-600"}`,children:B?n.jsx(ro,{className:"h-4 w-4 text-white"}):n.jsx(Mo,{className:"h-4 w-4 text-gray-400"})})]},`${L.serverId}-${L.id}`)})}),e.length>0&&n.jsx(jt,{className:"bg-beam-dark border-gray-700",children:n.jsxs(Ht,{className:"p-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsxs("span",{className:"text-sm font-medium text-white",children:["Selected MCP Tools (",e.length,")"]}),n.jsx(lt,{variant:"ghost",size:"sm",onClick:()=>{e.forEach(L=>{t(L.toolId,L.serverId,!1)})},className:"text-gray-400 hover:text-white h-6 px-2",children:"Clear all"})]}),n.jsx("div",{className:"flex flex-wrap gap-2",children:e.map((L,B)=>{const V=s.find($=>$.id===L.toolId&&$.serverId===L.serverId);return V?n.jsxs("div",{className:"flex items-center gap-1 bg-beam-blue/20 text-blue-300 px-2 py-1 rounded-md text-sm",children:[p(V.category),n.jsx("span",{children:V.name}),n.jsx("button",{onClick:$=>{$.stopPropagation(),t(V.id,V.serverId,!1)},className:"ml-1 text-blue-400 hover:text-blue-300",children:n.jsx(Pc,{className:"h-3 w-3"})})]},B):null})})]})})]})},ort=[{id:"gpt-4o-mini",name:"GPT-4o Mini",provider:"OpenAI",description:"Fast and efficient model with good reasoning capabilities",capabilities:{reasoning:7,multimodal:!0,speed:9,knowledge:7},cost:1,badge:"FAST"},{id:"gpt-4o",name:"GPT-4o",provider:"OpenAI",description:"Powerful model with excellent reasoning and multimodal capabilities",capabilities:{reasoning:9,multimodal:!0,speed:7,knowledge:9},cost:5,badge:"BALANCED"},{id:"gpt-4.5-preview",name:"GPT-4.5 Preview",provider:"OpenAI",description:"Most advanced model with superior reasoning for complex tasks",capabilities:{reasoning:10,multimodal:!0,speed:6,knowledge:10},cost:10,badge:"POWERFUL"}],lrt=[{id:"claude-3-opus",name:"Claude 3 Opus",provider:"Anthropic",description:"Anthropic's most powerful model for complex reasoning and analysis",capabilities:{reasoning:10,multimodal:!0,speed:6,knowledge:9},cost:9,badge:"PREMIUM"},{id:"claude-3-sonnet",name:"Claude 3 Sonnet",provider:"Anthropic",description:"Balanced model for everyday tasks with good efficiency",capabilities:{reasoning:8,multimodal:!0,speed:7,knowledge:8},cost:5,badge:"BALANCED"},{id:"claude-3-haiku",name:"Claude 3 Haiku",provider:"Anthropic",description:"Fast and cost-effective model for simple tasks",capabilities:{reasoning:7,multimodal:!0,speed:9,knowledge:7},cost:2,badge:"FAST"}],crt=[{id:"llama-3-8b",name:"Llama 3 8B",provider:"Meta",description:"Compact open-source model optimized for efficiency",capabilities:{reasoning:6,multimodal:!1,speed:9,knowledge:6},cost:1,badge:"COMPACT"},{id:"llama-3-70b",name:"Llama 3 70B",provider:"Meta",description:"Powerful open-source model with strong reasoning capabilities",capabilities:{reasoning:8,multimodal:!1,speed:7,knowledge:8},cost:3,badge:"POWERFUL"},{id:"llama-4-405b",name:"Llama 4 405B",provider:"Meta",description:"Next-generation open-source model with exceptional capabilities",capabilities:{reasoning:9,multimodal:!0,speed:6,knowledge:9},cost:5,badge:"ADVANCED"}],urt=[{id:"deepseek-coder",name:"DeepSeek Coder",provider:"DeepSeek",description:"Specialized for code generation and understanding",capabilities:{reasoning:7,multimodal:!1,speed:8,knowledge:7},cost:2,badge:"CODE"},{id:"deepseek-llm-7b",name:"DeepSeek LLM 7B",provider:"DeepSeek",description:"Efficient general purpose model",capabilities:{reasoning:6,multimodal:!1,speed:9,knowledge:6},cost:1,badge:"EFFICIENT"},{id:"deepseek-llm-67b",name:"DeepSeek LLM 67B",provider:"DeepSeek",description:"Powerful general purpose model with advanced reasoning",capabilities:{reasoning:8,multimodal:!1,speed:7,knowledge:8},cost:4,badge:"ADVANCED"}],drt=[{id:"nova-lite",name:"Nova Lite",provider:"Amazon",description:"Fast and efficient model for everyday business tasks",capabilities:{reasoning:7,multimodal:!1,speed:9,knowledge:7},cost:2,badge:"FAST"},{id:"nova-pro",name:"Nova Pro",provider:"Amazon",description:"Powerful AI model with advanced reasoning capabilities",capabilities:{reasoning:9,multimodal:!0,speed:7,knowledge:9},cost:6,badge:"PREMIUM"}],EZ={openai:ort,anthropic:lrt,meta:crt,deepseek:urt,amazon:drt},hrt=[{id:"code-interpreter",name:"Code Interpreter",description:"Allow the agent to write and execute code",icon:n.jsx(GD,{size:16,className:"text-green-400"})},{id:"reasoning-engine",name:"Reasoning Engine",description:"Advanced reasoning capabilities for complex problem-solving",icon:n.jsx(ti,{size:16,className:"text-purple-400"})},{id:"knowledge-graph",name:"Knowledge Graph",description:"Navigate and query complex knowledge relationships",icon:n.jsx(VD,{size:16,className:"text-blue-400"})},{id:"web-search",name:"Web Search",description:"Allow the agent to search the web for information",icon:n.jsx(B9,{size:16,className:"text-blue-400"})},{id:"document-retrieval",name:"Document Retrieval",description:"Allow the agent to retrieve and analyze documents",icon:n.jsx(Nh,{size:16,className:"text-yellow-400"})},{id:"api-access",name:"API Access",description:"Allow the agent to make API calls to external services",icon:n.jsx(B9,{size:16,className:"text-purple-400"})},{id:"knowledge-base",name:"Knowledge Base",description:"Allow the agent to access internal knowledge base",icon:n.jsx(CQ,{size:16,className:"text-indigo-400"})},{id:"prompt-engineering",name:"Prompt Engineering",description:"Create and optimize prompts for generative AI models",icon:n.jsx(kQ,{size:16,className:"text-pink-400"})},{id:"database-access",name:"Database Access",description:"Allow the agent to query and modify database records",icon:n.jsx(ln,{size:16,className:"text-orange-400"})}],mrt=[{id:"assistant",name:"General Assistant",description:"General purpose AI agent for a wide range of tasks",icon:n.jsx(Hi,{size:16,className:"text-blue-400"})},{id:"data-analyst",name:"Data Analyst",description:"Specialized in data analysis and visualization",icon:n.jsx(Co,{size:16,className:"text-green-400"})},{id:"code-assistant",name:"Code Assistant",description:"Specialized in writing and reviewing code",icon:n.jsx(Bc,{size:16,className:"text-purple-400"})},{id:"customer-support",name:"Customer Support",description:"Assists users with questions and troubleshooting",icon:n.jsx(_s,{size:16,className:"text-yellow-400"})},{id:"domain-expert",name:"Domain Expert",description:"Specialized knowledge in a specific domain",icon:n.jsx(CQ,{size:16,className:"text-red-400"})},{id:"custom",name:"Custom Role",description:"Define a custom role for your agent",icon:n.jsx(ws,{size:16,className:"text-gray-400"})}],frt=({open:e,onOpenChange:t})=>{const{toast:r}=Ah(),[i,a]=U.useState(1),[l,d]=U.useState(""),[s,p]=U.useState("openai"),[x,w]=U.useState(null),[j,S]=U.useState(""),[P,F]=U.useState(""),[L,B]=U.useState({shortTerm:!0,longTerm:!1,summary:!1,entity:!1}),[V,$]=U.useState([]),[G,W]=U.useState({global:!0,local:!1}),[Z,se]=U.useState(!1),[ae,ce]=U.useState([]),Pe=()=>{a(_e=>Math.min(_e+1,6))},we=()=>{a(_e=>Math.max(_e-1,1))},xe=(_e,Ee)=>{B(je=>({...je,[_e]:Ee}))},Ne=(_e,Ee)=>{$(je=>Ee?[...je,_e]:je.filter(Ce=>Ce!==_e))},ze=(_e,Ee)=>{W(je=>({...je,[_e]:Ee}))},ye=(_e,Ee,je)=>{ce(Ce=>je?[...Ce,{toolId:_e,serverId:Ee}]:Ce.filter(tt=>!(tt.toolId===_e&&tt.serverId===Ee)))},ve=()=>{r({title:"Agent Created Successfully",description:"Debug agent created!"}),t(!1),a(1)};return n.jsx(Ml,{open:e,onOpenChange:t,children:n.jsxs(Qo,{className:"bg-beam-dark-accent border-gray-700 text-white sm:max-w-md z-50",children:[n.jsx(el,{children:n.jsx(tl,{className:"text-white",children:"Create New Agent (Debug)"})}),n.jsxs("div",{className:"space-y-6",children:[i===1?n.jsxs("div",{className:"space-y-6",children:[n.jsx(wtt,{value:l,onChange:d}),n.jsx(ztt,{selectedModel:x,setSelectedModel:w,selectedProvider:s,handleProviderChange:p,handleModelChange:_e=>{var Ee;return w(((Ee=EZ[s])==null?void 0:Ee.find(je=>je.id===_e))||null)},AIModels:EZ})]}):i===2?n.jsx(Ltt,{roles:mrt,handleRoleSelect:S,selectedRole:j,description:P,onDescriptionChange:F}):i===3?n.jsx(Ftt,{handleMemoryToggle:xe,memory:L}):i===4?n.jsx(srt,{tools:hrt,handleToolToggle:Ne,selectedTools:V,guardrails:G,onGuardrailToggle:ze,databaseAccess:Z,onDatabaseAccessToggle:se}):i===5?n.jsx(art,{selectedMCPTools:ae,onMCPToolToggle:ye}):i===6?n.jsxs("div",{className:"text-center space-y-4",children:[n.jsx("h2",{className:"text-xl text-white",children:"Review & Confirm"}),n.jsxs("div",{className:"text-left space-y-2 bg-beam-dark p-4 rounded-lg",children:[n.jsxs("p",{className:"text-gray-300",children:[n.jsx("span",{className:"text-white",children:"Name:"})," ",l||"Not set"]}),n.jsxs("p",{className:"text-gray-300",children:[n.jsx("span",{className:"text-white",children:"Role:"})," ",j||"Not selected"]}),n.jsxs("p",{className:"text-gray-300",children:[n.jsx("span",{className:"text-white",children:"Model:"})," ",(x==null?void 0:x.name)||"Default"]}),n.jsxs("p",{className:"text-gray-300",children:[n.jsx("span",{className:"text-white",children:"Tools:"})," ",V.length," selected"]}),n.jsxs("p",{className:"text-gray-300",children:[n.jsx("span",{className:"text-white",children:"MCP Tools:"})," ",ae.length," selected"]})]})]}):n.jsxs("div",{className:"text-center",children:[n.jsxs("h2",{className:"text-xl text-white",children:["Step ",i," of 6"]}),n.jsxs("p",{className:"text-gray-300",children:["Debug step content for step ",i]})]}),n.jsxs(mg,{className:"gap-2 flex-row sm:justify-between",children:[n.jsxs("div",{className:"flex gap-2",children:[i>1&&n.jsx(lt,{type:"button",variant:"outline",onClick:we,className:"border-gray-700 text-white hover:bg-gray-700",children:"Back"}),i<6?n.jsx(lt,{type:"button",onClick:Pe,className:"bg-beam-blue hover:bg-beam-blue/80 text-white",children:"Next"}):n.jsx(lt,{type:"button",onClick:ve,className:"bg-green-500 hover:bg-green-600 text-white",children:"Create Agent"})]}),n.jsxs("div",{className:"text-xs text-gray-400 flex items-center gap-1",children:[n.jsx(f_,{size:12}),"Step ",i," of 6"]})]})]})]})})},prt=({open:e,onOpenChange:t})=>n.jsx(frt,{open:e,onOpenChange:t}),grt=({form:e})=>{const{register:t,formState:{errors:r}}=e;return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"text-center space-y-2",children:[n.jsx("div",{className:"flex justify-center",children:n.jsx("div",{className:"p-3 bg-purple-600/20 rounded-full",children:n.jsx(ti,{size:32,className:"text-purple-400"})})}),n.jsx("h3",{className:"text-lg font-semibold text-white",children:"Strands Agentic Workflow"}),n.jsx("p",{className:"text-gray-400 text-sm max-w-md mx-auto",children:"Create an advanced reasoning workflow with multi-step thinking, reflection, and memory consolidation"})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 p-4 bg-gray-800/50 rounded-lg",children:[n.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-300",children:[n.jsx(Yi,{size:16,className:"text-yellow-400"}),n.jsx("span",{children:"Advanced Reasoning"})]}),n.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-300",children:[n.jsx(Ch,{size:16,className:"text-green-400"}),n.jsx("span",{children:"Multi-Step Planning"})]}),n.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-300",children:[n.jsx(ti,{size:16,className:"text-purple-400"}),n.jsx("span",{children:"Memory Consolidation"})]})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(mr,{htmlFor:"name",className:"text-white",children:"Workflow Name *"}),n.jsx(An,{id:"name",...t("name",{required:"Workflow name is required"}),placeholder:"e.g., Strategic Analysis Workflow",className:"bg-gray-800 border-gray-600 text-white placeholder-gray-400"}),r.name&&n.jsx("p",{className:"text-red-400 text-sm",children:r.name.message})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(mr,{htmlFor:"description",className:"text-white",children:"Description"}),n.jsx(po,{id:"description",...t("description"),placeholder:"Describe what this workflow will accomplish and its reasoning approach...",rows:4,className:"bg-gray-800 border-gray-600 text-white placeholder-gray-400 resize-none"}),n.jsx("p",{className:"text-gray-500 text-xs",children:"Provide context about the workflow's purpose and expected reasoning patterns"})]})]}),n.jsxs("div",{className:"bg-blue-900/20 border border-blue-700/50 rounded-lg p-4",children:[n.jsx("h4",{className:"text-blue-300 font-medium mb-2",children:"🧠 What makes Strands special?"}),n.jsxs("ul",{className:"text-blue-200 text-sm space-y-1",children:[n.jsx("li",{children:"• Chain-of-thought and tree-of-thought reasoning"}),n.jsx("li",{children:"• Self-reflection and critique capabilities"}),n.jsx("li",{children:"• Advanced memory systems with consolidation"}),n.jsx("li",{children:"• Multi-step workflow orchestration"}),n.jsx("li",{children:"• AWS Bedrock integration for enterprise-grade AI"})]})]})]})};var Zce=["PageUp","PageDown"],Yce=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],Xce={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},B_="Slider",[iL,xrt,yrt]=d_(B_),[Jce,hft]=Jo(B_,[yrt]),[vrt,g3]=Jce(B_),Qce=U.forwardRef((e,t)=>{const{name:r,min:i=0,max:a=100,step:l=1,orientation:d="horizontal",disabled:s=!1,minStepsBetweenThumbs:p=0,defaultValue:x=[i],value:w,onValueChange:j=()=>{},onValueCommit:S=()=>{},inverted:P=!1,form:F,...L}=e,B=U.useRef(new Set),V=U.useRef(0),G=d==="horizontal"?brt:_rt,[W=[],Z]=fo({prop:w,defaultProp:x,onChange:xe=>{var ze;(ze=[...B.current][V.current])==null||ze.focus(),j(xe)}}),se=U.useRef(W);function ae(xe){const Ne=Crt(W,xe);we(xe,Ne)}function ce(xe){we(xe,V.current)}function Pe(){const xe=se.current[V.current];W[V.current]!==xe&&S(W)}function we(xe,Ne,{commit:ze}={commit:!1}){const ye=Prt(l),ve=Ert(Math.round((xe-i)/l)*l+i,ye),_e=pN(ve,[i,a]);Z((Ee=[])=>{const je=Nrt(Ee,_e,Ne);if(krt(je,p*l)){V.current=je.indexOf(_e);const Ce=String(je)!==String(Ee);return Ce&&ze&&S(je),Ce?je:Ee}else return Ee})}return n.jsx(vrt,{scope:e.__scopeSlider,name:r,disabled:s,min:i,max:a,valueIndexToChangeRef:V,thumbs:B.current,values:W,orientation:d,form:F,children:n.jsx(iL.Provider,{scope:e.__scopeSlider,children:n.jsx(iL.Slot,{scope:e.__scopeSlider,children:n.jsx(G,{"aria-disabled":s,"data-disabled":s?"":void 0,...L,ref:t,onPointerDown:_r(L.onPointerDown,()=>{s||(se.current=W)}),min:i,max:a,inverted:P,onSlideStart:s?void 0:ae,onSlideMove:s?void 0:ce,onSlideEnd:s?void 0:Pe,onHomeKeyDown:()=>!s&&we(i,0,{commit:!0}),onEndKeyDown:()=>!s&&we(a,W.length-1,{commit:!0}),onStepKeyDown:({event:xe,direction:Ne})=>{if(!s){const ve=Zce.includes(xe.key)||xe.shiftKey&&Yce.includes(xe.key)?10:1,_e=V.current,Ee=W[_e],je=l*ve*Ne;we(Ee+je,_e,{commit:!0})}}})})})})});Qce.displayName=B_;var[eue,tue]=Jce(B_,{startEdge:"left",endEdge:"right",size:"width",direction:1}),brt=U.forwardRef((e,t)=>{const{min:r,max:i,dir:a,inverted:l,onSlideStart:d,onSlideMove:s,onSlideEnd:p,onStepKeyDown:x,...w}=e,[j,S]=U.useState(null),P=Mn(t,G=>S(G)),F=U.useRef(),L=sg(a),B=L==="ltr",V=B&&!l||!B&&l;function $(G){const W=F.current||j.getBoundingClientRect(),Z=[0,W.width],ae=J6(Z,V?[r,i]:[i,r]);return F.current=W,ae(G-W.left)}return n.jsx(eue,{scope:e.__scopeSlider,startEdge:V?"left":"right",endEdge:V?"right":"left",direction:V?1:-1,size:"width",children:n.jsx(rue,{dir:L,"data-orientation":"horizontal",...w,ref:P,style:{...w.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:G=>{const W=$(G.clientX);d==null||d(W)},onSlideMove:G=>{const W=$(G.clientX);s==null||s(W)},onSlideEnd:()=>{F.current=void 0,p==null||p()},onStepKeyDown:G=>{const Z=Xce[V?"from-left":"from-right"].includes(G.key);x==null||x({event:G,direction:Z?-1:1})}})})}),_rt=U.forwardRef((e,t)=>{const{min:r,max:i,inverted:a,onSlideStart:l,onSlideMove:d,onSlideEnd:s,onStepKeyDown:p,...x}=e,w=U.useRef(null),j=Mn(t,w),S=U.useRef(),P=!a;function F(L){const B=S.current||w.current.getBoundingClientRect(),V=[0,B.height],G=J6(V,P?[i,r]:[r,i]);return S.current=B,G(L-B.top)}return n.jsx(eue,{scope:e.__scopeSlider,startEdge:P?"bottom":"top",endEdge:P?"top":"bottom",size:"height",direction:P?1:-1,children:n.jsx(rue,{"data-orientation":"vertical",...x,ref:j,style:{...x.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:L=>{const B=F(L.clientY);l==null||l(B)},onSlideMove:L=>{const B=F(L.clientY);d==null||d(B)},onSlideEnd:()=>{S.current=void 0,s==null||s()},onStepKeyDown:L=>{const V=Xce[P?"from-bottom":"from-top"].includes(L.key);p==null||p({event:L,direction:V?-1:1})}})})}),rue=U.forwardRef((e,t)=>{const{__scopeSlider:r,onSlideStart:i,onSlideMove:a,onSlideEnd:l,onHomeKeyDown:d,onEndKeyDown:s,onStepKeyDown:p,...x}=e,w=g3(B_,r);return n.jsx(Hr.span,{...x,ref:t,onKeyDown:_r(e.onKeyDown,j=>{j.key==="Home"?(d(j),j.preventDefault()):j.key==="End"?(s(j),j.preventDefault()):Zce.concat(Yce).includes(j.key)&&(p(j),j.preventDefault())}),onPointerDown:_r(e.onPointerDown,j=>{const S=j.target;S.setPointerCapture(j.pointerId),j.preventDefault(),w.thumbs.has(S)?S.focus():i(j)}),onPointerMove:_r(e.onPointerMove,j=>{j.target.hasPointerCapture(j.pointerId)&&a(j)}),onPointerUp:_r(e.onPointerUp,j=>{const S=j.target;S.hasPointerCapture(j.pointerId)&&(S.releasePointerCapture(j.pointerId),l(j))})})}),nue="SliderTrack",iue=U.forwardRef((e,t)=>{const{__scopeSlider:r,...i}=e,a=g3(nue,r);return n.jsx(Hr.span,{"data-disabled":a.disabled?"":void 0,"data-orientation":a.orientation,...i,ref:t})});iue.displayName=nue;var sL="SliderRange",sue=U.forwardRef((e,t)=>{const{__scopeSlider:r,...i}=e,a=g3(sL,r),l=tue(sL,r),d=U.useRef(null),s=Mn(t,d),p=a.values.length,x=a.values.map(S=>oue(S,a.min,a.max)),w=p>1?Math.min(...x):0,j=100-Math.max(...x);return n.jsx(Hr.span,{"data-orientation":a.orientation,"data-disabled":a.disabled?"":void 0,...i,ref:s,style:{...e.style,[l.startEdge]:w+"%",[l.endEdge]:j+"%"}})});sue.displayName=sL;var aL="SliderThumb",aue=U.forwardRef((e,t)=>{const r=xrt(e.__scopeSlider),[i,a]=U.useState(null),l=Mn(t,s=>a(s)),d=U.useMemo(()=>i?r().findIndex(s=>s.ref.current===i):-1,[r,i]);return n.jsx(wrt,{...e,ref:l,index:d})}),wrt=U.forwardRef((e,t)=>{const{__scopeSlider:r,index:i,name:a,...l}=e,d=g3(aL,r),s=tue(aL,r),[p,x]=U.useState(null),w=Mn(t,$=>x($)),j=p?d.form||!!p.closest("form"):!0,S=TE(p),P=d.values[i],F=P===void 0?0:oue(P,d.min,d.max),L=Srt(i,d.values.length),B=S==null?void 0:S[s.size],V=B?Art(B,F,s.direction):0;return U.useEffect(()=>{if(p)return d.thumbs.add(p),()=>{d.thumbs.delete(p)}},[p,d.thumbs]),n.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[s.startEdge]:`calc(${F}% + ${V}px)`},children:[n.jsx(iL.ItemSlot,{scope:e.__scopeSlider,children:n.jsx(Hr.span,{role:"slider","aria-label":e["aria-label"]||L,"aria-valuemin":d.min,"aria-valuenow":P,"aria-valuemax":d.max,"aria-orientation":d.orientation,"data-orientation":d.orientation,"data-disabled":d.disabled?"":void 0,tabIndex:d.disabled?void 0:0,...l,ref:w,style:P===void 0?{display:"none"}:e.style,onFocus:_r(e.onFocus,()=>{d.valueIndexToChangeRef.current=i})})}),j&&n.jsx(jrt,{name:a??(d.name?d.name+(d.values.length>1?"[]":""):void 0),form:d.form,value:P},i)]})});aue.displayName=aL;var jrt=e=>{const{value:t,...r}=e,i=U.useRef(null),a=s3(t);return U.useEffect(()=>{const l=i.current,d=window.HTMLInputElement.prototype,p=Object.getOwnPropertyDescriptor(d,"value").set;if(a!==t&&p){const x=new Event("input",{bubbles:!0});p.call(l,t),l.dispatchEvent(x)}},[a,t]),n.jsx("input",{style:{display:"none"},...r,ref:i,defaultValue:t})};function Nrt(e=[],t,r){const i=[...e];return i[r]=t,i.sort((a,l)=>a-l)}function oue(e,t,r){const l=100/(r-t)*(e-t);return pN(l,[0,100])}function Srt(e,t){return t>2?`Value ${e+1} of ${t}`:t===2?["Minimum","Maximum"][e]:void 0}function Crt(e,t){if(e.length===1)return 0;const r=e.map(a=>Math.abs(a-t)),i=Math.min(...r);return r.indexOf(i)}function Art(e,t,r){const i=e/2,l=J6([0,50],[0,i]);return(i-l(t)*r)*r}function Trt(e){return e.slice(0,-1).map((t,r)=>e[r+1]-t)}function krt(e,t){if(t>0){const r=Trt(e);return Math.min(...r)>=t}return!0}function J6(e,t){return r=>{if(e[0]===e[1]||t[0]===t[1])return t[0];const i=(t[1]-t[0])/(e[1]-e[0]);return t[0]+i*(r-e[0])}}function Prt(e){return(String(e).split(".")[1]||"").length}function Ert(e,t){const r=Math.pow(10,t);return Math.round(e*r)/r}var lue=Qce,Mrt=iue,Irt=sue,Ort=aue;const oh=U.forwardRef(({className:e,...t},r)=>n.jsxs(lue,{ref:r,className:Yt("relative flex w-full touch-none select-none items-center",e),...t,children:[n.jsx(Mrt,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-gray-700",children:n.jsx(Irt,{className:"absolute h-full bg-gradient-to-r from-beam-blue to-blue-600"})}),n.jsx(Ort,{className:"block h-5 w-5 rounded-full border-2 border-beam-blue bg-white ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]}));oh.displayName=lue.displayName;const Rrt=({form:e,selectedModel:t,setSelectedModel:r,selectedProvider:i,handleProviderChange:a,StrandsModels:l})=>{const{setValue:d,watch:s}=e,p=s("performance_config"),x=l.filter(S=>S.provider===i),w=S=>{const P=l.find(F=>F.id===S);if(P){r(P),d("model",S);const F=p;P.context_window>1e5&&j("max_tokens",Math.min(8e3,F.max_tokens)),P.reasoning_capabilities.includes("tree_of_thought")&&j("max_reasoning_depth",Math.max(7,F.max_reasoning_depth))}},j=(S,P)=>{d("performance_config",{...p,[S]:P})};return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"text-center space-y-2",children:[n.jsx("div",{className:"flex justify-center",children:n.jsx("div",{className:"p-3 bg-blue-600/20 rounded-full",children:n.jsx(bd,{size:32,className:"text-blue-400"})})}),n.jsx("h3",{className:"text-lg font-semibold text-white",children:"Model & Performance Configuration"}),n.jsx("p",{className:"text-gray-400 text-sm max-w-md mx-auto",children:"Select the AI model and configure performance parameters for optimal reasoning"})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(mr,{className:"text-white",children:"Provider *"}),n.jsxs(_n,{value:i,onValueChange:a,children:[n.jsx(xn,{className:"bg-gray-800 border-gray-600 text-white",children:n.jsx(wn,{placeholder:"Select provider"})}),n.jsxs(yn,{className:"bg-gray-800 border-gray-600",children:[n.jsx(yt,{value:"bedrock",className:"text-white",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(op,{size:16,className:"text-orange-400"}),"AWS Bedrock (Recommended)"]})}),n.jsx(yt,{value:"openai",className:"text-white",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Yi,{size:16,className:"text-green-400"}),"OpenAI"]})}),n.jsx(yt,{value:"anthropic",className:"text-white",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(bd,{size:16,className:"text-blue-400"}),"Anthropic"]})})]})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(mr,{className:"text-white",children:"Model *"}),n.jsxs(_n,{value:(t==null?void 0:t.id)||"",onValueChange:w,children:[n.jsx(xn,{className:"bg-gray-800 border-gray-600 text-white",children:n.jsx(wn,{placeholder:"Select model"})}),n.jsx(yn,{className:"bg-gray-800 border-gray-600",children:x.map(S=>n.jsx(yt,{value:S.id,className:"text-white",children:n.jsxs("div",{className:"space-y-1",children:[n.jsx("div",{className:"font-medium",children:S.name}),n.jsxs("div",{className:"text-xs text-gray-400",children:["Context: ",S.context_window.toLocaleString()," tokens"]})]})},S.id))})]})]}),t&&n.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4 space-y-3",children:[n.jsxs("h4",{className:"text-white font-medium flex items-center gap-2",children:[n.jsx(ws,{size:16}),"Model Capabilities"]}),n.jsx("div",{className:"grid grid-cols-2 gap-2",children:t.reasoning_capabilities.map(S=>n.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[n.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full"}),n.jsx("span",{className:"text-gray-300 capitalize",children:S.replace("_"," ")})]},S))})]})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsx("h4",{className:"text-white font-medium",children:"Performance Parameters"}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx(mr,{className:"text-white",children:"Temperature"}),n.jsx("span",{className:"text-gray-400 text-sm",children:p.temperature})]}),n.jsx(oh,{value:[p.temperature],onValueChange:([S])=>j("temperature",S),max:1,min:0,step:.1,className:"w-full"}),n.jsx("p",{className:"text-gray-500 text-xs",children:"Lower values for more focused reasoning, higher for more creative thinking"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx(mr,{className:"text-white",children:"Max Tokens"}),n.jsx("span",{className:"text-gray-400 text-sm",children:p.max_tokens})]}),n.jsx(oh,{value:[p.max_tokens],onValueChange:([S])=>j("max_tokens",S),max:8e3,min:1e3,step:500,className:"w-full"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx(mr,{className:"text-white",children:"Max Reasoning Depth"}),n.jsx("span",{className:"text-gray-400 text-sm",children:p.max_reasoning_depth})]}),n.jsx(oh,{value:[p.max_reasoning_depth],onValueChange:([S])=>j("max_reasoning_depth",S),max:10,min:1,step:1,className:"w-full"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx(mr,{className:"text-white",children:"Reflection Cycles"}),n.jsx("span",{className:"text-gray-400 text-sm",children:p.reflection_cycles})]}),n.jsx(oh,{value:[p.reflection_cycles],onValueChange:([S])=>j("reflection_cycles",S),max:5,min:0,step:1,className:"w-full"})]})]})]})]})},Drt={chain_of_thought:ti,tree_of_thought:Mve,reflection:vx,self_critique:fs,multi_step_reasoning:IQ,analogical_reasoning:RF},zrt=({form:e,handleReasoningPatternToggle:t,reasoningPatterns:r,selectedModel:i})=>{const{watch:a}=e,l=a("reasoning_patterns"),d=s=>(i==null?void 0:i.reasoning_capabilities.includes(s))??!1;return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"text-center space-y-2",children:[n.jsx("div",{className:"flex justify-center",children:n.jsx("div",{className:"p-3 bg-purple-600/20 rounded-full",children:n.jsx(ti,{size:32,className:"text-purple-400"})})}),n.jsx("h3",{className:"text-lg font-semibold text-white",children:"Reasoning Patterns"}),n.jsx("p",{className:"text-gray-400 text-sm max-w-md mx-auto",children:"Select the reasoning patterns your workflow will use for advanced problem-solving"})]}),n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:r.map(s=>{const p=Drt[s.id]||ti,x=d(s.id),w=l[s.id];return n.jsx("div",{className:`p-4 rounded-lg border transition-all ${w?"border-purple-500 bg-purple-900/20":x?"border-gray-600 bg-gray-800/50 hover:border-gray-500":"border-gray-700 bg-gray-800/30 opacity-50"}`,children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:"flex items-center space-x-2",children:n.jsx(yu,{id:s.id,checked:w,onCheckedChange:()=>t(s.id),disabled:!x,className:"border-gray-500"})}),n.jsxs("div",{className:"flex-1 space-y-2",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(p,{size:18,className:w?"text-purple-400":"text-gray-400"}),n.jsx("h4",{className:`font-medium ${w?"text-white":"text-gray-300"}`,children:s.name}),n.jsx("span",{className:`text-xs px-2 py-1 rounded ${s.complexity==="basic"?"bg-green-900/30 text-green-300":s.complexity==="intermediate"?"bg-yellow-900/30 text-yellow-300":"bg-red-900/30 text-red-300"}`,children:s.complexity})]}),n.jsx("p",{className:"text-gray-400 text-sm",children:s.description}),n.jsx("div",{className:"flex flex-wrap gap-1",children:s.use_cases.slice(0,2).map(j=>n.jsx("span",{className:"text-xs bg-gray-700 text-gray-300 px-2 py-1 rounded",children:j},j))}),!x&&n.jsx("p",{className:"text-red-400 text-xs",children:"Not supported by selected model"})]})]})},s.id)})}),n.jsxs("div",{className:"bg-blue-900/20 border border-blue-700/50 rounded-lg p-4",children:[n.jsx("h4",{className:"text-blue-300 font-medium mb-2",children:"💡 Reasoning Pattern Tips"}),n.jsxs("ul",{className:"text-blue-200 text-sm space-y-1",children:[n.jsx("li",{children:"• Start with Chain-of-Thought for basic step-by-step reasoning"}),n.jsx("li",{children:"• Add Tree-of-Thought for complex planning and exploration"}),n.jsx("li",{children:"• Enable Reflection for self-improvement and error correction"}),n.jsx("li",{children:"• Use Self-Critique for quality assurance and validation"})]})]})]})},Lrt={working_memory:$a,episodic_memory:Kye,semantic_memory:ln,memory_consolidation:PF,context_window_management:ws},Frt=({form:e,handleMemoryToggle:t,memoryTypes:r})=>{const{watch:i}=e,a=i("memory");return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"text-center space-y-2",children:[n.jsx("div",{className:"flex justify-center",children:n.jsx("div",{className:"p-3 bg-green-600/20 rounded-full",children:n.jsx(ln,{size:32,className:"text-green-400"})})}),n.jsx("h3",{className:"text-lg font-semibold text-white",children:"Memory Configuration"}),n.jsx("p",{className:"text-gray-400 text-sm max-w-md mx-auto",children:"Configure memory systems for context retention and knowledge consolidation"})]}),n.jsx("div",{className:"grid grid-cols-1 gap-4",children:r.map(l=>{const d=Lrt[l.id]||ln,s=a[l.id];return n.jsx("div",{className:`p-4 rounded-lg border transition-all ${s?"border-green-500 bg-green-900/20":"border-gray-600 bg-gray-800/50 hover:border-gray-500"}`,children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:"flex items-center space-x-2",children:n.jsx(yu,{id:l.id,checked:s,onCheckedChange:()=>t(l.id),className:"border-gray-500"})}),n.jsxs("div",{className:"flex-1 space-y-2",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(d,{size:18,className:s?"text-green-400":"text-gray-400"}),n.jsx("h4",{className:`font-medium ${s?"text-white":"text-gray-300"}`,children:l.name}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("span",{className:`text-xs px-2 py-1 rounded ${l.capacity==="limited"?"bg-yellow-900/30 text-yellow-300":"bg-green-900/30 text-green-300"}`,children:l.capacity}),n.jsx("span",{className:`text-xs px-2 py-1 rounded ${l.persistence==="session"?"bg-blue-900/30 text-blue-300":"bg-purple-900/30 text-purple-300"}`,children:l.persistence})]})]}),n.jsx("p",{className:"text-gray-400 text-sm",children:l.description}),n.jsx("div",{className:"flex flex-wrap gap-1",children:l.retrieval_methods.map(p=>n.jsx("span",{className:"text-xs bg-gray-700 text-gray-300 px-2 py-1 rounded",children:p},p))}),l.consolidation_support&&n.jsxs("div",{className:"flex items-center gap-1 text-xs text-green-400",children:[n.jsx(PF,{size:12}),n.jsx("span",{children:"Supports consolidation"})]})]})]})},l.id)})}),n.jsxs("div",{className:"bg-green-900/20 border border-green-700/50 rounded-lg p-4",children:[n.jsx("h4",{className:"text-green-300 font-medium mb-2",children:"🧠 Memory System Recommendations"}),n.jsxs("ul",{className:"text-green-200 text-sm space-y-1",children:[n.jsx("li",{children:"• Working Memory: Essential for maintaining context during reasoning"}),n.jsx("li",{children:"• Episodic Memory: Stores specific experiences and learning events"}),n.jsx("li",{children:"• Semantic Memory: Builds long-term knowledge base"}),n.jsx("li",{children:"• Memory Consolidation: Strengthens important memories over time"}),n.jsx("li",{children:"• Context Window Management: Optimizes token usage for better performance"})]})]})]})},Brt={reasoning:ti,tool_use:Yi,memory_retrieval:ln,validation:dn,reflection:vx},$rt=({form:e,handleWorkflowStepAdd:t,handleWorkflowStepRemove:r,handleWorkflowStepUpdate:i})=>{const{watch:a}=e,l=a("workflow_steps");return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"text-center space-y-2",children:[n.jsx("div",{className:"flex justify-center",children:n.jsx("div",{className:"p-3 bg-orange-600/20 rounded-full",children:n.jsx(Q0,{size:32,className:"text-orange-400"})})}),n.jsx("h3",{className:"text-lg font-semibold text-white",children:"Workflow Steps"}),n.jsx("p",{className:"text-gray-400 text-sm max-w-md mx-auto",children:"Define the sequence of reasoning and processing steps for your workflow"})]}),n.jsx("div",{className:"space-y-4",children:l.length===0?n.jsxs("div",{className:"text-center py-8 border-2 border-dashed border-gray-600 rounded-lg",children:[n.jsx(Q0,{size:48,className:"text-gray-500 mx-auto mb-4"}),n.jsx("p",{className:"text-gray-400 mb-4",children:"No workflow steps defined yet"}),n.jsxs(lt,{type:"button",onClick:t,className:"bg-orange-600 hover:bg-orange-700 text-white",children:[n.jsx(Mo,{size:16,className:"mr-2"}),"Add First Step"]})]}):n.jsxs(n.Fragment,{children:[l.map((d,s)=>{const p=Brt[d.type]||ti;return n.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4 space-y-4",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"w-8 h-8 bg-orange-600 rounded-full flex items-center justify-center text-white text-sm font-medium",children:s+1}),n.jsx(p,{size:20,className:"text-orange-400"}),n.jsxs("span",{className:"text-white font-medium",children:["Step ",s+1]})]}),n.jsx(lt,{type:"button",variant:"ghost",size:"sm",onClick:()=>r(d.id),className:"text-red-400 hover:text-red-300 hover:bg-red-900/20",children:n.jsx(BN,{size:16})})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx("label",{className:"text-white text-sm",children:"Step Name"}),n.jsx(An,{value:d.name,onChange:x=>i(d.id,{name:x.target.value}),placeholder:"e.g., Initial Analysis",className:"bg-gray-700 border-gray-600 text-white"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx("label",{className:"text-white text-sm",children:"Step Type"}),n.jsxs(_n,{value:d.type,onValueChange:x=>i(d.id,{type:x}),children:[n.jsx(xn,{className:"bg-gray-700 border-gray-600 text-white",children:n.jsx(wn,{})}),n.jsxs(yn,{className:"bg-gray-800 border-gray-600",children:[n.jsx(yt,{value:"reasoning",className:"text-white",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ti,{size:16}),"Reasoning"]})}),n.jsx(yt,{value:"tool_use",className:"text-white",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Yi,{size:16}),"Tool Use"]})}),n.jsx(yt,{value:"memory_retrieval",className:"text-white",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ln,{size:16}),"Memory Retrieval"]})}),n.jsx(yt,{value:"validation",className:"text-white",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(dn,{size:16}),"Validation"]})}),n.jsx(yt,{value:"reflection",className:"text-white",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(vx,{size:16}),"Reflection"]})})]})]})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx("label",{className:"text-white text-sm",children:"Description"}),n.jsx(po,{value:d.description,onChange:x=>i(d.id,{description:x.target.value}),placeholder:"Describe what this step accomplishes...",rows:2,className:"bg-gray-700 border-gray-600 text-white resize-none"})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(yu,{id:`parallel-${d.id}`,checked:d.parallel_execution,onCheckedChange:x=>i(d.id,{parallel_execution:!!x})}),n.jsx("label",{htmlFor:`parallel-${d.id}`,className:"text-white text-sm",children:"Allow parallel execution with other steps"})]})]},d.id)}),n.jsxs(lt,{type:"button",onClick:t,variant:"outline",className:"w-full border-gray-600 text-gray-300 hover:bg-gray-700",children:[n.jsx(Mo,{size:16,className:"mr-2"}),"Add Another Step"]})]})}),n.jsxs("div",{className:"bg-orange-900/20 border border-orange-700/50 rounded-lg p-4",children:[n.jsx("h4",{className:"text-orange-300 font-medium mb-2",children:"🔄 Workflow Design Tips"}),n.jsxs("ul",{className:"text-orange-200 text-sm space-y-1",children:[n.jsx("li",{children:"• Start with reasoning steps to analyze the problem"}),n.jsx("li",{children:"• Use memory retrieval to access relevant context"}),n.jsx("li",{children:"• Add validation steps to ensure quality"}),n.jsx("li",{children:"• Include reflection steps for self-improvement"}),n.jsx("li",{children:"• Enable parallel execution for independent steps"})]})]})]})},Vrt={reasoning:ti,data:ln,communication:_s,validation:ro,memory:ln},Urt=[{id:"content_filter",name:"Content Filter",description:"Filter inappropriate or harmful content",icon:dn},{id:"reasoning_validator",name:"Reasoning Validator",description:"Validate logical consistency of reasoning",icon:ro},{id:"output_sanitizer",name:"Output Sanitizer",description:"Clean and format output for safety",icon:dn},{id:"ethical_constraints",name:"Ethical Constraints",description:"Enforce ethical guidelines and constraints",icon:dn}],Grt=({form:e,handleToolToggle:t,strandsTools:r})=>{const{watch:i,setValue:a}=e,l=i("tools"),d=i("guardrails"),s=x=>{const w={...d,[x]:!d[x]};a("guardrails",w)},p=r.reduce((x,w)=>(x[w.category]||(x[w.category]=[]),x[w.category].push(w),x),{});return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"text-center space-y-2",children:[n.jsx("div",{className:"flex justify-center",children:n.jsx("div",{className:"p-3 bg-red-600/20 rounded-full",children:n.jsx(dn,{size:32,className:"text-red-400"})})}),n.jsx("h3",{className:"text-lg font-semibold text-white",children:"Tools & Guardrails"}),n.jsx("p",{className:"text-gray-400 text-sm max-w-md mx-auto",children:"Select specialized tools and configure safety guardrails for your workflow"})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("h4",{className:"text-white font-medium flex items-center gap-2",children:[n.jsx(Yi,{size:18}),"Specialized Tools"]}),Object.entries(p).map(([x,w])=>{const j=Vrt[x]||Yi;return n.jsxs("div",{className:"space-y-3",children:[n.jsxs("h5",{className:"text-gray-300 font-medium flex items-center gap-2 capitalize",children:[n.jsx(j,{size:16}),x.replace("_"," ")," Tools"]}),n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:w.map(S=>{const P=l.includes(S.id);return n.jsx("div",{className:`p-3 rounded-lg border transition-all ${P?"border-blue-500 bg-blue-900/20":"border-gray-600 bg-gray-800/50 hover:border-gray-500"}`,children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx(yu,{id:S.id,checked:P,onCheckedChange:()=>t(S.id),className:"border-gray-500 mt-1"}),n.jsxs("div",{className:"flex-1 space-y-1",children:[n.jsx("h6",{className:`font-medium text-sm ${P?"text-white":"text-gray-300"}`,children:S.name}),n.jsx("p",{className:"text-gray-400 text-xs",children:S.description}),S.reasoning_integration&&n.jsxs("div",{className:"flex items-center gap-1 text-xs text-purple-400",children:[n.jsx(ti,{size:10}),n.jsx("span",{children:"Reasoning Integration"})]})]})]})},S.id)})})]},x)})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("h4",{className:"text-white font-medium flex items-center gap-2",children:[n.jsx(dn,{size:18}),"Safety Guardrails"]}),n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Urt.map(x=>{const w=x.icon,j=d[x.id];return n.jsx("div",{className:`p-4 rounded-lg border transition-all ${j?"border-red-500 bg-red-900/20":"border-gray-600 bg-gray-800/50 hover:border-gray-500"}`,children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx(yu,{id:x.id,checked:j,onCheckedChange:()=>s(x.id),className:"border-gray-500"}),n.jsxs("div",{className:"flex-1 space-y-2",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(w,{size:16,className:j?"text-red-400":"text-gray-400"}),n.jsx("h6",{className:`font-medium ${j?"text-white":"text-gray-300"}`,children:x.name})]}),n.jsx("p",{className:"text-gray-400 text-sm",children:x.description})]})]})},x.id)})})]}),n.jsxs("div",{className:"bg-red-900/20 border border-red-700/50 rounded-lg p-4",children:[n.jsx("h4",{className:"text-red-300 font-medium mb-2",children:"🛡️ Safety & Performance Tips"}),n.jsxs("ul",{className:"text-red-200 text-sm space-y-1",children:[n.jsx("li",{children:"• Enable all guardrails for production workflows"}),n.jsx("li",{children:"• Reasoning Validator ensures logical consistency"}),n.jsx("li",{children:"• Content Filter prevents harmful outputs"}),n.jsx("li",{children:"• Specialized tools enhance reasoning capabilities"}),n.jsx("li",{children:"• Memory tools improve context retention"})]})]})]})},Hrt=({step:e,form:t,selectedModel:r,setSelectedModel:i,selectedProvider:a,handleProviderChange:l,handleReasoningPatternToggle:d,handleMemoryToggle:s,handleToolToggle:p,handleWorkflowStepAdd:x,handleWorkflowStepRemove:w,handleWorkflowStepUpdate:j,StrandsModels:S,strandsTools:P,reasoningPatterns:F,memoryTypes:L})=>{switch(e){case 1:return n.jsx(grt,{form:t});case 2:return n.jsx(Rrt,{form:t,selectedModel:r,setSelectedModel:i,selectedProvider:a,handleProviderChange:l,StrandsModels:S});case 3:return n.jsx(zrt,{form:t,handleReasoningPatternToggle:d,reasoningPatterns:F,selectedModel:r});case 4:return n.jsx(Frt,{form:t,handleMemoryToggle:s,memoryTypes:L});case 5:return n.jsx($rt,{form:t,handleWorkflowStepAdd:x,handleWorkflowStepRemove:w,handleWorkflowStepUpdate:j});case 6:return n.jsx(Grt,{form:t,handleToolToggle:p,strandsTools:P});default:return n.jsx("div",{children:"Invalid step"})}},qrt=({step:e,totalSteps:t,prevStep:r,nextStep:i,onSubmit:a,isSubmitting:l,form:d})=>{const s=e===t,p=e===1;console.log(`Navigation render - step: ${e}, totalSteps: ${t}, isFirstStep: ${p}, isLastStep: ${s}`);const x=()=>{try{const w=d.getValues();if(console.log(`Step ${e} validation - form values:`,w),e===1){const j=w&&w.name&&w.name.trim().length>0;return console.log(`Step 1 can proceed: ${j}, name: "${(w==null?void 0:w.name)||"undefined"}"`),j}return console.log(`Step ${e} can proceed: true`),!0}catch(w){return console.error("Error in canProceed validation:",w),!1}};return n.jsxs("div",{className:"flex justify-between items-center pt-4 border-t border-gray-700",children:[n.jsxs(lt,{type:"button",variant:"outline",onClick:()=>{console.log("Previous button clicked!"),r()},disabled:p||l,className:"flex items-center gap-2 border-gray-600 text-gray-300 hover:bg-gray-700",children:[n.jsx(EF,{size:16}),"Previous"]}),n.jsx("div",{className:"flex items-center gap-2 text-sm text-gray-400",children:n.jsxs("span",{children:["Step ",e," of ",t]})}),s?n.jsx(lt,{type:"button",onClick:a,disabled:!x()||l,className:"bg-gradient-to-r from-purple-600 to-purple-700 hover:from-purple-700 hover:to-purple-800 text-white flex items-center gap-2",children:l?n.jsxs(n.Fragment,{children:[n.jsx(OQ,{size:16,className:"animate-spin"}),"Creating Workflow..."]}):n.jsxs(n.Fragment,{children:[n.jsx(ti,{size:16}),"Create Strands Workflow"]})}):n.jsxs(lt,{type:"button",onClick:()=>{console.log("Next button clicked!"),i()},disabled:!1,className:"bg-gradient-to-r from-beam-blue to-blue-600 hover:opacity-90 text-white flex items-center gap-2",children:["Next",n.jsx(ng,{size:16})]})]})},oT=["Basic Information","Model & Provider","Reasoning Patterns","Memory Configuration","Workflow Steps","Tools & Guardrails"],Wrt=({open:e,onOpenChange:t,isSubmitting:r,form:i,step:a,prevStep:l,nextStep:d,onSubmit:s,selectedModel:p,setSelectedModel:x,selectedProvider:w,handleProviderChange:j,handleReasoningPatternToggle:S,handleMemoryToggle:P,handleToolToggle:F,handleWorkflowStepAdd:L,handleWorkflowStepRemove:B,handleWorkflowStepUpdate:V,StrandsModels:$,strandsTools:G,reasoningPatterns:W,memoryTypes:Z})=>{const se=a/oT.length*100;return n.jsxs(Qo,{className:"max-w-4xl max-h-[90vh] bg-beam-dark border-gray-700 flex flex-col",children:[n.jsxs(el,{className:"pb-4 border-b border-gray-700 flex-shrink-0",children:[n.jsx(tl,{className:"text-xl font-semibold text-white flex items-center gap-2",children:"🧠 Create Strands Agentic Workflow"}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex justify-between text-sm text-gray-400",children:[n.jsxs("span",{children:["Step ",a," of ",oT.length,": ",oT[a-1]]}),n.jsxs("span",{children:[Math.round(se),"% Complete"]})]}),n.jsx(vn,{value:se,className:"h-2"})]})]}),n.jsx("div",{className:"flex-1 overflow-y-auto py-4 min-h-0",children:n.jsx(Hrt,{step:a,form:i,selectedModel:p,setSelectedModel:x,selectedProvider:w,handleProviderChange:j,handleReasoningPatternToggle:S,handleMemoryToggle:P,handleToolToggle:F,handleWorkflowStepAdd:L,handleWorkflowStepRemove:B,handleWorkflowStepUpdate:V,StrandsModels:$,strandsTools:G,reasoningPatterns:W,memoryTypes:Z})}),n.jsx("div",{className:"flex-shrink-0",children:n.jsx(qrt,{step:a,totalSteps:oT.length,prevStep:l,nextStep:d,onSubmit:s,isSubmitting:r,form:i})})]})};var vS=e=>e.type==="checkbox",R0=e=>e instanceof Date,yl=e=>e==null;const cue=e=>typeof e=="object";var Sa=e=>!yl(e)&&!Array.isArray(e)&&cue(e)&&!R0(e),uue=e=>Sa(e)&&e.target?vS(e.target)?e.target.checked:e.target.value:e,Krt=e=>e.substring(0,e.search(/\.\d+(\.|$)/))||e,due=(e,t)=>e.has(Krt(t)),Zrt=e=>{const t=e.constructor&&e.constructor.prototype;return Sa(t)&&t.hasOwnProperty("isPrototypeOf")},Q6=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function Hl(e){let t;const r=Array.isArray(e);if(e instanceof Date)t=new Date(e);else if(e instanceof Set)t=new Set(e);else if(!(Q6&&(e instanceof Blob||e instanceof FileList))&&(r||Sa(e)))if(t=r?[]:{},!r&&!Zrt(e))t=e;else for(const i in e)e.hasOwnProperty(i)&&(t[i]=Hl(e[i]));else return e;return t}var x3=e=>Array.isArray(e)?e.filter(Boolean):[],ma=e=>e===void 0,Dr=(e,t,r)=>{if(!t||!Sa(e))return r;const i=x3(t.split(/[,[\].]+?/)).reduce((a,l)=>yl(a)?a:a[l],e);return ma(i)||i===e?ma(e[t])?r:e[t]:i},du=e=>typeof e=="boolean",e$=e=>/^\w*$/.test(e),hue=e=>x3(e.replace(/["|']|\]/g,"").split(/\.|\[/)),ns=(e,t,r)=>{let i=-1;const a=e$(t)?[t]:hue(t),l=a.length,d=l-1;for(;++i<l;){const s=a[i];let p=r;if(i!==d){const x=e[s];p=Sa(x)||Array.isArray(x)?x:isNaN(+a[i+1])?{}:[]}if(s==="__proto__")return;e[s]=p,e=e[s]}return e};const BP={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},hd={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},tm={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},mue=ke.createContext(null),y3=()=>ke.useContext(mue),Yrt=e=>{const{children:t,...r}=e;return ke.createElement(mue.Provider,{value:r},t)};var fue=(e,t,r,i=!0)=>{const a={defaultValues:t._defaultValues};for(const l in e)Object.defineProperty(a,l,{get:()=>{const d=l;return t._proxyFormState[d]!==hd.all&&(t._proxyFormState[d]=!i||hd.all),r&&(r[d]=!0),e[d]}});return a},ql=e=>Sa(e)&&!Object.keys(e).length,pue=(e,t,r,i)=>{r(e);const{name:a,...l}=e;return ql(l)||Object.keys(l).length>=Object.keys(t).length||Object.keys(l).find(d=>t[d]===(!i||hd.all))},qj=e=>Array.isArray(e)?e:[e],gue=(e,t,r)=>!e||!t||e===t||qj(e).some(i=>i&&(r?i===t:i.startsWith(t)||t.startsWith(i)));function t$(e){const t=ke.useRef(e);t.current=e,ke.useEffect(()=>{const r=!e.disabled&&t.current.subject&&t.current.subject.subscribe({next:t.current.next});return()=>{r&&r.unsubscribe()}},[e.disabled])}function Xrt(e){const t=y3(),{control:r=t.control,disabled:i,name:a,exact:l}=e||{},[d,s]=ke.useState(r._formState),p=ke.useRef(!0),x=ke.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,validatingFields:!1,isValidating:!1,isValid:!1,errors:!1}),w=ke.useRef(a);return w.current=a,t$({disabled:i,next:j=>p.current&&gue(w.current,j.name,l)&&pue(j,x.current,r._updateFormState)&&s({...r._formState,...j}),subject:r._subjects.state}),ke.useEffect(()=>(p.current=!0,x.current.isValid&&r._updateValid(!0),()=>{p.current=!1}),[r]),fue(d,r,x.current,!1)}var lh=e=>typeof e=="string",xue=(e,t,r,i,a)=>lh(e)?(i&&t.watch.add(e),Dr(r,e,a)):Array.isArray(e)?e.map(l=>(i&&t.watch.add(l),Dr(r,l))):(i&&(t.watchAll=!0),r);function Jrt(e){const t=y3(),{control:r=t.control,name:i,defaultValue:a,disabled:l,exact:d}=e||{},s=ke.useRef(i);s.current=i,t$({disabled:l,subject:r._subjects.values,next:w=>{gue(s.current,w.name,d)&&x(Hl(xue(s.current,r._names,w.values||r._formValues,!1,a)))}});const[p,x]=ke.useState(r._getWatch(i,a));return ke.useEffect(()=>r._removeUnmounted()),p}function Qrt(e){const t=y3(),{name:r,disabled:i,control:a=t.control,shouldUnregister:l}=e,d=due(a._names.array,r),s=Jrt({control:a,name:r,defaultValue:Dr(a._formValues,r,Dr(a._defaultValues,r,e.defaultValue)),exact:!0}),p=Xrt({control:a,name:r,exact:!0}),x=ke.useRef(a.register(r,{...e.rules,value:s,...du(e.disabled)?{disabled:e.disabled}:{}}));return ke.useEffect(()=>{const w=a._options.shouldUnregister||l,j=(S,P)=>{const F=Dr(a._fields,S);F&&F._f&&(F._f.mount=P)};if(j(r,!0),w){const S=Hl(Dr(a._options.defaultValues,r));ns(a._defaultValues,r,S),ma(Dr(a._formValues,r))&&ns(a._formValues,r,S)}return()=>{(d?w&&!a._state.action:w)?a.unregister(r):j(r,!1)}},[r,a,d,l]),ke.useEffect(()=>{Dr(a._fields,r)&&a._updateDisabledField({disabled:i,fields:a._fields,name:r,value:Dr(a._fields,r)._f.value})},[i,r,a]),{field:{name:r,value:s,...du(i)||p.disabled?{disabled:p.disabled||i}:{},onChange:ke.useCallback(w=>x.current.onChange({target:{value:uue(w),name:r},type:BP.CHANGE}),[r]),onBlur:ke.useCallback(()=>x.current.onBlur({target:{value:Dr(a._formValues,r),name:r},type:BP.BLUR}),[r,a]),ref:ke.useCallback(w=>{const j=Dr(a._fields,r);j&&w&&(j._f.ref={focus:()=>w.focus(),select:()=>w.select(),setCustomValidity:S=>w.setCustomValidity(S),reportValidity:()=>w.reportValidity()})},[a._fields,r])},formState:p,fieldState:Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!Dr(p.errors,r)},isDirty:{enumerable:!0,get:()=>!!Dr(p.dirtyFields,r)},isTouched:{enumerable:!0,get:()=>!!Dr(p.touchedFields,r)},isValidating:{enumerable:!0,get:()=>!!Dr(p.validatingFields,r)},error:{enumerable:!0,get:()=>Dr(p.errors,r)}})}}const ent=e=>e.render(Qrt(e));var yue=(e,t,r,i,a)=>t?{...r[e],types:{...r[e]&&r[e].types?r[e].types:{},[i]:a||!0}}:{},MZ=e=>({isOnSubmit:!e||e===hd.onSubmit,isOnBlur:e===hd.onBlur,isOnChange:e===hd.onChange,isOnAll:e===hd.all,isOnTouch:e===hd.onTouched}),IZ=(e,t,r)=>!r&&(t.watchAll||t.watch.has(e)||[...t.watch].some(i=>e.startsWith(i)&&/^\.\w+/.test(e.slice(i.length))));const Wj=(e,t,r,i)=>{for(const a of r||Object.keys(e)){const l=Dr(e,a);if(l){const{_f:d,...s}=l;if(d){if(d.refs&&d.refs[0]&&t(d.refs[0],a)&&!i)return!0;if(d.ref&&t(d.ref,d.name)&&!i)return!0;if(Wj(s,t))break}else if(Sa(s)&&Wj(s,t))break}}};var tnt=(e,t,r)=>{const i=qj(Dr(e,r));return ns(i,"root",t[r]),ns(e,r,i),e},r$=e=>e.type==="file",vm=e=>typeof e=="function",$P=e=>{if(!Q6)return!1;const t=e?e.ownerDocument:0;return e instanceof(t&&t.defaultView?t.defaultView.HTMLElement:HTMLElement)},DT=e=>lh(e),n$=e=>e.type==="radio",VP=e=>e instanceof RegExp;const OZ={value:!1,isValid:!1},RZ={value:!0,isValid:!0};var vue=e=>{if(Array.isArray(e)){if(e.length>1){const t=e.filter(r=>r&&r.checked&&!r.disabled).map(r=>r.value);return{value:t,isValid:!!t.length}}return e[0].checked&&!e[0].disabled?e[0].attributes&&!ma(e[0].attributes.value)?ma(e[0].value)||e[0].value===""?RZ:{value:e[0].value,isValid:!0}:RZ:OZ}return OZ};const DZ={isValid:!1,value:null};var bue=e=>Array.isArray(e)?e.reduce((t,r)=>r&&r.checked&&!r.disabled?{isValid:!0,value:r.value}:t,DZ):DZ;function zZ(e,t,r="validate"){if(DT(e)||Array.isArray(e)&&e.every(DT)||du(e)&&!e)return{type:r,message:DT(e)?e:"",ref:t}}var Xy=e=>Sa(e)&&!VP(e)?e:{value:e,message:""},LZ=async(e,t,r,i,a)=>{const{ref:l,refs:d,required:s,maxLength:p,minLength:x,min:w,max:j,pattern:S,validate:P,name:F,valueAsNumber:L,mount:B,disabled:V}=e._f,$=Dr(t,F);if(!B||V)return{};const G=d?d[0]:l,W=Ne=>{i&&G.reportValidity&&(G.setCustomValidity(du(Ne)?"":Ne||""),G.reportValidity())},Z={},se=n$(l),ae=vS(l),ce=se||ae,Pe=(L||r$(l))&&ma(l.value)&&ma($)||$P(l)&&l.value===""||$===""||Array.isArray($)&&!$.length,we=yue.bind(null,F,r,Z),xe=(Ne,ze,ye,ve=tm.maxLength,_e=tm.minLength)=>{const Ee=Ne?ze:ye;Z[F]={type:Ne?ve:_e,message:Ee,ref:l,...we(Ne?ve:_e,Ee)}};if(a?!Array.isArray($)||!$.length:s&&(!ce&&(Pe||yl($))||du($)&&!$||ae&&!vue(d).isValid||se&&!bue(d).isValid)){const{value:Ne,message:ze}=DT(s)?{value:!!s,message:s}:Xy(s);if(Ne&&(Z[F]={type:tm.required,message:ze,ref:G,...we(tm.required,ze)},!r))return W(ze),Z}if(!Pe&&(!yl(w)||!yl(j))){let Ne,ze;const ye=Xy(j),ve=Xy(w);if(!yl($)&&!isNaN($)){const _e=l.valueAsNumber||$&&+$;yl(ye.value)||(Ne=_e>ye.value),yl(ve.value)||(ze=_e<ve.value)}else{const _e=l.valueAsDate||new Date($),Ee=tt=>new Date(new Date().toDateString()+" "+tt),je=l.type=="time",Ce=l.type=="week";lh(ye.value)&&$&&(Ne=je?Ee($)>Ee(ye.value):Ce?$>ye.value:_e>new Date(ye.value)),lh(ve.value)&&$&&(ze=je?Ee($)<Ee(ve.value):Ce?$<ve.value:_e<new Date(ve.value))}if((Ne||ze)&&(xe(!!Ne,ye.message,ve.message,tm.max,tm.min),!r))return W(Z[F].message),Z}if((p||x)&&!Pe&&(lh($)||a&&Array.isArray($))){const Ne=Xy(p),ze=Xy(x),ye=!yl(Ne.value)&&$.length>+Ne.value,ve=!yl(ze.value)&&$.length<+ze.value;if((ye||ve)&&(xe(ye,Ne.message,ze.message),!r))return W(Z[F].message),Z}if(S&&!Pe&&lh($)){const{value:Ne,message:ze}=Xy(S);if(VP(Ne)&&!$.match(Ne)&&(Z[F]={type:tm.pattern,message:ze,ref:l,...we(tm.pattern,ze)},!r))return W(ze),Z}if(P){if(vm(P)){const Ne=await P($,t),ze=zZ(Ne,G);if(ze&&(Z[F]={...ze,...we(tm.validate,ze.message)},!r))return W(ze.message),Z}else if(Sa(P)){let Ne={};for(const ze in P){if(!ql(Ne)&&!r)break;const ye=zZ(await P[ze]($,t),G,ze);ye&&(Ne={...ye,...we(ze,ye.message)},W(ye.message),r&&(Z[F]=Ne))}if(!ql(Ne)&&(Z[F]={ref:G,...Ne},!r))return Z}}return W(!0),Z};function rnt(e,t){const r=t.slice(0,-1).length;let i=0;for(;i<r;)e=ma(e)?i++:e[t[i++]];return e}function nnt(e){for(const t in e)if(e.hasOwnProperty(t)&&!ma(e[t]))return!1;return!0}function Ya(e,t){const r=Array.isArray(t)?t:e$(t)?[t]:hue(t),i=r.length===1?e:rnt(e,r),a=r.length-1,l=r[a];return i&&delete i[l],a!==0&&(Sa(i)&&ql(i)||Array.isArray(i)&&nnt(i))&&Ya(e,r.slice(0,-1)),e}var aR=()=>{let e=[];return{get observers(){return e},next:a=>{for(const l of e)l.next&&l.next(a)},subscribe:a=>(e.push(a),{unsubscribe:()=>{e=e.filter(l=>l!==a)}}),unsubscribe:()=>{e=[]}}},oL=e=>yl(e)||!cue(e);function up(e,t){if(oL(e)||oL(t))return e===t;if(R0(e)&&R0(t))return e.getTime()===t.getTime();const r=Object.keys(e),i=Object.keys(t);if(r.length!==i.length)return!1;for(const a of r){const l=e[a];if(!i.includes(a))return!1;if(a!=="ref"){const d=t[a];if(R0(l)&&R0(d)||Sa(l)&&Sa(d)||Array.isArray(l)&&Array.isArray(d)?!up(l,d):l!==d)return!1}}return!0}var _ue=e=>e.type==="select-multiple",int=e=>n$(e)||vS(e),oR=e=>$P(e)&&e.isConnected,wue=e=>{for(const t in e)if(vm(e[t]))return!0;return!1};function UP(e,t={}){const r=Array.isArray(e);if(Sa(e)||r)for(const i in e)Array.isArray(e[i])||Sa(e[i])&&!wue(e[i])?(t[i]=Array.isArray(e[i])?[]:{},UP(e[i],t[i])):yl(e[i])||(t[i]=!0);return t}function jue(e,t,r){const i=Array.isArray(e);if(Sa(e)||i)for(const a in e)Array.isArray(e[a])||Sa(e[a])&&!wue(e[a])?ma(t)||oL(r[a])?r[a]=Array.isArray(e[a])?UP(e[a],[]):{...UP(e[a])}:jue(e[a],yl(t)?{}:t[a],r[a]):r[a]=!up(e[a],t[a]);return r}var oj=(e,t)=>jue(e,t,UP(t)),Nue=(e,{valueAsNumber:t,valueAsDate:r,setValueAs:i})=>ma(e)?e:t?e===""?NaN:e&&+e:r&&lh(e)?new Date(e):i?i(e):e;function lR(e){const t=e.ref;if(!(e.refs?e.refs.every(r=>r.disabled):t.disabled))return r$(t)?t.files:n$(t)?bue(e.refs).value:_ue(t)?[...t.selectedOptions].map(({value:r})=>r):vS(t)?vue(e.refs).value:Nue(ma(t.value)?e.ref.value:t.value,e)}var snt=(e,t,r,i)=>{const a={};for(const l of e){const d=Dr(t,l);d&&ns(a,l,d._f)}return{criteriaMode:r,names:[...e],fields:a,shouldUseNativeValidation:i}},lj=e=>ma(e)?e:VP(e)?e.source:Sa(e)?VP(e.value)?e.value.source:e.value:e;const FZ="AsyncFunction";var ant=e=>(!e||!e.validate)&&!!(vm(e.validate)&&e.validate.constructor.name===FZ||Sa(e.validate)&&Object.values(e.validate).find(t=>t.constructor.name===FZ)),ont=e=>e.mount&&(e.required||e.min||e.max||e.maxLength||e.minLength||e.pattern||e.validate);function BZ(e,t,r){const i=Dr(e,r);if(i||e$(r))return{error:i,name:r};const a=r.split(".");for(;a.length;){const l=a.join("."),d=Dr(t,l),s=Dr(e,l);if(d&&!Array.isArray(d)&&r!==l)return{name:r};if(s&&s.type)return{name:l,error:s};a.pop()}return{name:r}}var lnt=(e,t,r,i,a)=>a.isOnAll?!1:!r&&a.isOnTouch?!(t||e):(r?i.isOnBlur:a.isOnBlur)?!e:(r?i.isOnChange:a.isOnChange)?e:!0,cnt=(e,t)=>!x3(Dr(e,t)).length&&Ya(e,t);const unt={mode:hd.onSubmit,reValidateMode:hd.onChange,shouldFocusError:!0};function dnt(e={}){let t={...unt,...e},r={submitCount:0,isDirty:!1,isLoading:vm(t.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1},i={},a=Sa(t.defaultValues)||Sa(t.values)?Hl(t.defaultValues||t.values)||{}:{},l=t.shouldUnregister?{}:Hl(a),d={action:!1,mount:!1,watch:!1},s={mount:new Set,unMount:new Set,array:new Set,watch:new Set},p,x=0;const w={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1},j={values:aR(),array:aR(),state:aR()},S=MZ(t.mode),P=MZ(t.reValidateMode),F=t.criteriaMode===hd.all,L=Ye=>Nt=>{clearTimeout(x),x=setTimeout(Ye,Nt)},B=async Ye=>{if(!e.disabled&&(w.isValid||Ye)){const Nt=t.resolver?ql((await ce()).errors):await we(i,!0);Nt!==r.isValid&&j.state.next({isValid:Nt})}},V=(Ye,Nt)=>{!e.disabled&&(w.isValidating||w.validatingFields)&&((Ye||Array.from(s.mount)).forEach(zt=>{zt&&(Nt?ns(r.validatingFields,zt,Nt):Ya(r.validatingFields,zt))}),j.state.next({validatingFields:r.validatingFields,isValidating:!ql(r.validatingFields)}))},$=(Ye,Nt=[],zt,Nr,br=!0,hr=!0)=>{if(Nr&&zt&&!e.disabled){if(d.action=!0,hr&&Array.isArray(Dr(i,Ye))){const rr=zt(Dr(i,Ye),Nr.argA,Nr.argB);br&&ns(i,Ye,rr)}if(hr&&Array.isArray(Dr(r.errors,Ye))){const rr=zt(Dr(r.errors,Ye),Nr.argA,Nr.argB);br&&ns(r.errors,Ye,rr),cnt(r.errors,Ye)}if(w.touchedFields&&hr&&Array.isArray(Dr(r.touchedFields,Ye))){const rr=zt(Dr(r.touchedFields,Ye),Nr.argA,Nr.argB);br&&ns(r.touchedFields,Ye,rr)}w.dirtyFields&&(r.dirtyFields=oj(a,l)),j.state.next({name:Ye,isDirty:Ne(Ye,Nt),dirtyFields:r.dirtyFields,errors:r.errors,isValid:r.isValid})}else ns(l,Ye,Nt)},G=(Ye,Nt)=>{ns(r.errors,Ye,Nt),j.state.next({errors:r.errors})},W=Ye=>{r.errors=Ye,j.state.next({errors:r.errors,isValid:!1})},Z=(Ye,Nt,zt,Nr)=>{const br=Dr(i,Ye);if(br){const hr=Dr(l,Ye,ma(zt)?Dr(a,Ye):zt);ma(hr)||Nr&&Nr.defaultChecked||Nt?ns(l,Ye,Nt?hr:lR(br._f)):ve(Ye,hr),d.mount&&B()}},se=(Ye,Nt,zt,Nr,br)=>{let hr=!1,rr=!1;const an={name:Ye};if(!e.disabled){const ai=!!(Dr(i,Ye)&&Dr(i,Ye)._f&&Dr(i,Ye)._f.disabled);if(!zt||Nr){w.isDirty&&(rr=r.isDirty,r.isDirty=an.isDirty=Ne(),hr=rr!==an.isDirty);const ri=ai||up(Dr(a,Ye),Nt);rr=!!(!ai&&Dr(r.dirtyFields,Ye)),ri||ai?Ya(r.dirtyFields,Ye):ns(r.dirtyFields,Ye,!0),an.dirtyFields=r.dirtyFields,hr=hr||w.dirtyFields&&rr!==!ri}if(zt){const ri=Dr(r.touchedFields,Ye);ri||(ns(r.touchedFields,Ye,zt),an.touchedFields=r.touchedFields,hr=hr||w.touchedFields&&ri!==zt)}hr&&br&&j.state.next(an)}return hr?an:{}},ae=(Ye,Nt,zt,Nr)=>{const br=Dr(r.errors,Ye),hr=w.isValid&&du(Nt)&&r.isValid!==Nt;if(e.delayError&&zt?(p=L(()=>G(Ye,zt)),p(e.delayError)):(clearTimeout(x),p=null,zt?ns(r.errors,Ye,zt):Ya(r.errors,Ye)),(zt?!up(br,zt):br)||!ql(Nr)||hr){const rr={...Nr,...hr&&du(Nt)?{isValid:Nt}:{},errors:r.errors,name:Ye};r={...r,...rr},j.state.next(rr)}},ce=async Ye=>{V(Ye,!0);const Nt=await t.resolver(l,t.context,snt(Ye||s.mount,i,t.criteriaMode,t.shouldUseNativeValidation));return V(Ye),Nt},Pe=async Ye=>{const{errors:Nt}=await ce(Ye);if(Ye)for(const zt of Ye){const Nr=Dr(Nt,zt);Nr?ns(r.errors,zt,Nr):Ya(r.errors,zt)}else r.errors=Nt;return Nt},we=async(Ye,Nt,zt={valid:!0})=>{for(const Nr in Ye){const br=Ye[Nr];if(br){const{_f:hr,...rr}=br;if(hr){const an=s.array.has(hr.name),ai=br._f&&ant(br._f);ai&&w.validatingFields&&V([Nr],!0);const ri=await LZ(br,l,F,t.shouldUseNativeValidation&&!Nt,an);if(ai&&w.validatingFields&&V([Nr]),ri[hr.name]&&(zt.valid=!1,Nt))break;!Nt&&(Dr(ri,hr.name)?an?tnt(r.errors,ri,hr.name):ns(r.errors,hr.name,ri[hr.name]):Ya(r.errors,hr.name))}!ql(rr)&&await we(rr,Nt,zt)}}return zt.valid},xe=()=>{for(const Ye of s.unMount){const Nt=Dr(i,Ye);Nt&&(Nt._f.refs?Nt._f.refs.every(zt=>!oR(zt)):!oR(Nt._f.ref))&&tr(Ye)}s.unMount=new Set},Ne=(Ye,Nt)=>!e.disabled&&(Ye&&Nt&&ns(l,Ye,Nt),!up(it(),a)),ze=(Ye,Nt,zt)=>xue(Ye,s,{...d.mount?l:ma(Nt)?a:lh(Ye)?{[Ye]:Nt}:Nt},zt,Nt),ye=Ye=>x3(Dr(d.mount?l:a,Ye,e.shouldUnregister?Dr(a,Ye,[]):[])),ve=(Ye,Nt,zt={})=>{const Nr=Dr(i,Ye);let br=Nt;if(Nr){const hr=Nr._f;hr&&(!hr.disabled&&ns(l,Ye,Nue(Nt,hr)),br=$P(hr.ref)&&yl(Nt)?"":Nt,_ue(hr.ref)?[...hr.ref.options].forEach(rr=>rr.selected=br.includes(rr.value)):hr.refs?vS(hr.ref)?hr.refs.length>1?hr.refs.forEach(rr=>(!rr.defaultChecked||!rr.disabled)&&(rr.checked=Array.isArray(br)?!!br.find(an=>an===rr.value):br===rr.value)):hr.refs[0]&&(hr.refs[0].checked=!!br):hr.refs.forEach(rr=>rr.checked=rr.value===br):r$(hr.ref)?hr.ref.value="":(hr.ref.value=br,hr.ref.type||j.values.next({name:Ye,values:{...l}})))}(zt.shouldDirty||zt.shouldTouch)&&se(Ye,br,zt.shouldTouch,zt.shouldDirty,!0),zt.shouldValidate&&tt(Ye)},_e=(Ye,Nt,zt)=>{for(const Nr in Nt){const br=Nt[Nr],hr=`${Ye}.${Nr}`,rr=Dr(i,hr);(s.array.has(Ye)||Sa(br)||rr&&!rr._f)&&!R0(br)?_e(hr,br,zt):ve(hr,br,zt)}},Ee=(Ye,Nt,zt={})=>{const Nr=Dr(i,Ye),br=s.array.has(Ye),hr=Hl(Nt);ns(l,Ye,hr),br?(j.array.next({name:Ye,values:{...l}}),(w.isDirty||w.dirtyFields)&&zt.shouldDirty&&j.state.next({name:Ye,dirtyFields:oj(a,l),isDirty:Ne(Ye,hr)})):Nr&&!Nr._f&&!yl(hr)?_e(Ye,hr,zt):ve(Ye,hr,zt),IZ(Ye,s)&&j.state.next({...r}),j.values.next({name:d.mount?Ye:void 0,values:{...l}})},je=async Ye=>{d.mount=!0;const Nt=Ye.target;let zt=Nt.name,Nr=!0;const br=Dr(i,zt),hr=()=>Nt.type?lR(br._f):uue(Ye),rr=an=>{Nr=Number.isNaN(an)||R0(an)&&isNaN(an.getTime())||up(an,Dr(l,zt,an))};if(br){let an,ai;const ri=hr(),Ui=Ye.type===BP.BLUR||Ye.type===BP.FOCUS_OUT,oa=!ont(br._f)&&!t.resolver&&!Dr(r.errors,zt)&&!br._f.deps||lnt(Ui,Dr(r.touchedFields,zt),r.isSubmitted,P,S),Xs=IZ(zt,s,Ui);ns(l,zt,ri),Ui?(br._f.onBlur&&br._f.onBlur(Ye),p&&p(0)):br._f.onChange&&br._f.onChange(Ye);const rl=se(zt,ri,Ui,!1),Il=!ql(rl)||Xs;if(!Ui&&j.values.next({name:zt,type:Ye.type,values:{...l}}),oa)return w.isValid&&(e.mode==="onBlur"?Ui&&B():B()),Il&&j.state.next({name:zt,...Xs?{}:rl});if(!Ui&&Xs&&j.state.next({...r}),t.resolver){const{errors:xo}=await ce([zt]);if(rr(ri),Nr){const nl=BZ(r.errors,i,zt),Vs=BZ(xo,i,nl.name||zt);an=Vs.error,zt=Vs.name,ai=ql(xo)}}else V([zt],!0),an=(await LZ(br,l,F,t.shouldUseNativeValidation))[zt],V([zt]),rr(ri),Nr&&(an?ai=!1:w.isValid&&(ai=await we(i,!0)));Nr&&(br._f.deps&&tt(br._f.deps),ae(zt,ai,an,rl))}},Ce=(Ye,Nt)=>{if(Dr(r.errors,Nt)&&Ye.focus)return Ye.focus(),1},tt=async(Ye,Nt={})=>{let zt,Nr;const br=qj(Ye);if(t.resolver){const hr=await Pe(ma(Ye)?Ye:br);zt=ql(hr),Nr=Ye?!br.some(rr=>Dr(hr,rr)):zt}else Ye?(Nr=(await Promise.all(br.map(async hr=>{const rr=Dr(i,hr);return await we(rr&&rr._f?{[hr]:rr}:rr)}))).every(Boolean),!(!Nr&&!r.isValid)&&B()):Nr=zt=await we(i);return j.state.next({...!lh(Ye)||w.isValid&&zt!==r.isValid?{}:{name:Ye},...t.resolver||!Ye?{isValid:zt}:{},errors:r.errors}),Nt.shouldFocus&&!Nr&&Wj(i,Ce,Ye?br:s.mount),Nr},it=Ye=>{const Nt={...d.mount?l:a};return ma(Ye)?Nt:lh(Ye)?Dr(Nt,Ye):Ye.map(zt=>Dr(Nt,zt))},mt=(Ye,Nt)=>({invalid:!!Dr((Nt||r).errors,Ye),isDirty:!!Dr((Nt||r).dirtyFields,Ye),error:Dr((Nt||r).errors,Ye),isValidating:!!Dr(r.validatingFields,Ye),isTouched:!!Dr((Nt||r).touchedFields,Ye)}),gt=Ye=>{Ye&&qj(Ye).forEach(Nt=>Ya(r.errors,Nt)),j.state.next({errors:Ye?r.errors:{}})},qt=(Ye,Nt,zt)=>{const Nr=(Dr(i,Ye,{_f:{}})._f||{}).ref,br=Dr(r.errors,Ye)||{},{ref:hr,message:rr,type:an,...ai}=br;ns(r.errors,Ye,{...ai,...Nt,ref:Nr}),j.state.next({name:Ye,errors:r.errors,isValid:!1}),zt&&zt.shouldFocus&&Nr&&Nr.focus&&Nr.focus()},yr=(Ye,Nt)=>vm(Ye)?j.values.subscribe({next:zt=>Ye(ze(void 0,Nt),zt)}):ze(Ye,Nt,!0),tr=(Ye,Nt={})=>{for(const zt of Ye?qj(Ye):s.mount)s.mount.delete(zt),s.array.delete(zt),Nt.keepValue||(Ya(i,zt),Ya(l,zt)),!Nt.keepError&&Ya(r.errors,zt),!Nt.keepDirty&&Ya(r.dirtyFields,zt),!Nt.keepTouched&&Ya(r.touchedFields,zt),!Nt.keepIsValidating&&Ya(r.validatingFields,zt),!t.shouldUnregister&&!Nt.keepDefaultValue&&Ya(a,zt);j.values.next({values:{...l}}),j.state.next({...r,...Nt.keepDirty?{isDirty:Ne()}:{}}),!Nt.keepIsValid&&B()},Ft=({disabled:Ye,name:Nt,field:zt,fields:Nr,value:br})=>{if(du(Ye)&&d.mount||Ye){const hr=Ye?void 0:ma(br)?lR(zt?zt._f:Dr(Nr,Nt)._f):br;ns(l,Nt,hr),se(Nt,hr,!1,!1,!0)}},er=(Ye,Nt={})=>{let zt=Dr(i,Ye);const Nr=du(Nt.disabled)||du(e.disabled);return ns(i,Ye,{...zt||{},_f:{...zt&&zt._f?zt._f:{ref:{name:Ye}},name:Ye,mount:!0,...Nt}}),s.mount.add(Ye),zt?Ft({field:zt,disabled:du(Nt.disabled)?Nt.disabled:e.disabled,name:Ye,value:Nt.value}):Z(Ye,!0,Nt.value),{...Nr?{disabled:Nt.disabled||e.disabled}:{},...t.progressive?{required:!!Nt.required,min:lj(Nt.min),max:lj(Nt.max),minLength:lj(Nt.minLength),maxLength:lj(Nt.maxLength),pattern:lj(Nt.pattern)}:{},name:Ye,onChange:je,onBlur:je,ref:br=>{if(br){er(Ye,Nt),zt=Dr(i,Ye);const hr=ma(br.value)&&br.querySelectorAll&&br.querySelectorAll("input,select,textarea")[0]||br,rr=int(hr),an=zt._f.refs||[];if(rr?an.find(ai=>ai===hr):hr===zt._f.ref)return;ns(i,Ye,{_f:{...zt._f,...rr?{refs:[...an.filter(oR),hr,...Array.isArray(Dr(a,Ye))?[{}]:[]],ref:{type:hr.type,name:Ye}}:{ref:hr}}}),Z(Ye,!1,void 0,hr)}else zt=Dr(i,Ye,{}),zt._f&&(zt._f.mount=!1),(t.shouldUnregister||Nt.shouldUnregister)&&!(due(s.array,Ye)&&d.action)&&s.unMount.add(Ye)}}},Dt=()=>t.shouldFocusError&&Wj(i,Ce,s.mount),ge=Ye=>{du(Ye)&&(j.state.next({disabled:Ye}),Wj(i,(Nt,zt)=>{const Nr=Dr(i,zt);Nr&&(Nt.disabled=Nr._f.disabled||Ye,Array.isArray(Nr._f.refs)&&Nr._f.refs.forEach(br=>{br.disabled=Nr._f.disabled||Ye}))},0,!1))},sr=(Ye,Nt)=>async zt=>{let Nr;zt&&(zt.preventDefault&&zt.preventDefault(),zt.persist&&zt.persist());let br=Hl(l);if(j.state.next({isSubmitting:!0}),t.resolver){const{errors:hr,values:rr}=await ce();r.errors=hr,br=rr}else await we(i);if(Ya(r.errors,"root"),ql(r.errors)){j.state.next({errors:{}});try{await Ye(br,zt)}catch(hr){Nr=hr}}else Nt&&await Nt({...r.errors},zt),Dt(),setTimeout(Dt);if(j.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:ql(r.errors)&&!Nr,submitCount:r.submitCount+1,errors:r.errors}),Nr)throw Nr},St=(Ye,Nt={})=>{Dr(i,Ye)&&(ma(Nt.defaultValue)?Ee(Ye,Hl(Dr(a,Ye))):(Ee(Ye,Nt.defaultValue),ns(a,Ye,Hl(Nt.defaultValue))),Nt.keepTouched||Ya(r.touchedFields,Ye),Nt.keepDirty||(Ya(r.dirtyFields,Ye),r.isDirty=Nt.defaultValue?Ne(Ye,Hl(Dr(a,Ye))):Ne()),Nt.keepError||(Ya(r.errors,Ye),w.isValid&&B()),j.state.next({...r}))},jr=(Ye,Nt={})=>{const zt=Ye?Hl(Ye):a,Nr=Hl(zt),br=ql(Ye),hr=br?a:Nr;if(Nt.keepDefaultValues||(a=zt),!Nt.keepValues){if(Nt.keepDirtyValues){const rr=new Set([...s.mount,...Object.keys(oj(a,l))]);for(const an of Array.from(rr))Dr(r.dirtyFields,an)?ns(hr,an,Dr(l,an)):Ee(an,Dr(hr,an))}else{if(Q6&&ma(Ye))for(const rr of s.mount){const an=Dr(i,rr);if(an&&an._f){const ai=Array.isArray(an._f.refs)?an._f.refs[0]:an._f.ref;if($P(ai)){const ri=ai.closest("form");if(ri){ri.reset();break}}}}i={}}l=e.shouldUnregister?Nt.keepDefaultValues?Hl(a):{}:Hl(hr),j.array.next({values:{...hr}}),j.values.next({values:{...hr}})}s={mount:Nt.keepDirtyValues?s.mount:new Set,unMount:new Set,array:new Set,watch:new Set,watchAll:!1,focus:""},d.mount=!w.isValid||!!Nt.keepIsValid||!!Nt.keepDirtyValues,d.watch=!!e.shouldUnregister,j.state.next({submitCount:Nt.keepSubmitCount?r.submitCount:0,isDirty:br?!1:Nt.keepDirty?r.isDirty:!!(Nt.keepDefaultValues&&!up(Ye,a)),isSubmitted:Nt.keepIsSubmitted?r.isSubmitted:!1,dirtyFields:br?{}:Nt.keepDirtyValues?Nt.keepDefaultValues&&l?oj(a,l):r.dirtyFields:Nt.keepDefaultValues&&Ye?oj(a,Ye):Nt.keepDirty?r.dirtyFields:{},touchedFields:Nt.keepTouched?r.touchedFields:{},errors:Nt.keepErrors?r.errors:{},isSubmitSuccessful:Nt.keepIsSubmitSuccessful?r.isSubmitSuccessful:!1,isSubmitting:!1})},dt=(Ye,Nt)=>jr(vm(Ye)?Ye(l):Ye,Nt);return{control:{register:er,unregister:tr,getFieldState:mt,handleSubmit:sr,setError:qt,_executeSchema:ce,_getWatch:ze,_getDirty:Ne,_updateValid:B,_removeUnmounted:xe,_updateFieldArray:$,_updateDisabledField:Ft,_getFieldArray:ye,_reset:jr,_resetDefaultValues:()=>vm(t.defaultValues)&&t.defaultValues().then(Ye=>{dt(Ye,t.resetOptions),j.state.next({isLoading:!1})}),_updateFormState:Ye=>{r={...r,...Ye}},_disableForm:ge,_subjects:j,_proxyFormState:w,_setErrors:W,get _fields(){return i},get _formValues(){return l},get _state(){return d},set _state(Ye){d=Ye},get _defaultValues(){return a},get _names(){return s},set _names(Ye){s=Ye},get _formState(){return r},set _formState(Ye){r=Ye},get _options(){return t},set _options(Ye){t={...t,...Ye}}},trigger:tt,register:er,handleSubmit:sr,watch:yr,setValue:Ee,getValues:it,reset:dt,resetField:St,clearErrors:gt,unregister:tr,setError:qt,setFocus:(Ye,Nt={})=>{const zt=Dr(i,Ye),Nr=zt&&zt._f;if(Nr){const br=Nr.refs?Nr.refs[0]:Nr.ref;br.focus&&(br.focus(),Nt.shouldSelect&&br.select())}},getFieldState:mt}}function hx(e={}){const t=ke.useRef(),r=ke.useRef(),[i,a]=ke.useState({isDirty:!1,isValidating:!1,isLoading:vm(e.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1,defaultValues:vm(e.defaultValues)?void 0:e.defaultValues});t.current||(t.current={...dnt(e),formState:i});const l=t.current.control;return l._options=e,t$({subject:l._subjects.state,next:d=>{pue(d,l._proxyFormState,l._updateFormState,!0)&&a({...l._formState})}}),ke.useEffect(()=>l._disableForm(e.disabled),[l,e.disabled]),ke.useEffect(()=>{if(l._proxyFormState.isDirty){const d=l._getDirty();d!==i.isDirty&&l._subjects.state.next({isDirty:d})}},[l,i.isDirty]),ke.useEffect(()=>{e.values&&!up(e.values,r.current)?(l._reset(e.values,l._options.resetOptions),r.current=e.values,a(d=>({...d}))):l._resetDefaultValues()},[e.values,l]),ke.useEffect(()=>{e.errors&&l._setErrors(e.errors)},[e.errors,l]),ke.useEffect(()=>{l._state.mount||(l._updateValid(),l._state.mount=!0),l._state.watch&&(l._state.watch=!1,l._subjects.state.next({...l._formState})),l._removeUnmounted()}),ke.useEffect(()=>{e.shouldUnregister&&l._subjects.values.next({values:l._getWatch()})},[e.shouldUnregister,l]),ke.useEffect(()=>{t.current&&(t.current.watch=t.current.watch.bind({}))},[i]),t.current.formState=fue(i,l),t.current}class hnt{constructor(t="/api",r){u0(this,"baseUrl");u0(this,"apiKey");this.baseUrl=t,this.apiKey=r||""}async createAgent(t){console.log("StrandsSDK: Creating agent with config:",t);const r={name:t.name,framework:"strands",config:{model:t.model,reasoning_patterns:t.reasoning_patterns,memory:t.memory,tools:t.tools,guardrails:t.guardrails,workflow_steps:t.workflow_steps||[],performance_config:t.performance_config||{max_reasoning_depth:5,reflection_cycles:2,temperature:.7,max_tokens:4e3},reasoning_engine:{patterns:t.reasoning_patterns,memory_systems:t.memory,inference_strategy:this.buildInferenceStrategy(t.reasoning_patterns)},metadata:{framework_version:"1.0.0",reasoning_capabilities:this.getReasoningCapabilities(t.reasoning_patterns),memory_systems:this.getMemorySystems(t.memory),created_with:"strands-workflow-ui"}}};console.log("StrandsSDK: Sending to backend:",r);const i=await fetch(`${this.baseUrl}/agents`,{method:"POST",headers:{"Content-Type":"application/json",...this.apiKey&&{Authorization:`Bearer ${this.apiKey}`}},body:JSON.stringify(r)});if(!i.ok){const l=await i.text();let d="Failed to create Strands workflow";try{const s=JSON.parse(l);d=s.detail||s.error||d}catch{d=l||d}throw console.error("StrandsSDK: Backend error:",d),new Error(d)}const a=await i.json();return console.log("StrandsSDK: Backend response:",a),{id:a.agent_id,name:t.name,status:a.status==="active"?"ready":"error",config:t,metadata:{created_at:new Date().toISOString(),framework:"strands",version:"1.0.0",reasoning_capabilities:this.getReasoningCapabilities(t.reasoning_patterns),memory_systems:this.getMemorySystems(t.memory),performance_metrics:{avg_reasoning_time:0,reasoning_accuracy:0,memory_efficiency:0}}}}buildInferenceStrategy(t){const r=[];return t.chain_of_thought&&r.push("chain_of_thought"),t.tree_of_thought&&r.push("tree_of_thought"),t.reflection&&r.push("reflection"),t.self_critique&&r.push("self_critique"),r.length>0?r.join("->"):"basic_reasoning"}getReasoningCapabilities(t){const r=[];return t.chain_of_thought&&r.push("Chain-of-Thought Reasoning"),t.tree_of_thought&&r.push("Tree-of-Thought Planning"),t.reflection&&r.push("Reflective Analysis"),t.self_critique&&r.push("Self-Critique & Validation"),r}getMemorySystems(t){const r=[];return t.working_memory&&r.push("Working Memory"),t.episodic_memory&&r.push("Episodic Memory"),t.semantic_memory&&r.push("Semantic Memory"),t.memory_consolidation&&r.push("Memory Consolidation"),r}hasBedrockCredentials(){return!0}async executeReasoning(t,r,i){const a=await fetch(`${this.baseUrl}/agents/${t}/reason`,{method:"POST",headers:{"Content-Type":"application/json",...this.apiKey&&{Authorization:`Bearer ${this.apiKey}`}},body:JSON.stringify({prompt:r,options:i||{}})});if(!a.ok)throw new Error("Failed to execute reasoning");return await a.json()}async getAgentMetrics(t){const r=await fetch(`${this.baseUrl}/agents/${t}/metrics`);if(!r.ok)throw new Error("Failed to get agent metrics");return await r.json()}}const mnt=e=>{const{toast:t}=Ah(),[r,i]=U.useState(null),[a,l]=U.useState("bedrock"),[d,s]=U.useState(1),[p,x]=U.useState(!1),w=U.useRef(null),j=U.useRef(!1),S={name:"",description:"",model:"",provider:"bedrock",reasoning_patterns:{chain_of_thought:!0,tree_of_thought:!1,reflection:!1,self_critique:!1,multi_step_reasoning:!1,analogical_reasoning:!1},memory:{working_memory:!0,episodic_memory:!1,semantic_memory:!1,memory_consolidation:!1,context_window_management:!0},tools:[],workflow_steps:[],guardrails:{content_filter:!0,reasoning_validator:!0,output_sanitizer:!0,ethical_constraints:!0},performance_config:{max_reasoning_depth:5,reflection_cycles:2,temperature:.7,max_tokens:4e3}},P=hx({defaultValues:S,mode:"onChange"}),F=U.useCallback(()=>{w.current&&(clearTimeout(w.current),w.current=null)},[]),L=U.useCallback(()=>{F(),s(1),i(null),l("bedrock"),x(!1),P.reset(S),j.current=!1},[P,F]),B=U.useCallback(()=>{s(xe=>Math.min(xe+1,6))},[]),V=U.useCallback(()=>{s(xe=>Math.max(xe-1,1))},[]),$=U.useCallback(xe=>{l(xe),i(null),P.setValue("provider",xe),P.setValue("model","")},[P]),G=U.useCallback(xe=>{const Ne=P.getValues("reasoning_patterns"),ze={...Ne,[xe]:!Ne[xe]};P.setValue("reasoning_patterns",ze)},[P]),W=U.useCallback(xe=>{const Ne=P.getValues("memory"),ze={...Ne,[xe]:!Ne[xe]};P.setValue("memory",ze)},[P]),Z=U.useCallback(xe=>{const Ne=P.getValues("tools"),ze=Ne.includes(xe)?Ne.filter(ye=>ye!==xe):[...Ne,xe];P.setValue("tools",ze)},[P]),se=U.useCallback(()=>{const xe=P.getValues("workflow_steps"),Ne={id:`step_${Date.now()}`,name:`Step ${xe.length+1}`,type:"reasoning",description:"",config:{},dependencies:[],parallel_execution:!1};P.setValue("workflow_steps",[...xe,Ne])},[P]),ae=U.useCallback(xe=>{const ze=P.getValues("workflow_steps").filter(ye=>ye.id!==xe);P.setValue("workflow_steps",ze)},[P]),ce=U.useCallback((xe,Ne)=>{const ye=P.getValues("workflow_steps").map(ve=>ve.id===xe?{...ve,...Ne}:ve);P.setValue("workflow_steps",ye)},[P]),Pe=U.useCallback(()=>{F(),x(!1),j.current=!0},[F]),we=U.useCallback(async xe=>{if(!(p||j.current)){console.log("Strands form submission started with data:",xe),x(!0);try{if(!xe.name.trim())throw new Error("Workflow name is required");xe.model||(console.log("No model selected, using default bedrock-claude-3-sonnet"),xe.model="bedrock-claude-3-sonnet");const Ne=new hnt,ze={name:xe.name,description:xe.description,model:{provider:"bedrock",model_id:xe.model||"bedrock-claude-3-sonnet",temperature:xe.performance_config.temperature,max_tokens:xe.performance_config.max_tokens},reasoning_patterns:xe.reasoning_patterns,memory:xe.memory,tools:xe.tools,guardrails:xe.guardrails,workflow_steps:xe.workflow_steps,performance_config:xe.performance_config};console.log("Creating Strands workflow with config:",ze);const ye=await Ne.createAgent(ze);if(j.current)return;t({title:"Strands Workflow Created Successfully! 🧠",description:`${xe.name} is now ready with advanced reasoning capabilities`,duration:5e3}),w.current=setTimeout(()=>{j.current||(e(!1),L())},1500)}catch(Ne){if(j.current)return;console.error("Strands workflow creation error:",Ne);const ze=Ne instanceof Error?Ne.message:"Unknown error occurred";t({title:"Failed to Create Strands Workflow",description:ze,variant:"destructive",duration:5e3}),x(!1)}}},[p,t,e,L]);return{form:P,selectedModel:r,setSelectedModel:i,selectedProvider:a,step:d,isSubmitting:p,resetForm:L,nextStep:B,prevStep:V,handleProviderChange:$,handleReasoningPatternToggle:G,handleMemoryToggle:W,handleToolToggle:Z,handleWorkflowStepAdd:se,handleWorkflowStepRemove:ae,handleWorkflowStepUpdate:ce,onSubmit:P.handleSubmit(we),cancelSubmission:Pe}},fnt=[{id:"bedrock-claude-3-opus",name:"Claude 3 Opus (Bedrock)",provider:"bedrock",reasoning_capabilities:["chain_of_thought","tree_of_thought","reflection","self_critique","analogical_reasoning"],context_window:2e5,supports_tool_use:!0,supports_reflection:!0},{id:"bedrock-claude-3-sonnet",name:"Claude 3 Sonnet (Bedrock)",provider:"bedrock",reasoning_capabilities:["chain_of_thought","reflection","multi_step_reasoning"],context_window:2e5,supports_tool_use:!0,supports_reflection:!0},{id:"bedrock-claude-3-haiku",name:"Claude 3 Haiku (Bedrock)",provider:"bedrock",reasoning_capabilities:["chain_of_thought","multi_step_reasoning"],context_window:2e5,supports_tool_use:!0,supports_reflection:!1},{id:"bedrock-titan-text-premier",name:"Titan Text Premier (Bedrock)",provider:"bedrock",reasoning_capabilities:["chain_of_thought","multi_step_reasoning"],context_window:32e3,supports_tool_use:!0,supports_reflection:!1},{id:"gpt-4-turbo",name:"GPT-4 Turbo",provider:"openai",reasoning_capabilities:["chain_of_thought","tree_of_thought","reflection","self_critique"],context_window:128e3,supports_tool_use:!0,supports_reflection:!0},{id:"gpt-4",name:"GPT-4",provider:"openai",reasoning_capabilities:["chain_of_thought","reflection","multi_step_reasoning"],context_window:8192,supports_tool_use:!0,supports_reflection:!0},{id:"claude-3-opus",name:"Claude 3 Opus",provider:"anthropic",reasoning_capabilities:["chain_of_thought","tree_of_thought","reflection","self_critique","analogical_reasoning"],context_window:2e5,supports_tool_use:!0,supports_reflection:!0},{id:"claude-3-sonnet",name:"Claude 3 Sonnet",provider:"anthropic",reasoning_capabilities:["chain_of_thought","reflection","multi_step_reasoning"],context_window:2e5,supports_tool_use:!0,supports_reflection:!0}],pnt=[{id:"chain_of_thought",name:"Chain-of-Thought",description:"Step-by-step reasoning with explicit intermediate steps",complexity:"basic",use_cases:["Problem solving","Mathematical reasoning","Logical deduction"],compatible_models:["gpt-4","claude-3","bedrock-claude"]},{id:"tree_of_thought",name:"Tree-of-Thought",description:"Explore multiple reasoning paths and select the best one",complexity:"advanced",use_cases:["Complex planning","Creative problem solving","Strategic analysis"],compatible_models:["gpt-4","claude-3-opus"]},{id:"reflection",name:"Reflective Reasoning",description:"Self-evaluate and improve reasoning through reflection",complexity:"intermediate",use_cases:["Quality assurance","Error correction","Iterative improvement"],compatible_models:["gpt-4","claude-3","bedrock-claude"]},{id:"self_critique",name:"Self-Critique",description:"Critically analyze own outputs and identify weaknesses",complexity:"advanced",use_cases:["Content validation","Bias detection","Quality control"],compatible_models:["gpt-4","claude-3-opus"]},{id:"multi_step_reasoning",name:"Multi-Step Reasoning",description:"Break complex problems into manageable sub-problems",complexity:"intermediate",use_cases:["Complex analysis","Research tasks","Multi-faceted problems"],compatible_models:["gpt-4","claude-3","bedrock-claude"]},{id:"analogical_reasoning",name:"Analogical Reasoning",description:"Use analogies and past experiences to solve new problems",complexity:"advanced",use_cases:["Creative solutions","Knowledge transfer","Pattern recognition"],compatible_models:["gpt-4","claude-3-opus"]}],gnt=[{id:"reasoning_tracer",name:"Reasoning Tracer",description:"Track and visualize reasoning steps",category:"reasoning",parameters:[{name:"trace_depth",type:"number",required:!1,description:"Maximum depth of reasoning trace"},{name:"include_confidence",type:"boolean",required:!1,description:"Include confidence scores"}],reasoning_integration:!0},{id:"memory_consolidator",name:"Memory Consolidator",description:"Consolidate and organize memory across sessions",category:"memory",parameters:[{name:"consolidation_strategy",type:"string",required:!0,description:"Strategy for memory consolidation"},{name:"retention_period",type:"number",required:!1,description:"How long to retain memories"}],reasoning_integration:!0},{id:"reflection_engine",name:"Reflection Engine",description:"Perform deep reflection on reasoning processes",category:"reasoning",parameters:[{name:"reflection_depth",type:"number",required:!1,description:"Depth of reflection analysis"},{name:"focus_areas",type:"array",required:!1,description:"Specific areas to focus reflection on"}],reasoning_integration:!0},{id:"knowledge_graph",name:"Knowledge Graph",description:"Build and query knowledge graphs from reasoning",category:"data",parameters:[{name:"graph_type",type:"string",required:!0,description:"Type of knowledge graph to build"},{name:"max_nodes",type:"number",required:!1,description:"Maximum number of nodes"}],reasoning_integration:!0},{id:"critique_validator",name:"Critique Validator",description:"Validate reasoning through systematic critique",category:"validation",parameters:[{name:"validation_criteria",type:"array",required:!0,description:"Criteria for validation"},{name:"strictness_level",type:"string",required:!1,description:"How strict the validation should be"}],reasoning_integration:!0},{id:"pattern_matcher",name:"Pattern Matcher",description:"Identify patterns in reasoning and data",category:"reasoning",parameters:[{name:"pattern_types",type:"array",required:!0,description:"Types of patterns to match"},{name:"similarity_threshold",type:"number",required:!1,description:"Threshold for pattern matching"}],reasoning_integration:!0}],xnt=[{id:"working_memory",name:"Working Memory",description:"Short-term memory for current reasoning context",capacity:"limited",persistence:"session",retrieval_methods:["recency","relevance"],consolidation_support:!1},{id:"episodic_memory",name:"Episodic Memory",description:"Memory of specific experiences and events",capacity:"unlimited",persistence:"permanent",retrieval_methods:["temporal","contextual","associative"],consolidation_support:!0},{id:"semantic_memory",name:"Semantic Memory",description:"General knowledge and facts",capacity:"unlimited",persistence:"permanent",retrieval_methods:["semantic","categorical","hierarchical"],consolidation_support:!0},{id:"memory_consolidation",name:"Memory Consolidation",description:"Process of strengthening and organizing memories",capacity:"unlimited",persistence:"permanent",retrieval_methods:["importance","frequency","recency"],consolidation_support:!0},{id:"context_window_management",name:"Context Window Management",description:"Intelligent management of context window for optimal reasoning",capacity:"limited",persistence:"session",retrieval_methods:["relevance","importance","recency"],consolidation_support:!1}],ynt=({open:e,onOpenChange:t})=>{const{form:r,selectedModel:i,setSelectedModel:a,selectedProvider:l,step:d,isSubmitting:s,resetForm:p,nextStep:x,prevStep:w,handleProviderChange:j,handleReasoningPatternToggle:S,handleMemoryToggle:P,handleToolToggle:F,handleWorkflowStepAdd:L,handleWorkflowStepRemove:B,handleWorkflowStepUpdate:V,onSubmit:$,cancelSubmission:G}=mnt(t);U.useEffect(()=>(e||p(),()=>{s&&G()}),[e,p,s,G]);const W=Z=>{if(!Z&&s){console.log("Preventing dialog close during submission");return}t(Z)};return n.jsx(Ml,{open:e,onOpenChange:W,children:n.jsx(Wrt,{open:e,onOpenChange:W,isSubmitting:s,form:r,step:d,prevStep:w,nextStep:x,onSubmit:$,selectedModel:i,setSelectedModel:a,selectedProvider:l,handleProviderChange:j,handleReasoningPatternToggle:S,handleMemoryToggle:P,handleToolToggle:F,handleWorkflowStepAdd:L,handleWorkflowStepRemove:B,handleWorkflowStepUpdate:V,StrandsModels:fnt,strandsTools:gnt,reasoningPatterns:pnt,memoryTypes:xnt})})},vnt=({open:e,onOpenChange:t})=>{const{toast:r}=Ah(),[i,a]=U.useState(""),[l,d]=U.useState(""),[s,p]=U.useState([]),[x,w]=U.useState(!1),j=[{value:"coordinator",label:"Coordinator",icon:qi,description:"Orchestrates the workflow"},{value:"specialist",label:"Specialist",icon:Yi,description:"Handles specific domain tasks"},{value:"validator",label:"Validator",icon:Q0,description:"Validates outputs and decisions"},{value:"executor",label:"Executor",icon:V0,description:"Executes final actions"}],S=()=>{const B={id:`agent_${Date.now()}`,name:`Agent ${s.length+1}`,type:"specialist",description:"",capabilities:[]};p([...s,B])},P=B=>{p(s.filter(V=>V.id!==B))},F=(B,V)=>{p(s.map($=>$.id===B?{...$,...V}:$))},L=async()=>{if(!i.trim()){r({title:"Validation Error",description:"Workflow name is required",variant:"destructive"});return}if(s.length===0){r({title:"Validation Error",description:"At least one agent is required",variant:"destructive"});return}w(!0);try{const B={name:i,description:l,framework:"multi-agent",config:{agents:s,coordination_strategy:"sequential",communication_protocol:"message_passing",failure_handling:"retry_with_fallback"}};console.log("Creating multi-agent workflow:",B);const V=await fetch("/api/agents",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(B)});if(!V.ok){const G=await V.text();throw new Error(G||"Failed to create multi-agent workflow")}const $=await V.json();r({title:"Multi-Agent Workflow Created! 🤖",description:`${i} with ${s.length} agents is ready`,duration:5e3}),a(""),d(""),p([]),t(!1)}catch(B){console.error("Multi-agent workflow creation error:",B),r({title:"Creation Failed",description:B instanceof Error?B.message:"Unknown error occurred",variant:"destructive"})}finally{w(!1)}};return n.jsx(Ml,{open:e,onOpenChange:t,children:n.jsxs(Qo,{className:"max-w-4xl max-h-[90vh] overflow-hidden bg-beam-dark border-gray-700",children:[n.jsx(el,{className:"pb-4 border-b border-gray-700",children:n.jsxs(tl,{className:"text-xl font-semibold text-white flex items-center gap-2",children:[n.jsx(V0,{size:24,className:"text-orange-400"}),"Create Multi-Agent Workflow"]})}),n.jsxs("div",{className:"flex-1 overflow-y-auto py-4 space-y-6",children:[n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(mr,{htmlFor:"workflow-name",className:"text-white",children:"Workflow Name *"}),n.jsx(An,{id:"workflow-name",value:i,onChange:B=>a(B.target.value),placeholder:"e.g., Customer Support Workflow",className:"bg-gray-800 border-gray-600 text-white placeholder-gray-400"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(mr,{htmlFor:"workflow-description",className:"text-white",children:"Description"}),n.jsx(po,{id:"workflow-description",value:l,onChange:B=>d(B.target.value),placeholder:"Describe the workflow's purpose and how agents will collaborate...",rows:3,className:"bg-gray-800 border-gray-600 text-white placeholder-gray-400 resize-none"})]})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("h3",{className:"text-white font-medium",children:"Workflow Agents"}),n.jsxs(lt,{type:"button",onClick:S,className:"bg-orange-600 hover:bg-orange-700 text-white",size:"sm",children:[n.jsx(Mo,{size:16,className:"mr-2"}),"Add Agent"]})]}),s.length===0?n.jsxs("div",{className:"text-center py-8 border-2 border-dashed border-gray-600 rounded-lg",children:[n.jsx(qi,{size:48,className:"text-gray-500 mx-auto mb-4"}),n.jsx("p",{className:"text-gray-400 mb-4",children:"No agents configured yet"}),n.jsxs(lt,{type:"button",onClick:S,className:"bg-orange-600 hover:bg-orange-700 text-white",children:[n.jsx(Mo,{size:16,className:"mr-2"}),"Add First Agent"]})]}):n.jsx("div",{className:"space-y-4",children:s.map((B,V)=>{var G;const $=((G=j.find(W=>W.value===B.type))==null?void 0:G.icon)||qi;return n.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4 space-y-4",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"w-8 h-8 bg-orange-600 rounded-full flex items-center justify-center text-white text-sm font-medium",children:V+1}),n.jsx($,{size:20,className:"text-orange-400"}),n.jsxs("span",{className:"text-white font-medium",children:["Agent ",V+1]})]}),n.jsx(lt,{type:"button",variant:"ghost",size:"sm",onClick:()=>P(B.id),className:"text-red-400 hover:text-red-300 hover:bg-red-900/20",children:n.jsx(BN,{size:16})})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(mr,{className:"text-white text-sm",children:"Agent Name"}),n.jsx(An,{value:B.name,onChange:W=>F(B.id,{name:W.target.value}),placeholder:"e.g., Customer Analyzer",className:"bg-gray-700 border-gray-600 text-white"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(mr,{className:"text-white text-sm",children:"Agent Type"}),n.jsxs(_n,{value:B.type,onValueChange:W=>F(B.id,{type:W}),children:[n.jsx(xn,{className:"bg-gray-700 border-gray-600 text-white",children:n.jsx(wn,{})}),n.jsx(yn,{className:"bg-gray-800 border-gray-600",children:j.map(W=>{const Z=W.icon;return n.jsx(yt,{value:W.value,className:"text-white",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Z,{size:16}),n.jsxs("div",{children:[n.jsx("div",{children:W.label}),n.jsx("div",{className:"text-xs text-gray-400",children:W.description})]})]})},W.value)})})]})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(mr,{className:"text-white text-sm",children:"Description"}),n.jsx(po,{value:B.description,onChange:W=>F(B.id,{description:W.target.value}),placeholder:"Describe this agent's role and responsibilities...",rows:2,className:"bg-gray-700 border-gray-600 text-white resize-none"})]})]},B.id)})})]}),n.jsxs("div",{className:"bg-orange-900/20 border border-orange-700/50 rounded-lg p-4",children:[n.jsx("h4",{className:"text-orange-300 font-medium mb-2",children:"🤖 Multi-Agent Workflow Benefits"}),n.jsxs("ul",{className:"text-orange-200 text-sm space-y-1",children:[n.jsx("li",{children:"• Parallel processing for faster execution"}),n.jsx("li",{children:"• Specialized agents for domain expertise"}),n.jsx("li",{children:"• Fault tolerance through agent redundancy"}),n.jsx("li",{children:"• Scalable coordination patterns"})]})]})]}),n.jsxs("div",{className:"flex justify-between items-center pt-4 border-t border-gray-700",children:[n.jsx(lt,{type:"button",variant:"outline",onClick:()=>t(!1),disabled:x,className:"border-gray-600 text-gray-300 hover:bg-gray-700",children:"Cancel"}),n.jsx(lt,{type:"button",onClick:L,disabled:!i.trim()||s.length===0||x,className:"bg-gradient-to-r from-orange-600 to-orange-700 hover:from-orange-700 hover:to-orange-800 text-white",children:x?"Creating...":"Create Multi-Agent Workflow"})]})]})})},bnt=()=>{const[e,t]=U.useState(!1),[r,i]=U.useState(!1),[a,l]=U.useState(!1),d=U.useCallback(()=>{console.log("Opening Create Agent dialog"),t(!0)},[]),s=U.useCallback(()=>{i(!0)},[]),p=U.useCallback(()=>{l(!0)},[]);return n.jsxs(n.Fragment,{children:[n.jsxs(Ip,{children:[n.jsx(Op,{asChild:!0,children:n.jsxs(lt,{className:"bg-gradient-to-r from-beam-blue to-blue-600 hover:opacity-90 text-white px-5 py-2.5 rounded-lg flex items-center gap-2 shadow-lg transition-all duration-200",children:[n.jsx("span",{children:"Quick Actions"}),n.jsx(Na,{size:16})]})}),n.jsxs(_m,{align:"end",className:"bg-beam-dark-accent/95 border-gray-700 backdrop-blur-md text-white shadow-xl p-1 min-w-[220px] z-50",children:[n.jsxs(Ao,{className:"flex items-center gap-2 py-2.5 px-3 focus:bg-beam-blue/20 rounded-md cursor-pointer",onClick:d,children:[n.jsx(MF,{size:16,className:"text-green-400"}),n.jsx("span",{children:"Create New Agent"})]}),n.jsxs(Ao,{className:"flex items-center gap-2 py-2.5 px-3 focus:bg-beam-blue/20 rounded-md cursor-pointer",onClick:s,children:[n.jsx(ti,{size:16,className:"text-purple-400"}),n.jsx("span",{children:"Create Strands Workflow"})]}),n.jsxs(Ao,{className:"flex items-center gap-2 py-2.5 px-3 focus:bg-beam-blue/20 rounded-md cursor-pointer",onClick:p,children:[n.jsx(V0,{size:16,className:"text-orange-400"}),n.jsx("span",{children:"Multi-Agent Workflow"})]}),n.jsx("div",{className:"h-px bg-gray-700 my-1 mx-2"}),n.jsxs(Ao,{className:"flex items-center gap-2 py-2.5 px-3 focus:bg-beam-blue/20 rounded-md cursor-pointer",onClick:()=>window.open("/agent-control","_blank"),children:[n.jsx(op,{size:16,className:"text-cyan-400"}),n.jsx("span",{children:"Agent Control Panel"})]}),n.jsxs(Ao,{className:"flex items-center gap-2 py-2.5 px-3 focus:bg-beam-blue/20 rounded-md cursor-pointer",onClick:()=>{const x=new CustomEvent("refreshAgents");window.dispatchEvent(x)},children:[n.jsx(Co,{size:16,className:"text-green-400"}),n.jsx("span",{children:"Refresh Monitoring"})]})]})]}),n.jsx(prt,{open:e,onOpenChange:x=>{console.log("Create Agent dialog state change:",x),t(x)}}),n.jsx(ynt,{open:r,onOpenChange:i}),n.jsx(vnt,{open:a,onOpenChange:l})]})},_nt=({projects:e,onSelectProject:t})=>{const[r,i]=U.useState({}),[a,l]=U.useState({Network:!1,"Consumer Business":!1,"Sales & Service":!1,CX:!1,HR:!1,General:!1}),d=(S,P)=>{P.stopPropagation(),i(F=>({...F,[S]:!F[S]}))},s=(S,P)=>{P.preventDefault(),P.stopPropagation(),l(F=>({...F,[S]:!F[S]}))},p=S=>{t(S)},x=e.reduce((S,P)=>{const F=P.department||"General";return S[F]||(S[F]=[]),S[F].push(P),S},{}),w=["Network","Consumer Business","Sales & Service","CX","HR","General"],j=Object.keys(x).sort((S,P)=>w.indexOf(S)-w.indexOf(P));return n.jsxs("div",{className:"space-y-6",children:[n.jsx("h2",{className:"text-xl font-semibold text-white",children:"Projects"}),j.map(S=>n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center gap-2 cursor-pointer",onClick:P=>s(S,P),children:[n.jsx(Yye,{className:"text-beam-blue",size:18}),n.jsx("h3",{className:"text-lg font-medium text-white",children:S}),a[S]?n.jsx(x2,{size:16,className:"text-gray-400"}):n.jsx(Na,{size:16,className:"text-gray-400"})]}),a[S]&&n.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:x[S].map(P=>{var F,L,B,V;return n.jsx(jt,{className:`bg-beam-dark-accent/30 hover:bg-beam-dark-accent/50 backdrop-blur-md border-t-4 ${P.color} shadow-md hover:shadow-lg transition-all duration-300 cursor-pointer overflow-hidden flex flex-col h-auto`,onClick:()=>p(P.id),children:n.jsxs(Ht,{className:"p-3 flex flex-col flex-grow",children:[n.jsx("h3",{className:"text-base font-semibold text-white mb-1 truncate",children:P.name}),n.jsx("p",{className:"text-gray-300 text-xs mb-2 line-clamp-1",children:P.description}),n.jsxs("div",{className:"flex flex-wrap gap-2 pt-1 mt-auto",children:[n.jsxs("div",{className:"flex flex-col",children:[n.jsx(XF,{children:n.jsxs(DE,{children:[n.jsx(zE,{asChild:!0,children:n.jsxs("div",{className:"flex items-center gap-1.5 cursor-pointer",onClick:$=>d(`${P.id}-agents`,$),children:[n.jsx("div",{className:"p-1 rounded-md bg-blue-500/20 border border-blue-500/30",children:n.jsx(Hi,{size:12,className:"text-blue-400"})}),n.jsxs("div",{children:[n.jsx("div",{className:"text-xs text-gray-300",children:"Agents"}),n.jsxs("div",{className:"text-white text-xs font-medium flex items-center",children:[P.agentCount,r[`${P.id}-agents`]?n.jsx(x2,{size:12,className:"ml-0.5"}):n.jsx(Na,{size:12,className:"ml-0.5"})]})]})]})}),n.jsx(GN,{children:n.jsx("p",{children:"View agent details"})})]})}),r[`${P.id}-agents`]&&n.jsx("div",{className:"mt-1 ml-5 pl-1 border-l-2 border-blue-500/30",children:n.jsxs("div",{className:"text-xs text-blue-300",children:[P.agentCount," active agents"]})})]}),n.jsx("div",{className:"flex flex-col",children:n.jsxs(Ip,{children:[n.jsx(Op,{asChild:!0,onClick:$=>$.stopPropagation(),children:n.jsxs("div",{className:"flex items-center gap-1.5 cursor-pointer",children:[n.jsx("div",{className:"p-1 rounded-md bg-purple-500/20 border border-purple-500/30",children:n.jsx(Vc,{size:12,className:"text-purple-400"})}),n.jsxs("div",{children:[n.jsx("div",{className:"text-xs text-gray-300",children:"Tools"}),n.jsxs("div",{className:"text-white text-xs font-medium flex items-center",children:[((F=P.tools)==null?void 0:F.length)||0,n.jsx(Na,{size:12,className:"ml-0.5"})]})]})]})}),n.jsx(_m,{className:"bg-beam-dark border border-gray-700 text-white min-w-[180px] z-50",children:(P.tools||[]).map(($,G)=>n.jsxs(Ao,{className:"text-gray-200 hover:text-white hover:bg-beam-dark-accent/70 cursor-pointer",onClick:W=>W.stopPropagation(),children:[n.jsx(Vc,{size:14,className:"mr-2 text-purple-400"}),$]},`${P.id}-tool-${G}`))})]})}),n.jsx("div",{className:"flex flex-col",children:n.jsxs(Ip,{children:[n.jsx(Op,{asChild:!0,onClick:$=>$.stopPropagation(),children:n.jsxs("div",{className:"flex items-center gap-1.5 cursor-pointer",children:[n.jsx("div",{className:"p-1 rounded-md bg-green-500/20 border border-green-500/30",children:n.jsx(ln,{size:12,className:"text-green-400"})}),n.jsxs("div",{children:[n.jsx("div",{className:"text-xs text-gray-300",children:"DBs"}),n.jsxs("div",{className:"text-white text-xs font-medium flex items-center",children:[((L=P.databases)==null?void 0:L.length)||0,n.jsx(Na,{size:12,className:"ml-0.5"})]})]})]})}),n.jsx(_m,{className:"bg-beam-dark border border-gray-700 text-white min-w-[180px] z-50",children:(P.databases||[]).map(($,G)=>n.jsxs(Ao,{className:"text-gray-200 hover:text-white hover:bg-beam-dark-accent/70 cursor-pointer",onClick:W=>W.stopPropagation(),children:[n.jsx(ln,{size:14,className:"mr-2 text-green-400"}),$]},`${P.id}-db-${G}`))})]})}),n.jsx("div",{className:"flex flex-col",children:n.jsxs(Ip,{children:[n.jsx(Op,{asChild:!0,onClick:$=>$.stopPropagation(),children:n.jsxs("div",{className:"flex items-center gap-1.5 cursor-pointer",children:[n.jsx("div",{className:"p-1 rounded-md bg-amber-500/20 border border-amber-500/30",children:n.jsx(dn,{size:12,className:"text-amber-400"})}),n.jsxs("div",{children:[n.jsx("div",{className:"text-xs text-gray-300",children:"Guards"}),n.jsxs("div",{className:"text-white text-xs font-medium flex items-center",children:[(((B=P.globalGuardrails)==null?void 0:B.length)||0)+(((V=P.localGuardrails)==null?void 0:V.length)||0),n.jsx(Na,{size:12,className:"ml-0.5"})]})]})]})}),n.jsxs(_m,{className:"bg-beam-dark border border-gray-700 text-white min-w-[180px] z-50",children:[P.globalGuardrails&&P.globalGuardrails.length>0&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"px-2 py-1 text-xs font-medium text-gray-400 border-b border-gray-700 flex items-center",children:[n.jsx(Zs,{size:10,className:"mr-1 text-purple-400"}),"Global Guardrails"]}),P.globalGuardrails.map(($,G)=>n.jsxs(Ao,{className:"text-gray-200 hover:text-white hover:bg-beam-dark-accent/70 cursor-pointer",onClick:W=>W.stopPropagation(),children:[n.jsx(dn,{size:12,className:"mr-1.5 text-purple-400"}),$]},`${P.id}-global-guardrail-${G}`))]}),P.localGuardrails&&P.localGuardrails.length>0&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"px-2 py-1 text-xs font-medium text-gray-400 border-b border-gray-700 flex items-center",children:[n.jsx(V0,{size:10,className:"mr-1 text-indigo-400"}),"Local Guardrails"]}),P.localGuardrails.map(($,G)=>n.jsxs(Ao,{className:"text-gray-200 hover:text-white hover:bg-beam-dark-accent/70 cursor-pointer",onClick:W=>W.stopPropagation(),children:[n.jsx(dn,{size:12,className:"mr-1.5 text-indigo-400"}),$]},`${P.id}-local-guardrail-${G}`))]})]})]})})]})]})},P.id)})})]},S))]})};var i$="Collapsible",[wnt,Sue]=Jo(i$),[jnt,s$]=wnt(i$),Cue=U.forwardRef((e,t)=>{const{__scopeCollapsible:r,open:i,defaultOpen:a,disabled:l,onOpenChange:d,...s}=e,[p=!1,x]=fo({prop:i,defaultProp:a,onChange:d});return n.jsx(jnt,{scope:r,disabled:l,contentId:rc(),open:p,onOpenToggle:U.useCallback(()=>x(w=>!w),[x]),children:n.jsx(Hr.div,{"data-state":c$(p),"data-disabled":l?"":void 0,...s,ref:t})})});Cue.displayName=i$;var Aue="CollapsibleTrigger",a$=U.forwardRef((e,t)=>{const{__scopeCollapsible:r,...i}=e,a=s$(Aue,r);return n.jsx(Hr.button,{type:"button","aria-controls":a.contentId,"aria-expanded":a.open||!1,"data-state":c$(a.open),"data-disabled":a.disabled?"":void 0,disabled:a.disabled,...i,ref:t,onClick:_r(e.onClick,a.onOpenToggle)})});a$.displayName=Aue;var o$="CollapsibleContent",l$=U.forwardRef((e,t)=>{const{forceMount:r,...i}=e,a=s$(o$,e.__scopeCollapsible);return n.jsx(io,{present:r||a.open,children:({present:l})=>n.jsx(Nnt,{...i,ref:t,present:l})})});l$.displayName=o$;var Nnt=U.forwardRef((e,t)=>{const{__scopeCollapsible:r,present:i,children:a,...l}=e,d=s$(o$,r),[s,p]=U.useState(i),x=U.useRef(null),w=Mn(t,x),j=U.useRef(0),S=j.current,P=U.useRef(0),F=P.current,L=d.open||s,B=U.useRef(L),V=U.useRef();return U.useEffect(()=>{const $=requestAnimationFrame(()=>B.current=!1);return()=>cancelAnimationFrame($)},[]),Ba(()=>{const $=x.current;if($){V.current=V.current||{transitionDuration:$.style.transitionDuration,animationName:$.style.animationName},$.style.transitionDuration="0s",$.style.animationName="none";const G=$.getBoundingClientRect();j.current=G.height,P.current=G.width,B.current||($.style.transitionDuration=V.current.transitionDuration,$.style.animationName=V.current.animationName),p(i)}},[d.open,i]),n.jsx(Hr.div,{"data-state":c$(d.open),"data-disabled":d.disabled?"":void 0,id:d.contentId,hidden:!L,...l,ref:w,style:{"--radix-collapsible-content-height":S?`${S}px`:void 0,"--radix-collapsible-content-width":F?`${F}px`:void 0,...e.style},children:L&&a})});function c$(e){return e?"open":"closed"}var Tue=Cue,Snt=a$,Cnt=l$;const cR=Tue,uR=a$,dR=l$;var Um="Accordion",Ant=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[u$,Tnt,knt]=d_(Um),[v3,mft]=Jo(Um,[knt,Sue]),d$=Sue(),kue=ke.forwardRef((e,t)=>{const{type:r,...i}=e,a=i,l=i;return n.jsx(u$.Provider,{scope:e.__scopeAccordion,children:r==="multiple"?n.jsx(Int,{...l,ref:t}):n.jsx(Mnt,{...a,ref:t})})});kue.displayName=Um;var[Pue,Pnt]=v3(Um),[Eue,Ent]=v3(Um,{collapsible:!1}),Mnt=ke.forwardRef((e,t)=>{const{value:r,defaultValue:i,onValueChange:a=()=>{},collapsible:l=!1,...d}=e,[s,p]=fo({prop:r,defaultProp:i,onChange:a});return n.jsx(Pue,{scope:e.__scopeAccordion,value:s?[s]:[],onItemOpen:p,onItemClose:ke.useCallback(()=>l&&p(""),[l,p]),children:n.jsx(Eue,{scope:e.__scopeAccordion,collapsible:l,children:n.jsx(Mue,{...d,ref:t})})})}),Int=ke.forwardRef((e,t)=>{const{value:r,defaultValue:i,onValueChange:a=()=>{},...l}=e,[d=[],s]=fo({prop:r,defaultProp:i,onChange:a}),p=ke.useCallback(w=>s((j=[])=>[...j,w]),[s]),x=ke.useCallback(w=>s((j=[])=>j.filter(S=>S!==w)),[s]);return n.jsx(Pue,{scope:e.__scopeAccordion,value:d,onItemOpen:p,onItemClose:x,children:n.jsx(Eue,{scope:e.__scopeAccordion,collapsible:!0,children:n.jsx(Mue,{...l,ref:t})})})}),[Ont,b3]=v3(Um),Mue=ke.forwardRef((e,t)=>{const{__scopeAccordion:r,disabled:i,dir:a,orientation:l="vertical",...d}=e,s=ke.useRef(null),p=Mn(s,t),x=Tnt(r),j=sg(a)==="ltr",S=_r(e.onKeyDown,P=>{var ce;if(!Ant.includes(P.key))return;const F=P.target,L=x().filter(Pe=>{var we;return!((we=Pe.ref.current)!=null&&we.disabled)}),B=L.findIndex(Pe=>Pe.ref.current===F),V=L.length;if(B===-1)return;P.preventDefault();let $=B;const G=0,W=V-1,Z=()=>{$=B+1,$>W&&($=G)},se=()=>{$=B-1,$<G&&($=W)};switch(P.key){case"Home":$=G;break;case"End":$=W;break;case"ArrowRight":l==="horizontal"&&(j?Z():se());break;case"ArrowDown":l==="vertical"&&Z();break;case"ArrowLeft":l==="horizontal"&&(j?se():Z());break;case"ArrowUp":l==="vertical"&&se();break}const ae=$%V;(ce=L[ae].ref.current)==null||ce.focus()});return n.jsx(Ont,{scope:r,disabled:i,direction:a,orientation:l,children:n.jsx(u$.Slot,{scope:r,children:n.jsx(Hr.div,{...d,"data-orientation":l,ref:p,onKeyDown:i?void 0:S})})})}),GP="AccordionItem",[Rnt,h$]=v3(GP),Iue=ke.forwardRef((e,t)=>{const{__scopeAccordion:r,value:i,...a}=e,l=b3(GP,r),d=Pnt(GP,r),s=d$(r),p=rc(),x=i&&d.value.includes(i)||!1,w=l.disabled||e.disabled;return n.jsx(Rnt,{scope:r,open:x,disabled:w,triggerId:p,children:n.jsx(Tue,{"data-orientation":l.orientation,"data-state":Fue(x),...s,...a,ref:t,disabled:w,open:x,onOpenChange:j=>{j?d.onItemOpen(i):d.onItemClose(i)}})})});Iue.displayName=GP;var Oue="AccordionHeader",Rue=ke.forwardRef((e,t)=>{const{__scopeAccordion:r,...i}=e,a=b3(Um,r),l=h$(Oue,r);return n.jsx(Hr.h3,{"data-orientation":a.orientation,"data-state":Fue(l.open),"data-disabled":l.disabled?"":void 0,...i,ref:t})});Rue.displayName=Oue;var lL="AccordionTrigger",Due=ke.forwardRef((e,t)=>{const{__scopeAccordion:r,...i}=e,a=b3(Um,r),l=h$(lL,r),d=Ent(lL,r),s=d$(r);return n.jsx(u$.ItemSlot,{scope:r,children:n.jsx(Snt,{"aria-disabled":l.open&&!d.collapsible||void 0,"data-orientation":a.orientation,id:l.triggerId,...s,...i,ref:t})})});Due.displayName=lL;var zue="AccordionContent",Lue=ke.forwardRef((e,t)=>{const{__scopeAccordion:r,...i}=e,a=b3(Um,r),l=h$(zue,r),d=d$(r);return n.jsx(Cnt,{role:"region","aria-labelledby":l.triggerId,"data-orientation":a.orientation,...d,...i,ref:t,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...e.style}})});Lue.displayName=zue;function Fue(e){return e?"open":"closed"}var Dnt=kue,znt=Iue,Lnt=Rue,Bue=Due,$ue=Lue;const $Z=Dnt,cL=U.forwardRef(({className:e,...t},r)=>n.jsx(znt,{ref:r,className:Yt("border-b",e),...t}));cL.displayName="AccordionItem";const uL=U.forwardRef(({className:e,children:t,...r},i)=>n.jsx(Lnt,{className:"flex",children:n.jsxs(Bue,{ref:i,className:Yt("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",e),...r,children:[t,n.jsx(Na,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})}));uL.displayName=Bue.displayName;const dL=U.forwardRef(({className:e,children:t,...r},i)=>n.jsx($ue,{ref:i,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...r,children:n.jsx("div",{className:Yt("pb-4 pt-0",e),children:t})}));dL.displayName=$ue.displayName;const Fnt=({totalAgents:e,toolNodes:t,guardrailNodes:r,databaseAccesses:i,deniedToolAccesses:a,deniedDatabaseAccesses:l,averageDecisionTime:d,totalTaskTime:s,onNodeClick:p})=>{const x=[{id:"tool1",name:"Network Configuration API",reason:"Attempting production environment access in test mode",timestamp:"10:23 AM"},{id:"tool2",name:"Customer Billing System",reason:"Missing required authorization token",timestamp:"11:45 AM"}],w=[{id:"db1",name:"Customer PII Records",reason:"Access restricted due to data privacy regulations",timestamp:"09:15 AM"},{id:"db2",name:"Financial Transaction History",reason:"Access requires finance team approval",timestamp:"02:30 PM"},{id:"db3",name:"Network Infrastructure Credentials",reason:"Security policy violation: credential access",timestamp:"04:12 PM"}],j=[{id:"guard1",label:"Customer Data PII Detection",guardrailType:"pii",guardrailAction:"Redacted 12 instances of personally identifiable information",timestamp:"09:32 AM"},{id:"guard2",label:"Budget Cap Alert",guardrailType:"financial",guardrailAction:"Prevented exceeding approved CAPEX allocation of $1.2M",timestamp:"10:45 AM"},{id:"guard3",label:"Regulatory Compliance Check",guardrailType:"compliance",guardrailAction:"Enforced FCC Section 255 accessibility requirements",timestamp:"11:17 AM"},{id:"guard4",label:"Sensitive Market Intelligence",guardrailType:"confidential",guardrailAction:"Limited access to competitor analysis data",timestamp:"02:53 PM"}];return n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsxs(jt,{className:"bg-beam-dark/70 border border-gray-700/30",children:[n.jsx(wr,{className:"pb-2",children:n.jsx(fr,{className:"text-md font-medium text-white",children:"Project Summary"})}),n.jsx(Ht,{children:n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("div",{className:"flex flex-col p-3 bg-gray-800/40 rounded-lg border border-gray-700/30",children:[n.jsx("span",{className:"text-xs text-gray-400",children:"Total Agents"}),n.jsx("div",{className:"flex items-center mt-1",children:n.jsx("span",{className:"text-xl font-medium text-white",children:e})})]}),n.jsxs("div",{className:"flex flex-col p-3 bg-gray-800/40 rounded-lg border border-gray-700/30",children:[n.jsx("span",{className:"text-xs text-gray-400",children:"Tool Usages"}),n.jsx("div",{className:"flex items-center mt-1",children:n.jsx("span",{className:"text-xl font-medium text-purple-300",children:t.length})})]}),n.jsxs("div",{className:"flex flex-col p-3 bg-gray-800/40 rounded-lg border border-gray-700/30",children:[n.jsx("span",{className:"text-xs text-gray-400",children:"Guardrail Hits"}),n.jsx("div",{className:"flex items-center mt-1",children:n.jsx("span",{className:"text-xl font-medium text-amber-300",children:r.length||j.length})})]}),n.jsxs("div",{className:"flex flex-col p-3 bg-gray-800/40 rounded-lg border border-gray-700/30",children:[n.jsx("span",{className:"text-xs text-gray-400",children:"DB Accesses"}),n.jsx("div",{className:"flex items-center mt-1",children:n.jsx("span",{className:"text-xl font-medium text-blue-300",children:i})})]})]})})]}),n.jsxs(jt,{className:"bg-beam-dark/70 border border-gray-700/30",children:[n.jsx(wr,{className:"pb-2",children:n.jsx(fr,{className:"text-md font-medium text-white",children:"Execution Timing"})}),n.jsx(Ht,{children:n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex flex-col p-3 bg-gray-800/40 rounded-lg border border-gray-700/30",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-xs text-gray-400",children:"Avg Decision Step Time"}),n.jsx("span",{className:"text-xs font-medium text-white",children:d})]}),n.jsx(vn,{value:65,className:"h-1.5 mt-2"})]}),n.jsxs("div",{className:"flex flex-col p-3 bg-gray-800/40 rounded-lg border border-gray-700/30",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-xs text-gray-400",children:"Total Task Completion Time"}),n.jsx("span",{className:"text-xs font-medium text-white",children:s})]}),n.jsx(vn,{value:80,className:"h-1.5 mt-2"})]}),n.jsxs("div",{className:"flex justify-between p-3 bg-gray-800/40 rounded-lg border border-gray-700/30",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx($a,{size:14,className:"text-blue-400"}),n.jsx("span",{className:"text-xs text-gray-300",children:"Decision Trail Steps"})]}),n.jsx("span",{className:"text-xs font-medium text-white",children:t.length+r.length})]})]})})]})]}),n.jsxs(jt,{className:"bg-beam-dark/70 border border-gray-700/30",children:[n.jsx(wr,{className:"pb-2",children:n.jsx(fr,{className:"text-md font-medium text-white",children:"Access Control & Guardrails"})}),n.jsx(Ht,{children:n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-3",children:[n.jsxs(cR,{className:"w-full",children:[n.jsx(uR,{className:"w-full",children:n.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-800/40 rounded-lg border border-gray-700/30 hover:bg-gray-800/60 transition-colors cursor-pointer",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Vc,{size:14,className:"text-purple-400"}),n.jsx("span",{className:"text-xs text-gray-300",children:"Tool Access Denied"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Tt,{variant:"outline",className:"bg-red-900/30 text-red-300 border-red-600/30",children:a}),n.jsx(Na,{size:14,className:"text-gray-400 collapsible-icon"})]})]})}),n.jsx(dR,{children:n.jsx("div",{className:"mt-2 p-3 bg-gray-800/20 rounded-lg border border-gray-700/20 text-xs",children:n.jsx($Z,{type:"single",collapsible:!0,className:"w-full",children:x.map(S=>n.jsxs(cL,{value:S.id,className:"border-gray-700/30",children:[n.jsx(uL,{className:"py-2 text-red-300 hover:text-red-200 hover:no-underline",children:S.name}),n.jsx(dL,{className:"text-gray-300",children:n.jsxs("div",{className:"space-y-1 pl-2",children:[n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-400",children:"Reason:"})," ",S.reason]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-400",children:"Time:"})," ",S.timestamp]})]})})]},S.id))})})})]}),n.jsxs(cR,{className:"w-full",children:[n.jsx(uR,{className:"w-full",children:n.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-800/40 rounded-lg border border-gray-700/30 hover:bg-gray-800/60 transition-colors cursor-pointer",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ln,{size:14,className:"text-blue-400"}),n.jsx("span",{className:"text-xs text-gray-300",children:"Database Access Denied"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Tt,{variant:"outline",className:"bg-red-900/30 text-red-300 border-red-600/30",children:l}),n.jsx(Na,{size:14,className:"text-gray-400 collapsible-icon"})]})]})}),n.jsx(dR,{children:n.jsx("div",{className:"mt-2 p-3 bg-gray-800/20 rounded-lg border border-gray-700/20 text-xs",children:n.jsx($Z,{type:"single",collapsible:!0,className:"w-full",children:w.map(S=>n.jsxs(cL,{value:S.id,className:"border-gray-700/30",children:[n.jsx(uL,{className:"py-2 text-red-300 hover:text-red-200 hover:no-underline",children:S.name}),n.jsx(dL,{className:"text-gray-300",children:n.jsxs("div",{className:"space-y-1 pl-2",children:[n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-400",children:"Reason:"})," ",S.reason]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-400",children:"Time:"})," ",S.timestamp]})]})})]},S.id))})})})]}),n.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-800/40 rounded-lg border border-gray-700/30",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(dn,{size:14,className:"text-green-400"}),n.jsx("span",{className:"text-xs text-gray-300",children:"Guardrails Active"})]}),n.jsx(Tt,{variant:"outline",className:"bg-green-900/30 text-green-300 border-green-600/30",children:"Enabled"})]})]}),n.jsxs("div",{className:"p-3 bg-gray-800/40 rounded-lg border border-gray-700/30",children:[n.jsx("div",{className:"flex items-center justify-between mb-2",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(fs,{size:14,className:"text-amber-400"}),n.jsx("span",{className:"text-xs font-medium text-amber-300",children:"Guardrail Activations"})]})}),n.jsx(Da,{className:"my-2 bg-gray-700/30"}),n.jsxs("div",{className:"space-y-2 max-h-[120px] overflow-y-auto pr-1 scrollbar-thin",children:[j.map((S,P)=>n.jsxs(cR,{className:"w-full",children:[n.jsx(uR,{className:"w-full text-left",children:n.jsxs("div",{className:"flex items-center justify-between p-2 bg-amber-900/20 rounded border border-amber-600/20 cursor-pointer hover:bg-amber-900/30 transition-colors",children:[n.jsx("span",{className:"text-xs text-amber-200 truncate max-w-[200px]",children:S.label}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(Tt,{variant:"outline",className:"bg-amber-900/30 text-amber-300 border-amber-600/30 text-[10px]",onClick:F=>{F.stopPropagation(),p(S.id)},children:"View"}),n.jsx(Na,{size:12,className:"text-amber-400 collapsible-icon"})]})]})}),n.jsx(dR,{children:n.jsx("div",{className:"mt-2 p-2 bg-amber-900/10 rounded border border-amber-600/10 text-xs text-amber-100",children:n.jsxs("div",{className:"space-y-1 pl-2",children:[n.jsxs("div",{children:[n.jsx("span",{className:"text-amber-300",children:"Type:"})," ",S.guardrailType]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-amber-300",children:"Action:"})," ",S.guardrailAction]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-amber-300",children:"Time:"})," ",S.timestamp]})]})})})]},P)),j.length===0&&n.jsx("div",{className:"text-xs text-gray-400 text-center py-2",children:"No guardrail activations detected"})]})]})]})})]}),n.jsxs(jt,{className:"bg-beam-dark/70 border border-gray-700/30",children:[n.jsx(wr,{className:"pb-2",children:n.jsx(fr,{className:"text-md font-medium text-white",children:"Optimization Recommendations"})}),n.jsx(Ht,{children:n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"p-3 bg-gray-800/40 rounded-lg border border-gray-700/30",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(hh,{size:16,className:"text-green-400"}),n.jsx("span",{className:"text-sm text-white",children:"Optimize Database Queries"})]}),n.jsx("p",{className:"text-xs text-gray-300 mt-1 pl-6",children:"Database queries in tool executions could be optimized to reduce latency by ~30%."})]}),n.jsxs("div",{className:"p-3 bg-gray-800/40 rounded-lg border border-gray-700/30",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(hh,{size:16,className:"text-green-400"}),n.jsx("span",{className:"text-sm text-white",children:"Enhance Guardrail Precision"})]}),n.jsx("p",{className:"text-xs text-gray-300 mt-1 pl-6",children:"Current guardrails have 2 false positives. Consider refining guardrail criteria for better accuracy."})]}),n.jsxs("div",{className:"p-3 bg-gray-800/40 rounded-lg border border-gray-700/30",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(hh,{size:16,className:"text-green-400"}),n.jsx("span",{className:"text-sm text-white",children:"Parallelize Tool Execution"})]}),n.jsx("p",{className:"text-xs text-gray-300 mt-1 pl-6",children:"Independent tool operations could be executed in parallel to reduce overall task time."})]})]})})]})]})},Bnt=({selectedNode:e,decisionNodes:t,lineageNodes:r,selectedNodeMessages:i,reasoningOutput:a})=>{if(!e)return null;const l=t.find(x=>x.id===e)||r.find(x=>x.id===e);if(!l)return null;console.log("Node details rendering for:",e),console.log("Reasoning output in NodeDetails:",a);const d=i.some(x=>x.type==="guardrail"),s=i.filter(x=>x.type==="guardrail"),p=[...new Set(s.map(x=>x.guardrailType))];return n.jsxs(jt,{className:"bg-beam-dark/70 border border-gray-700/30",children:[n.jsx(wr,{className:"pb-2",children:n.jsx(fr,{className:"text-md font-medium text-white",children:"Selected Node Details"})}),n.jsxs(Ht,{className:"space-y-4",children:[n.jsxs("div",{className:"p-3 bg-blue-900/20 rounded-lg border border-blue-700/30",children:[n.jsxs("h3",{className:"text-md font-medium text-blue-300 mb-1",children:["Node: ",l.label]}),n.jsx("p",{className:"text-sm text-gray-300",children:l.content}),l.toolDetails&&n.jsxs("div",{className:"mt-3 pt-3 border-t border-blue-700/30 grid grid-cols-1 md:grid-cols-2 gap-3",children:[n.jsxs("div",{children:[n.jsx("h4",{className:"text-xs font-medium text-blue-300 mb-1",children:"Tool Execution"}),n.jsx("p",{className:"text-xs text-gray-300",children:l.toolDetails.executionTime&&n.jsxs("span",{className:"block",children:["Execution Time: ",l.toolDetails.executionTime]})})]}),l.toolDetails.databases&&n.jsxs("div",{children:[n.jsx("h4",{className:"text-xs font-medium text-blue-300 mb-1",children:"Databases Accessed"}),n.jsx("div",{className:"flex flex-wrap gap-1",children:l.toolDetails.databases.map((x,w)=>n.jsx(Tt,{className:"bg-blue-900/30 text-blue-300 border-blue-700/30 text-[10px]",children:x},w))})]})]}),i.length>0&&n.jsx("div",{className:"mt-3 pt-3 border-t border-blue-700/30",children:n.jsxs("div",{className:"flex items-center text-xs",children:[n.jsx(_s,{size:12,className:"text-blue-300 mr-1"}),n.jsxs("span",{className:"text-blue-300",children:[i.length," conversation messages"]}),d&&n.jsx(Tt,{className:"ml-2 text-[10px] bg-amber-900/30 text-amber-300 border-amber-600/30",children:"Guardrail activated"})]})})]}),d&&n.jsxs("div",{className:"p-3 bg-indigo-900/20 rounded-lg border border-indigo-700/30",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx(f_,{size:16,className:"text-indigo-400"}),n.jsx("h3",{className:"text-md font-medium text-indigo-300",children:"Feature Insight"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("p",{className:"text-sm text-gray-300",children:["This node triggered ",s.length," guardrail ",s.length===1?"activation":"activations","."]}),n.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:p.map((x,w)=>n.jsxs("div",{className:"flex items-center",children:[n.jsx(Tt,{className:"bg-indigo-900/30 text-indigo-300 border-indigo-700/30",children:x==="pii"?"PII Protection":x==="content"?"Content Filter":"Security Check"}),w<p.length-1&&n.jsx("span",{className:"text-gray-500 mx-1",children:"+"})]},w))}),n.jsx("div",{className:"mt-2 text-xs text-gray-400",children:n.jsx("p",{children:"Guardrails help ensure AI outputs meet safety and compliance requirements."})})]})]}),d&&n.jsxs("div",{className:"p-3 bg-amber-900/20 rounded-lg border border-amber-700/30",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx(dn,{size:16,className:"text-amber-400"}),n.jsx("h3",{className:"text-md font-medium text-amber-300",children:"Guardrails Applied"})]}),n.jsx("div",{className:"space-y-3",children:s.map((x,w)=>n.jsxs("div",{className:"bg-amber-950/30 p-2 rounded border border-amber-800/30",children:[n.jsxs("div",{className:"flex items-center justify-between mb-1",children:[n.jsx(Tt,{className:"text-[10px] bg-amber-900/30 text-amber-300 border-amber-600/30",children:x.guardrailType==="pii"?"PII Protection":x.guardrailType==="content"?"Content Filter":"Security Check"}),n.jsx("span",{className:"text-[10px] text-gray-400",children:x.timestamp})]}),n.jsx("p",{className:"text-sm text-gray-300",children:x.content})]},w))})]}),a&&n.jsxs("div",{className:"p-3 bg-purple-900/20 rounded-lg border border-purple-700/30",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx(Zye,{size:16,className:"text-purple-400"}),n.jsx("h3",{className:"text-md font-medium text-purple-300",children:"Agent Reasoning"}),n.jsxs(Tt,{className:"ml-auto bg-purple-900/30 text-purple-300 border-purple-700/30",children:[Math.round(a.confidence*100),"% confidence"]})]}),n.jsxs("div",{className:"space-y-3 mt-2",children:[a.objective&&n.jsxs("div",{children:[n.jsxs("h4",{className:"text-xs font-medium text-blue-300 mb-1 flex items-center",children:[n.jsx(Ch,{size:12,className:"mr-1"})," Objective"]}),n.jsx("p",{className:"text-sm text-gray-300 bg-blue-950/30 p-2 rounded border border-blue-800/30",children:a.objective})]}),n.jsxs("div",{children:[n.jsxs("h4",{className:"text-xs font-medium text-purple-300 mb-1 flex items-center",children:[n.jsx(ub,{size:12,className:"mr-1"})," Thought Process"]}),n.jsxs("p",{className:"text-sm text-gray-300 bg-purple-950/30 p-2 rounded border border-purple-800/30",children:['"',a.thought,'"']})]}),n.jsxs("div",{children:[n.jsxs("h4",{className:"text-xs font-medium text-purple-300 mb-1 flex items-center",children:[n.jsx(Qye,{size:12,className:"mr-1"})," Reasoning Steps"]}),n.jsx("ul",{className:"text-sm text-gray-300 space-y-1",children:a.reasoning.map((x,w)=>n.jsxs("li",{className:"flex items-start",children:[n.jsx("span",{className:"text-purple-400 mr-2",children:"•"}),n.jsx("span",{className:"flex-1",children:typeof x=="string"?x:x.step}),typeof x!="string"&&x.confidence!==void 0&&n.jsxs(Tt,{variant:"outline",className:"ml-2 text-xs",children:[Math.round(x.confidence*100),"%"]})]},w))})]}),a.tools&&a.tools.length>0&&n.jsxs("div",{children:[n.jsxs("h4",{className:"text-xs font-medium text-blue-300 mb-1 flex items-center",children:[n.jsx(Vc,{size:12,className:"mr-1"})," Tools Used"]}),n.jsx("ul",{className:"text-sm text-gray-300 space-y-1",children:a.tools.map((x,w)=>n.jsxs("li",{className:"flex items-start",children:[n.jsx("span",{className:"text-blue-400 mr-2",children:"•"}),n.jsx("span",{children:x})]},w))})]}),a.databases&&a.databases.length>0&&n.jsxs("div",{children:[n.jsxs("h4",{className:"text-xs font-medium text-green-300 mb-1 flex items-center",children:[n.jsx(ln,{size:12,className:"mr-1"})," Databases Accessed"]}),n.jsx("ul",{className:"text-sm text-gray-300 space-y-1",children:a.databases.map((x,w)=>n.jsxs("li",{className:"flex items-start",children:[n.jsx("span",{className:"text-green-400 mr-2",children:"•"}),n.jsx("span",{children:x})]},w))})]}),a.implementation&&a.implementation.length>0&&n.jsxs("div",{children:[n.jsxs("h4",{className:"text-xs font-medium text-indigo-300 mb-1 flex items-center",children:[n.jsx(Nve,{size:12,className:"mr-1"})," Implementation Plan"]}),n.jsx("ul",{className:"text-sm text-gray-300 space-y-1",children:a.implementation.map((x,w)=>n.jsxs("li",{className:"flex items-start",children:[n.jsxs("span",{className:"text-indigo-400 mr-2",children:[w+1,"."]}),n.jsx("span",{children:x})]},w))})]}),n.jsxs("div",{children:[n.jsxs("h4",{className:"text-xs font-medium text-amber-300 mb-1 flex items-center",children:[n.jsx(ub,{size:12,className:"mr-1"})," Constraints Applied"]}),n.jsx("ul",{className:"text-sm text-gray-300 space-y-1",children:a.constraints.map((x,w)=>n.jsxs("li",{className:"flex items-start",children:[n.jsx("span",{className:"text-amber-400 mr-2",children:"•"}),n.jsx("span",{children:x})]},w))})]}),n.jsxs("div",{children:[n.jsxs("h4",{className:"text-xs font-medium text-green-300 mb-1 flex items-center",children:[n.jsx(db,{size:12,className:"mr-1"})," Verification"]}),n.jsx("p",{className:"text-sm text-gray-300 bg-green-950/30 p-2 rounded border border-green-800/30",children:a.verification})]})]})]})]})]})},$nt=()=>n.jsxs("div",{className:"flex items-center justify-center h-32 text-gray-400",children:[n.jsx(_s,{className:"mr-2",size:18}),n.jsx("span",{children:"Select a node to view details and conversation history"})]}),Vnt=({operations:e})=>e.length===0?null:n.jsxs("div",{className:"mb-4",children:[n.jsxs("h3",{className:"text-sm font-medium text-green-300 mb-2 flex items-center",children:[n.jsx(ln,{size:14,className:"mr-1"})," Operations"]}),n.jsx("div",{className:"space-y-2",children:e.map((t,r)=>n.jsxs("div",{className:"p-2 rounded-lg bg-green-900/10 border-l-4 border-green-700",children:[n.jsxs("div",{className:"flex justify-between items-start",children:[n.jsx("span",{className:"text-sm font-medium text-green-300",children:t.name}),t.executionTime&&n.jsxs("span",{className:"text-xs text-gray-400 flex items-center",children:[n.jsx($a,{size:12,className:"mr-1"})," ",t.executionTime]})]}),n.jsx("p",{className:"text-sm text-gray-300 mt-1",children:t.description}),t.status&&n.jsx("div",{className:"mt-1.5",children:n.jsx(Tt,{className:`text-[10px] ${t.status==="success"?"bg-green-900/30 text-green-300 border-green-700/30":t.status==="warning"?"bg-amber-900/30 text-amber-300 border-amber-700/30":"bg-red-900/30 text-red-300 border-red-700/30"}`,children:t.status})})]},r))})]}),Unt=({message:e})=>n.jsx("div",{className:`p-3 rounded-lg ${e.type==="user"?"bg-gray-800/50 border-l-4 border-blue-600":e.type==="agent"?"bg-gray-800/30 border-l-4 border-purple-600":e.type==="guardrail"?"bg-amber-900/20 border-l-4 border-amber-600":"bg-gray-800/20 border-l-4 border-gray-600"}`,children:n.jsxs("div",{className:"flex items-start gap-2",children:[n.jsx("div",{className:"mt-0.5",children:e.type==="user"?n.jsx("div",{className:"bg-blue-600 p-1 rounded-full",children:n.jsx(_s,{size:12})}):e.type==="agent"?n.jsx("div",{className:"bg-purple-600 p-1 rounded-full",children:n.jsx(_s,{size:12})}):e.type==="guardrail"?n.jsx("div",{className:"bg-amber-600 p-1 rounded-full",children:n.jsx(fs,{size:12})}):n.jsx("div",{className:"bg-gray-600 p-1 rounded-full",children:n.jsx(dn,{size:12})})}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex justify-between items-start",children:[n.jsx("div",{className:`text-xs font-medium ${e.type==="user"?"text-blue-300":e.type==="agent"?"text-purple-300":e.type==="guardrail"?"text-amber-300":"text-gray-300"}`,children:e.type==="user"?"User":e.type==="agent"?"Agent":e.type==="guardrail"?"Guardrail":"System"}),n.jsx("div",{className:"text-[10px] text-gray-400",children:e.timestamp})]}),n.jsx("div",{className:"text-sm text-gray-200 mt-1",children:e.content}),e.type==="guardrail"&&e.guardrailType&&n.jsxs("div",{className:"mt-1.5 flex items-center",children:[n.jsx(Tt,{className:"text-[10px] bg-amber-900/30 text-amber-300 border-amber-600/30",children:e.guardrailType==="pii"?"PII Protection":e.guardrailType==="content"?"Content Filter":"Security Check"}),n.jsxs("span",{className:"text-[10px] text-gray-400 ml-2 flex items-center",children:[n.jsx(hh,{size:10,className:"text-green-500 mr-1"}),"Mitigated"]})]})]})]})}),Gnt=({messages:e,showHeader:t})=>e.length===0?null:n.jsxs("div",{className:"space-y-3",children:[t&&n.jsxs("h3",{className:"text-sm font-medium text-blue-300 mb-2 flex items-center",children:[n.jsx(_s,{size:14,className:"mr-1"})," Conversation"]}),e.map(r=>n.jsx(Unt,{message:r},r.id))]}),VZ=({messages:e,selectedNodeId:t,nodeName:r="Selected Node",operations:i=[]})=>!t&&e.length===0&&i.length===0?n.jsxs(jt,{className:"bg-beam-dark/70 border border-gray-700/30",children:[n.jsx(wr,{className:"pb-2",children:n.jsx(fr,{className:"text-md font-medium text-white",children:"Node Details"})}),n.jsx(Ht,{children:n.jsx($nt,{})})]}):n.jsxs(jt,{className:"bg-beam-dark/70 border border-gray-700/30",children:[n.jsx(wr,{className:"pb-2",children:n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx(fr,{className:"text-md font-medium text-white",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx(_s,{size:16,className:"text-blue-400 mr-2"}),e.length>0?`Conversation History: ${r}`:`Node Details: ${r}`]})}),e.length>0&&n.jsxs(Tt,{variant:"outline",className:"bg-blue-900/20 text-blue-300 border-blue-700/30",children:[e.length," messages"]}),i.length>0&&n.jsxs(Tt,{variant:"outline",className:"bg-green-900/20 text-green-300 border-green-700/30",children:[i.length," operations"]})]})}),n.jsx(Ht,{children:n.jsxs(Cl,{className:"h-[280px] pr-4",children:[n.jsx(Vnt,{operations:i}),n.jsx(Gnt,{messages:e,showHeader:i.length>0})]})})]}),Hnt=()=>n.jsxs("defs",{children:[n.jsx("marker",{id:"arrowhead",markerWidth:"10",markerHeight:"7",refX:"0",refY:"3.5",orient:"auto",children:n.jsx("polygon",{points:"0 0, 10 3.5, 0 7",fill:"#FFFFFF"})}),n.jsx("marker",{id:"arrowhead-purple",markerWidth:"10",markerHeight:"7",refX:"0",refY:"3.5",orient:"auto",children:n.jsx("polygon",{points:"0 0, 10 3.5, 0 7",fill:"#9C6EFF"})}),n.jsx("marker",{id:"arrowhead-highlight",markerWidth:"10",markerHeight:"7",refX:"0",refY:"3.5",orient:"auto",children:n.jsx("polygon",{points:"0 0, 10 3.5, 0 7",fill:"#FFFFFF"})})]}),qnt=({toolCount:e})=>n.jsxs("div",{className:"absolute top-2 left-2 z-10 flex items-center space-x-2",children:[n.jsxs("div",{className:"flex items-center gap-1.5 px-2.5 py-1.5 bg-purple-900/50 rounded-md border border-purple-500/40 shadow-md",children:[n.jsx(Vc,{size:14,className:"text-purple-300"}),n.jsxs("span",{className:"text-xs font-medium text-purple-200",children:[e," Tool",e!==1?"s":""]})]}),n.jsxs("div",{className:"flex items-center gap-1.5 px-2.5 py-1.5 bg-amber-900/50 rounded-md border border-amber-500/40 shadow-md",children:[n.jsx(dn,{size:14,className:"text-amber-300"}),n.jsx("span",{className:"text-xs font-medium text-amber-200",children:"Guardrails Active"})]})]}),Wnt=({nodeTypes:e})=>n.jsx("div",{className:"absolute bottom-2 right-2 bg-gray-900/80 backdrop-blur-sm rounded-lg p-3 text-xs text-gray-300 flex flex-wrap items-center gap-3 border border-gray-700/40 shadow-lg",children:Object.entries(e).map(([t,r])=>n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"w-3 h-3 rounded-full mr-1.5",style:{backgroundColor:r.color}}),n.jsx("span",{children:t==="tool"?"Tool":t.charAt(0).toUpperCase()+t.slice(1)})]},t))}),Knt=()=>Math.floor(Math.random()*100),Znt=e=>e>=80?"text-green-400":e>=50?"text-yellow-400":"text-red-400",Ynt=()=>{const e=["1m","2m","5m","10m","15m","1h","2h","1d"];return e[Math.floor(Math.random()*e.length)]+" ago"},Xnt=({label:e,isToolNode:t,hasOperations:r,expanded:i,percentage:a,timeAgo:l,toggleExpand:d,iconContainer:s})=>n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"flex-shrink-0",children:s}),n.jsxs("div",{className:"flex-grow min-w-0",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("span",{className:"text-xs font-medium text-white truncate",children:e}),t&&n.jsx(ng,{size:12,className:"text-purple-300"})]}),n.jsxs("div",{className:"flex items-center gap-2 text-[10px]",children:[n.jsxs("span",{className:`font-semibold ${Znt(a)}`,children:[a,"%"]}),n.jsx("span",{className:"text-gray-400",children:l})]})]}),r&&n.jsx("button",{className:"ml-auto text-gray-300 hover:text-white transition-colors p-0.5",onClick:d,children:i?n.jsx(x2,{size:14}):n.jsx(Na,{size:14})})]}),Jnt=({name:e,description:t,executionTime:r,status:i})=>n.jsxs("div",{className:"text-[10px] bg-black/20 rounded p-1",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"font-medium text-white",children:e}),r&&n.jsxs("span",{className:"text-[8px] text-gray-400 flex items-center",children:[n.jsx($a,{size:8,className:"mr-0.5"})," ",r]})]}),n.jsx("p",{className:"text-gray-300 mt-0.5",children:t})]}),Qnt=({operations:e})=>!e||e.length===0?null:n.jsx("div",{className:"mt-3 pt-2 border-t border-white/10 space-y-2 overflow-y-auto max-h-40",children:e.map((t,r)=>n.jsx(Jnt,{name:t.name,description:t.description,executionTime:t.executionTime,status:t.status},r))}),eit=({isToolNode:e,hasConversation:t,hasGuardrailActivation:r,toolDetails:i})=>n.jsxs("div",{className:"flex items-center justify-between mt-1",children:[e&&i&&n.jsxs("div",{className:"text-[9px] text-gray-400 pt-1",children:[i.executionTime&&n.jsx("span",{className:"text-purple-300",children:i.executionTime}),i.databases&&i.databases.length>0&&n.jsxs("span",{className:"ml-1 flex items-center",children:[n.jsx(ln,{size:8,className:"text-purple-300 mr-0.5"}),i.databases.length]})]}),t&&n.jsxs("div",{className:`flex items-center text-[9px] ${e?"":"pt-1"}`,children:[n.jsx(_s,{size:8,className:`${r?"text-amber-300":"text-blue-300"} mr-0.5`}),n.jsx("span",{className:r?"text-amber-300":"text-blue-300",children:r?"Guardrail":"Chat"})]})]}),tit=({label:e,content:t,type:r,hasOperations:i,operationsCount:a,hasConversation:l,hasGuardrailActivation:d})=>n.jsxs(GN,{side:"top",className:"max-w-xs bg-gray-900/90 border-gray-700",children:[n.jsx("div",{className:"text-sm font-medium text-white",children:e}),n.jsx("div",{className:"text-xs text-gray-300 mt-1 max-w-xs break-words",children:t}),r==="alternate"&&n.jsx("div",{className:"text-xs text-amber-300 mt-1",children:"Alternate path (guardrail triggered)"}),r==="tool"&&n.jsx("div",{className:"text-xs text-purple-300 mt-1",children:"Tool usage (click for details)"}),i&&n.jsxs("div",{className:"text-xs text-green-300 mt-1",children:[a," operations"]}),l&&n.jsx("div",{className:"text-xs text-blue-300 mt-1",children:"Click to view conversation history"}),d&&n.jsx("div",{className:"text-xs text-amber-300 mt-1",children:"Guardrail was activated"})]}),rit=({node:e,nodeType:t,isHovered:r,isSelected:i,nodeSize:a,onMouseEnter:l,onMouseLeave:d,onClick:s,renderIcon:p})=>{var ce,Pe;const[x,w]=U.useState(!1),j=e.type==="tool",S=e.type==="alternate",P=j&&!i?"animate-pulse-slow":"",F=j&&!i?"animate-float":"",L=["decision-1","decision-2","decision-3","tool-1"].includes(e.id),B=["decision-2","tool-1"].includes(e.id),V=e.operations&&e.operations.length>0,$=a.height+(((ce=e.operations)==null?void 0:ce.length)||0)*25+10,G=Knt(),W=Ynt(),Z={left:e.position.x,top:e.position.y,width:a.width,minHeight:x&&V?$:a.height,backgroundColor:S?"rgba(245, 158, 11, 0.15)":j?`${t.color}30`:`${t.color}20`,borderColor:S?"rgb(245, 158, 11, 0.5)":j?"rgba(139, 92, 246, 0.5)":"rgba(107, 114, 128, 0.4)",zIndex:i||r?20:j?15:10,transition:"height 0.3s ease-in-out, box-shadow 0.3s ease-in-out"};(i||r)&&(Z.boxShadow="0 0 15px rgba(255, 255, 255, 0.2)",Z.borderColor=S?"rgb(245, 158, 11)":j?"rgba(139, 92, 246)":"rgba(255, 255, 255, 0.7)");const se=we=>{we.stopPropagation(),w(!x)},ae=n.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center ${j?"ring-1 ring-purple-500/50":""}`,style:{backgroundColor:t.color},children:p(t.icon)});return n.jsxs(DE,{delayDuration:200,children:[n.jsx(zE,{asChild:!0,children:n.jsx("div",{className:`absolute rounded-md p-3 cursor-pointer transition-all duration-300 border backdrop-blur-sm ${i?"ring-1 ring-white/40":r?"shadow-lg":j?"shadow-[0_0_10px_rgba(139,92,246,0.15)]":""} ${P} ${F}`,style:Z,onClick:s,onMouseEnter:l,onMouseLeave:d,children:n.jsxs("div",{className:"flex flex-col h-full justify-between",children:[n.jsx(Xnt,{label:e.label,isToolNode:j,hasOperations:V,expanded:x,percentage:G,timeAgo:W,toggleExpand:se,iconContainer:ae}),x&&V&&n.jsx(Qnt,{operations:e.operations||[]}),n.jsx(eit,{isToolNode:j,hasConversation:L,hasGuardrailActivation:B,toolDetails:e.toolDetails})]})})}),n.jsx(tit,{label:e.label,content:e.content,type:e.type,hasOperations:V,operationsCount:(Pe=e.operations)==null?void 0:Pe.length,hasConversation:L,hasGuardrailActivation:B})]})},nit=(e,t,r,i,a,l,d)=>{const s=r.find(ce=>ce.id===t);if(!s)return null;const p=e.position.x+d.width,x=e.position.y+d.height/2,w=s.position.x,j=s.position.y+d.height/2,S=p,P=x,F=w,L=j,B=Math.abs(F-S),V=Math.min(150,Math.max(80,B/3)),$=`${e.id}-${t}`,G=l[$]||!1,W=s.type==="alternate";let Z=`M${S} ${P} C${S+V} ${P}, ${F-V} ${L}, ${F} ${L}`;const se=i===e.id||i===t||a===e.id||a===t,ae=e.type==="tool"||s.type==="tool";return{pathD:Z,pathId:$,isAnimated:G,isAlternatePath:W,pathHighlighted:se,isToolConnection:ae}},iit=(e,t,r,i)=>{const a=t.find($=>$.id===e.source),l=t.find($=>$.id===e.target);if(!a||!l)return null;const d=a.position.x+i.width,s=a.position.y+i.height/2,p=l.position.x,x=l.position.y+i.height/2,w=d,j=s,S=p,P=x,F=Math.abs(S-w),L=Math.min(150,Math.max(80,F/3));let B=`M${w} ${j} C${w+L} ${j}, ${S-L} ${P}, ${S} ${P}`;const V=r===e.source||r===e.target;return{pathD:B,isHighlighted:V}},sit=({nodes:e,hoveredNode:t,selectedNode:r,animatedPaths:i,nodeSize:a})=>n.jsx(n.Fragment,{children:e.map(l=>l.connects.map(d=>{const s=nit(l,d,e,t,r,i,a);if(!s)return null;const p=s.isToolConnection?s.pathHighlighted?"3.5":"2.5":s.pathHighlighted?"2.5":"1.5",x=s.isToolConnection?s.pathHighlighted?"#A78BFA":"#9C6EFF40":s.pathHighlighted?"#FFFFFF":"#666666",w=s.isToolConnection?s.pathHighlighted?"url(#arrowhead-highlight)":"url(#arrowhead-purple)":"url(#arrowhead)";return n.jsx("g",{children:n.jsx("path",{d:s.pathD,fill:"none",stroke:x,strokeWidth:p,strokeDasharray:s.isAlternatePath?"5,5":s.isAnimated?"12,12":"none",strokeDashoffset:s.isAnimated?"24":"0",className:`transition-all duration-200 ${s.isAnimated?"animate-connection-flow":""}`,markerEnd:w,style:{filter:s.pathHighlighted?"drop-shadow(0 0 2px rgba(255, 255, 255, 0.5))":"none"}})},`${s.pathId}-${Math.random().toString(36).substring(7)}`)}))}),ait=({nodes:e,metadata:t,onNodeClick:r,selectedNode:i,highlightGuardrails:a=!0})=>{const[l,d]=U.useState(null);U.useState(!0);const[s,p]=U.useState({});U.useEffect(()=>{if(l){const j={};e.forEach(S=>{S.id===l&&S.connects.forEach(P=>{j[`${S.id}-${P}`]=!0}),S.connects.includes(l)&&(j[`${S.id}-${l}`]=!0)}),p(j)}else if(i){const j={};e.forEach(S=>{S.id===i&&S.connects.forEach(P=>{j[`${S.id}-${P}`]=!0}),S.connects.includes(i)&&(j[`${S.id}-${i}`]=!0)}),p(j)}else p({})},[l,i,e]);const x=j=>{switch(j){case"Play":return n.jsx(Sh,{size:16});case"GitBranch":return n.jsx(Q0,{size:16});case"Wrench":return n.jsx(Vc,{size:16});case"Cpu":return n.jsx(bd,{size:16});case"AlertTriangle":return n.jsx(fs,{size:16});case"MessageSquare":return n.jsx(_s,{size:16});case"Database":return n.jsx(ln,{size:16});case"Info":return n.jsx(f_,{size:16});default:return n.jsx(bd,{size:16})}},w=e.filter(j=>j.type==="tool");return n.jsxs("div",{className:"w-full h-full overflow-hidden relative",style:{minHeight:t.height+"px"},children:[n.jsx(qnt,{toolCount:w.length}),n.jsxs("svg",{width:"100%",height:"100%",style:{position:"absolute",top:0,left:0,zIndex:1,pointerEvents:"none"},viewBox:`0 0 ${t.width} ${t.height}`,preserveAspectRatio:"xMinYMin meet",children:[n.jsx(Hnt,{}),n.jsx(sit,{nodes:e,hoveredNode:l,selectedNode:i,animatedPaths:s,nodeSize:t.nodeSize})]}),e.map(j=>{const S=t.nodeTypes[j.type]||{color:"#3B82F6",icon:"Cpu"},P=i===j.id,F=l===j.id;return j.type,n.jsx(rit,{node:j,nodeType:S,isHovered:F,isSelected:P,nodeSize:t.nodeSize,onMouseEnter:()=>d(j.id),onMouseLeave:()=>d(null),onClick:()=>r(j.id),renderIcon:x},j.id)}),n.jsx(Wnt,{nodeTypes:t.nodeTypes})]})},oit={start:[{id:"start-1",type:"user",content:"New loan application received from customer John Smith for $250,000 home mortgage",timestamp:"2024-01-15 09:15:23"},{id:"start-2",type:"agent",content:"Loan application received and logged. Initiating comprehensive processing workflow including KYC verification, credit assessment, and risk analysis. Application ID: LA-2024-001534",timestamp:"2024-01-15 09:15:24"},{id:"start-3",type:"system",content:"Processing initiated: Customer onboarding agent activated for KYC verification",timestamp:"2024-01-15 09:15:25"}],tool1:[{id:"tool1-1",type:"system",content:"KYC verification process started for customer ID: CUST-789012",timestamp:"2024-01-15 09:15:26"},{id:"tool1-2",type:"agent",content:"Performing comprehensive KYC checks including identity verification, document validation, and regulatory screening against sanctions lists",timestamp:"2024-01-15 09:15:27"},{id:"tool1-3",type:"system",content:"Document OCR completed: Driver's license verified, Social Security card validated, Utility bill processed for address confirmation",timestamp:"2024-01-15 09:16:45"},{id:"tool1-4",type:"agent",content:"Identity verification successful with 96.2% confidence. Customer cleared against all watchlists. Address confirmed through utility bill dated within 90 days.",timestamp:"2024-01-15 09:16:46"}],decision1:[{id:"decision1-1",type:"system",content:"Evaluating KYC verification results against regulatory compliance thresholds",timestamp:"2024-01-15 09:16:47"},{id:"decision1-2",type:"agent",content:"KYC verification exceeds required confidence threshold of 95%. Customer meets all regulatory requirements for proceeding to credit assessment phase.",timestamp:"2024-01-15 09:16:48"},{id:"decision1-3",type:"guardrail",content:"Guardrail check: PII data encryption verified, customer consent recorded, audit trail logged",timestamp:"2024-01-15 09:16:49",guardrailType:"pii"}],tool2:[{id:"tool2-1",type:"system",content:"Initiating credit assessment through integrated bureau services",timestamp:"2024-01-15 09:16:50"},{id:"tool2-2",type:"agent",content:"Retrieving credit reports from Experian, Equifax, and TransUnion. Analyzing 7-year payment history and current credit utilization.",timestamp:"2024-01-15 09:17:15"},{id:"tool2-3",type:"system",content:"Credit data retrieved: FICO Score 742, No delinquencies in 24 months, Current utilization 18%",timestamp:"2024-01-15 09:17:16"},{id:"tool2-4",type:"agent",content:"Income verification completed through employer payroll service. Annual income $95,000 confirmed. Debt-to-income ratio calculated at 32% including proposed mortgage.",timestamp:"2024-01-15 09:17:45"},{id:"tool2-5",type:"guardrail",content:"Guardrail activated: Credit inquiry consent verified before bureau access",timestamp:"2024-01-15 09:17:16",guardrailType:"content"}],tool3:[{id:"tool3-1",type:"system",content:"Executing comprehensive risk assessment algorithm",timestamp:"2024-01-15 09:17:46"},{id:"tool3-2",type:"agent",content:"Applying multi-factor risk model considering credit score, income stability, employment history, and current market conditions. Property appraisal value $320,000 provides adequate collateral coverage.",timestamp:"2024-01-15 09:18:30"},{id:"tool3-3",type:"system",content:"Risk calculation complete: Medium-Low risk profile assigned, Loan-to-Value ratio 78.1%",timestamp:"2024-01-15 09:18:31"},{id:"tool3-4",type:"agent",content:"Based on risk assessment and current market rates, recommended loan terms: $250,000 at 4.25% interest for 30-year fixed term. Monthly payment $1,229.85",timestamp:"2024-01-15 09:18:32"}],decision2:[{id:"decision2-1",type:"system",content:"Final approval decision point: Reviewing all assessment criteria",timestamp:"2024-01-15 09:18:33"},{id:"decision2-2",type:"agent",content:"All approval criteria satisfied: Credit score above minimum, DTI within limits, adequate collateral, income verified. Loan approved for requested amount with prime rate terms.",timestamp:"2024-01-15 09:18:34"},{id:"decision2-3",type:"guardrail",content:"Guardrail check: Fair lending practices validated, no discriminatory factors detected",timestamp:"2024-01-15 09:18:35",guardrailType:"content"},{id:"decision2-4",type:"system",content:"Regulatory compliance confirmed: All lending regulations satisfied",timestamp:"2024-01-15 09:18:36"}],tool4:[{id:"tool4-1",type:"system",content:"Executing loan setup and account creation processes",timestamp:"2024-01-15 09:18:37"},{id:"tool4-2",type:"agent",content:"Generating loan documents including promissory note, mortgage agreement, and disclosure statements. Setting up automated payment processing and escrow account.",timestamp:"2024-01-15 09:19:15"},{id:"tool4-3",type:"system",content:"Account created: Loan account LA-2024-001534, Payment due date set for 15th of each month",timestamp:"2024-01-15 09:19:16"},{id:"tool4-4",type:"agent",content:"Loan setup complete. Customer notification sent with approval details and next steps for closing. Loan ready for funding upon completion of closing requirements.",timestamp:"2024-01-15 09:19:17"}],alternate1:[{id:"alternate1-1",type:"system",content:"KYC verification failed - initiating remediation workflow",timestamp:"2024-01-15 09:16:47"},{id:"alternate1-2",type:"agent",content:"KYC verification could not be completed due to document quality issues. Customer notification sent requesting clearer copies of identification documents.",timestamp:"2024-01-15 09:16:48"},{id:"alternate1-3",type:"system",content:"Resubmission window opened: Customer has 7 days to provide updated documentation",timestamp:"2024-01-15 09:16:49"}],alternate2:[{id:"alternate2-1",type:"system",content:"Loan application declined - generating adverse action notice",timestamp:"2024-01-15 09:18:33"},{id:"alternate2-2",type:"agent",content:"Loan application declined due to debt-to-income ratio exceeding 43% threshold. Customer notified with specific decline reasons and credit improvement recommendations.",timestamp:"2024-01-15 09:18:34"},{id:"alternate2-3",type:"system",content:"Alternative product recommendations generated: Credit counseling service, secured credit card options",timestamp:"2024-01-15 09:18:35"},{id:"alternate2-4",type:"guardrail",content:"Guardrail check: Fair Credit Reporting Act compliance verified in adverse action notice",timestamp:"2024-01-15 09:18:36",guardrailType:"content"}],"corporate-credit":[{id:"corporate-1",type:"user",content:"Corporate credit facility request: $5M revolving line of credit for TechCorp Manufacturing Inc.",timestamp:"2024-01-15 10:30:00"},{id:"corporate-2",type:"agent",content:"Analyzing corporate financials: Revenue $45M, EBITDA $8.2M, Current assets $12M. Debt service coverage ratio 1.8x meets minimum requirements.",timestamp:"2024-01-15 10:45:30"},{id:"corporate-3",type:"system",content:"Industry analysis: Manufacturing sector showing stable growth, moderate risk classification applied",timestamp:"2024-01-15 10:45:31"}],"portfolio-optimization":[{id:"wealth-1",type:"user",content:"Client portfolio review: $2.5M portfolio, moderate risk tolerance, seeking growth with income",timestamp:"2024-01-15 14:20:00"},{id:"wealth-2",type:"agent",content:"Current allocation: 65% equities, 30% bonds, 5% alternatives. Recommending rebalancing to 60% equities, 25% bonds, 10% REITs, 5% commodities for better diversification.",timestamp:"2024-01-15 14:25:15"},{id:"wealth-3",type:"system",content:"Tax-loss harvesting opportunity identified: $15K in unrealized losses available for offset",timestamp:"2024-01-15 14:25:16"}]},Vue={"decision-1":[{name:"Data Extraction",description:"Extracted customer data from CRM database",executionTime:"245ms",status:"success"},{name:"LLM Processing",description:"Applied data analysis using GPT-4o model",executionTime:"1.2s",status:"success"}],"decision-2":[{name:"Revenue Forecasting",description:"Applied time-series analysis to historical sales data",executionTime:"567ms",status:"warning"},{name:"PII Filtering",description:"Detected and sanitized personally identifiable information",executionTime:"89ms",status:"success"}],"tool-1":[{name:"Database Query",description:"Executed SQL to fetch customer lifetime value metrics",executionTime:"178ms",status:"success"},{name:"Data Aggregation",description:"Grouped results by customer segments",executionTime:"42ms",status:"success"}],"lineage-1":[{name:"Data Source Access",description:"Connected to Customer Analytics Warehouse",executionTime:"215ms",status:"success"},{name:"Data Transformation",description:"Applied aggregation by customer segment",executionTime:"156ms",status:"success"},{name:"PII Compliance Check",description:"Verified no individual customer records are exposed",executionTime:"65ms",status:"success"}],"lineage-2":[{name:"Marketing Data Access",description:"Connected to Marketing Campaign Database",executionTime:"198ms",status:"success"},{name:"ROI Calculation",description:"Calculated return on investment for each campaign",executionTime:"120ms",status:"success"}],"lineage-3":[{name:"Quality Metric Collection",description:"Gathered data quality metrics from monitoring service",executionTime:"145ms",status:"success"},{name:"Completeness Analysis",description:"Verified data completeness across all required fields",executionTime:"78ms",status:"success"},{name:"Data Accuracy Validation",description:"Compared sample data with source of truth",executionTime:"210ms",status:"warning"}]},p0={start:{objective:"Process new customer loan application ensuring compliance with banking regulations and risk management policies",thought:"I need to initiate a comprehensive loan application workflow that validates customer identity, assesses creditworthiness, and ensures all regulatory requirements are met before approval.",reasoning:[{step:"Validate customer application completeness and required documentation",confidence:.98},{step:"Initiate KYC (Know Your Customer) verification process",confidence:.95},{step:"Check customer against sanctions and watchlists",confidence:.97},{step:"Determine loan type and applicable interest rates",confidence:.92}],constraints:["Must comply with Anti-Money Laundering (AML) regulations","All customer data must be handled according to GDPR/privacy laws","Loan amount cannot exceed regulatory lending limits","Interest rates must align with current market conditions and bank policy"],tools:["Customer Application Parser","Document Verification System","Regulatory Compliance Checker","Interest Rate Calculator"],databases:["Customer Master Database","Loan Products Catalog","Regulatory Requirements Database","Market Rate Reference"],verification:"Application received and initial validation confirms all required fields are present. Process can proceed to KYC verification stage.",confidence:.94},tool1:{objective:"Verify customer identity and perform comprehensive KYC checks to ensure regulatory compliance",thought:"KYC verification is critical for banking compliance. I must validate identity documents, check against government databases, and assess customer risk profile.",reasoning:[{step:"Parse and validate government-issued identification documents",confidence:.96},{step:"Cross-reference customer details with official registries",confidence:.93},{step:"Perform facial recognition matching against provided photo ID",confidence:.89},{step:"Check customer against PEP (Politically Exposed Persons) lists",confidence:.97},{step:"Validate address proof and residency status",confidence:.91}],constraints:["Identity verification must achieve 95% confidence threshold","All checks must complete within 3 minutes for customer experience","Data retention policies must be followed for audit trail","Failed verification requires manual review escalation"],tools:["Document OCR Engine","Government Database API","Facial Recognition System","PEP Screening Service","Address Validation Service"],databases:["KYC Documentation Store","Customer Risk Profiles","Government Registry APIs","Sanctions Lists Database"],verification:"Customer identity successfully verified with 96.2% confidence. All regulatory checks passed. Customer cleared for credit assessment.",confidence:.93},decision1:{objective:"Evaluate KYC verification results and determine if customer meets regulatory compliance requirements",thought:"Based on KYC verification results, I need to assess whether the customer passes all regulatory requirements or requires additional verification steps.",reasoning:[{step:"Analyze identity verification confidence score against minimum threshold",confidence:.95},{step:"Review any flags from sanctions or PEP screening",confidence:.98},{step:"Validate completeness of required documentation",confidence:.92},{step:"Assess overall customer risk profile classification",confidence:.89}],constraints:["KYC confidence must be above 95% for automatic approval","Any sanctions flags require immediate escalation","Incomplete documentation must trigger resubmission request","High-risk customers require enhanced due diligence"],tools:["Risk Assessment Engine","Compliance Decision Matrix","Escalation Workflow Manager"],databases:["Compliance Rules Database","Customer Risk Classifications","Audit Trail Repository"],verification:"KYC verification results meet all regulatory requirements. Customer approved for credit assessment with standard risk classification.",confidence:.94},tool2:{objective:"Perform comprehensive credit assessment by analyzing customer's credit history, income, and financial stability",thought:"Credit assessment is crucial for loan approval. I need to evaluate creditworthiness using multiple data sources and risk models to determine appropriate loan terms.",reasoning:[{step:"Retrieve credit report from major credit bureaus",confidence:.97},{step:"Analyze credit score and payment history patterns",confidence:.95},{step:"Verify income through employment and bank statements",confidence:.91},{step:"Calculate debt-to-income ratio and financial obligations",confidence:.93},{step:"Apply bank's proprietary credit scoring model",confidence:.88}],constraints:["Credit score must be above 650 for standard loan approval","Debt-to-income ratio cannot exceed 40%","Income verification must be within last 3 months","Multiple recent credit inquiries may impact approval"],tools:["Credit Bureau Integration","Income Verification System","Debt Analysis Calculator","Proprietary Credit Scoring Model","Financial Statement Analyzer"],databases:["Credit Bureau Data","Employment Verification Database","Bank Statement Repository","Credit Scoring Models Database"],verification:"Credit assessment completed. Customer has credit score of 742 with DTI ratio of 32%. Qualifies for prime rate lending terms.",confidence:.92},tool3:{objective:"Calculate comprehensive risk assessment and determine optimal loan terms based on customer profile and market conditions",thought:"Risk assessment combines credit data with behavioral analytics and market conditions to determine the most appropriate loan structure and pricing.",reasoning:[{step:"Apply multi-factor risk scoring algorithm including credit, income, and employment stability",confidence:.94},{step:"Analyze customer banking relationship history and deposit patterns",confidence:.91},{step:"Evaluate loan-to-value ratio for secured loans",confidence:.89},{step:"Consider macroeconomic factors and interest rate environment",confidence:.87},{step:"Determine appropriate loan terms, amount, and interest rate",confidence:.93}],constraints:["Maximum loan amount based on income multiples (5x annual income)","Interest rate must reflect risk profile and market conditions","Loan term cannot exceed regulatory maximum for loan type","Must maintain bank's target profit margins"],tools:["Multi-Factor Risk Engine","Behavioral Analytics Platform","Market Rate Monitoring System","Loan Pricing Calculator","Portfolio Risk Analyzer"],databases:["Customer Banking History","Market Rate Database","Risk Model Parameters","Loan Portfolio Analytics"],verification:"Risk assessment completed with medium-low risk classification. Approved for $250,000 loan at 4.25% interest rate over 30-year term.",confidence:.91},decision2:{objective:"Make final loan approval decision based on comprehensive risk assessment and regulatory requirements",thought:"This is the critical decision point where all assessment data is synthesized to make a final approval or denial decision that balances risk and business objectives.",reasoning:[{step:"Review all assessment results against approval criteria matrix",confidence:.96},{step:"Validate loan terms are within regulatory and policy limits",confidence:.98},{step:"Confirm adequate portfolio capacity for this risk profile",confidence:.92},{step:"Ensure proposed terms align with customer's repayment capacity",confidence:.94}],constraints:["Must meet all regulatory capital requirements","Loan concentration limits by industry and geography","Customer debt service coverage ratio minimum 1.25x","Approval authority limits based on loan amount"],tools:["Approval Decision Engine","Regulatory Compliance Validator","Portfolio Concentration Monitor","Authority Limits Checker"],databases:["Approval Criteria Database","Portfolio Risk Limits","Regulatory Requirements","Authority Matrix"],verification:"All criteria met for loan approval. Loan terms validated against regulatory requirements and portfolio limits. Final approval granted.",confidence:.95},tool4:{objective:"Execute approved loan setup including account creation, documentation generation, and system integration",thought:"Final step requires precise execution of loan setup processes while maintaining data integrity and ensuring all legal requirements are met.",reasoning:[{step:"Generate loan agreement and legal documentation",confidence:.97},{step:"Create loan account in core banking system",confidence:.96},{step:"Set up automated payment schedules and notifications",confidence:.94},{step:"Initialize loan monitoring and servicing workflows",confidence:.92},{step:"Send approval notification and next steps to customer",confidence:.95}],constraints:["All legal documentation must comply with state and federal regulations","Account setup must complete within 24 hours of approval","Customer notifications must include all required disclosures","Loan must be funded according to agreed timeline"],tools:["Document Generation Engine","Core Banking Integration","Payment Processing Setup","Loan Servicing Platform","Customer Communication System"],databases:["Core Banking System","Document Management System","Customer Communication Logs","Loan Servicing Database"],verification:"Loan account successfully created. Documentation generated and customer notified. Loan ready for funding.",confidence:.96},alternate1:{objective:"Handle KYC verification failure by requesting additional documentation and providing customer guidance",thought:"When KYC verification fails, I need to identify specific deficiencies and guide the customer through remediation while maintaining security protocols.",reasoning:[{step:"Analyze specific KYC failure points to provide targeted guidance",confidence:.93},{step:"Generate list of required additional documentation",confidence:.96},{step:"Assess if manual review is required for edge cases",confidence:.89},{step:"Provide clear instructions for resubmission process",confidence:.95}],constraints:["Cannot disclose specific security algorithm details","Must provide reasonable timeline for document resubmission","Customer has maximum 3 attempts for verification","Certain failures require mandatory cooling-off period"],tools:["KYC Failure Analysis Engine","Document Requirements Generator","Customer Guidance System","Resubmission Workflow Manager"],databases:["KYC Requirements Database","Customer Attempt History","Document Standards Repository"],verification:"KYC failure analysis completed. Customer provided with specific guidance for document resubmission.",confidence:.92},alternate2:{objective:"Process loan application denial with appropriate reasoning and alternative product recommendations",thought:"When declining a loan application, I must provide clear rationale while exploring alternative banking products that might serve the customer's needs.",reasoning:[{step:"Generate adverse action notice with specific decline reasons",confidence:.97},{step:"Analyze customer profile for alternative product suitability",confidence:.91},{step:"Recommend credit improvement strategies and timeline",confidence:.88},{step:"Suggest appropriate banking products or services",confidence:.93}],constraints:["Must comply with Fair Credit Reporting Act requirements","Decline reasons must be specific and actionable","Cannot recommend products outside customer's qualification criteria","Must provide credit report information as required by law"],tools:["Adverse Action Notice Generator","Alternative Product Matching Engine","Credit Improvement Advisor","Regulatory Compliance Validator"],databases:["Product Eligibility Database","Credit Improvement Programs","Regulatory Templates","Customer Product History"],verification:"Loan declined with proper adverse action notice. Customer provided with alternative product recommendations and improvement pathway.",confidence:.94},"corporate-credit":{objective:"Evaluate corporate credit application considering business financials, industry risk, and market conditions",thought:"Corporate credit assessment requires analysis of complex financial statements, industry dynamics, and macroeconomic factors affecting business viability.",reasoning:[{step:"Analyze audited financial statements and cash flow projections",confidence:.94},{step:"Evaluate industry sector risk and competitive positioning",confidence:.89},{step:"Assess management team experience and track record",confidence:.87},{step:"Review existing banking relationships and payment history",confidence:.93},{step:"Calculate debt service coverage and leverage ratios",confidence:.96}],constraints:["Minimum debt service coverage ratio of 1.35x required","Maximum leverage ratio of 4.0x for most industries","Must have 3 years of audited financial statements","Industry concentration limits apply"],tools:["Financial Statement Analyzer","Industry Risk Assessment Tool","Management Evaluation Framework","Credit Rating Model","Covenant Monitoring System"],databases:["Corporate Financial Database","Industry Risk Metrics","Management Database","Market Intelligence"],verification:"Corporate credit analysis completed. Company shows strong financial metrics with DSCR of 1.8x and leverage of 2.3x.",confidence:.91},"portfolio-optimization":{objective:"Optimize investment portfolio allocation based on client risk profile, investment objectives, and market outlook",thought:"Portfolio optimization requires balancing risk-return objectives while considering client constraints, tax implications, and current market conditions.",reasoning:[{step:"Analyze client risk tolerance questionnaire and investment objectives",confidence:.93},{step:"Review current portfolio allocation and performance attribution",confidence:.95},{step:"Apply modern portfolio theory with current market assumptions",confidence:.88},{step:"Consider tax implications and harvest loss opportunities",confidence:.91},{step:"Validate recommendations against suitability requirements",confidence:.96}],constraints:["Must align with client's stated risk tolerance","Minimum diversification requirements across asset classes","Consider liquidity needs for next 12 months","Stay within regulatory concentration limits"],tools:["Portfolio Optimization Engine","Risk Analytics Platform","Tax Optimization Calculator","Suitability Assessment Tool","Market Research Database"],databases:["Client Profile Database","Market Data Feeds","Securities Master Database","Tax Rate Tables"],verification:"Portfolio optimization completed with 15% expected return and 12% volatility, meeting client's moderate risk profile.",confidence:.92}},lit=({decisionNodes:e,lineageNodes:t,lineageEdges:r,decisionPathMetadata:i,dataLineageMetadata:a,selectedNode:l,onNodeClick:d})=>{const s=p=>{console.log("Node clicked in GraphVisualizer:",p),d(p)};return n.jsxs(jt,{className:"bg-beam-dark/70 border border-gray-700/30 overflow-hidden",children:[n.jsx(wr,{className:"p-3 border-b border-gray-700/30 flex flex-row items-center justify-between",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ga,{size:16,className:"text-purple-400"}),n.jsx(fr,{className:"text-md font-medium text-white",children:"Agentic Decision Path"})]})}),n.jsx(Ht,{className:"p-0 overflow-hidden",children:n.jsx("div",{className:"h-[550px] relative",style:{background:"radial-gradient(circle at center, rgba(147, 51, 234, 0.15) 0%, rgba(30, 27, 75, 0.05) 70%)"},children:n.jsx(ait,{nodes:e.map(p=>({...p,operations:Vue[p.id]})),metadata:{...i,nodeSize:{width:180,height:68}},onNodeClick:s,selectedNode:l,highlightGuardrails:!0})})})]})},cit=({decisionNodes:e,lineageNodes:t,lineageEdges:r,decisionPathMetadata:i,dataLineageMetadata:a,selectedNode:l,onNodeClick:d})=>{var P;const s=l?oit[l]||[]:[],p=l?Vue[l]||[]:[],x=l&&((P=e.find(F=>F.id===l)||t.find(F=>F.id===l))==null?void 0:P.label)||"Selected Node",w=F=>{if(!F)return;if(console.log(`Attempting to find reasoning output for node: ${F}`),p0[F])return console.log(`Found direct match for node ${F}`),p0[F];if(F==="start")return console.log("Found Network Capex Task node, returning network-capex reasoning"),p0["network-capex"];const L=j(F);if(L&&p0[L])return console.log(`Found match using standardized ID: ${L}`),p0[L];const B=e.find(V=>V.id===F)||t.find(V=>V.id===F);if(B&&B.label&&B.label.toLowerCase().includes("network")&&(B.label.toLowerCase().includes("capex")||B.label.toLowerCase().includes("capacity")))return console.log("Found node with Network Capex label, returning network-capex reasoning"),p0["network-capex"];if(B&&B.content&&B.content.toLowerCase().includes("network")&&(B.content.toLowerCase().includes("capex")||B.content.toLowerCase().includes("capacity")))return console.log("Found node with Network Capex content, returning network-capex reasoning"),p0["network-capex"];console.log(`No reasoning output found for node ${F}`)},j=F=>{if(!F)return null;let L="",B="";if(F.includes("-"))return F;if(F.startsWith("decision"))L="decision",B=F.replace("decision","");else if(F.startsWith("tool"))L="tool",B=F.replace("tool","");else if(F.startsWith("alternate"))L="alternate",B=F.replace("alternate","");else return F;return`${L}-${B}`},S=l?w(l):void 0;return console.log("Selected node:",l),console.log("Node label:",x),console.log("Has reasoning output:",S?"Yes":"No"),S&&console.log("Reasoning objective:",S.objective),n.jsxs("div",{className:"space-y-4",children:[n.jsx(lit,{decisionNodes:e,lineageNodes:t,lineageEdges:r,decisionPathMetadata:i,dataLineageMetadata:a,selectedNode:l,onNodeClick:d}),l&&n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[n.jsx(Bnt,{selectedNode:l,decisionNodes:e,lineageNodes:t,selectedNodeMessages:s,reasoningOutput:S}),n.jsx(VZ,{messages:s,selectedNodeId:l,nodeName:x,operations:p})]}),!l&&n.jsx(VZ,{messages:[],selectedNodeId:null})]})},uit=({decisionNodes:e,lineageNodes:t,lineageEdges:r,decisionPathMetadata:i,dataLineageMetadata:a,selectedNode:l,onNodeClick:d,projectName:s="Untitled Project",agents:p=[]})=>{const[x,w]=U.useState("overview"),j=p.length||1,S=e.filter(G=>G.type==="alternate"),P=e.filter(G=>G.type==="tool"),F=P.reduce((G,W)=>{var Z,se;return G+(((se=(Z=W.toolDetails)==null?void 0:Z.databases)==null?void 0:se.length)||0)},0);return n.jsx("div",{className:"space-y-6",children:n.jsxs(jt,{className:"shadow-lg border-gray-800/30 bg-gradient-to-br from-beam-dark-accent/70 to-beam-dark-accent/40 backdrop-blur-md",children:[n.jsx(wr,{className:"pb-2",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"p-2 rounded-lg bg-gradient-to-r from-blue-500/30 to-indigo-500/30 border border-blue-500/20",children:n.jsx(ga,{size:20,className:"text-blue-400"})}),n.jsxs("div",{children:[n.jsxs(fr,{className:"text-xl font-medium text-white",children:[s,": Agent Decision Traceability"]}),n.jsx(Ii,{className:"text-gray-300",children:"Visualize and analyze the reasoning process and guardrail activations"})]})]})}),n.jsx(Ht,{children:n.jsxs($i,{defaultValue:"overview",value:x,onValueChange:w,className:"w-full",children:[n.jsxs(Di,{className:"grid grid-cols-2 mb-6 bg-beam-dark/70 border border-gray-700/50 rounded-xl p-1 gap-1",children:[n.jsxs(Jt,{value:"overview",className:"rounded-lg flex items-center gap-2 data-[state=active]:bg-gradient-to-r data-[state=active]:from-blue-600 data-[state=active]:to-indigo-600 data-[state=active]:text-white data-[state=active]:shadow-md",children:[n.jsx(f_,{size:16}),n.jsx("span",{className:"font-medium",children:"Overview"})]}),n.jsxs(Jt,{value:"graph",className:"rounded-lg flex items-center gap-2 data-[state=active]:bg-gradient-to-r data-[state=active]:from-blue-600 data-[state=active]:to-indigo-600 data-[state=active]:text-white data-[state=active]:shadow-md",children:[n.jsx(ga,{size:16}),n.jsx("span",{className:"font-medium",children:"Agentic Decision Path"})]})]}),n.jsx(ur,{value:"overview",className:"mt-0",children:n.jsx(Fnt,{totalAgents:j,toolNodes:P,guardrailNodes:S,databaseAccesses:F,deniedToolAccesses:2,deniedDatabaseAccesses:3,averageDecisionTime:"1.8s",totalTaskTime:"12.4s",onNodeClick:d})}),n.jsx(ur,{value:"graph",className:"mt-0",children:n.jsx(cit,{decisionNodes:e,lineageNodes:t,lineageEdges:r,decisionPathMetadata:i,dataLineageMetadata:a,selectedNode:l,onNodeClick:d})})]})})]})})},t_=Yrt,Uue=U.createContext({}),Li=({...e})=>n.jsx(Uue.Provider,{value:{name:e.name},children:n.jsx(ent,{...e})}),_3=()=>{const e=U.useContext(Uue),t=U.useContext(Gue),{getFieldState:r,formState:i}=y3(),a=r(e.name,i);if(!e)throw new Error("useFormField should be used within <FormField>");const{id:l}=t;return{id:l,name:e.name,formItemId:`${l}-form-item`,formDescriptionId:`${l}-form-item-description`,formMessageId:`${l}-form-item-message`,...a}},Gue=U.createContext({}),Ei=U.forwardRef(({className:e,...t},r)=>{const i=U.useId();return n.jsx(Gue.Provider,{value:{id:i},children:n.jsx("div",{ref:r,className:Yt("space-y-2",e),...t})})});Ei.displayName="FormItem";const Mi=U.forwardRef(({className:e,...t},r)=>{const{error:i,formItemId:a}=_3();return n.jsx(mr,{ref:r,className:Yt(i&&"text-destructive",e),htmlFor:a,...t})});Mi.displayName="FormLabel";const Fi=U.forwardRef(({...e},t)=>{const{error:r,formItemId:i,formDescriptionId:a,formMessageId:l}=_3();return n.jsx(Al,{ref:t,id:i,"aria-describedby":r?`${a} ${l}`:`${a}`,"aria-invalid":!!r,...e})});Fi.displayName="FormControl";const Wl=U.forwardRef(({className:e,...t},r)=>{const{formDescriptionId:i}=_3();return n.jsx("p",{ref:r,id:i,className:Yt("text-sm text-muted-foreground",e),...t})});Wl.displayName="FormDescription";const Xf=U.forwardRef(({className:e,children:t,...r},i)=>{const{error:a,formMessageId:l}=_3(),d=a?String(a==null?void 0:a.message):t;return d?n.jsx("p",{ref:i,id:l,className:Yt("text-sm font-medium text-destructive",e),...r,children:d}):null});Xf.displayName="FormMessage";function dit(e,t=[]){let r=[];function i(l,d){const s=U.createContext(d),p=r.length;r=[...r,d];function x(j){const{scope:S,children:P,...F}=j,L=(S==null?void 0:S[e][p])||s,B=U.useMemo(()=>F,Object.values(F));return n.jsx(L.Provider,{value:B,children:P})}function w(j,S){const P=(S==null?void 0:S[e][p])||s,F=U.useContext(P);if(F)return F;if(d!==void 0)return d;throw new Error(`\`${j}\` must be used within \`${l}\``)}return x.displayName=l+"Provider",[x,w]}const a=()=>{const l=r.map(d=>U.createContext(d));return function(s){const p=(s==null?void 0:s[e])||l;return U.useMemo(()=>({[`__scope${e}`]:{...s,[e]:p}}),[s,p])}};return a.scopeName=e,[i,hit(a,...t)]}function hit(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const i=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(l){const d=i.reduce((s,{useScope:p,scopeName:x})=>{const j=p(l)[`__scope${x}`];return{...s,...j}},{});return U.useMemo(()=>({[`__scope${t.scopeName}`]:d}),[d])}};return r.scopeName=t.scopeName,r}var mit="Toggle",m$=U.forwardRef((e,t)=>{const{pressed:r,defaultPressed:i=!1,onPressedChange:a,...l}=e,[d=!1,s]=fo({prop:r,onChange:a,defaultProp:i});return n.jsx(Hr.button,{type:"button","aria-pressed":d,"data-state":d?"on":"off","data-disabled":e.disabled?"":void 0,...l,ref:t,onClick:_r(e.onClick,()=>{e.disabled||s(!d)})})});m$.displayName=mit;var Hue=m$,$_="ToggleGroup",[que,fft]=dit($_,[__]),Wue=__(),f$=ke.forwardRef((e,t)=>{const{type:r,...i}=e;if(r==="single"){const a=i;return n.jsx(fit,{...a,ref:t})}if(r==="multiple"){const a=i;return n.jsx(pit,{...a,ref:t})}throw new Error(`Missing prop \`type\` expected on \`${$_}\``)});f$.displayName=$_;var[Kue,Zue]=que($_),fit=ke.forwardRef((e,t)=>{const{value:r,defaultValue:i,onValueChange:a=()=>{},...l}=e,[d,s]=fo({prop:r,defaultProp:i,onChange:a});return n.jsx(Kue,{scope:e.__scopeToggleGroup,type:"single",value:d?[d]:[],onItemActivate:s,onItemDeactivate:ke.useCallback(()=>s(""),[s]),children:n.jsx(Yue,{...l,ref:t})})}),pit=ke.forwardRef((e,t)=>{const{value:r,defaultValue:i,onValueChange:a=()=>{},...l}=e,[d=[],s]=fo({prop:r,defaultProp:i,onChange:a}),p=ke.useCallback(w=>s((j=[])=>[...j,w]),[s]),x=ke.useCallback(w=>s((j=[])=>j.filter(S=>S!==w)),[s]);return n.jsx(Kue,{scope:e.__scopeToggleGroup,type:"multiple",value:d,onItemActivate:p,onItemDeactivate:x,children:n.jsx(Yue,{...l,ref:t})})});f$.displayName=$_;var[git,xit]=que($_),Yue=ke.forwardRef((e,t)=>{const{__scopeToggleGroup:r,disabled:i=!1,rovingFocus:a=!0,orientation:l,dir:d,loop:s=!0,...p}=e,x=Wue(r),w=sg(d),j={role:"group",dir:w,...p};return n.jsx(git,{scope:r,rovingFocus:a,disabled:i,children:a?n.jsx(oB,{asChild:!0,...x,orientation:l,dir:w,loop:s,children:n.jsx(Hr.div,{...j,ref:t})}):n.jsx(Hr.div,{...j,ref:t})})}),HP="ToggleGroupItem",Xue=ke.forwardRef((e,t)=>{const r=Zue(HP,e.__scopeToggleGroup),i=xit(HP,e.__scopeToggleGroup),a=Wue(e.__scopeToggleGroup),l=r.value.includes(e.value),d=i.disabled||e.disabled,s={...e,pressed:l,disabled:d},p=ke.useRef(null);return i.rovingFocus?n.jsx(lB,{asChild:!0,...a,focusable:!d,active:l,ref:p,children:n.jsx(UZ,{...s,ref:t})}):n.jsx(UZ,{...s,ref:t})});Xue.displayName=HP;var UZ=ke.forwardRef((e,t)=>{const{__scopeToggleGroup:r,value:i,...a}=e,l=Zue(HP,r),d={role:"radio","aria-checked":e.pressed,"aria-pressed":void 0},s=l.type==="single"?d:void 0;return n.jsx(m$,{...s,...a,ref:t,onPressedChange:p=>{p?l.onItemActivate(i):l.onItemDeactivate(i)}})}),Jue=f$,Que=Xue;const ede=rg("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground",{variants:{variant:{default:"bg-transparent",outline:"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground"},size:{default:"h-10 px-3",sm:"h-9 px-2.5",lg:"h-11 px-5"}},defaultVariants:{variant:"default",size:"default"}}),yit=U.forwardRef(({className:e,variant:t,size:r,...i},a)=>n.jsx(Hue,{ref:a,className:Yt(ede({variant:t,size:r,className:e})),...i}));yit.displayName=Hue.displayName;const tde=U.createContext({size:"default",variant:"default"}),rde=U.forwardRef(({className:e,variant:t,size:r,children:i,...a},l)=>n.jsx(Jue,{ref:l,className:Yt("flex items-center justify-center gap-1",e),...a,children:n.jsx(tde.Provider,{value:{variant:t,size:r},children:i})}));rde.displayName=Jue.displayName;const hL=U.forwardRef(({className:e,children:t,variant:r,size:i,...a},l)=>{const d=U.useContext(tde);return n.jsx(Que,{ref:l,className:Yt(ede({variant:d.variant||r,size:d.size||i}),e),...a,children:t})});hL.displayName=Que.displayName;const Jy=[{id:"ai-agents",name:"AI Agent Tools",icon:Hi},{id:"code",name:"Code & Development",icon:Bc},{id:"data",name:"Data Processing",icon:ln},{id:"network",name:"Network Management",icon:ga},{id:"customer",name:"Customer Operations",icon:Vp},{id:"infrastructure",name:"Infrastructure",icon:UQ},{id:"analytics",name:"Analytics & Insights",icon:Co},{id:"integration",name:"Integration",icon:CT},{id:"service",name:"Service Monitoring",icon:LD}],vit=({industry:e="banking"})=>{const[t,r]=U.useState("category"),[i,a]=U.useState(null),[l,d]=U.useState(()=>e==="telco"?[{id:"code-interpreter",name:"Code Interpreter",description:"Execute and analyze code across various programming languages",category:"ai-agents",icon:GD},{id:"reasoning-engine",name:"Reasoning Engine",description:"Advanced reasoning capabilities for complex problem-solving",category:"ai-agents",icon:ti},{id:"knowledge-graph",name:"Knowledge Graph Navigator",description:"Navigate and query complex knowledge relationships",category:"ai-agents",icon:VD},{id:"memory-management",name:"Agent Memory System",description:"Long and short-term memory management for AI agents",category:"ai-agents",icon:ln},{id:"network-analyzer",name:"Network Performance Analyzer",description:"Monitor and optimize network performance across nodes",category:"network",icon:ga},{id:"spectrum-analyzer",name:"Spectrum Analyzer",description:"Analyze frequency spectrum usage and interference",category:"network",icon:LD},{id:"customer-insights",name:"Customer Experience Insights",description:"Analyze customer journey and experience metrics",category:"customer",icon:Vp},{id:"tower-monitor",name:"Cell Tower Monitoring System",description:"Real-time monitoring of cell tower operations",category:"infrastructure",icon:UQ},{id:"traffic-analysis",name:"Network Traffic Analysis",description:"Deep packet inspection and traffic pattern analysis",category:"analytics",icon:Co},{id:"predictive-maintenance",name:"Infrastructure Predictive Maintenance",description:"AI-driven predictions for telecom infrastructure maintenance",category:"analytics",icon:Co},{id:"api-gateway",name:"Telecom API Gateway",description:"Centralized API management for telecom service integrations",category:"integration",icon:CT},{id:"service-health",name:"Service Health Dashboard",description:"Monitor telecom service availability and health metrics",category:"service",icon:LD},{id:"billing-engine",name:"Usage-Based Billing Engine",description:"Real-time billing calculations based on network usage",category:"customer",icon:Vp},{id:"fraud-detection",name:"Telecom Fraud Detection",description:"Detect and prevent telecom fraud and revenue leakage",category:"analytics",icon:Co}]:[{id:"code-interpreter",name:"Code Interpreter",description:"Execute and analyze code across various programming languages",category:"ai-agents",icon:GD},{id:"reasoning-engine",name:"Reasoning Engine",description:"Advanced reasoning capabilities for complex problem-solving",category:"ai-agents",icon:ti},{id:"knowledge-graph",name:"Knowledge Graph Navigator",description:"Navigate and query complex knowledge relationships",category:"ai-agents",icon:VD},{id:"memory-management",name:"Agent Memory System",description:"Long and short-term memory management for AI agents",category:"ai-agents",icon:ln},{id:"kyc-processor",name:"KYC Document Processor",description:"Automated Know Your Customer document verification",category:"data",icon:ln},{id:"fraud-detection",name:"Banking Fraud Detection",description:"Real-time fraud detection for banking transactions",category:"analytics",icon:Co},{id:"credit-scorer",name:"Credit Risk Scorer",description:"AI-powered credit risk assessment and scoring",category:"analytics",icon:Co},{id:"compliance-checker",name:"Regulatory Compliance Checker",description:"Automated compliance verification for banking regulations",category:"integration",icon:CT},{id:"transaction-analyzer",name:"Transaction Pattern Analyzer",description:"Analyze customer transaction patterns and behaviors",category:"data",icon:ln},{id:"loan-processor",name:"Loan Application Processor",description:"Automated loan application processing and evaluation",category:"data",icon:ln},{id:"api-gateway",name:"Banking API Gateway",description:"Centralized API management for banking service integrations",category:"integration",icon:CT},{id:"customer-insights",name:"Customer Financial Insights",description:"Analyze customer financial behavior and preferences",category:"analytics",icon:Co}]),s=hx({defaultValues:{name:"",description:"",category:""}}),p=w=>{var S;const j={id:`tool-${Date.now()}`,name:w.name,description:w.description,category:w.category,icon:((S=Jy.find(P=>P.id===w.category))==null?void 0:S.icon)||Vc};d([...l,j]),Ls.success("Tool added successfully!"),s.reset()},x=i?l.filter(w=>w.category===i):l;return n.jsxs("div",{className:"glass-panel p-6 backdrop-blur-md bg-beam-dark-accent/30 border border-gray-700/50 rounded-xl shadow-lg",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"p-2 rounded-lg bg-blue-500/20 border border-blue-500/30",children:n.jsx(Hi,{size:20,className:"text-blue-400"})}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl font-medium text-white",children:"Agent Tools"}),n.jsxs("p",{className:"text-gray-300 text-sm",children:["Specialized tools for AI agents and ",e==="telco"?"telecom operations":"banking operations"]})]})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs(rde,{type:"single",value:t,onValueChange:w=>w&&r(w),children:[n.jsx(hL,{value:"category","aria-label":"View by category",className:"bg-beam-dark-accent border border-gray-700 text-white hover:bg-gray-700",children:n.jsx(lve,{size:16})}),n.jsx(hL,{value:"grid","aria-label":"View as grid",className:"bg-beam-dark-accent border border-gray-700 text-white hover:bg-gray-700",children:n.jsx(uve,{size:16})})]}),n.jsxs(Ml,{children:[n.jsx(F_,{asChild:!0,children:n.jsxs(lt,{className:"bg-beam-blue hover:bg-blue-600",children:[n.jsx(Mo,{size:16,className:"mr-2"}),"Add Tool"]})}),n.jsxs(Qo,{className:"bg-beam-dark-accent border-gray-700 text-white",children:[n.jsxs(el,{children:[n.jsxs(tl,{children:["Add New ",e==="telco"?"Telecom":"Banking"," Tool"]}),n.jsxs(fg,{className:"text-gray-400",children:["Add a new tool for your agent to use in ",e==="telco"?"telecom":"banking"," operations."]})]}),n.jsx(t_,{...s,children:n.jsxs("form",{onSubmit:s.handleSubmit(p),className:"space-y-4",children:[n.jsx(Li,{control:s.control,name:"name",render:({field:w})=>n.jsxs(Ei,{children:[n.jsx(Mi,{children:"Tool Name"}),n.jsx(Fi,{children:n.jsx(An,{placeholder:"Network Traffic Analyzer",className:"bg-beam-dark border-gray-700",...w})})]})}),n.jsx(Li,{control:s.control,name:"description",render:({field:w})=>n.jsxs(Ei,{children:[n.jsx(Mi,{children:"Description"}),n.jsx(Fi,{children:n.jsx(An,{placeholder:"Analyzes network traffic patterns",className:"bg-beam-dark border-gray-700",...w})})]})}),n.jsx(Li,{control:s.control,name:"category",render:({field:w})=>n.jsxs(Ei,{children:[n.jsx(Mi,{children:"Category"}),n.jsxs(_n,{onValueChange:w.onChange,defaultValue:w.value,children:[n.jsx(Fi,{children:n.jsx(xn,{className:"bg-beam-dark border-gray-700",children:n.jsx(wn,{placeholder:"Select category"})})}),n.jsx(yn,{className:"bg-beam-dark border-gray-700",children:Jy.map(j=>n.jsx(yt,{value:j.id,children:j.name},j.id))})]})]})}),n.jsx(mg,{children:n.jsx(lt,{type:"submit",className:"bg-beam-blue hover:bg-blue-600",children:"Add Tool"})})]})})]})]})]})]}),t==="category"&&n.jsxs("div",{className:"flex flex-col md:flex-row gap-6",children:[n.jsxs("div",{className:"w-full md:w-64 bg-beam-dark-accent/50 rounded-lg border border-gray-700/50 p-4",children:[n.jsx("h3",{className:"text-white font-medium mb-3",children:"Categories"}),n.jsxs("div",{className:"space-y-1",children:[n.jsxs("button",{className:`w-full text-left px-3 py-2 rounded-md flex items-center gap-2 ${i===null?"bg-blue-500/20 text-blue-300":"text-gray-300 hover:bg-gray-700/50"}`,onClick:()=>a(null),children:[n.jsx(Vc,{size:16,className:"text-blue-400"}),n.jsx("span",{children:"All Tools"})]}),Jy.map(w=>{const j=w.icon,S=l.filter(P=>P.category===w.id).length;return S===0?null:n.jsxs("button",{className:`w-full text-left px-3 py-2 rounded-md flex items-center gap-2 ${i===w.id?"bg-blue-500/20 text-blue-300":"text-gray-300 hover:bg-gray-700/50"}`,onClick:()=>a(w.id),children:[n.jsx(j,{size:16,className:"text-blue-400"}),n.jsx("span",{children:w.name}),n.jsx("span",{className:"ml-auto text-xs bg-gray-700 text-gray-300 px-2 py-0.5 rounded-full",children:S})]},w.id)})]})]}),n.jsx("div",{className:"flex-1",children:n.jsx(Cl,{className:"h-[calc(100vh-300px)]",children:n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 pr-4",children:x.map(w=>{const j=w.icon,S=Jy.find(P=>P.id===w.category);return n.jsxs(jt,{className:"bg-gradient-to-br from-beam-dark-accent/50 to-beam-dark-accent/20 border border-gray-700/40 group hover:border-blue-500/50 transition-all duration-300 cursor-pointer shadow-sm hover:shadow-[0_0_15px_rgba(59,130,246,0.15)]",children:[n.jsx(wr,{className:"pb-2",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 rounded-xl bg-blue-500/10 flex items-center justify-center border border-blue-500/20 group-hover:bg-blue-500/20 transition-all duration-300",children:n.jsx(j,{size:20,className:"text-blue-300"})}),n.jsx(fr,{className:"text-white text-base",children:w.name})]})}),n.jsxs(Ht,{children:[n.jsx("p",{className:"text-sm text-gray-300 mb-2",children:w.description}),S&&n.jsx("div",{className:"flex items-center mt-2",children:n.jsxs("span",{className:"text-xs px-2 py-0.5 bg-blue-500/10 border border-blue-500/20 rounded-full text-blue-300 flex items-center gap-1",children:[ke.createElement(S.icon,{size:12,className:"text-blue-300"}),S.name]})})]})]},w.id)})})})})]}),t==="grid"&&n.jsx("div",{children:n.jsxs($i,{defaultValue:"all",className:"w-full",children:[n.jsxs(Di,{className:"mb-6 bg-beam-dark-accent/40 border border-gray-700/50 rounded-xl p-1 gap-1",children:[n.jsx(Jt,{value:"all",className:"rounded-lg data-[state=active]:bg-beam-blue data-[state=active]:text-white data-[state=active]:shadow-md",children:"All Tools"}),Jy.map(w=>l.filter(S=>S.category===w.id).length===0?null:n.jsx(Jt,{value:w.id,className:"rounded-lg data-[state=active]:bg-beam-blue data-[state=active]:text-white data-[state=active]:shadow-md",children:w.name},w.id))]}),n.jsx(ur,{value:"all",className:"mt-0",children:n.jsx(Cl,{className:"h-[calc(100vh-300px)]",children:n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-4 pr-4",children:l.map(w=>{const j=w.icon;return n.jsx(jt,{className:"bg-gradient-to-br from-beam-dark-accent/50 to-beam-dark-accent/20 border border-gray-700/40 group hover:border-blue-500/50 transition-all duration-300 cursor-pointer shadow-sm hover:shadow-[0_0_15px_rgba(59,130,246,0.15)]",children:n.jsx(Ht,{className:"p-4",children:n.jsxs("div",{className:"flex flex-col items-center text-center gap-3",children:[n.jsx("div",{className:"w-12 h-12 rounded-xl bg-blue-500/10 flex items-center justify-center border border-blue-500/20 group-hover:bg-blue-500/20 transition-all duration-300",children:n.jsx(j,{size:24,className:"text-blue-300"})}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-white font-medium",children:w.name}),n.jsx("p",{className:"text-xs text-gray-300 mt-1",children:w.description})]})]})})},w.id)})})})}),Jy.map(w=>{const j=l.filter(S=>S.category===w.id);return j.length===0?null:n.jsx(ur,{value:w.id,className:"mt-0",children:n.jsx(Cl,{className:"h-[calc(100vh-300px)]",children:n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-4 pr-4",children:j.map(S=>{const P=S.icon;return n.jsx(jt,{className:"bg-gradient-to-br from-beam-dark-accent/50 to-beam-dark-accent/20 border border-gray-700/40 group hover:border-blue-500/50 transition-all duration-300 cursor-pointer shadow-sm hover:shadow-[0_0_15px_rgba(59,130,246,0.15)]",children:n.jsx(Ht,{className:"p-4",children:n.jsxs("div",{className:"flex flex-col items-center text-center gap-3",children:[n.jsx("div",{className:"w-12 h-12 rounded-xl bg-blue-500/10 flex items-center justify-center border border-blue-500/20 group-hover:bg-blue-500/20 transition-all duration-300",children:n.jsx(P,{size:24,className:"text-blue-300"})}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-white font-medium",children:S.name}),n.jsx("p",{className:"text-xs text-gray-300 mt-1",children:S.description})]})]})})},S.id)})})})},w.id)})]})})]})};var Oi;(function(e){e.assertEqual=a=>a;function t(a){}e.assertIs=t;function r(a){throw new Error}e.assertNever=r,e.arrayToEnum=a=>{const l={};for(const d of a)l[d]=d;return l},e.getValidEnumValues=a=>{const l=e.objectKeys(a).filter(s=>typeof a[a[s]]!="number"),d={};for(const s of l)d[s]=a[s];return e.objectValues(d)},e.objectValues=a=>e.objectKeys(a).map(function(l){return a[l]}),e.objectKeys=typeof Object.keys=="function"?a=>Object.keys(a):a=>{const l=[];for(const d in a)Object.prototype.hasOwnProperty.call(a,d)&&l.push(d);return l},e.find=(a,l)=>{for(const d of a)if(l(d))return d},e.isInteger=typeof Number.isInteger=="function"?a=>Number.isInteger(a):a=>typeof a=="number"&&isFinite(a)&&Math.floor(a)===a;function i(a,l=" | "){return a.map(d=>typeof d=="string"?`'${d}'`:d).join(l)}e.joinValues=i,e.jsonStringifyReplacer=(a,l)=>typeof l=="bigint"?l.toString():l})(Oi||(Oi={}));var mL;(function(e){e.mergeShapes=(t,r)=>({...t,...r})})(mL||(mL={}));const Xr=Oi.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),dp=e=>{switch(typeof e){case"undefined":return Xr.undefined;case"string":return Xr.string;case"number":return isNaN(e)?Xr.nan:Xr.number;case"boolean":return Xr.boolean;case"function":return Xr.function;case"bigint":return Xr.bigint;case"symbol":return Xr.symbol;case"object":return Array.isArray(e)?Xr.array:e===null?Xr.null:e.then&&typeof e.then=="function"&&e.catch&&typeof e.catch=="function"?Xr.promise:typeof Map<"u"&&e instanceof Map?Xr.map:typeof Set<"u"&&e instanceof Set?Xr.set:typeof Date<"u"&&e instanceof Date?Xr.date:Xr.object;default:return Xr.unknown}},Ar=Oi.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),bit=e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:");class Lc extends Error{constructor(t){super(),this.issues=[],this.addIssue=i=>{this.issues=[...this.issues,i]},this.addIssues=(i=[])=>{this.issues=[...this.issues,...i]};const r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=t}get errors(){return this.issues}format(t){const r=t||function(l){return l.message},i={_errors:[]},a=l=>{for(const d of l.issues)if(d.code==="invalid_union")d.unionErrors.map(a);else if(d.code==="invalid_return_type")a(d.returnTypeError);else if(d.code==="invalid_arguments")a(d.argumentsError);else if(d.path.length===0)i._errors.push(r(d));else{let s=i,p=0;for(;p<d.path.length;){const x=d.path[p];p===d.path.length-1?(s[x]=s[x]||{_errors:[]},s[x]._errors.push(r(d))):s[x]=s[x]||{_errors:[]},s=s[x],p++}}};return a(this),i}static assert(t){if(!(t instanceof Lc))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Oi.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=r=>r.message){const r={},i=[];for(const a of this.issues)a.path.length>0?(r[a.path[0]]=r[a.path[0]]||[],r[a.path[0]].push(t(a))):i.push(t(a));return{formErrors:i,fieldErrors:r}}get formErrors(){return this.flatten()}}Lc.create=e=>new Lc(e);const r_=(e,t)=>{let r;switch(e.code){case Ar.invalid_type:e.received===Xr.undefined?r="Required":r=`Expected ${e.expected}, received ${e.received}`;break;case Ar.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(e.expected,Oi.jsonStringifyReplacer)}`;break;case Ar.unrecognized_keys:r=`Unrecognized key(s) in object: ${Oi.joinValues(e.keys,", ")}`;break;case Ar.invalid_union:r="Invalid input";break;case Ar.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${Oi.joinValues(e.options)}`;break;case Ar.invalid_enum_value:r=`Invalid enum value. Expected ${Oi.joinValues(e.options)}, received '${e.received}'`;break;case Ar.invalid_arguments:r="Invalid function arguments";break;case Ar.invalid_return_type:r="Invalid function return type";break;case Ar.invalid_date:r="Invalid date";break;case Ar.invalid_string:typeof e.validation=="object"?"includes"in e.validation?(r=`Invalid input: must include "${e.validation.includes}"`,typeof e.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?r=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?r=`Invalid input: must end with "${e.validation.endsWith}"`:Oi.assertNever(e.validation):e.validation!=="regex"?r=`Invalid ${e.validation}`:r="Invalid";break;case Ar.too_small:e.type==="array"?r=`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:e.type==="string"?r=`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:e.type==="number"?r=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="date"?r=`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:r="Invalid input";break;case Ar.too_big:e.type==="array"?r=`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:e.type==="string"?r=`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:e.type==="number"?r=`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="bigint"?r=`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="date"?r=`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:r="Invalid input";break;case Ar.custom:r="Invalid input";break;case Ar.invalid_intersection_types:r="Intersection results could not be merged";break;case Ar.not_multiple_of:r=`Number must be a multiple of ${e.multipleOf}`;break;case Ar.not_finite:r="Number must be finite";break;default:r=t.defaultError,Oi.assertNever(e)}return{message:r}};let nde=r_;function _it(e){nde=e}function qP(){return nde}const WP=e=>{const{data:t,path:r,errorMaps:i,issueData:a}=e,l=[...r,...a.path||[]],d={...a,path:l};if(a.message!==void 0)return{...a,path:l,message:a.message};let s="";const p=i.filter(x=>!!x).slice().reverse();for(const x of p)s=x(d,{data:t,defaultError:s}).message;return{...a,path:l,message:s}},wit=[];function Wr(e,t){const r=qP(),i=WP({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,r,r===r_?void 0:r_].filter(a=>!!a)});e.common.issues.push(i)}class Xo{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,r){const i=[];for(const a of r){if(a.status==="aborted")return qn;a.status==="dirty"&&t.dirty(),i.push(a.value)}return{status:t.value,value:i}}static async mergeObjectAsync(t,r){const i=[];for(const a of r){const l=await a.key,d=await a.value;i.push({key:l,value:d})}return Xo.mergeObjectSync(t,i)}static mergeObjectSync(t,r){const i={};for(const a of r){const{key:l,value:d}=a;if(l.status==="aborted"||d.status==="aborted")return qn;l.status==="dirty"&&t.dirty(),d.status==="dirty"&&t.dirty(),l.value!=="__proto__"&&(typeof d.value<"u"||a.alwaysSet)&&(i[l.value]=d.value)}return{status:t.value,value:i}}}const qn=Object.freeze({status:"aborted"}),Av=e=>({status:"dirty",value:e}),Tl=e=>({status:"valid",value:e}),fL=e=>e.status==="aborted",pL=e=>e.status==="dirty",gN=e=>e.status==="valid",xN=e=>typeof Promise<"u"&&e instanceof Promise;function KP(e,t,r,i){if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t.get(e)}function ide(e,t,r,i,a){if(typeof t=="function"?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return t.set(e,r),r}var gn;(function(e){e.errToObj=t=>typeof t=="string"?{message:t}:t||{},e.toString=t=>typeof t=="string"?t:t==null?void 0:t.message})(gn||(gn={}));var wj,jj;class _h{constructor(t,r,i,a){this._cachedPath=[],this.parent=t,this.data=r,this._path=i,this._key=a}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const GZ=(e,t)=>{if(gN(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const r=new Lc(e.common.issues);return this._error=r,this._error}}};function ei(e){if(!e)return{};const{errorMap:t,invalid_type_error:r,required_error:i,description:a}=e;if(t&&(r||i))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:a}:{errorMap:(d,s)=>{var p,x;const{message:w}=e;return d.code==="invalid_enum_value"?{message:w??s.defaultError}:typeof s.data>"u"?{message:(p=w??i)!==null&&p!==void 0?p:s.defaultError}:d.code!=="invalid_type"?{message:s.defaultError}:{message:(x=w??r)!==null&&x!==void 0?x:s.defaultError}},description:a}}class ui{constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(t){return dp(t.data)}_getOrReturnCtx(t,r){return r||{common:t.parent.common,data:t.data,parsedType:dp(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new Xo,ctx:{common:t.parent.common,data:t.data,parsedType:dp(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){const r=this._parse(t);if(xN(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(t){const r=this._parse(t);return Promise.resolve(r)}parse(t,r){const i=this.safeParse(t,r);if(i.success)return i.data;throw i.error}safeParse(t,r){var i;const a={common:{issues:[],async:(i=r==null?void 0:r.async)!==null&&i!==void 0?i:!1,contextualErrorMap:r==null?void 0:r.errorMap},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:dp(t)},l=this._parseSync({data:t,path:a.path,parent:a});return GZ(a,l)}async parseAsync(t,r){const i=await this.safeParseAsync(t,r);if(i.success)return i.data;throw i.error}async safeParseAsync(t,r){const i={common:{issues:[],contextualErrorMap:r==null?void 0:r.errorMap,async:!0},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:dp(t)},a=this._parse({data:t,path:i.path,parent:i}),l=await(xN(a)?a:Promise.resolve(a));return GZ(i,l)}refine(t,r){const i=a=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(a):r;return this._refinement((a,l)=>{const d=t(a),s=()=>l.addIssue({code:Ar.custom,...i(a)});return typeof Promise<"u"&&d instanceof Promise?d.then(p=>p?!0:(s(),!1)):d?!0:(s(),!1)})}refinement(t,r){return this._refinement((i,a)=>t(i)?!0:(a.addIssue(typeof r=="function"?r(i,a):r),!1))}_refinement(t){return new Nd({schema:this,typeName:Dn.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}optional(){return gh.create(this,this._def)}nullable(){return Xp.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return yd.create(this,this._def)}promise(){return i_.create(this,this._def)}or(t){return _N.create([this,t],this._def)}and(t){return wN.create(this,t,this._def)}transform(t){return new Nd({...ei(this._def),schema:this,typeName:Dn.ZodEffects,effect:{type:"transform",transform:t}})}default(t){const r=typeof t=="function"?t:()=>t;return new AN({...ei(this._def),innerType:this,defaultValue:r,typeName:Dn.ZodDefault})}brand(){return new p$({typeName:Dn.ZodBranded,type:this,...ei(this._def)})}catch(t){const r=typeof t=="function"?t:()=>t;return new TN({...ei(this._def),innerType:this,catchValue:r,typeName:Dn.ZodCatch})}describe(t){const r=this.constructor;return new r({...this._def,description:t})}pipe(t){return bS.create(this,t)}readonly(){return kN.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const jit=/^c[^\s-]{8,}$/i,Nit=/^[0-9a-z]+$/,Sit=/^[0-9A-HJKMNP-TV-Z]{26}$/,Cit=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,Ait=/^[a-z0-9_-]{21}$/i,Tit=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,kit=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,Pit="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let hR;const Eit=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Mit=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,Iit=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,sde="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",Oit=new RegExp(`^${sde}$`);function ade(e){let t="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return e.precision?t=`${t}\\.\\d{${e.precision}}`:e.precision==null&&(t=`${t}(\\.\\d+)?`),t}function Rit(e){return new RegExp(`^${ade(e)}$`)}function ode(e){let t=`${sde}T${ade(e)}`;const r=[];return r.push(e.local?"Z?":"Z"),e.offset&&r.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${r.join("|")})`,new RegExp(`^${t}$`)}function Dit(e,t){return!!((t==="v4"||!t)&&Eit.test(e)||(t==="v6"||!t)&&Mit.test(e))}class fd extends ui{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==Xr.string){const l=this._getOrReturnCtx(t);return Wr(l,{code:Ar.invalid_type,expected:Xr.string,received:l.parsedType}),qn}const i=new Xo;let a;for(const l of this._def.checks)if(l.kind==="min")t.data.length<l.value&&(a=this._getOrReturnCtx(t,a),Wr(a,{code:Ar.too_small,minimum:l.value,type:"string",inclusive:!0,exact:!1,message:l.message}),i.dirty());else if(l.kind==="max")t.data.length>l.value&&(a=this._getOrReturnCtx(t,a),Wr(a,{code:Ar.too_big,maximum:l.value,type:"string",inclusive:!0,exact:!1,message:l.message}),i.dirty());else if(l.kind==="length"){const d=t.data.length>l.value,s=t.data.length<l.value;(d||s)&&(a=this._getOrReturnCtx(t,a),d?Wr(a,{code:Ar.too_big,maximum:l.value,type:"string",inclusive:!0,exact:!0,message:l.message}):s&&Wr(a,{code:Ar.too_small,minimum:l.value,type:"string",inclusive:!0,exact:!0,message:l.message}),i.dirty())}else if(l.kind==="email")kit.test(t.data)||(a=this._getOrReturnCtx(t,a),Wr(a,{validation:"email",code:Ar.invalid_string,message:l.message}),i.dirty());else if(l.kind==="emoji")hR||(hR=new RegExp(Pit,"u")),hR.test(t.data)||(a=this._getOrReturnCtx(t,a),Wr(a,{validation:"emoji",code:Ar.invalid_string,message:l.message}),i.dirty());else if(l.kind==="uuid")Cit.test(t.data)||(a=this._getOrReturnCtx(t,a),Wr(a,{validation:"uuid",code:Ar.invalid_string,message:l.message}),i.dirty());else if(l.kind==="nanoid")Ait.test(t.data)||(a=this._getOrReturnCtx(t,a),Wr(a,{validation:"nanoid",code:Ar.invalid_string,message:l.message}),i.dirty());else if(l.kind==="cuid")jit.test(t.data)||(a=this._getOrReturnCtx(t,a),Wr(a,{validation:"cuid",code:Ar.invalid_string,message:l.message}),i.dirty());else if(l.kind==="cuid2")Nit.test(t.data)||(a=this._getOrReturnCtx(t,a),Wr(a,{validation:"cuid2",code:Ar.invalid_string,message:l.message}),i.dirty());else if(l.kind==="ulid")Sit.test(t.data)||(a=this._getOrReturnCtx(t,a),Wr(a,{validation:"ulid",code:Ar.invalid_string,message:l.message}),i.dirty());else if(l.kind==="url")try{new URL(t.data)}catch{a=this._getOrReturnCtx(t,a),Wr(a,{validation:"url",code:Ar.invalid_string,message:l.message}),i.dirty()}else l.kind==="regex"?(l.regex.lastIndex=0,l.regex.test(t.data)||(a=this._getOrReturnCtx(t,a),Wr(a,{validation:"regex",code:Ar.invalid_string,message:l.message}),i.dirty())):l.kind==="trim"?t.data=t.data.trim():l.kind==="includes"?t.data.includes(l.value,l.position)||(a=this._getOrReturnCtx(t,a),Wr(a,{code:Ar.invalid_string,validation:{includes:l.value,position:l.position},message:l.message}),i.dirty()):l.kind==="toLowerCase"?t.data=t.data.toLowerCase():l.kind==="toUpperCase"?t.data=t.data.toUpperCase():l.kind==="startsWith"?t.data.startsWith(l.value)||(a=this._getOrReturnCtx(t,a),Wr(a,{code:Ar.invalid_string,validation:{startsWith:l.value},message:l.message}),i.dirty()):l.kind==="endsWith"?t.data.endsWith(l.value)||(a=this._getOrReturnCtx(t,a),Wr(a,{code:Ar.invalid_string,validation:{endsWith:l.value},message:l.message}),i.dirty()):l.kind==="datetime"?ode(l).test(t.data)||(a=this._getOrReturnCtx(t,a),Wr(a,{code:Ar.invalid_string,validation:"datetime",message:l.message}),i.dirty()):l.kind==="date"?Oit.test(t.data)||(a=this._getOrReturnCtx(t,a),Wr(a,{code:Ar.invalid_string,validation:"date",message:l.message}),i.dirty()):l.kind==="time"?Rit(l).test(t.data)||(a=this._getOrReturnCtx(t,a),Wr(a,{code:Ar.invalid_string,validation:"time",message:l.message}),i.dirty()):l.kind==="duration"?Tit.test(t.data)||(a=this._getOrReturnCtx(t,a),Wr(a,{validation:"duration",code:Ar.invalid_string,message:l.message}),i.dirty()):l.kind==="ip"?Dit(t.data,l.version)||(a=this._getOrReturnCtx(t,a),Wr(a,{validation:"ip",code:Ar.invalid_string,message:l.message}),i.dirty()):l.kind==="base64"?Iit.test(t.data)||(a=this._getOrReturnCtx(t,a),Wr(a,{validation:"base64",code:Ar.invalid_string,message:l.message}),i.dirty()):Oi.assertNever(l);return{status:i.value,value:t.data}}_regex(t,r,i){return this.refinement(a=>t.test(a),{validation:r,code:Ar.invalid_string,...gn.errToObj(i)})}_addCheck(t){return new fd({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...gn.errToObj(t)})}url(t){return this._addCheck({kind:"url",...gn.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...gn.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...gn.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...gn.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...gn.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...gn.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...gn.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...gn.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...gn.errToObj(t)})}datetime(t){var r,i;return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,offset:(r=t==null?void 0:t.offset)!==null&&r!==void 0?r:!1,local:(i=t==null?void 0:t.local)!==null&&i!==void 0?i:!1,...gn.errToObj(t==null?void 0:t.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,...gn.errToObj(t==null?void 0:t.message)})}duration(t){return this._addCheck({kind:"duration",...gn.errToObj(t)})}regex(t,r){return this._addCheck({kind:"regex",regex:t,...gn.errToObj(r)})}includes(t,r){return this._addCheck({kind:"includes",value:t,position:r==null?void 0:r.position,...gn.errToObj(r==null?void 0:r.message)})}startsWith(t,r){return this._addCheck({kind:"startsWith",value:t,...gn.errToObj(r)})}endsWith(t,r){return this._addCheck({kind:"endsWith",value:t,...gn.errToObj(r)})}min(t,r){return this._addCheck({kind:"min",value:t,...gn.errToObj(r)})}max(t,r){return this._addCheck({kind:"max",value:t,...gn.errToObj(r)})}length(t,r){return this._addCheck({kind:"length",value:t,...gn.errToObj(r)})}nonempty(t){return this.min(1,gn.errToObj(t))}trim(){return new fd({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new fd({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new fd({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get minLength(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxLength(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}}fd.create=e=>{var t;return new fd({checks:[],typeName:Dn.ZodString,coerce:(t=e==null?void 0:e.coerce)!==null&&t!==void 0?t:!1,...ei(e)})};function zit(e,t){const r=(e.toString().split(".")[1]||"").length,i=(t.toString().split(".")[1]||"").length,a=r>i?r:i,l=parseInt(e.toFixed(a).replace(".","")),d=parseInt(t.toFixed(a).replace(".",""));return l%d/Math.pow(10,a)}class Kp extends ui{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==Xr.number){const l=this._getOrReturnCtx(t);return Wr(l,{code:Ar.invalid_type,expected:Xr.number,received:l.parsedType}),qn}let i;const a=new Xo;for(const l of this._def.checks)l.kind==="int"?Oi.isInteger(t.data)||(i=this._getOrReturnCtx(t,i),Wr(i,{code:Ar.invalid_type,expected:"integer",received:"float",message:l.message}),a.dirty()):l.kind==="min"?(l.inclusive?t.data<l.value:t.data<=l.value)&&(i=this._getOrReturnCtx(t,i),Wr(i,{code:Ar.too_small,minimum:l.value,type:"number",inclusive:l.inclusive,exact:!1,message:l.message}),a.dirty()):l.kind==="max"?(l.inclusive?t.data>l.value:t.data>=l.value)&&(i=this._getOrReturnCtx(t,i),Wr(i,{code:Ar.too_big,maximum:l.value,type:"number",inclusive:l.inclusive,exact:!1,message:l.message}),a.dirty()):l.kind==="multipleOf"?zit(t.data,l.value)!==0&&(i=this._getOrReturnCtx(t,i),Wr(i,{code:Ar.not_multiple_of,multipleOf:l.value,message:l.message}),a.dirty()):l.kind==="finite"?Number.isFinite(t.data)||(i=this._getOrReturnCtx(t,i),Wr(i,{code:Ar.not_finite,message:l.message}),a.dirty()):Oi.assertNever(l);return{status:a.value,value:t.data}}gte(t,r){return this.setLimit("min",t,!0,gn.toString(r))}gt(t,r){return this.setLimit("min",t,!1,gn.toString(r))}lte(t,r){return this.setLimit("max",t,!0,gn.toString(r))}lt(t,r){return this.setLimit("max",t,!1,gn.toString(r))}setLimit(t,r,i,a){return new Kp({...this._def,checks:[...this._def.checks,{kind:t,value:r,inclusive:i,message:gn.toString(a)}]})}_addCheck(t){return new Kp({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:gn.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:gn.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:gn.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:gn.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:gn.toString(t)})}multipleOf(t,r){return this._addCheck({kind:"multipleOf",value:t,message:gn.toString(r)})}finite(t){return this._addCheck({kind:"finite",message:gn.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:gn.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:gn.toString(t)})}get minValue(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxValue(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&Oi.isInteger(t.value))}get isFinite(){let t=null,r=null;for(const i of this._def.checks){if(i.kind==="finite"||i.kind==="int"||i.kind==="multipleOf")return!0;i.kind==="min"?(r===null||i.value>r)&&(r=i.value):i.kind==="max"&&(t===null||i.value<t)&&(t=i.value)}return Number.isFinite(r)&&Number.isFinite(t)}}Kp.create=e=>new Kp({checks:[],typeName:Dn.ZodNumber,coerce:(e==null?void 0:e.coerce)||!1,...ei(e)});class Zp extends ui{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce&&(t.data=BigInt(t.data)),this._getType(t)!==Xr.bigint){const l=this._getOrReturnCtx(t);return Wr(l,{code:Ar.invalid_type,expected:Xr.bigint,received:l.parsedType}),qn}let i;const a=new Xo;for(const l of this._def.checks)l.kind==="min"?(l.inclusive?t.data<l.value:t.data<=l.value)&&(i=this._getOrReturnCtx(t,i),Wr(i,{code:Ar.too_small,type:"bigint",minimum:l.value,inclusive:l.inclusive,message:l.message}),a.dirty()):l.kind==="max"?(l.inclusive?t.data>l.value:t.data>=l.value)&&(i=this._getOrReturnCtx(t,i),Wr(i,{code:Ar.too_big,type:"bigint",maximum:l.value,inclusive:l.inclusive,message:l.message}),a.dirty()):l.kind==="multipleOf"?t.data%l.value!==BigInt(0)&&(i=this._getOrReturnCtx(t,i),Wr(i,{code:Ar.not_multiple_of,multipleOf:l.value,message:l.message}),a.dirty()):Oi.assertNever(l);return{status:a.value,value:t.data}}gte(t,r){return this.setLimit("min",t,!0,gn.toString(r))}gt(t,r){return this.setLimit("min",t,!1,gn.toString(r))}lte(t,r){return this.setLimit("max",t,!0,gn.toString(r))}lt(t,r){return this.setLimit("max",t,!1,gn.toString(r))}setLimit(t,r,i,a){return new Zp({...this._def,checks:[...this._def.checks,{kind:t,value:r,inclusive:i,message:gn.toString(a)}]})}_addCheck(t){return new Zp({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:gn.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:gn.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:gn.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:gn.toString(t)})}multipleOf(t,r){return this._addCheck({kind:"multipleOf",value:t,message:gn.toString(r)})}get minValue(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxValue(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}}Zp.create=e=>{var t;return new Zp({checks:[],typeName:Dn.ZodBigInt,coerce:(t=e==null?void 0:e.coerce)!==null&&t!==void 0?t:!1,...ei(e)})};class yN extends ui{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==Xr.boolean){const i=this._getOrReturnCtx(t);return Wr(i,{code:Ar.invalid_type,expected:Xr.boolean,received:i.parsedType}),qn}return Tl(t.data)}}yN.create=e=>new yN({typeName:Dn.ZodBoolean,coerce:(e==null?void 0:e.coerce)||!1,...ei(e)});class mx extends ui{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==Xr.date){const l=this._getOrReturnCtx(t);return Wr(l,{code:Ar.invalid_type,expected:Xr.date,received:l.parsedType}),qn}if(isNaN(t.data.getTime())){const l=this._getOrReturnCtx(t);return Wr(l,{code:Ar.invalid_date}),qn}const i=new Xo;let a;for(const l of this._def.checks)l.kind==="min"?t.data.getTime()<l.value&&(a=this._getOrReturnCtx(t,a),Wr(a,{code:Ar.too_small,message:l.message,inclusive:!0,exact:!1,minimum:l.value,type:"date"}),i.dirty()):l.kind==="max"?t.data.getTime()>l.value&&(a=this._getOrReturnCtx(t,a),Wr(a,{code:Ar.too_big,message:l.message,inclusive:!0,exact:!1,maximum:l.value,type:"date"}),i.dirty()):Oi.assertNever(l);return{status:i.value,value:new Date(t.data.getTime())}}_addCheck(t){return new mx({...this._def,checks:[...this._def.checks,t]})}min(t,r){return this._addCheck({kind:"min",value:t.getTime(),message:gn.toString(r)})}max(t,r){return this._addCheck({kind:"max",value:t.getTime(),message:gn.toString(r)})}get minDate(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t!=null?new Date(t):null}}mx.create=e=>new mx({checks:[],coerce:(e==null?void 0:e.coerce)||!1,typeName:Dn.ZodDate,...ei(e)});class ZP extends ui{_parse(t){if(this._getType(t)!==Xr.symbol){const i=this._getOrReturnCtx(t);return Wr(i,{code:Ar.invalid_type,expected:Xr.symbol,received:i.parsedType}),qn}return Tl(t.data)}}ZP.create=e=>new ZP({typeName:Dn.ZodSymbol,...ei(e)});class vN extends ui{_parse(t){if(this._getType(t)!==Xr.undefined){const i=this._getOrReturnCtx(t);return Wr(i,{code:Ar.invalid_type,expected:Xr.undefined,received:i.parsedType}),qn}return Tl(t.data)}}vN.create=e=>new vN({typeName:Dn.ZodUndefined,...ei(e)});class bN extends ui{_parse(t){if(this._getType(t)!==Xr.null){const i=this._getOrReturnCtx(t);return Wr(i,{code:Ar.invalid_type,expected:Xr.null,received:i.parsedType}),qn}return Tl(t.data)}}bN.create=e=>new bN({typeName:Dn.ZodNull,...ei(e)});class n_ extends ui{constructor(){super(...arguments),this._any=!0}_parse(t){return Tl(t.data)}}n_.create=e=>new n_({typeName:Dn.ZodAny,...ei(e)});class q0 extends ui{constructor(){super(...arguments),this._unknown=!0}_parse(t){return Tl(t.data)}}q0.create=e=>new q0({typeName:Dn.ZodUnknown,...ei(e)});class zm extends ui{_parse(t){const r=this._getOrReturnCtx(t);return Wr(r,{code:Ar.invalid_type,expected:Xr.never,received:r.parsedType}),qn}}zm.create=e=>new zm({typeName:Dn.ZodNever,...ei(e)});class YP extends ui{_parse(t){if(this._getType(t)!==Xr.undefined){const i=this._getOrReturnCtx(t);return Wr(i,{code:Ar.invalid_type,expected:Xr.void,received:i.parsedType}),qn}return Tl(t.data)}}YP.create=e=>new YP({typeName:Dn.ZodVoid,...ei(e)});class yd extends ui{_parse(t){const{ctx:r,status:i}=this._processInputParams(t),a=this._def;if(r.parsedType!==Xr.array)return Wr(r,{code:Ar.invalid_type,expected:Xr.array,received:r.parsedType}),qn;if(a.exactLength!==null){const d=r.data.length>a.exactLength.value,s=r.data.length<a.exactLength.value;(d||s)&&(Wr(r,{code:d?Ar.too_big:Ar.too_small,minimum:s?a.exactLength.value:void 0,maximum:d?a.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:a.exactLength.message}),i.dirty())}if(a.minLength!==null&&r.data.length<a.minLength.value&&(Wr(r,{code:Ar.too_small,minimum:a.minLength.value,type:"array",inclusive:!0,exact:!1,message:a.minLength.message}),i.dirty()),a.maxLength!==null&&r.data.length>a.maxLength.value&&(Wr(r,{code:Ar.too_big,maximum:a.maxLength.value,type:"array",inclusive:!0,exact:!1,message:a.maxLength.message}),i.dirty()),r.common.async)return Promise.all([...r.data].map((d,s)=>a.type._parseAsync(new _h(r,d,r.path,s)))).then(d=>Xo.mergeArray(i,d));const l=[...r.data].map((d,s)=>a.type._parseSync(new _h(r,d,r.path,s)));return Xo.mergeArray(i,l)}get element(){return this._def.type}min(t,r){return new yd({...this._def,minLength:{value:t,message:gn.toString(r)}})}max(t,r){return new yd({...this._def,maxLength:{value:t,message:gn.toString(r)}})}length(t,r){return new yd({...this._def,exactLength:{value:t,message:gn.toString(r)}})}nonempty(t){return this.min(1,t)}}yd.create=(e,t)=>new yd({type:e,minLength:null,maxLength:null,exactLength:null,typeName:Dn.ZodArray,...ei(t)});function ov(e){if(e instanceof ra){const t={};for(const r in e.shape){const i=e.shape[r];t[r]=gh.create(ov(i))}return new ra({...e._def,shape:()=>t})}else return e instanceof yd?new yd({...e._def,type:ov(e.element)}):e instanceof gh?gh.create(ov(e.unwrap())):e instanceof Xp?Xp.create(ov(e.unwrap())):e instanceof wh?wh.create(e.items.map(t=>ov(t))):e}class ra extends ui{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),r=Oi.objectKeys(t);return this._cached={shape:t,keys:r}}_parse(t){if(this._getType(t)!==Xr.object){const x=this._getOrReturnCtx(t);return Wr(x,{code:Ar.invalid_type,expected:Xr.object,received:x.parsedType}),qn}const{status:i,ctx:a}=this._processInputParams(t),{shape:l,keys:d}=this._getCached(),s=[];if(!(this._def.catchall instanceof zm&&this._def.unknownKeys==="strip"))for(const x in a.data)d.includes(x)||s.push(x);const p=[];for(const x of d){const w=l[x],j=a.data[x];p.push({key:{status:"valid",value:x},value:w._parse(new _h(a,j,a.path,x)),alwaysSet:x in a.data})}if(this._def.catchall instanceof zm){const x=this._def.unknownKeys;if(x==="passthrough")for(const w of s)p.push({key:{status:"valid",value:w},value:{status:"valid",value:a.data[w]}});else if(x==="strict")s.length>0&&(Wr(a,{code:Ar.unrecognized_keys,keys:s}),i.dirty());else if(x!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const x=this._def.catchall;for(const w of s){const j=a.data[w];p.push({key:{status:"valid",value:w},value:x._parse(new _h(a,j,a.path,w)),alwaysSet:w in a.data})}}return a.common.async?Promise.resolve().then(async()=>{const x=[];for(const w of p){const j=await w.key,S=await w.value;x.push({key:j,value:S,alwaysSet:w.alwaysSet})}return x}).then(x=>Xo.mergeObjectSync(i,x)):Xo.mergeObjectSync(i,p)}get shape(){return this._def.shape()}strict(t){return gn.errToObj,new ra({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(r,i)=>{var a,l,d,s;const p=(d=(l=(a=this._def).errorMap)===null||l===void 0?void 0:l.call(a,r,i).message)!==null&&d!==void 0?d:i.defaultError;return r.code==="unrecognized_keys"?{message:(s=gn.errToObj(t).message)!==null&&s!==void 0?s:p}:{message:p}}}:{}})}strip(){return new ra({...this._def,unknownKeys:"strip"})}passthrough(){return new ra({...this._def,unknownKeys:"passthrough"})}extend(t){return new ra({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new ra({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:Dn.ZodObject})}setKey(t,r){return this.augment({[t]:r})}catchall(t){return new ra({...this._def,catchall:t})}pick(t){const r={};return Oi.objectKeys(t).forEach(i=>{t[i]&&this.shape[i]&&(r[i]=this.shape[i])}),new ra({...this._def,shape:()=>r})}omit(t){const r={};return Oi.objectKeys(this.shape).forEach(i=>{t[i]||(r[i]=this.shape[i])}),new ra({...this._def,shape:()=>r})}deepPartial(){return ov(this)}partial(t){const r={};return Oi.objectKeys(this.shape).forEach(i=>{const a=this.shape[i];t&&!t[i]?r[i]=a:r[i]=a.optional()}),new ra({...this._def,shape:()=>r})}required(t){const r={};return Oi.objectKeys(this.shape).forEach(i=>{if(t&&!t[i])r[i]=this.shape[i];else{let l=this.shape[i];for(;l instanceof gh;)l=l._def.innerType;r[i]=l}}),new ra({...this._def,shape:()=>r})}keyof(){return lde(Oi.objectKeys(this.shape))}}ra.create=(e,t)=>new ra({shape:()=>e,unknownKeys:"strip",catchall:zm.create(),typeName:Dn.ZodObject,...ei(t)});ra.strictCreate=(e,t)=>new ra({shape:()=>e,unknownKeys:"strict",catchall:zm.create(),typeName:Dn.ZodObject,...ei(t)});ra.lazycreate=(e,t)=>new ra({shape:e,unknownKeys:"strip",catchall:zm.create(),typeName:Dn.ZodObject,...ei(t)});class _N extends ui{_parse(t){const{ctx:r}=this._processInputParams(t),i=this._def.options;function a(l){for(const s of l)if(s.result.status==="valid")return s.result;for(const s of l)if(s.result.status==="dirty")return r.common.issues.push(...s.ctx.common.issues),s.result;const d=l.map(s=>new Lc(s.ctx.common.issues));return Wr(r,{code:Ar.invalid_union,unionErrors:d}),qn}if(r.common.async)return Promise.all(i.map(async l=>{const d={...r,common:{...r.common,issues:[]},parent:null};return{result:await l._parseAsync({data:r.data,path:r.path,parent:d}),ctx:d}})).then(a);{let l;const d=[];for(const p of i){const x={...r,common:{...r.common,issues:[]},parent:null},w=p._parseSync({data:r.data,path:r.path,parent:x});if(w.status==="valid")return w;w.status==="dirty"&&!l&&(l={result:w,ctx:x}),x.common.issues.length&&d.push(x.common.issues)}if(l)return r.common.issues.push(...l.ctx.common.issues),l.result;const s=d.map(p=>new Lc(p));return Wr(r,{code:Ar.invalid_union,unionErrors:s}),qn}}get options(){return this._def.options}}_N.create=(e,t)=>new _N({options:e,typeName:Dn.ZodUnion,...ei(t)});const sm=e=>e instanceof NN?sm(e.schema):e instanceof Nd?sm(e.innerType()):e instanceof SN?[e.value]:e instanceof Yp?e.options:e instanceof CN?Oi.objectValues(e.enum):e instanceof AN?sm(e._def.innerType):e instanceof vN?[void 0]:e instanceof bN?[null]:e instanceof gh?[void 0,...sm(e.unwrap())]:e instanceof Xp?[null,...sm(e.unwrap())]:e instanceof p$||e instanceof kN?sm(e.unwrap()):e instanceof TN?sm(e._def.innerType):[];class w3 extends ui{_parse(t){const{ctx:r}=this._processInputParams(t);if(r.parsedType!==Xr.object)return Wr(r,{code:Ar.invalid_type,expected:Xr.object,received:r.parsedType}),qn;const i=this.discriminator,a=r.data[i],l=this.optionsMap.get(a);return l?r.common.async?l._parseAsync({data:r.data,path:r.path,parent:r}):l._parseSync({data:r.data,path:r.path,parent:r}):(Wr(r,{code:Ar.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[i]}),qn)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(t,r,i){const a=new Map;for(const l of r){const d=sm(l.shape[t]);if(!d.length)throw new Error(`A discriminator value for key \`${t}\` could not be extracted from all schema options`);for(const s of d){if(a.has(s))throw new Error(`Discriminator property ${String(t)} has duplicate value ${String(s)}`);a.set(s,l)}}return new w3({typeName:Dn.ZodDiscriminatedUnion,discriminator:t,options:r,optionsMap:a,...ei(i)})}}function gL(e,t){const r=dp(e),i=dp(t);if(e===t)return{valid:!0,data:e};if(r===Xr.object&&i===Xr.object){const a=Oi.objectKeys(t),l=Oi.objectKeys(e).filter(s=>a.indexOf(s)!==-1),d={...e,...t};for(const s of l){const p=gL(e[s],t[s]);if(!p.valid)return{valid:!1};d[s]=p.data}return{valid:!0,data:d}}else if(r===Xr.array&&i===Xr.array){if(e.length!==t.length)return{valid:!1};const a=[];for(let l=0;l<e.length;l++){const d=e[l],s=t[l],p=gL(d,s);if(!p.valid)return{valid:!1};a.push(p.data)}return{valid:!0,data:a}}else return r===Xr.date&&i===Xr.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}class wN extends ui{_parse(t){const{status:r,ctx:i}=this._processInputParams(t),a=(l,d)=>{if(fL(l)||fL(d))return qn;const s=gL(l.value,d.value);return s.valid?((pL(l)||pL(d))&&r.dirty(),{status:r.value,value:s.data}):(Wr(i,{code:Ar.invalid_intersection_types}),qn)};return i.common.async?Promise.all([this._def.left._parseAsync({data:i.data,path:i.path,parent:i}),this._def.right._parseAsync({data:i.data,path:i.path,parent:i})]).then(([l,d])=>a(l,d)):a(this._def.left._parseSync({data:i.data,path:i.path,parent:i}),this._def.right._parseSync({data:i.data,path:i.path,parent:i}))}}wN.create=(e,t,r)=>new wN({left:e,right:t,typeName:Dn.ZodIntersection,...ei(r)});class wh extends ui{_parse(t){const{status:r,ctx:i}=this._processInputParams(t);if(i.parsedType!==Xr.array)return Wr(i,{code:Ar.invalid_type,expected:Xr.array,received:i.parsedType}),qn;if(i.data.length<this._def.items.length)return Wr(i,{code:Ar.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),qn;!this._def.rest&&i.data.length>this._def.items.length&&(Wr(i,{code:Ar.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());const l=[...i.data].map((d,s)=>{const p=this._def.items[s]||this._def.rest;return p?p._parse(new _h(i,d,i.path,s)):null}).filter(d=>!!d);return i.common.async?Promise.all(l).then(d=>Xo.mergeArray(r,d)):Xo.mergeArray(r,l)}get items(){return this._def.items}rest(t){return new wh({...this._def,rest:t})}}wh.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new wh({items:e,typeName:Dn.ZodTuple,rest:null,...ei(t)})};class jN extends ui{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:r,ctx:i}=this._processInputParams(t);if(i.parsedType!==Xr.object)return Wr(i,{code:Ar.invalid_type,expected:Xr.object,received:i.parsedType}),qn;const a=[],l=this._def.keyType,d=this._def.valueType;for(const s in i.data)a.push({key:l._parse(new _h(i,s,i.path,s)),value:d._parse(new _h(i,i.data[s],i.path,s)),alwaysSet:s in i.data});return i.common.async?Xo.mergeObjectAsync(r,a):Xo.mergeObjectSync(r,a)}get element(){return this._def.valueType}static create(t,r,i){return r instanceof ui?new jN({keyType:t,valueType:r,typeName:Dn.ZodRecord,...ei(i)}):new jN({keyType:fd.create(),valueType:t,typeName:Dn.ZodRecord,...ei(r)})}}class XP extends ui{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:r,ctx:i}=this._processInputParams(t);if(i.parsedType!==Xr.map)return Wr(i,{code:Ar.invalid_type,expected:Xr.map,received:i.parsedType}),qn;const a=this._def.keyType,l=this._def.valueType,d=[...i.data.entries()].map(([s,p],x)=>({key:a._parse(new _h(i,s,i.path,[x,"key"])),value:l._parse(new _h(i,p,i.path,[x,"value"]))}));if(i.common.async){const s=new Map;return Promise.resolve().then(async()=>{for(const p of d){const x=await p.key,w=await p.value;if(x.status==="aborted"||w.status==="aborted")return qn;(x.status==="dirty"||w.status==="dirty")&&r.dirty(),s.set(x.value,w.value)}return{status:r.value,value:s}})}else{const s=new Map;for(const p of d){const x=p.key,w=p.value;if(x.status==="aborted"||w.status==="aborted")return qn;(x.status==="dirty"||w.status==="dirty")&&r.dirty(),s.set(x.value,w.value)}return{status:r.value,value:s}}}}XP.create=(e,t,r)=>new XP({valueType:t,keyType:e,typeName:Dn.ZodMap,...ei(r)});class fx extends ui{_parse(t){const{status:r,ctx:i}=this._processInputParams(t);if(i.parsedType!==Xr.set)return Wr(i,{code:Ar.invalid_type,expected:Xr.set,received:i.parsedType}),qn;const a=this._def;a.minSize!==null&&i.data.size<a.minSize.value&&(Wr(i,{code:Ar.too_small,minimum:a.minSize.value,type:"set",inclusive:!0,exact:!1,message:a.minSize.message}),r.dirty()),a.maxSize!==null&&i.data.size>a.maxSize.value&&(Wr(i,{code:Ar.too_big,maximum:a.maxSize.value,type:"set",inclusive:!0,exact:!1,message:a.maxSize.message}),r.dirty());const l=this._def.valueType;function d(p){const x=new Set;for(const w of p){if(w.status==="aborted")return qn;w.status==="dirty"&&r.dirty(),x.add(w.value)}return{status:r.value,value:x}}const s=[...i.data.values()].map((p,x)=>l._parse(new _h(i,p,i.path,x)));return i.common.async?Promise.all(s).then(p=>d(p)):d(s)}min(t,r){return new fx({...this._def,minSize:{value:t,message:gn.toString(r)}})}max(t,r){return new fx({...this._def,maxSize:{value:t,message:gn.toString(r)}})}size(t,r){return this.min(t,r).max(t,r)}nonempty(t){return this.min(1,t)}}fx.create=(e,t)=>new fx({valueType:e,minSize:null,maxSize:null,typeName:Dn.ZodSet,...ei(t)});class Vv extends ui{constructor(){super(...arguments),this.validate=this.implement}_parse(t){const{ctx:r}=this._processInputParams(t);if(r.parsedType!==Xr.function)return Wr(r,{code:Ar.invalid_type,expected:Xr.function,received:r.parsedType}),qn;function i(s,p){return WP({data:s,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,qP(),r_].filter(x=>!!x),issueData:{code:Ar.invalid_arguments,argumentsError:p}})}function a(s,p){return WP({data:s,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,qP(),r_].filter(x=>!!x),issueData:{code:Ar.invalid_return_type,returnTypeError:p}})}const l={errorMap:r.common.contextualErrorMap},d=r.data;if(this._def.returns instanceof i_){const s=this;return Tl(async function(...p){const x=new Lc([]),w=await s._def.args.parseAsync(p,l).catch(P=>{throw x.addIssue(i(p,P)),x}),j=await Reflect.apply(d,this,w);return await s._def.returns._def.type.parseAsync(j,l).catch(P=>{throw x.addIssue(a(j,P)),x})})}else{const s=this;return Tl(function(...p){const x=s._def.args.safeParse(p,l);if(!x.success)throw new Lc([i(p,x.error)]);const w=Reflect.apply(d,this,x.data),j=s._def.returns.safeParse(w,l);if(!j.success)throw new Lc([a(w,j.error)]);return j.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...t){return new Vv({...this._def,args:wh.create(t).rest(q0.create())})}returns(t){return new Vv({...this._def,returns:t})}implement(t){return this.parse(t)}strictImplement(t){return this.parse(t)}static create(t,r,i){return new Vv({args:t||wh.create([]).rest(q0.create()),returns:r||q0.create(),typeName:Dn.ZodFunction,...ei(i)})}}class NN extends ui{get schema(){return this._def.getter()}_parse(t){const{ctx:r}=this._processInputParams(t);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}}NN.create=(e,t)=>new NN({getter:e,typeName:Dn.ZodLazy,...ei(t)});class SN extends ui{_parse(t){if(t.data!==this._def.value){const r=this._getOrReturnCtx(t);return Wr(r,{received:r.data,code:Ar.invalid_literal,expected:this._def.value}),qn}return{status:"valid",value:t.data}}get value(){return this._def.value}}SN.create=(e,t)=>new SN({value:e,typeName:Dn.ZodLiteral,...ei(t)});function lde(e,t){return new Yp({values:e,typeName:Dn.ZodEnum,...ei(t)})}class Yp extends ui{constructor(){super(...arguments),wj.set(this,void 0)}_parse(t){if(typeof t.data!="string"){const r=this._getOrReturnCtx(t),i=this._def.values;return Wr(r,{expected:Oi.joinValues(i),received:r.parsedType,code:Ar.invalid_type}),qn}if(KP(this,wj)||ide(this,wj,new Set(this._def.values)),!KP(this,wj).has(t.data)){const r=this._getOrReturnCtx(t),i=this._def.values;return Wr(r,{received:r.data,code:Ar.invalid_enum_value,options:i}),qn}return Tl(t.data)}get options(){return this._def.values}get enum(){const t={};for(const r of this._def.values)t[r]=r;return t}get Values(){const t={};for(const r of this._def.values)t[r]=r;return t}get Enum(){const t={};for(const r of this._def.values)t[r]=r;return t}extract(t,r=this._def){return Yp.create(t,{...this._def,...r})}exclude(t,r=this._def){return Yp.create(this.options.filter(i=>!t.includes(i)),{...this._def,...r})}}wj=new WeakMap;Yp.create=lde;class CN extends ui{constructor(){super(...arguments),jj.set(this,void 0)}_parse(t){const r=Oi.getValidEnumValues(this._def.values),i=this._getOrReturnCtx(t);if(i.parsedType!==Xr.string&&i.parsedType!==Xr.number){const a=Oi.objectValues(r);return Wr(i,{expected:Oi.joinValues(a),received:i.parsedType,code:Ar.invalid_type}),qn}if(KP(this,jj)||ide(this,jj,new Set(Oi.getValidEnumValues(this._def.values))),!KP(this,jj).has(t.data)){const a=Oi.objectValues(r);return Wr(i,{received:i.data,code:Ar.invalid_enum_value,options:a}),qn}return Tl(t.data)}get enum(){return this._def.values}}jj=new WeakMap;CN.create=(e,t)=>new CN({values:e,typeName:Dn.ZodNativeEnum,...ei(t)});class i_ extends ui{unwrap(){return this._def.type}_parse(t){const{ctx:r}=this._processInputParams(t);if(r.parsedType!==Xr.promise&&r.common.async===!1)return Wr(r,{code:Ar.invalid_type,expected:Xr.promise,received:r.parsedType}),qn;const i=r.parsedType===Xr.promise?r.data:Promise.resolve(r.data);return Tl(i.then(a=>this._def.type.parseAsync(a,{path:r.path,errorMap:r.common.contextualErrorMap})))}}i_.create=(e,t)=>new i_({type:e,typeName:Dn.ZodPromise,...ei(t)});class Nd extends ui{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Dn.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){const{status:r,ctx:i}=this._processInputParams(t),a=this._def.effect||null,l={addIssue:d=>{Wr(i,d),d.fatal?r.abort():r.dirty()},get path(){return i.path}};if(l.addIssue=l.addIssue.bind(l),a.type==="preprocess"){const d=a.transform(i.data,l);if(i.common.async)return Promise.resolve(d).then(async s=>{if(r.value==="aborted")return qn;const p=await this._def.schema._parseAsync({data:s,path:i.path,parent:i});return p.status==="aborted"?qn:p.status==="dirty"||r.value==="dirty"?Av(p.value):p});{if(r.value==="aborted")return qn;const s=this._def.schema._parseSync({data:d,path:i.path,parent:i});return s.status==="aborted"?qn:s.status==="dirty"||r.value==="dirty"?Av(s.value):s}}if(a.type==="refinement"){const d=s=>{const p=a.refinement(s,l);if(i.common.async)return Promise.resolve(p);if(p instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return s};if(i.common.async===!1){const s=this._def.schema._parseSync({data:i.data,path:i.path,parent:i});return s.status==="aborted"?qn:(s.status==="dirty"&&r.dirty(),d(s.value),{status:r.value,value:s.value})}else return this._def.schema._parseAsync({data:i.data,path:i.path,parent:i}).then(s=>s.status==="aborted"?qn:(s.status==="dirty"&&r.dirty(),d(s.value).then(()=>({status:r.value,value:s.value}))))}if(a.type==="transform")if(i.common.async===!1){const d=this._def.schema._parseSync({data:i.data,path:i.path,parent:i});if(!gN(d))return d;const s=a.transform(d.value,l);if(s instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:s}}else return this._def.schema._parseAsync({data:i.data,path:i.path,parent:i}).then(d=>gN(d)?Promise.resolve(a.transform(d.value,l)).then(s=>({status:r.value,value:s})):d);Oi.assertNever(a)}}Nd.create=(e,t,r)=>new Nd({schema:e,typeName:Dn.ZodEffects,effect:t,...ei(r)});Nd.createWithPreprocess=(e,t,r)=>new Nd({schema:t,effect:{type:"preprocess",transform:e},typeName:Dn.ZodEffects,...ei(r)});class gh extends ui{_parse(t){return this._getType(t)===Xr.undefined?Tl(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}gh.create=(e,t)=>new gh({innerType:e,typeName:Dn.ZodOptional,...ei(t)});class Xp extends ui{_parse(t){return this._getType(t)===Xr.null?Tl(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}Xp.create=(e,t)=>new Xp({innerType:e,typeName:Dn.ZodNullable,...ei(t)});class AN extends ui{_parse(t){const{ctx:r}=this._processInputParams(t);let i=r.data;return r.parsedType===Xr.undefined&&(i=this._def.defaultValue()),this._def.innerType._parse({data:i,path:r.path,parent:r})}removeDefault(){return this._def.innerType}}AN.create=(e,t)=>new AN({innerType:e,typeName:Dn.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...ei(t)});class TN extends ui{_parse(t){const{ctx:r}=this._processInputParams(t),i={...r,common:{...r.common,issues:[]}},a=this._def.innerType._parse({data:i.data,path:i.path,parent:{...i}});return xN(a)?a.then(l=>({status:"valid",value:l.status==="valid"?l.value:this._def.catchValue({get error(){return new Lc(i.common.issues)},input:i.data})})):{status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new Lc(i.common.issues)},input:i.data})}}removeCatch(){return this._def.innerType}}TN.create=(e,t)=>new TN({innerType:e,typeName:Dn.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...ei(t)});class JP extends ui{_parse(t){if(this._getType(t)!==Xr.nan){const i=this._getOrReturnCtx(t);return Wr(i,{code:Ar.invalid_type,expected:Xr.nan,received:i.parsedType}),qn}return{status:"valid",value:t.data}}}JP.create=e=>new JP({typeName:Dn.ZodNaN,...ei(e)});const Lit=Symbol("zod_brand");class p$ extends ui{_parse(t){const{ctx:r}=this._processInputParams(t),i=r.data;return this._def.type._parse({data:i,path:r.path,parent:r})}unwrap(){return this._def.type}}class bS extends ui{_parse(t){const{status:r,ctx:i}=this._processInputParams(t);if(i.common.async)return(async()=>{const l=await this._def.in._parseAsync({data:i.data,path:i.path,parent:i});return l.status==="aborted"?qn:l.status==="dirty"?(r.dirty(),Av(l.value)):this._def.out._parseAsync({data:l.value,path:i.path,parent:i})})();{const a=this._def.in._parseSync({data:i.data,path:i.path,parent:i});return a.status==="aborted"?qn:a.status==="dirty"?(r.dirty(),{status:"dirty",value:a.value}):this._def.out._parseSync({data:a.value,path:i.path,parent:i})}}static create(t,r){return new bS({in:t,out:r,typeName:Dn.ZodPipeline})}}class kN extends ui{_parse(t){const r=this._def.innerType._parse(t),i=a=>(gN(a)&&(a.value=Object.freeze(a.value)),a);return xN(r)?r.then(a=>i(a)):i(r)}unwrap(){return this._def.innerType}}kN.create=(e,t)=>new kN({innerType:e,typeName:Dn.ZodReadonly,...ei(t)});function cde(e,t={},r){return e?n_.create().superRefine((i,a)=>{var l,d;if(!e(i)){const s=typeof t=="function"?t(i):typeof t=="string"?{message:t}:t,p=(d=(l=s.fatal)!==null&&l!==void 0?l:r)!==null&&d!==void 0?d:!0,x=typeof s=="string"?{message:s}:s;a.addIssue({code:"custom",...x,fatal:p})}}):n_.create()}const Fit={object:ra.lazycreate};var Dn;(function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"})(Dn||(Dn={}));const Bit=(e,t={message:`Input not instance of ${e.name}`})=>cde(r=>r instanceof e,t),ude=fd.create,dde=Kp.create,$it=JP.create,Vit=Zp.create,hde=yN.create,Uit=mx.create,Git=ZP.create,Hit=vN.create,qit=bN.create,Wit=n_.create,Kit=q0.create,Zit=zm.create,Yit=YP.create,Xit=yd.create,Jit=ra.create,Qit=ra.strictCreate,est=_N.create,tst=w3.create,rst=wN.create,nst=wh.create,ist=jN.create,sst=XP.create,ast=fx.create,ost=Vv.create,lst=NN.create,cst=SN.create,ust=Yp.create,dst=CN.create,hst=i_.create,HZ=Nd.create,mst=gh.create,fst=Xp.create,pst=Nd.createWithPreprocess,gst=bS.create,xst=()=>ude().optional(),yst=()=>dde().optional(),vst=()=>hde().optional(),bst={string:e=>fd.create({...e,coerce:!0}),number:e=>Kp.create({...e,coerce:!0}),boolean:e=>yN.create({...e,coerce:!0}),bigint:e=>Zp.create({...e,coerce:!0}),date:e=>mx.create({...e,coerce:!0})},_st=qn;var os=Object.freeze({__proto__:null,defaultErrorMap:r_,setErrorMap:_it,getErrorMap:qP,makeIssue:WP,EMPTY_PATH:wit,addIssueToContext:Wr,ParseStatus:Xo,INVALID:qn,DIRTY:Av,OK:Tl,isAborted:fL,isDirty:pL,isValid:gN,isAsync:xN,get util(){return Oi},get objectUtil(){return mL},ZodParsedType:Xr,getParsedType:dp,ZodType:ui,datetimeRegex:ode,ZodString:fd,ZodNumber:Kp,ZodBigInt:Zp,ZodBoolean:yN,ZodDate:mx,ZodSymbol:ZP,ZodUndefined:vN,ZodNull:bN,ZodAny:n_,ZodUnknown:q0,ZodNever:zm,ZodVoid:YP,ZodArray:yd,ZodObject:ra,ZodUnion:_N,ZodDiscriminatedUnion:w3,ZodIntersection:wN,ZodTuple:wh,ZodRecord:jN,ZodMap:XP,ZodSet:fx,ZodFunction:Vv,ZodLazy:NN,ZodLiteral:SN,ZodEnum:Yp,ZodNativeEnum:CN,ZodPromise:i_,ZodEffects:Nd,ZodTransformer:Nd,ZodOptional:gh,ZodNullable:Xp,ZodDefault:AN,ZodCatch:TN,ZodNaN:JP,BRAND:Lit,ZodBranded:p$,ZodPipeline:bS,ZodReadonly:kN,custom:cde,Schema:ui,ZodSchema:ui,late:Fit,get ZodFirstPartyTypeKind(){return Dn},coerce:bst,any:Wit,array:Xit,bigint:Vit,boolean:hde,date:Uit,discriminatedUnion:tst,effect:HZ,enum:ust,function:ost,instanceof:Bit,intersection:rst,lazy:lst,literal:cst,map:sst,nan:$it,nativeEnum:dst,never:Zit,null:qit,nullable:fst,number:dde,object:Jit,oboolean:vst,onumber:yst,optional:mst,ostring:xst,pipeline:gst,preprocess:pst,promise:hst,record:ist,set:ast,strictObject:Qit,string:ude,symbol:Git,transformer:HZ,tuple:nst,undefined:Hit,union:est,unknown:Kit,void:Yit,NEVER:_st,ZodIssueCode:Ar,quotelessJson:bit,ZodError:Lc});const qZ=(e,t,r)=>{if(e&&"reportValidity"in e){const i=Dr(r,t);e.setCustomValidity(i&&i.message||""),e.reportValidity()}},mde=(e,t)=>{for(const r in t.fields){const i=t.fields[r];i&&i.ref&&"reportValidity"in i.ref?qZ(i.ref,r,e):i.refs&&i.refs.forEach(a=>qZ(a,r,e))}},wst=(e,t)=>{t.shouldUseNativeValidation&&mde(e,t);const r={};for(const i in e){const a=Dr(t.fields,i),l=Object.assign(e[i]||{},{ref:a&&a.ref});if(jst(t.names||Object.keys(e),i)){const d=Object.assign({},Dr(r,i));ns(d,"root",l),ns(r,i,d)}else ns(r,i,l)}return r},jst=(e,t)=>e.some(r=>r.startsWith(t+"."));var Nst=function(e,t){for(var r={};e.length;){var i=e[0],a=i.code,l=i.message,d=i.path.join(".");if(!r[d])if("unionErrors"in i){var s=i.unionErrors[0].errors[0];r[d]={message:s.message,type:s.code}}else r[d]={message:l,type:a};if("unionErrors"in i&&i.unionErrors.forEach(function(w){return w.errors.forEach(function(j){return e.push(j)})}),t){var p=r[d].types,x=p&&p[i.code];r[d]=yue(d,t,r,a,x?[].concat(x,i.message):i.message)}e.shift()}return r},xL=function(e,t,r){return r===void 0&&(r={}),function(i,a,l){try{return Promise.resolve(function(d,s){try{var p=Promise.resolve(e[r.mode==="sync"?"parse":"parseAsync"](i,t)).then(function(x){return l.shouldUseNativeValidation&&mde({},l),{errors:{},values:r.raw?i:x}})}catch(x){return s(x)}return p&&p.then?p.then(void 0,s):p}(0,function(d){if(function(s){return Array.isArray(s==null?void 0:s.errors)}(d))return{values:{},errors:wst(Nst(d.errors,!l.shouldUseNativeValidation&&l.criteriaMode==="all"),l)};throw d}))}catch(d){return Promise.reject(d)}}};const Sst=({step:e,prevStep:t,nextStep:r,isLastStep:i,isSubmitting:a=!1,totalSteps:l=4,submitText:d="Create Agent"})=>n.jsxs(mg,{className:"gap-2 flex-row sm:justify-between",children:[n.jsxs("div",{className:"flex gap-2",children:[e>1&&n.jsx(lt,{type:"button",variant:"outline",onClick:t,className:"border-gray-700 text-white hover:bg-gray-700",disabled:a,children:"Back"}),i?n.jsx(lt,{type:"submit",className:"bg-green-500 hover:bg-green-600 text-white",disabled:a,children:a?"Creating...":d}):n.jsx(lt,{type:"button",onClick:r,className:"bg-beam-blue hover:bg-beam-blue/80 text-white",disabled:a,children:"Next"})]}),n.jsxs("div",{className:"text-xs text-gray-400 flex items-center gap-1",children:[n.jsx(f_,{size:12}),"Step ",e," of ",l]})]}),Cst=os.object({name:os.string().min(3,"Name must be at least 3 characters"),description:os.string().min(10,"Description must be at least 10 characters"),type:os.enum(["pii","sensitive","regex","llm","custom"]),scope:os.enum(["global","local"]),severity:os.enum(["low","medium","high"]),action:os.enum(["log","warn","block","redact"]),pattern:os.string().optional(),categories:os.array(os.string()).optional()}),Ast=os.object({policyName:os.string().min(3,"Name must be at least 3 characters"),description:os.string().min(10,"Description must be at least 10 characters"),detectionType:os.enum(["rule-based","ml-based","hybrid"]),categories:os.array(os.string()).min(1,"Select at least one category"),redactionMethod:os.enum(["full","partial","hash","tokenize"]),actionOnDetection:os.enum(["log","warn","block","redact"]),automatedReasoning:os.boolean(),reasoningLevel:os.enum(["basic","advanced","comprehensive"]).optional(),enableAudit:os.boolean()}),Tst=({industry:e="banking"})=>{const[t,r]=U.useState("global"),[i,a]=U.useState(()=>e==="telco"?[{id:"g1",name:"Global Network Data Filter",description:"Organization-wide filter for network infrastructure information",type:"pii",scope:"global",severity:"high",action:"block",enabled:!0,categories:["Network Config","IP Addresses","Equipment Serial Numbers","Access Credentials"],createdAt:"2025-03-01"},{id:"g2",name:"Global Customer Data Protection",description:"Organization-wide filter for telecom customer information",type:"sensitive",scope:"global",severity:"high",action:"redact",enabled:!0,categories:["IMSI","Phone Numbers","Location Data","Usage Patterns"],createdAt:"2025-03-05"},{id:"g3",name:"Network Operations Security",description:"Project-specific filter for network operations data",type:"custom",scope:"local",severity:"high",action:"block",enabled:!0,categories:["Cell Tower Config","Network Passwords","Traffic Analysis","Spectrum Data"],createdAt:"2025-04-01"},{id:"g4",name:"Billing Information Protection",description:"Project-specific filter for customer billing data",type:"sensitive",scope:"local",severity:"high",action:"block",enabled:!0,categories:["Payment Methods","Billing History","Account Numbers","Credit Information"],createdAt:"2025-04-02"},{id:"g5",name:"Telecom Regulatory Compliance",description:"Ensures compliance with telecom regulations and standards",type:"custom",scope:"global",severity:"high",action:"warn",enabled:!0,categories:["GDPR Compliance","Telecom Act","Data Retention","Emergency Services"],createdAt:"2025-04-05"}]:[{id:"g1",name:"Global PII Filter",description:"Organization-wide filter for personally identifiable information",type:"pii",scope:"global",severity:"high",action:"block",enabled:!0,categories:["SSN","Credit Card","Phone Number","Address"],createdAt:"2025-03-01"},{id:"g2",name:"Global Sensitive Info Filter",description:"Organization-wide filter for sensitive business information",type:"sensitive",scope:"global",severity:"medium",action:"warn",enabled:!0,categories:["Financial Data","Business Strategy","Client Information"],createdAt:"2025-03-05"},{id:"g3",name:"Banking Network Data Filter",description:"Project-specific filter for banking network infrastructure data",type:"custom",scope:"local",severity:"high",action:"block",enabled:!0,categories:["Network Config","Database Credentials","API Keys"],createdAt:"2025-04-01"},{id:"g4",name:"Customer Financial Information",description:"Project-specific filter for customer financial information",type:"sensitive",scope:"local",severity:"high",action:"block",enabled:!0,categories:["Bank Account","Billing Address","Payment History"],createdAt:"2025-04-02"}]),l=hx({resolver:xL(Cst),defaultValues:{name:"",description:"",type:"pii",scope:"global",severity:"medium",action:"warn",pattern:"",categories:[]}}),d=ve=>{const _e={id:`g${i.length+1}`,name:ve.name,description:ve.description,type:ve.type,scope:ve.scope,severity:ve.severity,action:ve.action,enabled:!0,createdAt:new Date().toISOString().split("T")[0],pattern:ve.pattern,categories:ve.categories||[]};a([...i,_e]),Ls.success(`New ${ve.scope} guardrail created: ${ve.name}`),l.reset()},s=ve=>{a(i.map(_e=>_e.id===ve?{..._e,enabled:!_e.enabled}:_e))},p=ve=>{switch(ve){case"pii":return dn;case"sensitive":return mh;case"regex":return hve;case"llm":return eo;case"custom":return ws;default:return fs}},x=ve=>{switch(ve){case"high":return n.jsx(Tt,{className:"bg-red-500/20 text-red-400 border border-red-500/30",children:"High"});case"medium":return n.jsx(Tt,{className:"bg-amber-500/20 text-amber-400 border border-amber-500/30",children:"Medium"});case"low":return n.jsx(Tt,{className:"bg-green-500/20 text-green-400 border border-green-500/30",children:"Low"});default:return null}},w=ve=>{switch(ve){case"block":return n.jsx(Tt,{className:"bg-red-500/20 text-red-400 border border-red-500/30",children:"Block"});case"warn":return n.jsx(Tt,{className:"bg-amber-500/20 text-amber-400 border border-amber-500/30",children:"Warn"});case"log":return n.jsx(Tt,{className:"bg-blue-500/20 text-blue-400 border border-blue-500/30",children:"Log"});default:return null}},j=i.filter(ve=>ve.scope==="global"),S=i.filter(ve=>ve.scope==="local"),P=ve=>n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4",children:ve.map(_e=>{var je;const Ee=p(_e.type);return n.jsxs(jt,{className:"bg-beam-dark-accent/40 border border-gray-600/40 hover:border-purple-500/30 transition-all duration-300 shadow-lg",children:[n.jsx(wr,{className:"pb-2",children:n.jsxs("div",{className:"flex justify-between items-start",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:`p-2 rounded-lg ${_e.enabled?"bg-purple-500/20 border-purple-500/30":"bg-gray-500/20 border-gray-500/30"} border`,children:n.jsx(Ee,{size:16,className:_e.enabled?"text-purple-400":"text-gray-400"})}),n.jsxs("div",{children:[n.jsx(fr,{className:"text-white text-sm",children:_e.name}),n.jsxs(Ii,{className:"text-gray-400 text-xs",children:["Created: ",_e.createdAt]})]})]}),n.jsx("div",{className:"flex items-center gap-2",children:n.jsx(ko,{checked:_e.enabled,onCheckedChange:()=>s(_e.id)})})]})}),n.jsxs(Ht,{children:[n.jsx("p",{className:"text-sm text-gray-300 mb-3",children:_e.description}),n.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:(je=_e.categories)==null?void 0:je.map((Ce,tt)=>n.jsx(Tt,{variant:"outline",className:"bg-beam-dark-accent/60 border-gray-600/40",children:Ce},tt))}),n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[x(_e.severity),w(_e.action)]}),n.jsx(lt,{variant:"outline",size:"sm",className:"h-7 text-xs border-beam-blue text-beam-blue",children:"Configure"})]})]})]},_e.id)})}),[F,L]=U.useState(1),[B,V]=U.useState(!1);U.useState([]);const[$,G]=U.useState([]),[W,Z]=U.useState(!1),se=[{id:"names",label:"Names",description:"Personal names like John Doe"},{id:"addresses",label:"Addresses",description:"Physical addresses"},{id:"emails",label:"Email Addresses",description:"john@example.com"},{id:"phone",label:"Phone Numbers",description:"+1 555-123-4567"},{id:"ssn",label:"Social Security Numbers",description:"123-45-6789"},{id:"cc",label:"Credit Card Numbers",description:"4111-1111-1111-1111"},{id:"dob",label:"Dates of Birth",description:"01/01/1990"},{id:"passport",label:"Passport Numbers",description:"A12345678"},{id:"license",label:"License Numbers",description:"DL1234567"},{id:"medical",label:"Medical Information",description:"Health records, conditions"},{id:"financial",label:"Financial Details",description:"Bank account numbers, financial records"}],ae=hx({resolver:xL(Ast),defaultValues:{policyName:"",description:"",detectionType:"hybrid",categories:[],redactionMethod:"partial",actionOnDetection:"redact",automatedReasoning:!1,reasoningLevel:"basic",enableAudit:!0}}),ce=ve=>{console.log("Creating PII Policy:",ve);const _e={id:`g${i.length+1}`,name:ve.policyName,description:ve.description,type:"pii",scope:"global",severity:"high",action:ve.actionOnDetection,enabled:!0,createdAt:new Date().toISOString().split("T")[0],categories:ve.categories};a([...i,_e]),Ls.success(`Global PII Policy created: ${ve.policyName}`),V(!1),L(1),ae.reset()},Pe=ve=>{const _e=ve.target.files;if(_e&&_e.length>0){const Ee=Array.from(_e).map(je=>({name:je.name,type:je.name.endsWith(".json")?"JSON Policy":"Text Policy",size:`${(je.size/1024).toFixed(1)} KB`}));G([...$,...Ee]),Ls.success(`${_e.length} policy file(s) uploaded successfully`)}},we=()=>{F<3&&L(F+1)},xe=()=>{F>1&&L(F-1)},Ne=ve=>{const _e=ae.getValues().categories||[];_e.includes(ve)?ae.setValue("categories",_e.filter(Ee=>Ee!==ve)):ae.setValue("categories",[..._e,ve])},ze=ve=>{Z(ve),ae.setValue("automatedReasoning",ve)},ye=()=>{var ve;switch(F){case 1:return n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[n.jsx("div",{className:"p-2 rounded-lg bg-purple-500/20 border border-purple-500/30",children:n.jsx(dn,{size:18,className:"text-purple-400"})}),n.jsx("h3",{className:"text-white font-medium",children:"Basic Policy Information"})]}),n.jsx(Li,{control:ae.control,name:"policyName",render:({field:_e})=>n.jsxs(Ei,{children:[n.jsx(Mi,{className:"text-white",children:"Policy Name"}),n.jsx(Fi,{children:n.jsx(An,{placeholder:"Global PII Protection Policy",className:"bg-beam-dark border-gray-700",..._e})}),n.jsx(Wl,{className:"text-gray-400",children:"A descriptive name for this guardrail policy"})]})}),n.jsx(Li,{control:ae.control,name:"description",render:({field:_e})=>n.jsxs(Ei,{children:[n.jsx(Mi,{className:"text-white",children:"Description"}),n.jsx(Fi,{children:n.jsx(po,{placeholder:"Organization-wide policy for detecting and redacting personally identifiable information",className:"bg-beam-dark border-gray-700",..._e})}),n.jsx(Wl,{className:"text-gray-400",children:"Detailed description of this policy's purpose and scope"})]})}),n.jsx(Li,{control:ae.control,name:"detectionType",render:({field:_e})=>n.jsxs(Ei,{children:[n.jsx(Mi,{className:"text-white",children:"Detection Method"}),n.jsxs(_n,{onValueChange:_e.onChange,defaultValue:_e.value,children:[n.jsx(Fi,{children:n.jsx(xn,{className:"bg-beam-dark border-gray-700",children:n.jsx(wn,{placeholder:"Select detection method"})})}),n.jsxs(yn,{className:"bg-beam-dark border-gray-700",children:[n.jsx(yt,{value:"rule-based",children:"Rule-Based Detection"}),n.jsx(yt,{value:"ml-based",children:"ML-Based Detection"}),n.jsx(yt,{value:"hybrid",children:"Hybrid (Rules + ML)"})]})]}),n.jsx(Wl,{className:"text-gray-400",children:"How PII will be detected across your agents"})]})})]});case 2:return n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[n.jsx("div",{className:"p-2 rounded-lg bg-blue-500/20 border border-blue-500/30",children:n.jsx(mh,{size:18,className:"text-blue-400"})}),n.jsx("h3",{className:"text-white font-medium",children:"Detection Categories & Actions"})]}),n.jsx(Li,{control:ae.control,name:"categories",render:({field:_e})=>n.jsxs(Ei,{children:[n.jsx(Mi,{className:"text-white",children:"PII Categories to Detect"}),n.jsx(Wl,{className:"text-gray-400 mb-2",children:"Select which types of personally identifiable information to detect"}),n.jsx(Cl,{className:"h-64 rounded-md border border-gray-700 p-4",children:n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:se.map(Ee=>n.jsxs("div",{className:`p-3 rounded-md cursor-pointer border transition-colors ${_e.value.includes(Ee.id)?"border-purple-500 bg-purple-500/10":"border-gray-700 hover:border-gray-600"}`,onClick:()=>Ne(Ee.id),children:[n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:`w-4 h-4 rounded mr-2 ${_e.value.includes(Ee.id)?"bg-purple-500":"bg-gray-700"}`}),n.jsx("span",{className:"text-white font-medium",children:Ee.label})]}),n.jsx("p",{className:"text-gray-400 text-sm ml-6",children:Ee.description})]},Ee.id))})})]})}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsx(Li,{control:ae.control,name:"redactionMethod",render:({field:_e})=>n.jsxs(Ei,{children:[n.jsx(Mi,{className:"text-white",children:"Redaction Method"}),n.jsxs(_n,{onValueChange:_e.onChange,defaultValue:_e.value,children:[n.jsx(Fi,{children:n.jsx(xn,{className:"bg-beam-dark border-gray-700",children:n.jsx(wn,{placeholder:"Select redaction method"})})}),n.jsxs(yn,{className:"bg-beam-dark border-gray-700",children:[n.jsx(yt,{value:"full",children:"Full Redaction (****)"}),n.jsx(yt,{value:"partial",children:"Partial Redaction (J*** D**)"}),n.jsx(yt,{value:"hash",children:"Hash (a1b2c3d4)"}),n.jsx(yt,{value:"tokenize",children:"Tokenize (replace with tokens)"})]})]}),n.jsx(Wl,{className:"text-gray-400",children:"How detected PII will be redacted"})]})}),n.jsx(Li,{control:ae.control,name:"actionOnDetection",render:({field:_e})=>n.jsxs(Ei,{children:[n.jsx(Mi,{className:"text-white",children:"Action on Detection"}),n.jsxs(_n,{onValueChange:_e.onChange,defaultValue:_e.value,children:[n.jsx(Fi,{children:n.jsx(xn,{className:"bg-beam-dark border-gray-700",children:n.jsx(wn,{placeholder:"Select action"})})}),n.jsxs(yn,{className:"bg-beam-dark border-gray-700",children:[n.jsx(yt,{value:"log",children:"Log Only"}),n.jsx(yt,{value:"warn",children:"Warn User"}),n.jsx(yt,{value:"redact",children:"Automatically Redact"}),n.jsx(yt,{value:"block",children:"Block Interaction"})]})]}),n.jsx(Wl,{className:"text-gray-400",children:"What happens when PII is detected"})]})})]}),n.jsxs("div",{className:"p-4 rounded-lg border border-gray-700 bg-gray-900/50",children:[n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ove,{size:18,className:"text-gray-400"}),n.jsx("h4",{className:"text-white font-medium",children:"Upload Existing Policies"})]}),n.jsxs("label",{className:"cursor-pointer",children:[n.jsx(An,{type:"file",className:"hidden",multiple:!0,accept:".json,.txt",onChange:Pe}),n.jsx(lt,{type:"button",variant:"outline",className:"border-gray-700 hover:bg-gray-800",children:"Choose Files"})]})]}),$.length>0&&n.jsxs("div",{className:"mt-3",children:[n.jsx("h5",{className:"text-sm text-gray-400 mb-2",children:"Uploaded Files:"}),n.jsx(Cl,{className:"h-24 rounded-md border border-gray-700 p-2",children:n.jsx("div",{className:"space-y-2",children:$.map((_e,Ee)=>n.jsxs("div",{className:"flex justify-between items-center bg-gray-800 p-2 rounded",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Nh,{size:14,className:"text-gray-400"}),n.jsx("span",{className:"text-sm text-white",children:_e.name})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Tt,{variant:"outline",className:"text-xs",children:_e.type}),n.jsx("span",{className:"text-xs text-gray-400",children:_e.size})]})]},Ee))})})]})]})]});case 3:return n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[n.jsx("div",{className:"p-2 rounded-lg bg-green-500/20 border border-green-500/30",children:n.jsx(ti,{size:18,className:"text-green-400"})}),n.jsx("h3",{className:"text-white font-medium",children:"Automated Reasoning & Auditing"})]}),n.jsxs("div",{className:"p-4 rounded-lg border border-gray-700 space-y-4",children:[n.jsxs("div",{className:"flex justify-between items-start",children:[n.jsxs("div",{children:[n.jsxs("h4",{className:"text-white font-medium flex items-center gap-2",children:[n.jsx(ti,{size:16,className:"text-green-400"}),"Automated Reasoning"]}),n.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"Enables AI to automatically reason about and explain policy violations"})]}),n.jsx(ko,{checked:W,onCheckedChange:ze})]}),W&&n.jsx(Li,{control:ae.control,name:"reasoningLevel",render:({field:_e})=>n.jsxs(Ei,{children:[n.jsx(Mi,{className:"text-white",children:"Reasoning Comprehensiveness"}),n.jsxs(_n,{onValueChange:_e.onChange,defaultValue:_e.value,children:[n.jsx(Fi,{children:n.jsx(xn,{className:"bg-beam-dark border-gray-700",children:n.jsx(wn,{placeholder:"Select reasoning level"})})}),n.jsxs(yn,{className:"bg-beam-dark border-gray-700",children:[n.jsx(yt,{value:"basic",children:"Basic (Simple Explanations)"}),n.jsx(yt,{value:"advanced",children:"Advanced (Detailed Analysis)"}),n.jsx(yt,{value:"comprehensive",children:"Comprehensive (In-depth Rationale)"})]})]}),n.jsx(Wl,{className:"text-gray-400",children:"How detailed the reasoning about policy violations should be"})]})}),n.jsx("div",{className:"pt-4 border-t border-gray-700",children:n.jsxs(jt,{className:"bg-green-500/5 border border-green-500/30",children:[n.jsx(wr,{className:"pb-2",children:n.jsxs(fr,{className:"text-sm font-medium text-white flex items-center gap-2",children:[n.jsx(db,{size:14,className:"text-green-400"}),"Benefits of Automated Reasoning"]})}),n.jsx(Ht,{children:n.jsxs("ul",{className:"text-xs text-gray-300 space-y-1.5 list-disc pl-5",children:[n.jsx("li",{children:"Automatically explains why content was flagged"}),n.jsx("li",{children:"Provides continuous learning from policy applications"}),n.jsx("li",{children:"Helps identify policy gaps and false positives"}),n.jsx("li",{children:"Improves transparency and accountability"})]})})]})})]}),n.jsx(Li,{control:ae.control,name:"enableAudit",render:({field:_e})=>n.jsxs(Ei,{className:"flex flex-row items-center justify-between p-4 rounded-lg border border-gray-700",children:[n.jsxs("div",{className:"space-y-0.5",children:[n.jsxs(Mi,{className:"text-white flex items-center gap-2",children:[n.jsx(uk,{size:16,className:"text-blue-400"}),"Enable Audit Logging"]}),n.jsx(Wl,{className:"text-gray-400",children:"Keep detailed logs of all policy applications and violations"})]}),n.jsx(Fi,{children:n.jsx(ko,{checked:_e.value,onCheckedChange:_e.onChange})})]})}),n.jsxs("div",{className:"p-4 rounded-lg border border-gray-700 bg-gray-900/50",children:[n.jsx("h4",{className:"text-white font-medium mb-2",children:"Policy Summary"}),n.jsxs("div",{className:"space-y-2 text-sm",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-400",children:"Policy Name:"}),n.jsx("span",{className:"text-white",children:ae.getValues().policyName||"(Not set)"})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-400",children:"Detection Method:"}),n.jsx("span",{className:"text-white",children:ae.getValues().detectionType==="rule-based"?"Rule-Based":ae.getValues().detectionType==="ml-based"?"ML-Based":"Hybrid"})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-400",children:"Categories:"}),n.jsxs("span",{className:"text-white",children:[((ve=ae.getValues().categories)==null?void 0:ve.length)||0," selected"]})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-400",children:"Redaction:"}),n.jsx("span",{className:"text-white",children:ae.getValues().redactionMethod==="full"?"Full Redaction":ae.getValues().redactionMethod==="partial"?"Partial Redaction":ae.getValues().redactionMethod==="hash"?"Hash":"Tokenize"})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-400",children:"Action:"}),n.jsx("span",{className:"text-white",children:ae.getValues().actionOnDetection==="log"?"Log Only":ae.getValues().actionOnDetection==="warn"?"Warn User":ae.getValues().actionOnDetection==="redact"?"Auto-Redact":"Block"})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-400",children:"Automated Reasoning:"}),n.jsx("span",{className:"text-white",children:ae.getValues().automatedReasoning?"Enabled":"Disabled"})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-400",children:"Audit Logging:"}),n.jsx("span",{className:"text-white",children:ae.getValues().enableAudit?"Enabled":"Disabled"})]})]})]})]});default:return null}};return n.jsxs("div",{className:"glass-panel p-6 backdrop-blur-md bg-beam-dark-accent/30 border border-gray-700/50 rounded-xl shadow-lg",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[n.jsx("div",{className:"p-2 rounded-lg bg-purple-500/20 border border-purple-500/30",children:n.jsx(dn,{size:20,className:"text-purple-400"})}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl font-medium text-white",children:"Governance Controls"}),n.jsx("p",{className:"text-gray-300 text-sm",children:"Manage policies, guardrails, and compliance settings for your agents."})]})]}),n.jsxs($i,{defaultValue:"global",value:t,onValueChange:r,className:"w-full",children:[n.jsxs("div",{className:"flex justify-between items-center mb-4",children:[n.jsxs(Di,{className:"bg-beam-dark-accent/50",children:[n.jsxs(Jt,{value:"global",className:"data-[state=active]:bg-beam-blue data-[state=active]:text-white",children:[n.jsx(Zs,{size:14,className:"mr-2"}),"Global Guardrail Policy"]}),n.jsxs(Jt,{value:"local",className:"data-[state=active]:bg-beam-blue data-[state=active]:text-white",children:[n.jsx(V0,{size:14,className:"mr-2"}),"Local Guardrail Policy"]})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs(lt,{className:"bg-beam-blue hover:bg-blue-600",onClick:()=>V(!0),children:[n.jsx(Mo,{size:16,className:"mr-2"}),"Setup Policy"]}),n.jsxs(Ml,{children:[n.jsx(F_,{asChild:!0,children:n.jsxs(lt,{variant:"outline",className:"border-gray-700 text-white",children:[n.jsx(Mo,{size:16,className:"mr-2"}),"Add Guardrail"]})}),n.jsxs(Qo,{className:"bg-beam-dark-accent border-gray-700 text-white max-w-lg",children:[n.jsxs(el,{children:[n.jsx(tl,{children:"Create New Guardrail"}),n.jsx(fg,{className:"text-gray-400",children:"Configure a new guardrail to protect sensitive information."})]}),n.jsx(t_,{...l,children:n.jsxs("form",{onSubmit:l.handleSubmit(d),className:"space-y-4",children:[n.jsx(Li,{control:l.control,name:"name",render:({field:ve})=>n.jsxs(Ei,{children:[n.jsx(Mi,{children:"Guardrail Name"}),n.jsx(Fi,{children:n.jsx(An,{placeholder:"E.g., Customer PII Filter",className:"bg-beam-dark border-gray-700",...ve})})]})}),n.jsx(Li,{control:l.control,name:"description",render:({field:ve})=>n.jsxs(Ei,{children:[n.jsx(Mi,{children:"Description"}),n.jsx(Fi,{children:n.jsx(po,{placeholder:"Describe the purpose of this guardrail",className:"bg-beam-dark border-gray-700",...ve})})]})}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsx(Li,{control:l.control,name:"type",render:({field:ve})=>n.jsxs(Ei,{children:[n.jsx(Mi,{children:"Guardrail Type"}),n.jsxs(_n,{onValueChange:ve.onChange,defaultValue:ve.value,children:[n.jsx(Fi,{children:n.jsx(xn,{className:"bg-beam-dark border-gray-700",children:n.jsx(wn,{placeholder:"Select type"})})}),n.jsxs(yn,{className:"bg-beam-dark border-gray-700",children:[n.jsx(yt,{value:"pii",children:"PII Detection"}),n.jsx(yt,{value:"sensitive",children:"Sensitive Info"}),n.jsx(yt,{value:"regex",children:"Regex Pattern"}),n.jsx(yt,{value:"llm",children:"LLM Content Filter"}),n.jsx(yt,{value:"custom",children:"Custom Logic"})]})]})]})}),n.jsx(Li,{control:l.control,name:"scope",render:({field:ve})=>n.jsxs(Ei,{children:[n.jsx(Mi,{children:"Scope"}),n.jsxs(_n,{onValueChange:ve.onChange,defaultValue:ve.value,children:[n.jsx(Fi,{children:n.jsx(xn,{className:"bg-beam-dark border-gray-700",children:n.jsx(wn,{placeholder:"Select scope"})})}),n.jsxs(yn,{className:"bg-beam-dark border-gray-700",children:[n.jsx(yt,{value:"global",children:"Global (Org-wide)"}),n.jsx(yt,{value:"local",children:"Local (Project)"})]})]})]})})]}),l.watch("type")==="regex"&&n.jsx(Li,{control:l.control,name:"pattern",render:({field:ve})=>n.jsxs(Ei,{children:[n.jsx(Mi,{children:"Regex Pattern"}),n.jsx(Fi,{children:n.jsx(An,{placeholder:"E.g., \\b\\d{3}-\\d{2}-\\d{4}\\b",className:"bg-beam-dark border-gray-700 font-mono",...ve})}),n.jsx(Wl,{className:"text-gray-400",children:"Enter a regular expression pattern to match sensitive data"})]})}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsx(Li,{control:l.control,name:"severity",render:({field:ve})=>n.jsxs(Ei,{children:[n.jsx(Mi,{children:"Severity Level"}),n.jsxs(_n,{onValueChange:ve.onChange,defaultValue:ve.value,children:[n.jsx(Fi,{children:n.jsx(xn,{className:"bg-beam-dark border-gray-700",children:n.jsx(wn,{placeholder:"Select severity"})})}),n.jsxs(yn,{className:"bg-beam-dark border-gray-700",children:[n.jsx(yt,{value:"low",children:"Low"}),n.jsx(yt,{value:"medium",children:"Medium"}),n.jsx(yt,{value:"high",children:"High"})]})]})]})}),n.jsx(Li,{control:l.control,name:"action",render:({field:ve})=>n.jsxs(Ei,{children:[n.jsx(Mi,{children:"Action"}),n.jsxs(_n,{onValueChange:ve.onChange,defaultValue:ve.value,children:[n.jsx(Fi,{children:n.jsx(xn,{className:"bg-beam-dark border-gray-700",children:n.jsx(wn,{placeholder:"Select action"})})}),n.jsxs(yn,{className:"bg-beam-dark border-gray-700",children:[n.jsx(yt,{value:"log",children:"Log Only"}),n.jsx(yt,{value:"warn",children:"Warn"}),n.jsx(yt,{value:"block",children:"Block"})]})]})]})})]}),n.jsx(mg,{children:n.jsx(lt,{type:"submit",className:"bg-beam-blue hover:bg-blue-600",children:"Create Guardrail"})})]})})]})]})]})]}),n.jsx(ur,{value:"global",className:"mt-0",children:B?n.jsxs("div",{className:"glass-panel bg-beam-dark-accent/40 border border-gray-600/40 rounded-lg p-5",children:[n.jsxs("div",{className:"mb-6",children:[n.jsx("h3",{className:"text-white text-lg font-medium",children:"Global Guardrail Policy Setup"}),n.jsx("p",{className:"text-gray-400 text-sm",children:"Configure organization-wide policies for PII detection, redaction, and governance"})]}),n.jsx(t_,{...ae,children:n.jsxs("form",{onSubmit:ae.handleSubmit(ce),children:[ye(),n.jsx("div",{className:"mt-6",children:n.jsx(Sst,{step:F,prevStep:xe,nextStep:we,isLastStep:F===3,isSubmitting:ae.formState.isSubmitting})})]})})]}):n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"p-4 rounded-lg bg-beam-dark-accent/50 border border-gray-600/40 mb-4",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[n.jsx(Zs,{size:18,className:"text-purple-400"}),n.jsx("h3",{className:"text-white font-medium",children:"Organization-Wide Guardrail Policies"})]}),n.jsx("p",{className:"text-gray-300 text-sm ml-7",children:"Global guardrails are applied across all projects and agents in your organization. These policies cannot be overridden by project-level settings."})]}),j.length>0?n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4",children:j.map(ve=>{var Ee;const _e=p(ve.type);return n.jsxs(jt,{className:"bg-beam-dark-accent/40 border border-gray-600/40 hover:border-purple-500/30 transition-all duration-300 shadow-lg",children:[n.jsx(wr,{className:"pb-2",children:n.jsxs("div",{className:"flex justify-between items-start",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:`p-2 rounded-lg ${ve.enabled?"bg-purple-500/20 border-purple-500/30":"bg-gray-500/20 border-gray-500/30"} border`,children:n.jsx(_e,{size:16,className:ve.enabled?"text-purple-400":"text-gray-400"})}),n.jsxs("div",{children:[n.jsx(fr,{className:"text-white text-sm",children:ve.name}),n.jsxs(Ii,{className:"text-gray-400 text-xs",children:["Created: ",ve.createdAt]})]})]}),n.jsx("div",{className:"flex items-center gap-2",children:n.jsx(ko,{checked:ve.enabled,onCheckedChange:()=>s(ve.id)})})]})}),n.jsxs(Ht,{children:[n.jsx("p",{className:"text-sm text-gray-300 mb-3",children:ve.description}),n.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:(Ee=ve.categories)==null?void 0:Ee.map((je,Ce)=>n.jsx(Tt,{variant:"outline",className:"bg-beam-dark-accent/60 border-gray-600/40",children:je},Ce))}),n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[x(ve.severity),w(ve.action)]}),n.jsx(lt,{variant:"outline",size:"sm",className:"h-7 text-xs border-beam-blue text-beam-blue",children:"Configure"})]})]})]},ve.id)})}):n.jsxs("div",{className:"text-center py-10 text-gray-400",children:[n.jsx(dn,{size:40,className:"mx-auto mb-4 opacity-30"}),n.jsx("p",{children:"No global guardrails configured yet"}),n.jsx(lt,{onClick:()=>V(!0),variant:"link",className:"text-beam-blue",children:"Set up your first global policy"})]})]})}),n.jsxs(ur,{value:"local",className:"mt-0",children:[n.jsxs("div",{className:"p-4 rounded-lg bg-beam-dark-accent/50 border border-gray-600/40 mb-4",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[n.jsx(V0,{size:18,className:"text-blue-400"}),n.jsx("h3",{className:"text-white font-medium",children:"Project-Specific Guardrail Policies"})]}),n.jsx("p",{className:"text-gray-300 text-sm ml-7",children:"Local guardrails apply only to this specific project and its agents. These are enforced in addition to global guardrails."})]}),S.length>0?P(S):n.jsxs("div",{className:"text-center py-10 text-gray-400",children:[n.jsx(V0,{size:40,className:"mx-auto mb-4 opacity-30"}),n.jsx("p",{children:"No local guardrails configured for this project"}),n.jsx(lt,{onClick:()=>{var ve;l.setValue("scope","local"),(ve=document.querySelector("[data-state='closed'][data-trigger]"))==null||ve.dispatchEvent(new MouseEvent("click",{bubbles:!0}))},variant:"link",className:"text-beam-blue",children:"Add your first local guardrail"})]})]})]})]})},kst=()=>[{id:"customer",name:"Customer Data",icon:qi},{id:"accounts",name:"Accounts & Deposits",icon:m_},{id:"transactions",name:"Transaction Data",icon:sc},{id:"loans",name:"Loans & Credit",icon:J0},{id:"compliance",name:"Compliance & Risk",icon:dn},{id:"analytics",name:"Analytics & Reporting",icon:Co}],Pst=()=>[{id:"network",name:"Network Infrastructure",icon:ln},{id:"customer",name:"Customer Data",icon:qi},{id:"billing",name:"Billing & Usage",icon:m_},{id:"traffic",name:"Traffic Analytics",icon:Co},{id:"infrastructure",name:"Physical Infrastructure",icon:J0},{id:"compliance",name:"Telecom Compliance",icon:dn}],WZ=[{id:"read-only",name:"Read-Only"},{id:"read-write",name:"Read-Write"},{id:"admin",name:"Admin"},{id:"restricted",name:"Restricted"}],Est=({industry:e="banking"})=>{const t=e==="telco"?Pst():kst(),r=()=>e==="telco"?[{id:1,name:"Network Topology Database",type:"Graph Database",category:"network",accessLevel:"Read-Only",status:"Active",lastAccessed:"5 mins ago",queries:38},{id:2,name:"Customer Service Database",type:"SQL Database",category:"customer",accessLevel:"Read-Write",status:"Active",lastAccessed:"15 mins ago",queries:22},{id:3,name:"Billing & Usage Data Lake",type:"Data Lake",category:"billing",accessLevel:"Read-Only",status:"Active",lastAccessed:"2 hours ago",queries:14},{id:4,name:"Network Traffic Analytics",type:"Time Series DB",category:"traffic",accessLevel:"Read-Only",status:"Active",lastAccessed:"30 mins ago",queries:67},{id:5,name:"Infrastructure Management System",type:"CMDB",category:"infrastructure",accessLevel:"Read-Only",status:"Active",lastAccessed:"1 hour ago",queries:12},{id:6,name:"Telecom Regulatory Database",type:"Compliance Database",category:"compliance",accessLevel:"Restricted",status:"Active",lastAccessed:"4 hours ago",queries:3}]:[{id:1,name:"Customer Profile Database",type:"SQL Database",category:"customer",accessLevel:"Read-Only",status:"Active",lastAccessed:"10 mins ago",queries:24},{id:2,name:"Core Banking System",type:"Legacy Database",category:"accounts",accessLevel:"Read-Write",status:"Active",lastAccessed:"2 hours ago",queries:18},{id:3,name:"Transaction History Data Lake",type:"Data Lake",category:"transactions",accessLevel:"Read-Only",status:"Active",lastAccessed:"1 day ago",queries:7},{id:4,name:"Credit Risk Assessment DB",type:"Analytics Database",category:"loans",accessLevel:"Read-Only",status:"Restricted",lastAccessed:"5 days ago",queries:2},{id:5,name:"Anti-Money Laundering System",type:"Compliance Database",category:"compliance",accessLevel:"Read-Only",status:"Active",lastAccessed:"30 mins ago",queries:42},{id:6,name:"Customer Analytics Warehouse",type:"Data Warehouse",category:"analytics",accessLevel:"Read-Only",status:"Active",lastAccessed:"3 hours ago",queries:15}],[i,a]=U.useState(r());U.useEffect(()=>{a(r())},[e]);const l=hx({defaultValues:{name:"",type:"",category:"",accessLevel:"read-only"}}),d=s=>{var x;const p={id:i.length+1,name:s.name,type:s.type,category:s.category,accessLevel:((x=WZ.find(w=>w.id===s.accessLevel))==null?void 0:x.name)||"Read-Only",status:"Active",lastAccessed:"Just now",queries:0};a([...i,p]),Ls.success("Database connector added successfully!"),l.reset()};return n.jsx("div",{className:"space-y-6",children:n.jsxs(jt,{className:"shadow-lg border-gray-800/30 bg-gradient-to-br from-beam-dark-accent/70 to-beam-dark-accent/40 backdrop-blur-md",children:[n.jsx(wr,{className:"pb-2",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"p-2 rounded-lg bg-gradient-to-r from-blue-500/30 to-indigo-500/30 border border-blue-500/20",children:n.jsx(ln,{size:20,className:"text-blue-400"})}),n.jsxs("div",{children:[n.jsx(fr,{className:"text-xl font-medium text-white",children:e==="telco"?"Telecom Data Access Management":"Banking Data Access Management"}),n.jsxs(Ii,{className:"text-gray-300",children:["Connect to ",e==="telco"?"telecom-specific":"banking-specific"," data sources and systems"]})]})]}),n.jsxs(Ml,{children:[n.jsx(F_,{asChild:!0,children:n.jsxs(lt,{className:"bg-beam-blue hover:bg-blue-600",children:[n.jsx(Mo,{size:16,className:"mr-2"}),"Add Database"]})}),n.jsxs(Qo,{className:"bg-beam-dark-accent border-gray-700 text-white",children:[n.jsxs(el,{children:[n.jsx(tl,{children:"Add New Database Connector"}),n.jsxs(fg,{className:"text-gray-400",children:["Connect your agent to a ",e==="telco"?"telecom":"banking"," database or data source."]})]}),n.jsx(t_,{...l,children:n.jsxs("form",{onSubmit:l.handleSubmit(d),className:"space-y-4",children:[n.jsx(Li,{control:l.control,name:"name",render:({field:s})=>n.jsxs(Ei,{children:[n.jsx(Mi,{children:"Database Name"}),n.jsx(Fi,{children:n.jsx(An,{placeholder:"Customer Transaction Database",className:"bg-beam-dark border-gray-700",...s})})]})}),n.jsx(Li,{control:l.control,name:"type",render:({field:s})=>n.jsxs(Ei,{children:[n.jsx(Mi,{children:"Database Type"}),n.jsx(Fi,{children:n.jsx(An,{placeholder:"Core Banking System, Data Warehouse, etc.",className:"bg-beam-dark border-gray-700",...s})})]})}),n.jsx(Li,{control:l.control,name:"category",render:({field:s})=>n.jsxs(Ei,{children:[n.jsx(Mi,{children:"Category"}),n.jsxs(_n,{onValueChange:s.onChange,defaultValue:s.value,children:[n.jsx(Fi,{children:n.jsx(xn,{className:"bg-beam-dark border-gray-700",children:n.jsx(wn,{placeholder:"Select category"})})}),n.jsx(yn,{className:"bg-beam-dark border-gray-700",children:t.map(p=>n.jsx(yt,{value:p.id,children:p.name},p.id))})]})]})}),n.jsx(Li,{control:l.control,name:"accessLevel",render:({field:s})=>n.jsxs(Ei,{children:[n.jsx(Mi,{children:"Access Level"}),n.jsxs(_n,{onValueChange:s.onChange,defaultValue:s.value,children:[n.jsx(Fi,{children:n.jsx(xn,{className:"bg-beam-dark border-gray-700",children:n.jsx(wn,{placeholder:"Select access level"})})}),n.jsx(yn,{className:"bg-beam-dark border-gray-700",children:WZ.map(p=>n.jsx(yt,{value:p.id,children:p.name},p.id))})]})]})}),n.jsx(mg,{children:n.jsx(lt,{type:"submit",className:"bg-beam-blue hover:bg-blue-600",children:"Add Database"})})]})})]})]})]})}),n.jsx(Ht,{children:n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[n.jsx(jt,{className:"bg-beam-dark/70 border border-gray-700/30",children:n.jsxs(Ht,{className:"p-4",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx(ln,{size:18,className:"text-beam-blue"}),n.jsx(fr,{className:"text-base font-medium text-white",children:"Active Sources"})]}),n.jsx("div",{className:"text-3xl font-bold text-white",children:i.filter(s=>s.status==="Active").length}),n.jsxs(Ii,{className:"text-gray-400",children:["Across ",e==="telco"?"telecom":"banking"," systems"]})]})}),n.jsx(jt,{className:"bg-beam-dark/70 border border-gray-700/30",children:n.jsxs(Ht,{className:"p-4",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx($a,{size:18,className:"text-beam-blue"}),n.jsx(fr,{className:"text-base font-medium text-white",children:"Queries Today"})]}),n.jsx("div",{className:"text-3xl font-bold text-white",children:i.reduce((s,p)=>s+p.queries,0)}),n.jsx(Ii,{className:"text-gray-400",children:"+12% from yesterday"})]})}),n.jsx(jt,{className:"bg-beam-dark/70 border border-gray-700/30",children:n.jsxs(Ht,{className:"p-4",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx(dn,{size:18,className:"text-beam-blue"}),n.jsx(fr,{className:"text-base font-medium text-white",children:"Compliance Status"})]}),n.jsx("div",{className:"text-3xl font-bold text-green-400",children:"Secure"}),n.jsx(Ii,{className:"text-gray-400",children:e==="telco"?"Telecom regulations enforced":"Banking regulations enforced"})]})})]}),n.jsxs(jt,{className:"bg-beam-dark/70 border border-gray-700/30",children:[n.jsxs(wr,{className:"pb-2",children:[n.jsx(fr,{className:"text-xl text-white",children:e==="telco"?"Telecom Data Sources":"Banking Data Sources"}),n.jsxs(Ii,{className:"text-gray-400",children:[e==="telco"?"Telecom-specific":"Banking-specific"," data sources available to this agent"]})]}),n.jsx(Ht,{children:n.jsx("div",{className:"overflow-x-auto",children:n.jsxs(Mc,{children:[n.jsx(Ic,{children:n.jsxs(Fs,{className:"hover:bg-white/5",children:[n.jsx(Or,{className:"text-white",children:"Name"}),n.jsx(Or,{className:"text-white",children:"Type"}),n.jsx(Or,{className:"text-white",children:"Category"}),n.jsx(Or,{className:"text-white",children:"Access Level"}),n.jsx(Or,{className:"text-white",children:"Status"}),n.jsx(Or,{className:"text-white",children:"Last Accessed"}),n.jsx(Or,{className:"text-white",children:"Query Count"})]})}),n.jsx(Oc,{children:i.map(s=>{const p=t.find(w=>w.id===s.category),x=(p==null?void 0:p.icon)||ln;return n.jsxs(Fs,{className:"hover:bg-white/5 border-white/10",children:[n.jsx(Rr,{className:"font-medium text-white",children:s.name}),n.jsx(Rr,{className:"text-gray-300",children:s.type}),n.jsx(Rr,{children:n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(x,{size:14,className:"text-blue-400"}),n.jsx("span",{className:"text-gray-300",children:(p==null?void 0:p.name)||s.category})]})}),n.jsx(Rr,{children:n.jsx(Tt,{variant:"outline",className:`
                                ${s.accessLevel==="Read-Only"?"bg-blue-900/20 text-blue-300 border-blue-600/30":s.accessLevel==="Read-Write"?"bg-amber-900/20 text-amber-300 border-amber-600/30":s.accessLevel==="Admin"?"bg-purple-900/20 text-purple-300 border-purple-600/30":"bg-red-900/20 text-red-300 border-red-600/30"}
                              `,children:s.accessLevel})}),n.jsx(Rr,{children:n.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${s.status==="Active"?"bg-green-500/20 text-green-400":"bg-amber-500/20 text-amber-400"}`,children:s.status})}),n.jsx(Rr,{className:"text-gray-300",children:s.lastAccessed}),n.jsx(Rr,{children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-gray-300",children:s.queries}),n.jsx(vn,{value:s.queries*2,className:"h-1.5 w-12"})]})})]},s.id)})})]})})})]}),n.jsxs(jt,{className:"bg-beam-dark/70 border border-gray-700/30",children:[n.jsxs(wr,{className:"pb-2",children:[n.jsx(fr,{className:"text-xl text-white",children:"Banking Data Access Policies"}),n.jsx(Ii,{className:"text-gray-400",children:"Banking-specific enforced policies for data access and compliance"})]}),n.jsx(Ht,{children:n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"p-3 bg-gray-800/40 rounded-lg border border-gray-700/30",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(dn,{size:16,className:"text-green-400"}),n.jsx("span",{className:"text-sm text-white",children:"PII Data Masking (Customer Information)"}),n.jsx(Tt,{className:"ml-auto bg-green-500/20 text-green-400 border-green-600/30",children:"Active"})]}),n.jsx("p",{className:"text-xs text-gray-300 mt-1 pl-6",children:"Automatically detects and masks customer personally identifiable information."})]}),n.jsxs("div",{className:"p-3 bg-gray-800/40 rounded-lg border border-gray-700/30",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(NE,{size:16,className:"text-green-400"}),n.jsx("span",{className:"text-sm text-white",children:"Account Number Encryption"}),n.jsx(Tt,{className:"ml-auto bg-green-500/20 text-green-400 border-green-600/30",children:"Active"})]}),n.jsx("p",{className:"text-xs text-gray-300 mt-1 pl-6",children:"All account numbers are encrypted and access is logged for audit trails."})]}),n.jsxs("div",{className:"p-3 bg-gray-800/40 rounded-lg border border-gray-700/30",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(sc,{size:16,className:"text-green-400"}),n.jsx("span",{className:"text-sm text-white",children:"Transaction Amount Thresholds"}),n.jsx(Tt,{className:"ml-auto bg-green-500/20 text-green-400 border-green-600/30",children:"Active"})]}),n.jsx("p",{className:"text-xs text-gray-300 mt-1 pl-6",children:"Large transaction data requires elevated access permissions and approval."})]}),n.jsxs("div",{className:"p-3 bg-gray-800/40 rounded-lg border border-gray-700/30",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(fs,{size:16,className:"text-amber-400"}),n.jsx("span",{className:"text-sm text-white",children:"Query Rate Limiting"}),n.jsx(Tt,{className:"ml-auto bg-amber-500/20 text-amber-400 border-amber-600/30",children:"Warning"})]}),n.jsx("p",{className:"text-xs text-gray-300 mt-1 pl-6",children:"Approaching query rate limit of 200/day (current: 143)."})]}),n.jsxs("div",{className:"p-3 bg-gray-800/40 rounded-lg border border-gray-700/30",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(db,{size:16,className:"text-green-400"}),n.jsx("span",{className:"text-sm text-white",children:"SOX & Basel III Compliance Logging"}),n.jsx(Tt,{className:"ml-auto bg-green-500/20 text-green-400 border-green-600/30",children:"Active"})]}),n.jsx("p",{className:"text-xs text-gray-300 mt-1 pl-6",children:"All data access requests are logged for financial regulatory compliance."})]})]})})]})]})})]})})},Mst={light:"",dark:".dark"},fde=U.createContext(null);function pde(){const e=U.useContext(fde);if(!e)throw new Error("useChart must be used within a <ChartContainer />");return e}const Uv=U.forwardRef(({id:e,className:t,children:r,config:i,...a},l)=>{const d=U.useId(),s=`chart-${e||d.replace(/:/g,"")}`;return n.jsx(fde.Provider,{value:{config:i},children:n.jsxs("div",{"data-chart":s,ref:l,className:Yt("flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none",t),...a,children:[n.jsx(Ist,{id:s,config:i}),n.jsx(ms,{children:r})]})})});Uv.displayName="Chart";const Ist=({id:e,config:t})=>{const r=Object.entries(t).filter(([i,a])=>a.theme||a.color);return r.length?n.jsx("style",{dangerouslySetInnerHTML:{__html:Object.entries(Mst).map(([i,a])=>`
${a} [data-chart=${e}] {
${r.map(([l,d])=>{var p;const s=((p=d.theme)==null?void 0:p[i])||d.color;return s?`  --color-${l}: ${s};`:null}).join(`
`)}
}
`).join(`
`)}}):null},zT=yi,Gv=U.forwardRef(({active:e,payload:t,className:r,indicator:i="dot",hideLabel:a=!1,hideIndicator:l=!1,label:d,labelFormatter:s,labelClassName:p,formatter:x,color:w,nameKey:j,labelKey:S},P)=>{const{config:F}=pde(),L=U.useMemo(()=>{var Z;if(a||!(t!=null&&t.length))return null;const[V]=t,$=`${S||V.dataKey||V.name||"value"}`,G=yL(F,V,$),W=!S&&typeof d=="string"?((Z=F[d])==null?void 0:Z.label)||d:G==null?void 0:G.label;return s?n.jsx("div",{className:Yt("font-medium",p),children:s(W,t)}):W?n.jsx("div",{className:Yt("font-medium",p),children:W}):null},[d,s,t,a,p,F,S]);if(!e||!(t!=null&&t.length))return null;const B=t.length===1&&i!=="dot";return n.jsxs("div",{ref:P,className:Yt("grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl",r),children:[B?null:L,n.jsx("div",{className:"grid gap-1.5",children:t.map((V,$)=>{const G=`${j||V.name||V.dataKey||"value"}`,W=yL(F,V,G),Z=w||V.payload.fill||V.color;return n.jsx("div",{className:Yt("flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground",i==="dot"&&"items-center"),children:x&&(V==null?void 0:V.value)!==void 0&&V.name?x(V.value,V.name,V,$,V.payload):n.jsxs(n.Fragment,{children:[W!=null&&W.icon?n.jsx(W.icon,{}):!l&&n.jsx("div",{className:Yt("shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]",{"h-2.5 w-2.5":i==="dot","w-1":i==="line","w-0 border-[1.5px] border-dashed bg-transparent":i==="dashed","my-0.5":B&&i==="dashed"}),style:{"--color-bg":Z,"--color-border":Z}}),n.jsxs("div",{className:Yt("flex flex-1 justify-between leading-none",B?"items-end":"items-center"),children:[n.jsxs("div",{className:"grid gap-1.5",children:[B?L:null,n.jsx("span",{className:"text-muted-foreground",children:(W==null?void 0:W.label)||V.name})]}),V.value&&n.jsx("span",{className:"font-mono font-medium tabular-nums text-foreground",children:V.value.toLocaleString()})]})]})},V.dataKey)})})]})});Gv.displayName="ChartTooltip";const Ost=U.forwardRef(({className:e,hideIcon:t=!1,payload:r,verticalAlign:i="bottom",nameKey:a},l)=>{const{config:d}=pde();return r!=null&&r.length?n.jsx("div",{ref:l,className:Yt("flex items-center justify-center gap-4",i==="top"?"pb-3":"pt-3",e),children:r.map(s=>{const p=`${a||s.dataKey||"value"}`,x=yL(d,s,p);return n.jsxs("div",{className:Yt("flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground"),children:[x!=null&&x.icon&&!t?n.jsx(x.icon,{}):n.jsx("div",{className:"h-2 w-2 shrink-0 rounded-[2px]",style:{backgroundColor:s.color}}),x==null?void 0:x.label]},s.value)})}):null});Ost.displayName="ChartLegend";function yL(e,t,r){if(typeof t!="object"||t===null)return;const i="payload"in t&&typeof t.payload=="object"&&t.payload!==null?t.payload:void 0;let a=r;return r in t&&typeof t[r]=="string"?a=t[r]:i&&r in i&&typeof i[r]=="string"&&(a=i[r]),a in e?e[a]:e[r]}const Rst={"consumer-banking":"Consumer Banking","corporate-banking":"Corporate Banking","wealth-management":"Wealth Management",default:"General Banking"},KZ={"consumer-banking":n.jsx(qi,{size:16,className:"text-beam-blue"}),"corporate-banking":n.jsx(J0,{size:16,className:"text-purple-500"}),"wealth-management":n.jsx(En,{size:16,className:"text-green-500"}),default:n.jsx(m_,{size:16,className:"text-gray-500"})},Dst=({selectedProject:e,projectData:t,setSelectedProject:r})=>{const i=l=>Rst[l]||l,a=l=>KZ[l]||KZ.default;return n.jsxs(Ip,{children:[n.jsxs(Op,{className:"bg-beam-dark-accent/80 hover:bg-beam-dark-accent border border-gray-700 text-white px-5 py-2.5 rounded-lg flex items-center gap-2 shadow-lg transition-all duration-200",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"w-6 h-6 rounded-full bg-beam-blue/20 flex items-center justify-center",children:a(e)}),n.jsx("span",{className:"font-medium",children:i(e)})]}),n.jsx(Na,{size:16})]}),n.jsx(_m,{className:"bg-beam-dark-accent/95 border-gray-700 backdrop-blur-md text-white shadow-xl rounded-lg p-1 w-56",children:Object.keys(t).filter(l=>l!=="default").map(l=>n.jsxs(Ao,{className:"hover:bg-beam-blue/20 cursor-pointer flex items-center gap-3 py-2.5 px-3 rounded-md",onClick:()=>r(l),children:[n.jsx("div",{className:"w-6 h-6 rounded-full bg-beam-blue/20 flex items-center justify-center",children:a(l)}),n.jsx("span",{className:"font-medium",children:i(l)})]},l))})]})},g$=()=>({"consumer-banking":{department:"Consumer Banking",decisionNodes:zst(),lineageNodes:Lst(),lineageEdges:Fst(),agents:[{name:"Customer Onboarding Agent",description:"Streamlines new customer account opening and KYC processes",model:{name:"GPT-4o",provider:"OpenAI",paramSize:"1.76 trillion",contextLength:"128,000 tokens",latency:"250ms",role:"Automates identity verification and account setup workflows"},tools:["KYC API connectors","Document verification","Credit scoring APIs"],dataAccess:["Customer databases","Credit bureau data","Regulatory compliance systems"]},{name:"Personal Finance Advisor",description:"Provides personalized financial advice and product recommendations",model:{name:"Claude 3 Opus",provider:"Anthropic",paramSize:"1.5 trillion",contextLength:"200,000 tokens",latency:"320ms",role:"Analyzes spending patterns and recommends financial products"},tools:["Financial planning algorithms","Risk assessment tools","Product recommendation engine"],dataAccess:["Transaction history","Account balances","Product catalogs"]},{name:"Loan Underwriting Agent",description:"Automates loan application processing and risk assessment",model:{name:"Llama 3 70B",provider:"Meta",paramSize:"70 billion",contextLength:"8,000 tokens",latency:"180ms",role:"Evaluates creditworthiness and determines loan eligibility"},tools:["Credit scoring models","Income verification","Collateral assessment"],dataAccess:["Credit reports","Employment records","Asset valuations"]},{name:"Fraud Detection Agent",description:"Monitors transactions for suspicious activity and fraud prevention",model:{name:"GPT-4o",provider:"OpenAI",paramSize:"1.76 trillion",contextLength:"128,000 tokens",latency:"230ms",role:"Real-time transaction monitoring and fraud pattern recognition"},tools:["Anomaly detection algorithms","Behavioral analytics","Risk scoring"],dataAccess:["Transaction logs","Customer behavior patterns","Fraud databases"]},{name:"Customer Service Agent",description:"Handles customer inquiries and provides 24/7 support",model:{name:"Claude 3 Sonnet",provider:"Anthropic",paramSize:"540 billion",contextLength:"180,000 tokens",latency:"200ms",role:"Resolves customer issues and provides banking assistance"},tools:["Natural language processing","Sentiment analysis","Issue resolution workflows"],dataAccess:["Customer profiles","Account information","Service history"]}],workflow:[{phase:"Customer Acquisition",description:"Onboard new customers with automated KYC and account setup",agents:["Customer Onboarding Agent","Fraud Detection Agent"],outputs:["Verified customer profiles","Opened accounts","Compliance documentation"]},{phase:"Product Recommendation",description:"Analyze customer needs and recommend suitable products",agents:["Personal Finance Advisor","Customer Service Agent"],outputs:["Personalized product recommendations","Financial planning advice"]},{phase:"Loan Processing",description:"Process loan applications with automated underwriting",agents:["Loan Underwriting Agent","Fraud Detection Agent"],outputs:["Credit decisions","Risk assessments","Loan approvals"]}]},"corporate-banking":{department:"Corporate Banking",decisionNodes:mR(),lineageNodes:fR(),lineageEdges:pR(),agents:[{name:"Corporate Credit Analyst",description:"Evaluates corporate credit applications and risk profiles",model:{name:"GPT-4o",provider:"OpenAI",paramSize:"1.76 trillion",contextLength:"128,000 tokens",latency:"280ms",role:"Analyzes financial statements and assesses corporate creditworthiness"},tools:["Financial ratio analysis","Industry benchmarking","Credit modeling"],dataAccess:["Corporate financials","Industry data","Market intelligence"]},{name:"Cash Management Agent",description:"Optimizes corporate cash flow and liquidity management",model:{name:"Claude 3 Opus",provider:"Anthropic",paramSize:"1.5 trillion",contextLength:"200,000 tokens",latency:"350ms",role:"Provides cash forecasting and working capital optimization"},tools:["Cash flow forecasting","Liquidity optimization","Treasury management"],dataAccess:["Account balances","Payment schedules","Investment portfolios"]},{name:"Trade Finance Agent",description:"Processes trade finance transactions and documentation",model:{name:"GPT-4 Turbo",provider:"OpenAI",paramSize:"1.76 trillion",contextLength:"128,000 tokens",latency:"260ms",role:"Automates letter of credit and trade documentation processing"},tools:["Document processing","Trade compliance checking","Settlement automation"],dataAccess:["Trade documents","Regulatory databases","Partner bank systems"]},{name:"Relationship Manager Assistant",description:"Supports relationship managers with client insights and opportunities",model:{name:"Claude 3 Sonnet",provider:"Anthropic",paramSize:"540 billion",contextLength:"180,000 tokens",latency:"220ms",role:"Identifies cross-selling opportunities and client engagement strategies"},tools:["Client analytics","Opportunity identification","Relationship mapping"],dataAccess:["Client profiles","Transaction history","Market data"]}]},"wealth-management":{department:"Wealth Management",decisionNodes:mR(),lineageNodes:fR(),lineageEdges:pR(),agents:[{name:"Portfolio Optimization Agent",description:"Creates and rebalances investment portfolios based on client risk profiles",model:{name:"GPT-4o",provider:"OpenAI",paramSize:"1.76 trillion",contextLength:"128,000 tokens",latency:"300ms",role:"Optimizes asset allocation and portfolio performance"},tools:["Modern portfolio theory","Risk modeling","Asset allocation algorithms"],dataAccess:["Market data","Client risk profiles","Portfolio holdings"]},{name:"Investment Research Agent",description:"Analyzes market trends and generates investment recommendations",model:{name:"Claude 3 Opus",provider:"Anthropic",paramSize:"1.5 trillion",contextLength:"200,000 tokens",latency:"380ms",role:"Conducts fundamental and technical analysis for investment decisions"},tools:["Market analysis","Company research","Economic modeling"],dataAccess:["Financial markets data","Company fundamentals","Economic indicators"]},{name:"Tax Optimization Agent",description:"Identifies tax-efficient investment strategies and planning opportunities",model:{name:"GPT-4 Turbo",provider:"OpenAI",paramSize:"1.76 trillion",contextLength:"128,000 tokens",latency:"240ms",role:"Optimizes tax implications of investment decisions"},tools:["Tax modeling","Regulatory compliance","Estate planning tools"],dataAccess:["Tax regulations","Client tax profiles","Investment tax implications"]},{name:"Wealth Advisor Assistant",description:"Supports wealth advisors with client insights and planning recommendations",model:{name:"Claude 3 Sonnet",provider:"Anthropic",paramSize:"540 billion",contextLength:"180,000 tokens",latency:"210ms",role:"Provides comprehensive wealth planning and advisory support"},tools:["Financial planning","Goal-based investing","Client communication"],dataAccess:["Client financial data","Life goals","Market opportunities"]},{name:"ESG Investment Agent",description:"Identifies sustainable investment opportunities aligned with ESG criteria",model:{name:"Llama 3 70B",provider:"Meta",paramSize:"70 billion",contextLength:"8,000 tokens",latency:"190ms",role:"Evaluates environmental, social, and governance factors in investments"},tools:["ESG scoring","Sustainability analysis","Impact measurement"],dataAccess:["ESG databases","Sustainability reports","Impact metrics"]}]},default:{department:"General Banking",decisionNodes:mR(),lineageNodes:fR(),lineageEdges:pR(),agents:[{name:"General Banking Assistant",description:"Handles general banking operations and customer support",model:{name:"GPT-4o",provider:"OpenAI",paramSize:"1.76 trillion",contextLength:"128,000 tokens",latency:"220ms",role:"Multi-purpose banking assistance and transaction processing"}}]}});function zst(){return[{id:"start",type:"start",label:"Customer Application",content:"New customer loan application received",connects:["tool1"],position:{x:50,y:100}},{id:"tool1",type:"tool",label:"KYC Verification",content:"Performing identity and document verification",connects:["decision1"],position:{x:250,y:100},toolDetails:{input:"Customer documents",output:"Verified identity",databases:["CustomerDB"],executionTime:"2.1s",query:"SELECT * FROM kyc_documents WHERE customer_id = ?"}},{id:"decision1",type:"decision",label:"KYC Status",content:"Evaluating KYC compliance status",connects:["tool2","alternate1"],position:{x:450,y:100}},{id:"tool2",type:"tool",label:"Credit Check",content:"Analyzing credit history and score",connects:["tool3"],position:{x:650,y:100},toolDetails:{input:"Customer ID",output:"Credit Score & History",databases:["CreditBureau"],executionTime:"1.8s",query:"GET /credit-score/{customer_id}"}},{id:"alternate1",type:"alternate",label:"KYC Failed",content:"Additional documentation required",connects:["tool1"],position:{x:450,y:250}},{id:"tool3",type:"tool",label:"Risk Assessment",content:"Calculating loan risk and terms",connects:["decision2"],position:{x:850,y:100},toolDetails:{input:"Credit data, Income verification",output:"Risk Score & Loan Terms",databases:["RiskEngine"],executionTime:"3.2s",query:"CALL calculate_loan_risk(?)"}},{id:"decision2",type:"decision",label:"Approval Decision",content:"Determining loan approval status",connects:["tool4","alternate2"],position:{x:1050,y:100}},{id:"tool4",type:"tool",label:"Account Setup",content:"Creating customer account and loan records",connects:["end"],position:{x:1250,y:100},toolDetails:{input:"Approved application",output:"Active account & loan",databases:["CoreBanking"],executionTime:"1.5s",query:"INSERT INTO accounts (customer_id, loan_amount, terms)"}},{id:"alternate2",type:"alternate",label:"Application Declined",content:"Risk assessment indicates high risk",connects:["end"],position:{x:1050,y:250}},{id:"end",type:"end",label:"Process Complete",content:"Customer application processed",connects:[],position:{x:1250,y:250}}]}function Lst(){return[{id:"customerdb",type:"database",label:"Customer DB",content:"Customer profiles and KYC data",position:{x:50,y:400},isCombinedView:!0},{id:"creditbureau",type:"api",label:"Credit Bureau API",content:"External credit scoring service",position:{x:250,y:400},isCombinedView:!0},{id:"kycdata",type:"file",label:"KYC Data",content:"Identity verification documents",position:{x:450,y:400},isCombinedView:!0},{id:"riskengine",type:"database",label:"Risk Engine",content:"Loan risk assessment system",position:{x:650,y:400},isCombinedView:!0},{id:"creditscores",type:"transformation",label:"Credit Scores",content:"Processed credit assessments",position:{x:850,y:400},isCombinedView:!0},{id:"corebanking",type:"database",label:"Core Banking",content:"Account and transaction systems",position:{x:1050,y:400},isCombinedView:!0},{id:"loanrecords",type:"file",label:"Loan Records",content:"Approved loan documentation",position:{x:1250,y:400},isCombinedView:!0}]}function Fst(){return[{source:"customerdb",target:"kycdata",type:"data_flow"},{source:"creditbureau",target:"creditscores",type:"data_flow"},{source:"kycdata",target:"riskengine",type:"transformation"},{source:"creditscores",target:"riskengine",type:"data_flow"},{source:"riskengine",target:"corebanking",type:"dependency"},{source:"corebanking",target:"loanrecords",type:"data_flow"}]}function mR(e){return[{id:"start",type:"start",label:"Start Process",content:"Banking process initiated",connects:["tool1"],position:{x:50,y:100}},{id:"tool1",type:"tool",label:"Data Collection",content:"Gathering required financial data",connects:["decision1"],position:{x:250,y:100},toolDetails:{input:"Client request",output:"Financial data",databases:["BankingDB"],executionTime:"0.8s",query:"SELECT * FROM accounts WHERE ..."}},{id:"decision1",type:"decision",label:"Compliance Check",content:"Verifying regulatory compliance",connects:["tool2","alternate1"],position:{x:450,y:100}},{id:"tool2",type:"tool",label:"Risk Analysis",content:"Analyzing financial risk factors",connects:["decision2"],position:{x:650,y:100},toolDetails:{input:"Financial data",output:"Risk assessment",databases:["RiskDB"],executionTime:"1.2s",query:"CALL risk_analysis(...)"}},{id:"alternate1",type:"alternate",label:"Compliance Issue",content:"Additional review required",connects:["end"],position:{x:450,y:250}},{id:"decision2",type:"decision",label:"Approval Gate",content:"Final approval decision",connects:["tool3"],position:{x:850,y:100}},{id:"tool3",type:"tool",label:"Execute Transaction",content:"Processing approved transaction",connects:["end"],position:{x:1050,y:100},toolDetails:{input:"Approved request",output:"Completed transaction",databases:["TransactionDB"],executionTime:"0.5s",query:"INSERT INTO transactions ..."}},{id:"end",type:"end",label:"Process Complete",content:"Banking process completed",connects:[],position:{x:1050,y:250}}]}function fR(e){return[{id:"bankingdb",type:"database",label:"Banking DB",content:"Core banking system data",position:{x:50,y:350}},{id:"clientrequest",type:"api",label:"Client Request",content:"Customer service requests",position:{x:250,y:350}},{id:"financialdata",type:"file",label:"Financial Data",content:"Processed financial information",position:{x:450,y:350}},{id:"riskassessment",type:"transformation",label:"Risk Assessment",content:"Analyzed risk metrics",position:{x:650,y:350}},{id:"riskdb",type:"database",label:"Risk DB",content:"Risk management system",position:{x:850,y:350}},{id:"transactiondb",type:"database",label:"Transaction DB",content:"Transaction processing system",position:{x:1050,y:350}},{id:"completedtransaction",type:"file",label:"Completed Transaction",content:"Final transaction records",position:{x:1250,y:350}}].map(r=>({...r,isCombinedView:!0}))}function pR(e){return[{source:"bankingdb",target:"financialdata",type:"data_flow"},{source:"clientrequest",target:"financialdata",type:"data_flow"},{source:"financialdata",target:"riskassessment",type:"transformation"},{source:"riskassessment",target:"riskdb",type:"data_flow"},{source:"riskdb",target:"transactiondb",type:"dependency"},{source:"transactiondb",target:"completedtransaction",type:"data_flow"}]}const Bst={width:1800,height:400,nodeSize:{width:140,height:70},nodeTypes:{start:{color:"#4ade80",icon:"Play"},tool:{color:"#a8bdf8",icon:"Wrench"},decision:{color:"#facc15",icon:"GitBranch"},alternate:{color:"#f87171",icon:"AlertTriangle"},end:{color:"#9ca3af",icon:"Check"}}},$st={width:1800,height:400,nodeSize:{width:140,height:70},nodeTypes:{database:{color:"#8B5CF6",icon:"Database"},api:{color:"#3B82F6",icon:"Zap"},file:{color:"#10B981",icon:"FileText"},transformation:{color:"#EC4899",icon:"GitMerge"}}},Vst=[{month:"Jan","Network Capex":124,"Customer Lifetime":85,"Sales & Service":42,"Customer Experience":73,"HR Analytics":53},{month:"Feb","Network Capex":137,"Customer Lifetime":77,"Sales & Service":50,"Customer Experience":63,"HR Analytics":48},{month:"Mar","Network Capex":129,"Customer Lifetime":90,"Sales & Service":56,"Customer Experience":81,"HR Analytics":59},{month:"Apr","Network Capex":142,"Customer Lifetime":103,"Sales & Service":65,"Customer Experience":89,"HR Analytics":62},{month:"May","Network Capex":158,"Customer Lifetime":118,"Sales & Service":72,"Customer Experience":94,"HR Analytics":68},{month:"Jun","Network Capex":146,"Customer Lifetime":110,"Sales & Service":80,"Customer Experience":86,"HR Analytics":65}],ZZ=[{id:1,name:"Investment Analyzer",project:"Network Capex",model:"GPT-4o",dailyInferences:245,monthlyCost:127.4,costTrend:"up"},{id:2,name:"Customer Insights Agent",project:"Customer Lifetime",model:"Claude 3 Sonnet",dailyInferences:187,monthlyCost:98.65,costTrend:"down"},{id:3,name:"Sales Assistant",project:"Sales & Service",model:"Nova Pro",dailyInferences:156,monthlyCost:62.4,costTrend:"up"},{id:4,name:"Experience Optimizer",project:"Customer Experience",model:"GPT-4o Mini",dailyInferences:203,monthlyCost:81.2,costTrend:"down"},{id:5,name:"Talent Manager",project:"HR Analytics",model:"Nova Lite",dailyInferences:129,monthlyCost:51.6,costTrend:"up"},{id:6,name:"Investment Forecaster",project:"Network Capex",model:"Claude 3 Opus",dailyInferences:178,monthlyCost:103.8,costTrend:"down"},{id:7,name:"Customer Retention Agent",project:"Customer Lifetime",model:"GPT-4o",dailyInferences:195,monthlyCost:85.3,costTrend:"up"},{id:8,name:"Support Agent",project:"Sales & Service",model:"Claude 3 Sonnet",dailyInferences:220,monthlyCost:68.9,costTrend:"down"}],lu={"Network Capex":"#4338ca","Customer Lifetime":"#8b5cf6","Sales & Service":"#10b981","Customer Experience":"#f59e0b","HR Analytics":"#ec4899"},rm={"network-capex":"Network Capex","customer-lifetime":"Customer Lifetime","sales-service-ai":"Sales & Service","customer-experience":"Customer Experience","hr-analytics":"HR Analytics"},Ust=({selectedProject:e,setSelectedProject:t})=>{const[r,i]=U.useState("network-capex"),[a,l]=U.useState(["network-capex"]),[d,s]=U.useState(!0),p=e||r,x=t||i,w=g$(),j=ZZ.filter(W=>d||a.includes(Object.keys(rm).find(Z=>rm[Z]===W.project)||"")),S=j.reduce((W,Z)=>W+Z.monthlyCost,0),P=j.reduce((W,Z)=>W+Z.dailyInferences,0),L=Object.keys(rm).map(W=>{const Z=rm[W],se=ZZ.filter(ae=>ae.project===Z);return{project:Z,key:W,cost:se.reduce((ae,ce)=>ae+ce.monthlyCost,0)}}).sort((W,Z)=>Z.cost-W.cost)[0],B=W=>{x(W),rm[W]&&(l([W]),s(!1))},V=(W,Z)=>{l(Z?se=>[...se,W]:se=>se.filter(ae=>ae!==W)),s(!1)},$=W=>{s(W),W&&l(Object.keys(rm))},G=Vst.map(W=>{const Z={month:W.month};return Object.keys(W).forEach(se=>{if(se==="month")return;const ae=Object.keys(rm).find(ce=>rm[ce]===se);(d||ae&&a.includes(ae))&&(Z[se]=W[se])}),Z});return n.jsxs("div",{className:"glass-panel backdrop-blur-md bg-beam-dark-accent/30 border border-gray-700/50 rounded-xl p-6 shadow-lg space-y-6",children:[n.jsxs("div",{className:"flex justify-between items-center mb-4",children:[n.jsx("h2",{className:"text-xl font-semibold text-white",children:"Cost Analytics"}),n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(yu,{id:"showAll",checked:d,onCheckedChange:$,className:"data-[state=checked]:bg-beam-blue data-[state=checked]:border-beam-blue"}),n.jsx("label",{htmlFor:"showAll",className:"text-sm text-gray-300 cursor-pointer",children:"Show All Projects"})]}),n.jsx(Dst,{selectedProject:p,projectData:w,setSelectedProject:B})]})]}),n.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-3",children:[n.jsxs(jt,{className:"bg-beam-dark-accent/50 border-gray-700/50 text-white",children:[n.jsxs(wr,{className:"pb-2",children:[n.jsx(fr,{className:"text-lg font-medium",children:"Total Monthly Cost"}),n.jsx(Ii,{className:"text-gray-400",children:d?"All projects combined":"Selected projects"})]}),n.jsx(Ht,{children:n.jsxs("div",{className:"flex items-baseline space-x-2",children:[n.jsx("span",{className:"text-3xl font-bold",children:S.toFixed(2)}),n.jsxs("span",{className:"text-green-400 text-sm font-medium ml-2 flex items-center",children:[n.jsx(En,{className:"h-4 w-4 mr-1"}),"+8.2%"]})]})})]}),n.jsxs(jt,{className:"bg-beam-dark-accent/50 border-gray-700/50 text-white",children:[n.jsxs(wr,{className:"pb-2",children:[n.jsx(fr,{className:"text-lg font-medium",children:"Daily Inference Count"}),n.jsx(Ii,{className:"text-gray-400",children:d?"Average across all agents":"Selected projects"})]}),n.jsx(Ht,{children:n.jsxs("div",{className:"flex items-baseline space-x-2",children:[n.jsx("span",{className:"text-3xl font-bold",children:P.toLocaleString()}),n.jsxs("span",{className:"text-green-400 text-sm font-medium ml-2 flex items-center",children:[n.jsx(En,{className:"h-4 w-4 mr-1"}),"+12.5%"]})]})})]}),n.jsxs(jt,{className:"bg-beam-dark-accent/50 border-gray-700/50 text-white",children:[n.jsxs(wr,{className:"pb-2",children:[n.jsx(fr,{className:"text-lg font-medium",children:"Highest Cost Project"}),n.jsx(Ii,{className:"text-gray-400",children:L.project})]}),n.jsx(Ht,{children:n.jsxs("div",{className:"flex items-baseline space-x-2",children:[n.jsx("span",{className:"text-3xl font-bold",children:L.cost.toFixed(2)}),n.jsxs("span",{className:"text-red-400 text-sm font-medium ml-2 flex items-center",children:[n.jsx(tx,{className:"h-4 w-4 mr-1"}),"-3.1%"]})]})})]})]}),n.jsxs(jt,{className:"bg-beam-dark-accent/50 border-gray-700/50 text-white",children:[n.jsxs(wr,{className:"pb-2 flex flex-row items-center justify-between",children:[n.jsxs("div",{children:[n.jsx(fr,{className:"text-lg font-medium",children:"Monthly Cost Trends"}),n.jsx(Ii,{className:"text-gray-400",children:"Last 6 months, selected projects"})]}),n.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(rm).map(([W,Z])=>n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(yu,{id:`project-${W}`,checked:d||a.includes(W),onCheckedChange:se=>V(W,se===!0),className:"data-[state=checked]:bg-beam-blue data-[state=checked]:border-beam-blue",disabled:d}),n.jsxs("label",{htmlFor:`project-${W}`,className:"text-xs text-gray-300 cursor-pointer flex items-center",children:[n.jsx("div",{className:"w-2 h-2 rounded-full mr-1",style:{backgroundColor:lu[Z]}}),Z]})]},W))})]}),n.jsx(Ht,{children:n.jsx("div",{className:"h-80",children:n.jsx(Uv,{config:{"Network Capex":{color:lu["Network Capex"]},"Customer Lifetime":{color:lu["Customer Lifetime"]},"Sales & Service":{color:lu["Sales & Service"]},"Customer Experience":{color:lu["Customer Experience"]},"HR Analytics":{color:lu["HR Analytics"]}},children:n.jsx(ms,{width:"100%",height:"100%",children:n.jsxs(nc,{data:G,margin:{top:20,right:30,left:20,bottom:5},children:[n.jsx($s,{strokeDasharray:"3 3",stroke:"#444"}),n.jsx(is,{dataKey:"month",stroke:"#888"}),n.jsx(Gi,{stroke:"#888"}),n.jsx(yi,{content:n.jsx(Gst,{})}),n.jsx(xa,{}),d||a.includes("network-capex")?n.jsx(pi,{dataKey:"Network Capex",fill:lu["Network Capex"]}):null,d||a.includes("customer-lifetime")?n.jsx(pi,{dataKey:"Customer Lifetime",fill:lu["Customer Lifetime"]}):null,d||a.includes("sales-service-ai")?n.jsx(pi,{dataKey:"Sales & Service",fill:lu["Sales & Service"]}):null,d||a.includes("customer-experience")?n.jsx(pi,{dataKey:"Customer Experience",fill:lu["Customer Experience"]}):null,d||a.includes("hr-analytics")?n.jsx(pi,{dataKey:"HR Analytics",fill:lu["HR Analytics"]}):null]})})})})})]}),n.jsxs(jt,{className:"bg-beam-dark-accent/50 border-gray-700/50 text-white",children:[n.jsxs(wr,{className:"pb-2",children:[n.jsx(fr,{className:"text-lg font-medium",children:"Agent Cost Breakdown"}),n.jsx(Ii,{className:"text-gray-400",children:d?"Top agents by monthly cost":"Selected project agents"})]}),n.jsx(Ht,{children:n.jsxs(Mc,{className:"text-white",children:[n.jsx(Ic,{children:n.jsxs(Fs,{className:"hover:bg-beam-dark-accent/70 border-gray-700",children:[n.jsx(Or,{className:"text-gray-400",children:"Agent Name"}),n.jsx(Or,{className:"text-gray-400",children:"Project"}),n.jsx(Or,{className:"text-gray-400",children:"Model"}),n.jsx(Or,{className:"text-gray-400 text-right",children:"Daily Inferences"}),n.jsx(Or,{className:"text-gray-400 text-right",children:"Monthly Cost"}),n.jsx(Or,{className:"text-gray-400 text-right",children:"Trend"})]})}),n.jsx(Oc,{children:j.map(W=>n.jsxs(Fs,{className:"hover:bg-beam-dark-accent/70 border-gray-700",children:[n.jsx(Rr,{children:W.name}),n.jsx(Rr,{children:n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"w-2 h-2 rounded-full mr-2",style:{backgroundColor:lu[W.project]}}),W.project]})}),n.jsx(Rr,{children:W.model}),n.jsx(Rr,{className:"text-right",children:W.dailyInferences.toLocaleString()}),n.jsx(Rr,{className:"text-right font-mono",children:W.monthlyCost.toFixed(2)}),n.jsx(Rr,{className:"text-right",children:W.costTrend==="up"?n.jsx("span",{className:"text-red-400 inline-flex items-center",children:n.jsx(En,{className:"h-4 w-4 mr-1"})}):n.jsx("span",{className:"text-green-400 inline-flex items-center",children:n.jsx(tx,{className:"h-4 w-4 mr-1"})})})]},W.id))})]})})]})]})},Gst=({active:e,payload:t,label:r})=>e&&t&&t.length?n.jsx(Gv,{className:"bg-beam-dark-accent/90 border border-gray-700 text-white",payload:t,active:e,label:r}):null,gR=()=>[{id:"network-operations",name:"Network Operations Center",description:"Automated network monitoring, fault detection, and performance optimization",agentCount:8,tools:["Network Monitoring API","Performance Analytics Engine","Fault Detection System","Auto-Remediation Tools","Capacity Planning Models","Traffic Analysis Suite"],databases:["Network Topology DB","Performance Metrics DB","Fault Management DB","Configuration DB","Traffic Analytics DB"],globalGuardrails:["SLA Compliance Monitor","Network Security Policy","Performance Threshold Guards","Emergency Response Protocol"],localGuardrails:["Automated Escalation Rules","Change Management Controls","Resource Allocation Limits"],color:"border-t-blue-500",department:"Network"},{id:"customer-experience",name:"Customer Experience Center",description:"AI-powered customer support, service quality monitoring, and issue resolution",agentCount:6,tools:["Customer Support Chat","Service Diagnostics","Quality Monitoring","Issue Tracking System","Knowledge Base API","Sentiment Analysis"],databases:["Customer Profiles DB","Service History DB","Product Catalog DB","Support Tickets DB","Quality Metrics DB"],globalGuardrails:["Data Privacy Protection","Customer Communication Standards","Service Level Agreements","Escalation Procedures"],localGuardrails:["Response Time Limits","Quality Score Thresholds","Customer Satisfaction Guards"],color:"border-t-green-500",department:"CX"},{id:"billing-revenue",name:"Billing & Revenue Assurance",description:"Automated billing, usage analytics, fraud detection, and revenue optimization",agentCount:5,tools:["Billing Engine","Usage Analytics","Fraud Detection AI","Revenue Assurance Tools","Payment Processing","Pricing Optimization"],databases:["Billing Records DB","Usage Data DB","Customer Accounts DB","Pricing Models DB","Fraud Detection DB"],globalGuardrails:["Financial Compliance","Audit Trail Requirements","Revenue Protection Rules","Customer Billing Rights"],localGuardrails:["Billing Accuracy Checks","Fraud Score Thresholds","Payment Processing Limits"],color:"border-t-purple-500",department:"Sales & Service"},{id:"network-planning",name:"Network Planning & Optimization",description:"Long-term network planning, capacity forecasting, and infrastructure optimization",agentCount:4,tools:["Capacity Planning Models","Traffic Forecasting","Network Simulation","Coverage Analysis","Technology Migration Tools"],databases:["Network Assets DB","Traffic Patterns DB","Capacity Models DB","Geographic Data DB"],globalGuardrails:["Investment Approval Process","Technology Standards","Regulatory Compliance","Environmental Impact"],localGuardrails:["Budget Allocation Limits","Timeline Constraints","Resource Availability"],color:"border-t-orange-500",department:"Network"},{id:"service-provisioning",name:"Service Provisioning",description:"Automated service activation, configuration, and customer onboarding",agentCount:5,tools:["Service Activation Engine","Configuration Management","Customer Onboarding Flow","Service Testing Suite","Inventory Management"],databases:["Service Catalog DB","Customer Orders DB","Network Inventory DB","Configuration DB"],globalGuardrails:["Service Quality Standards","Customer Data Protection","Activation Time Limits","Compliance Verification"],localGuardrails:["Configuration Validation","Resource Availability Checks","Service Testing Requirements"],color:"border-t-cyan-500",department:"Consumer Business"},{id:"marketing-analytics",name:"Marketing & Sales Analytics",description:"Customer segmentation, campaign optimization, and sales performance analytics",agentCount:4,tools:["Customer Segmentation","Campaign Management","Sales Analytics","Churn Prediction","Recommendation Engine"],databases:["Customer Behavior DB","Campaign Data DB","Sales Performance DB","Market Research DB"],globalGuardrails:["Marketing Compliance","Customer Consent Management","Brand Guidelines","Privacy Regulations"],localGuardrails:["Campaign Budget Limits","Targeting Restrictions","Performance Thresholds"],color:"border-t-pink-500",department:"Sales & Service"}],Hst=()=>{const[e,t]=U.useState([]),[r,i]=U.useState(!1),[a,l]=U.useState(null),d=async()=>{i(!0);try{const w=await fetch("/api/agents");if(w.ok){const j=await w.json();t(j.agents||[]),l(new Date),console.log("Fetched agents:",j.agents)}else console.error("Failed to fetch agents:",w.status)}catch(w){console.error("Error fetching agents:",w)}finally{i(!1)}};U.useEffect(()=>{d();const w=setInterval(d,1e4);return()=>clearInterval(w)},[]);const s=w=>{switch(w){case"active":return n.jsx(ro,{className:"h-4 w-4 text-green-400"});case"failed":return n.jsx(BD,{className:"h-4 w-4 text-red-400"});default:return n.jsx($a,{className:"h-4 w-4 text-yellow-400"})}},p=w=>{switch(w){case"generic":return"border-purple-500 text-purple-400";case"strands":return"border-green-500 text-green-400";case"agentcore":return"border-blue-500 text-blue-400";default:return"border-gray-500 text-gray-400"}},x={total:e.length,generic:e.filter(w=>w.framework==="generic").length,strands:e.filter(w=>w.framework==="strands").length,agentcore:e.filter(w=>w.framework==="agentcore").length,active:e.filter(w=>w.status==="active").length,failed:e.filter(w=>w.status==="failed").length};return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"text-lg font-semibold text-white",children:"Agent Monitoring"}),n.jsx("p",{className:"text-sm text-gray-400",children:"Real-time agent status and performance"})]}),n.jsxs("div",{className:"flex items-center gap-4",children:[a&&n.jsxs("span",{className:"text-xs text-gray-400",children:["Last updated: ",a.toLocaleTimeString()]}),n.jsx(lt,{onClick:d,disabled:r,size:"sm",className:"bg-blue-600 hover:bg-blue-700",children:r?n.jsx(uk,{className:"h-4 w-4 animate-spin"}):n.jsx(uk,{className:"h-4 w-4"})})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-4",children:[n.jsx(jt,{className:"bg-beam-dark-accent border-gray-700",children:n.jsx(Ht,{className:"p-3",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-xl font-bold text-white",children:x.total}),n.jsx("div",{className:"text-xs text-gray-400",children:"Total"})]})})}),n.jsx(jt,{className:"bg-beam-dark-accent border-gray-700",children:n.jsx(Ht,{className:"p-3",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-xl font-bold text-green-400",children:x.active}),n.jsx("div",{className:"text-xs text-gray-400",children:"Active"})]})})}),n.jsx(jt,{className:"bg-beam-dark-accent border-gray-700",children:n.jsx(Ht,{className:"p-3",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-xl font-bold text-red-400",children:x.failed}),n.jsx("div",{className:"text-xs text-gray-400",children:"Failed"})]})})}),n.jsx(jt,{className:"bg-beam-dark-accent border-gray-700",children:n.jsx(Ht,{className:"p-3",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-xl font-bold text-purple-400",children:x.generic}),n.jsx("div",{className:"text-xs text-gray-400",children:"Generic"})]})})}),n.jsx(jt,{className:"bg-beam-dark-accent border-gray-700",children:n.jsx(Ht,{className:"p-3",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-xl font-bold text-green-400",children:x.strands}),n.jsx("div",{className:"text-xs text-gray-400",children:"Strands"})]})})}),n.jsx(jt,{className:"bg-beam-dark-accent border-gray-700",children:n.jsx(Ht,{className:"p-3",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-xl font-bold text-blue-400",children:x.agentcore}),n.jsx("div",{className:"text-xs text-gray-400",children:"AgentCore"})]})})})]}),n.jsxs(jt,{className:"bg-beam-dark-accent border-gray-700",children:[n.jsx(wr,{children:n.jsxs(fr,{className:"flex items-center gap-2 text-white",children:[n.jsx(Hi,{className:"h-5 w-5"}),"Live Agents (",e.length,")"]})}),n.jsx(Ht,{children:e.length===0?n.jsxs("div",{className:"text-center py-8",children:[n.jsx(Hi,{className:"h-12 w-12 text-gray-600 mx-auto mb-4"}),n.jsx("p",{className:"text-gray-400",children:"No agents created yet"}),n.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Create your first agent to see it here"})]}):n.jsx("div",{className:"space-y-3",children:e.map(w=>n.jsx(jt,{className:"bg-gray-800/50 border-gray-600",children:n.jsxs(Ht,{className:"p-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[s(w.status),n.jsx("span",{className:"font-medium text-white",children:w.name})]}),n.jsx(Tt,{variant:"outline",className:p(w.framework),children:w.framework})]}),n.jsx("div",{className:"text-xs text-gray-400",children:new Date(w.created_at).toLocaleString()})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2 text-xs",children:[n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-400",children:"ID:"}),n.jsxs("span",{className:"text-white ml-1 font-mono",children:[w.id.substring(0,8),"..."]})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-400",children:"Status:"}),n.jsx("span",{className:`ml-1 ${w.status==="active"?"text-green-400":w.status==="failed"?"text-red-400":"text-yellow-400"}`,children:w.status})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-400",children:"Framework:"}),n.jsx("span",{className:"text-white ml-1",children:w.framework})]})]}),w.framework_metadata&&n.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-700",children:[n.jsx("div",{className:"text-xs text-gray-300 mb-2",children:"Framework Details:"}),w.framework==="strands"&&w.framework_metadata.reasoning_capabilities&&n.jsx("div",{className:"flex flex-wrap gap-1",children:w.framework_metadata.reasoning_capabilities.map(j=>n.jsx(Tt,{variant:"outline",className:"text-xs border-green-600 text-green-300",children:j},j))}),w.framework==="agentcore"&&n.jsxs("div",{className:"flex gap-2 text-xs",children:[n.jsx("span",{className:"text-gray-400",children:"Action Groups:"}),n.jsx("span",{className:"text-white",children:w.framework_metadata.action_groups_count||0}),n.jsx("span",{className:"text-gray-400",children:"Knowledge Bases:"}),n.jsx("span",{className:"text-white",children:w.framework_metadata.knowledge_bases_count||0})]})]}),w.error_message&&n.jsx("div",{className:"mt-3 p-2 bg-red-500/10 border border-red-500/20 rounded text-xs",children:n.jsxs("span",{className:"text-red-400",children:["Error: ",w.error_message]})})]})},w.id))})})]})]})},qst=({activeTab:e,setActiveTab:t,selectedProject:r,setSelectedProject:i,projectData:a,selectedNode:l,onNodeClick:d,decisionPathMetadata:s,dataLineageMetadata:p})=>{var L,B,V,$,G;Ah();const{currentIndustry:x}=b_(),w=x.id==="telco"?Object.fromEntries(gR().map(W=>[W.id,{department:W.department,agents:Array(W.agentCount).fill(null).map((Z,se)=>({name:`Agent ${se+1}`}))}])):g$();U.useEffect(()=>{e&&localStorage.setItem("command-centre-active-tab",e)},[e]),(L=Object.entries(w).find(([W])=>W===r))==null||L[1];const j=x.id==="telco"?gR():[],P=x.id==="telco"?Object.fromEntries(j.map(W=>[W.id,W.name])):{"network-capex":"Network Capex Investment Management","customer-lifetime":"Customer Lifetime Value Management","sales-service-ai":"Sales & Service Optimization","customer-experience":"Customer Experience Enhancement","hr-analytics":"HR Analytics & Talent Management",default:"Default Project"},F=W=>{t(W),localStorage.setItem("command-centre-active-tab",W),window.history.pushState({tab:W,project:r},"",`?tab=${W}${r?`&project=${r}`:""}`)};return n.jsxs($i,{defaultValue:"dashboard",value:e,onValueChange:F,className:"w-full",children:[n.jsxs(Di,{className:"grid grid-cols-7 mb-6 bg-beam-dark-accent/40 border border-gray-700/50 rounded-xl p-1 gap-1 w-full max-w-full overflow-hidden",children:[n.jsxs(Jt,{value:"dashboard",className:"rounded-lg flex items-center gap-1 md:gap-2 data-[state=active]:bg-beam-blue data-[state=active]:text-white data-[state=active]:shadow-md text-xs md:text-sm min-w-0",children:[n.jsx(Co,{size:16,className:"md:w-[18px] md:h-[18px] flex-shrink-0"}),n.jsx("span",{className:"hidden sm:inline font-medium truncate",children:"Dashboard"})]}),n.jsxs(Jt,{value:"traceability",className:"rounded-lg flex items-center gap-1 md:gap-2 data-[state=active]:bg-beam-blue data-[state=active]:text-white data-[state=active]:shadow-md text-xs md:text-sm min-w-0",children:[n.jsx(mve,{size:16,className:"md:w-[18px] md:h-[18px] flex-shrink-0"}),n.jsx("span",{className:"hidden sm:inline font-medium truncate",children:"Traceability"})]}),n.jsxs(Jt,{value:"tools",className:"rounded-lg flex items-center gap-1 md:gap-2 data-[state=active]:bg-beam-blue data-[state=active]:text-white data-[state=active]:shadow-md text-xs md:text-sm min-w-0",children:[n.jsx(Vc,{size:16,className:"md:w-[18px] md:h-[18px] flex-shrink-0"}),n.jsx("span",{className:"hidden sm:inline font-medium truncate",children:"Tools"})]}),n.jsxs(Jt,{value:"data",className:"rounded-lg flex items-center gap-1 md:gap-2 data-[state=active]:bg-beam-blue data-[state=active]:text-white data-[state=active]:shadow-md text-xs md:text-sm min-w-0",children:[n.jsx(ln,{size:16,className:"md:w-[18px] md:h-[18px] flex-shrink-0"}),n.jsx("span",{className:"hidden sm:inline font-medium truncate",children:"Data"})]}),n.jsxs(Jt,{value:"governance",className:"rounded-lg flex items-center gap-1 md:gap-2 data-[state=active]:bg-beam-blue data-[state=active]:text-white data-[state=active]:shadow-md text-xs md:text-sm min-w-0",children:[n.jsx(dn,{size:16,className:"md:w-[18px] md:h-[18px] flex-shrink-0"}),n.jsx("span",{className:"hidden sm:inline font-medium truncate",children:"Governance"})]}),n.jsxs(Jt,{value:"cost",className:"rounded-lg flex items-center gap-1 md:gap-2 data-[state=active]:bg-beam-blue data-[state=active]:text-white data-[state=active]:shadow-md text-xs md:text-sm min-w-0",children:[n.jsx(tve,{size:16,className:"md:w-[18px] md:h-[18px] flex-shrink-0"}),n.jsx("span",{className:"hidden sm:inline font-medium truncate",children:"Cost"})]}),n.jsxs(Jt,{value:"monitoring",className:"rounded-lg flex items-center gap-1 md:gap-2 data-[state=active]:bg-beam-blue data-[state=active]:text-white data-[state=active]:shadow-md text-xs md:text-sm min-w-0",children:[n.jsx(bs,{size:16,className:"md:w-[18px] md:h-[18px] flex-shrink-0"}),n.jsx("span",{className:"hidden sm:inline font-medium truncate",children:"Monitor"})]})]}),n.jsx(ur,{value:"dashboard",className:"mt-0",children:n.jsx("div",{className:"glass-panel backdrop-blur-md bg-beam-dark-accent/30 border border-gray-700/50 rounded-xl p-6 shadow-lg",children:n.jsx(_nt,{projects:x.id==="telco"?gR():Object.entries(w).map(([W,Z])=>{var se,ae,ce;return{id:W,name:P[W]||W,description:`${((se=Z.agents)==null?void 0:se.length)||1} agent${((ae=Z.agents)==null?void 0:ae.length)!==1?"s":""}`,agentCount:((ce=Z.agents)==null?void 0:ce.length)||1,tools:["API Gateway","Data Connector","Prediction Engine"],databases:["Customer DB","Analytics Warehouse"],globalGuardrails:["PII Protection","Content Filtering"],localGuardrails:["Network Data Protection","Custom Regex Filter"],color:W==="network-capex"?"border-blue-500":W==="customer-lifetime"?"border-purple-500":W==="sales-service-ai"?"border-green-500":W==="customer-experience"?"border-amber-500":W==="hr-analytics"?"border-pink-500":"border-gray-500",department:Z.department||"General"}}),onSelectProject:W=>{i(W),t("traceability")}})})}),n.jsx(ur,{value:"traceability",className:"mt-0",children:n.jsx(uit,{decisionNodes:((B=a[r])==null?void 0:B.decisionNodes)||[],lineageNodes:((V=a[r])==null?void 0:V.lineageNodes)||[],lineageEdges:(($=a[r])==null?void 0:$.lineageEdges)||[],decisionPathMetadata:s,dataLineageMetadata:p,selectedNode:l,onNodeClick:d,projectName:P[r]||"Project",agents:((G=a[r])==null?void 0:G.agents)||[]})}),n.jsx(ur,{value:"tools",className:"mt-0",children:n.jsx(vit,{industry:x.id})}),n.jsx(ur,{value:"data",className:"mt-0",children:n.jsx(Est,{industry:x.id})}),n.jsx(ur,{value:"governance",className:"mt-0",children:n.jsx(Tst,{industry:x.id})}),n.jsx(ur,{value:"cost",className:"mt-0",children:n.jsx(Ust,{selectedProject:r,setSelectedProject:i})}),n.jsx(ur,{value:"monitoring",className:"mt-0",children:n.jsx(Hst,{})})]})},Wst=()=>({"network-operations":{department:"Network",decisionNodes:Kst(),lineageNodes:Zst(),lineageEdges:Yst(),agents:[{name:"Network Performance Monitor",description:"Real-time monitoring of network performance and quality metrics",model:{name:"GPT-4o",provider:"OpenAI",paramSize:"1.76 trillion",contextLength:"128,000 tokens",latency:"220ms",role:"Monitors network KPIs, latency, throughput, and service quality"},tools:["Network monitoring APIs","Performance analytics","Alert systems"],dataAccess:["Network topology","Performance metrics","Traffic analytics"]},{name:"Capacity Planning Agent",description:"Optimizes network capacity and predicts infrastructure needs",model:{name:"Claude 3 Opus",provider:"Anthropic",paramSize:"1.5 trillion",contextLength:"200,000 tokens",latency:"310ms",role:"Analyzes traffic patterns and forecasts capacity requirements"},tools:["Capacity modeling","Traffic prediction","Resource optimization"],dataAccess:["Traffic data","Network utilization","Growth projections"]},{name:"Fault Detection Agent",description:"Identifies and diagnoses network faults and service disruptions",model:{name:"GPT-4 Turbo",provider:"OpenAI",paramSize:"1.76 trillion",contextLength:"128,000 tokens",latency:"190ms",role:"Detects anomalies and automates fault resolution procedures"},tools:["Anomaly detection","Root cause analysis","Auto-remediation"],dataAccess:["Network logs","Alarm data","Configuration databases"]}],workflow:[{phase:"Network Monitoring",description:"Continuous monitoring of network performance and health",agents:["Network Performance Monitor","Fault Detection Agent"],outputs:["Performance dashboards","Fault alerts","Quality metrics"]},{phase:"Capacity Planning",description:"Analyze traffic patterns and plan infrastructure scaling",agents:["Capacity Planning Agent","Network Performance Monitor"],outputs:["Capacity forecasts","Resource requirements","Scaling plans"]}]},"customer-experience":{department:"CX",decisionNodes:xR(),lineageNodes:yR(),lineageEdges:vR(),agents:[{name:"Customer Support Agent",description:"Handles customer inquiries and technical support requests",model:{name:"Claude 3 Sonnet",provider:"Anthropic",paramSize:"540 billion",contextLength:"180,000 tokens",latency:"200ms",role:"Provides 24/7 customer support and issue resolution"},tools:["Knowledge base","Ticketing system","Service diagnostics"],dataAccess:["Customer profiles","Service history","Product catalogs"]},{name:"Network Diagnostics Agent",description:"Diagnoses customer connectivity and service quality issues",model:{name:"GPT-4o",provider:"OpenAI",paramSize:"1.76 trillion",contextLength:"128,000 tokens",latency:"240ms",role:"Analyzes customer connection quality and troubleshoots issues"},tools:["Network testing","Signal analysis","Performance diagnostics"],dataAccess:["Network topology","Customer equipment","Service logs"]}]},"billing-revenue":{department:"Sales & Service",decisionNodes:xR(),lineageNodes:yR(),lineageEdges:vR(),agents:[{name:"Billing Automation Agent",description:"Automates billing processes and revenue assurance",model:{name:"GPT-4 Turbo",provider:"OpenAI",paramSize:"1.76 trillion",contextLength:"128,000 tokens",latency:"210ms",role:"Processes usage data and generates accurate customer bills"},tools:["Billing engines","Usage analytics","Revenue assurance"],dataAccess:["Usage records","Pricing models","Customer accounts"]},{name:"Fraud Prevention Agent",description:"Detects and prevents telecom fraud and revenue leakage",model:{name:"Llama 3 70B",provider:"Meta",paramSize:"70 billion",contextLength:"8,000 tokens",latency:"180ms",role:"Identifies suspicious usage patterns and prevents fraud"},tools:["Fraud detection algorithms","Pattern analysis","Risk scoring"],dataAccess:["Call detail records","Usage patterns","Fraud databases"]}]},default:{department:"General",decisionNodes:xR(),lineageNodes:yR(),lineageEdges:vR(),agents:[{name:"General Telco Assistant",description:"Handles general telecommunications operations and support",model:{name:"GPT-4o",provider:"OpenAI",paramSize:"1.76 trillion",contextLength:"128,000 tokens",latency:"220ms",role:"Multi-purpose telecommunications assistance and operations"}}]}});function Kst(){return[{id:"start",type:"start",label:"Network Alert",content:"Network performance degradation detected",connects:["tool1"],position:{x:50,y:100}},{id:"tool1",type:"tool",label:"Performance Analysis",content:"Analyzing network performance metrics",connects:["decision1"],position:{x:250,y:100},toolDetails:{input:"Network metrics",output:"Performance assessment",databases:["NetworkDB"],executionTime:"1.8s",query:"SELECT * FROM network_metrics WHERE timestamp > ?"}},{id:"decision1",type:"decision",label:"Severity Assessment",content:"Evaluating impact and severity level",connects:["tool2","alternate1"],position:{x:450,y:100}},{id:"tool2",type:"tool",label:"Root Cause Analysis",content:"Identifying source of performance issue",connects:["tool3"],position:{x:650,y:100},toolDetails:{input:"Performance data",output:"Root cause identification",databases:["FaultDB"],executionTime:"2.1s",query:"CALL analyze_network_fault(?)"}},{id:"alternate1",type:"alternate",label:"Low Impact",content:"Minor issue - monitoring only",connects:["end"],position:{x:450,y:250}},{id:"tool3",type:"tool",label:"Auto Remediation",content:"Attempting automated fix procedures",connects:["decision2"],position:{x:850,y:100},toolDetails:{input:"Fault diagnosis",output:"Remediation result",databases:["ConfigDB"],executionTime:"3.5s",query:"EXEC auto_remediate_fault(?)"}},{id:"decision2",type:"decision",label:"Remediation Success",content:"Checking if auto-fix resolved the issue",connects:["end","alternate2"],position:{x:1050,y:100}},{id:"alternate2",type:"alternate",label:"Manual Intervention",content:"Escalating to network operations team",connects:["end"],position:{x:1050,y:250}},{id:"end",type:"end",label:"Resolution Complete",content:"Network issue resolved or escalated",connects:[],position:{x:1250,y:200}}]}function Zst(){return[{id:"networkdb",type:"database",label:"Network DB",content:"Network topology and configuration",position:{x:50,y:400},isCombinedView:!0},{id:"performanceapi",type:"api",label:"Performance API",content:"Real-time network metrics",position:{x:250,y:400},isCombinedView:!0},{id:"alertsystem",type:"file",label:"Alert System",content:"Network monitoring alerts",position:{x:450,y:400},isCombinedView:!0},{id:"faultdb",type:"database",label:"Fault DB",content:"Fault management system",position:{x:650,y:400},isCombinedView:!0},{id:"analytics",type:"transformation",label:"Analytics Engine",content:"Network performance analytics",position:{x:850,y:400},isCombinedView:!0},{id:"configdb",type:"database",label:"Config DB",content:"Network configuration management",position:{x:1050,y:400},isCombinedView:!0},{id:"reports",type:"file",label:"Performance Reports",content:"Network performance dashboards",position:{x:1250,y:400},isCombinedView:!0}]}function Yst(){return[{source:"networkdb",target:"alertsystem",type:"data_flow"},{source:"performanceapi",target:"analytics",type:"data_flow"},{source:"alertsystem",target:"faultdb",type:"transformation"},{source:"analytics",target:"faultdb",type:"data_flow"},{source:"faultdb",target:"configdb",type:"dependency"},{source:"configdb",target:"reports",type:"data_flow"}]}function xR(e){return[{id:"start",type:"start",label:"Start Process",content:"Telco process initiated",connects:["tool1"],position:{x:50,y:100}},{id:"tool1",type:"tool",label:"Data Collection",content:"Gathering network and customer data",connects:["decision1"],position:{x:250,y:100},toolDetails:{input:"Service request",output:"Network data",databases:["TelcoDB"],executionTime:"0.9s",query:"SELECT * FROM network_data WHERE ..."}},{id:"decision1",type:"decision",label:"Service Check",content:"Verifying service availability",connects:["tool2","alternate1"],position:{x:450,y:100}},{id:"tool2",type:"tool",label:"Quality Assessment",content:"Analyzing service quality metrics",connects:["decision2"],position:{x:650,y:100},toolDetails:{input:"Network data",output:"Quality metrics",databases:["QualityDB"],executionTime:"1.1s",query:"CALL assess_service_quality(...)"}},{id:"alternate1",type:"alternate",label:"Service Unavailable",content:"Service restoration required",connects:["end"],position:{x:450,y:250}},{id:"decision2",type:"decision",label:"Quality Check",content:"Determining if quality meets standards",connects:["tool3","alternate2"],position:{x:850,y:100}},{id:"tool3",type:"tool",label:"Service Optimization",content:"Optimizing network performance",connects:["end"],position:{x:1050,y:100},toolDetails:{input:"Quality assessment",output:"Optimized service",databases:["ConfigDB"],executionTime:"2.0s",query:"UPDATE network_config SET ..."}},{id:"alternate2",type:"alternate",label:"Quality Issue",content:"Performance improvement needed",connects:["tool3"],position:{x:850,y:250}},{id:"end",type:"end",label:"Process Complete",content:"Telco process completed",connects:[],position:{x:1250,y:150}}]}function yR(e){return[{id:"telcodb",type:"database",label:"Telco DB",content:"Core telecommunications data",position:{x:50,y:400},isCombinedView:!0},{id:"networkapi",type:"api",label:"Network API",content:"Network service interface",position:{x:250,y:400},isCombinedView:!0},{id:"servicedata",type:"file",label:"Service Data",content:"Customer service records",position:{x:450,y:400},isCombinedView:!0},{id:"qualitydb",type:"database",label:"Quality DB",content:"Service quality metrics",position:{x:650,y:400},isCombinedView:!0},{id:"analytics",type:"transformation",label:"Network Analytics",content:"Performance analysis engine",position:{x:850,y:400},isCombinedView:!0},{id:"configdb",type:"database",label:"Config DB",content:"Network configuration database",position:{x:1050,y:400},isCombinedView:!0},{id:"reports",type:"file",label:"Service Reports",content:"Network performance reports",position:{x:1250,y:400},isCombinedView:!0}]}function vR(e){return[{source:"telcodb",target:"servicedata",type:"data_flow"},{source:"networkapi",target:"analytics",type:"data_flow"},{source:"servicedata",target:"qualitydb",type:"transformation"},{source:"analytics",target:"qualitydb",type:"data_flow"},{source:"qualitydb",target:"configdb",type:"dependency"},{source:"configdb",target:"reports",type:"data_flow"}]}const Xst=()=>{const{currentIndustry:e}=b_(),[t,r]=U.useState("dashboard"),[i,a]=U.useState(null),[l,d]=U.useState(e.id==="telco"?"network-operations":"consumer-banking"),s=U.useRef(!0),p=U.useMemo(()=>e.id==="telco"?Wst():g$(),[e.id]);ke.useEffect(()=>{const S=e.id==="telco"?"network-operations":"consumer-banking";d(S)},[e.id]);const x=U.useCallback(S=>{s.current&&a(S===i?null:S)},[i]),w=U.useCallback(S=>{s.current&&r(S)},[]),j=U.useCallback(S=>{s.current&&(d(S),t!=="cost"&&r("traceability"))},[t]);return ke.useEffect(()=>()=>{s.current=!1},[]),n.jsx(Ia,{children:n.jsx("div",{className:"flex-1 h-screen overflow-y-auto overflow-x-hidden bg-beam-dark bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-gray-900 via-beam-dark to-beam-dark text-beam-text",children:n.jsx("div",{className:"w-full p-6 md:p-8",children:n.jsxs("div",{className:"flex flex-col gap-6 max-w-full",children:[n.jsx("div",{className:"glass-panel backdrop-blur-md bg-beam-dark-accent/30 border border-gray-700/50 rounded-xl p-6 shadow-lg",children:n.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[n.jsxs("div",{className:"mb-4 md:mb-0",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"h-2 w-2 rounded-full bg-green-500 animate-pulse"}),n.jsx("span",{className:"text-green-400 text-sm",children:"Active"})]}),n.jsx("h1",{className:"text-3xl font-bold text-white mt-1 mb-2",children:e.displayName}),n.jsxs("p",{className:"text-gray-300",children:["Monitor, manage and govern your ",e.name," AI agents in real-time"]})]}),n.jsx("div",{className:"flex gap-3 items-center",children:n.jsx(bnt,{})})]})}),n.jsx(qst,{activeTab:t,setActiveTab:w,selectedProject:l,setSelectedProject:j,projectData:p,selectedNode:i,onNodeClick:x,decisionPathMetadata:Bst,dataLineageMetadata:$st})]})})})})},Jst=({reasoning:e,isVisible:t})=>{if(!t)return null;const r=()=>typeof e=="string"?e:[`Objective: ${e.objective||"Not specified"}`,`Thought: ${e.thought||""}`,"Steps:",...(e.reasoning||[]).map(i=>{if(typeof i=="string")return`- ${i}`;{const a=i.confidence?` (Confidence: ${(i.confidence*100).toFixed(1)}%)`:"";return`- ${i.step}${a}`}}),"Constraints:",...(e.constraints||[]).map(i=>`- ${i}`),e.tools?`Tools: ${e.tools.join(", ")}`:"",e.databases?`Databases: ${e.databases.join(", ")}`:"",`Verification: ${e.verification||""}`,`Overall Confidence: ${e.confidence?(e.confidence*100).toFixed(1)+"%":"Not specified"}`].filter(Boolean).join(`
`);return n.jsxs("div",{className:"mt-1 rounded-lg border border-amber-500/40 bg-amber-500/10 p-3 text-sm text-gray-300",children:[n.jsxs("div",{className:"mb-1 flex items-center text-xs text-amber-400",children:[n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"mr-1 h-4 w-4",children:[n.jsx("path",{d:"M10 12a2 2 0 100-4 2 2 0 000 4z"}),n.jsx("path",{fillRule:"evenodd",d:"M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z",clipRule:"evenodd"})]}),n.jsx("span",{children:"Agent reasoning"})]}),n.jsx("div",{className:"whitespace-pre-wrap",children:r()})]})},Qst=({agent:e})=>{const[t,r]=U.useState([]),[i,a]=U.useState(""),[l,d]=U.useState(!1),s=()=>{if(!i.trim())return;const p={role:"user",content:i,timestamp:new Date().toLocaleTimeString()};let x;e.id==="investment-advisor"?x={role:"agent",content:"Based on your risk profile and current market conditions, I recommend increasing your allocation to technology stocks by 5% and reducing bonds by 3%. This adjustment aligns with your growth objectives while maintaining appropriate risk levels.",timestamp:new Date().toLocaleTimeString(),reasoning:{objective:"Optimize portfolio allocation based on client risk profile and market analysis",thought:"The current market presents opportunities in the technology sector while bond yields remain relatively low.",reasoning:[{step:"Analyze current portfolio allocation against target",confidence:.95},{step:"Assess market conditions and sector performance",confidence:.88},{step:"Evaluate risk tolerance and investment timeline",confidence:.92},{step:"Generate personalized recommendation",confidence:.89}],constraints:["Must maintain diversification requirements","Cannot exceed 70% equity allocation","Must consider tax implications"],confidence:.91}}:e.id==="portfolio-rebalancer"?x={role:"agent",content:"Your portfolio has drifted 2.3% from target allocation. I can automatically rebalance by selling $1,200 in large-cap growth and purchasing $1,200 in international bonds. This will restore your 60/40 equity/bond ratio.",timestamp:new Date().toLocaleTimeString(),reasoning:{objective:"Maintain target portfolio allocation through automated rebalancing",thought:"Portfolio drift has exceeded the 2% threshold, triggering rebalancing recommendation.",reasoning:[{step:"Monitor real-time portfolio allocation",confidence:.98},{step:"Compare against target allocation parameters",confidence:.96},{step:"Calculate optimal rebalancing trades",confidence:.94},{step:"Assess transaction costs and tax impact",confidence:.87}],confidence:.94}}:x={role:"agent",content:"I've identified 3 optimization opportunities: You could save $180/month by refinancing your mortgage at current rates, optimize your credit card usage to improve your credit score, and consider a high-yield savings account for your emergency fund.",timestamp:new Date().toLocaleTimeString(),reasoning:{objective:"Identify and present financial optimization opportunities",thought:"Comprehensive analysis of financial health reveals several actionable improvements.",reasoning:[{step:"Analyze current debt structure and rates",confidence:.93},{step:"Review spending patterns and credit utilization",confidence:.91},{step:"Evaluate savings account performance",confidence:.89},{step:"Calculate potential savings and benefits",confidence:.95}],confidence:.92}},r([...t,p,x]),a("")};return n.jsxs(Ml,{children:[n.jsx(F_,{asChild:!0,children:n.jsx(lt,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 text-gray-400 hover:text-white",children:n.jsx(_s,{className:"h-4 w-4"})})}),n.jsxs(Qo,{className:"bg-beam-dark-accent border-gray-700 text-white max-w-2xl",children:[n.jsx(el,{children:n.jsxs(tl,{className:"flex items-center gap-2",children:[n.jsx(Hi,{className:"h-5 w-5 text-true-red"}),"Chat with ",e.name]})}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("span",{className:"text-sm text-gray-400",children:["Model: ",e.model]}),n.jsxs(lt,{variant:"outline",size:"sm",onClick:()=>d(!l),className:"text-xs",children:[l?"Hide":"Show"," Reasoning"]})]}),n.jsx("div",{className:"h-96 overflow-y-auto border border-gray-700 rounded-lg p-4 space-y-4",children:t.length===0?n.jsxs("div",{className:"text-center text-gray-400 py-8",children:[n.jsx(Hi,{className:"h-12 w-12 mx-auto mb-4 text-gray-600"}),n.jsx("p",{children:"Start a conversation with your AI agent"})]}):t.map((p,x)=>n.jsx("div",{className:`flex ${p.role==="user"?"justify-end":"justify-start"}`,children:n.jsxs("div",{className:`max-w-[80%] rounded-lg p-3 ${p.role==="user"?"bg-true-red/20 border border-true-red/30":"bg-beam-dark-accent/50 border border-gray-700/50"}`,children:[n.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-400 mb-1",children:[p.role==="agent"&&n.jsx(Hi,{className:"h-3 w-3"}),p.role==="user"?"You":e.name,n.jsxs("span",{children:["• ",p.timestamp]})]}),n.jsx("p",{className:"text-sm",children:p.content}),p.reasoning&&l&&n.jsx(Jst,{reasoning:p.reasoning,isVisible:!0})]})},x))}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx(An,{value:i,onChange:p=>a(p.target.value),placeholder:"Ask your agent a question...",className:"bg-beam-dark-accent/50 border-gray-700 text-white",onKeyPress:p=>p.key==="Enter"&&s()}),n.jsx(lt,{onClick:s,className:"bg-true-red hover:bg-true-red/90",children:n.jsx(zF,{className:"h-4 w-4"})})]})]})]})]})},Qy=()=>{U.useState(null);const e=[{id:"market-research-agent",name:"AI Market Research Agent",description:"Continuously scans global markets, news, and economic indicators to identify investment opportunities and risks",status:"active",icon:$c,color:"text-green-400",bgColor:"bg-green-900/20",borderColor:"border-green-700/30",model:"GPT-4o + Web Research",capabilities:["Real-time News Analysis","Economic Data Mining","Sentiment Analysis","Risk Detection"],lastAction:"Identified emerging tech opportunity in quantum computing - 15 min ago",researchSources:["Reuters","Bloomberg","SEC Filings","Fed Reports"]},{id:"trend-analysis-agent",name:"Predictive Trend Analyzer",description:"Uses machine learning to identify market patterns and predict future trends across asset classes",status:"analyzing",icon:to,color:"text-blue-400",bgColor:"bg-blue-900/20",borderColor:"border-blue-700/30",model:"Claude 3 Opus + ML Models",capabilities:["Pattern Recognition","Predictive Analytics","Cross-Asset Analysis","Volatility Forecasting"],lastAction:"Detected 78% probability of sector rotation into energy - 8 min ago",confidence:94},{id:"investment-advisor",name:"Personalized Investment Advisor",description:"Analyzes your complete financial profile and generates personalized investment recommendations",status:"active",icon:En,color:"text-purple-400",bgColor:"bg-purple-900/20",borderColor:"border-purple-700/30",model:"GPT-4o",capabilities:["Portfolio Analysis","Risk Assessment","Tax Optimization","Goal-Based Planning"],lastAction:"Generated ESG-focused portfolio rebalancing strategy - 1 hour ago"},{id:"risk-sentinel",name:"AI Risk Sentinel",description:"Advanced risk monitoring system that analyzes global events and their potential impact on your portfolio",status:"monitoring",icon:dn,color:"text-amber-400",bgColor:"bg-amber-900/20",borderColor:"border-amber-700/30",model:"Claude 3 Opus + Risk Models",capabilities:["Geopolitical Analysis","Correlation Monitoring","Stress Testing","Black Swan Detection"],lastAction:"All systems normal - Monitoring 247 risk factors",riskFactors:247},{id:"web-intelligence-agent",name:"Web Intelligence Aggregator",description:"Crawls financial websites, forums, and social media to gather market intelligence and sentiment data",status:"active",icon:Zs,color:"text-cyan-400",bgColor:"bg-cyan-900/20",borderColor:"border-cyan-700/30",model:"GPT-4o + Web Crawling",capabilities:["Social Sentiment","Forum Analysis","Insider Tracking","Regulatory Monitoring"],lastAction:"Detected unusual options activity in NVDA - High conviction signal",signalStrength:"High"},{id:"financial-health",name:"Proactive Wealth Optimizer",description:"Monitors overall financial health and identifies optimization opportunities across all accounts",status:"optimizing",icon:bs,color:"text-green-500",bgColor:"bg-green-900/20",borderColor:"border-green-700/30",model:"GPT-4 Turbo",capabilities:["Multi-Account Analysis","Tax Loss Harvesting","Rebalancing","Cash Management"],lastAction:"Found $12,400 in tax-loss harvesting opportunities",potentialSavings:"$12,400"}],t=r=>{switch(r){case"active":return n.jsx(Tt,{className:"bg-green-900/20 text-green-300 border-green-700/30",children:"Active"});case"monitoring":return n.jsx(Tt,{className:"bg-blue-900/20 text-blue-300 border-blue-700/30",children:"Monitoring"});case"analyzing":return n.jsx(Tt,{className:"bg-purple-900/20 text-purple-300 border-purple-700/30",children:"Analyzing"});case"optimizing":return n.jsx(Tt,{className:"bg-amber-900/20 text-amber-300 border-amber-700/30",children:"Optimizing"});default:return n.jsx(Tt,{variant:"outline",children:"Inactive"})}};return n.jsxs("div",{className:"space-y-4",children:[n.jsx(jt,{className:"bg-beam-dark-accent/70 border-gray-700",children:n.jsxs(wr,{className:"pb-3",children:[n.jsxs(fr,{className:"text-lg text-white flex items-center",children:[n.jsx(ti,{className:"mr-2 h-5 w-5 text-true-red"}),"AI Wealth Research Team"]}),n.jsx("p",{className:"text-sm text-gray-400",children:"6 agents actively managing your portfolio"})]})}),n.jsx("div",{className:"space-y-3",children:e.map(r=>{const i=r.icon;return n.jsx(jt,{className:`bg-beam-dark-accent/50 border ${r.borderColor} hover:border-true-red/50 transition-all duration-200 hover:shadow-lg`,children:n.jsxs(Ht,{className:"p-4",children:[n.jsxs("div",{className:"flex items-start justify-between mb-3",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs("div",{className:`p-2 rounded-lg ${r.bgColor} relative`,children:[n.jsx(i,{className:`h-4 w-4 ${r.color}`}),r.status==="active"&&n.jsx("div",{className:"absolute -top-1 -right-1 h-3 w-3 bg-green-500 rounded-full animate-pulse"})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-white text-sm",children:r.name}),t(r.status)]})]}),n.jsxs("div",{className:"flex gap-1",children:[n.jsx(Qst,{agent:r}),n.jsx(lt,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 text-gray-400 hover:text-white",children:n.jsx(ws,{className:"h-4 w-4"})})]})]}),n.jsx("p",{className:"text-gray-400 text-xs mb-3",children:r.description}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"text-xs text-gray-500",children:["Model: ",n.jsx("span",{className:"text-gray-300",children:r.model})]}),r.confidence&&n.jsxs("div",{className:"text-xs",children:[n.jsx("span",{className:"text-gray-500",children:"Confidence: "}),n.jsxs("span",{className:"text-green-400 font-medium",children:[r.confidence,"%"]})]}),r.riskFactors&&n.jsxs("div",{className:"text-xs",children:[n.jsx("span",{className:"text-gray-500",children:"Monitoring: "}),n.jsxs("span",{className:"text-blue-400 font-medium",children:[r.riskFactors," risk factors"]})]}),r.signalStrength&&n.jsxs("div",{className:"text-xs",children:[n.jsx("span",{className:"text-gray-500",children:"Signal: "}),n.jsxs("span",{className:"text-amber-400 font-medium",children:[r.signalStrength," conviction"]})]}),r.potentialSavings&&n.jsxs("div",{className:"text-xs",children:[n.jsx("span",{className:"text-gray-500",children:"Identified: "}),n.jsxs("span",{className:"text-green-400 font-medium",children:[r.potentialSavings," savings"]})]}),n.jsx("div",{className:"text-xs text-gray-400 mt-2 p-2 bg-beam-dark-accent/30 rounded border-l-2 border-true-red/30",children:r.lastAction})]}),n.jsxs("div",{className:"flex flex-wrap gap-1 mt-3",children:[r.capabilities.slice(0,2).map((a,l)=>n.jsx(Tt,{variant:"outline",className:"text-xs py-0 px-2 border-gray-600 text-gray-400",children:a},l)),r.capabilities.length>2&&n.jsxs(Tt,{variant:"outline",className:"text-xs py-0 px-2 border-gray-600 text-gray-400",children:["+",r.capabilities.length-2," more"]})]})]})},r.id)})})]})},eat=()=>{const[e,t]=ke.useState([65]),r=[{title:"AI Semiconductor Surge",description:"Web research indicates 73% increase in AI chip demand",confidence:94,impact:"High",sources:["Reuters","TechCrunch","SEC Filings"],sentiment:"Bullish"},{title:"Energy Transition Momentum",description:"Government incentives driving renewable energy adoption",confidence:87,impact:"Medium",sources:["Bloomberg","IEA Reports","Policy Tracker"],sentiment:"Positive"},{title:"Bond Market Volatility",description:"Fed policy uncertainty creating opportunities in duration trades",confidence:79,impact:"Medium",sources:["Fed Minutes","Bond Trader Forums","Economic Data"],sentiment:"Cautious"}],i=[{id:1,title:"AI Infrastructure Investment Theme",description:"Multi-agent research identifies explosive growth in AI infrastructure companies",confidence:96,impact:"Very High",timeframe:"6-18 months",rationale:"Web crawling detected 340% increase in AI infrastructure job postings, $12B in recent funding, and analyst upgrades across the sector",action:"Allocate $25,000 across NVDA, AMD, and emerging AI infrastructure ETFs",status:"high-conviction",webSources:["TechCrunch","VentureBeat","LinkedIn Job Data","Crunchbase"],marketData:{sector:"Technology",expectedReturn:"28-35%",risk:"Medium-High",allocation:"8-12%"},aiInsights:["Patent filings in AI chips up 145% YoY","Major cloud providers increasing capex 60%","Supply chain bottlenecks easing Q2 2025"]},{id:2,title:"ESG Transition Opportunity",description:"Research agents identify undervalued clean energy stocks with strong fundamentals",confidence:91,impact:"High",timeframe:"3-12 months",rationale:"Sentiment analysis shows improving investor confidence in renewable energy, while valuations remain attractive post-correction",action:"Add $18,000 to clean energy ETFs and select wind/solar companies",status:"recommended",webSources:["CleanTechnica","Energy Transition News","ESG Forums","Government Policy Sites"],marketData:{sector:"Clean Energy",expectedReturn:"18-25%",risk:"Medium",allocation:"5-8%"},aiInsights:["Government incentives extended through 2027","Energy storage costs down 23% this year","Corporate renewable commitments accelerating"]},{id:3,title:"Defensive Repositioning Signal",description:"Risk algorithms detect increased correlation across asset classes - recommend defensive allocation",confidence:88,impact:"Medium",timeframe:"1-6 months",rationale:"Multi-source analysis indicates rising geopolitical tensions and potential market volatility ahead",action:"Increase cash position to 15% and add defensive sectors (utilities, consumer staples)",status:"risk-management",webSources:["Financial Times","Geopolitical Risk Trackers","VIX Analysis","Central Bank Communications"],marketData:{sector:"Defensive",expectedReturn:"6-12%",risk:"Low",allocation:"20-25%"},aiInsights:["Correlation between stocks and bonds increasing","Safe-haven demand showing early signs","Options market pricing in higher volatility"]}],a=s=>{switch(s){case"high-conviction":return n.jsxs(Tt,{className:"bg-green-900/20 text-green-300 border-green-700/30",children:[n.jsx(FF,{className:"h-3 w-3 mr-1"}),"High Conviction"]});case"recommended":return n.jsx(Tt,{className:"bg-blue-900/20 text-blue-300 border-blue-700/30",children:"AI Recommended"});case"risk-management":return n.jsxs(Tt,{className:"bg-amber-900/20 text-amber-300 border-amber-700/30",children:[n.jsx(fs,{className:"h-3 w-3 mr-1"}),"Risk Alert"]});default:return n.jsx(Tt,{variant:"outline",children:"Under Review"})}},l=s=>s>=90?"text-green-400":s>=80?"text-amber-400":"text-red-400",d=s=>{switch(s){case"Bullish":return"text-green-400";case"Positive":return"text-blue-400";case"Cautious":return"text-amber-400";default:return"text-gray-400"}};return n.jsxs("div",{className:"space-y-6",children:[n.jsxs(jt,{className:"bg-beam-dark-accent/70 border-gray-700",children:[n.jsxs(wr,{children:[n.jsxs(fr,{className:"text-white flex items-center",children:[n.jsx(Zs,{className:"mr-2 h-5 w-5 text-true-red"}),"Real-Time Market Intelligence"]}),n.jsx("p",{className:"text-sm text-gray-400",children:"AI agents have analyzed 2,847 sources in the last 24 hours"})]}),n.jsx(Ht,{className:"space-y-4",children:n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:r.map((s,p)=>n.jsxs("div",{className:"p-4 rounded-lg bg-beam-dark-accent/30 border border-gray-700/50",children:[n.jsxs("div",{className:"flex justify-between items-start mb-2",children:[n.jsx("h4",{className:"font-medium text-white text-sm",children:s.title}),n.jsx("span",{className:`text-xs font-medium ${d(s.sentiment)}`,children:s.sentiment})]}),n.jsx("p",{className:"text-xs text-gray-400 mb-3",children:s.description}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex justify-between text-xs",children:[n.jsx("span",{className:"text-gray-500",children:"AI Confidence"}),n.jsxs("span",{className:l(s.confidence),children:[s.confidence,"%"]})]}),n.jsx(vn,{value:s.confidence,className:"h-1"}),n.jsxs("div",{className:"text-xs text-gray-500",children:["Sources: ",s.sources.join(", ")]})]})]},p))})})]}),n.jsxs(jt,{className:"bg-beam-dark-accent/70 border-gray-700",children:[n.jsx(wr,{children:n.jsxs(fr,{className:"text-white flex items-center",children:[n.jsx(Ch,{className:"mr-2 h-5 w-5 text-true-red"}),"AI-Optimized Risk Profile"]})}),n.jsxs(Ht,{className:"space-y-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsx("span",{className:"text-gray-400",children:"Conservative"}),n.jsxs("span",{className:"text-white",children:["Current: ",e[0],"% | AI Suggested: 68%"]}),n.jsx("span",{className:"text-gray-400",children:"Aggressive"})]}),n.jsx(oh,{value:e,onValueChange:t,max:100,step:5,className:"w-full"})]}),n.jsxs("div",{className:"grid grid-cols-4 gap-4 text-center",children:[n.jsxs("div",{className:"p-3 rounded-lg bg-beam-dark-accent/30",children:[n.jsx("p",{className:"text-sm text-gray-400",children:"Expected Return"}),n.jsxs("p",{className:"text-lg font-bold text-green-400",children:[(6+e[0]/100*6).toFixed(1),"%"]})]}),n.jsxs("div",{className:"p-3 rounded-lg bg-beam-dark-accent/30",children:[n.jsx("p",{className:"text-sm text-gray-400",children:"Volatility"}),n.jsxs("p",{className:"text-lg font-bold text-amber-400",children:[(8+e[0]/100*12).toFixed(1),"%"]})]}),n.jsxs("div",{className:"p-3 rounded-lg bg-beam-dark-accent/30",children:[n.jsx("p",{className:"text-sm text-gray-400",children:"Sharpe Ratio"}),n.jsx("p",{className:"text-lg font-bold text-blue-400",children:(.8+e[0]/100*.6).toFixed(2)})]}),n.jsxs("div",{className:"p-3 rounded-lg bg-beam-dark-accent/30",children:[n.jsx("p",{className:"text-sm text-gray-400",children:"Max Drawdown"}),n.jsxs("p",{className:"text-lg font-bold text-red-400",children:[(5+e[0]/100*20).toFixed(1),"%"]})]})]})]})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("h3",{className:"text-xl font-bold text-white flex items-center",children:[n.jsx(ti,{className:"mr-2 h-6 w-6 text-true-red"}),"AI Investment Recommendations"]}),n.jsxs(Tt,{className:"bg-true-red/20 text-true-red border-true-red/30",children:[n.jsx(to,{className:"h-3 w-3 mr-1"}),"Updated 12 min ago"]})]}),i.map(s=>n.jsxs(jt,{className:"bg-beam-dark-accent/70 border-gray-700 hover:border-true-red/50 transition-colors",children:[n.jsx(wr,{className:"pb-3",children:n.jsxs("div",{className:"flex items-start justify-between",children:[n.jsxs("div",{className:"flex-1",children:[n.jsxs(fr,{className:"text-white text-lg flex items-center",children:[n.jsx(RF,{className:"mr-2 h-5 w-5 text-amber-400"}),s.title]}),n.jsx("p",{className:"text-gray-400 mt-1",children:s.description})]}),a(s.status)]})}),n.jsxs(Ht,{className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-xs text-gray-400",children:"AI Confidence"}),n.jsxs("p",{className:`text-lg font-bold ${l(s.confidence)}`,children:[s.confidence,"%"]})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-xs text-gray-400",children:"Expected Impact"}),n.jsx("p",{className:"text-lg font-bold text-white",children:s.impact})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-xs text-gray-400",children:"Timeframe"}),n.jsx("p",{className:"text-lg font-bold text-white",children:s.timeframe})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-xs text-gray-400",children:"Allocation"}),n.jsx("p",{className:"text-lg font-bold text-blue-400",children:s.marketData.allocation})]})]}),n.jsxs("div",{className:"p-3 rounded-lg bg-beam-dark-accent/30 border border-gray-700/50",children:[n.jsx("h4",{className:"text-sm font-medium text-white mb-2",children:"Market Analysis"}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 text-xs",children:[n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-400",children:"Sector: "}),n.jsx("span",{className:"text-white",children:s.marketData.sector})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-400",children:"Expected Return: "}),n.jsx("span",{className:"text-green-400",children:s.marketData.expectedReturn})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-400",children:"Risk Level: "}),n.jsx("span",{className:"text-amber-400",children:s.marketData.risk})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-400",children:"Web Sources: "}),n.jsx("span",{className:"text-blue-400",children:s.webSources.length})]})]})]}),n.jsxs("div",{className:"p-3 rounded-lg bg-beam-dark-accent/30 border border-gray-700/50",children:[n.jsx("h4",{className:"text-sm font-medium text-white mb-2",children:"Key AI Insights"}),n.jsx("ul",{className:"space-y-1",children:s.aiInsights.map((p,x)=>n.jsxs("li",{className:"text-xs text-gray-300 flex items-center",children:[n.jsx("div",{className:"w-1 h-1 bg-true-red rounded-full mr-2"}),p]},x))})]}),n.jsxs("div",{className:"p-3 rounded-lg bg-beam-dark-accent/30 border border-gray-700/50",children:[n.jsxs("p",{className:"text-sm text-gray-300 mb-2",children:[n.jsx("strong",{children:"Rationale:"})," ",s.rationale]}),n.jsxs("p",{className:"text-sm text-green-400",children:[n.jsx("strong",{children:"Suggested Action:"})," ",s.action]}),n.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Research Sources: ",s.webSources.join(", ")]})]}),n.jsxs("div",{className:"flex justify-end gap-2",children:[n.jsx(lt,{variant:"outline",className:"border-gray-700 text-gray-300 hover:bg-gray-700/50",children:"View Research"}),n.jsxs(lt,{className:"bg-true-red hover:bg-true-red/90 text-white",children:[n.jsx(ro,{className:"mr-2 h-4 w-4"}),"Implement Strategy"]})]})]})]},s.id))]})]})},tat=rg("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),x$=U.forwardRef(({className:e,variant:t,...r},i)=>n.jsx("div",{ref:i,role:"alert",className:Yt(tat({variant:t}),e),...r}));x$.displayName="Alert";const rat=U.forwardRef(({className:e,...t},r)=>n.jsx("h5",{ref:r,className:Yt("mb-1 font-medium leading-none tracking-tight",e),...t}));rat.displayName="AlertTitle";const y$=U.forwardRef(({className:e,...t},r)=>n.jsx("div",{ref:r,className:Yt("text-sm [&_p]:leading-relaxed",e),...t}));y$.displayName="AlertDescription";const nat=()=>{const e={overallScore:85,emergencyFund:{current:28e3,target:3e4,score:93},debtToIncome:{current:22,target:30,score:88},savingsRate:{current:18,target:15,score:95},creditScore:{current:742,target:750,score:82}},t=[{id:1,title:"Mortgage Refinancing Opportunity",description:"Current rates are 0.4% lower than your existing mortgage",savings:"$180/month",effort:"Medium",timeframe:"30-45 days",priority:"high",icon:sc,color:"text-green-400"},{id:2,title:"Credit Utilization Optimization",description:"Reduce credit utilization from 35% to under 30% to boost credit score",savings:"+15 credit score points",effort:"Low",timeframe:"1-2 months",priority:"medium",icon:m_,color:"text-blue-400"},{id:3,title:"High-Yield Savings Account",description:"Move emergency fund to account earning 4.5% APY vs current 0.5%",savings:"$92/month in interest",effort:"Low",timeframe:"1 week",priority:"medium",icon:_ve,color:"text-amber-400"}],r=a=>{switch(a){case"high":return n.jsx(Tt,{className:"bg-red-900/20 text-red-300 border-red-700/30",children:"High Priority"});case"medium":return n.jsx(Tt,{className:"bg-amber-900/20 text-amber-300 border-amber-700/30",children:"Medium Priority"});case"low":return n.jsx(Tt,{className:"bg-blue-900/20 text-blue-300 border-blue-700/30",children:"Low Priority"});default:return n.jsx(Tt,{variant:"outline",children:"Unknown"})}},i=a=>a>=90?"text-green-400":a>=80?"text-amber-400":"text-red-400";return n.jsxs("div",{className:"space-y-6",children:[n.jsxs(jt,{className:"bg-beam-dark-accent/70 border-gray-700",children:[n.jsx(wr,{children:n.jsxs(fr,{className:"text-white flex items-center",children:[n.jsx(OF,{className:"mr-2 h-5 w-5 text-true-red"}),"Financial Health Score"]})}),n.jsxs(Ht,{children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{children:[n.jsxs("p",{className:"text-3xl font-bold text-green-400",children:[e.overallScore,"/100"]}),n.jsx("p",{className:"text-sm text-gray-400",children:"Excellent financial health"})]}),n.jsx("div",{className:"text-right",children:n.jsxs(Tt,{className:"bg-green-900/20 text-green-300 border-green-700/30 mb-2",children:[n.jsx(En,{className:"h-3 w-3 mr-1"}),"+3 points this month"]})})]}),n.jsx(vn,{value:e.overallScore,className:"h-3"})]})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsx(jt,{className:"bg-beam-dark-accent/70 border-gray-700",children:n.jsxs(Ht,{className:"p-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("h4",{className:"text-white font-medium",children:"Emergency Fund"}),n.jsx("span",{className:`text-lg font-bold ${i(e.emergencyFund.score)}`,children:e.emergencyFund.score})]}),n.jsxs("p",{className:"text-sm text-gray-400 mb-2",children:["$",e.emergencyFund.current.toLocaleString()," / $",e.emergencyFund.target.toLocaleString()]}),n.jsx(vn,{value:e.emergencyFund.current/e.emergencyFund.target*100,className:"h-2"})]})}),n.jsx(jt,{className:"bg-beam-dark-accent/70 border-gray-700",children:n.jsxs(Ht,{className:"p-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("h4",{className:"text-white font-medium",children:"Debt-to-Income"}),n.jsx("span",{className:`text-lg font-bold ${i(e.debtToIncome.score)}`,children:e.debtToIncome.score})]}),n.jsxs("p",{className:"text-sm text-gray-400 mb-2",children:[e.debtToIncome.current,"% (Target: under ",e.debtToIncome.target,"%)"]}),n.jsx(vn,{value:100-e.debtToIncome.current/e.debtToIncome.target*100,className:"h-2"})]})}),n.jsx(jt,{className:"bg-beam-dark-accent/70 border-gray-700",children:n.jsxs(Ht,{className:"p-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("h4",{className:"text-white font-medium",children:"Savings Rate"}),n.jsx("span",{className:`text-lg font-bold ${i(e.savingsRate.score)}`,children:e.savingsRate.score})]}),n.jsxs("p",{className:"text-sm text-gray-400 mb-2",children:[e.savingsRate.current,"% (Target: ",e.savingsRate.target,"%+)"]}),n.jsx(vn,{value:e.savingsRate.current/20*100,className:"h-2"})]})}),n.jsx(jt,{className:"bg-beam-dark-accent/70 border-gray-700",children:n.jsxs(Ht,{className:"p-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("h4",{className:"text-white font-medium",children:"Credit Score"}),n.jsx("span",{className:`text-lg font-bold ${i(e.creditScore.score)}`,children:e.creditScore.score})]}),n.jsxs("p",{className:"text-sm text-gray-400 mb-2",children:[e.creditScore.current," (Target: ",e.creditScore.target,"+)"]}),n.jsx(vn,{value:e.creditScore.current/850*100,className:"h-2"})]})})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("h3",{className:"text-xl font-bold text-white flex items-center",children:[n.jsx(fs,{className:"mr-2 h-6 w-6 text-true-red"}),"Optimization Opportunities"]}),t.map(a=>{const l=a.icon;return n.jsx(jt,{className:"bg-beam-dark-accent/70 border-gray-700 hover:border-true-red/50 transition-colors",children:n.jsxs(Ht,{className:"p-4",children:[n.jsxs("div",{className:"flex items-start justify-between mb-3",children:[n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:"p-2 rounded-lg bg-beam-dark-accent/50",children:n.jsx(l,{className:`h-5 w-5 ${a.color}`})}),n.jsxs("div",{children:[n.jsx("h4",{className:"text-white font-medium",children:a.title}),n.jsx("p",{className:"text-gray-400 text-sm mt-1",children:a.description})]})]}),r(a.priority)]}),n.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-xs text-gray-400",children:"Potential Savings"}),n.jsx("p",{className:"text-lg font-bold text-green-400",children:a.savings})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-xs text-gray-400",children:"Effort Required"}),n.jsx("p",{className:"text-lg font-bold text-white",children:a.effort})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-xs text-gray-400",children:"Timeframe"}),n.jsx("p",{className:"text-lg font-bold text-white",children:a.timeframe})]})]}),n.jsxs("div",{className:"flex justify-end gap-2",children:[n.jsx(lt,{variant:"outline",className:"border-gray-700 text-gray-300 hover:bg-gray-700/50",children:"Learn More"}),n.jsxs(lt,{className:"bg-true-red hover:bg-true-red/90 text-white",children:[n.jsx(ro,{className:"mr-2 h-4 w-4"}),"Take Action"]})]})]})},a.id)})]}),n.jsxs(x$,{className:"bg-blue-900/20 border-blue-700/30",children:[n.jsx(fs,{className:"h-4 w-4 text-blue-400"}),n.jsxs(y$,{className:"text-blue-300",children:[n.jsx("strong",{children:"Proactive Alert:"})," Your credit utilization increased to 35% this month. Consider paying down $2,000 in credit card debt to improve your score and reduce interest costs."]})]})]})},iat=()=>{const[e,t]=U.useState({lastUpdate:new Date,sourcesScanned:2847,signalsDetected:23,highConfidenceSignals:8});U.useEffect(()=>{const d=setInterval(()=>{t(s=>({...s,lastUpdate:new Date,sourcesScanned:s.sourcesScanned+Math.floor(Math.random()*10),signalsDetected:s.signalsDetected+(Math.random()>.8?1:0)}))},3e4);return()=>clearInterval(d)},[]);const r=[{topic:"AI Infrastructure Spending",sentiment:"bullish",mentions:1247,change:"+34%",sources:["TechCrunch","VentureBeat","Crunchbase","LinkedIn"],keyPoints:["Microsoft announces $10B AI datacenter expansion","NVIDIA supply constraints easing in Q2","Enterprise AI adoption accelerating 45% QoQ"],relevantStocks:["NVDA","MSFT","GOOGL","META"],confidence:94},{topic:"Clean Energy Policy Shifts",sentiment:"positive",mentions:892,change:"+18%",sources:["Reuters","Bloomberg Green","Energy.gov","CleanTechnica"],keyPoints:["IRA tax credits extended through 2027","Grid modernization funding increased","Corporate renewable commitments up 67%"],relevantStocks:["ENPH","SEDG","NEE","BEP"],confidence:87},{topic:"Federal Reserve Communications",sentiment:"cautious",mentions:1456,change:"+12%",sources:["Fed Minutes","FOMC Speeches","Economic Data","Bond Forums"],keyPoints:["Powell signals data-dependent approach","Regional Fed presidents show division","Market pricing 75bps cuts by year-end"],relevantStocks:["XLF","BRK.B","JPM","BAC"],confidence:82},{topic:"Geopolitical Risk Factors",sentiment:"bearish",mentions:734,change:"+28%",sources:["Financial Times","WSJ","Foreign Affairs","Risk Intelligence"],keyPoints:["Trade tensions escalating in key sectors","Supply chain vulnerabilities exposed","Safe-haven flows increasing"],relevantStocks:["GLD","TLT","VIX","DXY"],confidence:79}],i=[{source:"Reddit WallStreetBets",signal:"Unusual Options Activity",ticker:"NVDA",strength:"High",description:"Massive call volume in Feb expiries, unusual retail positioning",timestamp:"15 min ago"},{source:"LinkedIn Executive Posts",signal:"Hiring Surge Signal",ticker:"AI Sector",strength:"Medium",description:"AI engineers job postings up 340% across major tech companies",timestamp:"32 min ago"},{source:"SEC Filings Monitor",signal:"Insider Buying",ticker:"ENPH",strength:"Medium",description:"CEO purchased $2.3M in shares, first insider buying in 8 months",timestamp:"1 hour ago"},{source:"Economic Calendar",signal:"Data Release Impact",ticker:"USD",strength:"High",description:"CPI data beats expectations, dollar strength continues",timestamp:"2 hours ago"}],a=d=>{switch(d){case"bullish":return"text-green-400 bg-green-900/20 border-green-700/30";case"positive":return"text-blue-400 bg-blue-900/20 border-blue-700/30";case"cautious":return"text-amber-400 bg-amber-900/20 border-amber-700/30";case"bearish":return"text-red-400 bg-red-900/20 border-red-700/30";default:return"text-gray-400 bg-gray-900/20 border-gray-700/30"}},l=d=>{switch(d){case"High":return"text-red-400";case"Medium":return"text-amber-400";case"Low":return"text-green-400";default:return"text-gray-400"}};return n.jsxs("div",{className:"space-y-6",children:[n.jsxs(jt,{className:"bg-beam-dark-accent/70 border-gray-700",children:[n.jsx(wr,{children:n.jsxs(fr,{className:"text-white flex items-center",children:[n.jsx(ti,{className:"mr-2 h-5 w-5 text-true-red"}),"AI Research Intelligence Center"]})}),n.jsxs(Ht,{children:[n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[n.jsxs("div",{className:"text-center p-3 rounded-lg bg-beam-dark-accent/30",children:[n.jsx("div",{className:"text-2xl font-bold text-green-400",children:e.sourcesScanned.toLocaleString()}),n.jsx("div",{className:"text-xs text-gray-400",children:"Sources Scanned Today"})]}),n.jsxs("div",{className:"text-center p-3 rounded-lg bg-beam-dark-accent/30",children:[n.jsx("div",{className:"text-2xl font-bold text-blue-400",children:e.signalsDetected}),n.jsx("div",{className:"text-xs text-gray-400",children:"Signals Detected"})]}),n.jsxs("div",{className:"text-center p-3 rounded-lg bg-beam-dark-accent/30",children:[n.jsx("div",{className:"text-2xl font-bold text-amber-400",children:e.highConfidenceSignals}),n.jsx("div",{className:"text-xs text-gray-400",children:"High Confidence"})]}),n.jsxs("div",{className:"text-center p-3 rounded-lg bg-beam-dark-accent/30",children:[n.jsx("div",{className:"text-2xl font-bold text-true-red",children:"94%"}),n.jsx("div",{className:"text-xs text-gray-400",children:"Research Accuracy"})]})]}),n.jsxs("div",{className:"mt-4 text-xs text-gray-400 text-center",children:["Last updated: ",e.lastUpdate.toLocaleTimeString()," • Next scan in: ",60-e.lastUpdate.getSeconds()," seconds"]})]})]}),n.jsxs(jt,{className:"bg-beam-dark-accent/70 border-gray-700",children:[n.jsxs(wr,{children:[n.jsxs(fr,{className:"text-white flex items-center",children:[n.jsx(En,{className:"mr-2 h-5 w-5 text-true-red"}),"Trending Market Intelligence"]}),n.jsx("p",{className:"text-sm text-gray-400",children:"Real-time analysis of market-moving topics"})]}),n.jsx(Ht,{className:"space-y-4",children:r.map((d,s)=>n.jsx(jt,{className:"bg-beam-dark-accent/50 border-gray-700/50",children:n.jsxs(Ht,{className:"p-4",children:[n.jsxs("div",{className:"flex justify-between items-start mb-3",children:[n.jsxs("div",{className:"flex-1",children:[n.jsx("h4",{className:"font-medium text-white mb-1",children:d.topic}),n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx(Tt,{className:a(d.sentiment),children:d.sentiment.charAt(0).toUpperCase()+d.sentiment.slice(1)}),n.jsxs("span",{className:"text-xs text-gray-400",children:[d.mentions," mentions (",d.change,")"]})]})]}),n.jsxs("div",{className:"text-right",children:[n.jsxs("div",{className:"text-sm font-medium text-white",children:[d.confidence,"%"]}),n.jsx("div",{className:"text-xs text-gray-400",children:"Confidence"})]})]}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{children:[n.jsx("h5",{className:"text-xs font-medium text-gray-300 mb-1",children:"Key Insights:"}),n.jsx("ul",{className:"space-y-1",children:d.keyPoints.map((p,x)=>n.jsxs("li",{className:"text-xs text-gray-400 flex items-start",children:[n.jsx("div",{className:"w-1 h-1 bg-true-red rounded-full mt-2 mr-2 flex-shrink-0"}),p]},x))})]}),n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsxs("div",{children:[n.jsx("span",{className:"text-xs text-gray-400",children:"Relevant: "}),n.jsx("span",{className:"text-xs text-blue-400",children:d.relevantStocks.join(", ")})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-xs text-gray-400",children:"Sources: "}),n.jsx("span",{className:"text-xs text-gray-300",children:d.sources.length})]})]})]})]})},s))})]}),n.jsxs(jt,{className:"bg-beam-dark-accent/70 border-gray-700",children:[n.jsxs(wr,{children:[n.jsxs(fr,{className:"text-white flex items-center",children:[n.jsx(Zs,{className:"mr-2 h-5 w-5 text-true-red"}),"Live Web Intelligence Signals"]}),n.jsx("p",{className:"text-sm text-gray-400",children:"Real-time signals from alternative data sources"})]}),n.jsxs(Ht,{className:"space-y-3",children:[i.map((d,s)=>n.jsx("div",{className:"p-3 rounded-lg bg-beam-dark-accent/30 border border-gray-700/50 hover:border-true-red/30 transition-colors",children:n.jsxs("div",{className:"flex justify-between items-start mb-2",children:[n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx("h4",{className:"font-medium text-white text-sm",children:d.signal}),n.jsx(Tt,{variant:"outline",className:"text-xs py-0 px-2",children:d.ticker})]}),n.jsx("p",{className:"text-xs text-gray-400 mb-1",children:d.description}),n.jsxs("div",{className:"text-xs text-gray-500",children:["Source: ",d.source," • ",d.timestamp]})]}),n.jsxs("div",{className:"text-right",children:[n.jsx("div",{className:`text-sm font-medium ${l(d.strength)}`,children:d.strength}),n.jsx("div",{className:"text-xs text-gray-400",children:"Signal"})]})]})},s)),n.jsx("div",{className:"text-center pt-4",children:n.jsxs(lt,{variant:"outline",className:"border-gray-700 text-gray-300 hover:bg-gray-700/50",children:[n.jsx(IF,{className:"mr-2 h-4 w-4"}),"View All Signals"]})})]})]})]})},bR={portfolio:{label:"Portfolio Value",color:"hsl(var(--chart-1))"},benchmark:{label:"S&P 500",color:"hsl(var(--chart-2))"},returns:{label:"Returns",color:"hsl(var(--chart-3))"}},YZ=()=>{const[e,t]=U.useState("1Y");U.useState("performance");const r=[{month:"Jan",portfolio:985e3,benchmark:975e3,returns:2.3},{month:"Feb",portfolio:102e4,benchmark:995e3,returns:3.8},{month:"Mar",portfolio:995e3,benchmark:985e3,returns:1.2},{month:"Apr",portfolio:105e4,benchmark:101e4,returns:4.2},{month:"May",portfolio:108e4,benchmark:1025e3,returns:5.1},{month:"Jun",portfolio:1095e3,benchmark:1035e3,returns:5.8},{month:"Jul",portfolio:112e4,benchmark:1055e3,returns:6.5},{month:"Aug",portfolio:1105e3,benchmark:1045e3,returns:6.1},{month:"Sep",portfolio:1135e3,benchmark:1065e3,returns:7.2},{month:"Oct",portfolio:115e4,benchmark:1075e3,returns:7.8},{month:"Nov",portfolio:1175e3,benchmark:109e4,returns:8.5},{month:"Dec",portfolio:12e5,benchmark:11e5,returns:9.2}],i=[{name:"Equities",value:45,amount:54e4,color:"#0ea5e9"},{name:"Fixed Income",value:25,amount:3e5,color:"#10b981"},{name:"Real Estate",value:15,amount:18e4,color:"#f59e0b"},{name:"Commodities",value:8,amount:96e3,color:"#ef4444"},{name:"Cash",value:7,amount:84e3,color:"#8b5cf6"}],a=[{sector:"Technology",allocation:22,performance:12.5,risk:"Medium"},{sector:"Healthcare",allocation:18,performance:8.3,risk:"Low"},{sector:"Financial Services",allocation:15,performance:6.7,risk:"Medium"},{sector:"Consumer Goods",allocation:12,performance:4.2,risk:"Low"},{sector:"Energy",allocation:10,performance:15.8,risk:"High"},{sector:"Real Estate",allocation:8,performance:7.1,risk:"Medium"},{sector:"Utilities",allocation:7,performance:3.9,risk:"Low"},{sector:"Materials",allocation:8,performance:9.4,risk:"High"}],l=[{metric:"Portfolio Beta",value:"1.12",change:"+0.05",trend:"up"},{metric:"Sharpe Ratio",value:"1.34",change:"+0.12",trend:"up"},{metric:"Max Drawdown",value:"-8.2%",change:"-1.3%",trend:"down"},{metric:"Value at Risk (95%)",value:"$45,200",change:"+$2,100",trend:"up"},{metric:"Volatility (30d)",value:"12.8%",change:"-2.1%",trend:"down"},{metric:"Correlation to S&P",value:"0.87",change:"+0.03",trend:"up"}],d=["1D","1W","1M","3M","6M","1Y","3Y","5Y"];return n.jsxs("div",{className:"space-y-6",children:[n.jsxs(jt,{className:"bg-beam-dark-accent/70 border-gray-700",children:[n.jsx(wr,{children:n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsxs(fr,{className:"text-white flex items-center",children:[n.jsx(bs,{className:"mr-2 h-5 w-5 text-true-red"}),"Portfolio Performance Analysis"]}),n.jsx("div",{className:"flex gap-2",children:d.map(s=>n.jsx(lt,{variant:e===s?"default":"outline",size:"sm",onClick:()=>t(s),className:e===s?"bg-true-red hover:bg-true-red/80":"border-gray-600 text-gray-300",children:s},s))})]})}),n.jsxs(Ht,{children:[n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-4 mb-6",children:[n.jsxs("div",{className:"p-4 rounded-lg bg-beam-dark-accent/30 border border-green-700/30",children:[n.jsx("div",{className:"text-sm text-gray-400",children:"Total Portfolio Value"}),n.jsx("div",{className:"text-2xl font-bold text-green-400",children:"$1,200,000"}),n.jsxs("div",{className:"text-sm text-green-400 flex items-center",children:[n.jsx(En,{className:"h-4 w-4 mr-1"}),"+9.2% YTD"]})]}),n.jsxs("div",{className:"p-4 rounded-lg bg-beam-dark-accent/30 border border-blue-700/30",children:[n.jsx("div",{className:"text-sm text-gray-400",children:"Outperformance vs Benchmark"}),n.jsx("div",{className:"text-2xl font-bold text-blue-400",children:"+4.8%"}),n.jsx("div",{className:"text-sm text-blue-400",children:"vs S&P 500"})]}),n.jsxs("div",{className:"p-4 rounded-lg bg-beam-dark-accent/30 border border-amber-700/30",children:[n.jsx("div",{className:"text-sm text-gray-400",children:"Monthly Return"}),n.jsx("div",{className:"text-2xl font-bold text-amber-400",children:"+2.1%"}),n.jsx("div",{className:"text-sm text-gray-400",children:"December 2024"})]}),n.jsxs("div",{className:"p-4 rounded-lg bg-beam-dark-accent/30 border border-purple-700/30",children:[n.jsx("div",{className:"text-sm text-gray-400",children:"Risk-Adjusted Return"}),n.jsx("div",{className:"text-2xl font-bold text-purple-400",children:"1.34"}),n.jsx("div",{className:"text-sm text-gray-400",children:"Sharpe Ratio"})]})]}),n.jsx(Uv,{config:bR,className:"h-80",children:n.jsxs(uS,{data:r,children:[n.jsx($s,{strokeDasharray:"3 3",stroke:"#374151"}),n.jsx(is,{dataKey:"month",stroke:"#9ca3af"}),n.jsx(Gi,{stroke:"#9ca3af"}),n.jsx(zT,{content:n.jsx(Gv,{})}),n.jsx(Zo,{type:"monotone",dataKey:"portfolio",stroke:"#0ea5e9",fill:"#0ea5e9",fillOpacity:.3,strokeWidth:2}),n.jsx(Zo,{type:"monotone",dataKey:"benchmark",stroke:"#10b981",fill:"#10b981",fillOpacity:.2,strokeWidth:2})]})})]})]}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[n.jsxs(jt,{className:"bg-beam-dark-accent/70 border-gray-700",children:[n.jsx(wr,{children:n.jsxs(fr,{className:"text-white flex items-center",children:[n.jsx(AQ,{className:"mr-2 h-5 w-5 text-true-red"}),"Asset Allocation"]})}),n.jsx(Ht,{children:n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsx(Uv,{config:bR,className:"h-64",children:n.jsxs(oN,{children:[n.jsx(Gc,{data:i,cx:"50%",cy:"50%",innerRadius:40,outerRadius:80,paddingAngle:5,dataKey:"value",children:i.map((s,p)=>n.jsx(jd,{fill:s.color},`cell-${p}`))}),n.jsx(zT,{content:n.jsx(Gv,{})})]})}),n.jsx("div",{className:"space-y-3",children:i.map((s,p)=>n.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg bg-beam-dark-accent/30",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:s.color}}),n.jsx("span",{className:"text-sm text-gray-300",children:s.name})]}),n.jsxs("div",{className:"text-right",children:[n.jsxs("div",{className:"text-sm font-medium text-white",children:[s.value,"%"]}),n.jsxs("div",{className:"text-xs text-gray-400",children:["$",s.amount.toLocaleString()]})]})]},p))})]})})]}),n.jsxs(jt,{className:"bg-beam-dark-accent/70 border-gray-700",children:[n.jsx(wr,{children:n.jsxs(fr,{className:"text-white flex items-center",children:[n.jsx(Ch,{className:"mr-2 h-5 w-5 text-true-red"}),"Risk Analytics"]})}),n.jsx(Ht,{children:n.jsx("div",{className:"grid grid-cols-1 gap-3",children:l.map((s,p)=>n.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-beam-dark-accent/30 border border-gray-700/50",children:[n.jsxs("div",{className:"flex-1",children:[n.jsx("div",{className:"text-sm text-gray-300",children:s.metric}),n.jsx("div",{className:"text-lg font-medium text-white",children:s.value})]}),n.jsx("div",{className:"text-right",children:n.jsxs("div",{className:`text-sm font-medium flex items-center ${s.trend==="up"?"text-green-400":"text-red-400"}`,children:[s.trend==="up"?n.jsx(En,{className:"h-3 w-3 mr-1"}):n.jsx(tx,{className:"h-3 w-3 mr-1"}),s.change]})})]},p))})})]})]}),n.jsxs(jt,{className:"bg-beam-dark-accent/70 border-gray-700",children:[n.jsx(wr,{children:n.jsxs(fr,{className:"text-white flex items-center",children:[n.jsx(to,{className:"mr-2 h-5 w-5 text-true-red"}),"Sector Performance Analysis"]})}),n.jsxs(Ht,{children:[n.jsx(Uv,{config:bR,className:"h-80 mb-4",children:n.jsxs(nc,{data:a,children:[n.jsx($s,{strokeDasharray:"3 3",stroke:"#374151"}),n.jsx(is,{dataKey:"sector",stroke:"#9ca3af",angle:-45,textAnchor:"end",height:80}),n.jsx(Gi,{stroke:"#9ca3af"}),n.jsx(zT,{content:n.jsx(Gv,{})}),n.jsx(pi,{dataKey:"allocation",fill:"#0ea5e9",name:"Allocation %"}),n.jsx(pi,{dataKey:"performance",fill:"#10b981",name:"Performance %"})]})}),n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:a.map((s,p)=>n.jsxs("div",{className:"p-3 rounded-lg bg-beam-dark-accent/30 border border-gray-700/50",children:[n.jsx("div",{className:"text-sm font-medium text-white",children:s.sector}),n.jsxs("div",{className:"flex justify-between items-center mt-2",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-xs text-gray-400",children:"Allocation"}),n.jsxs("div",{className:"text-sm font-medium text-blue-400",children:[s.allocation,"%"]})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-xs text-gray-400",children:"Performance"}),n.jsxs("div",{className:"text-sm font-medium text-green-400",children:["+",s.performance,"%"]})]}),n.jsx(Tt,{className:`text-xs ${s.risk==="Low"?"bg-green-900/20 text-green-300 border-green-700/30":s.risk==="Medium"?"bg-amber-900/20 text-amber-300 border-amber-700/30":"bg-red-900/20 text-red-300 border-red-700/30"}`,children:s.risk})]})]},p))})]})]})]})},sat=()=>{const[e,t]=U.useState("john-doe"),r={"john-doe":{name:"John Doe",portfolioValue:12e5,riskProfile:"Moderate",lastReview:"2024-12-01",nextReview:"2024-12-15",performance:"+9.2%",status:"active",alerts:2,tasks:3,opportunities:["Tax Loss Harvesting","ESG Rebalancing","Alternative Investments"]},"sarah-smith":{name:"Sarah Smith",portfolioValue:85e4,riskProfile:"Conservative",lastReview:"2024-11-28",nextReview:"2024-12-20",performance:"+6.7%",status:"review_needed",alerts:1,tasks:5,opportunities:["Fixed Income Optimization","Dividend Growth Strategy"]},"mike-johnson":{name:"Mike Johnson",portfolioValue:21e5,riskProfile:"Aggressive",lastReview:"2024-12-05",nextReview:"2024-12-25",performance:"+12.8%",status:"active",alerts:0,tasks:1,opportunities:["Growth Stock Allocation","International Exposure","Crypto Integration"]}},i=[{id:"research",title:"Market Research",status:"completed",description:"AI agents analyze current market conditions",timestamp:"09:00 AM",insights:["Tech sector showing strong momentum","Fed policy remains accommodative","Emerging markets opportunity identified"]},{id:"analysis",title:"Portfolio Analysis",status:"in_progress",description:"Deep dive into client portfolio performance",timestamp:"09:30 AM",insights:["Overweight in growth stocks","Underweight in international","ESG allocation below target"]},{id:"recommendations",title:"Generate Recommendations",status:"pending",description:"AI-powered investment suggestions",timestamp:"10:00 AM",insights:[]},{id:"client_prep",title:"Client Meeting Prep",status:"pending",description:"Prepare personalized presentation",timestamp:"10:30 AM",insights:[]}],a=[{id:1,client:"John Doe",task:"Portfolio Review Meeting",priority:"high",dueDate:"2024-12-15",type:"meeting",duration:"1 hour",preparation:"Review Q4 performance, discuss 2025 strategy"},{id:2,client:"Sarah Smith",task:"Risk Assessment Update",priority:"medium",dueDate:"2024-12-18",type:"analysis",duration:"30 mins",preparation:"Complete risk questionnaire review"},{id:3,client:"Mike Johnson",task:"Tax Planning Call",priority:"high",dueDate:"2024-12-20",type:"call",duration:"45 mins",preparation:"Prepare tax loss harvesting recommendations"},{id:4,client:"Emily Chen",task:"Onboarding Session",priority:"medium",dueDate:"2024-12-22",type:"onboarding",duration:"2 hours",preparation:"Complete KYC and investment preference analysis"}],l=[{label:"Total AUM",value:"$12.8M",change:"+8.2%",icon:sc},{label:"Active Clients",value:"47",change:"+3",icon:qi},{label:"Avg Portfolio Performance",value:"+8.9%",change:"+1.2%",icon:En},{label:"Client Satisfaction",value:"94%",change:"+2%",icon:qye}],d=x=>{switch(x){case"completed":return"bg-green-900/20 text-green-300 border-green-700/30";case"in_progress":return"bg-blue-900/20 text-blue-300 border-blue-700/30";case"pending":return"bg-gray-900/20 text-gray-300 border-gray-700/30";default:return"bg-gray-900/20 text-gray-300 border-gray-700/30"}},s=x=>{switch(x){case"high":return"bg-red-900/20 text-red-300 border-red-700/30";case"medium":return"bg-amber-900/20 text-amber-300 border-amber-700/30";case"low":return"bg-green-900/20 text-green-300 border-green-700/30";default:return"bg-gray-900/20 text-gray-300 border-gray-700/30"}},p=r[e];return n.jsxs("div",{className:"space-y-6",children:[n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:l.map((x,w)=>{const j=x.icon;return n.jsx(jt,{className:"bg-beam-dark-accent/70 border-gray-700",children:n.jsx(Ht,{className:"p-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-400",children:x.label}),n.jsx("p",{className:"text-2xl font-bold text-white",children:x.value}),n.jsx("p",{className:"text-sm text-green-400",children:x.change})]}),n.jsx(j,{className:"h-8 w-8 text-true-red"})]})})},w)})}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[n.jsxs(jt,{className:"lg:col-span-2 bg-beam-dark-accent/70 border-gray-700",children:[n.jsxs(wr,{children:[n.jsxs(fr,{className:"text-white flex items-center",children:[n.jsx(Ch,{className:"mr-2 h-5 w-5 text-true-red"}),"Today's Workflow Progress"]}),n.jsx("p",{className:"text-sm text-gray-400",children:"AI-driven research and analysis pipeline"})]}),n.jsx(Ht,{className:"space-y-4",children:i.map((x,w)=>n.jsx("div",{className:"relative",children:n.jsxs("div",{className:"flex items-start gap-4",children:[n.jsxs("div",{className:"flex flex-col items-center",children:[n.jsx("div",{className:`w-3 h-3 rounded-full ${x.status==="completed"?"bg-green-500":x.status==="in_progress"?"bg-blue-500 animate-pulse":"bg-gray-500"}`}),w<i.length-1&&n.jsx("div",{className:"w-px h-16 bg-gray-700 mt-2"})]}),n.jsxs("div",{className:"flex-1 pb-8",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("h4",{className:"font-medium text-white",children:x.title}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Tt,{className:d(x.status),children:x.status.replace("_"," ")}),n.jsx("span",{className:"text-xs text-gray-400",children:x.timestamp})]})]}),n.jsx("p",{className:"text-sm text-gray-400 mb-3",children:x.description}),x.insights.length>0&&n.jsxs("div",{className:"space-y-1",children:[n.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Key Insights:"}),x.insights.map((j,S)=>n.jsxs("div",{className:"text-xs text-blue-400 flex items-start",children:[n.jsx("div",{className:"w-1 h-1 bg-blue-400 rounded-full mt-2 mr-2 flex-shrink-0"}),j]},S))]})]})]})},x.id))})]}),n.jsxs(jt,{className:"bg-beam-dark-accent/70 border-gray-700",children:[n.jsx(wr,{children:n.jsxs(fr,{className:"text-white flex items-center",children:[n.jsx(qi,{className:"mr-2 h-5 w-5 text-true-red"}),"Client Focus"]})}),n.jsxs(Ht,{className:"space-y-4",children:[n.jsx("div",{className:"space-y-2",children:Object.entries(r).map(([x,w])=>n.jsx(lt,{variant:e===x?"default":"ghost",className:`w-full justify-start ${e===x?"bg-true-red hover:bg-true-red/80":"hover:bg-gray-700/50"}`,onClick:()=>t(x),children:n.jsxs("div",{className:"flex items-center justify-between w-full",children:[n.jsx("span",{children:w.name}),w.alerts>0&&n.jsx(Tt,{className:"bg-red-900/20 text-red-300 border-red-700/30",children:w.alerts})]})},x))}),p&&n.jsxs("div",{className:"p-4 rounded-lg bg-beam-dark-accent/30 border border-gray-700/50",children:[n.jsx("h4",{className:"font-medium text-white mb-3",children:p.name}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-sm text-gray-400",children:"Portfolio Value"}),n.jsxs("span",{className:"text-sm font-medium text-white",children:["$",p.portfolioValue.toLocaleString()]})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-sm text-gray-400",children:"Performance YTD"}),n.jsx("span",{className:"text-sm font-medium text-green-400",children:p.performance})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-sm text-gray-400",children:"Risk Profile"}),n.jsx(Tt,{variant:"outline",className:"text-xs",children:p.riskProfile})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-sm text-gray-400",children:"Next Review"}),n.jsx("span",{className:"text-sm text-amber-400",children:p.nextReview})]})]}),n.jsxs("div",{className:"mt-4 space-y-2",children:[n.jsxs(lt,{size:"sm",className:"w-full bg-blue-600 hover:bg-blue-700",children:[n.jsx($9,{className:"mr-2 h-4 w-4"}),"Schedule Call"]}),n.jsxs(lt,{size:"sm",variant:"outline",className:"w-full border-gray-600",children:[n.jsx(_s,{className:"mr-2 h-4 w-4"}),"Send Message"]})]}),p.opportunities.length>0&&n.jsxs("div",{className:"mt-4",children:[n.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide mb-2",children:"Opportunities:"}),n.jsx("div",{className:"space-y-1",children:p.opportunities.map((x,w)=>n.jsxs("div",{className:"text-xs text-green-400 flex items-start",children:[n.jsx(En,{className:"h-3 w-3 mr-1 mt-0.5 flex-shrink-0"}),x]},w))})]})]})]})]})]}),n.jsxs(jt,{className:"bg-beam-dark-accent/70 border-gray-700",children:[n.jsx(wr,{children:n.jsxs(fr,{className:"text-white flex items-center",children:[n.jsx(xh,{className:"mr-2 h-5 w-5 text-true-red"}),"Upcoming Tasks & Meetings"]})}),n.jsx(Ht,{children:n.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:a.map(x=>n.jsxs("div",{className:"p-4 rounded-lg bg-beam-dark-accent/30 border border-gray-700/50 hover:border-true-red/30 transition-colors",children:[n.jsxs("div",{className:"flex items-start justify-between mb-3",children:[n.jsxs("div",{className:"flex-1",children:[n.jsx("h4",{className:"font-medium text-white",children:x.task}),n.jsx("p",{className:"text-sm text-gray-400",children:x.client})]}),n.jsx(Tt,{className:s(x.priority),children:x.priority})]}),n.jsxs("div",{className:"space-y-2 text-sm",children:[n.jsxs("div",{className:"flex items-center gap-2 text-gray-400",children:[n.jsx(xh,{className:"h-4 w-4"}),x.dueDate," • ",x.duration]}),n.jsxs("div",{className:"flex items-center gap-2 text-gray-400",children:[x.type==="meeting"&&n.jsx(qi,{className:"h-4 w-4"}),x.type==="call"&&n.jsx($9,{className:"h-4 w-4"}),x.type==="analysis"&&n.jsx(En,{className:"h-4 w-4"}),x.type==="onboarding"&&n.jsx(ro,{className:"h-4 w-4"}),x.type.charAt(0).toUpperCase()+x.type.slice(1)]}),n.jsx("p",{className:"text-xs text-gray-500 mt-2",children:x.preparation})]}),n.jsxs("div",{className:"mt-3 flex gap-2",children:[n.jsx(lt,{size:"sm",variant:"outline",className:"flex-1 border-gray-600 text-gray-300",children:"Prepare"}),n.jsx(lt,{size:"sm",className:"flex-1 bg-true-red hover:bg-true-red/80",children:"Start"})]})]},x.id))})})]})]})},aat={sentiment:{label:"Market Sentiment",color:"hsl(var(--chart-1))"},volume:{label:"News Volume",color:"hsl(var(--chart-2))"}},oat=()=>{const[e,t]=U.useState("all"),[r,i]=U.useState("all"),[a,l]=U.useState({lastUpdate:new Date,articlesProcessed:2847,sentimentScore:.62,volatilityIndex:23.4});U.useEffect(()=>{const F=setInterval(()=>{l(L=>({...L,lastUpdate:new Date,articlesProcessed:L.articlesProcessed+Math.floor(Math.random()*15),sentimentScore:Math.max(0,Math.min(1,L.sentimentScore+(Math.random()-.5)*.1)),volatilityIndex:Math.max(0,L.volatilityIndex+(Math.random()-.5)*2)}))},1e4);return()=>clearInterval(F)},[]);const d=["all","markets","crypto","earnings","policy","geopolitical"],s=["all","positive","neutral","negative"],p=[{id:1,headline:"Federal Reserve Signals Potential Rate Cuts in Q2 2025",source:"Reuters",timestamp:"2 minutes ago",sentiment:"positive",impact:"high",marketReaction:"+1.2%",aiAnalysis:"Bullish signal for growth stocks and real estate. Bond yields likely to decline.",relevantStocks:["SPY","QQQ","TLT","REITs"],category:"policy"},{id:2,headline:"NVIDIA Reports Record Q4 Revenue, Beats Estimates by 15%",source:"Bloomberg",timestamp:"8 minutes ago",sentiment:"positive",impact:"high",marketReaction:"+6.8%",aiAnalysis:"Strong momentum in AI infrastructure. Semiconductor sector likely to rally.",relevantStocks:["NVDA","AMD","TSM","AVGO"],category:"earnings"},{id:3,headline:"China Manufacturing PMI Falls Below 50, Signals Contraction",source:"Financial Times",timestamp:"15 minutes ago",sentiment:"negative",impact:"medium",marketReaction:"-0.8%",aiAnalysis:"Bearish for commodities and China-exposed stocks. Safe-haven flows expected.",relevantStocks:["FXI","ASHR","GLD","DXY"],category:"geopolitical"},{id:4,headline:"Bitcoin ETF Sees Record $2.3B Inflow in Single Day",source:"CoinDesk",timestamp:"22 minutes ago",sentiment:"positive",impact:"medium",marketReaction:"+4.5%",aiAnalysis:"Institutional adoption accelerating. Crypto-related stocks likely to benefit.",relevantStocks:["MSTR","COIN","RIOT","MARA"],category:"crypto"},{id:5,headline:"European Central Bank Maintains Dovish Stance Amid Inflation Concerns",source:"WSJ",timestamp:"35 minutes ago",sentiment:"neutral",impact:"medium",marketReaction:"+0.3%",aiAnalysis:"Mixed signals for EUR/USD. European equities may see modest gains.",relevantStocks:["EZU","FEZ","IEUR","EWG"],category:"policy"}],x=[{time:"9:00",sentiment:.45,volume:234},{time:"9:30",sentiment:.52,volume:289},{time:"10:00",sentiment:.48,volume:356},{time:"10:30",sentiment:.61,volume:423},{time:"11:00",sentiment:.58,volume:387},{time:"11:30",sentiment:.65,volume:445},{time:"12:00",sentiment:.62,volume:398},{time:"12:30",sentiment:.59,volume:367},{time:"13:00",sentiment:.67,volume:456},{time:"13:30",sentiment:.63,volume:401}],w=[{sector:"Technology",sentiment:.72,articles:156,change:"+2.1%"},{sector:"Healthcare",sentiment:.58,articles:89,change:"+0.8%"},{sector:"Financial",sentiment:.65,articles:134,change:"+1.5%"},{sector:"Energy",sentiment:.43,articles:78,change:"-1.2%"},{sector:"Consumer",sentiment:.61,articles:92,change:"+0.9%"},{sector:"Industrial",sentiment:.55,articles:67,change:"+0.4%"}],j=p.filter(F=>{const L=e==="all"||F.category===e,B=r==="all"||F.sentiment===r;return L&&B}),S=F=>{switch(F){case"positive":return"text-green-400 bg-green-900/20 border-green-700/30";case"negative":return"text-red-400 bg-red-900/20 border-red-700/30";case"neutral":return"text-gray-400 bg-gray-900/20 border-gray-700/30";default:return"text-gray-400 bg-gray-900/20 border-gray-700/30"}},P=F=>{switch(F){case"high":return"text-red-400";case"medium":return"text-amber-400";case"low":return"text-green-400";default:return"text-gray-400"}};return n.jsxs("div",{className:"space-y-6",children:[n.jsxs(jt,{className:"bg-beam-dark-accent/70 border-gray-700",children:[n.jsx(wr,{children:n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsxs(fr,{className:"text-white flex items-center",children:[n.jsx(ti,{className:"mr-2 h-5 w-5 text-true-red"}),"AI-Powered Market Sentiment Analysis"]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs(Tt,{className:"bg-green-900/20 text-green-300 border-green-700/30 animate-pulse",children:[n.jsx(Yi,{className:"h-3 w-3 mr-1"}),"Live"]}),n.jsxs("span",{className:"text-xs text-gray-400",children:["Updated: ",a.lastUpdate.toLocaleTimeString()]})]})]})}),n.jsxs(Ht,{children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[n.jsxs("div",{className:"p-4 rounded-lg bg-beam-dark-accent/30 border border-blue-700/30",children:[n.jsx("div",{className:"text-sm text-gray-400",children:"Articles Processed"}),n.jsx("div",{className:"text-2xl font-bold text-blue-400",children:a.articlesProcessed.toLocaleString()}),n.jsx("div",{className:"text-xs text-gray-400",children:"Last 24 hours"})]}),n.jsxs("div",{className:"p-4 rounded-lg bg-beam-dark-accent/30 border border-green-700/30",children:[n.jsx("div",{className:"text-sm text-gray-400",children:"Market Sentiment"}),n.jsxs("div",{className:"text-2xl font-bold text-green-400",children:[(a.sentimentScore*100).toFixed(1),"%"]}),n.jsx("div",{className:"text-xs text-gray-400",children:"Bullish overall"})]}),n.jsxs("div",{className:"p-4 rounded-lg bg-beam-dark-accent/30 border border-amber-700/30",children:[n.jsx("div",{className:"text-sm text-gray-400",children:"Volatility Index"}),n.jsx("div",{className:"text-2xl font-bold text-amber-400",children:a.volatilityIndex.toFixed(1)}),n.jsx("div",{className:"text-xs text-gray-400",children:"Market uncertainty"})]}),n.jsxs("div",{className:"p-4 rounded-lg bg-beam-dark-accent/30 border border-purple-700/30",children:[n.jsx("div",{className:"text-sm text-gray-400",children:"AI Confidence"}),n.jsx("div",{className:"text-2xl font-bold text-purple-400",children:"94.2%"}),n.jsx("div",{className:"text-xs text-gray-400",children:"Prediction accuracy"})]})]}),n.jsx(Uv,{config:aat,className:"h-64",children:n.jsxs(uS,{data:x,children:[n.jsx($s,{strokeDasharray:"3 3",stroke:"#374151"}),n.jsx(is,{dataKey:"time",stroke:"#9ca3af"}),n.jsx(Gi,{domain:[0,1],stroke:"#9ca3af"}),n.jsx(zT,{content:n.jsx(Gv,{})}),n.jsx(Zo,{type:"monotone",dataKey:"sentiment",stroke:"#10b981",fill:"#10b981",fillOpacity:.3,strokeWidth:2})]})})]})]}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[n.jsxs(jt,{className:"lg:col-span-2 bg-beam-dark-accent/70 border-gray-700",children:[n.jsx(wr,{children:n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsxs(fr,{className:"text-white flex items-center",children:[n.jsx(DQ,{className:"mr-2 h-5 w-5 text-true-red"}),"Real-Time Market News"]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("select",{value:e,onChange:F=>t(F.target.value),className:"bg-beam-dark-accent border border-gray-700 text-white text-sm rounded px-3 py-1",children:d.map(F=>n.jsx("option",{value:F,children:F.charAt(0).toUpperCase()+F.slice(1)},F))}),n.jsx("select",{value:r,onChange:F=>i(F.target.value),className:"bg-beam-dark-accent border border-gray-700 text-white text-sm rounded px-3 py-1",children:s.map(F=>n.jsx("option",{value:F,children:F.charAt(0).toUpperCase()+F.slice(1)},F))})]})]})}),n.jsx(Ht,{className:"space-y-4",children:j.map(F=>n.jsx(jt,{className:"bg-beam-dark-accent/50 border-gray-700/50 hover:border-true-red/30 transition-colors",children:n.jsxs(Ht,{className:"p-4",children:[n.jsxs("div",{className:"flex justify-between items-start mb-3",children:[n.jsxs("div",{className:"flex-1",children:[n.jsx("h4",{className:"font-medium text-white mb-2 leading-tight",children:F.headline}),n.jsxs("div",{className:"flex items-center gap-3 text-sm text-gray-400",children:[n.jsx("span",{children:F.source}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx($a,{className:"h-3 w-3"}),F.timestamp]})]})]}),n.jsxs("div",{className:"flex flex-col items-end gap-2",children:[n.jsx(Tt,{className:S(F.sentiment),children:F.sentiment}),n.jsx("div",{className:`text-sm font-medium ${P(F.impact)}`,children:F.marketReaction})]})]}),n.jsx("div",{className:"mb-3 p-3 rounded-lg bg-beam-dark-accent/30 border-l-2 border-true-red/30",children:n.jsxs("div",{className:"flex items-start gap-2",children:[n.jsx(ti,{className:"h-4 w-4 text-true-red mt-0.5 flex-shrink-0"}),n.jsxs("div",{children:[n.jsx("div",{className:"text-xs text-gray-500 uppercase tracking-wide mb-1",children:"AI Analysis"}),n.jsx("p",{className:"text-sm text-gray-300",children:F.aiAnalysis})]})]})}),n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-xs text-gray-400",children:"Relevant:"}),n.jsxs("div",{className:"flex gap-1",children:[F.relevantStocks.slice(0,3).map((L,B)=>n.jsx(Tt,{variant:"outline",className:"text-xs py-0 px-2 border-gray-600 text-gray-400",children:L},B)),F.relevantStocks.length>3&&n.jsxs(Tt,{variant:"outline",className:"text-xs py-0 px-2 border-gray-600 text-gray-400",children:["+",F.relevantStocks.length-3]})]})]}),n.jsx(lt,{size:"sm",variant:"ghost",className:"text-gray-400 hover:text-white",children:n.jsx(IF,{className:"h-4 w-4"})})]})]})},F.id))})]}),n.jsxs(jt,{className:"bg-beam-dark-accent/70 border-gray-700",children:[n.jsx(wr,{children:n.jsxs(fr,{className:"text-white flex items-center",children:[n.jsx(En,{className:"mr-2 h-5 w-5 text-true-red"}),"Sector Impact Analysis"]})}),n.jsx(Ht,{className:"space-y-4",children:w.map((F,L)=>n.jsxs("div",{className:"p-3 rounded-lg bg-beam-dark-accent/30 border border-gray-700/50",children:[n.jsxs("div",{className:"flex justify-between items-center mb-2",children:[n.jsx("h4",{className:"font-medium text-white",children:F.sector}),n.jsx("div",{className:`text-sm font-medium ${F.change.startsWith("+")?"text-green-400":"text-red-400"}`,children:F.change})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsx("span",{className:"text-gray-400",children:"Sentiment"}),n.jsxs("span",{className:"text-white",children:[(F.sentiment*100).toFixed(0),"%"]})]}),n.jsx(vn,{value:F.sentiment*100,className:"h-2"}),n.jsxs("div",{className:"flex justify-between text-xs text-gray-400",children:[n.jsxs("span",{children:[F.articles," articles"]}),n.jsx("span",{children:"Last 4 hours"})]})]})]},L))})]})]})]})},lat=()=>{const[e,t]=U.useState(null);U.useState(new Set);const r=[{agentId:"market-research-agent",agentName:"AI Market Research Agent",recommendation:"Strong Buy - AI Infrastructure ETF",confidence:96,reasoning:{dataPoints:["NVIDIA revenue up 206% YoY in Q3 2024","AI chip demand increased 73% globally","Microsoft, Google, Amazon increasing AI capex by 60%","Patent filings in AI hardware up 145% this year"],analysisSteps:["Scraped 2,847 news articles and financial reports","Analyzed earnings calls from top 50 tech companies","Cross-referenced government AI spending initiatives","Evaluated supply chain improvements and bottlenecks"],riskFactors:["Potential China trade restrictions on semiconductors","High valuations in AI sector (P/E ratios above historical norms)","Competition from custom chip development by major tech firms"],supportingEvidence:["SEC filings show 340% increase in AI infrastructure investments","Job postings for AI hardware engineers up 89%","Venture capital AI hardware funding reached $12B in 2024"]},sources:[{type:"SEC Filing",title:"NVIDIA Q3 2024 10-Q",relevance:98,timestamp:"2024-12-09 14:30"},{type:"News",title:"Reuters: AI Chip Shortage Easing",relevance:92,timestamp:"2024-12-09 11:15"},{type:"Analyst Report",title:"Goldman Sachs AI Infrastructure Outlook",relevance:89,timestamp:"2024-12-08 16:45"},{type:"Market Data",title:"Bloomberg Terminal: Semiconductor Index",relevance:85,timestamp:"2024-12-09 15:00"}],decisionPath:[{step:"Data Collection",action:"Scanned 2,847 sources",outcome:"Identified 23 high-relevance signals",confidence:94},{step:"Sentiment Analysis",action:"Analyzed market sentiment",outcome:"Bullish sentiment score: 8.3/10",confidence:91},{step:"Risk Assessment",action:"Evaluated downside scenarios",outcome:"Max drawdown risk: 15-20%",confidence:88},{step:"Final Recommendation",action:"Generated investment thesis",outcome:"Strong Buy with 28-35% target",confidence:96}]},{agentId:"trend-analysis-agent",agentName:"Predictive Trend Analyzer",recommendation:"Sector Rotation into Energy",confidence:78,reasoning:{dataPoints:["Energy sector correlation with tech dropping to 0.23","Oil prices showing technical breakout pattern","Renewable energy stocks oversold by 32%","Energy ETF options showing unusual call volume"],analysisSteps:["Applied ML pattern recognition across 15 sectors","Analyzed historical sector rotation cycles","Evaluated geopolitical energy market drivers","Cross-validated with options flow data"],riskFactors:["Potential recession could dampen energy demand","Green energy policy uncertainty","Volatile commodity price environment"],supportingEvidence:["Historical data shows 78% accuracy in sector rotation predictions","Energy sector P/E ratios at 5-year lows","Institutional money flow showing early rotation signs"]},sources:[{type:"Market Data",title:"Energy Sector Performance Analysis",relevance:94,timestamp:"2024-12-09 13:20"},{type:"Options Flow",title:"Unusual Energy Options Activity",relevance:87,timestamp:"2024-12-09 12:45"},{type:"Technical Analysis",title:"Sector Rotation Indicators",relevance:82,timestamp:"2024-12-09 10:30"}],decisionPath:[{step:"Pattern Detection",action:"Identified rotation signals",outcome:"Found 5 confirming indicators",confidence:82},{step:"Historical Validation",action:"Backtested similar patterns",outcome:"78% historical accuracy",confidence:79},{step:"Risk Modeling",action:"Assessed downside risks",outcome:"Risk-adjusted return positive",confidence:75},{step:"Timing Analysis",action:"Optimized entry timing",outcome:"Next 3-6 months favorable",confidence:78}]}],i=a=>a>=90?"text-green-400":a>=70?"text-amber-400":"text-red-400";return r.find(a=>a.agentId===e),n.jsx("div",{className:"space-y-4",children:n.jsxs(jt,{className:"bg-beam-dark-accent/70 border-gray-700",children:[n.jsxs(wr,{children:[n.jsxs(fr,{className:"text-white flex items-center",children:[n.jsx(ti,{className:"mr-2 h-5 w-5 text-true-red"}),"Agent Decision Traceability"]}),n.jsx("p",{className:"text-sm text-gray-400",children:"Drill down into AI reasoning and confidence levels"})]}),n.jsx(Ht,{className:"space-y-3",children:r.map(a=>n.jsxs("div",{className:"p-4 rounded-lg bg-beam-dark-accent/30 border border-gray-700/50",children:[n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsxs("div",{className:"flex-1",children:[n.jsx("h4",{className:"font-medium text-white",children:a.agentName}),n.jsx("p",{className:"text-sm text-gray-400",children:a.recommendation})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs("div",{className:"text-right",children:[n.jsx("p",{className:"text-xs text-gray-400",children:"Confidence"}),n.jsxs("p",{className:`text-lg font-bold ${i(a.confidence)}`,children:[a.confidence,"%"]})]}),n.jsxs(Ml,{children:[n.jsx(F_,{asChild:!0,children:n.jsxs(lt,{size:"sm",className:"bg-true-red hover:bg-true-red/80",onClick:()=>t(a.agentId),children:[n.jsx(mh,{className:"mr-2 h-4 w-4"}),"View Reasoning"]})}),n.jsxs(Qo,{className:"max-w-4xl max-h-[80vh] bg-beam-dark border-gray-700",children:[n.jsx(el,{children:n.jsxs(tl,{className:"text-white flex items-center",children:[n.jsx(ti,{className:"mr-2 h-5 w-5 text-true-red"}),a.agentName," - Decision Analysis"]})}),n.jsxs($i,{defaultValue:"reasoning",className:"w-full",children:[n.jsxs(Di,{className:"bg-beam-dark-accent/50 border border-gray-700",children:[n.jsx(Jt,{value:"reasoning",children:"Reasoning Process"}),n.jsx(Jt,{value:"sources",children:"Data Sources"}),n.jsx(Jt,{value:"path",children:"Decision Path"})]}),n.jsx(ur,{value:"reasoning",className:"mt-4",children:n.jsx(Cl,{className:"h-[400px] pr-4",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"p-4 rounded-lg bg-beam-dark-accent/30 border border-green-700/30",children:[n.jsx("h4",{className:"font-medium text-green-400 mb-2",children:"Key Data Points"}),n.jsx("ul",{className:"space-y-1",children:a.reasoning.dataPoints.map((l,d)=>n.jsxs("li",{className:"text-sm text-gray-300 flex items-start",children:[n.jsx("div",{className:"w-1 h-1 bg-green-400 rounded-full mt-2 mr-2 flex-shrink-0"}),l]},d))})]}),n.jsxs("div",{className:"p-4 rounded-lg bg-beam-dark-accent/30 border border-blue-700/30",children:[n.jsx("h4",{className:"font-medium text-blue-400 mb-2",children:"Analysis Steps"}),n.jsx("ul",{className:"space-y-1",children:a.reasoning.analysisSteps.map((l,d)=>n.jsxs("li",{className:"text-sm text-gray-300 flex items-start",children:[n.jsx("div",{className:"w-1 h-1 bg-blue-400 rounded-full mt-2 mr-2 flex-shrink-0"}),l]},d))})]}),n.jsxs("div",{className:"p-4 rounded-lg bg-beam-dark-accent/30 border border-amber-700/30",children:[n.jsx("h4",{className:"font-medium text-amber-400 mb-2",children:"Risk Factors"}),n.jsx("ul",{className:"space-y-1",children:a.reasoning.riskFactors.map((l,d)=>n.jsxs("li",{className:"text-sm text-gray-300 flex items-start",children:[n.jsx("div",{className:"w-1 h-1 bg-amber-400 rounded-full mt-2 mr-2 flex-shrink-0"}),l]},d))})]}),n.jsxs("div",{className:"p-4 rounded-lg bg-beam-dark-accent/30 border border-purple-700/30",children:[n.jsx("h4",{className:"font-medium text-purple-400 mb-2",children:"Supporting Evidence"}),n.jsx("ul",{className:"space-y-1",children:a.reasoning.supportingEvidence.map((l,d)=>n.jsxs("li",{className:"text-sm text-gray-300 flex items-start",children:[n.jsx("div",{className:"w-1 h-1 bg-purple-400 rounded-full mt-2 mr-2 flex-shrink-0"}),l]},d))})]})]})})}),n.jsx(ur,{value:"sources",className:"mt-4",children:n.jsx(Cl,{className:"h-[400px] pr-4",children:n.jsx("div",{className:"space-y-3",children:a.sources.map((l,d)=>n.jsxs("div",{className:"p-3 rounded-lg bg-beam-dark-accent/30 border border-gray-700/50",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Tt,{variant:"outline",className:"text-xs",children:l.type}),n.jsx("span",{className:"text-sm font-medium text-white",children:l.title})]}),n.jsxs("div",{className:"text-right",children:[n.jsx("p",{className:"text-xs text-gray-400",children:"Relevance"}),n.jsxs("p",{className:`text-sm font-medium ${i(l.relevance)}`,children:[l.relevance,"%"]})]})]}),n.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-400",children:[n.jsx($a,{className:"h-3 w-3"}),l.timestamp]}),n.jsx(vn,{value:l.relevance,className:"h-1 mt-2"})]},d))})})}),n.jsx(ur,{value:"path",className:"mt-4",children:n.jsx(Cl,{className:"h-[400px] pr-4",children:n.jsx("div",{className:"space-y-3",children:a.decisionPath.map((l,d)=>n.jsx("div",{className:"relative",children:n.jsxs("div",{className:"flex items-start gap-4",children:[n.jsxs("div",{className:"flex flex-col items-center",children:[n.jsx("div",{className:`w-3 h-3 rounded-full ${l.confidence>=90?"bg-green-500":l.confidence>=70?"bg-amber-500":"bg-red-500"}`}),d<a.decisionPath.length-1&&n.jsx("div",{className:"w-px h-16 bg-gray-700 mt-2"})]}),n.jsxs("div",{className:"flex-1 pb-8",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("h4",{className:"font-medium text-white",children:l.step}),n.jsxs("span",{className:`text-sm font-medium ${i(l.confidence)}`,children:[l.confidence,"%"]})]}),n.jsxs("p",{className:"text-sm text-gray-400 mb-1",children:[n.jsx("strong",{children:"Action:"})," ",l.action]}),n.jsxs("p",{className:"text-sm text-gray-300",children:[n.jsx("strong",{children:"Outcome:"})," ",l.outcome]})]})]})},d))})})})]})]})]})]})]}),n.jsx(vn,{value:a.confidence,className:"h-2"})]},a.agentId))})]})})},cat=()=>{const[e,t]=U.useState(!1),[r,i]=U.useState(!1),[a,l]=U.useState(!1),[d,s]=U.useState(""),[p,x]=U.useState(null),[w,j]=U.useState([{id:"1",type:"assistant",content:"Hello! I'm your AI assistant. Click on any part of the dashboard to ask questions about it, or ask me anything about the wealth management data.",timestamp:new Date().toLocaleTimeString()}]),S=U.useRef(null),P=()=>{var $;($=S.current)==null||$.scrollIntoView({behavior:"smooth"})};U.useEffect(()=>{P()},[w]),U.useEffect(()=>{if(a){document.body.style.cursor="crosshair";const $=G=>{G.preventDefault(),G.stopPropagation();const W=G.target,Z=F(W);x(Z),l(!1),document.body.style.cursor="default";const se={id:Date.now().toString(),type:"assistant",content:`I can see you've selected: "${Z}". What would you like to know about this?`,timestamp:new Date().toLocaleTimeString(),contextElement:Z};j(ae=>[...ae,se])};return document.addEventListener("click",$,!0),()=>{document.removeEventListener("click",$,!0),document.body.style.cursor="default"}}},[a]);const F=$=>{var se;const G=((se=$.textContent)==null?void 0:se.trim().substring(0,50))||"",W=$.className,Z=$.tagName.toLowerCase();return G&&G.length>0?`${Z} containing "${G}${G.length>=50?"...":""}"`:W.includes("chart")||W.includes("Chart")?"Chart or visualization component":W.includes("card")||W.includes("Card")?"Dashboard card component":W.includes("agent")||W.includes("Agent")?"AI Agent component":`${Z} element`},L=()=>{if(!d.trim())return;const $={id:Date.now().toString(),type:"user",content:d,timestamp:new Date().toLocaleTimeString(),contextElement:p||void 0};j(G=>[...G,$]),setTimeout(()=>{const G={id:(Date.now()+1).toString(),type:"assistant",content:B(d,p),timestamp:new Date().toLocaleTimeString(),confidence:Math.floor(Math.random()*20)+80};j(W=>[...W,G])},1e3),s(""),x(null)},B=($,G)=>{const W=[`Based on the AI agents' analysis, this ${G||"element"} shows strong performance indicators. The confidence level is high due to multiple confirming data sources.`,"The recommendation here is backed by real-time market data and sentiment analysis. Our AI research agents identified this opportunity through web scraping and pattern recognition.","This visualization represents data from 6 active AI agents. The confidence score reflects the consensus across multiple analysis frameworks including risk assessment and trend prediction.","The underlying algorithm considers 247 risk factors and cross-references with historical patterns. This specific insight has a 94% historical accuracy rate.","This component leverages machine learning models trained on 15+ years of market data. The current recommendation aligns with 5 different analytical approaches."];return W[Math.floor(Math.random()*W.length)]},V=["Why is this recommendation confidence so high?","What data sources support this analysis?","How does this compare to historical trends?","What are the main risk factors here?","Explain the AI reasoning behind this"];return e?r?n.jsx("div",{className:"fixed bottom-6 right-6 z-50",children:n.jsx(jt,{className:"bg-beam-dark border-gray-700 w-80",children:n.jsx(wr,{className:"pb-2",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs(fr,{className:"text-white text-sm flex items-center",children:[n.jsx(_s,{className:"mr-2 h-4 w-4 text-true-red"}),"RM Assistant"]}),n.jsxs("div",{className:"flex gap-1",children:[n.jsx(lt,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",onClick:()=>i(!1),children:n.jsx(fve,{className:"h-3 w-3"})}),n.jsx(lt,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",onClick:()=>t(!1),children:n.jsx(Pc,{className:"h-3 w-3"})})]})]})})})}):n.jsx("div",{className:"fixed bottom-6 right-6 z-50",children:n.jsxs(jt,{className:"bg-beam-dark border-gray-700 w-96 h-[600px] shadow-2xl",children:[n.jsxs(wr,{className:"pb-2",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs(fr,{className:"text-white text-sm flex items-center",children:[n.jsx(_s,{className:"mr-2 h-4 w-4 text-true-red"}),"RM AI Assistant"]}),n.jsxs("div",{className:"flex gap-1",children:[n.jsx(lt,{variant:"ghost",size:"sm",className:`h-6 w-6 p-0 ${a?"bg-true-red text-white":""}`,onClick:()=>l(!a),title:"Click to highlight and question UI elements",children:n.jsx(mh,{className:"h-3 w-3"})}),n.jsx(lt,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",onClick:()=>i(!0),children:n.jsx(pve,{className:"h-3 w-3"})}),n.jsx(lt,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",onClick:()=>t(!1),children:n.jsx(Pc,{className:"h-3 w-3"})})]})]}),a&&n.jsx(Tt,{className:"bg-true-red/20 text-true-red border-true-red/30 text-xs",children:"Click on any UI element to ask about it"})]}),n.jsxs(Ht,{className:"flex flex-col h-[500px] p-4",children:[n.jsx(Cl,{className:"flex-1 pr-4 mb-4",children:n.jsxs("div",{className:"space-y-4",children:[w.map($=>n.jsx("div",{className:`flex ${$.type==="user"?"justify-end":"justify-start"}`,children:n.jsxs("div",{className:`max-w-[80%] p-3 rounded-lg ${$.type==="user"?"bg-true-red text-white":"bg-beam-dark-accent/70 border border-gray-700 text-gray-300"}`,children:[n.jsx("p",{className:"text-sm",children:$.content}),n.jsxs("div",{className:"flex items-center justify-between mt-2",children:[n.jsx("span",{className:"text-xs opacity-70",children:$.timestamp}),$.confidence&&n.jsxs(Tt,{variant:"outline",className:"text-xs",children:[$.confidence,"% confidence"]})]}),$.contextElement&&n.jsxs(Tt,{variant:"outline",className:"text-xs mt-1",children:[n.jsx(mh,{className:"h-3 w-3 mr-1"}),$.contextElement]})]})},$.id)),n.jsx("div",{ref:S})]})}),n.jsxs("div",{className:"mb-3",children:[n.jsx("p",{className:"text-xs text-gray-400 mb-2",children:"Quick questions:"}),n.jsx("div",{className:"flex flex-wrap gap-1",children:V.slice(0,3).map(($,G)=>n.jsx(lt,{variant:"outline",size:"sm",className:"text-xs h-6 border-gray-600 text-gray-300",onClick:()=>s($),children:$},G))})]}),p&&n.jsx("div",{className:"mb-2 p-2 bg-beam-dark-accent/30 rounded border border-true-red/30",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(mh,{className:"h-3 w-3 text-true-red"}),n.jsxs("span",{className:"text-xs text-gray-300",children:["Selected: ",p]}),n.jsx(lt,{variant:"ghost",size:"sm",className:"h-4 w-4 p-0 ml-auto",onClick:()=>x(null),children:n.jsx(Pc,{className:"h-3 w-3"})})]})}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx(An,{value:d,onChange:$=>s($.target.value),placeholder:"Ask about any part of the dashboard...",className:"bg-beam-dark-accent/50 border-gray-700 text-white",onKeyPress:$=>$.key==="Enter"&&L()}),n.jsx(lt,{onClick:L,size:"sm",className:"bg-true-red hover:bg-true-red/80",disabled:!d.trim(),children:n.jsx(zF,{className:"h-4 w-4"})})]})]})]})}):n.jsx("div",{className:"fixed bottom-6 right-6 z-50",children:n.jsx(lt,{onClick:()=>t(!0),className:"bg-true-red hover:bg-true-red/80 text-white rounded-full w-14 h-14 shadow-lg",size:"lg",children:n.jsx(_s,{className:"h-6 w-6"})})})};function uat(){const[e,t]=U.useState("workflow"),[r,i]=U.useState("rm");return n.jsx(Ia,{children:n.jsxs("div",{className:"space-y-4 bg-black min-h-screen w-full max-w-full overflow-x-hidden pl-1 pr-4 py-4",children:[n.jsx("div",{className:"bg-gradient-to-r from-beam-dark to-beam-dark-accent rounded-xl p-4 md:p-6 text-white",children:n.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-start gap-4",children:[n.jsxs("div",{className:"min-w-0 flex-1",children:[n.jsxs("h1",{className:"text-2xl md:text-3xl font-bold mb-2 flex items-center flex-wrap",children:[n.jsx(ti,{className:"mr-3 h-6 w-6 md:h-8 md:w-8 text-true-red flex-shrink-0"}),n.jsx("span",{children:"AI Wealth Management Centre"})]}),n.jsx("p",{className:"text-gray-300 text-sm md:text-base",children:"Advanced AI-powered portfolio management with real-time market research"})]}),n.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[n.jsx(Tt,{className:"bg-green-900/20 text-green-300 border-green-700/30 text-xs",children:"6 Agents Active"}),n.jsx(Tt,{className:"bg-blue-900/20 text-blue-300 border-blue-700/30 text-xs",children:"Real-time Research"}),n.jsxs("div",{className:"flex gap-1",children:[n.jsx(lt,{size:"sm",variant:r==="rm"?"default":"outline",onClick:()=>i("rm"),className:r==="rm"?"bg-true-red hover:bg-true-red/80 text-xs":"border-gray-600 text-xs",children:"RM View"}),n.jsx(lt,{size:"sm",variant:r==="client"?"default":"outline",onClick:()=>i("client"),className:r==="client"?"bg-true-red hover:bg-true-red/80 text-xs":"border-gray-600 text-xs",children:"Client View"})]})]})]})}),n.jsxs($i,{value:e,onValueChange:t,className:"w-full max-w-full",children:[n.jsx("div",{className:"overflow-x-auto",children:n.jsxs(Di,{className:"bg-beam-dark-accent/50 border border-gray-700 w-max min-w-full flex",children:[n.jsxs(Jt,{value:"workflow",className:"flex items-center gap-1 text-xs px-2 py-1 whitespace-nowrap",children:[n.jsx(p_,{className:"h-3 w-3 flex-shrink-0"}),n.jsx("span",{className:"hidden md:inline",children:r==="rm"?"RM Workflow":"Client Dashboard"}),n.jsx("span",{className:"md:hidden",children:"Work"})]}),n.jsxs(Jt,{value:"portfolio",className:"flex items-center gap-1 text-xs px-2 py-1 whitespace-nowrap",children:[n.jsx(to,{className:"h-3 w-3 flex-shrink-0"}),n.jsx("span",{className:"hidden md:inline",children:"Portfolio"}),n.jsx("span",{className:"md:hidden",children:"Port"})]}),n.jsxs(Jt,{value:"research",className:"flex items-center gap-1 text-xs px-2 py-1 whitespace-nowrap",children:[n.jsx(Zs,{className:"h-3 w-3 flex-shrink-0"}),n.jsx("span",{className:"hidden md:inline",children:"Market Intel"}),n.jsx("span",{className:"md:hidden",children:"Mkt"})]}),n.jsxs(Jt,{value:"news",className:"flex items-center gap-1 text-xs px-2 py-1 whitespace-nowrap",children:[n.jsx(DQ,{className:"h-3 w-3 flex-shrink-0"}),n.jsx("span",{className:"hidden md:inline",children:"News"}),n.jsx("span",{className:"md:hidden",children:"News"})]}),n.jsxs(Jt,{value:"recommendations",className:"flex items-center gap-1 text-xs px-2 py-1 whitespace-nowrap",children:[n.jsx(En,{className:"h-3 w-3 flex-shrink-0"}),n.jsx("span",{className:"hidden md:inline",children:"AI Rec"}),n.jsx("span",{className:"md:hidden",children:"AI"})]}),n.jsxs(Jt,{value:"insights",className:"flex items-center gap-1 text-xs px-2 py-1 whitespace-nowrap",children:[n.jsx(dn,{className:"h-3 w-3 flex-shrink-0"}),n.jsx("span",{className:"hidden md:inline",children:"Health"}),n.jsx("span",{className:"md:hidden",children:"Hlth"})]}),n.jsxs(Jt,{value:"traceability",className:"flex items-center gap-1 text-xs px-2 py-1 whitespace-nowrap",children:[n.jsx($c,{className:"h-3 w-3 flex-shrink-0"}),n.jsx("span",{className:"hidden md:inline",children:"Trace"}),n.jsx("span",{className:"md:hidden",children:"Trc"})]})]})}),n.jsx(ur,{value:"workflow",className:"mt-6",children:r==="rm"?n.jsx(sat,{}):n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[n.jsx("div",{className:"lg:col-span-1",children:n.jsx(Qy,{})}),n.jsx("div",{className:"lg:col-span-2",children:n.jsx(YZ,{})})]})}),n.jsx(ur,{value:"portfolio",className:"mt-6",children:n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[n.jsx("div",{className:"lg:col-span-1",children:n.jsx(Qy,{})}),n.jsx("div",{className:"lg:col-span-2",children:n.jsx(YZ,{})})]})}),n.jsx(ur,{value:"research",className:"mt-6",children:n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[n.jsx("div",{className:"lg:col-span-1",children:n.jsx(Qy,{})}),n.jsx("div",{className:"lg:col-span-2",children:n.jsx(iat,{})})]})}),n.jsx(ur,{value:"news",className:"mt-6",children:n.jsx(oat,{})}),n.jsx(ur,{value:"recommendations",className:"mt-6",children:n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[n.jsx("div",{className:"lg:col-span-1",children:n.jsx(Qy,{})}),n.jsx("div",{className:"lg:col-span-2",children:n.jsx(eat,{})})]})}),n.jsx(ur,{value:"insights",className:"mt-6",children:n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[n.jsx("div",{className:"lg:col-span-1",children:n.jsx(Qy,{})}),n.jsx("div",{className:"lg:col-span-2",children:n.jsx(nat,{})})]})}),n.jsx(ur,{value:"traceability",className:"mt-6",children:n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[n.jsx("div",{className:"lg:col-span-1",children:n.jsx(Qy,{})}),n.jsx("div",{className:"lg:col-span-2",children:n.jsx(lat,{})})]})})]}),n.jsx(cat,{})]})})}const gde=U.createContext(void 0),xde=({children:e})=>{const[t,r]=U.useState(localStorage.getItem("cvm-chat-mode")==="true"),[i,a]=U.useState(JSON.parse(localStorage.getItem("cvm-chat-messages")||"[]"));U.useEffect(()=>{localStorage.setItem("cvm-chat-mode",String(t))},[t]),U.useEffect(()=>{localStorage.setItem("cvm-chat-messages",JSON.stringify(i))},[i]);const l=()=>new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),p={chatMode:t,setChatMode:r,chatMessages:i,addChatMessage:x=>{a(w=>[...w,{...x,timestamp:l()}])},clearChatMessages:()=>{a([])}};return n.jsx(gde.Provider,{value:p,children:e})},V_=()=>{const e=U.useContext(gde);if(e===void 0)throw new Error("useCvmChatContext must be used within a CvmChatProvider");return e},ev=({name:e,description:t,icon:r,queryPrompt:i,onAgentClick:a})=>n.jsxs(jt,{className:"bg-beam-dark-accent/30 border-gray-700/30 hover:border-purple-500/50 transition-colors",children:[n.jsx(wr,{className:"pb-3",children:n.jsxs("div",{className:"flex justify-between items-start",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[r,n.jsxs("div",{children:[n.jsx(fr,{className:"text-md text-white",children:e}),n.jsx(Tt,{variant:"outline",className:"mt-1 bg-purple-900/20 text-purple-300 border-purple-700/30",children:"CVM Agent"})]})]}),n.jsx(lt,{variant:"ghost",size:"sm",className:"text-purple-400 hover:text-purple-300 hover:bg-purple-900/30 p-1 h-auto",onClick:()=>a(e,i),children:n.jsx(_s,{size:16})})]})}),n.jsx(Ht,{children:n.jsx("p",{className:"text-sm text-gray-300",children:t})})]}),dat=()=>{const{addChatMessage:e}=V_(),t=(r,i)=>{e({role:"user",content:i}),setTimeout(()=>{e({role:"assistant",content:{"Segment Analyzer":"I've analyzed your customer segments. The High Value segment shows 15% higher engagement this month compared to last quarter. Would you like me to provide more detailed metrics on any specific segment?","Campaign Optimizer":"Based on your recent campaigns, I recommend focusing on the Premium Retention Offer which has shown the highest ROI at 5.1x. I can help you optimize audience targeting for this campaign.","CLV Predictor":"The predicted lifetime value for your Medium Value segment is increasing by 8% following your recent targeted campaigns. The top-spending customers are showing a 12% higher retention rate.","Churn Prevention Specialist":"I've identified 123 customers at high risk of churn in the next 30 days. Would you like me to suggest personalized retention offers for these customers?","Customer Journey Mapper":"I've analyzed the customer journey touchpoints and found that customers who engage with the mobile app have a 32% higher purchase frequency. The website-to-app transition is a critical conversion point.","Marketing Mix Modeler":"Based on your current marketing mix, social media contributes to 28% of conversions while email drives 35%. I recommend increasing your social media budget allocation by 10%."}[r]||"I can help you analyze and optimize your customer value management strategy."})},1500)};return n.jsx("div",{className:"space-y-6",children:n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-5",children:[n.jsx(ev,{name:"Segment Analyzer",description:"Analyzes customer segments and identifies key characteristics, behaviors, and value metrics for each group.",icon:n.jsx(qi,{size:24,className:"text-blue-400"}),queryPrompt:"Analyze my customer segments and provide insights",onAgentClick:t}),n.jsx(ev,{name:"Campaign Optimizer",description:"Suggests campaign optimizations based on historical performance data and audience response patterns.",icon:n.jsx(Co,{size:24,className:"text-green-400"}),queryPrompt:"Which campaign should I focus on based on ROI?",onAgentClick:t}),n.jsx(ev,{name:"CLV Predictor",description:"Predicts customer lifetime value for different segments and recommends strategies to increase revenue.",icon:n.jsx(En,{size:24,className:"text-purple-400"}),queryPrompt:"Predict the lifetime value for my customer segments",onAgentClick:t}),n.jsx(ev,{name:"Churn Prevention Specialist",description:"Identifies customers at risk of churn and suggests targeted retention strategies.",icon:n.jsx(Hi,{size:24,className:"text-red-400"}),queryPrompt:"Show me customers at risk of churning",onAgentClick:t}),n.jsx(ev,{name:"Customer Journey Mapper",description:"Maps and analyzes customer journeys across channels to identify optimization opportunities.",icon:n.jsx(_s,{size:24,className:"text-yellow-400"}),queryPrompt:"Analyze our customer journey touchpoints",onAgentClick:t}),n.jsx(ev,{name:"Marketing Mix Modeler",description:"Analyzes the effectiveness of marketing channels and recommends optimal budget allocation.",icon:n.jsx(ln,{size:24,className:"text-orange-400"}),queryPrompt:"What's our optimal marketing mix?",onAgentClick:t})]})})},lT=["#0088FE","#00C49F","#FFBB28","#FF8042","#8884d8","#82ca9d"],_R=[{name:"High Value",value:28,count:126e4,arpu:42,churn:5,tenure:48},{name:"Medium Value",value:35,count:1575e3,arpu:28,churn:12,tenure:24},{name:"Low Value",value:22,count:99e4,arpu:15,churn:20,tenure:12},{name:"New Customers",value:15,count:675e3,arpu:22,churn:25,tenure:3}],hat=[{name:"High Value",prepaid:32e4,postpaid:94e4},{name:"Medium Value",prepaid:875e3,postpaid:7e5},{name:"Low Value",prepaid:79e4,postpaid:2e5},{name:"New Customers",prepaid:475e3,postpaid:2e5}],XZ=[{name:"Voice Only",value:15},{name:"Data Only",value:25},{name:"Voice & Data",value:40},{name:"Voice, Data & VAS",value:20}],mat=[{id:"1001",name:"Alex Johnson",segment:"High Value",arpu:45,tenure:36,churn:"Low",dataUsage:"12GB",services:"Voice, Data, VAS",lastRecharge:"2023-05-01"},{id:"1002",name:"Samantha Lee",segment:"High Value",arpu:38,tenure:48,churn:"Low",dataUsage:"15GB",services:"Voice, Data, VAS",lastRecharge:"2023-05-03"},{id:"1003",name:"David Wilson",segment:"Medium Value",arpu:25,tenure:24,churn:"Medium",dataUsage:"8GB",services:"Voice & Data",lastRecharge:"2023-04-28"},{id:"1004",name:"Mei Zhang",segment:"Low Value",arpu:18,tenure:12,churn:"High",dataUsage:"3GB",services:"Data Only",lastRecharge:"2023-04-15"},{id:"1005",name:"James Brown",segment:"New Customers",arpu:22,tenure:2,churn:"Medium",dataUsage:"5GB",services:"Voice & Data",lastRecharge:"2023-05-05"}],fat=()=>{const[e,t]=U.useState("chart"),[r,i]=U.useState({segment:"all",arpuMin:0,arpuMax:50,tenureMin:0,tenureMax:60}),a=()=>{za({title:"Segmentation Analysis Complete",description:"Customer segments have been updated based on your criteria."})},l=()=>{za({title:"Segment Saved",description:"Your custom segment definition has been saved for future use."})},d=()=>{za({title:"Export Started",description:"Customer segment data is being exported to CSV format."})};return n.jsx("div",{className:"space-y-6",children:n.jsxs(jt,{className:"shadow-lg border-gray-800/30 bg-beam-dark-accent/50 backdrop-blur-md",children:[n.jsx(wr,{className:"pb-2",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx(fr,{className:"text-xl text-white",children:"Customer Segmentation Analysis"}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs(lt,{variant:"outline",size:"sm",onClick:()=>t("chart"),className:e==="chart"?"bg-beam-blue/20":"",children:[n.jsx(Co,{size:16,className:"mr-1"}),"Bar"]}),n.jsxs(lt,{variant:"outline",size:"sm",onClick:()=>t("pie"),className:e==="pie"?"bg-beam-blue/20":"",children:[n.jsx(AQ,{size:16,className:"mr-1"}),"Pie"]}),n.jsxs(lt,{variant:"outline",size:"sm",onClick:()=>t("table"),className:e==="table"?"bg-beam-blue/20":"",children:[n.jsx(qi,{size:16,className:"mr-1"}),"Table"]})]})]})}),n.jsxs(Ht,{children:[n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-4 mb-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"text-sm text-gray-400 mb-1 block",children:"Segment"}),n.jsxs(_n,{defaultValue:"all",onValueChange:s=>i({...r,segment:s}),children:[n.jsx(xn,{className:"bg-beam-dark/70 border-gray-700",children:n.jsx(wn,{placeholder:"All Segments"})}),n.jsxs(yn,{className:"bg-beam-dark border-gray-700",children:[n.jsx(yt,{value:"all",children:"All Segments"}),n.jsx(yt,{value:"high",children:"High Value"}),n.jsx(yt,{value:"medium",children:"Medium Value"}),n.jsx(yt,{value:"low",children:"Low Value"}),n.jsx(yt,{value:"new",children:"New Customers"})]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm text-gray-400 mb-1 block",children:"Service Type"}),n.jsxs(_n,{defaultValue:"all",children:[n.jsx(xn,{className:"bg-beam-dark/70 border-gray-700",children:n.jsx(wn,{placeholder:"All Services"})}),n.jsxs(yn,{className:"bg-beam-dark border-gray-700",children:[n.jsx(yt,{value:"all",children:"All Services"}),n.jsx(yt,{value:"voice",children:"Voice Only"}),n.jsx(yt,{value:"data",children:"Data Only"}),n.jsx(yt,{value:"voice-data",children:"Voice & Data"}),n.jsx(yt,{value:"full",children:"Voice, Data & VAS"})]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm text-gray-400 mb-1 block",children:"ARPU Range ($ per month)"}),n.jsxs("div",{className:"pl-2 pr-4",children:[n.jsx(oh,{defaultValue:[0,50],max:50,step:1,onValueChange:s=>i({...r,arpuMin:s[0],arpuMax:s[1]})}),n.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[n.jsxs("span",{children:["$",r.arpuMin]}),n.jsxs("span",{children:["$",r.arpuMax]})]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm text-gray-400 mb-1 block",children:"Tenure (months)"}),n.jsxs("div",{className:"pl-2 pr-4",children:[n.jsx(oh,{defaultValue:[0,60],max:60,step:1,onValueChange:s=>i({...r,tenureMin:s[0],tenureMax:s[1]})}),n.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[n.jsxs("span",{children:[r.tenureMin,"m"]}),n.jsxs("span",{children:[r.tenureMax,"m"]})]})]})]}),n.jsxs("div",{className:"flex items-end gap-2",children:[n.jsxs(lt,{className:"bg-beam-blue hover:bg-blue-600",onClick:a,children:[n.jsx(kve,{size:16,className:"mr-2"}),"Run Segmentation"]}),n.jsxs(lt,{variant:"outline",children:[n.jsx(fm,{size:16,className:"mr-1"}),"More Filters"]})]})]}),n.jsxs("div",{className:"space-y-6",children:[e==="chart"&&n.jsxs("div",{className:"bg-beam-dark/70 p-4 rounded-lg border border-gray-700/30",children:[n.jsx("h3",{className:"text-white font-medium mb-4",children:"Customer Segments by Service Type"}),n.jsx(ms,{width:"100%",height:350,children:n.jsxs(nc,{data:hat,margin:{top:20,right:30,left:20,bottom:20},children:[n.jsx($s,{strokeDasharray:"3 3",stroke:"#444"}),n.jsx(is,{dataKey:"name",stroke:"#aaa"}),n.jsx(Gi,{stroke:"#aaa"}),n.jsx(yi,{contentStyle:{backgroundColor:"#1e1e2d",borderColor:"#444",color:"#fff"},formatter:s=>[`${s.toLocaleString()} subscribers`,""]}),n.jsx(xa,{}),n.jsx(pi,{dataKey:"prepaid",name:"Prepaid",fill:"#0088FE"}),n.jsx(pi,{dataKey:"postpaid",name:"Postpaid",fill:"#00C49F"})]})}),n.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[n.jsxs(lt,{variant:"outline",size:"sm",onClick:l,children:[n.jsx(LQ,{size:14,className:"mr-1"}),"Save View"]}),n.jsxs(lt,{variant:"outline",size:"sm",onClick:d,children:[n.jsx(Nu,{size:14,className:"mr-1"}),"Export Data"]})]})]}),e==="pie"&&n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"bg-beam-dark/70 p-4 rounded-lg border border-gray-700/30",children:[n.jsx("h3",{className:"text-white font-medium mb-4",children:"Customer Value Distribution"}),n.jsx(ms,{width:"100%",height:300,children:n.jsxs(oN,{children:[n.jsx(Gc,{data:_R,cx:"50%",cy:"50%",labelLine:!1,outerRadius:100,fill:"#8884d8",dataKey:"value",nameKey:"name",label:({name:s,percent:p})=>`${s}: ${(p*100).toFixed(0)}%`,children:_R.map((s,p)=>n.jsx(jd,{fill:lT[p%lT.length]},`cell-${p}`))}),n.jsx(yi,{formatter:s=>[`${s}%`,"Percentage"],contentStyle:{backgroundColor:"#1e1e2d",borderColor:"#444",color:"#fff"}})]})})]}),n.jsxs("div",{className:"bg-beam-dark/70 p-4 rounded-lg border border-gray-700/30",children:[n.jsx("h3",{className:"text-white font-medium mb-4",children:"Customer Service Type Distribution"}),n.jsx(ms,{width:"100%",height:300,children:n.jsxs(oN,{children:[n.jsx(Gc,{data:XZ,cx:"50%",cy:"50%",labelLine:!1,outerRadius:100,fill:"#8884d8",dataKey:"value",nameKey:"name",label:({name:s,percent:p})=>`${s}: ${(p*100).toFixed(0)}%`,children:XZ.map((s,p)=>n.jsx(jd,{fill:lT[p%lT.length]},`cell-${p}`))}),n.jsx(yi,{formatter:s=>[`${s}%`,"Percentage"],contentStyle:{backgroundColor:"#1e1e2d",borderColor:"#444",color:"#fff"}})]})})]})]}),e==="table"&&n.jsxs("div",{className:"bg-beam-dark/70 p-4 rounded-lg border border-gray-700/30",children:[n.jsx("h3",{className:"text-white font-medium mb-4",children:"Customer Details"}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs(Mc,{children:[n.jsx(Ic,{children:n.jsxs(Fs,{className:"border-gray-700",children:[n.jsx(Or,{className:"text-white",children:"ID"}),n.jsx(Or,{className:"text-white",children:"Customer Name"}),n.jsx(Or,{className:"text-white",children:"Segment"}),n.jsx(Or,{className:"text-white",children:"ARPU ($)"}),n.jsx(Or,{className:"text-white",children:"Tenure (m)"}),n.jsx(Or,{className:"text-white",children:"Churn Risk"}),n.jsx(Or,{className:"text-white",children:"Data Usage"}),n.jsx(Or,{className:"text-white",children:"Services"}),n.jsx(Or,{className:"text-white",children:"Last Recharge"})]})}),n.jsx(Oc,{children:mat.map(s=>n.jsxs(Fs,{className:"border-gray-700 hover:bg-gray-800/30",children:[n.jsx(Rr,{className:"text-white",children:s.id}),n.jsx(Rr,{className:"text-white",children:s.name}),n.jsx(Rr,{children:n.jsx(Tt,{className:`
                              ${s.segment==="High Value"?"bg-green-900/30 text-green-400 border-green-600":s.segment==="Medium Value"?"bg-blue-900/30 text-blue-400 border-blue-600":s.segment==="Low Value"?"bg-amber-900/30 text-amber-400 border-amber-600":"bg-purple-900/30 text-purple-400 border-purple-600"}
                            `,children:s.segment})}),n.jsxs(Rr,{className:"text-white",children:["$",s.arpu]}),n.jsx(Rr,{className:"text-white",children:s.tenure}),n.jsx(Rr,{children:n.jsx(Tt,{className:`
                              ${s.churn==="Low"?"bg-green-900/30 text-green-400 border-green-600":s.churn==="Medium"?"bg-amber-900/30 text-amber-400 border-amber-600":"bg-red-900/30 text-red-400 border-red-600"}
                            `,children:s.churn})}),n.jsx(Rr,{className:"text-white",children:s.dataUsage}),n.jsx(Rr,{className:"text-white",children:s.services}),n.jsx(Rr,{className:"text-white",children:s.lastRecharge})]},s.id))})]})}),n.jsxs("div",{className:"flex justify-between mt-4",children:[n.jsx("div",{className:"text-sm text-gray-400",children:"Showing 5 of 4,500,000 customers"}),n.jsxs(lt,{variant:"outline",size:"sm",onClick:d,children:[n.jsx(Nu,{size:14,className:"mr-1"}),"Export Data"]})]})]}),n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:_R.map((s,p)=>n.jsxs(jt,{className:`
                  bg-beam-dark/70 border-l-4 ${p===0?"border-l-green-500":p===1?"border-l-blue-500":p===2?"border-l-amber-500":"border-l-purple-500"} border-t-0 border-r-0 border-b-0 rounded-tr-lg rounded-br-lg
                `,children:[n.jsx(wr,{className:"pb-2",children:n.jsx(fr,{className:"text-lg text-white",children:s.name})}),n.jsx(Ht,{children:n.jsxs("dl",{className:"space-y-2",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("dt",{className:"text-gray-400",children:"Subscribers:"}),n.jsx("dd",{className:"font-medium text-white",children:s.count.toLocaleString()})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("dt",{className:"text-gray-400",children:"Avg. ARPU:"}),n.jsxs("dd",{className:"font-medium text-white",children:["$",s.arpu]})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("dt",{className:"text-gray-400",children:"Churn Rate:"}),n.jsxs("dd",{className:"font-medium text-white",children:[s.churn,"%"]})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("dt",{className:"text-gray-400",children:"Avg. Tenure:"}),n.jsxs("dd",{className:"font-medium text-white",children:[s.tenure," months"]})]})]})})]},p))})]})]})]})})},v$=6048e5,pat=864e5,yde=6e4,vde=36e5,JZ=Symbol.for("constructDateFrom");function no(e,t){return typeof e=="function"?e(t):e&&typeof e=="object"&&JZ in e?e[JZ](t):e instanceof Date?new e.constructor(t):new Date(t)}function Ri(e,t){return no(t||e,e)}function qo(e,t,r){const i=Ri(e,r==null?void 0:r.in);return isNaN(t)?no((r==null?void 0:r.in)||e,NaN):(t&&i.setDate(i.getDate()+t),i)}function Sd(e,t,r){const i=Ri(e,r==null?void 0:r.in);if(isNaN(t))return no((r==null?void 0:r.in)||e,NaN);if(!t)return i;const a=i.getDate(),l=no((r==null?void 0:r.in)||e,i.getTime());l.setMonth(i.getMonth()+t+1,0);const d=l.getDate();return a>=d?l:(i.setFullYear(l.getFullYear(),l.getMonth(),a),i)}let gat={};function _S(){return gat}function jh(e,t){var s,p,x,w;const r=_S(),i=(t==null?void 0:t.weekStartsOn)??((p=(s=t==null?void 0:t.locale)==null?void 0:s.options)==null?void 0:p.weekStartsOn)??r.weekStartsOn??((w=(x=r.locale)==null?void 0:x.options)==null?void 0:w.weekStartsOn)??0,a=Ri(e,t==null?void 0:t.in),l=a.getDay(),d=(l<i?7:0)+l-i;return a.setDate(a.getDate()-d),a.setHours(0,0,0,0),a}function px(e,t){return jh(e,{...t,weekStartsOn:1})}function bde(e,t){const r=Ri(e,t==null?void 0:t.in),i=r.getFullYear(),a=no(r,0);a.setFullYear(i+1,0,4),a.setHours(0,0,0,0);const l=px(a),d=no(r,0);d.setFullYear(i,0,4),d.setHours(0,0,0,0);const s=px(d);return r.getTime()>=l.getTime()?i+1:r.getTime()>=s.getTime()?i:i-1}function QP(e){const t=Ri(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function U_(e,...t){const r=no.bind(null,e||t.find(i=>typeof i=="object"));return t.map(r)}function s_(e,t){const r=Ri(e,t==null?void 0:t.in);return r.setHours(0,0,0,0),r}function ch(e,t,r){const[i,a]=U_(r==null?void 0:r.in,e,t),l=s_(i),d=s_(a),s=+l-QP(l),p=+d-QP(d);return Math.round((s-p)/pat)}function xat(e,t){const r=bde(e,t),i=no(e,0);return i.setFullYear(r,0,4),i.setHours(0,0,0,0),px(i)}function vL(e,t,r){return qo(e,t*7,r)}function yat(e,t,r){return Sd(e,t*12,r)}function vat(e,t){let r,i=t==null?void 0:t.in;return e.forEach(a=>{!i&&typeof a=="object"&&(i=no.bind(null,a));const l=Ri(a,i);(!r||r<l||isNaN(+l))&&(r=l)}),no(i,r||NaN)}function bat(e,t){let r,i=t==null?void 0:t.in;return e.forEach(a=>{!i&&typeof a=="object"&&(i=no.bind(null,a));const l=Ri(a,i);(!r||r>l||isNaN(+l))&&(r=l)}),no(i,r||NaN)}function Jl(e,t,r){const[i,a]=U_(r==null?void 0:r.in,e,t);return+s_(i)==+s_(a)}function b$(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function _at(e){return!(!b$(e)&&typeof e!="number"||isNaN(+Ri(e)))}function PN(e,t,r){const[i,a]=U_(r==null?void 0:r.in,e,t),l=i.getFullYear()-a.getFullYear(),d=i.getMonth()-a.getMonth();return l*12+d}function wat(e,t,r){const[i,a]=U_(r==null?void 0:r.in,e,t),l=jh(i,r),d=jh(a,r),s=+l-QP(l),p=+d-QP(d);return Math.round((s-p)/v$)}function _$(e,t){const r=Ri(e,t==null?void 0:t.in),i=r.getMonth();return r.setFullYear(r.getFullYear(),i+1,0),r.setHours(23,59,59,999),r}function ic(e,t){const r=Ri(e,t==null?void 0:t.in);return r.setDate(1),r.setHours(0,0,0,0),r}function _de(e,t){const r=Ri(e,t==null?void 0:t.in);return r.setFullYear(r.getFullYear(),0,1),r.setHours(0,0,0,0),r}function w$(e,t){var s,p,x,w;const r=_S(),i=(t==null?void 0:t.weekStartsOn)??((p=(s=t==null?void 0:t.locale)==null?void 0:s.options)==null?void 0:p.weekStartsOn)??r.weekStartsOn??((w=(x=r.locale)==null?void 0:x.options)==null?void 0:w.weekStartsOn)??0,a=Ri(e,t==null?void 0:t.in),l=a.getDay(),d=(l<i?-7:0)+6-(l-i);return a.setDate(a.getDate()+d),a.setHours(23,59,59,999),a}function wde(e,t){return w$(e,{...t,weekStartsOn:1})}const jat={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Nat=(e,t,r)=>{let i;const a=jat[e];return typeof a=="string"?i=a:t===1?i=a.one:i=a.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+i:i+" ago":i};function wR(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const Sat={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},Cat={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},Aat={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Tat={date:wR({formats:Sat,defaultWidth:"full"}),time:wR({formats:Cat,defaultWidth:"full"}),dateTime:wR({formats:Aat,defaultWidth:"full"})},kat={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},Pat=(e,t,r,i)=>kat[e];function cj(e){return(t,r)=>{const i=r!=null&&r.context?String(r.context):"standalone";let a;if(i==="formatting"&&e.formattingValues){const d=e.defaultFormattingWidth||e.defaultWidth,s=r!=null&&r.width?String(r.width):d;a=e.formattingValues[s]||e.formattingValues[d]}else{const d=e.defaultWidth,s=r!=null&&r.width?String(r.width):e.defaultWidth;a=e.values[s]||e.values[d]}const l=e.argumentCallback?e.argumentCallback(t):t;return a[l]}}const Eat={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},Mat={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},Iat={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Oat={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},Rat={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},Dat={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},zat=(e,t)=>{const r=Number(e),i=r%100;if(i>20||i<10)switch(i%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},Lat={ordinalNumber:zat,era:cj({values:Eat,defaultWidth:"wide"}),quarter:cj({values:Mat,defaultWidth:"wide",argumentCallback:e=>e-1}),month:cj({values:Iat,defaultWidth:"wide"}),day:cj({values:Oat,defaultWidth:"wide"}),dayPeriod:cj({values:Rat,defaultWidth:"wide",formattingValues:Dat,defaultFormattingWidth:"wide"})};function uj(e){return(t,r={})=>{const i=r.width,a=i&&e.matchPatterns[i]||e.matchPatterns[e.defaultMatchWidth],l=t.match(a);if(!l)return null;const d=l[0],s=i&&e.parsePatterns[i]||e.parsePatterns[e.defaultParseWidth],p=Array.isArray(s)?Bat(s,j=>j.test(d)):Fat(s,j=>j.test(d));let x;x=e.valueCallback?e.valueCallback(p):p,x=r.valueCallback?r.valueCallback(x):x;const w=t.slice(d.length);return{value:x,rest:w}}}function Fat(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function Bat(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function $at(e){return(t,r={})=>{const i=t.match(e.matchPattern);if(!i)return null;const a=i[0],l=t.match(e.parsePattern);if(!l)return null;let d=e.valueCallback?e.valueCallback(l[0]):l[0];d=r.valueCallback?r.valueCallback(d):d;const s=t.slice(a.length);return{value:d,rest:s}}}const Vat=/^(\d+)(th|st|nd|rd)?/i,Uat=/\d+/i,Gat={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},Hat={any:[/^b/i,/^(a|c)/i]},qat={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},Wat={any:[/1/i,/2/i,/3/i,/4/i]},Kat={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Zat={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Yat={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},Xat={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Jat={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Qat={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},eot={ordinalNumber:$at({matchPattern:Vat,parsePattern:Uat,valueCallback:e=>parseInt(e,10)}),era:uj({matchPatterns:Gat,defaultMatchWidth:"wide",parsePatterns:Hat,defaultParseWidth:"any"}),quarter:uj({matchPatterns:qat,defaultMatchWidth:"wide",parsePatterns:Wat,defaultParseWidth:"any",valueCallback:e=>e+1}),month:uj({matchPatterns:Kat,defaultMatchWidth:"wide",parsePatterns:Zat,defaultParseWidth:"any"}),day:uj({matchPatterns:Yat,defaultMatchWidth:"wide",parsePatterns:Xat,defaultParseWidth:"any"}),dayPeriod:uj({matchPatterns:Jat,defaultMatchWidth:"any",parsePatterns:Qat,defaultParseWidth:"any"})},jde={code:"en-US",formatDistance:Nat,formatLong:Tat,formatRelative:Pat,localize:Lat,match:eot,options:{weekStartsOn:0,firstWeekContainsDate:1}};function tot(e,t){const r=Ri(e,t==null?void 0:t.in);return ch(r,_de(r))+1}function Nde(e,t){const r=Ri(e,t==null?void 0:t.in),i=+px(r)-+xat(r);return Math.round(i/v$)+1}function Sde(e,t){var w,j,S,P;const r=Ri(e,t==null?void 0:t.in),i=r.getFullYear(),a=_S(),l=(t==null?void 0:t.firstWeekContainsDate)??((j=(w=t==null?void 0:t.locale)==null?void 0:w.options)==null?void 0:j.firstWeekContainsDate)??a.firstWeekContainsDate??((P=(S=a.locale)==null?void 0:S.options)==null?void 0:P.firstWeekContainsDate)??1,d=no((t==null?void 0:t.in)||e,0);d.setFullYear(i+1,0,l),d.setHours(0,0,0,0);const s=jh(d,t),p=no((t==null?void 0:t.in)||e,0);p.setFullYear(i,0,l),p.setHours(0,0,0,0);const x=jh(p,t);return+r>=+s?i+1:+r>=+x?i:i-1}function rot(e,t){var s,p,x,w;const r=_S(),i=(t==null?void 0:t.firstWeekContainsDate)??((p=(s=t==null?void 0:t.locale)==null?void 0:s.options)==null?void 0:p.firstWeekContainsDate)??r.firstWeekContainsDate??((w=(x=r.locale)==null?void 0:x.options)==null?void 0:w.firstWeekContainsDate)??1,a=Sde(e,t),l=no((t==null?void 0:t.in)||e,0);return l.setFullYear(a,0,i),l.setHours(0,0,0,0),jh(l,t)}function Cde(e,t){const r=Ri(e,t==null?void 0:t.in),i=+jh(r,t)-+rot(r,t);return Math.round(i/v$)+1}function as(e,t){const r=e<0?"-":"",i=Math.abs(e).toString().padStart(t,"0");return r+i}const Wf={y(e,t){const r=e.getFullYear(),i=r>0?r:1-r;return as(t==="yy"?i%100:i,t.length)},M(e,t){const r=e.getMonth();return t==="M"?String(r+1):as(r+1,2)},d(e,t){return as(e.getDate(),t.length)},a(e,t){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(e,t){return as(e.getHours()%12||12,t.length)},H(e,t){return as(e.getHours(),t.length)},m(e,t){return as(e.getMinutes(),t.length)},s(e,t){return as(e.getSeconds(),t.length)},S(e,t){const r=t.length,i=e.getMilliseconds(),a=Math.trunc(i*Math.pow(10,r-3));return as(a,t.length)}},tv={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},QZ={G:function(e,t,r){const i=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(i,{width:"abbreviated"});case"GGGGG":return r.era(i,{width:"narrow"});case"GGGG":default:return r.era(i,{width:"wide"})}},y:function(e,t,r){if(t==="yo"){const i=e.getFullYear(),a=i>0?i:1-i;return r.ordinalNumber(a,{unit:"year"})}return Wf.y(e,t)},Y:function(e,t,r,i){const a=Sde(e,i),l=a>0?a:1-a;if(t==="YY"){const d=l%100;return as(d,2)}return t==="Yo"?r.ordinalNumber(l,{unit:"year"}):as(l,t.length)},R:function(e,t){const r=bde(e);return as(r,t.length)},u:function(e,t){const r=e.getFullYear();return as(r,t.length)},Q:function(e,t,r){const i=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(i);case"QQ":return as(i,2);case"Qo":return r.ordinalNumber(i,{unit:"quarter"});case"QQQ":return r.quarter(i,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(i,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(i,{width:"wide",context:"formatting"})}},q:function(e,t,r){const i=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(i);case"qq":return as(i,2);case"qo":return r.ordinalNumber(i,{unit:"quarter"});case"qqq":return r.quarter(i,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(i,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(i,{width:"wide",context:"standalone"})}},M:function(e,t,r){const i=e.getMonth();switch(t){case"M":case"MM":return Wf.M(e,t);case"Mo":return r.ordinalNumber(i+1,{unit:"month"});case"MMM":return r.month(i,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(i,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(i,{width:"wide",context:"formatting"})}},L:function(e,t,r){const i=e.getMonth();switch(t){case"L":return String(i+1);case"LL":return as(i+1,2);case"Lo":return r.ordinalNumber(i+1,{unit:"month"});case"LLL":return r.month(i,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(i,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(i,{width:"wide",context:"standalone"})}},w:function(e,t,r,i){const a=Cde(e,i);return t==="wo"?r.ordinalNumber(a,{unit:"week"}):as(a,t.length)},I:function(e,t,r){const i=Nde(e);return t==="Io"?r.ordinalNumber(i,{unit:"week"}):as(i,t.length)},d:function(e,t,r){return t==="do"?r.ordinalNumber(e.getDate(),{unit:"date"}):Wf.d(e,t)},D:function(e,t,r){const i=tot(e);return t==="Do"?r.ordinalNumber(i,{unit:"dayOfYear"}):as(i,t.length)},E:function(e,t,r){const i=e.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(i,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(i,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(i,{width:"short",context:"formatting"});case"EEEE":default:return r.day(i,{width:"wide",context:"formatting"})}},e:function(e,t,r,i){const a=e.getDay(),l=(a-i.weekStartsOn+8)%7||7;switch(t){case"e":return String(l);case"ee":return as(l,2);case"eo":return r.ordinalNumber(l,{unit:"day"});case"eee":return r.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(a,{width:"short",context:"formatting"});case"eeee":default:return r.day(a,{width:"wide",context:"formatting"})}},c:function(e,t,r,i){const a=e.getDay(),l=(a-i.weekStartsOn+8)%7||7;switch(t){case"c":return String(l);case"cc":return as(l,t.length);case"co":return r.ordinalNumber(l,{unit:"day"});case"ccc":return r.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(a,{width:"narrow",context:"standalone"});case"cccccc":return r.day(a,{width:"short",context:"standalone"});case"cccc":default:return r.day(a,{width:"wide",context:"standalone"})}},i:function(e,t,r){const i=e.getDay(),a=i===0?7:i;switch(t){case"i":return String(a);case"ii":return as(a,t.length);case"io":return r.ordinalNumber(a,{unit:"day"});case"iii":return r.day(i,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(i,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(i,{width:"short",context:"formatting"});case"iiii":default:return r.day(i,{width:"wide",context:"formatting"})}},a:function(e,t,r){const a=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(e,t,r){const i=e.getHours();let a;switch(i===12?a=tv.noon:i===0?a=tv.midnight:a=i/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(e,t,r){const i=e.getHours();let a;switch(i>=17?a=tv.evening:i>=12?a=tv.afternoon:i>=4?a=tv.morning:a=tv.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(e,t,r){if(t==="ho"){let i=e.getHours()%12;return i===0&&(i=12),r.ordinalNumber(i,{unit:"hour"})}return Wf.h(e,t)},H:function(e,t,r){return t==="Ho"?r.ordinalNumber(e.getHours(),{unit:"hour"}):Wf.H(e,t)},K:function(e,t,r){const i=e.getHours()%12;return t==="Ko"?r.ordinalNumber(i,{unit:"hour"}):as(i,t.length)},k:function(e,t,r){let i=e.getHours();return i===0&&(i=24),t==="ko"?r.ordinalNumber(i,{unit:"hour"}):as(i,t.length)},m:function(e,t,r){return t==="mo"?r.ordinalNumber(e.getMinutes(),{unit:"minute"}):Wf.m(e,t)},s:function(e,t,r){return t==="so"?r.ordinalNumber(e.getSeconds(),{unit:"second"}):Wf.s(e,t)},S:function(e,t){return Wf.S(e,t)},X:function(e,t,r){const i=e.getTimezoneOffset();if(i===0)return"Z";switch(t){case"X":return tY(i);case"XXXX":case"XX":return j0(i);case"XXXXX":case"XXX":default:return j0(i,":")}},x:function(e,t,r){const i=e.getTimezoneOffset();switch(t){case"x":return tY(i);case"xxxx":case"xx":return j0(i);case"xxxxx":case"xxx":default:return j0(i,":")}},O:function(e,t,r){const i=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+eY(i,":");case"OOOO":default:return"GMT"+j0(i,":")}},z:function(e,t,r){const i=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+eY(i,":");case"zzzz":default:return"GMT"+j0(i,":")}},t:function(e,t,r){const i=Math.trunc(+e/1e3);return as(i,t.length)},T:function(e,t,r){return as(+e,t.length)}};function eY(e,t=""){const r=e>0?"-":"+",i=Math.abs(e),a=Math.trunc(i/60),l=i%60;return l===0?r+String(a):r+String(a)+t+as(l,2)}function tY(e,t){return e%60===0?(e>0?"-":"+")+as(Math.abs(e)/60,2):j0(e,t)}function j0(e,t=""){const r=e>0?"-":"+",i=Math.abs(e),a=as(Math.trunc(i/60),2),l=as(i%60,2);return r+a+t+l}const rY=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},Ade=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},not=(e,t)=>{const r=e.match(/(P+)(p+)?/)||[],i=r[1],a=r[2];if(!a)return rY(e,t);let l;switch(i){case"P":l=t.dateTime({width:"short"});break;case"PP":l=t.dateTime({width:"medium"});break;case"PPP":l=t.dateTime({width:"long"});break;case"PPPP":default:l=t.dateTime({width:"full"});break}return l.replace("{{date}}",rY(i,t)).replace("{{time}}",Ade(a,t))},iot={p:Ade,P:not},sot=/^D+$/,aot=/^Y+$/,oot=["D","DD","YY","YYYY"];function lot(e){return sot.test(e)}function cot(e){return aot.test(e)}function uot(e,t,r){const i=dot(e,t,r);if(console.warn(i),oot.includes(e))throw new RangeError(i)}function dot(e,t,r){const i=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${i} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const hot=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,mot=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,fot=/^'([^]*?)'?$/,pot=/''/g,got=/[a-zA-Z]/;function fa(e,t,r){var w,j,S,P,F,L,B,V;const i=_S(),a=(r==null?void 0:r.locale)??i.locale??jde,l=(r==null?void 0:r.firstWeekContainsDate)??((j=(w=r==null?void 0:r.locale)==null?void 0:w.options)==null?void 0:j.firstWeekContainsDate)??i.firstWeekContainsDate??((P=(S=i.locale)==null?void 0:S.options)==null?void 0:P.firstWeekContainsDate)??1,d=(r==null?void 0:r.weekStartsOn)??((L=(F=r==null?void 0:r.locale)==null?void 0:F.options)==null?void 0:L.weekStartsOn)??i.weekStartsOn??((V=(B=i.locale)==null?void 0:B.options)==null?void 0:V.weekStartsOn)??0,s=Ri(e,r==null?void 0:r.in);if(!_at(s))throw new RangeError("Invalid time value");let p=t.match(mot).map($=>{const G=$[0];if(G==="p"||G==="P"){const W=iot[G];return W($,a.formatLong)}return $}).join("").match(hot).map($=>{if($==="''")return{isToken:!1,value:"'"};const G=$[0];if(G==="'")return{isToken:!1,value:xot($)};if(QZ[G])return{isToken:!0,value:$};if(G.match(got))throw new RangeError("Format string contains an unescaped latin alphabet character `"+G+"`");return{isToken:!1,value:$}});a.localize.preprocessor&&(p=a.localize.preprocessor(s,p));const x={firstWeekContainsDate:l,weekStartsOn:d,locale:a};return p.map($=>{if(!$.isToken)return $.value;const G=$.value;(!(r!=null&&r.useAdditionalWeekYearTokens)&&cot(G)||!(r!=null&&r.useAdditionalDayOfYearTokens)&&lot(G))&&uot(G,t,String(e));const W=QZ[G[0]];return W(s,G,a.localize,x)}).join("")}function xot(e){const t=e.match(fot);return t?t[1].replace(pot,"'"):e}function yot(e,t){const r=Ri(e,t==null?void 0:t.in),i=r.getFullYear(),a=r.getMonth(),l=no(r,0);return l.setFullYear(i,a+1,0),l.setHours(0,0,0,0),l.getDate()}function vot(e){return Math.trunc(+Ri(e)/1e3)}function bot(e,t){const r=Ri(e,t==null?void 0:t.in),i=r.getMonth();return r.setFullYear(r.getFullYear(),i+1,0),r.setHours(0,0,0,0),Ri(r,t==null?void 0:t.in)}function _ot(e,t){const r=Ri(e,t==null?void 0:t.in);return wat(bot(r,t),ic(r,t),t)+1}function bL(e,t){return+Ri(e)>+Ri(t)}function Tde(e,t){return+Ri(e)<+Ri(t)}function j$(e,t,r){const[i,a]=U_(r==null?void 0:r.in,e,t);return i.getFullYear()===a.getFullYear()&&i.getMonth()===a.getMonth()}function wot(e,t,r){const[i,a]=U_(r==null?void 0:r.in,e,t);return i.getFullYear()===a.getFullYear()}function kde(e,t,r){const i=+Ri(e,r==null?void 0:r.in),[a,l]=[+Ri(t.start,r==null?void 0:r.in),+Ri(t.end,r==null?void 0:r.in)].sort((d,s)=>d-s);return i>=a&&i<=l}function jR(e,t,r){return qo(e,-t,r)}function Jf(e,t){const r=()=>no(t==null?void 0:t.in,NaN),a=Cot(e);let l;if(a.date){const x=Aot(a.date,2);l=Tot(x.restDateString,x.year)}if(!l||isNaN(+l))return r();const d=+l;let s=0,p;if(a.time&&(s=kot(a.time),isNaN(s)))return r();if(a.timezone){if(p=Pot(a.timezone),isNaN(p))return r()}else{const x=new Date(d+s),w=Ri(0,t==null?void 0:t.in);return w.setFullYear(x.getUTCFullYear(),x.getUTCMonth(),x.getUTCDate()),w.setHours(x.getUTCHours(),x.getUTCMinutes(),x.getUTCSeconds(),x.getUTCMilliseconds()),w}return Ri(d+s+p,t==null?void 0:t.in)}const cT={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},jot=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,Not=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,Sot=/^([+-])(\d{2})(?::?(\d{2}))?$/;function Cot(e){const t={},r=e.split(cT.dateTimeDelimiter);let i;if(r.length>2)return t;if(/:/.test(r[0])?i=r[0]:(t.date=r[0],i=r[1],cT.timeZoneDelimiter.test(t.date)&&(t.date=e.split(cT.timeZoneDelimiter)[0],i=e.substr(t.date.length,e.length))),i){const a=cT.timezone.exec(i);a?(t.time=i.replace(a[1],""),t.timezone=a[1]):t.time=i}return t}function Aot(e,t){const r=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),i=e.match(r);if(!i)return{year:NaN,restDateString:""};const a=i[1]?parseInt(i[1]):null,l=i[2]?parseInt(i[2]):null;return{year:l===null?a:l*100,restDateString:e.slice((i[1]||i[2]).length)}}function Tot(e,t){if(t===null)return new Date(NaN);const r=e.match(jot);if(!r)return new Date(NaN);const i=!!r[4],a=dj(r[1]),l=dj(r[2])-1,d=dj(r[3]),s=dj(r[4]),p=dj(r[5])-1;if(i)return Rot(t,s,p)?Eot(t,s,p):new Date(NaN);{const x=new Date(0);return!Iot(t,l,d)||!Oot(t,a)?new Date(NaN):(x.setUTCFullYear(t,l,Math.max(a,d)),x)}}function dj(e){return e?parseInt(e):1}function kot(e){const t=e.match(Not);if(!t)return NaN;const r=NR(t[1]),i=NR(t[2]),a=NR(t[3]);return Dot(r,i,a)?r*vde+i*yde+a*1e3:NaN}function NR(e){return e&&parseFloat(e.replace(",","."))||0}function Pot(e){if(e==="Z")return 0;const t=e.match(Sot);if(!t)return 0;const r=t[1]==="+"?-1:1,i=parseInt(t[2]),a=t[3]&&parseInt(t[3])||0;return zot(i,a)?r*(i*vde+a*yde):NaN}function Eot(e,t,r){const i=new Date(0);i.setUTCFullYear(e,0,4);const a=i.getUTCDay()||7,l=(t-1)*7+r+1-a;return i.setUTCDate(i.getUTCDate()+l),i}const Mot=[31,null,31,30,31,30,31,31,30,31,30,31];function Pde(e){return e%400===0||e%4===0&&e%100!==0}function Iot(e,t,r){return t>=0&&t<=11&&r>=1&&r<=(Mot[t]||(Pde(e)?29:28))}function Oot(e,t){return t>=1&&t<=(Pde(e)?366:365)}function Rot(e,t,r){return t>=1&&t<=53&&r>=0&&r<=6}function Dot(e,t,r){return e===24?t===0&&r===0:r>=0&&r<60&&t>=0&&t<60&&e>=0&&e<25}function zot(e,t){return t>=0&&t<=59}function SR(e,t,r){const i=Ri(e,r==null?void 0:r.in),a=i.getFullYear(),l=i.getDate(),d=no(e,0);d.setFullYear(a,t,15),d.setHours(0,0,0,0);const s=yot(d);return i.setMonth(t,Math.min(l,s)),i}function nY(e,t,r){const i=Ri(e,r==null?void 0:r.in);return isNaN(+i)?no(e,NaN):(i.setFullYear(t),i)}var Hn=function(){return Hn=Object.assign||function(t){for(var r,i=1,a=arguments.length;i<a;i++){r=arguments[i];for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&(t[l]=r[l])}return t},Hn.apply(this,arguments)};function Lot(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(e);a<i.length;a++)t.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(e,i[a])&&(r[i[a]]=e[i[a]]);return r}function Ede(e,t,r){for(var i=0,a=t.length,l;i<a;i++)(l||!(i in t))&&(l||(l=Array.prototype.slice.call(t,0,i)),l[i]=t[i]);return e.concat(l||Array.prototype.slice.call(t))}function wS(e){return e.mode==="multiple"}function jS(e){return e.mode==="range"}function j3(e){return e.mode==="single"}var Fot={root:"rdp",multiple_months:"rdp-multiple_months",with_weeknumber:"rdp-with_weeknumber",vhidden:"rdp-vhidden",button_reset:"rdp-button_reset",button:"rdp-button",caption:"rdp-caption",caption_start:"rdp-caption_start",caption_end:"rdp-caption_end",caption_between:"rdp-caption_between",caption_label:"rdp-caption_label",caption_dropdowns:"rdp-caption_dropdowns",dropdown:"rdp-dropdown",dropdown_month:"rdp-dropdown_month",dropdown_year:"rdp-dropdown_year",dropdown_icon:"rdp-dropdown_icon",months:"rdp-months",month:"rdp-month",table:"rdp-table",tbody:"rdp-tbody",tfoot:"rdp-tfoot",head:"rdp-head",head_row:"rdp-head_row",head_cell:"rdp-head_cell",nav:"rdp-nav",nav_button:"rdp-nav_button",nav_button_previous:"rdp-nav_button_previous",nav_button_next:"rdp-nav_button_next",nav_icon:"rdp-nav_icon",row:"rdp-row",weeknumber:"rdp-weeknumber",cell:"rdp-cell",day:"rdp-day",day_today:"rdp-day_today",day_outside:"rdp-day_outside",day_selected:"rdp-day_selected",day_disabled:"rdp-day_disabled",day_hidden:"rdp-day_hidden",day_range_start:"rdp-day_range_start",day_range_end:"rdp-day_range_end",day_range_middle:"rdp-day_range_middle"};function Bot(e,t){return fa(e,"LLLL y",t)}function $ot(e,t){return fa(e,"d",t)}function Vot(e,t){return fa(e,"LLLL",t)}function Uot(e){return"".concat(e)}function Got(e,t){return fa(e,"cccccc",t)}function Hot(e,t){return fa(e,"yyyy",t)}var qot=Object.freeze({__proto__:null,formatCaption:Bot,formatDay:$ot,formatMonthCaption:Vot,formatWeekNumber:Uot,formatWeekdayName:Got,formatYearCaption:Hot}),Wot=function(e,t,r){return fa(e,"do MMMM (EEEE)",r)},Kot=function(){return"Month: "},Zot=function(){return"Go to next month"},Yot=function(){return"Go to previous month"},Xot=function(e,t){return fa(e,"cccc",t)},Jot=function(e){return"Week n. ".concat(e)},Qot=function(){return"Year: "},elt=Object.freeze({__proto__:null,labelDay:Wot,labelMonthDropdown:Kot,labelNext:Zot,labelPrevious:Yot,labelWeekNumber:Jot,labelWeekday:Xot,labelYearDropdown:Qot});function tlt(){var e="buttons",t=Fot,r=jde,i={},a={},l=1,d={},s=new Date;return{captionLayout:e,classNames:t,formatters:qot,labels:elt,locale:r,modifiersClassNames:i,modifiers:a,numberOfMonths:l,styles:d,today:s,mode:"default"}}function rlt(e){var t=e.fromYear,r=e.toYear,i=e.fromMonth,a=e.toMonth,l=e.fromDate,d=e.toDate;return i?l=ic(i):t&&(l=new Date(t,0,1)),a?d=_$(a):r&&(d=new Date(r,11,31)),{fromDate:l?s_(l):void 0,toDate:d?s_(d):void 0}}var Mde=U.createContext(void 0);function nlt(e){var t,r=e.initialProps,i=tlt(),a=rlt(r),l=a.fromDate,d=a.toDate,s=(t=r.captionLayout)!==null&&t!==void 0?t:i.captionLayout;s!=="buttons"&&(!l||!d)&&(s="buttons");var p;(j3(r)||wS(r)||jS(r))&&(p=r.onSelect);var x=Hn(Hn(Hn({},i),r),{captionLayout:s,classNames:Hn(Hn({},i.classNames),r.classNames),components:Hn({},r.components),formatters:Hn(Hn({},i.formatters),r.formatters),fromDate:l,labels:Hn(Hn({},i.labels),r.labels),mode:r.mode||i.mode,modifiers:Hn(Hn({},i.modifiers),r.modifiers),modifiersClassNames:Hn(Hn({},i.modifiersClassNames),r.modifiersClassNames),onSelect:p,styles:Hn(Hn({},i.styles),r.styles),toDate:d});return n.jsx(Mde.Provider,{value:x,children:e.children})}function ks(){var e=U.useContext(Mde);if(!e)throw new Error("useDayPicker must be used within a DayPickerProvider.");return e}function Ide(e){var t=ks(),r=t.locale,i=t.classNames,a=t.styles,l=t.formatters.formatCaption;return n.jsx("div",{className:i.caption_label,style:a.caption_label,"aria-live":"polite",role:"presentation",id:e.id,children:l(e.displayMonth,{locale:r})})}function ilt(e){return n.jsx("svg",Hn({width:"8px",height:"8px",viewBox:"0 0 120 120","data-testid":"iconDropdown"},e,{children:n.jsx("path",{d:"M4.22182541,48.2218254 C8.44222828,44.0014225 15.2388494,43.9273804 19.5496459,47.9996989 L19.7781746,48.2218254 L60,88.443 L100.221825,48.2218254 C104.442228,44.0014225 111.238849,43.9273804 115.549646,47.9996989 L115.778175,48.2218254 C119.998577,52.4422283 120.07262,59.2388494 116.000301,63.5496459 L115.778175,63.7781746 L67.7781746,111.778175 C63.5577717,115.998577 56.7611506,116.07262 52.4503541,112.000301 L52.2218254,111.778175 L4.22182541,63.7781746 C-0.0739418023,59.4824074 -0.0739418023,52.5175926 4.22182541,48.2218254 Z",fill:"currentColor",fillRule:"nonzero"})}))}function Ode(e){var t,r,i=e.onChange,a=e.value,l=e.children,d=e.caption,s=e.className,p=e.style,x=ks(),w=(r=(t=x.components)===null||t===void 0?void 0:t.IconDropdown)!==null&&r!==void 0?r:ilt;return n.jsxs("div",{className:s,style:p,children:[n.jsx("span",{className:x.classNames.vhidden,children:e["aria-label"]}),n.jsx("select",{name:e.name,"aria-label":e["aria-label"],className:x.classNames.dropdown,style:x.styles.dropdown,value:a,onChange:i,children:l}),n.jsxs("div",{className:x.classNames.caption_label,style:x.styles.caption_label,"aria-hidden":"true",children:[d,n.jsx(w,{className:x.classNames.dropdown_icon,style:x.styles.dropdown_icon})]})]})}function slt(e){var t,r=ks(),i=r.fromDate,a=r.toDate,l=r.styles,d=r.locale,s=r.formatters.formatMonthCaption,p=r.classNames,x=r.components,w=r.labels.labelMonthDropdown;if(!i)return n.jsx(n.Fragment,{});if(!a)return n.jsx(n.Fragment,{});var j=[];if(wot(i,a))for(var S=ic(i),P=i.getMonth();P<=a.getMonth();P++)j.push(SR(S,P));else for(var S=ic(new Date),P=0;P<=11;P++)j.push(SR(S,P));var F=function(B){var V=Number(B.target.value),$=SR(ic(e.displayMonth),V);e.onChange($)},L=(t=x==null?void 0:x.Dropdown)!==null&&t!==void 0?t:Ode;return n.jsx(L,{name:"months","aria-label":w(),className:p.dropdown_month,style:l.dropdown_month,onChange:F,value:e.displayMonth.getMonth(),caption:s(e.displayMonth,{locale:d}),children:j.map(function(B){return n.jsx("option",{value:B.getMonth(),children:s(B,{locale:d})},B.getMonth())})})}function alt(e){var t,r=e.displayMonth,i=ks(),a=i.fromDate,l=i.toDate,d=i.locale,s=i.styles,p=i.classNames,x=i.components,w=i.formatters.formatYearCaption,j=i.labels.labelYearDropdown,S=[];if(!a)return n.jsx(n.Fragment,{});if(!l)return n.jsx(n.Fragment,{});for(var P=a.getFullYear(),F=l.getFullYear(),L=P;L<=F;L++)S.push(nY(_de(new Date),L));var B=function($){var G=nY(ic(r),Number($.target.value));e.onChange(G)},V=(t=x==null?void 0:x.Dropdown)!==null&&t!==void 0?t:Ode;return n.jsx(V,{name:"years","aria-label":j(),className:p.dropdown_year,style:s.dropdown_year,onChange:B,value:r.getFullYear(),caption:w(r,{locale:d}),children:S.map(function($){return n.jsx("option",{value:$.getFullYear(),children:w($,{locale:d})},$.getFullYear())})})}function olt(e,t){var r=U.useState(e),i=r[0],a=r[1],l=t===void 0?i:t;return[l,a]}function llt(e){var t=e.month,r=e.defaultMonth,i=e.today,a=t||r||i||new Date,l=e.toDate,d=e.fromDate,s=e.numberOfMonths,p=s===void 0?1:s;if(l&&PN(l,a)<0){var x=-1*(p-1);a=Sd(l,x)}return d&&PN(a,d)<0&&(a=d),ic(a)}function clt(){var e=ks(),t=llt(e),r=olt(t,e.month),i=r[0],a=r[1],l=function(d){var s;if(!e.disableNavigation){var p=ic(d);a(p),(s=e.onMonthChange)===null||s===void 0||s.call(e,p)}};return[i,l]}function ult(e,t){for(var r=t.reverseMonths,i=t.numberOfMonths,a=ic(e),l=ic(Sd(a,i)),d=PN(l,a),s=[],p=0;p<d;p++){var x=Sd(a,p);s.push(x)}return r&&(s=s.reverse()),s}function dlt(e,t){if(!t.disableNavigation){var r=t.toDate,i=t.pagedNavigation,a=t.numberOfMonths,l=a===void 0?1:a,d=i?l:1,s=ic(e);if(!r)return Sd(s,d);var p=PN(r,e);if(!(p<l))return Sd(s,d)}}function hlt(e,t){if(!t.disableNavigation){var r=t.fromDate,i=t.pagedNavigation,a=t.numberOfMonths,l=a===void 0?1:a,d=i?l:1,s=ic(e);if(!r)return Sd(s,-d);var p=PN(s,r);if(!(p<=0))return Sd(s,-d)}}var Rde=U.createContext(void 0);function mlt(e){var t=ks(),r=clt(),i=r[0],a=r[1],l=ult(i,t),d=dlt(i,t),s=hlt(i,t),p=function(j){return l.some(function(S){return j$(j,S)})},x=function(j,S){p(j)||(S&&Tde(j,S)?a(Sd(j,1+t.numberOfMonths*-1)):a(j))},w={currentMonth:i,displayMonths:l,goToMonth:a,goToDate:x,previousMonth:s,nextMonth:d,isDateDisplayed:p};return n.jsx(Rde.Provider,{value:w,children:e.children})}function NS(){var e=U.useContext(Rde);if(!e)throw new Error("useNavigation must be used within a NavigationProvider");return e}function iY(e){var t,r=ks(),i=r.classNames,a=r.styles,l=r.components,d=NS().goToMonth,s=function(w){d(Sd(w,e.displayIndex?-e.displayIndex:0))},p=(t=l==null?void 0:l.CaptionLabel)!==null&&t!==void 0?t:Ide,x=n.jsx(p,{id:e.id,displayMonth:e.displayMonth});return n.jsxs("div",{className:i.caption_dropdowns,style:a.caption_dropdowns,children:[n.jsx("div",{className:i.vhidden,children:x}),n.jsx(slt,{onChange:s,displayMonth:e.displayMonth}),n.jsx(alt,{onChange:s,displayMonth:e.displayMonth})]})}function flt(e){return n.jsx("svg",Hn({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:n.jsx("path",{d:"M69.490332,3.34314575 C72.6145263,0.218951416 77.6798462,0.218951416 80.8040405,3.34314575 C83.8617626,6.40086786 83.9268205,11.3179931 80.9992143,14.4548388 L80.8040405,14.6568542 L35.461,60 L80.8040405,105.343146 C83.8617626,108.400868 83.9268205,113.317993 80.9992143,116.454839 L80.8040405,116.656854 C77.7463184,119.714576 72.8291931,119.779634 69.6923475,116.852028 L69.490332,116.656854 L18.490332,65.6568542 C15.4326099,62.5991321 15.367552,57.6820069 18.2951583,54.5451612 L18.490332,54.3431458 L69.490332,3.34314575 Z",fill:"currentColor",fillRule:"nonzero"})}))}function plt(e){return n.jsx("svg",Hn({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:n.jsx("path",{d:"M49.8040405,3.34314575 C46.6798462,0.218951416 41.6145263,0.218951416 38.490332,3.34314575 C35.4326099,6.40086786 35.367552,11.3179931 38.2951583,14.4548388 L38.490332,14.6568542 L83.8333725,60 L38.490332,105.343146 C35.4326099,108.400868 35.367552,113.317993 38.2951583,116.454839 L38.490332,116.656854 C41.5480541,119.714576 46.4651794,119.779634 49.602025,116.852028 L49.8040405,116.656854 L100.804041,65.6568542 C103.861763,62.5991321 103.926821,57.6820069 100.999214,54.5451612 L100.804041,54.3431458 L49.8040405,3.34314575 Z",fill:"currentColor"})}))}var eE=U.forwardRef(function(e,t){var r=ks(),i=r.classNames,a=r.styles,l=[i.button_reset,i.button];e.className&&l.push(e.className);var d=l.join(" "),s=Hn(Hn({},a.button_reset),a.button);return e.style&&Object.assign(s,e.style),n.jsx("button",Hn({},e,{ref:t,type:"button",className:d,style:s}))});function glt(e){var t,r,i=ks(),a=i.dir,l=i.locale,d=i.classNames,s=i.styles,p=i.labels,x=p.labelPrevious,w=p.labelNext,j=i.components;if(!e.nextMonth&&!e.previousMonth)return n.jsx(n.Fragment,{});var S=x(e.previousMonth,{locale:l}),P=[d.nav_button,d.nav_button_previous].join(" "),F=w(e.nextMonth,{locale:l}),L=[d.nav_button,d.nav_button_next].join(" "),B=(t=j==null?void 0:j.IconRight)!==null&&t!==void 0?t:plt,V=(r=j==null?void 0:j.IconLeft)!==null&&r!==void 0?r:flt;return n.jsxs("div",{className:d.nav,style:s.nav,children:[!e.hidePrevious&&n.jsx(eE,{name:"previous-month","aria-label":S,className:P,style:s.nav_button_previous,disabled:!e.previousMonth,onClick:e.onPreviousClick,children:a==="rtl"?n.jsx(B,{className:d.nav_icon,style:s.nav_icon}):n.jsx(V,{className:d.nav_icon,style:s.nav_icon})}),!e.hideNext&&n.jsx(eE,{name:"next-month","aria-label":F,className:L,style:s.nav_button_next,disabled:!e.nextMonth,onClick:e.onNextClick,children:a==="rtl"?n.jsx(V,{className:d.nav_icon,style:s.nav_icon}):n.jsx(B,{className:d.nav_icon,style:s.nav_icon})})]})}function sY(e){var t=ks().numberOfMonths,r=NS(),i=r.previousMonth,a=r.nextMonth,l=r.goToMonth,d=r.displayMonths,s=d.findIndex(function(F){return j$(e.displayMonth,F)}),p=s===0,x=s===d.length-1,w=t>1&&(p||!x),j=t>1&&(x||!p),S=function(){i&&l(i)},P=function(){a&&l(a)};return n.jsx(glt,{displayMonth:e.displayMonth,hideNext:w,hidePrevious:j,nextMonth:a,previousMonth:i,onPreviousClick:S,onNextClick:P})}function xlt(e){var t,r=ks(),i=r.classNames,a=r.disableNavigation,l=r.styles,d=r.captionLayout,s=r.components,p=(t=s==null?void 0:s.CaptionLabel)!==null&&t!==void 0?t:Ide,x;return a?x=n.jsx(p,{id:e.id,displayMonth:e.displayMonth}):d==="dropdown"?x=n.jsx(iY,{displayMonth:e.displayMonth,id:e.id}):d==="dropdown-buttons"?x=n.jsxs(n.Fragment,{children:[n.jsx(iY,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id}),n.jsx(sY,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id})]}):x=n.jsxs(n.Fragment,{children:[n.jsx(p,{id:e.id,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),n.jsx(sY,{displayMonth:e.displayMonth,id:e.id})]}),n.jsx("div",{className:i.caption,style:l.caption,children:x})}function ylt(e){var t=ks(),r=t.footer,i=t.styles,a=t.classNames.tfoot;return r?n.jsx("tfoot",{className:a,style:i.tfoot,children:n.jsx("tr",{children:n.jsx("td",{colSpan:8,children:r})})}):n.jsx(n.Fragment,{})}function vlt(e,t,r){for(var i=r?px(new Date):jh(new Date,{locale:e,weekStartsOn:t}),a=[],l=0;l<7;l++){var d=qo(i,l);a.push(d)}return a}function blt(){var e=ks(),t=e.classNames,r=e.styles,i=e.showWeekNumber,a=e.locale,l=e.weekStartsOn,d=e.ISOWeek,s=e.formatters.formatWeekdayName,p=e.labels.labelWeekday,x=vlt(a,l,d);return n.jsxs("tr",{style:r.head_row,className:t.head_row,children:[i&&n.jsx("td",{style:r.head_cell,className:t.head_cell}),x.map(function(w,j){return n.jsx("th",{scope:"col",className:t.head_cell,style:r.head_cell,"aria-label":p(w,{locale:a}),children:s(w,{locale:a})},j)})]})}function _lt(){var e,t=ks(),r=t.classNames,i=t.styles,a=t.components,l=(e=a==null?void 0:a.HeadRow)!==null&&e!==void 0?e:blt;return n.jsx("thead",{style:i.head,className:r.head,children:n.jsx(l,{})})}function wlt(e){var t=ks(),r=t.locale,i=t.formatters.formatDay;return n.jsx(n.Fragment,{children:i(e.date,{locale:r})})}var N$=U.createContext(void 0);function jlt(e){if(!wS(e.initialProps)){var t={selected:void 0,modifiers:{disabled:[]}};return n.jsx(N$.Provider,{value:t,children:e.children})}return n.jsx(Nlt,{initialProps:e.initialProps,children:e.children})}function Nlt(e){var t=e.initialProps,r=e.children,i=t.selected,a=t.min,l=t.max,d=function(x,w,j){var S,P;(S=t.onDayClick)===null||S===void 0||S.call(t,x,w,j);var F=!!(w.selected&&a&&(i==null?void 0:i.length)===a);if(!F){var L=!!(!w.selected&&l&&(i==null?void 0:i.length)===l);if(!L){var B=i?Ede([],i):[];if(w.selected){var V=B.findIndex(function($){return Jl(x,$)});B.splice(V,1)}else B.push(x);(P=t.onSelect)===null||P===void 0||P.call(t,B,x,w,j)}}},s={disabled:[]};i&&s.disabled.push(function(x){var w=l&&i.length>l-1,j=i.some(function(S){return Jl(S,x)});return!!(w&&!j)});var p={selected:i,onDayClick:d,modifiers:s};return n.jsx(N$.Provider,{value:p,children:r})}function S$(){var e=U.useContext(N$);if(!e)throw new Error("useSelectMultiple must be used within a SelectMultipleProvider");return e}function Slt(e,t){var r=t||{},i=r.from,a=r.to;return i&&a?Jl(a,e)&&Jl(i,e)?void 0:Jl(a,e)?{from:a,to:void 0}:Jl(i,e)?void 0:bL(i,e)?{from:e,to:a}:{from:i,to:e}:a?bL(e,a)?{from:a,to:e}:{from:e,to:a}:i?Tde(e,i)?{from:e,to:i}:{from:i,to:e}:{from:e,to:void 0}}var C$=U.createContext(void 0);function Clt(e){if(!jS(e.initialProps)){var t={selected:void 0,modifiers:{range_start:[],range_end:[],range_middle:[],disabled:[]}};return n.jsx(C$.Provider,{value:t,children:e.children})}return n.jsx(Alt,{initialProps:e.initialProps,children:e.children})}function Alt(e){var t=e.initialProps,r=e.children,i=t.selected,a=i||{},l=a.from,d=a.to,s=t.min,p=t.max,x=function(P,F,L){var B,V;(B=t.onDayClick)===null||B===void 0||B.call(t,P,F,L);var $=Slt(P,i);(V=t.onSelect)===null||V===void 0||V.call(t,$,P,F,L)},w={range_start:[],range_end:[],range_middle:[],disabled:[]};if(l?(w.range_start=[l],d?(w.range_end=[d],Jl(l,d)||(w.range_middle=[{after:l,before:d}])):w.range_end=[l]):d&&(w.range_start=[d],w.range_end=[d]),s&&(l&&!d&&w.disabled.push({after:jR(l,s-1),before:qo(l,s-1)}),l&&d&&w.disabled.push({after:l,before:qo(l,s-1)}),!l&&d&&w.disabled.push({after:jR(d,s-1),before:qo(d,s-1)})),p){if(l&&!d&&(w.disabled.push({before:qo(l,-p+1)}),w.disabled.push({after:qo(l,p-1)})),l&&d){var j=ch(d,l)+1,S=p-j;w.disabled.push({before:jR(l,S)}),w.disabled.push({after:qo(d,S)})}!l&&d&&(w.disabled.push({before:qo(d,-p+1)}),w.disabled.push({after:qo(d,p-1)}))}return n.jsx(C$.Provider,{value:{selected:i,onDayClick:x,modifiers:w},children:r})}function A$(){var e=U.useContext(C$);if(!e)throw new Error("useSelectRange must be used within a SelectRangeProvider");return e}function LT(e){return Array.isArray(e)?Ede([],e):e!==void 0?[e]:[]}function Tlt(e){var t={};return Object.entries(e).forEach(function(r){var i=r[0],a=r[1];t[i]=LT(a)}),t}var Cd;(function(e){e.Outside="outside",e.Disabled="disabled",e.Selected="selected",e.Hidden="hidden",e.Today="today",e.RangeStart="range_start",e.RangeEnd="range_end",e.RangeMiddle="range_middle"})(Cd||(Cd={}));var klt=Cd.Selected,nm=Cd.Disabled,Plt=Cd.Hidden,Elt=Cd.Today,CR=Cd.RangeEnd,AR=Cd.RangeMiddle,TR=Cd.RangeStart,Mlt=Cd.Outside;function Ilt(e,t,r){var i,a=(i={},i[klt]=LT(e.selected),i[nm]=LT(e.disabled),i[Plt]=LT(e.hidden),i[Elt]=[e.today],i[CR]=[],i[AR]=[],i[TR]=[],i[Mlt]=[],i);return e.fromDate&&a[nm].push({before:e.fromDate}),e.toDate&&a[nm].push({after:e.toDate}),wS(e)?a[nm]=a[nm].concat(t.modifiers[nm]):jS(e)&&(a[nm]=a[nm].concat(r.modifiers[nm]),a[TR]=r.modifiers[TR],a[AR]=r.modifiers[AR],a[CR]=r.modifiers[CR]),a}var Dde=U.createContext(void 0);function Olt(e){var t=ks(),r=S$(),i=A$(),a=Ilt(t,r,i),l=Tlt(t.modifiers),d=Hn(Hn({},a),l);return n.jsx(Dde.Provider,{value:d,children:e.children})}function zde(){var e=U.useContext(Dde);if(!e)throw new Error("useModifiers must be used within a ModifiersProvider");return e}function Rlt(e){return!!(e&&typeof e=="object"&&"before"in e&&"after"in e)}function Dlt(e){return!!(e&&typeof e=="object"&&"from"in e)}function zlt(e){return!!(e&&typeof e=="object"&&"after"in e)}function Llt(e){return!!(e&&typeof e=="object"&&"before"in e)}function Flt(e){return!!(e&&typeof e=="object"&&"dayOfWeek"in e)}function Blt(e,t){var r,i=t.from,a=t.to;if(i&&a){var l=ch(a,i)<0;l&&(r=[a,i],i=r[0],a=r[1]);var d=ch(e,i)>=0&&ch(a,e)>=0;return d}return a?Jl(a,e):i?Jl(i,e):!1}function $lt(e){return b$(e)}function Vlt(e){return Array.isArray(e)&&e.every(b$)}function Ult(e,t){return t.some(function(r){if(typeof r=="boolean")return r;if($lt(r))return Jl(e,r);if(Vlt(r))return r.includes(e);if(Dlt(r))return Blt(e,r);if(Flt(r))return r.dayOfWeek.includes(e.getDay());if(Rlt(r)){var i=ch(r.before,e),a=ch(r.after,e),l=i>0,d=a<0,s=bL(r.before,r.after);return s?d&&l:l||d}return zlt(r)?ch(e,r.after)>0:Llt(r)?ch(r.before,e)>0:typeof r=="function"?r(e):!1})}function T$(e,t,r){var i=Object.keys(t).reduce(function(l,d){var s=t[d];return Ult(e,s)&&l.push(d),l},[]),a={};return i.forEach(function(l){return a[l]=!0}),r&&!j$(e,r)&&(a.outside=!0),a}function Glt(e,t){for(var r=ic(e[0]),i=_$(e[e.length-1]),a,l,d=r;d<=i;){var s=T$(d,t),p=!s.disabled&&!s.hidden;if(!p){d=qo(d,1);continue}if(s.selected)return d;s.today&&!l&&(l=d),a||(a=d),d=qo(d,1)}return l||a}var Hlt=365;function Lde(e,t){var r=t.moveBy,i=t.direction,a=t.context,l=t.modifiers,d=t.retry,s=d===void 0?{count:0,lastFocused:e}:d,p=a.weekStartsOn,x=a.fromDate,w=a.toDate,j=a.locale,S={day:qo,week:vL,month:Sd,year:yat,startOfWeek:function(B){return a.ISOWeek?px(B):jh(B,{locale:j,weekStartsOn:p})},endOfWeek:function(B){return a.ISOWeek?wde(B):w$(B,{locale:j,weekStartsOn:p})}},P=S[r](e,i==="after"?1:-1);i==="before"&&x?P=vat([x,P]):i==="after"&&w&&(P=bat([w,P]));var F=!0;if(l){var L=T$(P,l);F=!L.disabled&&!L.hidden}return F?P:s.count>Hlt?s.lastFocused:Lde(P,{moveBy:r,direction:i,context:a,modifiers:l,retry:Hn(Hn({},s),{count:s.count+1})})}var Fde=U.createContext(void 0);function qlt(e){var t=NS(),r=zde(),i=U.useState(),a=i[0],l=i[1],d=U.useState(),s=d[0],p=d[1],x=Glt(t.displayMonths,r),w=a??(s&&t.isDateDisplayed(s))?s:x,j=function(){p(a),l(void 0)},S=function(B){l(B)},P=ks(),F=function(B,V){if(a){var $=Lde(a,{moveBy:B,direction:V,context:P,modifiers:r});Jl(a,$)||(t.goToDate($,a),S($))}},L={focusedDay:a,focusTarget:w,blur:j,focus:S,focusDayAfter:function(){return F("day","after")},focusDayBefore:function(){return F("day","before")},focusWeekAfter:function(){return F("week","after")},focusWeekBefore:function(){return F("week","before")},focusMonthBefore:function(){return F("month","before")},focusMonthAfter:function(){return F("month","after")},focusYearBefore:function(){return F("year","before")},focusYearAfter:function(){return F("year","after")},focusStartOfWeek:function(){return F("startOfWeek","before")},focusEndOfWeek:function(){return F("endOfWeek","after")}};return n.jsx(Fde.Provider,{value:L,children:e.children})}function k$(){var e=U.useContext(Fde);if(!e)throw new Error("useFocusContext must be used within a FocusProvider");return e}function Wlt(e,t){var r=zde(),i=T$(e,r,t);return i}var P$=U.createContext(void 0);function Klt(e){if(!j3(e.initialProps)){var t={selected:void 0};return n.jsx(P$.Provider,{value:t,children:e.children})}return n.jsx(Zlt,{initialProps:e.initialProps,children:e.children})}function Zlt(e){var t=e.initialProps,r=e.children,i=function(l,d,s){var p,x,w;if((p=t.onDayClick)===null||p===void 0||p.call(t,l,d,s),d.selected&&!t.required){(x=t.onSelect)===null||x===void 0||x.call(t,void 0,l,d,s);return}(w=t.onSelect)===null||w===void 0||w.call(t,l,l,d,s)},a={selected:t.selected,onDayClick:i};return n.jsx(P$.Provider,{value:a,children:r})}function Bde(){var e=U.useContext(P$);if(!e)throw new Error("useSelectSingle must be used within a SelectSingleProvider");return e}function Ylt(e,t){var r=ks(),i=Bde(),a=S$(),l=A$(),d=k$(),s=d.focusDayAfter,p=d.focusDayBefore,x=d.focusWeekAfter,w=d.focusWeekBefore,j=d.blur,S=d.focus,P=d.focusMonthBefore,F=d.focusMonthAfter,L=d.focusYearBefore,B=d.focusYearAfter,V=d.focusStartOfWeek,$=d.focusEndOfWeek,G=function(Ee){var je,Ce,tt,it;j3(r)?(je=i.onDayClick)===null||je===void 0||je.call(i,e,t,Ee):wS(r)?(Ce=a.onDayClick)===null||Ce===void 0||Ce.call(a,e,t,Ee):jS(r)?(tt=l.onDayClick)===null||tt===void 0||tt.call(l,e,t,Ee):(it=r.onDayClick)===null||it===void 0||it.call(r,e,t,Ee)},W=function(Ee){var je;S(e),(je=r.onDayFocus)===null||je===void 0||je.call(r,e,t,Ee)},Z=function(Ee){var je;j(),(je=r.onDayBlur)===null||je===void 0||je.call(r,e,t,Ee)},se=function(Ee){var je;(je=r.onDayMouseEnter)===null||je===void 0||je.call(r,e,t,Ee)},ae=function(Ee){var je;(je=r.onDayMouseLeave)===null||je===void 0||je.call(r,e,t,Ee)},ce=function(Ee){var je;(je=r.onDayPointerEnter)===null||je===void 0||je.call(r,e,t,Ee)},Pe=function(Ee){var je;(je=r.onDayPointerLeave)===null||je===void 0||je.call(r,e,t,Ee)},we=function(Ee){var je;(je=r.onDayTouchCancel)===null||je===void 0||je.call(r,e,t,Ee)},xe=function(Ee){var je;(je=r.onDayTouchEnd)===null||je===void 0||je.call(r,e,t,Ee)},Ne=function(Ee){var je;(je=r.onDayTouchMove)===null||je===void 0||je.call(r,e,t,Ee)},ze=function(Ee){var je;(je=r.onDayTouchStart)===null||je===void 0||je.call(r,e,t,Ee)},ye=function(Ee){var je;(je=r.onDayKeyUp)===null||je===void 0||je.call(r,e,t,Ee)},ve=function(Ee){var je;switch(Ee.key){case"ArrowLeft":Ee.preventDefault(),Ee.stopPropagation(),r.dir==="rtl"?s():p();break;case"ArrowRight":Ee.preventDefault(),Ee.stopPropagation(),r.dir==="rtl"?p():s();break;case"ArrowDown":Ee.preventDefault(),Ee.stopPropagation(),x();break;case"ArrowUp":Ee.preventDefault(),Ee.stopPropagation(),w();break;case"PageUp":Ee.preventDefault(),Ee.stopPropagation(),Ee.shiftKey?L():P();break;case"PageDown":Ee.preventDefault(),Ee.stopPropagation(),Ee.shiftKey?B():F();break;case"Home":Ee.preventDefault(),Ee.stopPropagation(),V();break;case"End":Ee.preventDefault(),Ee.stopPropagation(),$();break}(je=r.onDayKeyDown)===null||je===void 0||je.call(r,e,t,Ee)},_e={onClick:G,onFocus:W,onBlur:Z,onKeyDown:ve,onKeyUp:ye,onMouseEnter:se,onMouseLeave:ae,onPointerEnter:ce,onPointerLeave:Pe,onTouchCancel:we,onTouchEnd:xe,onTouchMove:Ne,onTouchStart:ze};return _e}function Xlt(){var e=ks(),t=Bde(),r=S$(),i=A$(),a=j3(e)?t.selected:wS(e)?r.selected:jS(e)?i.selected:void 0;return a}function Jlt(e){return Object.values(Cd).includes(e)}function Qlt(e,t){var r=[e.classNames.day];return Object.keys(t).forEach(function(i){var a=e.modifiersClassNames[i];if(a)r.push(a);else if(Jlt(i)){var l=e.classNames["day_".concat(i)];l&&r.push(l)}}),r}function ect(e,t){var r=Hn({},e.styles.day);return Object.keys(t).forEach(function(i){var a;r=Hn(Hn({},r),(a=e.modifiersStyles)===null||a===void 0?void 0:a[i])}),r}function tct(e,t,r){var i,a,l,d=ks(),s=k$(),p=Wlt(e,t),x=Ylt(e,p),w=Xlt(),j=!!(d.onDayClick||d.mode!=="default");U.useEffect(function(){var se;p.outside||s.focusedDay&&j&&Jl(s.focusedDay,e)&&((se=r.current)===null||se===void 0||se.focus())},[s.focusedDay,e,r,j,p.outside]);var S=Qlt(d,p).join(" "),P=ect(d,p),F=!!(p.outside&&!d.showOutsideDays||p.hidden),L=(l=(a=d.components)===null||a===void 0?void 0:a.DayContent)!==null&&l!==void 0?l:wlt,B=n.jsx(L,{date:e,displayMonth:t,activeModifiers:p}),V={style:P,className:S,children:B,role:"gridcell"},$=s.focusTarget&&Jl(s.focusTarget,e)&&!p.outside,G=s.focusedDay&&Jl(s.focusedDay,e),W=Hn(Hn(Hn({},V),(i={disabled:p.disabled,role:"gridcell"},i["aria-selected"]=p.selected,i.tabIndex=G||$?0:-1,i)),x),Z={isButton:j,isHidden:F,activeModifiers:p,selectedDays:w,buttonProps:W,divProps:V};return Z}function rct(e){var t=U.useRef(null),r=tct(e.date,e.displayMonth,t);return r.isHidden?n.jsx("div",{role:"gridcell"}):r.isButton?n.jsx(eE,Hn({name:"day",ref:t},r.buttonProps)):n.jsx("div",Hn({},r.divProps))}function nct(e){var t=e.number,r=e.dates,i=ks(),a=i.onWeekNumberClick,l=i.styles,d=i.classNames,s=i.locale,p=i.labels.labelWeekNumber,x=i.formatters.formatWeekNumber,w=x(Number(t),{locale:s});if(!a)return n.jsx("span",{className:d.weeknumber,style:l.weeknumber,children:w});var j=p(Number(t),{locale:s}),S=function(P){a(t,r,P)};return n.jsx(eE,{name:"week-number","aria-label":j,className:d.weeknumber,style:l.weeknumber,onClick:S,children:w})}function ict(e){var t,r,i=ks(),a=i.styles,l=i.classNames,d=i.showWeekNumber,s=i.components,p=(t=s==null?void 0:s.Day)!==null&&t!==void 0?t:rct,x=(r=s==null?void 0:s.WeekNumber)!==null&&r!==void 0?r:nct,w;return d&&(w=n.jsx("td",{className:l.cell,style:a.cell,children:n.jsx(x,{number:e.weekNumber,dates:e.dates})})),n.jsxs("tr",{className:l.row,style:a.row,children:[w,e.dates.map(function(j){return n.jsx("td",{className:l.cell,style:a.cell,role:"presentation",children:n.jsx(p,{displayMonth:e.displayMonth,date:j})},vot(j))})]})}function aY(e,t,r){for(var i=r!=null&&r.ISOWeek?wde(t):w$(t,r),a=r!=null&&r.ISOWeek?px(e):jh(e,r),l=ch(i,a),d=[],s=0;s<=l;s++)d.push(qo(a,s));var p=d.reduce(function(x,w){var j=r!=null&&r.ISOWeek?Nde(w):Cde(w,r),S=x.find(function(P){return P.weekNumber===j});return S?(S.dates.push(w),x):(x.push({weekNumber:j,dates:[w]}),x)},[]);return p}function sct(e,t){var r=aY(ic(e),_$(e),t);if(t!=null&&t.useFixedWeeks){var i=_ot(e,t);if(i<6){var a=r[r.length-1],l=a.dates[a.dates.length-1],d=vL(l,6-i),s=aY(vL(l,1),d,t);r.push.apply(r,s)}}return r}function act(e){var t,r,i,a=ks(),l=a.locale,d=a.classNames,s=a.styles,p=a.hideHead,x=a.fixedWeeks,w=a.components,j=a.weekStartsOn,S=a.firstWeekContainsDate,P=a.ISOWeek,F=sct(e.displayMonth,{useFixedWeeks:!!x,ISOWeek:P,locale:l,weekStartsOn:j,firstWeekContainsDate:S}),L=(t=w==null?void 0:w.Head)!==null&&t!==void 0?t:_lt,B=(r=w==null?void 0:w.Row)!==null&&r!==void 0?r:ict,V=(i=w==null?void 0:w.Footer)!==null&&i!==void 0?i:ylt;return n.jsxs("table",{id:e.id,className:d.table,style:s.table,role:"grid","aria-labelledby":e["aria-labelledby"],children:[!p&&n.jsx(L,{}),n.jsx("tbody",{className:d.tbody,style:s.tbody,children:F.map(function($){return n.jsx(B,{displayMonth:e.displayMonth,dates:$.dates,weekNumber:$.weekNumber},$.weekNumber)})}),n.jsx(V,{displayMonth:e.displayMonth})]})}function oct(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var lct=oct()?U.useLayoutEffect:U.useEffect,kR=!1,cct=0;function oY(){return"react-day-picker-".concat(++cct)}function uct(e){var t,r=e??(kR?oY():null),i=U.useState(r),a=i[0],l=i[1];return lct(function(){a===null&&l(oY())},[]),U.useEffect(function(){kR===!1&&(kR=!0)},[]),(t=e??a)!==null&&t!==void 0?t:void 0}function dct(e){var t,r,i=ks(),a=i.dir,l=i.classNames,d=i.styles,s=i.components,p=NS().displayMonths,x=uct(i.id?"".concat(i.id,"-").concat(e.displayIndex):void 0),w=i.id?"".concat(i.id,"-grid-").concat(e.displayIndex):void 0,j=[l.month],S=d.month,P=e.displayIndex===0,F=e.displayIndex===p.length-1,L=!P&&!F;a==="rtl"&&(t=[P,F],F=t[0],P=t[1]),P&&(j.push(l.caption_start),S=Hn(Hn({},S),d.caption_start)),F&&(j.push(l.caption_end),S=Hn(Hn({},S),d.caption_end)),L&&(j.push(l.caption_between),S=Hn(Hn({},S),d.caption_between));var B=(r=s==null?void 0:s.Caption)!==null&&r!==void 0?r:xlt;return n.jsxs("div",{className:j.join(" "),style:S,children:[n.jsx(B,{id:x,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),n.jsx(act,{id:w,"aria-labelledby":x,displayMonth:e.displayMonth})]},e.displayIndex)}function hct(e){var t=ks(),r=t.classNames,i=t.styles;return n.jsx("div",{className:r.months,style:i.months,children:e.children})}function mct(e){var t,r,i=e.initialProps,a=ks(),l=k$(),d=NS(),s=U.useState(!1),p=s[0],x=s[1];U.useEffect(function(){a.initialFocus&&l.focusTarget&&(p||(l.focus(l.focusTarget),x(!0)))},[a.initialFocus,p,l.focus,l.focusTarget,l]);var w=[a.classNames.root,a.className];a.numberOfMonths>1&&w.push(a.classNames.multiple_months),a.showWeekNumber&&w.push(a.classNames.with_weeknumber);var j=Hn(Hn({},a.styles.root),a.style),S=Object.keys(i).filter(function(F){return F.startsWith("data-")}).reduce(function(F,L){var B;return Hn(Hn({},F),(B={},B[L]=i[L],B))},{}),P=(r=(t=i.components)===null||t===void 0?void 0:t.Months)!==null&&r!==void 0?r:hct;return n.jsx("div",Hn({className:w.join(" "),style:j,dir:a.dir,id:a.id,nonce:i.nonce,title:i.title,lang:i.lang},S,{children:n.jsx(P,{children:d.displayMonths.map(function(F,L){return n.jsx(dct,{displayIndex:L,displayMonth:F},L)})})}))}function fct(e){var t=e.children,r=Lot(e,["children"]);return n.jsx(nlt,{initialProps:r,children:n.jsx(mlt,{children:n.jsx(Klt,{initialProps:r,children:n.jsx(jlt,{initialProps:r,children:n.jsx(Clt,{initialProps:r,children:n.jsx(Olt,{children:n.jsx(qlt,{children:t})})})})})})})}function pct(e){return n.jsx(fct,Hn({},e,{children:n.jsx(mct,{initialProps:e})}))}function tE({className:e,classNames:t,showOutsideDays:r=!0,...i}){return n.jsx(pct,{showOutsideDays:r,className:Yt("p-3",e),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:Yt(w2({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:Yt(w2({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...t},components:{IconLeft:({...a})=>n.jsx(EF,{className:"h-4 w-4"}),IconRight:({...a})=>n.jsx(ng,{className:"h-4 w-4"})},...i})}tE.displayName="Calendar";const gct=os.object({name:os.string().min(3,{message:"Campaign name must be at least 3 characters"}),type:os.string(),target:os.string(),targetSize:os.number().positive(),startDate:os.date(),endDate:os.date(),status:os.string().default("Draft")}),xct=({open:e,setOpen:t,editCampaign:r,onSave:i})=>{const a=!!r,l=hx({resolver:xL(gct),defaultValues:{name:(r==null?void 0:r.name)||"",type:(r==null?void 0:r.type)||"Upsell",target:(r==null?void 0:r.target)||"Medium Value",targetSize:(r==null?void 0:r.targetSize)||1e5,startDate:r!=null&&r.startDate?new Date(r.startDate):new Date,endDate:r!=null&&r.endDate?new Date(r.endDate):new Date(Date.now()+30*24*60*60*1e3),status:(r==null?void 0:r.status)||"Draft"}}),d=s=>{const p={...s,id:(r==null?void 0:r.id)||`C${Math.floor(1e3+Math.random()*9e3)}`,startDate:fa(s.startDate,"yyyy-MM-dd"),endDate:fa(s.endDate,"yyyy-MM-dd"),conversion:(r==null?void 0:r.conversion)||0,roi:(r==null?void 0:r.roi)||0,revenue:(r==null?void 0:r.revenue)||0,cost:(r==null?void 0:r.cost)||0};i(p),t(!1),za({title:a?"Campaign Updated":"Campaign Created",description:`${s.name} has been ${a?"updated":"created"} successfully.`})};return n.jsx(Ml,{open:e,onOpenChange:t,children:n.jsxs(Qo,{className:"sm:max-w-[600px] bg-beam-dark text-white border-gray-700",children:[n.jsxs(el,{children:[n.jsx(tl,{className:"text-xl text-white",children:a?"Edit Campaign":"Create New Campaign"}),n.jsx(fg,{className:"text-gray-400",children:a?"Update the campaign details below.":"Fill out the form below to create a new marketing campaign."})]}),n.jsx(t_,{...l,children:n.jsxs("form",{onSubmit:l.handleSubmit(d),className:"space-y-4",children:[n.jsx(Li,{control:l.control,name:"name",render:({field:s})=>n.jsxs(Ei,{children:[n.jsx(Mi,{className:"text-white",children:"Campaign Name"}),n.jsx(Fi,{children:n.jsx(An,{className:"bg-beam-dark-accent/50 border-gray-700 text-white",...s})}),n.jsx(Xf,{})]})}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsx(Li,{control:l.control,name:"type",render:({field:s})=>n.jsxs(Ei,{children:[n.jsx(Mi,{className:"text-white",children:"Campaign Type"}),n.jsxs(_n,{onValueChange:s.onChange,defaultValue:s.value,children:[n.jsx(Fi,{children:n.jsx(xn,{className:"bg-beam-dark-accent/50 border-gray-700 text-white",children:n.jsx(wn,{placeholder:"Select type"})})}),n.jsxs(yn,{className:"bg-beam-dark border-gray-700",children:[n.jsx(yt,{value:"Upsell",children:"Upsell"}),n.jsx(yt,{value:"Cross-sell",children:"Cross-sell"}),n.jsx(yt,{value:"Retention",children:"Retention"}),n.jsx(yt,{value:"Acquisition",children:"Acquisition"})]})]}),n.jsx(Xf,{})]})}),n.jsx(Li,{control:l.control,name:"target",render:({field:s})=>n.jsxs(Ei,{children:[n.jsx(Mi,{className:"text-white",children:"Target Segment"}),n.jsxs(_n,{onValueChange:s.onChange,defaultValue:s.value,children:[n.jsx(Fi,{children:n.jsx(xn,{className:"bg-beam-dark-accent/50 border-gray-700 text-white",children:n.jsx(wn,{placeholder:"Select target"})})}),n.jsxs(yn,{className:"bg-beam-dark border-gray-700",children:[n.jsx(yt,{value:"High Value",children:"High Value"}),n.jsx(yt,{value:"Medium Value",children:"Medium Value"}),n.jsx(yt,{value:"Low Value",children:"Low Value"}),n.jsx(yt,{value:"New Customers",children:"New Customers"}),n.jsx(yt,{value:"At Risk",children:"At Risk"}),n.jsx(yt,{value:"All Segments",children:"All Segments"})]})]}),n.jsx(Xf,{})]})})]}),n.jsx(Li,{control:l.control,name:"targetSize",render:({field:s})=>n.jsxs(Ei,{children:[n.jsx(Mi,{className:"text-white",children:"Target Size"}),n.jsx(Fi,{children:n.jsx(An,{className:"bg-beam-dark-accent/50 border-gray-700 text-white",type:"number",...s,onChange:p=>s.onChange(parseInt(p.target.value))})}),n.jsx(Xf,{})]})}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsx(Li,{control:l.control,name:"startDate",render:({field:s})=>n.jsxs(Ei,{className:"flex flex-col",children:[n.jsx(Mi,{className:"text-white",children:"Start Date"}),n.jsxs(rL,{children:[n.jsx(nL,{asChild:!0,children:n.jsx(Fi,{children:n.jsxs(lt,{variant:"outline",className:Yt("bg-beam-dark-accent/50 border-gray-700 text-white pl-3 text-left font-normal",!s.value&&"text-muted-foreground"),children:[s.value?fa(s.value,"PPP"):n.jsx("span",{children:"Pick a date"}),n.jsx(xh,{className:"ml-auto h-4 w-4 opacity-50"})]})})}),n.jsx(zP,{className:"w-auto p-0 bg-beam-dark border-gray-700",align:"start",children:n.jsx(tE,{mode:"single",selected:s.value,onSelect:s.onChange,initialFocus:!0,className:"p-3 pointer-events-auto"})})]}),n.jsx(Xf,{})]})}),n.jsx(Li,{control:l.control,name:"endDate",render:({field:s})=>n.jsxs(Ei,{className:"flex flex-col",children:[n.jsx(Mi,{className:"text-white",children:"End Date"}),n.jsxs(rL,{children:[n.jsx(nL,{asChild:!0,children:n.jsx(Fi,{children:n.jsxs(lt,{variant:"outline",className:Yt("bg-beam-dark-accent/50 border-gray-700 text-white pl-3 text-left font-normal",!s.value&&"text-muted-foreground"),children:[s.value?fa(s.value,"PPP"):n.jsx("span",{children:"Pick a date"}),n.jsx(xh,{className:"ml-auto h-4 w-4 opacity-50"})]})})}),n.jsx(zP,{className:"w-auto p-0 bg-beam-dark border-gray-700",align:"start",children:n.jsx(tE,{mode:"single",selected:s.value,onSelect:s.onChange,initialFocus:!0,className:"p-3 pointer-events-auto"})})]}),n.jsx(Xf,{})]})})]}),a&&n.jsx(Li,{control:l.control,name:"status",render:({field:s})=>n.jsxs(Ei,{children:[n.jsx(Mi,{className:"text-white",children:"Status"}),n.jsxs(_n,{onValueChange:s.onChange,defaultValue:s.value,children:[n.jsx(Fi,{children:n.jsx(xn,{className:"bg-beam-dark-accent/50 border-gray-700 text-white",children:n.jsx(wn,{placeholder:"Select status"})})}),n.jsxs(yn,{className:"bg-beam-dark border-gray-700",children:[n.jsx(yt,{value:"Draft",children:"Draft"}),n.jsx(yt,{value:"Active",children:"Active"}),n.jsx(yt,{value:"Paused",children:"Paused"}),n.jsx(yt,{value:"Completed",children:"Completed"}),n.jsx(yt,{value:"Archived",children:"Archived"})]})]}),n.jsx(Xf,{})]})}),n.jsxs(mg,{className:"pt-4",children:[n.jsx(lt,{type:"button",variant:"outline",onClick:()=>t(!1),children:"Cancel"}),n.jsx(lt,{className:"bg-beam-blue hover:bg-blue-600",type:"submit",children:a?"Update Campaign":"Create Campaign"})]})]})})]})})},yct=({campaigns:e,onSelectCampaign:t})=>{const[r,i]=U.useState(new Date),[a,l]=U.useState("calendar"),d=e.filter(w=>w.status!=="Archived"&&w.status!=="Completed"),s=w=>(fa(w,"yyyy-MM-dd"),d.filter(j=>{try{const S=Jf(j.startDate),P=Jf(j.endDate);return kde(w,{start:S,end:P})}catch{return!1}})),p={};d.forEach(w=>{try{const j=Jf(w.startDate),S=fa(j,"MMMM yyyy");p[S]||(p[S]=[]),p[S].push(w)}catch{}});const x=Object.keys(p).sort((w,j)=>{const S=new Date(w),P=new Date(j);return S.getTime()-P.getTime()});return n.jsxs(jt,{className:"border-gray-800/30 bg-beam-dark-accent/50 backdrop-blur-md shadow-lg",children:[n.jsx(wr,{className:"pb-2",children:n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx(fr,{className:"text-lg text-white",children:"Campaign Calendar"}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs(lt,{variant:a==="calendar"?"default":"outline",size:"sm",className:a==="calendar"?"bg-beam-blue":"border-gray-700 text-gray-300",onClick:()=>l("calendar"),children:[n.jsx(xh,{size:16,className:"mr-1"}),"Calendar"]}),n.jsxs(lt,{variant:a==="list"?"default":"outline",size:"sm",className:a==="list"?"bg-beam-blue":"border-gray-700 text-gray-300",onClick:()=>l("list"),children:[n.jsx(xh,{size:16,className:"mr-1"}),"List"]})]})]})}),n.jsx(Ht,{children:a==="calendar"?n.jsxs("div",{className:"rounded-md border border-gray-700/50 p-3 bg-beam-dark/70",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx(lt,{variant:"outline",size:"sm",className:"border-gray-700 text-gray-300 hover:bg-gray-800",onClick:()=>{const w=new Date(r);w.setMonth(w.getMonth()-1),i(w)},children:n.jsx(EF,{size:16})}),n.jsx("h3",{className:"text-white font-medium",children:fa(r,"MMMM yyyy")}),n.jsx(lt,{variant:"outline",size:"sm",className:"border-gray-700 text-gray-300 hover:bg-gray-800",onClick:()=>{const w=new Date(r);w.setMonth(w.getMonth()+1),i(w)},children:n.jsx(ng,{size:16})})]}),n.jsx(tE,{mode:"single",selected:r,onSelect:w=>w&&i(w),className:"pointer-events-auto",modifiers:{hasCampaign:w=>s(w).length>0},modifiersStyles:{hasCampaign:{backgroundColor:"rgba(59, 130, 246, 0.2)",borderRadius:"0"}},components:{DayContent:w=>{const j=s(w.date);return n.jsxs("div",{className:"relative h-10 w-10 p-0 flex items-center justify-center",children:[n.jsx("span",{children:fa(w.date,"d")}),j.length>0&&n.jsxs("div",{className:"absolute bottom-1 left-1/2 transform -translate-x-1/2 flex gap-1",children:[j.slice(0,3).map((S,P)=>n.jsx("div",{className:"h-1.5 w-1.5 rounded-full bg-beam-blue"},P)),j.length>3&&n.jsx("div",{className:"h-1.5 w-1.5 rounded-full bg-gray-500"})]})]})}}}),n.jsxs("div",{className:"mt-4 space-y-2",children:[n.jsxs("h4",{className:"text-white font-medium",children:["Campaigns on ",fa(r,"MMMM d, yyyy")]}),n.jsx("div",{className:"space-y-2",children:s(r).length>0?s(r).map(w=>n.jsxs("div",{className:"p-2 border border-gray-700/50 rounded bg-gray-800/30 cursor-pointer hover:bg-gray-800/50",onClick:()=>t(w),children:[n.jsxs("div",{className:"flex justify-between items-start",children:[n.jsx("h5",{className:"text-white",children:w.name}),n.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${w.status==="Active"?"bg-green-900/50 text-green-400":w.status==="Paused"?"bg-yellow-900/50 text-yellow-400":"bg-gray-800 text-gray-400"}`,children:w.status})]}),n.jsxs("p",{className:"text-sm text-gray-400",children:[fa(Jf(w.startDate),"MMM d")," - ",fa(Jf(w.endDate),"MMM d, yyyy")]})]},w.id)):n.jsx("p",{className:"text-gray-500 text-center py-3",children:"No campaigns scheduled for this day"})})]})]}):n.jsx("div",{className:"space-y-6 max-h-[500px] overflow-y-auto pr-2",children:x.length>0?x.map(w=>n.jsxs("div",{children:[n.jsx("h3",{className:"text-white font-medium mb-3 sticky top-0 bg-beam-dark-accent/90 py-2 z-10",children:w}),n.jsx("div",{className:"space-y-2",children:p[w].map(j=>n.jsxs("div",{className:"p-3 border border-gray-700/50 rounded bg-gray-800/30 cursor-pointer hover:bg-gray-800/50",onClick:()=>t(j),children:[n.jsxs("div",{className:"flex justify-between items-start",children:[n.jsx("h5",{className:"text-white font-medium",children:j.name}),n.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${j.status==="Active"?"bg-green-900/50 text-green-400":j.status==="Paused"?"bg-yellow-900/50 text-yellow-400":"bg-gray-800 text-gray-400"}`,children:j.status})]}),n.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[n.jsx("span",{className:"text-xs bg-gray-800 text-gray-300 px-2 py-1 rounded",children:j.type}),n.jsx("span",{className:"text-xs bg-gray-800 text-gray-300 px-2 py-1 rounded",children:j.target})]}),n.jsxs("p",{className:"text-sm text-gray-400 mt-2",children:[fa(Jf(j.startDate),"MMM d")," - ",fa(Jf(j.endDate),"MMM d, yyyy")]})]},j.id))})]},w)):n.jsx("p",{className:"text-gray-500 text-center py-10",children:"No active campaigns scheduled"})})})]})},vct=({campaigns:e,selectedCampaigns:t,onSelectCampaigns:r})=>{const i=e.filter(l=>t.includes(l.id)).map(l=>({name:l.name,conversion:l.conversion,roi:l.roi,cost:l.cost/1e6,revenue:l.revenue/1e6})),a=l=>{t.includes(l)?r(t.filter(d=>d!==l)):t.length<3&&r([...t,l])};return n.jsxs(jt,{className:"border-gray-800/30 bg-beam-dark-accent/50 backdrop-blur-md shadow-lg",children:[n.jsx(wr,{className:"pb-2",children:n.jsxs(fr,{className:"text-lg text-white flex justify-between items-center",children:[n.jsx("span",{children:"Campaign Comparison"}),n.jsxs("div",{className:"flex gap-2 items-center",children:[n.jsx("span",{className:"text-sm text-gray-400",children:"Add campaign:"}),n.jsxs(_n,{onValueChange:a,value:"",children:[n.jsx(xn,{className:"w-[180px] bg-beam-dark/70 border-gray-700 h-8",children:n.jsx(wn,{placeholder:"Select campaign"})}),n.jsx(yn,{className:"bg-beam-dark border-gray-700",children:e.map(l=>n.jsx(yt,{value:l.id,disabled:t.includes(l.id),children:l.name},l.id))})]})]})]})}),n.jsx(Ht,{children:t.length===0?n.jsx("div",{className:"text-center text-gray-500 py-8",children:"Select campaigns to compare their performance"}):n.jsxs("div",{className:"space-y-6",children:[n.jsx("div",{className:"flex flex-wrap gap-3",children:t.map(l=>{const d=e.find(s=>s.id===l);return d?n.jsxs("div",{className:"px-3 py-1 bg-gray-800/50 rounded-md text-sm flex items-center gap-2",children:[n.jsx("span",{children:d.name}),n.jsx("button",{className:"text-gray-400 hover:text-white",onClick:()=>a(l),children:"×"})]},l):null})}),n.jsx("div",{className:"h-64",children:n.jsx(ms,{width:"100%",height:"100%",children:n.jsxs(nc,{data:i,margin:{top:5,right:30,left:20,bottom:5},children:[n.jsx($s,{strokeDasharray:"3 3",stroke:"#333"}),n.jsx(is,{dataKey:"name",tick:{fill:"#aaa"}}),n.jsx(Gi,{tick:{fill:"#aaa"}}),n.jsx(yi,{contentStyle:{backgroundColor:"#222",border:"1px solid #444"},itemStyle:{color:"#fff"},formatter:(l,d)=>d==="revenue"||d==="cost"?[`$${l.toFixed(2)}M`,d]:d==="conversion"?[`${l}%`,d]:d==="roi"?[`${l}x`,d]:[l,d]}),n.jsx(xa,{wrapperStyle:{color:"#fff"}}),n.jsx(pi,{dataKey:"conversion",name:"Conversion %",fill:"#3b82f6"}),n.jsx(pi,{dataKey:"roi",name:"ROI",fill:"#10b981"}),n.jsx(pi,{dataKey:"revenue",name:"Revenue ($M)",fill:"#8b5cf6"}),n.jsx(pi,{dataKey:"cost",name:"Cost ($M)",fill:"#ef4444"})]})})})]})})]})},bct=[{id:"tpl1",name:"End of Month Retention",description:"Targeted retention offer for high-value customers approaching contract renewal",type:"Retention",target:"High Value"},{id:"tpl2",name:"Cross-sell Bundle",description:"Cross-sell additional services to existing customers based on usage patterns",type:"Cross-sell",target:"Medium Value"},{id:"tpl3",name:"Service Upgrade",description:"Upgrade offer for customers eligible for service/plan improvements",type:"Upsell",target:"All Segments"},{id:"tpl4",name:"Win-back Campaign",description:"Special offers to re-engage customers who have recently churned",type:"Acquisition",target:"At Risk"}],_ct=({onSelectTemplate:e})=>{const t=r=>{e(r),za({title:"Template Selected",description:`The "${r.name}" template has been loaded. You can now customize it.`})};return n.jsxs(jt,{className:"border-gray-800/30 bg-beam-dark-accent/50 backdrop-blur-md shadow-lg",children:[n.jsx(wr,{className:"pb-2",children:n.jsx(fr,{className:"text-lg text-white",children:"Campaign Templates"})}),n.jsx(Ht,{children:n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:bct.map(r=>n.jsxs("div",{className:"border border-gray-700/50 rounded-lg p-4 bg-beam-dark/70",children:[n.jsxs("div",{className:"flex items-start justify-between mb-2",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Nh,{size:18,className:"text-blue-400"}),n.jsx("h3",{className:"font-medium text-white",children:r.name})]}),n.jsx("span",{className:"px-2 py-1 text-xs rounded-full bg-gray-800 text-gray-300",children:r.type})]}),n.jsx("p",{className:"text-sm text-gray-400 mb-3",children:r.description}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("span",{className:"text-xs text-gray-500",children:["Target: ",r.target]}),n.jsxs(lt,{variant:"outline",size:"sm",className:"text-blue-400 border-blue-600/30 hover:bg-blue-950/20",onClick:()=>t(r),children:[n.jsx(Mo,{size:14,className:"mr-1"}),"Use Template"]})]})]},r.id))})})]})},wct=({selectedCampaign:e})=>{const[t,r]=U.useState(null),i=[{id:"test1",name:"Offer Message Variation",description:"Testing different messaging approaches for the main offer",status:"Running",startDate:"2023-05-10",endDate:"2023-06-10",variants:[{id:"var1",name:"Price-focused",description:"Emphasize cost savings and value",metrics:{impressions:25e3,clicks:1250,conversions:175,conversionRate:7,revenue:87500}},{id:"var2",name:"Benefits-focused",description:"Emphasize product benefits and features",metrics:{impressions:25e3,clicks:1375,conversions:165,conversionRate:6.6,revenue:82500}}]},{id:"test2",name:"Call-to-Action Test",description:"Testing different CTA button texts and colors",status:"Completed",startDate:"2023-04-15",endDate:"2023-05-15",variants:[{id:"var1",name:"Direct CTA",description:'"Get Started" with blue button',metrics:{impressions:3e4,clicks:1800,conversions:216,conversionRate:7.2,revenue:108e3}},{id:"var2",name:"FOMO CTA",description:`"Don't Miss Out" with orange button`,metrics:{impressions:3e4,clicks:1650,conversions:165,conversionRate:5.5,revenue:82500}}]}],a=()=>{za({title:"A/B Test Created",description:"New A/B test has been created for this campaign."})},l=p=>{r(p)},d=p=>p.variants.map(x=>({name:x.name,clickRate:x.metrics.clicks/x.metrics.impressions*100,conversionRate:x.metrics.conversionRate,revenuePerImpression:x.metrics.revenue/x.metrics.impressions})),s=p=>p.status!=="Completed"?null:p.variants.reduce((x,w)=>w.metrics.conversionRate>x.metrics.conversionRate?w:x,p.variants[0]);return n.jsxs(jt,{className:"border-gray-800/30 bg-beam-dark-accent/50 backdrop-blur-md shadow-lg",children:[n.jsx(wr,{className:"pb-2",children:n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsxs(fr,{className:"text-lg text-white flex items-center gap-2",children:[n.jsx(VQ,{size:18}),"A/B Testing"]}),n.jsx(lt,{className:"bg-beam-blue hover:bg-blue-600 text-white",size:"sm",onClick:a,children:"Create A/B Test"})]})}),n.jsx(Ht,{children:t?n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"text-white font-medium",children:t.name}),n.jsx("p",{className:"text-gray-400 text-sm",children:t.description})]}),n.jsx(lt,{variant:"outline",size:"sm",className:"border-gray-700 text-gray-300 h-8",onClick:()=>r(null),children:"Back to all tests"})]}),n.jsxs("div",{className:"grid grid-cols-3 gap-3 mt-4",children:[n.jsxs("div",{className:"bg-gray-800/30 border border-gray-700/50 rounded p-3",children:[n.jsx("h4",{className:"text-gray-400 text-sm",children:"Status"}),n.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[n.jsx("span",{className:`h-2 w-2 rounded-full ${t.status==="Running"?"bg-green-400":t.status==="Completed"?"bg-blue-400":"bg-gray-400"}`}),n.jsx("span",{className:"text-white",children:t.status})]})]}),n.jsxs("div",{className:"bg-gray-800/30 border border-gray-700/50 rounded p-3",children:[n.jsx("h4",{className:"text-gray-400 text-sm",children:"Timeline"}),n.jsxs("div",{className:"text-white mt-1",children:[t.startDate," ",n.jsx(cb,{size:12,className:"inline mx-1"})," ",t.endDate]})]}),n.jsxs("div",{className:"bg-gray-800/30 border border-gray-700/50 rounded p-3",children:[n.jsx("h4",{className:"text-gray-400 text-sm",children:"Variants"}),n.jsxs("div",{className:"text-white mt-1",children:[t.variants.length," variants"]})]})]}),n.jsx("div",{className:"h-64 mt-6",children:n.jsx(ms,{width:"100%",height:"100%",children:n.jsxs(nc,{data:d(t),margin:{top:5,right:30,left:20,bottom:5},children:[n.jsx($s,{strokeDasharray:"3 3",stroke:"#333"}),n.jsx(is,{dataKey:"name",tick:{fill:"#aaa"}}),n.jsx(Gi,{tick:{fill:"#aaa"}}),n.jsx(yi,{contentStyle:{backgroundColor:"#222",border:"1px solid #444"},itemStyle:{color:"#fff"},formatter:p=>[`${p.toFixed(2)}`,""]}),n.jsx(xa,{wrapperStyle:{color:"#fff"}}),n.jsx(pi,{dataKey:"clickRate",name:"Click Rate %",fill:"#3b82f6"}),n.jsx(pi,{dataKey:"conversionRate",name:"Conversion Rate %",fill:"#10b981"}),n.jsx(pi,{dataKey:"revenuePerImpression",name:"Revenue per Impression ($)",fill:"#8b5cf6"})]})})}),n.jsx("div",{className:"grid grid-cols-2 gap-4 mt-4",children:t.variants.map(p=>{var w;const x=((w=s(t))==null?void 0:w.id)===p.id;return n.jsxs("div",{className:`border rounded-lg p-4 ${x?"border-green-600/50 bg-green-900/10":"border-gray-700/50 bg-gray-800/30"}`,children:[n.jsxs("div",{className:"flex justify-between items-start",children:[n.jsxs("h4",{className:"text-white font-medium flex items-center gap-2",children:[p.name,x&&n.jsxs("span",{className:"flex items-center text-green-400 text-xs gap-1",children:[n.jsx(db,{size:12}),"Winner"]})]}),n.jsxs("span",{className:"text-xs bg-gray-800 text-gray-300 px-2 py-0.5 rounded",children:["Variant ",t.variants.findIndex(j=>j.id===p.id)+1]})]}),n.jsx("p",{className:"text-gray-400 text-sm mt-1",children:p.description}),n.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-4",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-gray-400 text-xs",children:"Impressions"}),n.jsx("div",{className:"text-white",children:p.metrics.impressions.toLocaleString()})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-gray-400 text-xs",children:"Clicks"}),n.jsx("div",{className:"text-white",children:p.metrics.clicks.toLocaleString()})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-gray-400 text-xs",children:"Conversions"}),n.jsx("div",{className:"text-white",children:p.metrics.conversions.toLocaleString()})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-gray-400 text-xs",children:"Conversion Rate"}),n.jsxs("div",{className:"text-white",children:[p.metrics.conversionRate,"%"]})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx("div",{className:"text-gray-400 text-xs",children:"Revenue"}),n.jsxs("div",{className:"text-white",children:["$",p.metrics.revenue.toLocaleString()]})]})]})]},p.id)})})]}):n.jsx("div",{children:n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:i.map(p=>{var x;return n.jsxs("div",{className:"border border-gray-700/50 rounded-lg p-4 bg-gray-800/30 cursor-pointer hover:bg-gray-800/50",onClick:()=>l(p),children:[n.jsxs("div",{className:"flex justify-between items-start",children:[n.jsx("h3",{className:"text-white font-medium",children:p.name}),n.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${p.status==="Running"?"bg-green-900/50 text-green-400":p.status==="Completed"?"bg-blue-900/50 text-blue-400":"bg-gray-700 text-gray-300"}`,children:p.status})]}),n.jsx("p",{className:"text-gray-400 text-sm mt-1",children:p.description}),n.jsxs("div",{className:"flex justify-between mt-3 text-sm",children:[n.jsxs("div",{className:"text-gray-400",children:[p.startDate," - ",p.endDate]}),n.jsxs("div",{className:"text-white",children:[p.variants.length," variants"]})]}),p.status==="Completed"&&n.jsx("div",{className:"mt-3 pt-3 border-t border-gray-700/50",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-sm text-gray-400",children:"Winner:"}),n.jsxs("span",{className:"text-sm text-green-400 flex items-center gap-1",children:[n.jsx(db,{size:14}),(x=s(p))==null?void 0:x.name]})]})})]},p.id)})})})})]})},jct=({campaigns:e,onSelectCampaign:t})=>{const i=(()=>{const s=new Date,p=[];return e.forEach(x=>{try{const w=Jf(x.endDate),j=qo(s,7);kde(w,{start:s,end:j})&&x.status==="Active"&&p.push({id:`end-${x.id}`,type:"warning",title:"Campaign Ending Soon",description:`${x.name} is scheduled to end on ${fa(w,"MMMM d, yyyy")}`,date:s,campaign:x,read:!1}),x.conversion>7&&x.status==="Active"&&p.push({id:`perf-${x.id}`,type:"success",title:"High Performing Campaign",description:`${x.name} is performing above target with ${x.conversion}% conversion rate`,date:s,campaign:x,read:!1}),x.conversion<3&&x.status==="Active"&&p.push({id:`underperf-${x.id}`,type:"warning",title:"Campaign Below Target",description:`${x.name} is performing below target with only ${x.conversion}% conversion rate`,date:s,campaign:x,read:!0})}catch{}}),p.push({id:"update-1",type:"info",title:"Audience Size Updated",description:"Target audience sizes for all campaigns have been refreshed with the latest data",date:s,read:!0}),p.push({id:"system-1",type:"info",title:"New Campaign Templates Available",description:"3 new campaign templates have been added to the template library",date:new Date(s.getTime()-864e5),read:!0}),p.sort((x,w)=>x.read!==w.read?x.read?1:-1:w.date.getTime()-x.date.getTime())})(),a=i.filter(s=>!s.read).length,l=s=>{s.campaign&&t(s.campaign)},d=()=>{za({title:"Notifications Cleared",description:"All notifications have been marked as read"})};return n.jsxs(jt,{className:"border-gray-800/30 bg-beam-dark-accent/50 backdrop-blur-md shadow-lg",children:[n.jsx(wr,{className:"pb-2",children:n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsxs(fr,{className:"text-lg text-white flex items-center gap-2",children:[n.jsx(Wye,{size:18}),"Campaign Notifications",a>0&&n.jsx("span",{className:"bg-beam-blue text-white text-xs rounded-full h-5 min-w-5 inline-flex items-center justify-center px-1.5",children:a})]}),n.jsx(lt,{variant:"outline",size:"sm",className:"border-gray-700 text-gray-300 hover:bg-gray-800 text-xs",onClick:d,children:"Mark all as read"})]})}),n.jsx(Ht,{children:n.jsx("div",{className:"space-y-3 max-h-[400px] overflow-y-auto pr-1",children:i.map(s=>n.jsx("div",{className:`p-3 border rounded cursor-pointer transition-colors ${s.read?"border-gray-700/40 bg-gray-800/20 hover:bg-gray-800/40":"border-gray-700 bg-gray-800/40 hover:bg-gray-800/60"}`,onClick:()=>l(s),children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsxs("div",{className:"mt-0.5",children:[s.type==="success"&&n.jsx(db,{size:18,className:"text-green-400"}),s.type==="warning"&&n.jsx(fs,{size:18,className:"text-amber-400"}),s.type==="info"&&(s.title.includes("Template")?n.jsx(xh,{size:18,className:"text-blue-400"}):n.jsx(qi,{size:18,className:"text-blue-400"}))]}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex justify-between items-start",children:[n.jsx("h4",{className:`font-medium ${s.read?"text-gray-300":"text-white"}`,children:s.title}),n.jsx("span",{className:"text-xs text-gray-500",children:fa(s.date,"MMM d")})]}),n.jsx("p",{className:"text-sm text-gray-400 mt-1",children:s.description}),s.campaign&&n.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[n.jsx("span",{className:`text-xs px-2 py-0.5 rounded text-white ${s.campaign.type==="Upsell"?"bg-blue-900/70":s.campaign.type==="Cross-sell"?"bg-green-900/70":s.campaign.type==="Retention"?"bg-purple-900/70":"bg-gray-700"}`,children:s.campaign.type}),s.type==="success"&&n.jsxs("span",{className:"text-xs bg-green-900/50 text-green-300 px-2 py-0.5 rounded flex items-center gap-1",children:[n.jsx(En,{size:12}),s.campaign.conversion,"% Conv."]}),s.type==="warning"&&s.title.includes("Below")&&n.jsxs("span",{className:"text-xs bg-red-900/50 text-red-300 px-2 py-0.5 rounded flex items-center gap-1",children:[n.jsx(En,{size:12,className:"rotate-180"}),s.campaign.conversion,"% Conv."]})]})]})]})},s.id))})})]})},Nct=()=>n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-4 mb-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"text-sm text-gray-400 mb-1 block",children:"Campaign Type"}),n.jsxs(_n,{defaultValue:"all",children:[n.jsx(xn,{className:"bg-beam-dark/70 border-gray-700",children:n.jsx(wn,{placeholder:"All Types"})}),n.jsxs(yn,{className:"bg-beam-dark border-gray-700",children:[n.jsx(yt,{value:"all",children:"All Types"}),n.jsx(yt,{value:"acquisition",children:"Acquisition"}),n.jsx(yt,{value:"retention",children:"Retention"}),n.jsx(yt,{value:"upsell",children:"Upsell"}),n.jsx(yt,{value:"cross-sell",children:"Cross-sell"})]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm text-gray-400 mb-1 block",children:"Target Segment"}),n.jsxs(_n,{defaultValue:"all",children:[n.jsx(xn,{className:"bg-beam-dark/70 border-gray-700",children:n.jsx(wn,{placeholder:"All Segments"})}),n.jsxs(yn,{className:"bg-beam-dark border-gray-700",children:[n.jsx(yt,{value:"all",children:"All Segments"}),n.jsx(yt,{value:"high",children:"High Value"}),n.jsx(yt,{value:"medium",children:"Medium Value"}),n.jsx(yt,{value:"low",children:"Low Value"}),n.jsx(yt,{value:"new",children:"New Customers"}),n.jsx(yt,{value:"risk",children:"At Risk"})]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm text-gray-400 mb-1 block",children:"Status"}),n.jsxs(_n,{defaultValue:"active",children:[n.jsx(xn,{className:"bg-beam-dark/70 border-gray-700",children:n.jsx(wn,{placeholder:"Active Campaigns"})}),n.jsxs(yn,{className:"bg-beam-dark border-gray-700",children:[n.jsx(yt,{value:"all",children:"All Statuses"}),n.jsx(yt,{value:"active",children:"Active"}),n.jsx(yt,{value:"scheduled",children:"Scheduled"}),n.jsx(yt,{value:"completed",children:"Completed"}),n.jsx(yt,{value:"draft",children:"Draft"})]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm text-gray-400 mb-1 block",children:"Date Range"}),n.jsxs(_n,{defaultValue:"current",children:[n.jsx(xn,{className:"bg-beam-dark/70 border-gray-700",children:n.jsx(wn,{placeholder:"Current Quarter"})}),n.jsxs(yn,{className:"bg-beam-dark border-gray-700",children:[n.jsx(yt,{value:"current",children:"Current Quarter"}),n.jsx(yt,{value:"previous",children:"Previous Quarter"}),n.jsx(yt,{value:"ytd",children:"Year to Date"}),n.jsx(yt,{value:"custom",children:"Custom Range"})]})]})]})]}),$de=U.createContext(void 0),Vde=({children:e})=>{const[t,r]=U.useState(null),[i,a]=U.useState(localStorage.getItem("cvm-selected-segment")),[l,d]=U.useState(localStorage.getItem("cvm-selected-model")),[s,p]=U.useState(localStorage.getItem("cvm-active-view")||"table");U.useEffect(()=>{i&&localStorage.setItem("cvm-selected-segment",i)},[i]),U.useEffect(()=>{l&&localStorage.setItem("cvm-selected-model",l)},[l]),U.useEffect(()=>{localStorage.setItem("cvm-active-view",s)},[s]);const x={selectedCampaign:t,setSelectedCampaign:r,selectedSegment:i,setSelectedSegment:a,selectedModel:l,setSelectedModel:d,activeView:s,setActiveView:p};return n.jsx($de.Provider,{value:x,children:n.jsx(xde,{children:e})})},N3=()=>{const e=U.useContext($de);if(e===void 0)throw new Error("useCvmContext must be used within a CvmProvider");return e},Sct=({campaignList:e,onSelectCampaign:t})=>{const{selectedCampaign:r,setSelectedCampaign:i}=N3();U.useEffect(()=>{!r&&e.length>0&&i(e[0])},[e,r,i]);const a=l=>{i(l),t&&t(l)};return n.jsxs("div",{className:"bg-beam-dark/70 p-4 rounded-lg border border-gray-700/30 mb-6",children:[n.jsx("h3",{className:"text-white font-medium mb-4",children:"Active Campaigns"}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs(Mc,{children:[n.jsx(Ic,{children:n.jsxs(Fs,{className:"border-gray-700",children:[n.jsx(Or,{className:"text-white",children:"ID"}),n.jsx(Or,{className:"text-white",children:"Campaign"}),n.jsx(Or,{className:"text-white",children:"Type"}),n.jsx(Or,{className:"text-white",children:"Target"}),n.jsx(Or,{className:"text-white",children:"Timeline"}),n.jsx(Or,{className:"text-white",children:"Conversion"}),n.jsx(Or,{className:"text-white",children:"ROI"}),n.jsx(Or,{className:"text-white",children:"Status"}),n.jsx(Or,{className:"text-white",children:"Action"})]})}),n.jsx(Oc,{children:e.map(l=>n.jsxs(Fs,{className:`border-gray-700 hover:bg-gray-800/30 cursor-pointer ${(r==null?void 0:r.id)===l.id?"bg-gray-800/50":""}`,onClick:()=>a(l),children:[n.jsx(Rr,{className:"text-white",children:l.id}),n.jsx(Rr,{className:"text-white font-medium",children:l.name}),n.jsx(Rr,{children:n.jsx(Tt,{className:`
                    ${l.type==="Upsell"?"bg-blue-900/30 text-blue-400 border-blue-600":l.type==="Retention"?"bg-purple-900/30 text-purple-400 border-purple-600":"bg-green-900/30 text-green-400 border-green-600"}
                  `,children:l.type})}),n.jsx(Rr,{className:"text-white",children:l.target}),n.jsx(Rr,{className:"text-gray-300",children:n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(Jye,{size:14,className:"text-gray-400"}),n.jsxs("span",{children:[l.startDate.split("-")[1],"/",l.startDate.split("-")[2]]}),n.jsx(cb,{size:12}),n.jsxs("span",{children:[l.endDate.split("-")[1],"/",l.endDate.split("-")[2]]})]})}),n.jsx(Rr,{children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("span",{className:"text-white",children:[l.conversion,"%"]}),n.jsx(vn,{value:l.conversion*10,className:"h-1.5 w-12"})]})}),n.jsx(Rr,{children:n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsxs("span",{className:"text-white",children:[l.roi,"x"]}),l.roi>4?n.jsx(En,{size:14,className:"text-green-400"}):n.jsx("span",{className:"text-amber-400",children:"→"})]})}),n.jsx(Rr,{children:n.jsx(Tt,{className:l.status==="Active"?"bg-green-900/30 text-green-400 border-green-600":"bg-gray-700/30 text-gray-300 border-gray-600",children:l.status})}),n.jsx(Rr,{children:n.jsx(lt,{variant:"ghost",size:"sm",className:"h-8 px-2",children:n.jsx(fm,{size:14})})})]},l.id))})]})})]})},Cct=({selectedCampaign:e,performanceData:t})=>n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[n.jsxs("div",{className:"bg-beam-dark/70 p-4 rounded-lg border border-gray-700/30",children:[n.jsx("h3",{className:"text-white font-medium mb-4",children:"Campaign KPIs"}),n.jsxs("dl",{className:"space-y-4",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("dt",{className:"text-gray-400",children:"Target Size:"}),n.jsxs("dd",{className:"font-medium text-white",children:[e.targetSize.toLocaleString()," subscribers"]})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("dt",{className:"text-gray-400",children:"Conversion Rate:"}),n.jsxs("dd",{className:"font-medium text-white",children:[e.conversion,"%"]})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("dt",{className:"text-gray-400",children:"ROI:"}),n.jsxs("dd",{className:"font-medium text-white",children:[e.roi,"x"]})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("dt",{className:"text-gray-400",children:"Revenue Generated:"}),n.jsxs("dd",{className:"font-medium text-white",children:["$",(e.revenue/1e6).toFixed(2),"M"]})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("dt",{className:"text-gray-400",children:"Campaign Cost:"}),n.jsxs("dd",{className:"font-medium text-white",children:["$",(e.cost/1e6).toFixed(2),"M"]})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("dt",{className:"text-gray-400",children:"Net Profit:"}),n.jsxs("dd",{className:"font-medium text-green-400",children:["$",((e.revenue-e.cost)/1e6).toFixed(2),"M"]})]})]})]}),n.jsxs("div",{className:"lg:col-span-2 bg-beam-dark/70 p-4 rounded-lg border border-gray-700/30",children:[n.jsx("h3",{className:"text-white font-medium mb-4",children:"Performance Trend"}),n.jsx(ms,{width:"100%",height:300,children:n.jsxs(LM,{data:t,margin:{top:20,right:30,left:20,bottom:20},children:[n.jsx($s,{strokeDasharray:"3 3",stroke:"#444"}),n.jsx(is,{dataKey:"month",stroke:"#aaa"}),n.jsx(Gi,{stroke:"#aaa"}),n.jsx(yi,{contentStyle:{backgroundColor:"#1e1e2d",borderColor:"#444",color:"#fff"}}),n.jsx(xa,{}),n.jsx(jl,{type:"monotone",dataKey:"conversion",name:"Conversion Rate (%)",stroke:"#0088FE",strokeWidth:2,dot:{r:4},activeDot:{r:6}}),n.jsx(jl,{type:"monotone",dataKey:"roi",name:"ROI (x)",stroke:"#00C49F",strokeWidth:2,dot:{r:4},activeDot:{r:6}}),n.jsx(jl,{type:"monotone",dataKey:"targetConversion",name:"Target Conversion (%)",stroke:"#FF8042",strokeDasharray:"5 5",strokeWidth:2})]})})]})]}),Act=({targetBreakdown:e,colors:t})=>n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"bg-beam-dark/70 p-4 rounded-lg border border-gray-700/30",children:[n.jsx("h3",{className:"text-white font-medium mb-4",children:"Target Segment Breakdown"}),n.jsx(ms,{width:"100%",height:300,children:n.jsxs(oN,{children:[n.jsx(Gc,{data:e,cx:"50%",cy:"50%",labelLine:!1,outerRadius:100,fill:"#8884d8",dataKey:"value",nameKey:"name",label:({name:r,percent:i})=>`${r}: ${(i*100).toFixed(0)}%`,children:e.map((r,i)=>n.jsx(jd,{fill:t[i%t.length]},`cell-${i}`))}),n.jsx(yi,{formatter:r=>[`${r}%`,"Percentage"],contentStyle:{backgroundColor:"#1e1e2d",borderColor:"#444",color:"#fff"}})]})})]}),n.jsxs("div",{className:"bg-beam-dark/70 p-4 rounded-lg border border-gray-700/30",children:[n.jsx("h3",{className:"text-white font-medium mb-4",children:"Segment Response Rates"}),n.jsx(ms,{width:"100%",height:300,children:n.jsxs(nc,{data:[{name:"High Value",response:7.8},{name:"Medium Value",response:5.5},{name:"Low Value",response:3.2},{name:"New Customers",response:4.4},{name:"At Risk",response:6.7}],margin:{top:20,right:30,left:20,bottom:40},children:[n.jsx($s,{strokeDasharray:"3 3",stroke:"#444"}),n.jsx(is,{dataKey:"name",stroke:"#aaa",angle:-45,textAnchor:"end",height:60}),n.jsx(Gi,{stroke:"#aaa",label:{value:"Response Rate (%)",angle:-90,position:"insideLeft",style:{fill:"#aaa"}}}),n.jsx(yi,{contentStyle:{backgroundColor:"#1e1e2d",borderColor:"#444",color:"#fff"}}),n.jsx(pi,{dataKey:"response",name:"Response Rate (%)",fill:"#0088FE"})]})})]})]}),Tct=({selectedCampaign:e})=>n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[n.jsxs("div",{className:"bg-beam-dark/70 p-4 rounded-lg border border-gray-700/30",children:[n.jsx("h3",{className:"text-white font-medium mb-4",children:"Financial Summary"}),n.jsxs("dl",{className:"space-y-4",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("dt",{className:"text-gray-400",children:"Total Revenue:"}),n.jsxs("dd",{className:"font-medium text-white",children:["$",(e.revenue/1e6).toFixed(2),"M"]})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("dt",{className:"text-gray-400",children:"Total Cost:"}),n.jsxs("dd",{className:"font-medium text-white",children:["$",(e.cost/1e6).toFixed(2),"M"]})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("dt",{className:"text-gray-400",children:"Net Profit:"}),n.jsxs("dd",{className:"font-medium text-green-400",children:["$",((e.revenue-e.cost)/1e6).toFixed(2),"M"]})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("dt",{className:"text-gray-400",children:"ROI:"}),n.jsxs("dd",{className:"font-medium text-white",children:[e.roi,"x"]})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("dt",{className:"text-gray-400",children:"Cost per Acquisition:"}),n.jsxs("dd",{className:"font-medium text-white",children:["$",(e.cost/(e.targetSize*(Number(e.conversion)/100))).toFixed(2)]})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("dt",{className:"text-gray-400",children:"Lifetime Value (est.):"}),n.jsxs("dd",{className:"font-medium text-white",children:["$",(e.revenue/(e.targetSize*(Number(e.conversion)/100))*3).toFixed(2)]})]})]})]}),n.jsxs("div",{className:"lg:col-span-2 bg-beam-dark/70 p-4 rounded-lg border border-gray-700/30",children:[n.jsx("h3",{className:"text-white font-medium mb-4",children:"Revenue vs Cost Breakdown"}),n.jsx(ms,{width:"100%",height:300,children:n.jsxs(nc,{data:[{name:"High Value",revenue:e.revenue*.35,cost:e.cost*.3},{name:"Medium Value",revenue:e.revenue*.25,cost:e.cost*.35},{name:"Low Value",revenue:e.revenue*.15,cost:e.cost*.15},{name:"New Customers",revenue:e.revenue*.1,cost:e.cost*.1},{name:"At Risk",revenue:e.revenue*.15,cost:e.cost*.1}],margin:{top:20,right:30,left:20,bottom:40},children:[n.jsx($s,{strokeDasharray:"3 3",stroke:"#444"}),n.jsx(is,{dataKey:"name",stroke:"#aaa",angle:-45,textAnchor:"end",height:60}),n.jsx(Gi,{stroke:"#aaa",tickFormatter:t=>`$${(t/1e6).toFixed(1)}M`}),n.jsx(yi,{contentStyle:{backgroundColor:"#1e1e2d",borderColor:"#444",color:"#fff"},formatter:t=>[`$${(Number(t)/1e6).toFixed(2)}M`,""]}),n.jsx(xa,{}),n.jsx(pi,{dataKey:"revenue",name:"Revenue",fill:"#0088FE"}),n.jsx(pi,{dataKey:"cost",name:"Cost",fill:"#FF8042"})]})})]})]}),kct=({selectedCampaign:e,campaignView:t,setCampaignView:r,performanceData:i,targetBreakdown:a,colors:l})=>n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl font-medium text-white",children:e.name}),n.jsxs("p",{className:"text-gray-400",children:["Campaign ID: ",e.id]})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx($i,{value:t,onValueChange:r,className:"w-auto",children:n.jsxs(Di,{className:"bg-beam-dark/70 border border-gray-700/50",children:[n.jsx(Jt,{value:"performance",children:"Performance"}),n.jsx(Jt,{value:"target",children:"Target Segments"}),n.jsx(Jt,{value:"financials",children:"Financials"})]})}),n.jsxs(lt,{variant:"outline",size:"sm",children:[n.jsx(Nu,{size:14,className:"mr-1"}),"Export"]})]})]}),n.jsx(ur,{value:"performance",className:"m-0",children:n.jsx(Cct,{selectedCampaign:e,performanceData:i})}),n.jsx(ur,{value:"target",className:"m-0",children:n.jsx(Act,{targetBreakdown:a,colors:l})}),n.jsx(ur,{value:"financials",className:"m-0",children:n.jsx(Tct,{selectedCampaign:e})})]}),Pct=({campaigns:e,selectedCampaign:t})=>{const[r,i]=U.useState(!1),a=(l,d=!1)=>{i(!0),setTimeout(()=>{i(!1);const s=d?"All campaigns":"Campaign details",p=l.toUpperCase();za({title:`${p} Export Successful`,description:`${s} have been exported as ${p} file.`})},1e3)};return n.jsxs(Ip,{children:[n.jsx(Op,{asChild:!0,children:n.jsx(lt,{variant:"outline",size:"sm",disabled:r,className:"border-gray-700 text-gray-300 hover:bg-gray-800",children:r?n.jsx(n.Fragment,{children:"Exporting..."}):n.jsxs(n.Fragment,{children:[n.jsx(Nh,{size:16,className:"mr-1"}),"Export"]})})}),n.jsxs(_m,{className:"bg-beam-dark text-white border-gray-700",children:[t&&n.jsxs(n.Fragment,{children:[n.jsxs(Ao,{className:"hover:bg-gray-800 cursor-pointer",onClick:()=>a("pdf"),children:[n.jsx(IA,{size:16,className:"mr-2 text-blue-400"}),'Export "',t.name,'" as PDF']}),n.jsxs(Ao,{className:"hover:bg-gray-800 cursor-pointer",onClick:()=>a("csv"),children:[n.jsx(IA,{size:16,className:"mr-2 text-green-400"}),'Export "',t.name,'" as CSV']})]}),n.jsxs(Ao,{className:"hover:bg-gray-800 cursor-pointer",onClick:()=>a("excel",!0),children:[n.jsx(IA,{size:16,className:"mr-2 text-green-400"}),"Export all campaigns as Excel"]}),n.jsxs(Ao,{className:"hover:bg-gray-800 cursor-pointer",onClick:()=>a("csv",!0),children:[n.jsx(IA,{size:16,className:"mr-2 text-blue-400"}),"Export all campaigns as CSV"]})]})]})};var Ude="AlertDialog",[Ect,pft]=Jo(Ude,[Yee]),Gm=Yee(),Gde=e=>{const{__scopeAlertDialog:t,...r}=e,i=Gm(t);return n.jsx(sB,{...i,...r,modal:!0})};Gde.displayName=Ude;var Mct="AlertDialogTrigger",Hde=U.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...i}=e,a=Gm(r);return n.jsx(hte,{...a,...i,ref:t})});Hde.displayName=Mct;var Ict="AlertDialogPortal",qde=e=>{const{__scopeAlertDialog:t,...r}=e,i=Gm(t);return n.jsx(aB,{...i,...r})};qde.displayName=Ict;var Oct="AlertDialogOverlay",Wde=U.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...i}=e,a=Gm(r);return n.jsx(ZN,{...a,...i,ref:t})});Wde.displayName=Oct;var Hv="AlertDialogContent",[Rct,Dct]=Ect(Hv),Kde=U.forwardRef((e,t)=>{const{__scopeAlertDialog:r,children:i,...a}=e,l=Gm(r),d=U.useRef(null),s=Mn(t,d),p=U.useRef(null);return n.jsx(bje,{contentName:Hv,titleName:Zde,docsSlug:"alert-dialog",children:n.jsx(Rct,{scope:r,cancelRef:p,children:n.jsxs(YN,{role:"alertdialog",...l,...a,ref:s,onOpenAutoFocus:_r(a.onOpenAutoFocus,x=>{var w;x.preventDefault(),(w=p.current)==null||w.focus({preventScroll:!0})}),onPointerDownOutside:x=>x.preventDefault(),onInteractOutside:x=>x.preventDefault(),children:[n.jsx(SF,{children:i}),n.jsx(Lct,{contentRef:d})]})})})});Kde.displayName=Hv;var Zde="AlertDialogTitle",Yde=U.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...i}=e,a=Gm(r);return n.jsx(XN,{...a,...i,ref:t})});Yde.displayName=Zde;var Xde="AlertDialogDescription",Jde=U.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...i}=e,a=Gm(r);return n.jsx(JN,{...a,...i,ref:t})});Jde.displayName=Xde;var zct="AlertDialogAction",Qde=U.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...i}=e,a=Gm(r);return n.jsx(VE,{...a,...i,ref:t})});Qde.displayName=zct;var ehe="AlertDialogCancel",the=U.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...i}=e,{cancelRef:a}=Dct(ehe,r),l=Gm(r),d=Mn(t,a);return n.jsx(VE,{...l,...i,ref:d})});the.displayName=ehe;var Lct=({contentRef:e})=>{const t=`\`${Hv}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${Hv}\` by passing a \`${Xde}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${Hv}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return U.useEffect(()=>{var i;document.getElementById((i=e.current)==null?void 0:i.getAttribute("aria-describedby"))||console.warn(t)},[t,e]),null},Fct=Gde,Bct=Hde,$ct=qde,rhe=Wde,nhe=Kde,ihe=Qde,she=the,ahe=Yde,ohe=Jde;const Vct=Fct,Uct=Bct,Gct=$ct,lhe=U.forwardRef(({className:e,...t},r)=>n.jsx(rhe,{className:Yt("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:r}));lhe.displayName=rhe.displayName;const che=U.forwardRef(({className:e,...t},r)=>n.jsxs(Gct,{children:[n.jsx(lhe,{}),n.jsx(nhe,{ref:r,className:Yt("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...t})]}));che.displayName=nhe.displayName;const uhe=({className:e,...t})=>n.jsx("div",{className:Yt("flex flex-col space-y-2 text-center sm:text-left",e),...t});uhe.displayName="AlertDialogHeader";const dhe=({className:e,...t})=>n.jsx("div",{className:Yt("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});dhe.displayName="AlertDialogFooter";const hhe=U.forwardRef(({className:e,...t},r)=>n.jsx(ahe,{ref:r,className:Yt("text-lg font-semibold",e),...t}));hhe.displayName=ahe.displayName;const mhe=U.forwardRef(({className:e,...t},r)=>n.jsx(ohe,{ref:r,className:Yt("text-sm text-muted-foreground",e),...t}));mhe.displayName=ohe.displayName;const fhe=U.forwardRef(({className:e,...t},r)=>n.jsx(ihe,{ref:r,className:Yt(w2(),e),...t}));fhe.displayName=ihe.displayName;const phe=U.forwardRef(({className:e,...t},r)=>n.jsx(she,{ref:r,className:Yt(w2({variant:"outline"}),"mt-2 sm:mt-0",e),...t}));phe.displayName=she.displayName;const Hct=({campaign:e,onStatusChange:t})=>{const r=()=>{t(e.id,"Paused"),za({title:"Campaign Paused",description:`${e.name} has been paused. You can resume it at any time.`})},i=()=>{t(e.id,"Active"),za({title:"Campaign Resumed",description:`${e.name} is now active and running.`})},a=()=>{t(e.id,"Archived"),za({title:"Campaign Archived",description:`${e.name} has been archived.`})};return n.jsxs("div",{className:"flex items-center gap-2",children:[e.status==="Active"&&n.jsxs(lt,{variant:"outline",size:"sm",className:"border-amber-600/50 text-amber-400 hover:bg-amber-950/30",onClick:r,children:[n.jsx(rve,{size:16,className:"mr-1"}),"Pause"]}),e.status==="Paused"&&n.jsxs(lt,{variant:"outline",size:"sm",className:"border-green-600/50 text-green-400 hover:bg-green-950/30",onClick:i,children:[n.jsx(nve,{size:16,className:"mr-1"}),"Resume"]}),(e.status==="Active"||e.status==="Paused")&&n.jsxs(Vct,{children:[n.jsx(Uct,{asChild:!0,children:n.jsxs(lt,{variant:"outline",size:"sm",className:"border-gray-600/50 text-gray-400 hover:bg-gray-800/30",children:[n.jsx(PF,{size:16,className:"mr-1"}),"Archive"]})}),n.jsxs(che,{className:"bg-beam-dark text-white border-gray-700",children:[n.jsxs(uhe,{children:[n.jsxs(hhe,{className:"text-white flex items-center gap-2",children:[n.jsx(ub,{size:20,className:"text-amber-400"}),"Archive Campaign"]}),n.jsxs(mhe,{className:"text-gray-400",children:['Are you sure you want to archive "',e.name,'"? This will stop the campaign and move it to the archive. You can access archived campaigns from the filter menu.']})]}),n.jsxs(dhe,{children:[n.jsx(phe,{className:"bg-gray-800 text-white hover:bg-gray-700 border-gray-600",children:"Cancel"}),n.jsx(fhe,{onClick:a,className:"bg-red-900 hover:bg-red-800 text-white",children:"Archive Campaign"})]})]})]})]})},qct=[{id:"C1001",name:"Summer Data Booster",type:"Upsell",startDate:"2023-05-01",endDate:"2023-07-31",target:"Medium Value",targetSize:12e5,conversion:5.8,roi:4.2,status:"Active",revenue:245e4,cost:58e4},{id:"C1002",name:"Premium Retention Offer",type:"Retention",startDate:"2023-04-15",endDate:"2023-06-15",target:"High Value",targetSize:45e4,conversion:7.2,roi:5.1,status:"Active",revenue:32e5,cost:62e4},{id:"C1003",name:"Family Plan Upgrade",type:"Cross-sell",startDate:"2023-04-01",endDate:"2023-05-31",target:"Medium Value",targetSize:85e4,conversion:4.5,roi:3.8,status:"Active",revenue:185e4,cost:48e4},{id:"C1004",name:"Churn Prevention Bundle",type:"Retention",startDate:"2023-05-10",endDate:"2023-06-10",target:"At Risk",targetSize:32e4,conversion:8.4,roi:3.2,status:"Active",revenue:125e4,cost:385e3},{id:"C1005",name:"New Device Promotional",type:"Cross-sell",startDate:"2023-03-01",endDate:"2023-04-30",target:"All Segments",targetSize:22e5,conversion:3.2,roi:2.9,status:"Completed",revenue:54e5,cost:185e4}],Wct=()=>{const{selectedCampaign:e,setSelectedCampaign:t}=N3(),[r,i]=U.useState("performance"),[a,l]=U.useState(!1),[d,s]=U.useState(void 0),[p,x]=U.useState(qct),[w,j]=U.useState([]);return{selectedCampaign:e,setSelectedCampaign:t,campaignView:r,setCampaignView:i,campaignDialogOpen:a,setCampaignDialogOpen:l,editingCampaign:d,setEditingCampaign:s,campaigns:p,setCampaigns:x,comparisonCampaigns:w,setComparisonCampaigns:j,handleCreateCampaign:()=>{s(void 0),l(!0)},handleEditCampaign:()=>{s(e),l(!0)},handleSaveCampaign:$=>{if(d)x(G=>G.map(W=>W.id===d.id?{...W,...$}:W)),(e==null?void 0:e.id)===d.id&&t({...e,...$});else{const G=$;x(W=>[...W,G])}},handleStatusChange:($,G)=>{x(W=>W.map(Z=>Z.id===$?{...Z,status:G}:Z)),(e==null?void 0:e.id)===$&&t({...e,status:G})},handleRunSimulation:()=>{za({title:"Simulation Started",description:"Campaign performance simulation is running. Results will be available shortly."})},handleUseTemplate:$=>{s(void 0),l(!0)}}},Kct=()=>[{month:"Jan",conversion:3.8,roi:4.2,targetConversion:3.5},{month:"Feb",conversion:4.1,roi:4.5,targetConversion:3.5},{month:"Mar",conversion:3.5,roi:3.9,targetConversion:3.5},{month:"Apr",conversion:5.2,roi:5.4,targetConversion:3.5},{month:"May",conversion:4.8,roi:5.1,targetConversion:3.5},{month:"Jun",conversion:5.5,roi:5.8,targetConversion:3.5}],Zct=()=>[{name:"High Value",value:25},{name:"Medium Value",value:35},{name:"Low Value",value:20},{name:"New Customers",value:10},{name:"At Risk",value:10}],Yct=()=>["#0088FE","#00C49F","#FFBB28","#FF8042","#8884d8","#82ca9d"],Xct=({campaigns:e,onSelectCampaign:t,campaignView:r,setCampaignView:i,handleEditCampaign:a,handleStatusChange:l,onTemplatesClick:d,onNotificationsClick:s,onAbTestingClick:p})=>{const{selectedCampaign:x,setSelectedCampaign:w}=N3(),j=Kct(),S=Zct(),P=Yct();return U.useEffect(()=>{!x&&e.length>0&&w(e[0])},[e,x,w]),n.jsxs(n.Fragment,{children:[n.jsx(Nct,{}),n.jsxs("div",{className:"flex justify-between items-center mb-3",children:[n.jsxs(lt,{variant:"outline",size:"sm",className:"border-gray-700 text-gray-300 hover:bg-gray-800",children:[n.jsx(fm,{size:16,className:"mr-1"}),"Filter"]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx(Pct,{campaigns:e,selectedCampaign:x}),n.jsxs(lt,{variant:"outline",size:"sm",className:"border-gray-700 text-gray-300 hover:bg-gray-800",onClick:d,children:[n.jsx(fm,{size:16,className:"mr-1"}),"Templates"]}),n.jsxs(lt,{variant:"outline",size:"sm",className:"border-gray-700 text-gray-300 hover:bg-gray-800",onClick:s,children:[n.jsx(fm,{size:16,className:"mr-1"}),"Notifications"]})]})]}),n.jsx(Sct,{campaignList:e,onSelectCampaign:t}),x&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl font-medium text-white",children:x.name}),n.jsxs("p",{className:"text-gray-400",children:["Campaign ID: ",x.id]})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx($i,{value:r,onValueChange:i,className:"w-auto",children:n.jsxs(Di,{className:"bg-beam-dark/70 border border-gray-700/50",children:[n.jsx(Jt,{value:"performance",children:"Performance"}),n.jsx(Jt,{value:"target",children:"Target Segments"}),n.jsx(Jt,{value:"financials",children:"Financials"}),n.jsx(Jt,{value:"ab-testing",onClick:p,children:"A/B Testing"})]})}),n.jsxs(lt,{variant:"outline",size:"sm",onClick:a,children:[n.jsx(fm,{size:14,className:"mr-1"}),"Edit"]}),n.jsx(Hct,{campaign:x,onStatusChange:l})]})]}),n.jsx(kct,{selectedCampaign:x,campaignView:r,setCampaignView:i,performanceData:j,targetBreakdown:S,colors:P})]})]})},Jct=({activeSection:e,onCreateCampaign:t,onRunSimulation:r,onCalendarClick:i,onComparisonClick:a})=>n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx(fr,{className:"text-xl text-white",children:"Campaign Analysis & Planning"}),n.jsx(Ii,{className:"text-gray-300",children:"Track performance, run simulations, and optimize campaigns"})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs(lt,{className:"bg-beam-blue hover:bg-blue-600",onClick:t,children:[n.jsx(Mo,{size:16,className:"mr-1"}),"Create Campaign"]}),n.jsxs(lt,{variant:"outline",size:"sm",onClick:r,children:[n.jsx(Sh,{size:16,className:"mr-1"}),"Run Simulation"]}),n.jsxs(lt,{variant:e==="calendar"?"default":"outline",size:"sm",className:e==="calendar"?"bg-beam-blue":"border-gray-700",onClick:i,children:[n.jsx(xh,{size:16,className:"mr-1"}),"Calendar"]}),n.jsxs(lt,{variant:e==="comparison"?"default":"outline",size:"sm",className:e==="comparison"?"bg-beam-blue":"border-gray-700",onClick:a,children:[n.jsx(Co,{size:16,className:"mr-1"}),"Compare"]})]})]}),Qct=({activeSection:e,onChange:t})=>n.jsx("div",{className:"mt-4 lg:hidden",children:n.jsx($i,{value:e,onValueChange:t,className:"w-full",children:n.jsxs(Di,{className:"grid grid-cols-3 w-full bg-beam-dark/70 border border-gray-700/50",children:[n.jsx(Jt,{value:"main",children:"Campaigns"}),n.jsx(Jt,{value:"calendar",children:"Calendar"}),n.jsx(Jt,{value:"comparison",children:"Compare"})]})})}),eut=()=>{const{selectedCampaign:e,setSelectedCampaign:t,campaignView:r,setCampaignView:i,campaignDialogOpen:a,setCampaignDialogOpen:l,editingCampaign:d,campaigns:s,comparisonCampaigns:p,setComparisonCampaigns:x,handleCreateCampaign:w,handleEditCampaign:j,handleSaveCampaign:S,handleStatusChange:P,handleRunSimulation:F,handleUseTemplate:L}=Wct(),[B,V]=U.useState("main"),$=()=>V(B==="calendar"?"main":"calendar"),G=()=>V(B==="comparison"?"main":"comparison"),W=()=>V("templates"),Z=()=>V("notifications"),se=()=>V("ab-testing");return n.jsxs("div",{className:"space-y-6",children:[n.jsxs(jt,{className:"shadow-lg border-gray-800/30 bg-beam-dark-accent/50 backdrop-blur-md",children:[n.jsxs(wr,{className:"pb-2",children:[n.jsx(Jct,{activeSection:B,onCreateCampaign:w,onRunSimulation:F,onCalendarClick:$,onComparisonClick:G}),n.jsx(Qct,{activeSection:B,onChange:ae=>V(ae)})]}),n.jsxs(Ht,{children:[B==="main"&&n.jsx(Xct,{campaigns:s,onSelectCampaign:t,campaignView:r,setCampaignView:i,handleEditCampaign:j,handleStatusChange:P,onTemplatesClick:W,onNotificationsClick:Z,onAbTestingClick:se}),B==="calendar"&&n.jsx(yct,{campaigns:s,onSelectCampaign:ae=>{t(ae),V("main")}}),B==="comparison"&&n.jsx(vct,{campaigns:s,selectedCampaigns:p,onSelectCampaigns:x}),B==="templates"&&n.jsx(_ct,{onSelectTemplate:L}),B==="ab-testing"&&n.jsx(wct,{selectedCampaign:e}),B==="notifications"&&n.jsx(jct,{campaigns:s,onSelectCampaign:ae=>{t(ae),V("main")}})]})]}),n.jsx(xct,{open:a,setOpen:l,editCampaign:d,onSave:S})]})},tut=[{month:"Jan",precision:82,recall:78,f1:80,baseline:70},{month:"Feb",precision:83,recall:79,f1:81,baseline:70},{month:"Mar",precision:84,recall:80,f1:82,baseline:70},{month:"Apr",precision:83,recall:81,f1:82,baseline:70},{month:"May",precision:85,recall:82,f1:83,baseline:70},{month:"Jun",precision:86,recall:83,f1:84,baseline:70}],lY=[{id:"M001",name:"Churn Prediction",icon:RQ,type:"Classification",accuracy:86,lastUpdated:"2023-05-10",dataSources:["Customer Database","Usage Patterns","Payment History"],features:85,dataPoints:"4.5M",status:"Active"},{id:"M002",name:"Postpaid Plan Propensity",icon:sc,type:"Classification",accuracy:82,lastUpdated:"2023-05-05",dataSources:["Customer Database","Campaign History","Service Usage"],features:72,dataPoints:"2.8M",status:"Active"},{id:"M003",name:"Prepaid Plan Propensity",icon:Tve,type:"Classification",accuracy:84,lastUpdated:"2023-05-02",dataSources:["Customer Database","Recharge Patterns","Service Usage"],features:68,dataPoints:"3.2M",status:"Active"},{id:"M004",name:"Add-on Purchase Propensity",icon:vve,type:"Classification",accuracy:79,lastUpdated:"2023-04-28",dataSources:["Customer Database","Service Usage","App Behavior"],features:64,dataPoints:"3.8M",status:"Active"},{id:"M005",name:"Risk of Default",icon:yve,type:"Classification",accuracy:88,lastUpdated:"2023-04-25",dataSources:["Payment History","Credit Score","Customer Database"],features:78,dataPoints:"2.1M",status:"Active"}],PR=[{name:"Service Calls (last 30 days)",importance:18},{name:"Bill Amount Variability",importance:16},{name:"Tenure (months)",importance:14},{name:"Payment Delays (last 6 months)",importance:12},{name:"Data Usage Trend",importance:10},{name:"Network Drops (last 30 days)",importance:9},{name:"Contract Type",importance:8},{name:"Device Age",importance:7},{name:"Competitor Offers (region)",importance:6}],rut=[{id:"1001",name:"Alex Johnson",segment:"High Value",churnScore:.12,postpaidScore:.85,prepaidScore:.15,addOnScore:.67},{id:"1002",name:"Samantha Lee",segment:"High Value",churnScore:.08,postpaidScore:.92,prepaidScore:.05,addOnScore:.78},{id:"1003",name:"David Wilson",segment:"Medium Value",churnScore:.45,postpaidScore:.38,prepaidScore:.62,addOnScore:.29},{id:"1004",name:"Mei Zhang",segment:"Low Value",churnScore:.75,postpaidScore:.22,prepaidScore:.78,addOnScore:.15},{id:"1005",name:"James Brown",segment:"New Customers",churnScore:.35,postpaidScore:.65,prepaidScore:.35,addOnScore:.48}],cY=["#0088FE","#00C49F","#FFBB28","#FF8042","#8884d8","#82ca9d"],nut=()=>{const[e,t]=U.useState(lY[0]),[r,i]=U.useState("performance"),a=()=>{za({title:"Model Refresh Initiated",description:"The model is being refreshed with the latest data. This may take a few minutes."})},l=()=>{za({title:"Export Started",description:"Propensity model insights are being exported in CSV format."})};return n.jsx("div",{className:"space-y-6",children:n.jsxs(jt,{className:"shadow-lg border-gray-800/30 bg-beam-dark-accent/50 backdrop-blur-md",children:[n.jsx(wr,{className:"pb-2",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx(fr,{className:"text-xl text-white",children:"Propensity Models"}),n.jsx(Ii,{className:"text-gray-300",children:"Track and leverage ML models for customer behavior prediction"})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs(lt,{variant:"outline",size:"sm",onClick:a,children:[n.jsx(uk,{size:16,className:"mr-1"}),"Refresh Models"]}),n.jsxs(lt,{variant:"outline",size:"sm",onClick:l,children:[n.jsx(Nu,{size:16,className:"mr-1"}),"Export Insights"]})]})]})}),n.jsxs(Ht,{children:[n.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-4 mb-6",children:lY.map(d=>n.jsx(jt,{className:`
                  bg-beam-dark/70 border border-gray-700/30 hover:border-gray-500/50 transition-colors cursor-pointer
                  ${e.id===d.id?"border-beam-blue/50 shadow-md shadow-beam-blue/10":""}
                `,onClick:()=>t(d),children:n.jsxs(Ht,{className:"p-4",children:[n.jsx("div",{className:"flex items-center justify-between mb-2",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:`
                        p-1.5 rounded-md ${d.name.includes("Churn")?"bg-red-900/20 text-red-400":d.name.includes("Postpaid")?"bg-blue-900/20 text-blue-400":d.name.includes("Prepaid")?"bg-green-900/20 text-green-400":d.name.includes("Add-on")?"bg-purple-900/20 text-purple-400":"bg-amber-900/20 text-amber-400"}
                      `,children:n.jsx(d.icon,{size:16})}),n.jsx("span",{className:"font-medium text-white",children:d.name})]})}),n.jsxs("div",{className:"flex items-center gap-1 text-sm text-gray-400 mb-2",children:[n.jsx("span",{children:d.type}),n.jsx("span",{className:"text-gray-600",children:"•"}),n.jsxs("span",{children:["Updated ",d.lastUpdated]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("span",{className:"text-white text-sm",children:[d.accuracy,"% accuracy"]}),n.jsx(vn,{value:d.accuracy,className:"h-1.5"})]})]})},d.id))}),e&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsxs("h2",{className:"text-xl font-medium text-white flex items-center gap-2",children:[n.jsx("div",{className:`
                      p-1.5 rounded-md ${e.name.includes("Churn")?"bg-red-900/20 text-red-400":e.name.includes("Postpaid")?"bg-blue-900/20 text-blue-400":e.name.includes("Prepaid")?"bg-green-900/20 text-green-400":e.name.includes("Add-on")?"bg-purple-900/20 text-purple-400":"bg-amber-900/20 text-amber-400"}
                    `,children:n.jsx(e.icon,{size:18})}),e.name]}),n.jsxs("p",{className:"text-gray-400",children:["Model ID: ",e.id]})]}),n.jsx("div",{className:"flex gap-2",children:n.jsx($i,{value:r,onValueChange:i,className:"w-auto",children:n.jsxs(Di,{className:"bg-beam-dark/70 border border-gray-700/50",children:[n.jsx(Jt,{value:"performance",children:"Performance"}),n.jsx(Jt,{value:"features",children:"Features"}),n.jsx(Jt,{value:"predictions",children:"Predictions"})]})})})]}),n.jsx(ur,{value:"performance",className:"m-0",children:n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[n.jsxs("div",{className:"bg-beam-dark/70 p-4 rounded-lg border border-gray-700/30",children:[n.jsx("h3",{className:"text-white font-medium mb-4",children:"Model Statistics"}),n.jsxs("dl",{className:"space-y-4",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("dt",{className:"text-gray-400",children:"Accuracy:"}),n.jsxs("dd",{className:"font-medium text-white",children:[e.accuracy,"%"]})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("dt",{className:"text-gray-400",children:"Data Sources:"}),n.jsx("dd",{className:"font-medium text-white",children:e.dataSources.length})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("dt",{className:"text-gray-400",children:"Features:"}),n.jsx("dd",{className:"font-medium text-white",children:e.features})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("dt",{className:"text-gray-400",children:"Data Points:"}),n.jsx("dd",{className:"font-medium text-white",children:e.dataPoints})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("dt",{className:"text-gray-400",children:"Last Updated:"}),n.jsx("dd",{className:"font-medium text-white",children:e.lastUpdated})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("dt",{className:"text-gray-400",children:"Status:"}),n.jsx("dd",{className:"font-medium text-green-400",children:e.status})]})]})]}),n.jsxs("div",{className:"lg:col-span-2 bg-beam-dark/70 p-4 rounded-lg border border-gray-700/30",children:[n.jsx("h3",{className:"text-white font-medium mb-4",children:"Performance Metrics"}),n.jsx(ms,{width:"100%",height:300,children:n.jsxs(LM,{data:tut,margin:{top:20,right:30,left:20,bottom:20},children:[n.jsx($s,{strokeDasharray:"3 3",stroke:"#444"}),n.jsx(is,{dataKey:"month",stroke:"#aaa"}),n.jsx(Gi,{stroke:"#aaa",domain:[60,90]}),n.jsx(yi,{contentStyle:{backgroundColor:"#1e1e2d",borderColor:"#444",color:"#fff"},formatter:d=>[`${d}%`,""]}),n.jsx(xa,{}),n.jsx(jl,{type:"monotone",dataKey:"precision",name:"Precision",stroke:"#0088FE",strokeWidth:2,dot:{r:4},activeDot:{r:6}}),n.jsx(jl,{type:"monotone",dataKey:"recall",name:"Recall",stroke:"#00C49F",strokeWidth:2,dot:{r:4},activeDot:{r:6}}),n.jsx(jl,{type:"monotone",dataKey:"f1",name:"F1 Score",stroke:"#FFBB28",strokeWidth:2,dot:{r:4},activeDot:{r:6}}),n.jsx(jl,{type:"monotone",dataKey:"baseline",name:"Baseline",stroke:"#FF8042",strokeDasharray:"5 5",strokeWidth:2})]})})]}),n.jsxs("div",{className:"lg:col-span-3 bg-beam-dark/70 p-4 rounded-lg border border-gray-700/30",children:[n.jsx("h3",{className:"text-white font-medium mb-4",children:"Data Sources"}),n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:e.dataSources.map((d,s)=>n.jsx(jt,{className:"bg-beam-dark border border-gray-700/30",children:n.jsxs(Ht,{className:"p-4",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx(Tt,{variant:"secondary",children:s+1}),n.jsx("h4",{className:"text-white font-medium",children:d})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsx("span",{className:"text-gray-400",children:"Connection:"}),n.jsx("span",{className:"text-green-400",children:"Active"})]}),n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsx("span",{className:"text-gray-400",children:"Records:"}),n.jsxs("span",{className:"text-white",children:[(Math.random()*5+1).toFixed(1),"M"]})]}),n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsx("span",{className:"text-gray-400",children:"Last Sync:"}),n.jsx("span",{className:"text-white",children:"3 hours ago"})]})]})]})},s))})]})]})}),n.jsx(ur,{value:"features",className:"m-0",children:n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"bg-beam-dark/70 p-4 rounded-lg border border-gray-700/30",children:[n.jsx("h3",{className:"text-white font-medium mb-4",children:"Feature Importance"}),n.jsx(ms,{width:"100%",height:400,children:n.jsxs(nc,{layout:"vertical",data:PR,margin:{top:20,right:30,left:120,bottom:20},children:[n.jsx($s,{strokeDasharray:"3 3",stroke:"#444",horizontal:!1}),n.jsx(is,{type:"number",stroke:"#aaa"}),n.jsx(Gi,{dataKey:"name",type:"category",stroke:"#aaa",width:110}),n.jsx(yi,{contentStyle:{backgroundColor:"#1e1e2d",borderColor:"#444",color:"#fff"},formatter:d=>[`${d}%`,"Importance"]}),n.jsx(pi,{dataKey:"importance",name:"Importance",fill:"#0088FE",children:PR.map((d,s)=>n.jsx(jd,{fill:cY[s%cY.length]},`cell-${s}`))})]})})]}),n.jsxs("div",{className:"bg-beam-dark/70 p-4 rounded-lg border border-gray-700/30",children:[n.jsx("h3",{className:"text-white font-medium mb-4",children:"Feature Correlation Strength"}),n.jsx("div",{className:"space-y-4",children:PR.map((d,s)=>n.jsxs("div",{className:"space-y-1",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-white",children:d.name}),n.jsxs("span",{className:"text-gray-300",children:[d.importance,"%"]})]}),n.jsx(vn,{value:d.importance*5,className:"h-2",style:{background:"linear-gradient(90deg, rgba(0,136,254,0.2) 0%, rgba(0,196,159,0.2) 50%, rgba(255,187,40,0.2) 100%)"}}),n.jsxs("div",{className:"text-xs text-gray-400",children:[s===0&&"Higher call volumes strongly indicate dissatisfaction",s===1&&"Unexpected bill changes are a key churn indicator",s===2&&"Longer-tenured customers are less likely to churn",s===3&&"Frequent payment issues predict churn risk",s===4&&"Decreasing data usage often precedes churn"]})]},s))})]}),n.jsxs("div",{className:"lg:col-span-2 bg-beam-dark/70 p-4 rounded-lg border border-gray-700/30",children:[n.jsx("h3",{className:"text-white font-medium mb-4",children:"Feature Engineering Insights"}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"p-3 bg-blue-900/10 border border-blue-600/20 rounded-lg",children:[n.jsx("h4",{className:"text-white font-medium mb-1",children:"Data Transformations"}),n.jsx("p",{className:"text-gray-300 text-sm",children:"Key features undergo log transformation to normalize distributions. Customer tenure, ARPU metrics, and usage patterns are standardized with z-score normalization to improve model reliability."})]}),n.jsxs("div",{className:"p-3 bg-green-900/10 border border-green-600/20 rounded-lg",children:[n.jsx("h4",{className:"text-white font-medium mb-1",children:"Time-based Features"}),n.jsx("p",{className:"text-gray-300 text-sm",children:"Rolling 30-day and 90-day aggregations of usage metrics, network quality indicators, and customer service interactions provide time-sensitive predictors of changing customer behavior."})]}),n.jsxs("div",{className:"p-3 bg-purple-900/10 border border-purple-600/20 rounded-lg",children:[n.jsx("h4",{className:"text-white font-medium mb-1",children:"Categorical Encoding"}),n.jsx("p",{className:"text-gray-300 text-sm",children:"One-hot encoding is applied to location data, service plans, and device types. Target encoding is used for high-cardinality variables like cell tower IDs to maintain predictive power while reducing dimensionality."})]}),n.jsxs("div",{className:"p-3 bg-amber-900/10 border border-amber-600/20 rounded-lg",children:[n.jsx("h4",{className:"text-white font-medium mb-1",children:"Interaction Features"}),n.jsx("p",{className:"text-gray-300 text-sm",children:"Custom interaction terms between network quality metrics and customer service contacts revealed strong predictive patterns. Similarly, combinations of payment behavior and service plan changes significantly improved model performance."})]})]})]})]})}),n.jsx(ur,{value:"predictions",className:"m-0",children:n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"bg-beam-dark/70 p-4 rounded-lg border border-gray-700/30",children:[n.jsx("h3",{className:"text-white font-medium mb-4",children:"Individual Customer Predictions"}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs(Mc,{children:[n.jsx(Ic,{children:n.jsxs(Fs,{className:"border-gray-700",children:[n.jsx(Or,{className:"text-white",children:"ID"}),n.jsx(Or,{className:"text-white",children:"Customer Name"}),n.jsx(Or,{className:"text-white",children:"Segment"}),n.jsx(Or,{className:"text-white",children:"Churn Risk"}),n.jsx(Or,{className:"text-white",children:"Postpaid Propensity"}),n.jsx(Or,{className:"text-white",children:"Prepaid Propensity"}),n.jsx(Or,{className:"text-white",children:"Add-on Propensity"})]})}),n.jsx(Oc,{children:rut.map(d=>n.jsxs(Fs,{className:"border-gray-700 hover:bg-gray-800/30",children:[n.jsx(Rr,{className:"text-white",children:d.id}),n.jsx(Rr,{className:"text-white",children:d.name}),n.jsx(Rr,{children:n.jsx(Tt,{className:`
                                  ${d.segment==="High Value"?"bg-green-900/30 text-green-400 border-green-600":d.segment==="Medium Value"?"bg-blue-900/30 text-blue-400 border-blue-600":d.segment==="Low Value"?"bg-amber-900/30 text-amber-400 border-amber-600":"bg-purple-900/30 text-purple-400 border-purple-600"}
                                `,children:d.segment})}),n.jsx(Rr,{children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(vn,{value:d.churnScore*100,className:"h-2 w-16",style:{background:"linear-gradient(90deg, rgba(34,197,94,0.2) 0%, rgba(234,179,8,0.2) 50%, rgba(239,68,68,0.2) 100%)"}}),n.jsxs("span",{className:d.churnScore<.3?"text-green-400":d.churnScore<.6?"text-amber-400":"text-red-400",children:[(d.churnScore*100).toFixed(0),"%"]})]})}),n.jsx(Rr,{children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(vn,{value:d.postpaidScore*100,className:"h-2 w-16 bg-blue-900/20"}),n.jsxs("span",{className:"text-white",children:[(d.postpaidScore*100).toFixed(0),"%"]})]})}),n.jsx(Rr,{children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(vn,{value:d.prepaidScore*100,className:"h-2 w-16 bg-green-900/20"}),n.jsxs("span",{className:"text-white",children:[(d.prepaidScore*100).toFixed(0),"%"]})]})}),n.jsx(Rr,{children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(vn,{value:d.addOnScore*100,className:"h-2 w-16 bg-purple-900/20"}),n.jsxs("span",{className:"text-white",children:[(d.addOnScore*100).toFixed(0),"%"]})]})})]},d.id))})]})}),n.jsxs("div",{className:"flex justify-between mt-4",children:[n.jsx("div",{className:"text-sm text-gray-400",children:"Showing 5 of 4,500,000 customers"}),n.jsxs(lt,{variant:"outline",size:"sm",children:[n.jsx(Nu,{size:14,className:"mr-1"}),"Export Predictions"]})]})]}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"bg-beam-dark/70 p-4 rounded-lg border border-gray-700/30",children:[n.jsx("h3",{className:"text-white font-medium mb-4",children:"Segment-level Propensities"}),n.jsx(ms,{width:"100%",height:350,children:n.jsxs(nc,{data:[{name:"High Value",churn:12,postpaid:85,prepaid:15,addon:62},{name:"Medium Value",churn:28,postpaid:65,prepaid:35,addon:48},{name:"Low Value",churn:45,postpaid:30,prepaid:70,addon:25},{name:"New Customers",churn:32,postpaid:52,prepaid:48,addon:44}],margin:{top:20,right:30,left:20,bottom:40},children:[n.jsx($s,{strokeDasharray:"3 3",stroke:"#444"}),n.jsx(is,{dataKey:"name",stroke:"#aaa",angle:-45,textAnchor:"end",height:60}),n.jsx(Gi,{stroke:"#aaa"}),n.jsx(yi,{contentStyle:{backgroundColor:"#1e1e2d",borderColor:"#444",color:"#fff"}}),n.jsx(xa,{}),n.jsx(pi,{dataKey:"churn",name:"Churn Risk %",fill:"#ff4d4f"}),n.jsx(pi,{dataKey:"postpaid",name:"Postpaid %",fill:"#0088FE"}),n.jsx(pi,{dataKey:"prepaid",name:"Prepaid %",fill:"#00C49F"}),n.jsx(pi,{dataKey:"addon",name:"Add-on %",fill:"#8884d8"})]})})]}),n.jsxs("div",{className:"bg-beam-dark/70 p-4 rounded-lg border border-gray-700/30",children:[n.jsx("h3",{className:"text-white font-medium mb-4",children:"Score Distribution"}),n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-white",children:"Churn Risk Distribution"}),n.jsx("span",{className:"text-gray-400",children:"Mean: 28%"})]}),n.jsxs("div",{className:"h-8 rounded-md bg-gradient-to-r from-green-500 via-yellow-500 to-red-500 relative",children:[n.jsxs("div",{className:"absolute inset-0 flex",children:[n.jsx("div",{className:"w-1/5 border-r border-gray-700/50"}),n.jsx("div",{className:"w-1/5 border-r border-gray-700/50"}),n.jsx("div",{className:"w-1/5 border-r border-gray-700/50"}),n.jsx("div",{className:"w-1/5 border-r border-gray-700/50"}),n.jsx("div",{className:"w-1/5"})]}),n.jsx("div",{className:"absolute bottom-full left-[28%] transform -translate-x-1/2 mb-1",children:n.jsx("div",{className:"w-1 h-3 bg-white mx-auto"})})]}),n.jsxs("div",{className:"flex justify-between text-xs text-gray-400",children:[n.jsx("span",{children:"0%"}),n.jsx("span",{children:"20%"}),n.jsx("span",{children:"40%"}),n.jsx("span",{children:"60%"}),n.jsx("span",{children:"80%"}),n.jsx("span",{children:"100%"})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-white",children:"Postpaid Propensity Distribution"}),n.jsx("span",{className:"text-gray-400",children:"Mean: 58%"})]}),n.jsxs("div",{className:"h-8 rounded-md bg-gradient-to-r from-gray-500 via-blue-400 to-blue-600 relative",children:[n.jsxs("div",{className:"absolute inset-0 flex",children:[n.jsx("div",{className:"w-1/5 border-r border-gray-700/50"}),n.jsx("div",{className:"w-1/5 border-r border-gray-700/50"}),n.jsx("div",{className:"w-1/5 border-r border-gray-700/50"}),n.jsx("div",{className:"w-1/5 border-r border-gray-700/50"}),n.jsx("div",{className:"w-1/5"})]}),n.jsx("div",{className:"absolute bottom-full left-[58%] transform -translate-x-1/2 mb-1",children:n.jsx("div",{className:"w-1 h-3 bg-white mx-auto"})})]}),n.jsxs("div",{className:"flex justify-between text-xs text-gray-400",children:[n.jsx("span",{children:"0%"}),n.jsx("span",{children:"20%"}),n.jsx("span",{children:"40%"}),n.jsx("span",{children:"60%"}),n.jsx("span",{children:"80%"}),n.jsx("span",{children:"100%"})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-white",children:"Add-on Propensity Distribution"}),n.jsx("span",{className:"text-gray-400",children:"Mean: 45%"})]}),n.jsxs("div",{className:"h-8 rounded-md bg-gradient-to-r from-gray-500 via-purple-400 to-purple-600 relative",children:[n.jsxs("div",{className:"absolute inset-0 flex",children:[n.jsx("div",{className:"w-1/5 border-r border-gray-700/50"}),n.jsx("div",{className:"w-1/5 border-r border-gray-700/50"}),n.jsx("div",{className:"w-1/5 border-r border-gray-700/50"}),n.jsx("div",{className:"w-1/5 border-r border-gray-700/50"}),n.jsx("div",{className:"w-1/5"})]}),n.jsx("div",{className:"absolute bottom-full left-[45%] transform -translate-x-1/2 mb-1",children:n.jsx("div",{className:"w-1 h-3 bg-white mx-auto"})})]}),n.jsxs("div",{className:"flex justify-between text-xs text-gray-400",children:[n.jsx("span",{children:"0%"}),n.jsx("span",{children:"20%"}),n.jsx("span",{children:"40%"}),n.jsx("span",{children:"60%"}),n.jsx("span",{children:"80%"}),n.jsx("span",{children:"100%"})]})]})]})]})]})]})})]})]})]})})},uY=["#0088FE","#00C49F","#FFBB28","#FF8042","#8884d8","#82ca9d"],ER=[{id:"NBO001",name:"Premium 5G Upgrade",type:"Upsell",targetSegment:"High Value",conversionRate:8.2,revenueImpact:"High",priority:95,arpu:"+$15/mo",retention:"+18%"},{id:"NBO002",name:"Family Plan Bundle",type:"Cross-sell",targetSegment:"Medium Value",conversionRate:6.5,revenueImpact:"High",priority:88,arpu:"+$28/mo",retention:"+22%"},{id:"NBO003",name:"International Calling Pack",type:"Add-on",targetSegment:"High Value",conversionRate:7.8,revenueImpact:"Medium",priority:82,arpu:"+$10/mo",retention:"+8%"},{id:"NBO004",name:"Extended Data Bundle",type:"Upsell",targetSegment:"Medium Value",conversionRate:5.1,revenueImpact:"Medium",priority:78,arpu:"+$12/mo",retention:"+14%"},{id:"NBO005",name:"Premium Content Subscription",type:"Add-on",targetSegment:"All Segments",conversionRate:4.2,revenueImpact:"Medium",priority:75,arpu:"+$9/mo",retention:"+7%"},{id:"NBO006",name:"Loyalty Discount Bundle",type:"Retention",targetSegment:"At Risk",conversionRate:12.5,revenueImpact:"Low",priority:92,arpu:"-$5/mo",retention:"+35%"}],iut=[{id:"1001",name:"Alex Johnson",segment:"High Value",primaryOffer:"Premium 5G Upgrade",secondaryOffer:"International Calling Pack",churnRisk:"Low",lifetime:"$2,450",lastContact:"7 days ago"},{id:"1002",name:"Samantha Lee",segment:"High Value",primaryOffer:"Family Plan Bundle",secondaryOffer:"Premium Content Subscription",churnRisk:"Low",lifetime:"$3,200",lastContact:"14 days ago"},{id:"1003",name:"David Wilson",segment:"Medium Value",primaryOffer:"Extended Data Bundle",secondaryOffer:"Premium Content Subscription",churnRisk:"Medium",lifetime:"$1,850",lastContact:"5 days ago"},{id:"1004",name:"Mei Zhang",segment:"Low Value",primaryOffer:"Loyalty Discount Bundle",secondaryOffer:"Premium Content Subscription",churnRisk:"High",lifetime:"$780",lastContact:"3 days ago"},{id:"1005",name:"James Brown",segment:"New Customers",primaryOffer:"Extended Data Bundle",secondaryOffer:"Premium Content Subscription",churnRisk:"Medium",lifetime:"$950",lastContact:"1 day ago"}],sut=[{attribute:"Conversion",NBO001:82,NBO002:65,NBO003:78,fullmark:100},{attribute:"Revenue",NBO001:90,NBO002:85,NBO003:60,fullmark:100},{attribute:"Retention",NBO001:75,NBO002:88,NBO003:50,fullmark:100},{attribute:"Cost",NBO001:65,NBO002:55,NBO003:45,fullmark:100},{attribute:"Customer Satisfaction",NBO001:85,NBO002:80,NBO003:70,fullmark:100}],aut=[{channel:"SMS",efficacy:78,volume:52e4},{channel:"Email",efficacy:65,volume:78e4},{channel:"App Notification",efficacy:82,volume:62e4},{channel:"Call Center",efficacy:92,volume:18e4},{channel:"Web Portal",efficacy:58,volume:42e4}],out=()=>{const[e,t]=U.useState(ER[0]),[r,i]=U.useState("overview"),a=()=>{za({title:"Create New Offer",description:"Offer creation workflow started."})},l=()=>{za({title:"Simulation Started",description:"NBO engine simulation is running. Results will be available shortly."})},d=()=>{za({title:"Export Started",description:"NBO recommendations are being exported to CSV format."})};return n.jsx("div",{className:"space-y-6",children:n.jsxs(jt,{className:"shadow-lg border-gray-800/30 bg-beam-dark-accent/50 backdrop-blur-md",children:[n.jsx(wr,{className:"pb-2",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx(fr,{className:"text-xl text-white",children:"Next Best Offer Engine"}),n.jsx(Ii,{className:"text-gray-300",children:"Automated offer optimization and arbitration for personalized customer recommendations"})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs(lt,{className:"bg-beam-blue hover:bg-blue-600",onClick:a,children:[n.jsx($D,{size:16,className:"mr-1"}),"Create New Offer"]}),n.jsxs(lt,{variant:"outline",size:"sm",onClick:l,children:[n.jsx(Sh,{size:16,className:"mr-1"}),"Run Simulation"]})]})]})}),n.jsxs(Ht,{children:[n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-4 mb-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"text-sm text-gray-400 mb-1 block",children:"Offer Type"}),n.jsxs(_n,{defaultValue:"all",children:[n.jsx(xn,{className:"bg-beam-dark/70 border-gray-700",children:n.jsx(wn,{placeholder:"All Types"})}),n.jsxs(yn,{className:"bg-beam-dark border-gray-700",children:[n.jsx(yt,{value:"all",children:"All Types"}),n.jsx(yt,{value:"upsell",children:"Upsell"}),n.jsx(yt,{value:"cross-sell",children:"Cross-sell"}),n.jsx(yt,{value:"add-on",children:"Add-on"}),n.jsx(yt,{value:"retention",children:"Retention"})]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm text-gray-400 mb-1 block",children:"Target Segment"}),n.jsxs(_n,{defaultValue:"all",children:[n.jsx(xn,{className:"bg-beam-dark/70 border-gray-700",children:n.jsx(wn,{placeholder:"All Segments"})}),n.jsxs(yn,{className:"bg-beam-dark border-gray-700",children:[n.jsx(yt,{value:"all",children:"All Segments"}),n.jsx(yt,{value:"high",children:"High Value"}),n.jsx(yt,{value:"medium",children:"Medium Value"}),n.jsx(yt,{value:"low",children:"Low Value"}),n.jsx(yt,{value:"new",children:"New Customers"}),n.jsx(yt,{value:"risk",children:"At Risk"})]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm text-gray-400 mb-1 block",children:"Revenue Impact"}),n.jsxs(_n,{defaultValue:"all",children:[n.jsx(xn,{className:"bg-beam-dark/70 border-gray-700",children:n.jsx(wn,{placeholder:"All Impact Levels"})}),n.jsxs(yn,{className:"bg-beam-dark border-gray-700",children:[n.jsx(yt,{value:"all",children:"All Impact Levels"}),n.jsx(yt,{value:"high",children:"High Impact"}),n.jsx(yt,{value:"medium",children:"Medium Impact"}),n.jsx(yt,{value:"low",children:"Low Impact"})]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm text-gray-400 mb-1 block",children:"Priority"}),n.jsxs(_n,{defaultValue:"all",children:[n.jsx(xn,{className:"bg-beam-dark/70 border-gray-700",children:n.jsx(wn,{placeholder:"All Priorities"})}),n.jsxs(yn,{className:"bg-beam-dark border-gray-700",children:[n.jsx(yt,{value:"all",children:"All Priorities"}),n.jsx(yt,{value:"high",children:"High Priority (90+)"}),n.jsx(yt,{value:"medium",children:"Medium Priority (75-90)"}),n.jsx(yt,{value:"low",children:"Low Priority (Below 75)"})]})]})]})]}),n.jsxs("div",{className:"bg-beam-dark/70 p-4 rounded-lg border border-gray-700/30 mb-6",children:[n.jsx("h3",{className:"text-white font-medium mb-4",children:"Active Offer Catalog"}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs(Mc,{children:[n.jsx(Ic,{children:n.jsxs(Fs,{className:"border-gray-700",children:[n.jsx(Or,{className:"text-white",children:"ID"}),n.jsx(Or,{className:"text-white",children:"Offer Name"}),n.jsx(Or,{className:"text-white",children:"Type"}),n.jsx(Or,{className:"text-white",children:"Target Segment"}),n.jsx(Or,{className:"text-white",children:"Conversion"}),n.jsx(Or,{className:"text-white",children:"Revenue Impact"}),n.jsx(Or,{className:"text-white",children:"Priority Score"}),n.jsx(Or,{className:"text-white",children:"ARPU Change"}),n.jsx(Or,{className:"text-white",children:"Retention Effect"})]})}),n.jsx(Oc,{children:ER.map(s=>n.jsxs(Fs,{className:`border-gray-700 hover:bg-gray-800/30 cursor-pointer ${e.id===s.id?"bg-gray-800/50":""}`,onClick:()=>t(s),children:[n.jsx(Rr,{className:"text-white",children:s.id}),n.jsx(Rr,{className:"text-white font-medium",children:s.name}),n.jsx(Rr,{children:n.jsx(Tt,{className:`
                          ${s.type==="Upsell"?"bg-blue-900/30 text-blue-400 border-blue-600":s.type==="Cross-sell"?"bg-green-900/30 text-green-400 border-green-600":s.type==="Add-on"?"bg-purple-900/30 text-purple-400 border-purple-600":"bg-amber-900/30 text-amber-400 border-amber-600"}
                        `,children:s.type})}),n.jsx(Rr,{className:"text-white",children:s.targetSegment}),n.jsx(Rr,{children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("span",{className:"text-white",children:[s.conversionRate,"%"]}),n.jsx(vn,{value:s.conversionRate*8,className:"h-1.5 w-12"})]})}),n.jsx(Rr,{children:n.jsx(Tt,{className:`
                          ${s.revenueImpact==="High"?"bg-green-900/30 text-green-400 border-green-600":s.revenueImpact==="Medium"?"bg-blue-900/30 text-blue-400 border-blue-600":"bg-amber-900/30 text-amber-400 border-amber-600"}
                        `,children:s.revenueImpact})}),n.jsx(Rr,{children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-white",children:s.priority}),n.jsx(vn,{value:s.priority,className:"h-1.5 w-12",style:{background:"linear-gradient(90deg, rgba(239,68,68,0.2) 0%, rgba(234,179,8,0.2) 50%, rgba(34,197,94,0.2) 100%)"}})]})}),n.jsx(Rr,{className:`font-medium ${s.arpu.startsWith("+")?"text-green-400":"text-amber-400"}`,children:s.arpu}),n.jsx(Rr,{className:"text-green-400 font-medium",children:s.retention})]},s.id))})]})}),n.jsxs("div",{className:"flex justify-between mt-4",children:[n.jsxs(lt,{variant:"outline",size:"sm",onClick:a,children:[n.jsx(MF,{size:14,className:"mr-1"}),"Add New Offer"]}),n.jsxs(lt,{variant:"outline",size:"sm",onClick:d,children:[n.jsx(Nu,{size:14,className:"mr-1"}),"Export Catalog"]})]})]}),e&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsxs("h2",{className:"text-xl font-medium text-white flex items-center gap-2",children:[n.jsx($D,{size:18,className:"text-beam-blue"}),e.name]}),n.jsxs("p",{className:"text-gray-400",children:["Offer ID: ",e.id]})]}),n.jsx("div",{className:"flex gap-2",children:n.jsx($i,{value:r,onValueChange:i,className:"w-auto",children:n.jsxs(Di,{className:"bg-beam-dark/70 border border-gray-700/50",children:[n.jsx(Jt,{value:"overview",children:"Overview"}),n.jsx(Jt,{value:"comparison",children:"Comparison"}),n.jsx(Jt,{value:"channels",children:"Channels"})]})})})]}),n.jsx(ur,{value:"overview",className:"m-0",children:n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[n.jsxs("div",{className:"bg-beam-dark/70 p-4 rounded-lg border border-gray-700/30",children:[n.jsx("h3",{className:"text-white font-medium mb-4",children:"Offer Details"}),n.jsxs("dl",{className:"space-y-4",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("dt",{className:"text-gray-400",children:"Offer Type:"}),n.jsx("dd",{className:"font-medium text-white",children:e.type})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("dt",{className:"text-gray-400",children:"Target Segment:"}),n.jsx("dd",{className:"font-medium text-white",children:e.targetSegment})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("dt",{className:"text-gray-400",children:"Conversion Rate:"}),n.jsxs("dd",{className:"font-medium text-white",children:[e.conversionRate,"%"]})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("dt",{className:"text-gray-400",children:"ARPU Change:"}),n.jsx("dd",{className:`font-medium ${e.arpu.startsWith("+")?"text-green-400":"text-amber-400"}`,children:e.arpu})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("dt",{className:"text-gray-400",children:"Retention Effect:"}),n.jsx("dd",{className:"font-medium text-green-400",children:e.retention})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("dt",{className:"text-gray-400",children:"Priority Score:"}),n.jsxs("dd",{className:"font-medium text-white",children:[e.priority,"/100"]})]})]})]}),n.jsxs("div",{className:"lg:col-span-2 bg-beam-dark/70 p-4 rounded-lg border border-gray-700/30",children:[n.jsx("h3",{className:"text-white font-medium mb-4",children:"Performance By Segment"}),n.jsx(ms,{width:"100%",height:350,children:n.jsxs(nc,{data:[{segment:"High Value",conversion:e.id==="NBO001"?9.2:e.id==="NBO003"?8.4:7.5},{segment:"Medium Value",conversion:e.id==="NBO002"?8.5:e.id==="NBO004"?7.2:5.8},{segment:"Low Value",conversion:e.id==="NBO006"?7.4:4.2},{segment:"New Customers",conversion:e.id==="NBO005"?6.8:5.4},{segment:"At Risk",conversion:e.id==="NBO006"?14.5:6.2}],margin:{top:20,right:30,left:20,bottom:40},children:[n.jsx($s,{strokeDasharray:"3 3",stroke:"#444"}),n.jsx(is,{dataKey:"segment",stroke:"#aaa",angle:-45,textAnchor:"end",height:60}),n.jsx(Gi,{stroke:"#aaa",label:{value:"Conversion Rate (%)",angle:-90,position:"insideLeft",style:{fill:"#aaa"}}}),n.jsx(yi,{contentStyle:{backgroundColor:"#1e1e2d",borderColor:"#444",color:"#fff"}}),n.jsx(pi,{dataKey:"conversion",name:"Conversion Rate (%)",fill:"#0088FE"})]})})]}),n.jsxs("div",{className:"lg:col-span-3 bg-beam-dark/70 p-4 rounded-lg border border-gray-700/30",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-white font-medium",children:"Customer Recommendations"}),n.jsxs(lt,{variant:"outline",size:"sm",children:[n.jsx(fm,{size:14,className:"mr-1"}),"Filter"]})]}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs(Mc,{children:[n.jsx(Ic,{children:n.jsxs(Fs,{className:"border-gray-700",children:[n.jsx(Or,{className:"text-white",children:"ID"}),n.jsx(Or,{className:"text-white",children:"Customer Name"}),n.jsx(Or,{className:"text-white",children:"Segment"}),n.jsx(Or,{className:"text-white",children:"Churn Risk"}),n.jsx(Or,{className:"text-white",children:"Primary Offer"}),n.jsx(Or,{className:"text-white",children:"Secondary Offer"}),n.jsx(Or,{className:"text-white",children:"Lifetime Value"}),n.jsx(Or,{className:"text-white",children:"Last Contact"}),n.jsx(Or,{className:"text-white",children:"Action"})]})}),n.jsx(Oc,{children:iut.map(s=>n.jsxs(Fs,{className:"border-gray-700 hover:bg-gray-800/30",children:[n.jsx(Rr,{className:"text-white",children:s.id}),n.jsx(Rr,{className:"text-white font-medium",children:s.name}),n.jsx(Rr,{children:n.jsx(Tt,{className:`
                                  ${s.segment==="High Value"?"bg-green-900/30 text-green-400 border-green-600":s.segment==="Medium Value"?"bg-blue-900/30 text-blue-400 border-blue-600":s.segment==="Low Value"?"bg-amber-900/30 text-amber-400 border-amber-600":"bg-purple-900/30 text-purple-400 border-purple-600"}
                                `,children:s.segment})}),n.jsx(Rr,{children:n.jsx(Tt,{className:`
                                  ${s.churnRisk==="Low"?"bg-green-900/30 text-green-400 border-green-600":s.churnRisk==="Medium"?"bg-amber-900/30 text-amber-400 border-amber-600":"bg-red-900/30 text-red-400 border-red-600"}
                                `,children:s.churnRisk})}),n.jsx(Rr,{children:n.jsx(Tt,{variant:"outline",className:"border-blue-600/30 text-blue-400 font-normal",children:s.primaryOffer})}),n.jsx(Rr,{children:n.jsx(Tt,{variant:"outline",className:"border-gray-600/30 text-gray-400 font-normal",children:s.secondaryOffer})}),n.jsx(Rr,{className:"text-white",children:s.lifetime}),n.jsx(Rr,{className:"text-gray-400",children:s.lastContact}),n.jsx(Rr,{children:n.jsx(lt,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:n.jsx(ng,{size:14})})})]},s.id))})]})}),n.jsxs("div",{className:"flex justify-between mt-4",children:[n.jsx("div",{className:"text-sm text-gray-400",children:"Showing 5 of 12,500 recommendations"}),n.jsxs(lt,{variant:"outline",size:"sm",onClick:d,children:[n.jsx(Nu,{size:14,className:"mr-1"}),"Export Recommendations"]})]})]})]})}),n.jsx(ur,{value:"comparison",className:"m-0",children:n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"bg-beam-dark/70 p-4 rounded-lg border border-gray-700/30",children:[n.jsx("h3",{className:"text-white font-medium mb-4",children:"Offer Comparison"}),n.jsx(ms,{width:"100%",height:400,children:n.jsxs(Fae,{outerRadius:150,data:sut,children:[n.jsx(p6,{stroke:"#444"}),n.jsx(Tx,{dataKey:"attribute",stroke:"#aaa"}),n.jsx(Ax,{angle:30,domain:[0,100],stroke:"#aaa"}),n.jsx(zp,{name:"Premium 5G Upgrade",dataKey:"NBO001",stroke:"#0088FE",fill:"#0088FE",fillOpacity:.2}),n.jsx(zp,{name:"Family Plan Bundle",dataKey:"NBO002",stroke:"#00C49F",fill:"#00C49F",fillOpacity:.2}),n.jsx(zp,{name:"International Calling Pack",dataKey:"NBO003",stroke:"#FFBB28",fill:"#FFBB28",fillOpacity:.2}),n.jsx(xa,{}),n.jsx(yi,{contentStyle:{backgroundColor:"#1e1e2d",borderColor:"#444",color:"#fff"}})]})})]}),n.jsxs("div",{className:"bg-beam-dark/70 p-4 rounded-lg border border-gray-700/30",children:[n.jsx("h3",{className:"text-white font-medium mb-4",children:"Offer Priority Ranking"}),n.jsx(ms,{width:"100%",height:400,children:n.jsxs(nc,{layout:"vertical",data:[{name:"Premium 5G Upgrade",value:95},{name:"Loyalty Discount Bundle",value:92},{name:"Family Plan Bundle",value:88},{name:"International Calling Pack",value:82},{name:"Extended Data Bundle",value:78},{name:"Premium Content Subscription",value:75}],margin:{top:20,right:30,left:120,bottom:20},children:[n.jsx($s,{strokeDasharray:"3 3",stroke:"#444",horizontal:!1}),n.jsx(is,{type:"number",stroke:"#aaa",domain:[70,100]}),n.jsx(Gi,{dataKey:"name",type:"category",stroke:"#aaa",width:110}),n.jsx(yi,{contentStyle:{backgroundColor:"#1e1e2d",borderColor:"#444",color:"#fff"},formatter:s=>[`${s} priority score`,""]}),n.jsx(pi,{dataKey:"value",name:"Priority Score",fill:"#0088FE",children:ER.map((s,p)=>n.jsx(jd,{fill:uY[p%uY.length]},`cell-${p}`))})]})})]}),n.jsxs("div",{className:"lg:col-span-2 bg-beam-dark/70 p-4 rounded-lg border border-gray-700/30",children:[n.jsx("h3",{className:"text-white font-medium mb-4",children:"NBO Engine Arbitration Logic"}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"p-3 bg-blue-900/10 border border-blue-600/20 rounded-lg",children:[n.jsx("h4",{className:"text-white font-medium mb-1",children:"Customer Profile Analysis"}),n.jsx("p",{className:"text-gray-300 text-sm",children:"The NBO engine first analyzes the complete customer profile, including service history, usage patterns, payment behavior, and demographics. This information is combined with propensity model scores to determine customer needs and preferences."})]}),n.jsxs("div",{className:"p-3 bg-green-900/10 border border-green-600/20 rounded-lg",children:[n.jsx("h4",{className:"text-white font-medium mb-1",children:"Objective Function"}),n.jsx("p",{className:"text-gray-300 text-sm",children:"Recommendations are prioritized based on a weighted objective function that considers revenue impact (40%), conversion likelihood (30%), retention effect (20%), and strategic alignment (10%). This ensures that offers maximize both customer value and business outcomes."})]}),n.jsxs("div",{className:"p-3 bg-purple-900/10 border border-purple-600/20 rounded-lg",children:[n.jsx("h4",{className:"text-white font-medium mb-1",children:"Contextual Relevance"}),n.jsx("p",{className:"text-gray-300 text-sm",children:"The system evaluates the timing and context for each offer. For example, international calling packages are prioritized for customers who recently made international calls, while family plans are suggested for customers with multiple lines."})]}),n.jsxs("div",{className:"p-3 bg-amber-900/10 border border-amber-600/20 rounded-lg",children:[n.jsx("h4",{className:"text-white font-medium mb-1",children:"Fallback Logic"}),n.jsx("p",{className:"text-gray-300 text-sm",children:"If a customer has declined primary offers multiple times, the system automatically switches to alternative categories. For customers with high churn risk, retention offers take precedence over upsell recommendations regardless of potential revenue."})]})]})]})]})}),n.jsx(ur,{value:"channels",className:"m-0",children:n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[n.jsxs("div",{className:"lg:col-span-2 bg-beam-dark/70 p-4 rounded-lg border border-gray-700/30",children:[n.jsx("h3",{className:"text-white font-medium mb-4",children:"Channel Performance for Offers"}),n.jsx(ms,{width:"100%",height:350,children:n.jsxs(nc,{data:aut,margin:{top:20,right:30,left:20,bottom:20},children:[n.jsx($s,{strokeDasharray:"3 3",stroke:"#444"}),n.jsx(is,{dataKey:"channel",stroke:"#aaa"}),n.jsx(Gi,{yAxisId:"left",orientation:"left",stroke:"#0088FE",label:{value:"Efficacy (%)",angle:-90,position:"insideLeft",style:{fill:"#0088FE"}}}),n.jsx(Gi,{yAxisId:"right",orientation:"right",stroke:"#FFBB28",label:{value:"Volume",angle:90,position:"insideRight",style:{fill:"#FFBB28"}}}),n.jsx(yi,{contentStyle:{backgroundColor:"#1e1e2d",borderColor:"#444",color:"#fff"}}),n.jsx(xa,{}),n.jsx(pi,{yAxisId:"left",dataKey:"efficacy",name:"Response Rate (%)",fill:"#0088FE"}),n.jsx(pi,{yAxisId:"right",dataKey:"volume",name:"Volume",fill:"#FFBB28"})]})})]}),n.jsxs("div",{className:"bg-beam-dark/70 p-4 rounded-lg border border-gray-700/30",children:[n.jsx("h3",{className:"text-white font-medium mb-4",children:"Optimal Channel Mix"}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("dl",{className:"space-y-3",children:[n.jsxs("div",{children:[n.jsx("dt",{className:"text-white font-medium mb-1",children:"Primary Channel"}),n.jsxs("dd",{className:"text-gray-300 flex items-center gap-2",children:[n.jsx(Tt,{className:"bg-green-900/30 text-green-400 border-green-600",children:"Call Center"}),n.jsx("span",{className:"text-sm",children:"92% efficacy"})]})]}),n.jsxs("div",{children:[n.jsx("dt",{className:"text-white font-medium mb-1",children:"Secondary Channel"}),n.jsxs("dd",{className:"text-gray-300 flex items-center gap-2",children:[n.jsx(Tt,{className:"bg-blue-900/30 text-blue-400 border-blue-600",children:"App Notification"}),n.jsx("span",{className:"text-sm",children:"82% efficacy"})]})]}),n.jsxs("div",{children:[n.jsx("dt",{className:"text-white font-medium mb-1",children:"Tertiary Channel"}),n.jsxs("dd",{className:"text-gray-300 flex items-center gap-2",children:[n.jsx(Tt,{className:"bg-purple-900/30 text-purple-400 border-purple-600",children:"SMS"}),n.jsx("span",{className:"text-sm",children:"78% efficacy"})]})]})]}),n.jsxs("div",{className:"pt-3 border-t border-gray-700/30",children:[n.jsx("h4",{className:"text-white font-medium mb-2",children:"Channel Strategy"}),n.jsxs("ul",{className:"space-y-2 text-sm text-gray-300",children:[n.jsxs("li",{className:"flex items-start gap-2",children:[n.jsx("div",{className:"mt-1 h-2 w-2 rounded-full bg-green-400 flex-shrink-0"}),n.jsx("span",{children:"Use call center for high-value customers and premium offers"})]}),n.jsxs("li",{className:"flex items-start gap-2",children:[n.jsx("div",{className:"mt-1 h-2 w-2 rounded-full bg-blue-400 flex-shrink-0"}),n.jsx("span",{children:"App notifications for tech-savvy users and immediate offers"})]}),n.jsxs("li",{className:"flex items-start gap-2",children:[n.jsx("div",{className:"mt-1 h-2 w-2 rounded-full bg-purple-400 flex-shrink-0"}),n.jsx("span",{children:"SMS for time-sensitive and location-based promotions"})]}),n.jsxs("li",{className:"flex items-start gap-2",children:[n.jsx("div",{className:"mt-1 h-2 w-2 rounded-full bg-amber-400 flex-shrink-0"}),n.jsx("span",{children:"Email for detailed offers with supporting information"})]})]})]})]})]}),n.jsxs("div",{className:"lg:col-span-3 bg-beam-dark/70 p-4 rounded-lg border border-gray-700/30",children:[n.jsx("h3",{className:"text-white font-medium mb-4",children:"Multi-channel Campaign Design"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[n.jsxs("div",{className:"p-3 bg-gray-800/40 rounded-lg border border-gray-700/30",children:[n.jsxs("h4",{className:"text-white font-medium mb-2 flex items-center gap-2",children:[n.jsx(Tt,{children:"1"}),"Initial Contact"]}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[n.jsx(Tt,{className:"bg-blue-900/30 text-blue-400 border-blue-600",children:"App Notification"}),n.jsx("span",{className:"text-gray-300",children:"Initial awareness"})]}),n.jsx("p",{className:"text-xs text-gray-400",children:"Personalized app notification based on recent customer activity, highlighting key offer benefits."}),n.jsx("div",{className:"pt-2 border-t border-gray-700/30 text-xs text-gray-400",children:"Timing: Day 1"})]})]}),n.jsxs("div",{className:"p-3 bg-gray-800/40 rounded-lg border border-gray-700/30",children:[n.jsxs("h4",{className:"text-white font-medium mb-2 flex items-center gap-2",children:[n.jsx(Tt,{children:"2"}),"Detailed Information"]}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[n.jsx(Tt,{className:"bg-purple-900/30 text-purple-400 border-purple-600",children:"Email"}),n.jsx("span",{className:"text-gray-300",children:"Feature details"})]}),n.jsx("p",{className:"text-xs text-gray-400",children:"Comprehensive email with complete offer details, personalized savings calculator, and testimonials."}),n.jsx("div",{className:"pt-2 border-t border-gray-700/30 text-xs text-gray-400",children:"Timing: Day 2 (morning)"})]})]}),n.jsxs("div",{className:"p-3 bg-gray-800/40 rounded-lg border border-gray-700/30",children:[n.jsxs("h4",{className:"text-white font-medium mb-2 flex items-center gap-2",children:[n.jsx(Tt,{children:"3"}),"Reminder"]}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[n.jsx(Tt,{className:"bg-amber-900/30 text-amber-400 border-amber-600",children:"SMS"}),n.jsx("span",{className:"text-gray-300",children:"Quick reminder"})]}),n.jsx("p",{className:"text-xs text-gray-400",children:"Brief SMS with limited-time offer reminder and direct activation link or code."}),n.jsx("div",{className:"pt-2 border-t border-gray-700/30 text-xs text-gray-400",children:"Timing: Day 3 (afternoon)"})]})]}),n.jsxs("div",{className:"p-3 bg-gray-800/40 rounded-lg border border-gray-700/30",children:[n.jsxs("h4",{className:"text-white font-medium mb-2 flex items-center gap-2",children:[n.jsx(Tt,{children:"4"}),"Direct Engagement"]}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[n.jsx(Tt,{className:"bg-green-900/30 text-green-400 border-green-600",children:"Call Center"}),n.jsx("span",{className:"text-gray-300",children:"Personal discussion"})]}),n.jsx("p",{className:"text-xs text-gray-400",children:"Targeted outbound call to high-value customers who showed interest but haven't converted."}),n.jsx("div",{className:"pt-2 border-t border-gray-700/30 text-xs text-gray-400",children:"Timing: Day 5 (for selected customers)"})]})]}),n.jsxs("div",{className:"p-3 bg-gray-800/40 rounded-lg border border-gray-700/30",children:[n.jsxs("h4",{className:"text-white font-medium mb-2 flex items-center gap-2",children:[n.jsx(Tt,{children:"5"}),"Final Opportunity"]}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[n.jsx(Tt,{className:"bg-red-900/30 text-red-400 border-red-600",children:"Multi-channel"}),n.jsx("span",{className:"text-gray-300",children:"Last chance"})]}),n.jsx("p",{className:"text-xs text-gray-400",children:"Final reminder through primary channel with enhanced offer value for 24-hour limited time."}),n.jsx("div",{className:"pt-2 border-t border-gray-700/30 text-xs text-gray-400",children:"Timing: Day 7 (offer expiry)"})]})]}),n.jsxs("div",{className:"p-3 bg-gray-800/40 rounded-lg border border-gray-700/30",children:[n.jsxs("h4",{className:"text-white font-medium mb-2 flex items-center gap-2",children:[n.jsx(Tt,{children:"6"}),"Analysis & Optimization"]}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[n.jsx(Tt,{className:"bg-gray-900/30 text-gray-400 border-gray-600",children:"Internal"}),n.jsx("span",{className:"text-gray-300",children:"Performance review"})]}),n.jsx("p",{className:"text-xs text-gray-400",children:"Campaign performance analysis and optimization for future campaigns based on channel efficacy."}),n.jsx("div",{className:"pt-2 border-t border-gray-700/30 text-xs text-gray-400",children:"Timing: Day 10-14"})]})]})]}),n.jsx("div",{className:"mt-4 flex justify-end",children:n.jsxs(lt,{variant:"outline",size:"sm",children:[n.jsx(Nh,{size:14,className:"mr-1"}),"Campaign Template"]})})]})]})})]})]})]})})},lut=({node:e,isHovered:t,nodeType:r,nodeSize:i,onMouseEnter:a,onMouseLeave:l,onClick:d})=>{var L,B,V;const[s,p]=U.useState(!1),x=e.id.startsWith("lineage-"),w=e.id==="lineage-1"||e.id==="lineage-3",j=e.operations&&e.operations.length>0,S=$=>{switch($){case"Database":return n.jsx(ln,{size:16});case"Wrench":return n.jsx(Vc,{size:16});case"GitMerge":return n.jsx(PQ,{size:16});case"FileText":return n.jsx(Nh,{size:16});default:return n.jsx(ln,{size:16})}},P=$=>{$.stopPropagation(),p(!s)},F=i.height+(((L=e.operations)==null?void 0:L.length)||0)*25+10;return n.jsx(XF,{children:n.jsxs(DE,{children:[n.jsx(zE,{asChild:!0,children:n.jsx("div",{className:`absolute rounded-lg p-2 cursor-pointer transition-all duration-300 border-[1.5px] backdrop-blur-sm ${t?"border-white/50 shadow-[0_0_15px_rgba(255,255,255,0.2)]":"border-gray-600/40 hover:border-white/30"}`,style:{left:e.position.x,top:e.position.y,width:i.width,height:s&&j?F:i.height,backgroundColor:`${r.color}20`,zIndex:t?20:10,transition:"height 0.3s ease-in-out"},onMouseEnter:a,onMouseLeave:l,onClick:d,children:n.jsxs("div",{className:"flex flex-col h-full justify-between",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center shadow-sm",style:{backgroundColor:r.color},children:S(r.icon)}),n.jsx("span",{className:"text-xs font-medium text-white truncate",children:e.label}),j&&n.jsx("button",{className:"ml-auto text-gray-300 hover:text-white transition-colors p-0.5",onClick:P,children:s?n.jsx(x2,{size:14}):n.jsx(Na,{size:14})})]}),n.jsx("div",{className:"text-[10px] text-gray-300 line-clamp-2 mt-1",children:e.content}),s&&j&&n.jsx("div",{className:"mt-3 pt-2 border-t border-white/10 space-y-2 overflow-y-auto max-h-40",children:(B=e.operations)==null?void 0:B.map(($,G)=>n.jsxs("div",{className:"text-[10px] bg-black/20 rounded p-1",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"font-medium text-white",children:$.name}),$.executionTime&&n.jsxs("span",{className:"text-[8px] text-gray-400 flex items-center",children:[n.jsx($a,{size:8,className:"mr-0.5"})," ",$.executionTime]})]}),n.jsx("p",{className:"text-gray-300 mt-0.5",children:$.description})]},G))}),x&&n.jsxs("div",{className:"flex items-center text-[9px] border-t border-white/10 pt-1 mt-1",children:[n.jsx(_s,{size:8,className:`${w?"text-amber-300":"text-blue-300"} mr-0.5`}),n.jsx("span",{className:w?"text-amber-300":"text-blue-300",children:w?"Guardrail":"Chat"})]})]})})}),n.jsxs(GN,{side:"top",className:"max-w-xs bg-gray-900/90 border-gray-700",children:[n.jsx("div",{className:"text-sm font-medium text-white",children:e.label}),n.jsx("div",{className:"text-xs text-gray-300 mt-1 max-w-xs break-words",children:e.content}),n.jsx("div",{className:"text-xs text-blue-300 mt-1",children:e.type.replace("_"," ")}),j&&n.jsxs("div",{className:"text-xs text-green-300 mt-1",children:[(V=e.operations)==null?void 0:V.length," operations"]}),x&&n.jsx("div",{className:"text-xs text-blue-300 mt-1",children:"Click to view conversation history"}),w&&n.jsx("div",{className:"text-xs text-amber-300 mt-1",children:"Guardrail was activated"})]})]})})},cut=({edge:e,nodes:t,hoveredNode:r,nodeSize:i})=>{const a=iit(e,t,r,i);if(!a)return null;const l=e.type==="dependency"?{strokeDasharray:"5,5"}:e.type==="transformation"?{strokeWidth:a.isHighlighted?"3":"2"}:{};return n.jsx("path",{d:a.pathD,fill:"none",stroke:a.isHighlighted?"#4F8FFF":"#666666",strokeWidth:a.isHighlighted?"2.5":"1.5",strokeDasharray:e.type==="dependency"?"5,5":"none",className:"transition-all duration-200",markerEnd:a.isHighlighted?"url(#arrowhead-lineage-highlight)":"url(#arrowhead-lineage)",style:{filter:a.isHighlighted?"drop-shadow(0 0 2px rgba(79, 143, 255, 0.5))":"none",...l}},`${e.source}-${e.target}`)},uut=()=>n.jsxs("defs",{children:[n.jsx("marker",{id:"arrowhead-lineage",markerWidth:"10",markerHeight:"7",refX:"5",refY:"3.5",orient:"auto",children:n.jsx("polygon",{points:"0 0, 10 3.5, 0 7",fill:"#666666"})}),n.jsx("marker",{id:"arrowhead-lineage-highlight",markerWidth:"10",markerHeight:"7",refX:"5",refY:"3.5",orient:"auto",children:n.jsx("polygon",{points:"0 0, 10 3.5, 0 7",fill:"#3B82F6"})}),n.jsx("marker",{id:"arrowhead",markerWidth:"10",markerHeight:"7",refX:"5",refY:"3.5",orient:"auto",children:n.jsx("polygon",{points:"0 0, 10 3.5, 0 7",fill:"#666666"})}),n.jsx("marker",{id:"arrowhead-highlight",markerWidth:"10",markerHeight:"7",refX:"5",refY:"3.5",orient:"auto",children:n.jsx("polygon",{points:"0 0, 10 3.5, 0 7",fill:"#FFFFFF"})}),n.jsx("marker",{id:"arrowhead-purple",markerWidth:"10",markerHeight:"7",refX:"5",refY:"3.5",orient:"auto",children:n.jsx("polygon",{points:"0 0, 10 3.5, 0 7",fill:"#9C6EFF"})})]}),dut=()=>n.jsxs("div",{className:"absolute bottom-2 right-2 bg-gray-900/80 backdrop-blur-sm rounded-lg p-3 text-xs text-gray-300 flex flex-wrap items-center gap-3 border border-gray-700/40 shadow-lg",children:[n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"w-3 h-3 rounded-full bg-[#8B5CF6] mr-1.5"}),n.jsx("span",{children:"Data Source"})]}),n.jsxs("div",{className:"flex items-center ml-2",children:[n.jsx("div",{className:"w-3 h-3 rounded-full bg-[#10B981] mr-1.5"}),n.jsx("span",{children:"Transformation"})]}),n.jsxs("div",{className:"flex items-center ml-2",children:[n.jsx("div",{className:"w-3 h-3 rounded-full bg-[#3B82F6] mr-1.5"}),n.jsx("span",{children:"Aggregation"})]}),n.jsxs("div",{className:"flex items-center ml-2",children:[n.jsx("div",{className:"w-3 h-3 rounded-full bg-[#EC4899] mr-1.5"}),n.jsx("span",{children:"Output"})]})]}),hut=({nodeCount:e})=>{const t=Math.floor(e/3),r=e-t;return n.jsxs("div",{className:"absolute top-2 left-2 z-10 flex items-center space-x-2",children:[n.jsxs("div",{className:"flex items-center gap-1.5 px-2 py-1 bg-purple-900/40 rounded-md border border-purple-500/30",children:[n.jsx(ln,{size:12,className:"text-purple-400"}),n.jsxs("span",{className:"text-xs text-purple-300",children:[t," Source",t!==1?"s":""]})]}),n.jsxs("div",{className:"flex items-center gap-1.5 px-2 py-1 bg-green-900/40 rounded-md border border-green-500/30",children:[n.jsx(PQ,{size:12,className:"text-green-400"}),n.jsxs("span",{className:"text-xs text-green-300",children:[r," Transformation",r!==1?"s":""]})]})]})},mut=({nodes:e,edges:t,metadata:r,onNodeClick:i})=>{const[a,l]=U.useState(null),d=s=>{i&&i(s)};return n.jsxs("div",{className:"w-full h-full overflow-hidden relative",style:{minHeight:r.height+"px"},children:[n.jsx(hut,{nodeCount:e.length}),n.jsxs("svg",{width:"100%",height:"100%",style:{position:"absolute",top:0,left:0,zIndex:1,pointerEvents:"none"},viewBox:`0 0 ${r.width} ${r.height}`,preserveAspectRatio:"xMinYMin meet",children:[n.jsx(uut,{}),t.map(s=>n.jsx(cut,{edge:s,nodes:e,hoveredNode:a,nodeSize:r.nodeSize},`${s.source}-${s.target}-${Math.random().toString(36).substring(7)}`))]}),e.map(s=>{const p=r.nodeTypes[s.type]||{color:"#3B82F6",icon:"Database"},x=a===s.id;return n.jsx(lut,{node:s,isHovered:x,nodeType:p,nodeSize:r.nodeSize,onMouseEnter:()=>l(s.id),onMouseLeave:()=>l(null),onClick:()=>d(s.id)},s.id)}),n.jsx(dut,{})]})},MR=[{id:"customer",name:"Customer Data",description:"Subscriber profiles, demographics, and account information",icon:$N},{id:"network",name:"Network Data",description:"Network performance, coverage, and quality metrics",icon:Ov},{id:"device",name:"Device Data",description:"Device types, capabilities, and usage patterns",icon:Vp},{id:"service",name:"Service Data",description:"Service subscriptions, usage, and billing information",icon:eo},{id:"temporal",name:"Temporal Data",description:"Historical usage patterns and time-series data",icon:$a},{id:"security",name:"Security Data",description:"Authentication, authorization, and compliance data",icon:dn}],fut=[{id:"DS1001",name:"Subscriber Profiles DB",type:"Database",description:"PostgreSQL database containing subscriber profiles and demographics",category:"customer",owner:"Data Governance Team",accessLevel:"Restricted",lastUpdated:"2023-11-15",refreshFrequency:"Daily",status:"Active",quality:"High",schema:[{name:"subscriber_id",type:"INT",description:"Unique subscriber identifier"},{name:"name",type:"VARCHAR",description:"Subscriber name"},{name:"age",type:"INT",description:"Subscriber age"},{name:"location",type:"VARCHAR",description:"Subscriber location"}],preview:[{subscriber_id:1001,name:"Alice Smith",age:32,location:"New York"},{subscriber_id:1002,name:"Bob Johnson",age:45,location:"Los Angeles"}],lineage:!0,metrics:[{name:"Record Count",value:5e6,unit:"records"},{name:"Average Age",value:38.5,unit:"years"}]},{id:"DS1002",name:"Network Performance API",type:"API",description:"REST API providing real-time network performance metrics",category:"network",owner:"Network Operations",accessLevel:"Public",lastUpdated:"2023-11-18",refreshFrequency:"Real-time",status:"Active",quality:"Medium",schema:[{name:"timestamp",type:"TIMESTAMP",description:"Timestamp of the metric"},{name:"cell_id",type:"VARCHAR",description:"Cell identifier"},{name:"latency",type:"FLOAT",description:"Network latency in ms"},{name:"throughput",type:"FLOAT",description:"Network throughput in Mbps"}],preview:[{timestamp:"2023-11-18 10:00:00",cell_id:"CELL001",latency:25.6,throughput:45.2},{timestamp:"2023-11-18 10:00:05",cell_id:"CELL002",latency:30.1,throughput:50.5}],lineage:!0,metrics:[{name:"Average Latency",value:28.3,unit:"ms"},{name:"Average Throughput",value:47.8,unit:"Mbps"}]},{id:"DS1003",name:"Device Usage Logs",type:"File",description:"S3 bucket containing device usage logs in CSV format",category:"device",owner:"Device Management",accessLevel:"Restricted",lastUpdated:"2023-11-10",refreshFrequency:"Weekly",status:"Maintenance",quality:"Low",schema:[{name:"device_id",type:"VARCHAR",description:"Device identifier"},{name:"user_id",type:"INT",description:"User identifier"},{name:"app_name",type:"VARCHAR",description:"Application name"},{name:"usage_duration",type:"INT",description:"Usage duration in seconds"}],preview:[{device_id:"DEVICE001",user_id:2001,app_name:"Facebook",usage_duration:3600},{device_id:"DEVICE002",user_id:2002,app_name:"YouTube",usage_duration:7200}],lineage:!1,metrics:[{name:"Total Usage Duration",value:15e5,unit:"hours"},{name:"Most Used App",value:"YouTube",unit:null}]},{id:"DS1004",name:"Service Subscription Data",type:"Database",description:"MySQL database containing service subscription details",category:"service",owner:"Service Management",accessLevel:"Confidential",lastUpdated:"2023-11-20",refreshFrequency:"Daily",status:"Active",quality:"High",schema:[{name:"subscription_id",type:"INT",description:"Subscription identifier"},{name:"user_id",type:"INT",description:"User identifier"},{name:"service_name",type:"VARCHAR",description:"Service name"},{name:"start_date",type:"DATE",description:"Subscription start date"},{name:"end_date",type:"DATE",description:"Subscription end date"}],preview:[{subscription_id:3001,user_id:1001,service_name:"Premium Plan",start_date:"2023-01-01",end_date:"2023-12-31"},{subscription_id:3002,user_id:1002,service_name:"Basic Plan",start_date:"2023-02-15",end_date:"2024-02-15"}],lineage:!0,metrics:[{name:"Total Subscriptions",value:12e5,unit:"subscriptions"},{name:"Churn Rate",value:.05,unit:"rate"}]},{id:"DS1005",name:"Customer Call Records",type:"File",description:"CSV files containing customer call records",category:"temporal",owner:"Customer Service",accessLevel:"Restricted",lastUpdated:"2023-11-22",refreshFrequency:"Daily",status:"Active",quality:"Medium",schema:[{name:"call_id",type:"VARCHAR",description:"Call identifier"},{name:"caller_id",type:"VARCHAR",description:"Caller identifier"},{name:"receiver_id",type:"VARCHAR",description:"Receiver identifier"},{name:"call_duration",type:"INT",description:"Call duration in seconds"},{name:"call_timestamp",type:"TIMESTAMP",description:"Call timestamp"}],preview:[{call_id:"CALL001",caller_id:"USER001",receiver_id:"AGENT001",call_duration:120,call_timestamp:"2023-11-22 09:00:00"},{call_id:"CALL002",caller_id:"USER002",receiver_id:"AGENT002",call_duration:300,call_timestamp:"2023-11-22 10:30:00"}],lineage:!1,metrics:[{name:"Total Calls",value:5e4,unit:"calls"},{name:"Average Call Duration",value:180,unit:"seconds"}]},{id:"DS1006",name:"Security Event Logs",type:"Stream",description:"Kafka stream containing security event logs",category:"security",owner:"Security Operations",accessLevel:"Sensitive",lastUpdated:"2023-11-21",refreshFrequency:"Real-time",status:"Active",quality:"High",schema:[{name:"event_id",type:"VARCHAR",description:"Event identifier"},{name:"event_type",type:"VARCHAR",description:"Event type"},{name:"timestamp",type:"TIMESTAMP",description:"Event timestamp"},{name:"source_ip",type:"VARCHAR",description:"Source IP address"},{name:"destination_ip",type:"VARCHAR",description:"Destination IP address"}],preview:[{event_id:"EVT001",event_type:"Login Failure",timestamp:"2023-11-21 14:00:00",source_ip:"192.168.1.100",destination_ip:"10.0.0.1"},{event_id:"EVT002",event_type:"Firewall Block",timestamp:"2023-11-21 14:00:05",source_ip:"192.168.1.101",destination_ip:"10.0.0.2"}],lineage:!0,metrics:[{name:"Total Events",value:1e6,unit:"events"},{name:"Failed Login Attempts",value:5e3,unit:"attempts"}]}],put=()=>{var $;const[e,t]=U.useState(fut),[r,i]=U.useState(null),[a,l]=U.useState("schema"),[d,s]=U.useState(!1),[p,x]=U.useState({key:"name",direction:"asc"}),w=hx({defaultValues:{sourceName:"",sourceType:"api",category:"customer",accessLevel:"restricted"}}),j=G=>{const W={id:`DS${Math.floor(Math.random()*1e4)}`,name:G.sourceName,type:G.sourceType,description:"Custom data source",category:G.category,owner:"User",accessLevel:G.accessLevel,lastUpdated:new Date().toLocaleDateString(),refreshFrequency:"Manual",status:"Active",quality:"Medium"};t([...e,W]),s(!1),za({title:"Data Source Added",description:"New data source has been successfully added."})},S=()=>{za({title:"Refreshing Connections",description:"Data source connections are being refreshed. Please wait."})},P=G=>{const W=MR.find(Z=>Z.id===G);return(W==null?void 0:W.icon)||ln},F=[...e].sort((G,W)=>p.key?p.direction==="asc"?G[p.key].localeCompare(W[p.key]):W[p.key].localeCompare(G[p.key]):0),L=[{id:"node1",type:"source",label:"Source Data",content:"Customer Data",position:{x:50,y:100},operations:[{name:"Extract",description:"Extract data from source",status:"success",executionTime:"120ms"}]},{id:"node2",type:"transform",label:"Data Processing",content:"Transform and clean",position:{x:300,y:100},operations:[{name:"Transform",description:"Apply transformations",status:"success",executionTime:"85ms"}]},{id:"node3",type:"destination",label:"Data Warehouse",content:"Stored Data",position:{x:550,y:100},operations:[{name:"Load",description:"Load into warehouse",status:"success",executionTime:"150ms"}]}],B=[{source:"node1",target:"node2",type:"dataflow"},{source:"node2",target:"node3",type:"dataflow"}],V={width:800,height:400,nodeSize:{width:180,height:100},nodeTypes:{source:{color:"#3B82F6",icon:"Database"},transform:{color:"#10B981",icon:"RefreshCw"},destination:{color:"#8B5CF6",icon:"HardDrive"}}};return n.jsx("div",{className:"space-y-6",children:n.jsxs(jt,{className:"shadow-lg border-gray-800/30 bg-beam-dark-accent/50 backdrop-blur-md",children:[n.jsx(wr,{className:"pb-2",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx(fr,{className:"text-xl text-white",children:"Data Sources Management"}),n.jsx(Ii,{className:"text-gray-300",children:"Connect, manage, and monitor all your telecom data sources"})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs(Ml,{children:[n.jsx(F_,{asChild:!0,children:n.jsxs(lt,{className:"bg-beam-blue hover:bg-blue-600",children:[n.jsx(MF,{size:16,className:"mr-1"}),"New Connection"]})}),n.jsxs(Qo,{className:"bg-beam-dark border-gray-700 text-white max-w-2xl",children:[n.jsxs(el,{children:[n.jsx(tl,{children:"Add New Data Source"}),n.jsx(fg,{className:"text-gray-400",children:"Connect to a new data source or create a custom connector"})]}),n.jsx(t_,{...w,children:n.jsxs("form",{onSubmit:w.handleSubmit(j),className:"space-y-6",children:[n.jsx(Li,{control:w.control,name:"sourceName",render:({field:G})=>n.jsxs(Ei,{children:[n.jsx(Mi,{className:"text-white",children:"Source Name"}),n.jsx(Fi,{children:n.jsx(An,{placeholder:"Enter a name for this data source",className:"bg-beam-dark/70 border-gray-600",...G})}),n.jsx(Wl,{className:"text-gray-500",children:"This name will be used to identify the data source in the system."})]})}),n.jsx(Li,{control:w.control,name:"sourceType",render:({field:G})=>n.jsxs(Ei,{children:[n.jsx(Mi,{className:"text-white",children:"Source Type"}),n.jsx(Fi,{children:n.jsxs(_n,{onValueChange:G.onChange,defaultValue:G.value,children:[n.jsx(xn,{className:"bg-beam-dark/70 border-gray-600",children:n.jsx(wn,{placeholder:"Select source type"})}),n.jsxs(yn,{className:"bg-beam-dark border-gray-700",children:[n.jsx(yt,{value:"api",children:"API"}),n.jsx(yt,{value:"database",children:"Database"}),n.jsx(yt,{value:"file",children:"File Storage"}),n.jsx(yt,{value:"stream",children:"Data Stream"}),n.jsx(yt,{value:"custom",children:"Custom Connector"})]})]})}),n.jsx(Wl,{className:"text-gray-500",children:"The type of data source you want to connect to."})]})}),n.jsx(Li,{control:w.control,name:"category",render:({field:G})=>n.jsxs(Ei,{children:[n.jsx(Mi,{className:"text-white",children:"Category"}),n.jsx(Fi,{children:n.jsxs(_n,{onValueChange:G.onChange,defaultValue:G.value,children:[n.jsx(xn,{className:"bg-beam-dark/70 border-gray-600",children:n.jsx(wn,{placeholder:"Select category"})}),n.jsx(yn,{className:"bg-beam-dark border-gray-700",children:MR.map(W=>n.jsx(yt,{value:W.id,children:W.name},W.id))})]})}),n.jsx(Wl,{className:"text-gray-500",children:"The category this data source belongs to."})]})}),n.jsx(Li,{control:w.control,name:"accessLevel",render:({field:G})=>n.jsxs(Ei,{children:[n.jsx(Mi,{className:"text-white",children:"Access Level"}),n.jsx(Fi,{children:n.jsxs(_n,{onValueChange:G.onChange,defaultValue:G.value,children:[n.jsx(xn,{className:"bg-beam-dark/70 border-gray-600",children:n.jsx(wn,{placeholder:"Select access level"})}),n.jsxs(yn,{className:"bg-beam-dark border-gray-700",children:[n.jsx(yt,{value:"public",children:"Public"}),n.jsx(yt,{value:"restricted",children:"Restricted"}),n.jsx(yt,{value:"confidential",children:"Confidential"}),n.jsx(yt,{value:"sensitive",children:"Sensitive"})]})]})}),n.jsx(Wl,{className:"text-gray-500",children:"This determines who can access this data source."})]})}),n.jsx(mg,{children:n.jsx(lt,{type:"submit",className:"bg-beam-blue hover:bg-blue-600",children:"Add Data Source"})})]})})]})]}),n.jsxs(lt,{variant:"outline",onClick:S,children:[n.jsx(jve,{size:16,className:"mr-2"}),"Refresh"]})]})]})}),n.jsxs(Ht,{children:[n.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[n.jsx("div",{className:"bg-beam-dark/70 p-4 rounded-lg border border-gray-700/30",children:n.jsxs("div",{className:"flex items-start justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-gray-400 text-sm",children:"Total Data Sources"}),n.jsx("h3",{className:"text-2xl font-semibold text-white mt-1",children:e.length})]}),n.jsx("div",{className:"p-2 bg-blue-900/30 rounded-full text-blue-400",children:n.jsx(ln,{size:18})})]})}),n.jsx("div",{className:"bg-beam-dark/70 p-4 rounded-lg border border-gray-700/30",children:n.jsxs("div",{className:"flex items-start justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-gray-400 text-sm",children:"User Profile Sources"}),n.jsx("h3",{className:"text-2xl font-semibold text-white mt-1",children:"12"})]}),n.jsx("div",{className:"p-2 bg-green-900/30 rounded-full text-green-400",children:n.jsx($N,{size:18})})]})}),n.jsx("div",{className:"bg-beam-dark/70 p-4 rounded-lg border border-gray-700/30",children:n.jsxs("div",{className:"flex items-start justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-gray-400 text-sm",children:"Real-time Feeds"}),n.jsx("h3",{className:"text-2xl font-semibold text-white mt-1",children:"8"})]}),n.jsx("div",{className:"p-2 bg-amber-900/30 rounded-full text-amber-400",children:n.jsx($a,{size:18})})]})}),n.jsx("div",{className:"bg-beam-dark/70 p-4 rounded-lg border border-gray-700/30",children:n.jsxs("div",{className:"flex items-start justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-gray-400 text-sm",children:"Protected Sources"}),n.jsx("h3",{className:"text-2xl font-semibold text-white mt-1",children:"27"})]}),n.jsx("div",{className:"p-2 bg-purple-900/30 rounded-full text-purple-400",children:n.jsx(dn,{size:18})})]})})]}),n.jsxs("div",{className:"bg-beam-dark/70 p-4 rounded-lg border border-gray-700/30 mb-6",children:[n.jsxs("div",{className:"flex justify-between items-center mb-4",children:[n.jsx("h3",{className:"text-white font-medium",children:"Available Data Sources"}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("div",{className:"relative",children:[n.jsx($c,{className:"absolute left-3 top-2.5 h-4 w-4 text-gray-500"}),n.jsx(An,{placeholder:"Search data sources...",className:"pl-10 bg-beam-dark/70 border-gray-600 w-64"})]}),n.jsx(lt,{variant:"outline",size:"icon",className:"h-10 w-10",children:n.jsx(fm,{size:16})})]})]}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs(Mc,{children:[n.jsx(Ic,{children:n.jsxs(Fs,{className:"border-gray-700",children:[n.jsx(Or,{className:"text-white",children:"Name"}),n.jsx(Or,{className:"text-white",children:"Category"}),n.jsx(Or,{className:"text-white",children:"Type"}),n.jsx(Or,{className:"text-white",children:"Owner"}),n.jsx(Or,{className:"text-white",children:"Last Updated"}),n.jsx(Or,{className:"text-white",children:"Quality"}),n.jsx(Or,{className:"text-white",children:"Status"}),n.jsx(Or,{className:"text-white",children:"Access"}),n.jsx(Or,{className:"text-white"})]})}),n.jsx(Oc,{children:F.map(G=>{const W=P(G.category),Z=MR.find(se=>se.id===G.category);return n.jsxs(Fs,{className:`border-gray-700 hover:bg-gray-800/30 cursor-pointer ${(r==null?void 0:r.id)===G.id?"bg-gray-800/50":""}`,onClick:()=>i(G),children:[n.jsx(Rr,{children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:`p-1.5 rounded-full ${G.category==="customer"?"bg-green-900/30 text-green-400":G.category==="network"?"bg-blue-900/30 text-blue-400":G.category==="device"?"bg-amber-900/30 text-amber-400":G.category==="service"?"bg-purple-900/30 text-purple-400":G.category==="temporal"?"bg-pink-900/30 text-pink-400":"bg-slate-900/30 text-slate-400"}`,children:n.jsx(W,{size:14})}),n.jsx("span",{className:"font-medium text-white",children:G.name})]})}),n.jsx(Rr,{className:"text-gray-300",children:(Z==null?void 0:Z.name)||G.category}),n.jsx(Rr,{children:n.jsx(Tt,{className:`
                            ${G.type==="API"?"bg-blue-900/30 text-blue-400 border-blue-600":G.type==="Database"?"bg-green-900/30 text-green-400 border-green-600":G.type==="File"?"bg-amber-900/30 text-amber-400 border-amber-600":"bg-purple-900/30 text-purple-400 border-purple-600"}
                          `,children:G.type})}),n.jsx(Rr,{className:"text-gray-300",children:G.owner}),n.jsx(Rr,{className:"text-gray-300",children:G.lastUpdated}),n.jsx(Rr,{children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(vn,{value:G.quality==="High"?90:G.quality==="Medium"?65:35,className:"h-1.5 w-16"}),n.jsx("span",{className:`text-xs font-medium ${G.quality==="High"?"text-green-400":G.quality==="Medium"?"text-amber-400":"text-red-400"}`,children:G.quality})]})}),n.jsx(Rr,{children:n.jsx(Tt,{className:G.status==="Active"?"bg-green-900/30 text-green-400 border-green-600":G.status==="Maintenance"?"bg-amber-900/30 text-amber-400 border-amber-600":"bg-red-900/30 text-red-400 border-red-600",children:G.status})}),n.jsx(Rr,{children:n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(NE,{size:14,className:G.accessLevel==="Public"?"text-green-400":G.accessLevel==="Restricted"?"text-amber-400":G.accessLevel==="Confidential"?"text-orange-400":"text-red-400"}),n.jsx("span",{className:"text-gray-300",children:G.accessLevel})]})}),n.jsx(Rr,{children:n.jsx(lt,{variant:"ghost",size:"sm",className:"h-8 px-2",children:n.jsx(mh,{size:14})})})]},G.id)})})]})})]}),r&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:`p-2 rounded-full ${r.category==="customer"?"bg-green-900/30 text-green-400":r.category==="network"?"bg-blue-900/30 text-blue-400":r.category==="device"?"bg-amber-900/30 text-amber-400":r.category==="service"?"bg-purple-900/30 text-purple-400":r.category==="temporal"?"bg-pink-900/30 text-pink-400":"bg-slate-900/30 text-slate-400"}`,children:(()=>{const G=P(r.category);return n.jsx(G,{size:18})})()}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl font-medium text-white",children:r.name}),n.jsx("p",{className:"text-gray-400",children:r.description})]})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx($i,{value:a,onValueChange:G=>l(G),className:"w-auto",children:n.jsxs(Di,{className:"bg-beam-dark/70 border border-gray-700/50",children:[n.jsx(Jt,{value:"schema",children:"Schema"}),n.jsx(Jt,{value:"preview",children:"Preview"}),n.jsx(Jt,{value:"lineage",children:"Lineage"}),n.jsx(Jt,{value:"metrics",children:"Metrics"})]})}),n.jsxs(lt,{variant:"outline",size:"sm",children:[n.jsx(ws,{size:14,className:"mr-1"}),"Configure"]})]})]}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-4",children:[n.jsxs("div",{className:"bg-beam-dark/70 p-4 rounded-lg border border-gray-700/30",children:[n.jsx("h3",{className:"text-white font-medium mb-3",children:"Security Details"}),n.jsxs("dl",{className:"space-y-3",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("dt",{className:"text-gray-400",children:"Access Level"}),n.jsxs("dd",{className:"text-white flex items-center gap-1",children:[n.jsx(dn,{size:14,className:r.accessLevel==="Public"?"text-green-400":r.accessLevel==="Restricted"?"text-amber-400":r.accessLevel==="Confidential"?"text-orange-400":"text-red-400"}),r.accessLevel]})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("dt",{className:"text-gray-400",children:"Owner"}),n.jsx("dd",{className:"text-white",children:r.owner})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("dt",{className:"text-gray-400",children:"Last Updated"}),n.jsx("dd",{className:"text-white",children:r.lastUpdated})]})]})]}),n.jsxs("div",{className:"bg-beam-dark/70 p-4 rounded-lg border border-gray-700/30",children:[n.jsx("h3",{className:"text-white font-medium mb-3",children:"Connection Details"}),n.jsxs("dl",{className:"space-y-3",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("dt",{className:"text-gray-400",children:"Type"}),n.jsxs("dd",{className:"text-white flex items-center gap-1",children:[n.jsx(Vp,{size:14}),r.type]})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("dt",{className:"text-gray-400",children:"Status"}),n.jsx("dd",{className:"text-white",children:n.jsx(Tt,{className:r.status==="Active"?"bg-green-900/30 text-green-400 border-green-600":r.status==="Maintenance"?"bg-amber-900/30 text-amber-400 border-amber-600":"bg-red-900/30 text-red-400 border-red-600",children:r.status})})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("dt",{className:"text-gray-400",children:"Refresh"}),n.jsx("dd",{className:"text-white",children:r.refreshFrequency})]})]})]}),n.jsxs("div",{className:"bg-beam-dark/70 p-4 rounded-lg border border-gray-700/30",children:[n.jsx("h3",{className:"text-white font-medium mb-3",children:"Quality Metrics"}),n.jsxs("dl",{className:"space-y-3",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("dt",{className:"text-gray-400",children:"Overall Quality"}),n.jsx("dd",{className:"text-white",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(vn,{value:r.quality==="High"?90:r.quality==="Medium"?65:35,className:"h-1.5 w-16"}),n.jsx("span",{className:`text-xs font-medium ${r.quality==="High"?"text-green-400":r.quality==="Medium"?"text-amber-400":"text-red-400"}`,children:r.quality})]})})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("dt",{className:"text-gray-400",children:"Completeness"}),n.jsx("dd",{className:"text-white",children:n.jsx(vn,{value:75,className:"h-1.5 w-16"})})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("dt",{className:"text-gray-400",children:"Accuracy"}),n.jsx("dd",{className:"text-white",children:n.jsx(vn,{value:85,className:"h-1.5 w-16"})})]})]})]}),n.jsxs("div",{className:"bg-beam-dark/70 p-4 rounded-lg border border-gray-700/30",children:[n.jsx("h3",{className:"text-white font-medium mb-3",children:"Usage Stats"}),n.jsxs("dl",{className:"space-y-3",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("dt",{className:"text-gray-400",children:"Services Using"}),n.jsx("dd",{className:"text-white",children:"8"})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("dt",{className:"text-gray-400",children:"Last Accessed"}),n.jsx("dd",{className:"text-white",children:"Today"})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("dt",{className:"text-gray-400",children:"Query Count"}),n.jsx("dd",{className:"text-white",children:"1,204"})]})]})]})]}),n.jsx(ur,{value:"schema",className:"pt-3",children:n.jsxs("div",{className:"bg-beam-dark/70 p-4 rounded-lg border border-gray-700/30",children:[n.jsxs("div",{className:"flex justify-between items-center mb-4",children:[n.jsx("h3",{className:"text-white font-medium",children:"Schema Definition"}),n.jsx("div",{className:"flex gap-2",children:n.jsxs(lt,{variant:"outline",size:"sm",children:[n.jsx(kQ,{size:14,className:"mr-1"}),"Export DDL"]})})]}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs(Mc,{children:[n.jsx(Ic,{children:n.jsxs(Fs,{className:"border-gray-700",children:[n.jsx(Or,{className:"text-white",children:"Field Name"}),n.jsx(Or,{className:"text-white",children:"Type"}),n.jsx(Or,{className:"text-white",children:"Description"})]})}),n.jsx(Oc,{children:($=r.schema)==null?void 0:$.map((G,W)=>n.jsxs(Fs,{className:"border-gray-700",children:[n.jsx(Rr,{className:"font-medium text-white",children:G.name}),n.jsx(Rr,{children:n.jsx(Tt,{className:"bg-blue-900/30 text-blue-400 border-blue-600",children:G.type})}),n.jsx(Rr,{className:"text-gray-300",children:G.description})]},W))})]})})]})}),n.jsx(ur,{value:"preview",className:"pt-3",children:n.jsxs("div",{className:"bg-beam-dark/70 p-4 rounded-lg border border-gray-700/30",children:[n.jsxs("div",{className:"flex justify-between items-center mb-4",children:[n.jsx("h3",{className:"text-white font-medium",children:"Data Preview"}),n.jsx("div",{className:"flex gap-2",children:n.jsxs(lt,{variant:"outline",size:"sm",children:[n.jsx(Nh,{size:14,className:"mr-1"}),"Export CSV"]})})]}),r.preview&&r.preview.length>0?n.jsx("div",{className:"overflow-x-auto",children:n.jsxs(Mc,{children:[n.jsx(Ic,{children:n.jsx(Fs,{className:"border-gray-700",children:Object.keys(r.preview[0]).map(G=>n.jsx(Or,{className:"text-white",children:G},G))})}),n.jsx(Oc,{children:r.preview.map((G,W)=>n.jsx(Fs,{className:"border-gray-700",children:Object.values(G).map((Z,se)=>n.jsx(Rr,{className:"text-gray-300",children:String(Z)},se))},W))})]})}):n.jsx("div",{className:"text-center py-8 text-gray-400",children:"No preview data available for this source"})]})}),n.jsx(ur,{value:"lineage",className:"pt-3",children:n.jsxs("div",{className:"bg-beam-dark/70 p-4 rounded-lg border border-gray-700/30",children:[n.jsxs("div",{className:"flex justify-between items-center mb-4",children:[n.jsx("h3",{className:"text-white font-medium",children:"Data Lineage"}),n.jsx("div",{className:"flex gap-2",children:n.jsxs(lt,{variant:"outline",size:"sm",children:[n.jsx(FQ,{size:14,className:"mr-1"}),"Export Diagram"]})})]}),r.lineage?n.jsx("div",{className:"bg-gray-900/50 border border-gray-700/50 rounded-lg p-4 min-h-[400px]",children:n.jsx(mut,{nodes:L,edges:B,metadata:V})}):n.jsx("div",{className:"text-center py-8 text-gray-400",children:"No lineage information available for this source"})]})}),n.jsx(ur,{value:"metrics",className:"pt-3",children:n.jsxs("div",{className:"bg-beam-dark/70 p-4 rounded-lg border border-gray-700/30",children:[n.jsxs("div",{className:"flex justify-between items-center mb-4",children:[n.jsx("h3",{className:"text-white font-medium",children:"Data Metrics"}),n.jsx("div",{className:"flex gap-2",children:n.jsxs(lt,{variant:"outline",size:"sm",children:[n.jsx(Bc,{size:14,className:"mr-1"}),"Generate Report"]})})]}),r.metrics&&r.metrics.length>0?n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:r.metrics.map((G,W)=>n.jsxs("div",{className:"bg-gray-900/50 border border-gray-700/50 rounded-lg p-4",children:[n.jsx("h4",{className:"text-gray-300 mb-1",children:G.name}),n.jsxs("div",{className:"flex items-end gap-2",children:[n.jsx("span",{className:"text-2xl font-semibold text-white",children:G.value}),G.unit&&n.jsx("span",{className:"text-gray-400 text-sm",children:G.unit})]})]},W))}):n.jsx("div",{className:"text-center py-8 text-gray-400",children:"No metrics available for this source"})]})})]})]})]})})},ghe=()=>{const[e,t]=U.useState(null),[r,i]=U.useState([]),[a,l]=U.useState([]);U.useState("all");const[d,s]=U.useState(!1),{toast:p}=Ah();U.useEffect(()=>{l([{agentId:"cvm-journey",agentName:"Customer Journey Mapper",decision:"Prioritize email touchpoints for high-value customers",confidence:.87,reasoning:"Analysis shows 73% higher conversion rates through email vs SMS for customers with CLV > $2000",impact:"high",data_sources:["CRM","Transaction History","Behavioral Analytics"]},{agentId:"cvm-churn",agentName:"Churn Prevention Agent",decision:"Implement retention campaign for at-risk premium customers",confidence:.92,reasoning:"Detected early churn signals in 156 premium customers with declining engagement",impact:"high",data_sources:["Usage Patterns","Support Interactions","Payment History"]},{agentId:"cvm-nba",agentName:"Next Best Action Agent",decision:"Cross-sell mobile insurance to family plan subscribers",confidence:.78,reasoning:"Family plan users show 45% higher propensity for insurance products",impact:"medium",data_sources:["Subscription Data","Demographic Info","Purchase History"]}])},[]);const x=B=>{s(!0);const V={id:`sim_${Date.now()}`,type:B,status:"running",progress:0,insights:[],metrics:{},reasoning:"",recommendations:[],timestamp:new Date};i(G=>[V,...G]),t(V.id);const $=setInterval(()=>{i(G=>G.map(W=>{if(W.id===V.id&&W.status==="running"){const Z=Math.min(W.progress+Math.random()*20,100);return Z>=100?(clearInterval($),s(!1),p({title:`${B} Simulation Complete`,description:"Analysis ready for review"}),{...W,status:"completed",progress:100,insights:w(B),metrics:j(B),reasoning:S(B),recommendations:P(B)}):{...W,progress:Z}}return W}))},500);return()=>clearInterval($)},w=B=>({campaign:["Email campaigns show 34% higher ROI than SMS for premium customers","Weekend campaigns have 23% lower engagement rates","Personalized offers increase conversion by 45%"],profitability:["High-value customers generate 67% of total revenue from 23% of customer base","Customer acquisition cost has increased 18% YoY","Retention campaigns show 3.2x ROI compared to acquisition"],churn:["Support ticket volume is the strongest churn predictor (87% accuracy)","Customers with declining usage show 4.3x higher churn probability","Proactive retention reduces churn by 42% when applied early"]})[B]||[],j=B=>({campaign:{potential_revenue:"$2.4M",expected_conversion:"12.3%",target_audience:"45,600",roi:"320%"},profitability:{total_clv:"$156M",avg_clv:"$2,840",profitability_score:"78%",cost_per_acquisition:"$145"},churn:{at_risk_customers:"2,340",churn_probability:"23%",retention_opportunity:"$890K",prevention_cost:"$67K"}})[B]||{},S=B=>({campaign:"Multi-agent analysis combining customer journey mapping, CLV prediction, and behavioral analytics indicates email campaigns targeting high-value segments during weekdays with personalized offers will maximize ROI.",profitability:"Revenue optimization agent identified that focusing retention efforts on top 25% of customers while optimizing acquisition channels for similar profiles will improve overall profitability by 23%.",churn:"Churn prevention agent analyzed 18 months of customer data using ensemble models and identified early warning signals that allow intervention 60 days before typical churn events."})[B]||"",P=B=>({campaign:["Launch personalized email campaign targeting customers with CLV > $2000","Implement dynamic content based on customer journey stage","A/B test subject lines focusing on value proposition vs urgency"],profitability:["Increase investment in retention campaigns by 35%","Implement tiered service levels based on customer value","Optimize acquisition spend toward lookalike audiences of high-value customers"],churn:["Deploy proactive retention campaign for identified at-risk customers","Implement real-time monitoring for early churn signals","Create specialized retention offers for premium customer segment"]})[B]||[],F=B=>{switch(B){case"running":return"bg-yellow-500";case"completed":return"bg-green-500";case"failed":return"bg-red-500";default:return"bg-gray-500"}},L=B=>{switch(B){case"high":return"bg-red-500";case"medium":return"bg-yellow-500";case"low":return"bg-green-500";default:return"bg-gray-500"}};return n.jsxs("div",{className:"w-full space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("h2",{className:"text-2xl font-bold bg-gradient-to-r from-white to-white/70 bg-clip-text text-transparent",children:"CVM Agentic Decisioning"}),n.jsx("p",{className:"text-white/60 mt-1",children:"AI-powered decision intelligence for customer value optimization"})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs(lt,{variant:"outline",size:"sm",className:"border-white/20 text-white hover:bg-white/10",children:[n.jsx(fm,{className:"w-4 h-4 mr-2"}),"Filters"]}),n.jsxs(lt,{variant:"outline",size:"sm",className:"border-white/20 text-white hover:bg-white/10",children:[n.jsx(Nu,{className:"w-4 h-4 mr-2"}),"Export"]})]})]}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[n.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[n.jsxs(jt,{className:"bg-white/5 border-white/10",children:[n.jsx(wr,{children:n.jsxs(fr,{className:"text-white flex items-center gap-2",children:[n.jsx(ti,{className:"w-5 h-5"}),"Simulation Center"]})}),n.jsx(Ht,{children:n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[n.jsxs(lt,{onClick:()=>x("campaign"),disabled:d,className:"h-20 flex flex-col items-center justify-center gap-2 bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800",children:[n.jsx(Ch,{className:"w-6 h-6"}),n.jsx("span",{className:"text-sm",children:"Campaign Simulation"})]}),n.jsxs(lt,{onClick:()=>x("profitability"),disabled:d,className:"h-20 flex flex-col items-center justify-center gap-2 bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800",children:[n.jsx(sc,{className:"w-6 h-6"}),n.jsx("span",{className:"text-sm",children:"Profitability Analysis"})]}),n.jsxs(lt,{onClick:()=>x("churn"),disabled:d,className:"h-20 flex flex-col items-center justify-center gap-2 bg-gradient-to-r from-red-600 to-red-700 hover:from-red-700 hover:to-red-800",children:[n.jsx(tx,{className:"w-6 h-6"}),n.jsx("span",{className:"text-sm",children:"Churn Analysis"})]})]})})]}),n.jsxs(jt,{className:"bg-white/5 border-white/10",children:[n.jsx(wr,{children:n.jsxs(fr,{className:"text-white flex items-center gap-2",children:[n.jsx(to,{className:"w-5 h-5"}),"Active Simulations"]})}),n.jsx(Ht,{children:n.jsx(Cl,{className:"h-80",children:r.length===0?n.jsxs("div",{className:"text-center text-white/60 py-8",children:[n.jsx(ti,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),n.jsx("p",{children:"No simulations running. Start a new analysis above."})]}):n.jsx("div",{className:"space-y-4",children:r.map(B=>n.jsxs("div",{className:`p-4 rounded-lg border cursor-pointer transition-all ${e===B.id?"border-blue-500 bg-blue-500/10":"border-white/10 bg-white/5 hover:bg-white/10"}`,onClick:()=>t(B.id),children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:`w-3 h-3 rounded-full ${F(B.status)}`}),n.jsxs("span",{className:"text-white font-medium capitalize",children:[B.type," Analysis"]})]}),n.jsx(Tt,{variant:"outline",className:"border-white/20 text-white/80",children:B.status})]}),B.status==="running"&&n.jsxs("div",{className:"mb-2",children:[n.jsx("div",{className:"w-full bg-white/10 rounded-full h-2",children:n.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-blue-600 h-2 rounded-full transition-all duration-500",style:{width:`${B.progress}%`}})}),n.jsxs("p",{className:"text-xs text-white/60 mt-1",children:[Math.round(B.progress),"% complete"]})]}),B.status==="completed"&&B.insights.length>0&&n.jsxs("div",{className:"mt-3 space-y-2",children:[n.jsx("p",{className:"text-sm text-white/80",children:"Key Insights:"}),B.insights.slice(0,2).map((V,$)=>n.jsxs("p",{className:"text-xs text-white/60",children:["• ",V]},$))]})]},B.id))})})})]})]}),n.jsxs("div",{className:"space-y-6",children:[n.jsxs(jt,{className:"bg-white/5 border-white/10",children:[n.jsx(wr,{children:n.jsxs(fr,{className:"text-white flex items-center gap-2",children:[n.jsx(Yi,{className:"w-5 h-5"}),"Live Agent Decisions"]})}),n.jsx(Ht,{children:n.jsx(Cl,{className:"h-80",children:n.jsx("div",{className:"space-y-4",children:a.map((B,V)=>n.jsxs("div",{className:"p-3 rounded-lg bg-white/5 border border-white/10",children:[n.jsxs("div",{className:"flex items-start justify-between mb-2",children:[n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"text-sm font-medium text-white",children:B.agentName}),n.jsx("p",{className:"text-xs text-white/60 mt-1",children:B.decision})]}),n.jsxs("div",{className:"flex flex-col items-end gap-1",children:[n.jsx(Tt,{className:`${L(B.impact)} text-white text-xs`,children:B.impact}),n.jsxs("span",{className:"text-xs text-white/60",children:[Math.round(B.confidence*100),"%"]})]})]}),n.jsx(Da,{className:"my-2 bg-white/10"}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs(lt,{variant:"ghost",size:"sm",className:"w-full justify-start text-white/80 hover:bg-white/10 h-8",children:[n.jsx(_s,{className:"w-3 h-3 mr-2"}),"View Reasoning"]}),n.jsx("div",{className:"flex gap-1",children:B.data_sources.map(($,G)=>n.jsx(Tt,{variant:"outline",className:"text-xs border-white/20 text-white/60",children:$},G))})]})]},V))})})})]}),n.jsxs(jt,{className:"bg-white/5 border-white/10",children:[n.jsx(wr,{children:n.jsxs(fr,{className:"text-white flex items-center gap-2",children:[n.jsx(mh,{className:"w-5 h-5"}),"Real-time Metrics"]})}),n.jsx(Ht,{children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("span",{className:"text-white/80 text-sm",children:"Active Campaigns"}),n.jsx("span",{className:"text-white font-medium",children:"12"})]}),n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("span",{className:"text-white/80 text-sm",children:"Avg CLV"}),n.jsx("span",{className:"text-white font-medium",children:"$2,840"})]}),n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("span",{className:"text-white/80 text-sm",children:"Churn Risk"}),n.jsx("span",{className:"text-red-400 font-medium",children:"2.3%"})]}),n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("span",{className:"text-white/80 text-sm",children:"Revenue Impact"}),n.jsx("span",{className:"text-green-400 font-medium",children:"+$1.2M"})]})]})})]})]})]}),e&&n.jsxs(jt,{className:"bg-white/5 border-white/10",children:[n.jsx(wr,{children:n.jsx(fr,{className:"text-white",children:"Simulation Results & Reasoning"})}),n.jsx(Ht,{children:n.jsxs($i,{defaultValue:"results",className:"w-full",children:[n.jsxs(Di,{className:"grid grid-cols-3 mb-4 bg-white/10",children:[n.jsx(Jt,{value:"results",className:"text-white data-[state=active]:bg-white/20",children:"Results"}),n.jsx(Jt,{value:"reasoning",className:"text-white data-[state=active]:bg-white/20",children:"AI Reasoning"}),n.jsx(Jt,{value:"recommendations",className:"text-white data-[state=active]:bg-white/20",children:"Recommendations"})]}),n.jsx(ur,{value:"results",className:"space-y-4",children:(()=>{const B=r.find(V=>V.id===e);return!B||B.status!=="completed"?n.jsx("p",{className:"text-white/60",children:"Simulation in progress..."}):n.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:Object.entries(B.metrics).map(([V,$])=>n.jsxs("div",{className:"p-4 rounded-lg bg-white/5 border border-white/10",children:[n.jsx("p",{className:"text-xs text-white/60 uppercase tracking-wide",children:V.replace("_"," ")}),n.jsx("p",{className:"text-lg font-bold text-white mt-1",children:$})]},V))})})()}),n.jsx(ur,{value:"reasoning",className:"space-y-4",children:(()=>{const B=r.find(V=>V.id===e);return n.jsx("div",{className:"p-4 rounded-lg bg-white/5 border border-white/10",children:n.jsx("p",{className:"text-white/80 leading-relaxed",children:(B==null?void 0:B.reasoning)||"Analysis in progress..."})})})()}),n.jsx(ur,{value:"recommendations",className:"space-y-4",children:(()=>{const B=r.find(V=>V.id===e);return n.jsx("div",{className:"space-y-3",children:(B==null?void 0:B.recommendations.map((V,$)=>n.jsxs("div",{className:"p-4 rounded-lg bg-white/5 border border-white/10 flex items-start gap-3",children:[n.jsx("div",{className:"w-6 h-6 rounded-full bg-blue-500 flex items-center justify-center flex-shrink-0 mt-1",children:n.jsx("span",{className:"text-white text-sm font-medium",children:$+1})}),n.jsx("p",{className:"text-white/80",children:V})]},$)))||n.jsx("p",{className:"text-white/60",children:"Generating recommendations..."})})})()})]})})]})]})},gut=()=>{const[e,t]=U.useState("agents");Ah(),U.useEffect(()=>{const i=localStorage.getItem("cvm-active-tab");i&&t(i)},[]);const r=i=>{t(i),localStorage.setItem("cvm-active-tab",i)};return n.jsxs($i,{defaultValue:e,value:e,onValueChange:r,className:"w-full",children:[n.jsxs(Di,{className:"grid grid-cols-7 mb-6 bg-beam-dark-accent/40 border border-gray-700/50 rounded-xl p-1 gap-1",children:[n.jsxs(Jt,{value:"agents",className:"rounded-lg flex items-center gap-2 data-[state=active]:bg-beam-blue data-[state=active]:text-white data-[state=active]:shadow-md",children:[n.jsx(Hi,{size:18}),n.jsx("span",{className:"hidden md:inline font-medium",children:"Agents"})]}),n.jsxs(Jt,{value:"segmentation",className:"rounded-lg flex items-center gap-2 data-[state=active]:bg-beam-blue data-[state=active]:text-white data-[state=active]:shadow-md",children:[n.jsx(qi,{size:18}),n.jsx("span",{className:"hidden md:inline font-medium",children:"Segmentation"})]}),n.jsxs(Jt,{value:"campaign",className:"rounded-lg flex items-center gap-2 data-[state=active]:bg-beam-blue data-[state=active]:text-white data-[state=active]:shadow-md",children:[n.jsx(Co,{size:18}),n.jsx("span",{className:"hidden md:inline font-medium",children:"Campaign Analysis"})]}),n.jsxs(Jt,{value:"propensity",className:"rounded-lg flex items-center gap-2 data-[state=active]:bg-beam-blue data-[state=active]:text-white data-[state=active]:shadow-md",children:[n.jsx(En,{size:18}),n.jsx("span",{className:"hidden md:inline font-medium",children:"Propensity Models"})]}),n.jsxs(Jt,{value:"nbo",className:"rounded-lg flex items-center gap-2 data-[state=active]:bg-beam-blue data-[state=active]:text-white data-[state=active]:shadow-md",children:[n.jsx($D,{size:18}),n.jsx("span",{className:"hidden md:inline font-medium",children:"Next Best Offer"})]}),n.jsxs(Jt,{value:"datasources",className:"rounded-lg flex items-center gap-2 data-[state=active]:bg-beam-blue data-[state=active]:text-white data-[state=active]:shadow-md",children:[n.jsx(ln,{size:18}),n.jsx("span",{className:"hidden md:inline font-medium",children:"Data Sources"})]}),n.jsxs(Jt,{value:"decisioning",className:"rounded-lg flex items-center gap-2 data-[state=active]:bg-beam-blue data-[state=active]:text-white data-[state=active]:shadow-md",children:[n.jsx(ti,{size:18}),n.jsx("span",{className:"hidden md:inline font-medium",children:"AI Decisioning"})]})]}),n.jsx(ur,{value:"agents",className:"mt-0",children:n.jsx(dat,{})}),n.jsx(ur,{value:"segmentation",className:"mt-0",children:n.jsx(fat,{})}),n.jsx(ur,{value:"campaign",className:"mt-0",children:n.jsx(eut,{})}),n.jsx(ur,{value:"propensity",className:"mt-0",children:n.jsx(nut,{})}),n.jsx(ur,{value:"nbo",className:"mt-0",children:n.jsx(out,{})}),n.jsx(ur,{value:"datasources",className:"mt-0",children:n.jsx(put,{})}),n.jsx(ur,{value:"decisioning",className:"mt-0",children:n.jsx(ghe,{})})]})},xut=()=>{const{chatMode:e,setChatMode:t}=V_(),r=()=>{t(!e),za({title:e?"UI Navigation Mode":"Chat Mode",description:e?"Switched to traditional UI navigation":"Ask questions to navigate customer value data",duration:3e3})};return n.jsx(lt,{variant:"outline",size:"sm",onClick:r,className:"flex items-center gap-2 border-gray-700 text-white hover:bg-beam-dark-accent",children:e?n.jsxs(n.Fragment,{children:[n.jsx(sve,{size:16,className:"text-beam-blue"}),n.jsx("span",{children:"UI Mode"})]}):n.jsxs(n.Fragment,{children:[n.jsx(_s,{size:16,className:"text-beam-blue"}),n.jsx("span",{children:"Chat Mode"})]})})},yut=({onSubmit:e,isLoading:t})=>{const[r,i]=U.useState(""),a=l=>{l.preventDefault(),r.trim()&&(e(r.trim()),i(""))};return n.jsx("form",{onSubmit:a,className:"w-full",children:n.jsxs("div",{className:"relative",children:[n.jsx(po,{placeholder:"Ask about customer segments, campaigns...",value:r,onChange:l=>i(l.target.value),className:"resize-none min-h-[60px] max-h-[120px] bg-beam-dark-accent/30 border-beam-blue/40 focus:border-beam-blue/70 text-white pr-10",onKeyDown:l=>{l.key==="Enter"&&!l.shiftKey&&(l.preventDefault(),a(l))},disabled:t}),n.jsx(lt,{type:"submit",size:"icon",className:"absolute bottom-2 right-2 h-8 w-8 rounded-full bg-beam-blue hover:bg-beam-blue-dark",disabled:t||!r.trim(),children:t?n.jsx("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-white border-opacity-20 border-t-white"}):n.jsx(zF,{className:"h-4 w-4"})})]})})},vut=({message:e})=>{const{role:t,content:r,timestamp:i}=e;return n.jsx("div",{className:`flex ${t==="user"?"justify-end":"justify-start"}`,children:n.jsxs("div",{className:`max-w-[80%] p-3 rounded-lg ${t==="user"?"bg-beam-blue/20 border border-beam-blue/30":"bg-beam-dark-accent/50 border border-gray-700/50"}`,children:[n.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-400 mb-1",children:[t==="assistant"&&n.jsx(Hi,{className:"h-3 w-3 text-beam-blue"}),t==="user"?"You":"CVM Assistant",n.jsxs("span",{className:"opacity-50",children:["• ",i]})]}),n.jsx("p",{className:"text-sm text-white",children:r})]})})},xhe=({suggestions:e,onSelectSuggestion:t})=>{const i=e||["Show me high value customers","Which campaign has the best ROI?","Compare retention campaigns","What's our customer lifetime value?"];return n.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center p-4",children:[n.jsx("div",{className:"bg-beam-dark-accent/50 rounded-full p-3 mb-3",children:n.jsx(_s,{className:"h-6 w-6 text-beam-blue"})}),n.jsx("h3",{className:"text-white font-medium",children:"Ask CVM Assistant"}),n.jsx("p",{className:"text-gray-400 text-sm mt-2",children:"Ask questions about customer segments, campaigns, or analytics."}),n.jsx("div",{className:"grid grid-cols-1 gap-2 mt-4 w-full",children:i.map((a,l)=>n.jsx(lt,{variant:"outline",size:"sm",className:"justify-start text-left text-gray-300 hover:text-white border-gray-700 hover:bg-beam-dark-accent",onClick:()=>t(a),children:a},l))})]})},but=({onSelectSuggestion:e,suggestions:t})=>n.jsx(xhe,{onSelectSuggestion:e,suggestions:t}),_ut=()=>{const{setSelectedSegment:e,setSelectedCampaign:t}=N3(),{chatMessages:r,addChatMessage:i}=V_(),[a,l]=U.useState(!1),{toast:d}=Ah();return{chatMessages:r,isLoading:a,processQuery:async p=>{l(!0),i({role:"user",content:p});try{await new Promise(j=>setTimeout(j,1200));const x=p.toLowerCase();let w="I'm not sure how to help with that query. Try asking about customer segments, campaigns, or analytics.";x.includes("high value")||x.includes("premium")?(e("High Value"),w="I've selected the High Value customer segment for you. You can see the analysis in the dashboard."):x.includes("medium value")?(e("Medium Value"),w="I've selected the Medium Value customer segment for you. The dashboard has been updated with relevant data."):x.includes("low value")?(e("Low Value"),w="I've selected the Low Value customer segment for you. The dashboard now displays data specific to this segment."):x.includes("campaign")&&x.includes("summer")?w="I've selected the Summer Data Booster campaign. You can now see its performance metrics in the dashboard.":x.includes("retention")&&x.includes("campaign")?w="I've updated the dashboard to show retention campaign data. You can see the performance metrics for our retention efforts.":x.includes("compare")&&x.includes("campaign")?w="I've set up a campaign comparison view for you. You can now see how different campaigns perform against each other.":x.includes("best performing")?w="Based on the current data, our Premium Retention Offer campaign has the highest ROI at 5.1x. I've selected it for you to view the details.":(x.includes("customer lifetime value")||x.includes("clv"))&&(w="The average customer lifetime value across segments is $523. High Value customers average $892, Medium Value $427, and Low Value $213. I've updated the dashboard to show CLV breakdowns."),i({role:"assistant",content:w})}catch(x){console.error("Error processing query:",x),d({title:"Error",description:"Failed to process your query. Please try again.",variant:"destructive"})}finally{l(!1)}}}},wut=()=>{const{addChatMessage:e}=V_(),t=(r,i)=>{e({role:"user",content:i}),setTimeout(()=>{e({role:"assistant",content:{"Segment Analyzer":"I've analyzed your customer segments. The High Value segment shows 15% higher engagement this month compared to last quarter.","Campaign Optimizer":"Based on your recent campaigns, I recommend focusing on the Premium Retention Offer which has shown the highest ROI at 5.1x.","CLV Predictor":"The predicted lifetime value for your Medium Value segment is increasing by 8% following your recent targeted campaigns."}[r]||"I can help you analyze and optimize your customer value management strategy."})},1500)};return n.jsxs(jt,{className:"bg-beam-dark-accent/50 border-gray-700/30 mb-4",children:[n.jsx(wr,{className:"pb-2",children:n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsxs(fr,{className:"text-md text-white flex items-center",children:[n.jsx(Hi,{size:16,className:"text-purple-400 mr-2"}),"CVM Agents"]}),n.jsx(Tt,{variant:"outline",className:"bg-purple-900/20 text-purple-300 border-purple-700/30",children:"3 available"})]})}),n.jsx(Ht,{className:"space-y-3",children:n.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[n.jsx("div",{className:"p-3 rounded-lg bg-beam-dark-accent/30 border border-gray-700/30 hover:border-purple-500/50 transition-colors",children:n.jsxs("div",{className:"flex justify-between items-start",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"text-sm font-medium text-white",children:"Segment Analyzer"}),n.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Analyzes customer segments and provides insights"})]}),n.jsx(lt,{variant:"ghost",size:"sm",className:"text-purple-400 hover:text-purple-300 hover:bg-purple-900/30 p-1 h-auto",onClick:()=>t("Segment Analyzer","Analyze my customer segments"),children:n.jsx(_s,{size:14})})]})}),n.jsx("div",{className:"p-3 rounded-lg bg-beam-dark-accent/30 border border-gray-700/30 hover:border-purple-500/50 transition-colors",children:n.jsxs("div",{className:"flex justify-between items-start",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"text-sm font-medium text-white",children:"Campaign Optimizer"}),n.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Suggests campaign optimizations based on performance"})]}),n.jsx(lt,{variant:"ghost",size:"sm",className:"text-purple-400 hover:text-purple-300 hover:bg-purple-900/30 p-1 h-auto",onClick:()=>t("Campaign Optimizer","Which campaign should I focus on?"),children:n.jsx(_s,{size:14})})]})}),n.jsx("div",{className:"p-3 rounded-lg bg-beam-dark-accent/30 border border-gray-700/30 hover:border-purple-500/50 transition-colors",children:n.jsxs("div",{className:"flex justify-between items-start",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"text-sm font-medium text-white",children:"CLV Predictor"}),n.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Predicts customer lifetime value for different segments"})]}),n.jsx(lt,{variant:"ghost",size:"sm",className:"text-purple-400 hover:text-purple-300 hover:bg-purple-900/30 p-1 h-auto",onClick:()=>t("CLV Predictor","Predict the lifetime value for my customer segments"),children:n.jsx(_s,{size:14})})]})})]})})]})},jut=()=>{const{chatMessages:e}=V_(),{isLoading:t,processQuery:r}=_ut(),i=U.useRef(null),a=["What's the value of my high-value customers?","Show me segment performance trends","Compare campaign ROI across segments","Which segment has the highest churn rate?","What's our best performing campaign?"];U.useEffect(()=>{i.current&&i.current.scrollIntoView({behavior:"smooth"})},[e]);const l=d=>{d.trim()&&r(d)};return n.jsxs(jt,{className:"bg-beam-dark-accent/70 border-gray-700 h-full flex flex-col",children:[n.jsx(wr,{className:"pb-2",children:n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsxs(fr,{className:"text-xl text-white flex items-center",children:[n.jsx(Hi,{className:"mr-2 h-5 w-5 text-beam-blue"}),"CVM Assistant"]}),n.jsx(Tt,{variant:"outline",className:"bg-blue-900/20 text-blue-300 border-blue-700/30",children:e.length>0?"Active":"Ready"})]})}),n.jsxs(Ht,{className:"flex-grow flex flex-col p-3 pt-2",children:[n.jsx(wut,{}),n.jsx(Cl,{className:"flex-grow pr-4 mb-4",children:e.length===0?n.jsx(but,{onSelectSuggestion:l,suggestions:a}):n.jsxs("div",{className:"space-y-4",children:[e.map((d,s)=>n.jsx(vut,{message:d},s)),n.jsx("div",{ref:i})]})}),e.length===0&&n.jsx(xhe,{suggestions:a,onSelectSuggestion:l}),n.jsx(yut,{onSubmit:l,isLoading:t})]})]})},Nut=()=>{const{chatMode:e}=V_();return n.jsxs("div",{className:"p-6 space-y-6 bg-black min-h-screen",children:[n.jsx(jt,{className:"shadow-lg border-gray-800/30 bg-gradient-to-br from-beam-dark-accent/70 to-beam-dark-accent/40 backdrop-blur-md",children:n.jsx(wr,{className:"pb-2",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx(fr,{className:"text-2xl font-bold text-white",children:"Customer Value Management"}),n.jsx(Ii,{className:"text-gray-300",children:"Segment, analyze, and maximize customer lifetime value across services"})]}),n.jsx(xut,{})]})})}),n.jsxs("div",{className:"flex flex-col lg:flex-row gap-6",children:[n.jsx("div",{className:`${e?"w-full lg:w-8/12":"w-full"}`,children:n.jsx(gut,{})}),e&&n.jsx("div",{className:"w-full lg:w-4/12",children:n.jsx(jut,{})})]})]})};function Sut(){return n.jsx(Ia,{children:n.jsx(Vde,{children:n.jsx(Nut,{})})})}function Cut(){return n.jsx(Ia,{children:n.jsx(Vde,{children:n.jsx(xde,{children:n.jsxs("div",{className:"p-6 space-y-6 bg-black min-h-screen",children:[n.jsx(jt,{className:"shadow-lg border-gray-800/30 bg-gradient-to-br from-beam-dark-accent/70 to-beam-dark-accent/40 backdrop-blur-md",children:n.jsx(wr,{className:"pb-2",children:n.jsx("div",{className:"flex items-center justify-between",children:n.jsxs("div",{children:[n.jsx(fr,{className:"text-2xl font-bold text-white",children:"Customer Analytics"}),n.jsx(Ii,{className:"text-gray-300",children:"AI-powered customer analytics with agentic decisioning for campaign simulation, profitability scenarios, and churn analysis"})]})})})}),n.jsx(ghe,{})]})})})})}var E$="Avatar",[Aut,gft]=Jo(E$),[Tut,yhe]=Aut(E$),vhe=U.forwardRef((e,t)=>{const{__scopeAvatar:r,...i}=e,[a,l]=U.useState("idle");return n.jsx(Tut,{scope:r,imageLoadingStatus:a,onImageLoadingStatusChange:l,children:n.jsx(Hr.span,{...i,ref:t})})});vhe.displayName=E$;var bhe="AvatarImage",_he=U.forwardRef((e,t)=>{const{__scopeAvatar:r,src:i,onLoadingStatusChange:a=()=>{},...l}=e,d=yhe(bhe,r),s=kut(i,l.referrerPolicy),p=Ws(x=>{a(x),d.onImageLoadingStatusChange(x)});return Ba(()=>{s!=="idle"&&p(s)},[s,p]),s==="loaded"?n.jsx(Hr.img,{...l,ref:t,src:i}):null});_he.displayName=bhe;var whe="AvatarFallback",jhe=U.forwardRef((e,t)=>{const{__scopeAvatar:r,delayMs:i,...a}=e,l=yhe(whe,r),[d,s]=U.useState(i===void 0);return U.useEffect(()=>{if(i!==void 0){const p=window.setTimeout(()=>s(!0),i);return()=>window.clearTimeout(p)}},[i]),d&&l.imageLoadingStatus!=="loaded"?n.jsx(Hr.span,{...a,ref:t}):null});jhe.displayName=whe;function kut(e,t){const[r,i]=U.useState("idle");return Ba(()=>{if(!e){i("error");return}let a=!0;const l=new window.Image,d=s=>()=>{a&&i(s)};return i("loading"),l.onload=d("loaded"),l.onerror=d("error"),l.src=e,t&&(l.referrerPolicy=t),()=>{a=!1}},[e,t]),r}var Nhe=vhe,She=_he,Che=jhe;const S3=U.forwardRef(({className:e,...t},r)=>n.jsx(Nhe,{ref:r,className:Yt("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",e),...t}));S3.displayName=Nhe.displayName;const C3=U.forwardRef(({className:e,...t},r)=>n.jsx(She,{ref:r,className:Yt("aspect-square h-full w-full",e),...t}));C3.displayName=She.displayName;const A3=U.forwardRef(({className:e,...t},r)=>n.jsx(Che,{ref:r,className:Yt("flex h-full w-full items-center justify-center rounded-full bg-muted",e),...t}));A3.displayName=Che.displayName;const Put="modulepreload",Eut=function(e){return"/"+e},dY={},a_=function(t,r,i){let a=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),s=(d==null?void 0:d.nonce)||(d==null?void 0:d.getAttribute("nonce"));a=Promise.allSettled(r.map(p=>{if(p=Eut(p),p in dY)return;dY[p]=!0;const x=p.endsWith(".css"),w=x?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${w}`))return;const j=document.createElement("link");if(j.rel=x?"stylesheet":Put,x||(j.as="script"),j.crossOrigin="",j.href=p,s&&j.setAttribute("nonce",s),document.head.appendChild(j),x)return new Promise((S,P)=>{j.addEventListener("load",S),j.addEventListener("error",()=>P(new Error(`Unable to preload CSS for ${p}`)))})}))}function l(d){const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=d,window.dispatchEvent(s),!s.defaultPrevented)throw d}return a.then(d=>{for(const s of d||[])s.status==="rejected"&&l(s.reason);return t().catch(l)})},Mut=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>a_(async()=>{const{default:i}=await Promise.resolve().then(()=>G_);return{default:i}},void 0).then(({default:i})=>i(...r)):t=fetch,(...r)=>t(...r)};class M$ extends Error{constructor(t,r="FunctionsError",i){super(t),this.name=r,this.context=i}}class Iut extends M${constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class Out extends M${constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class Rut extends M${constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var _L;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(_L||(_L={}));var Dut=function(e,t,r,i){function a(l){return l instanceof r?l:new r(function(d){d(l)})}return new(r||(r=Promise))(function(l,d){function s(w){try{x(i.next(w))}catch(j){d(j)}}function p(w){try{x(i.throw(w))}catch(j){d(j)}}function x(w){w.done?l(w.value):a(w.value).then(s,p)}x((i=i.apply(e,t||[])).next())})};class zut{constructor(t,{headers:r={},customFetch:i,region:a=_L.Any}={}){this.url=t,this.headers=r,this.region=a,this.fetch=Mut(i)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,r={}){var i;return Dut(this,void 0,void 0,function*(){try{const{headers:a,method:l,body:d}=r;let s={},{region:p}=r;p||(p=this.region),p&&p!=="any"&&(s["x-region"]=p);let x;d&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)&&(typeof Blob<"u"&&d instanceof Blob||d instanceof ArrayBuffer?(s["Content-Type"]="application/octet-stream",x=d):typeof d=="string"?(s["Content-Type"]="text/plain",x=d):typeof FormData<"u"&&d instanceof FormData?x=d:(s["Content-Type"]="application/json",x=JSON.stringify(d)));const w=yield this.fetch(`${this.url}/${t}`,{method:l||"POST",headers:Object.assign(Object.assign(Object.assign({},s),this.headers),a),body:x}).catch(F=>{throw new Iut(F)}),j=w.headers.get("x-relay-error");if(j&&j==="true")throw new Out(w);if(!w.ok)throw new Rut(w);let S=((i=w.headers.get("Content-Type"))!==null&&i!==void 0?i:"text/plain").split(";")[0].trim(),P;return S==="application/json"?P=yield w.json():S==="application/octet-stream"?P=yield w.blob():S==="text/event-stream"?P=w:S==="multipart/form-data"?P=yield w.formData():P=yield w.text(),{data:P,error:null}}catch(a){return{data:null,error:a}}})}}var Zl={},I$={},T3={},SS={},k3={},P3={},Lut=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},o_=Lut();const Fut=o_.fetch,Ahe=o_.fetch.bind(o_),The=o_.Headers,But=o_.Request,$ut=o_.Response,G_=Object.freeze(Object.defineProperty({__proto__:null,Headers:The,Request:But,Response:$ut,default:Ahe,fetch:Fut},Symbol.toStringTag,{value:"Module"})),Vut=rge(G_);var E3={};Object.defineProperty(E3,"__esModule",{value:!0});let Uut=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};E3.default=Uut;var khe=To&&To.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(P3,"__esModule",{value:!0});const Gut=khe(Vut),Hut=khe(E3);let qut=class{constructor(t){this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=t.headers,this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=t.shouldThrowOnError,this.signal=t.signal,this.isMaybeSingle=t.isMaybeSingle,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=Gut.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,r){return this.headers=Object.assign({},this.headers),this.headers[t]=r,this}then(t,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const i=this.fetch;let a=i(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async l=>{var d,s,p;let x=null,w=null,j=null,S=l.status,P=l.statusText;if(l.ok){if(this.method!=="HEAD"){const V=await l.text();V===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?w=V:w=JSON.parse(V))}const L=(d=this.headers.Prefer)===null||d===void 0?void 0:d.match(/count=(exact|planned|estimated)/),B=(s=l.headers.get("content-range"))===null||s===void 0?void 0:s.split("/");L&&B&&B.length>1&&(j=parseInt(B[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(w)&&(w.length>1?(x={code:"PGRST116",details:`Results contain ${w.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},w=null,j=null,S=406,P="Not Acceptable"):w.length===1?w=w[0]:w=null)}else{const L=await l.text();try{x=JSON.parse(L),Array.isArray(x)&&l.status===404&&(w=[],x=null,S=200,P="OK")}catch{l.status===404&&L===""?(S=204,P="No Content"):x={message:L}}if(x&&this.isMaybeSingle&&(!((p=x==null?void 0:x.details)===null||p===void 0)&&p.includes("0 rows"))&&(x=null,S=200,P="OK"),x&&this.shouldThrowOnError)throw new Hut.default(x)}return{error:x,data:w,count:j,status:S,statusText:P}});return this.shouldThrowOnError||(a=a.catch(l=>{var d,s,p;return{error:{message:`${(d=l==null?void 0:l.name)!==null&&d!==void 0?d:"FetchError"}: ${l==null?void 0:l.message}`,details:`${(s=l==null?void 0:l.stack)!==null&&s!==void 0?s:""}`,hint:"",code:`${(p=l==null?void 0:l.code)!==null&&p!==void 0?p:""}`},data:null,count:null,status:0,statusText:""}})),a.then(t,r)}returns(){return this}overrideTypes(){return this}};P3.default=qut;var Wut=To&&To.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(k3,"__esModule",{value:!0});const Kut=Wut(P3);let Zut=class extends Kut.default{select(t){let r=!1;const i=(t??"*").split("").map(a=>/\s/.test(a)&&!r?"":(a==='"'&&(r=!r),a)).join("");return this.url.searchParams.set("select",i),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(t,{ascending:r=!0,nullsFirst:i,foreignTable:a,referencedTable:l=a}={}){const d=l?`${l}.order`:"order",s=this.url.searchParams.get(d);return this.url.searchParams.set(d,`${s?`${s},`:""}${t}.${r?"asc":"desc"}${i===void 0?"":i?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:r,referencedTable:i=r}={}){const a=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(a,`${t}`),this}range(t,r,{foreignTable:i,referencedTable:a=i}={}){const l=typeof a>"u"?"offset":`${a}.offset`,d=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(l,`${t}`),this.url.searchParams.set(d,`${r-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:t=!1,verbose:r=!1,settings:i=!1,buffers:a=!1,wal:l=!1,format:d="text"}={}){var s;const p=[t?"analyze":null,r?"verbose":null,i?"settings":null,a?"buffers":null,l?"wal":null].filter(Boolean).join("|"),x=(s=this.headers.Accept)!==null&&s!==void 0?s:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${d}; for="${x}"; options=${p};`,d==="json"?this:this}rollback(){var t;return((t=this.headers.Prefer)!==null&&t!==void 0?t:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};k3.default=Zut;var Yut=To&&To.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(SS,"__esModule",{value:!0});const Xut=Yut(k3);let Jut=class extends Xut.default{eq(t,r){return this.url.searchParams.append(t,`eq.${r}`),this}neq(t,r){return this.url.searchParams.append(t,`neq.${r}`),this}gt(t,r){return this.url.searchParams.append(t,`gt.${r}`),this}gte(t,r){return this.url.searchParams.append(t,`gte.${r}`),this}lt(t,r){return this.url.searchParams.append(t,`lt.${r}`),this}lte(t,r){return this.url.searchParams.append(t,`lte.${r}`),this}like(t,r){return this.url.searchParams.append(t,`like.${r}`),this}likeAllOf(t,r){return this.url.searchParams.append(t,`like(all).{${r.join(",")}}`),this}likeAnyOf(t,r){return this.url.searchParams.append(t,`like(any).{${r.join(",")}}`),this}ilike(t,r){return this.url.searchParams.append(t,`ilike.${r}`),this}ilikeAllOf(t,r){return this.url.searchParams.append(t,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(t,r){return this.url.searchParams.append(t,`ilike(any).{${r.join(",")}}`),this}is(t,r){return this.url.searchParams.append(t,`is.${r}`),this}in(t,r){const i=Array.from(new Set(r)).map(a=>typeof a=="string"&&new RegExp("[,()]").test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(t,`in.(${i})`),this}contains(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cs.{${r.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(r)}`),this}containedBy(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cd.{${r.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(r)}`),this}rangeGt(t,r){return this.url.searchParams.append(t,`sr.${r}`),this}rangeGte(t,r){return this.url.searchParams.append(t,`nxl.${r}`),this}rangeLt(t,r){return this.url.searchParams.append(t,`sl.${r}`),this}rangeLte(t,r){return this.url.searchParams.append(t,`nxr.${r}`),this}rangeAdjacent(t,r){return this.url.searchParams.append(t,`adj.${r}`),this}overlaps(t,r){return typeof r=="string"?this.url.searchParams.append(t,`ov.${r}`):this.url.searchParams.append(t,`ov.{${r.join(",")}}`),this}textSearch(t,r,{config:i,type:a}={}){let l="";a==="plain"?l="pl":a==="phrase"?l="ph":a==="websearch"&&(l="w");const d=i===void 0?"":`(${i})`;return this.url.searchParams.append(t,`${l}fts${d}.${r}`),this}match(t){return Object.entries(t).forEach(([r,i])=>{this.url.searchParams.append(r,`eq.${i}`)}),this}not(t,r,i){return this.url.searchParams.append(t,`not.${r}.${i}`),this}or(t,{foreignTable:r,referencedTable:i=r}={}){const a=i?`${i}.or`:"or";return this.url.searchParams.append(a,`(${t})`),this}filter(t,r,i){return this.url.searchParams.append(t,`${r}.${i}`),this}};SS.default=Jut;var Qut=To&&To.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(T3,"__esModule",{value:!0});const hj=Qut(SS);let edt=class{constructor(t,{headers:r={},schema:i,fetch:a}){this.url=t,this.headers=r,this.schema=i,this.fetch=a}select(t,{head:r=!1,count:i}={}){const a=r?"HEAD":"GET";let l=!1;const d=(t??"*").split("").map(s=>/\s/.test(s)&&!l?"":(s==='"'&&(l=!l),s)).join("");return this.url.searchParams.set("select",d),i&&(this.headers.Prefer=`count=${i}`),new hj.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(t,{count:r,defaultToNull:i=!0}={}){const a="POST",l=[];if(this.headers.Prefer&&l.push(this.headers.Prefer),r&&l.push(`count=${r}`),i||l.push("missing=default"),this.headers.Prefer=l.join(","),Array.isArray(t)){const d=t.reduce((s,p)=>s.concat(Object.keys(p)),[]);if(d.length>0){const s=[...new Set(d)].map(p=>`"${p}"`);this.url.searchParams.set("columns",s.join(","))}}return new hj.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}upsert(t,{onConflict:r,ignoreDuplicates:i=!1,count:a,defaultToNull:l=!0}={}){const d="POST",s=[`resolution=${i?"ignore":"merge"}-duplicates`];if(r!==void 0&&this.url.searchParams.set("on_conflict",r),this.headers.Prefer&&s.push(this.headers.Prefer),a&&s.push(`count=${a}`),l||s.push("missing=default"),this.headers.Prefer=s.join(","),Array.isArray(t)){const p=t.reduce((x,w)=>x.concat(Object.keys(w)),[]);if(p.length>0){const x=[...new Set(p)].map(w=>`"${w}"`);this.url.searchParams.set("columns",x.join(","))}}return new hj.default({method:d,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}update(t,{count:r}={}){const i="PATCH",a=[];return this.headers.Prefer&&a.push(this.headers.Prefer),r&&a.push(`count=${r}`),this.headers.Prefer=a.join(","),new hj.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}delete({count:t}={}){const r="DELETE",i=[];return t&&i.push(`count=${t}`),this.headers.Prefer&&i.unshift(this.headers.Prefer),this.headers.Prefer=i.join(","),new hj.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};T3.default=edt;var M3={},I3={};Object.defineProperty(I3,"__esModule",{value:!0});I3.version=void 0;I3.version="0.0.0-automated";Object.defineProperty(M3,"__esModule",{value:!0});M3.DEFAULT_HEADERS=void 0;const tdt=I3;M3.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${tdt.version}`};var Phe=To&&To.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(I$,"__esModule",{value:!0});const rdt=Phe(T3),ndt=Phe(SS),idt=M3;let sdt=class Ehe{constructor(t,{headers:r={},schema:i,fetch:a}={}){this.url=t,this.headers=Object.assign(Object.assign({},idt.DEFAULT_HEADERS),r),this.schemaName=i,this.fetch=a}from(t){const r=new URL(`${this.url}/${t}`);return new rdt.default(r,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new Ehe(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:i=!1,get:a=!1,count:l}={}){let d;const s=new URL(`${this.url}/rpc/${t}`);let p;i||a?(d=i?"HEAD":"GET",Object.entries(r).filter(([w,j])=>j!==void 0).map(([w,j])=>[w,Array.isArray(j)?`{${j.join(",")}}`:`${j}`]).forEach(([w,j])=>{s.searchParams.append(w,j)})):(d="POST",p=r);const x=Object.assign({},this.headers);return l&&(x.Prefer=`count=${l}`),new ndt.default({method:d,url:s,headers:x,schema:this.schemaName,body:p,fetch:this.fetch,allowEmpty:!1})}};I$.default=sdt;var H_=To&&To.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Zl,"__esModule",{value:!0});Zl.PostgrestError=Zl.PostgrestBuilder=Zl.PostgrestTransformBuilder=Zl.PostgrestFilterBuilder=Zl.PostgrestQueryBuilder=Zl.PostgrestClient=void 0;const Mhe=H_(I$);Zl.PostgrestClient=Mhe.default;const Ihe=H_(T3);Zl.PostgrestQueryBuilder=Ihe.default;const Ohe=H_(SS);Zl.PostgrestFilterBuilder=Ohe.default;const Rhe=H_(k3);Zl.PostgrestTransformBuilder=Rhe.default;const Dhe=H_(P3);Zl.PostgrestBuilder=Dhe.default;const zhe=H_(E3);Zl.PostgrestError=zhe.default;var adt=Zl.default={PostgrestClient:Mhe.default,PostgrestQueryBuilder:Ihe.default,PostgrestFilterBuilder:Ohe.default,PostgrestTransformBuilder:Rhe.default,PostgrestBuilder:Dhe.default,PostgrestError:zhe.default};const{PostgrestClient:odt,PostgrestQueryBuilder:wft,PostgrestFilterBuilder:jft,PostgrestTransformBuilder:Nft,PostgrestBuilder:Sft,PostgrestError:Cft}=adt,ldt="2.11.2",cdt={"X-Client-Info":`realtime-js/${ldt}`},udt="1.0.0",Lhe=1e4,ddt=1e3;var qv;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(qv||(qv={}));var yc;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(yc||(yc={}));var ld;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(ld||(ld={}));var wL;(function(e){e.websocket="websocket"})(wL||(wL={}));var C0;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(C0||(C0={}));class hdt{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),i=new TextDecoder;return this._decodeBroadcast(t,r,i)}_decodeBroadcast(t,r,i){const a=r.getUint8(1),l=r.getUint8(2);let d=this.HEADER_LENGTH+2;const s=i.decode(t.slice(d,d+a));d=d+a;const p=i.decode(t.slice(d,d+l));d=d+l;const x=JSON.parse(i.decode(t.slice(d,t.byteLength)));return{ref:null,topic:s,event:p,payload:x}}}class Fhe{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Ss;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(Ss||(Ss={}));const hY=(e,t,r={})=>{var i;const a=(i=r.skipTypes)!==null&&i!==void 0?i:[];return Object.keys(t).reduce((l,d)=>(l[d]=mdt(d,e,t,a),l),{})},mdt=(e,t,r,i)=>{const a=t.find(s=>s.name===e),l=a==null?void 0:a.type,d=r[e];return l&&!i.includes(l)?Bhe(l,d):jL(d)},Bhe=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return xdt(t,r)}switch(e){case Ss.bool:return fdt(t);case Ss.float4:case Ss.float8:case Ss.int2:case Ss.int4:case Ss.int8:case Ss.numeric:case Ss.oid:return pdt(t);case Ss.json:case Ss.jsonb:return gdt(t);case Ss.timestamp:return ydt(t);case Ss.abstime:case Ss.date:case Ss.daterange:case Ss.int4range:case Ss.int8range:case Ss.money:case Ss.reltime:case Ss.text:case Ss.time:case Ss.timestamptz:case Ss.timetz:case Ss.tsrange:case Ss.tstzrange:return jL(t);default:return jL(t)}},jL=e=>e,fdt=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},pdt=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},gdt=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},xdt=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,i=e[r];if(e[0]==="{"&&i==="}"){let l;const d=e.slice(1,r);try{l=JSON.parse("["+d+"]")}catch{l=d?d.split(","):[]}return l.map(s=>Bhe(t,s))}return e},ydt=e=>typeof e=="string"?e.replace(" ","T"):e,$he=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")};class IR{constructor(t,r,i={},a=Lhe){this.channel=t,this.event=r,this.payload=i,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var i;return this._hasReceived(t)&&r((i=this.receivedResp)===null||i===void 0?void 0:i.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(i=>i.status===t).forEach(i=>i.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var mY;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(mY||(mY={}));class Kj{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const i=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(i.state,{},a=>{const{onJoin:l,onLeave:d,onSync:s}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Kj.syncState(this.state,a,l,d),this.pendingDiffs.forEach(p=>{this.state=Kj.syncDiff(this.state,p,l,d)}),this.pendingDiffs=[],s()}),this.channel._on(i.diff,{},a=>{const{onJoin:l,onLeave:d,onSync:s}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=Kj.syncDiff(this.state,a,l,d),s())}),this.onJoin((a,l,d)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:l,newPresences:d})}),this.onLeave((a,l,d)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:l,leftPresences:d})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,i,a){const l=this.cloneDeep(t),d=this.transformState(r),s={},p={};return this.map(l,(x,w)=>{d[x]||(p[x]=w)}),this.map(d,(x,w)=>{const j=l[x];if(j){const S=w.map(B=>B.presence_ref),P=j.map(B=>B.presence_ref),F=w.filter(B=>P.indexOf(B.presence_ref)<0),L=j.filter(B=>S.indexOf(B.presence_ref)<0);F.length>0&&(s[x]=F),L.length>0&&(p[x]=L)}else s[x]=w}),this.syncDiff(l,{joins:s,leaves:p},i,a)}static syncDiff(t,r,i,a){const{joins:l,leaves:d}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return i||(i=()=>{}),a||(a=()=>{}),this.map(l,(s,p)=>{var x;const w=(x=t[s])!==null&&x!==void 0?x:[];if(t[s]=this.cloneDeep(p),w.length>0){const j=t[s].map(P=>P.presence_ref),S=w.filter(P=>j.indexOf(P.presence_ref)<0);t[s].unshift(...S)}i(s,w,p)}),this.map(d,(s,p)=>{let x=t[s];if(!x)return;const w=p.map(j=>j.presence_ref);x=x.filter(j=>w.indexOf(j.presence_ref)<0),t[s]=x,a(s,x,p),x.length===0&&delete t[s]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(i=>r(i,t[i]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,i)=>{const a=t[i];return"metas"in a?r[i]=a.metas.map(l=>(l.presence_ref=l.phx_ref,delete l.phx_ref,delete l.phx_ref_prev,l)):r[i]=a,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var fY;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(fY||(fY={}));var pY;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(pY||(pY={}));var cm;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(cm||(cm={}));class O${constructor(t,r={config:{}},i){this.topic=t,this.params=r,this.socket=i,this.bindings={},this.state=yc.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new IR(this,ld.join,this.params,this.timeout),this.rejoinTimer=new Fhe(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=yc.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=yc.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=yc.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=yc.errored,this.rejoinTimer.scheduleTimeout())}),this._on(ld.reply,{},(a,l)=>{this._trigger(this._replyEventName(l),a)}),this.presence=new Kj(this),this.broadcastEndpointURL=$he(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(t,r=this.timeout){var i,a;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:l,presence:d,private:s}}=this.params;this._onError(w=>t==null?void 0:t(cm.CHANNEL_ERROR,w)),this._onClose(()=>t==null?void 0:t(cm.CLOSED));const p={},x={broadcast:l,presence:d,postgres_changes:(a=(i=this.bindings.postgres_changes)===null||i===void 0?void 0:i.map(w=>w.filter))!==null&&a!==void 0?a:[],private:s};this.socket.accessTokenValue&&(p.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:x},p)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:w})=>{var j;if(this.socket.setAuth(),w===void 0){t==null||t(cm.SUBSCRIBED);return}else{const S=this.bindings.postgres_changes,P=(j=S==null?void 0:S.length)!==null&&j!==void 0?j:0,F=[];for(let L=0;L<P;L++){const B=S[L],{filter:{event:V,schema:$,table:G,filter:W}}=B,Z=w&&w[L];if(Z&&Z.event===V&&Z.schema===$&&Z.table===G&&Z.filter===W)F.push(Object.assign(Object.assign({},B),{id:Z.id}));else{this.unsubscribe(),t==null||t(cm.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=F,t&&t(cm.SUBSCRIBED);return}}).receive("error",w=>{t==null||t(cm.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(w).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(cm.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,i){return this._on(t,r,i)}async send(t,r={}){var i,a;if(!this._canPush()&&t.type==="broadcast"){const{event:l,payload:d}=t,p={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:l,payload:d,private:this.private}]})};try{const x=await this._fetchWithTimeout(this.broadcastEndpointURL,p,(i=r.timeout)!==null&&i!==void 0?i:this.timeout);return await((a=x.body)===null||a===void 0?void 0:a.cancel()),x.ok?"ok":"error"}catch(x){return x.name==="AbortError"?"timed out":"error"}}else return new Promise(l=>{var d,s,p;const x=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((p=(s=(d=this.params)===null||d===void 0?void 0:d.config)===null||s===void 0?void 0:s.broadcast)===null||p===void 0)&&p.ack)&&l("ok"),x.receive("ok",()=>l("ok")),x.receive("error",()=>l("error")),x.receive("timeout",()=>l("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=yc.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(ld.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(i=>{const a=new IR(this,ld.leave,{},t);a.receive("ok",()=>{r(),i("ok")}).receive("timeout",()=>{r(),i("timed out")}).receive("error",()=>{i("error")}),a.send(),this._canPush()||a.trigger("ok",{})})}async _fetchWithTimeout(t,r,i){const a=new AbortController,l=setTimeout(()=>a.abort(),i),d=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:a.signal}));return clearTimeout(l),d}_push(t,r,i=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new IR(this,t,r,i);return this._canPush()?a.send():(a.startTimeout(),this.pushBuffer.push(a)),a}_onMessage(t,r,i){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,i){var a,l;const d=t.toLocaleLowerCase(),{close:s,error:p,leave:x,join:w}=ld;if(i&&[s,p,x,w].indexOf(d)>=0&&i!==this._joinRef())return;let S=this._onMessage(d,r,i);if(r&&!S)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(d)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(P=>{var F,L,B;return((F=P.filter)===null||F===void 0?void 0:F.event)==="*"||((B=(L=P.filter)===null||L===void 0?void 0:L.event)===null||B===void 0?void 0:B.toLocaleLowerCase())===d}).map(P=>P.callback(S,i)):(l=this.bindings[d])===null||l===void 0||l.filter(P=>{var F,L,B,V,$,G;if(["broadcast","presence","postgres_changes"].includes(d))if("id"in P){const W=P.id,Z=(F=P.filter)===null||F===void 0?void 0:F.event;return W&&((L=r.ids)===null||L===void 0?void 0:L.includes(W))&&(Z==="*"||(Z==null?void 0:Z.toLocaleLowerCase())===((B=r.data)===null||B===void 0?void 0:B.type.toLocaleLowerCase()))}else{const W=($=(V=P==null?void 0:P.filter)===null||V===void 0?void 0:V.event)===null||$===void 0?void 0:$.toLocaleLowerCase();return W==="*"||W===((G=r==null?void 0:r.event)===null||G===void 0?void 0:G.toLocaleLowerCase())}else return P.type.toLocaleLowerCase()===d}).map(P=>{if(typeof S=="object"&&"ids"in S){const F=S.data,{schema:L,table:B,commit_timestamp:V,type:$,errors:G}=F;S=Object.assign(Object.assign({},{schema:L,table:B,commit_timestamp:V,eventType:$,new:{},old:{},errors:G}),this._getPayloadRecords(F))}P.callback(S,i)})}_isClosed(){return this.state===yc.closed}_isJoined(){return this.state===yc.joined}_isJoining(){return this.state===yc.joining}_isLeaving(){return this.state===yc.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,i){const a=t.toLocaleLowerCase(),l={type:a,filter:r,callback:i};return this.bindings[a]?this.bindings[a].push(l):this.bindings[a]=[l],this}_off(t,r){const i=t.toLocaleLowerCase();return this.bindings[i]=this.bindings[i].filter(a=>{var l;return!(((l=a.type)===null||l===void 0?void 0:l.toLocaleLowerCase())===i&&O$.isEqual(a.filter,r))}),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const i in t)if(t[i]!==r[i])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(ld.close,{},t)}_onError(t){this._on(ld.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=yc.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=hY(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=hY(t.columns,t.old_record)),r}}const vdt=()=>{},bdt=typeof WebSocket<"u",_dt=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class wdt{constructor(t,r){var i;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=cdt,this.params={},this.timeout=Lhe,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=vdt,this.conn=null,this.sendBuffer=[],this.serializer=new hdt,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=l=>{let d;return l?d=l:typeof fetch>"u"?d=(...s)=>a_(async()=>{const{default:p}=await Promise.resolve().then(()=>G_);return{default:p}},void 0).then(({default:p})=>p(...s)):d=fetch,(...s)=>d(...s)},this.endPoint=`${t}/${wL.websocket}`,this.httpEndpoint=$he(t),r!=null&&r.transport?this.transport=r.transport:this.transport=null,r!=null&&r.params&&(this.params=r.params),r!=null&&r.headers&&(this.headers=Object.assign(Object.assign({},this.headers),r.headers)),r!=null&&r.timeout&&(this.timeout=r.timeout),r!=null&&r.logger&&(this.logger=r.logger),r!=null&&r.heartbeatIntervalMs&&(this.heartbeatIntervalMs=r.heartbeatIntervalMs);const a=(i=r==null?void 0:r.params)===null||i===void 0?void 0:i.apikey;if(a&&(this.accessTokenValue=a,this.apiKey=a),this.reconnectAfterMs=r!=null&&r.reconnectAfterMs?r.reconnectAfterMs:l=>[1e3,2e3,5e3,1e4][l-1]||1e4,this.encode=r!=null&&r.encode?r.encode:(l,d)=>d(JSON.stringify(l)),this.decode=r!=null&&r.decode?r.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Fhe(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(r==null?void 0:r.fetch),r!=null&&r.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(r==null?void 0:r.worker)||!1,this.workerUrl=r==null?void 0:r.workerUrl}this.accessToken=(r==null?void 0:r.accessToken)||null}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});return}if(bdt){this.conn=new WebSocket(this.endpointURL()),this.setupConnection();return}this.conn=new jdt(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),a_(async()=>{const{default:t}=await import("./browser-BaNJ4w_P.js").then(r=>r.b);return{default:t}},[]).then(({default:t})=>{this.conn=new t(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:udt}))}disconnect(t,r){this.conn&&(this.conn.onclose=function(){},t?this.conn.close(t,r??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.disconnect(),t}log(t,r,i){this.logger(t,r,i)}connectionState(){switch(this.conn&&this.conn.readyState){case qv.connecting:return C0.Connecting;case qv.open:return C0.Open;case qv.closing:return C0.Closing;default:return C0.Closed}}isConnected(){return this.connectionState()===C0.Open}channel(t,r={config:{}}){const i=new O$(`realtime:${t}`,r,this);return this.channels.push(i),i}push(t){const{topic:r,event:i,payload:a,ref:l}=t,d=()=>{this.encode(t,s=>{var p;(p=this.conn)===null||p===void 0||p.send(s)})};this.log("push",`${r} ${i} (${l})`,a),this.isConnected()?d():this.sendBuffer.push(d)}async setAuth(t=null){let r=t||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(r){let i=null;try{i=JSON.parse(atob(r.split(".")[1]))}catch{}if(i&&i.exp&&!(Math.floor(Date.now()/1e3)-i.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${i.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${i.exp}`);this.accessTokenValue=r,this.channels.forEach(a=>{r&&a.updateJoinPayload({access_token:r}),a.joinedOnce&&a._isJoined()&&a._push(ld.access_token,{access_token:r})})}}async sendHeartbeat(){var t;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(t=this.conn)===null||t===void 0||t.close(ddt,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(i=>i.topic===t&&(i._isJoined()||i._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r._joinRef()!==t._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_onConnMessage(t){this.decode(t.data,r=>{let{topic:i,event:a,payload:l,ref:d}=r;d&&d===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${l.status||""} ${i} ${a} ${d&&"("+d+")"||""}`,l),this.channels.filter(s=>s._isMember(i)).forEach(s=>s._trigger(a,l,d)),this.stateChangeCallbacks.message.forEach(s=>s(r))})}async _onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(t=>t())}_onConnClose(t){this.log("transport","close",t),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(r=>r(t))}_onConnError(t){this.log("transport",t.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(r=>r(t))}_triggerChanError(){this.channels.forEach(t=>t._trigger(ld.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const i=t.match(/\?/)?"&":"?",a=new URLSearchParams(r);return`${t}${i}${a}`}_workerObjectUrl(t){let r;if(t)r=t;else{const i=new Blob([_dt],{type:"application/javascript"});r=URL.createObjectURL(i)}return r}}class jdt{constructor(t,r,i){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=qv.connecting,this.send=()=>{},this.url=null,this.url=t,this.close=i.close}}class R$ extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function lo(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class Ndt extends R${constructor(t,r){super(t),this.name="StorageApiError",this.status=r}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class NL extends R${constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var Sdt=function(e,t,r,i){function a(l){return l instanceof r?l:new r(function(d){d(l)})}return new(r||(r=Promise))(function(l,d){function s(w){try{x(i.next(w))}catch(j){d(j)}}function p(w){try{x(i.throw(w))}catch(j){d(j)}}function x(w){w.done?l(w.value):a(w.value).then(s,p)}x((i=i.apply(e,t||[])).next())})};const Vhe=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>a_(async()=>{const{default:i}=await Promise.resolve().then(()=>G_);return{default:i}},void 0).then(({default:i})=>i(...r)):t=fetch,(...r)=>t(...r)},Cdt=()=>Sdt(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield a_(()=>Promise.resolve().then(()=>G_),void 0)).Response:Response}),SL=e=>{if(Array.isArray(e))return e.map(r=>SL(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,i])=>{const a=r.replace(/([-_][a-z])/gi,l=>l.toUpperCase().replace(/[-_]/g,""));t[a]=SL(i)}),t};var kx=function(e,t,r,i){function a(l){return l instanceof r?l:new r(function(d){d(l)})}return new(r||(r=Promise))(function(l,d){function s(w){try{x(i.next(w))}catch(j){d(j)}}function p(w){try{x(i.throw(w))}catch(j){d(j)}}function x(w){w.done?l(w.value):a(w.value).then(s,p)}x((i=i.apply(e,t||[])).next())})};const OR=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Adt=(e,t,r)=>kx(void 0,void 0,void 0,function*(){const i=yield Cdt();e instanceof i&&!(r!=null&&r.noResolveJson)?e.json().then(a=>{t(new Ndt(OR(a),e.status||500))}).catch(a=>{t(new NL(OR(a),a))}):t(new NL(OR(e),e))}),Tdt=(e,t,r,i)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),i&&(a.body=JSON.stringify(i)),Object.assign(Object.assign({},a),r))};function CS(e,t,r,i,a,l){return kx(this,void 0,void 0,function*(){return new Promise((d,s)=>{e(r,Tdt(t,i,a,l)).then(p=>{if(!p.ok)throw p;return i!=null&&i.noResolveJson?p:p.json()}).then(p=>d(p)).catch(p=>Adt(p,s,i))})})}function rE(e,t,r,i){return kx(this,void 0,void 0,function*(){return CS(e,"GET",t,r,i)})}function ip(e,t,r,i,a){return kx(this,void 0,void 0,function*(){return CS(e,"POST",t,i,a,r)})}function kdt(e,t,r,i,a){return kx(this,void 0,void 0,function*(){return CS(e,"PUT",t,i,a,r)})}function Pdt(e,t,r,i){return kx(this,void 0,void 0,function*(){return CS(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),i)})}function Uhe(e,t,r,i,a){return kx(this,void 0,void 0,function*(){return CS(e,"DELETE",t,i,a,r)})}var Gl=function(e,t,r,i){function a(l){return l instanceof r?l:new r(function(d){d(l)})}return new(r||(r=Promise))(function(l,d){function s(w){try{x(i.next(w))}catch(j){d(j)}}function p(w){try{x(i.throw(w))}catch(j){d(j)}}function x(w){w.done?l(w.value):a(w.value).then(s,p)}x((i=i.apply(e,t||[])).next())})};const Edt={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},gY={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Mdt{constructor(t,r={},i,a){this.url=t,this.headers=r,this.bucketId=i,this.fetch=Vhe(a)}uploadOrUpdate(t,r,i,a){return Gl(this,void 0,void 0,function*(){try{let l;const d=Object.assign(Object.assign({},gY),a);let s=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(d.upsert)});const p=d.metadata;typeof Blob<"u"&&i instanceof Blob?(l=new FormData,l.append("cacheControl",d.cacheControl),p&&l.append("metadata",this.encodeMetadata(p)),l.append("",i)):typeof FormData<"u"&&i instanceof FormData?(l=i,l.append("cacheControl",d.cacheControl),p&&l.append("metadata",this.encodeMetadata(p))):(l=i,s["cache-control"]=`max-age=${d.cacheControl}`,s["content-type"]=d.contentType,p&&(s["x-metadata"]=this.toBase64(this.encodeMetadata(p)))),a!=null&&a.headers&&(s=Object.assign(Object.assign({},s),a.headers));const x=this._removeEmptyFolders(r),w=this._getFinalPath(x),j=yield this.fetch(`${this.url}/object/${w}`,Object.assign({method:t,body:l,headers:s},d!=null&&d.duplex?{duplex:d.duplex}:{})),S=yield j.json();return j.ok?{data:{path:x,id:S.Id,fullPath:S.Key},error:null}:{data:null,error:S}}catch(l){if(lo(l))return{data:null,error:l};throw l}})}upload(t,r,i){return Gl(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,i)})}uploadToSignedUrl(t,r,i,a){return Gl(this,void 0,void 0,function*(){const l=this._removeEmptyFolders(t),d=this._getFinalPath(l),s=new URL(this.url+`/object/upload/sign/${d}`);s.searchParams.set("token",r);try{let p;const x=Object.assign({upsert:gY.upsert},a),w=Object.assign(Object.assign({},this.headers),{"x-upsert":String(x.upsert)});typeof Blob<"u"&&i instanceof Blob?(p=new FormData,p.append("cacheControl",x.cacheControl),p.append("",i)):typeof FormData<"u"&&i instanceof FormData?(p=i,p.append("cacheControl",x.cacheControl)):(p=i,w["cache-control"]=`max-age=${x.cacheControl}`,w["content-type"]=x.contentType);const j=yield this.fetch(s.toString(),{method:"PUT",body:p,headers:w}),S=yield j.json();return j.ok?{data:{path:l,fullPath:S.Key},error:null}:{data:null,error:S}}catch(p){if(lo(p))return{data:null,error:p};throw p}})}createSignedUploadUrl(t,r){return Gl(this,void 0,void 0,function*(){try{let i=this._getFinalPath(t);const a=Object.assign({},this.headers);r!=null&&r.upsert&&(a["x-upsert"]="true");const l=yield ip(this.fetch,`${this.url}/object/upload/sign/${i}`,{},{headers:a}),d=new URL(this.url+l.url),s=d.searchParams.get("token");if(!s)throw new R$("No token returned by API");return{data:{signedUrl:d.toString(),path:t,token:s},error:null}}catch(i){if(lo(i))return{data:null,error:i};throw i}})}update(t,r,i){return Gl(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,i)})}move(t,r,i){return Gl(this,void 0,void 0,function*(){try{return{data:yield ip(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:i==null?void 0:i.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(lo(a))return{data:null,error:a};throw a}})}copy(t,r,i){return Gl(this,void 0,void 0,function*(){try{return{data:{path:(yield ip(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:i==null?void 0:i.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(lo(a))return{data:null,error:a};throw a}})}createSignedUrl(t,r,i){return Gl(this,void 0,void 0,function*(){try{let a=this._getFinalPath(t),l=yield ip(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:r},i!=null&&i.transform?{transform:i.transform}:{}),{headers:this.headers});const d=i!=null&&i.download?`&download=${i.download===!0?"":i.download}`:"";return l={signedUrl:encodeURI(`${this.url}${l.signedURL}${d}`)},{data:l,error:null}}catch(a){if(lo(a))return{data:null,error:a};throw a}})}createSignedUrls(t,r,i){return Gl(this,void 0,void 0,function*(){try{const a=yield ip(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),l=i!=null&&i.download?`&download=${i.download===!0?"":i.download}`:"";return{data:a.map(d=>Object.assign(Object.assign({},d),{signedUrl:d.signedURL?encodeURI(`${this.url}${d.signedURL}${l}`):null})),error:null}}catch(a){if(lo(a))return{data:null,error:a};throw a}})}download(t,r){return Gl(this,void 0,void 0,function*(){const a=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",l=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),d=l?`?${l}`:"";try{const s=this._getFinalPath(t);return{data:yield(yield rE(this.fetch,`${this.url}/${a}/${s}${d}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(s){if(lo(s))return{data:null,error:s};throw s}})}info(t){return Gl(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const i=yield rE(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:SL(i),error:null}}catch(i){if(lo(i))return{data:null,error:i};throw i}})}exists(t){return Gl(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield Pdt(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(i){if(lo(i)&&i instanceof NL){const a=i.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:i}}throw i}})}getPublicUrl(t,r){const i=this._getFinalPath(t),a=[],l=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";l!==""&&a.push(l);const s=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",p=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});p!==""&&a.push(p);let x=a.join("&");return x!==""&&(x=`?${x}`),{data:{publicUrl:encodeURI(`${this.url}/${s}/public/${i}${x}`)}}}remove(t){return Gl(this,void 0,void 0,function*(){try{return{data:yield Uhe(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(lo(r))return{data:null,error:r};throw r}})}list(t,r,i){return Gl(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},Edt),r),{prefix:t||""});return{data:yield ip(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},i),error:null}}catch(a){if(lo(a))return{data:null,error:a};throw a}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const Idt="2.7.1",Odt={"X-Client-Info":`storage-js/${Idt}`};var rv=function(e,t,r,i){function a(l){return l instanceof r?l:new r(function(d){d(l)})}return new(r||(r=Promise))(function(l,d){function s(w){try{x(i.next(w))}catch(j){d(j)}}function p(w){try{x(i.throw(w))}catch(j){d(j)}}function x(w){w.done?l(w.value):a(w.value).then(s,p)}x((i=i.apply(e,t||[])).next())})};class Rdt{constructor(t,r={},i){this.url=t,this.headers=Object.assign(Object.assign({},Odt),r),this.fetch=Vhe(i)}listBuckets(){return rv(this,void 0,void 0,function*(){try{return{data:yield rE(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(lo(t))return{data:null,error:t};throw t}})}getBucket(t){return rv(this,void 0,void 0,function*(){try{return{data:yield rE(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(lo(r))return{data:null,error:r};throw r}})}createBucket(t,r={public:!1}){return rv(this,void 0,void 0,function*(){try{return{data:yield ip(this.fetch,`${this.url}/bucket`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(i){if(lo(i))return{data:null,error:i};throw i}})}updateBucket(t,r){return rv(this,void 0,void 0,function*(){try{return{data:yield kdt(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(i){if(lo(i))return{data:null,error:i};throw i}})}emptyBucket(t){return rv(this,void 0,void 0,function*(){try{return{data:yield ip(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(lo(r))return{data:null,error:r};throw r}})}deleteBucket(t){return rv(this,void 0,void 0,function*(){try{return{data:yield Uhe(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(lo(r))return{data:null,error:r};throw r}})}}class Ddt extends Rdt{constructor(t,r={},i){super(t,r,i)}from(t){return new Mdt(this.url,this.headers,t,this.fetch)}}const zdt="2.49.4";let Nj="";typeof Deno<"u"?Nj="deno":typeof document<"u"?Nj="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Nj="react-native":Nj="node";const Ldt={"X-Client-Info":`supabase-js-${Nj}/${zdt}`},Fdt={headers:Ldt},Bdt={schema:"public"},$dt={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Vdt={};var Udt=function(e,t,r,i){function a(l){return l instanceof r?l:new r(function(d){d(l)})}return new(r||(r=Promise))(function(l,d){function s(w){try{x(i.next(w))}catch(j){d(j)}}function p(w){try{x(i.throw(w))}catch(j){d(j)}}function x(w){w.done?l(w.value):a(w.value).then(s,p)}x((i=i.apply(e,t||[])).next())})};const Gdt=e=>{let t;return e?t=e:typeof fetch>"u"?t=Ahe:t=fetch,(...r)=>t(...r)},Hdt=()=>typeof Headers>"u"?The:Headers,qdt=(e,t,r)=>{const i=Gdt(r),a=Hdt();return(l,d)=>Udt(void 0,void 0,void 0,function*(){var s;const p=(s=yield t())!==null&&s!==void 0?s:e;let x=new a(d==null?void 0:d.headers);return x.has("apikey")||x.set("apikey",e),x.has("Authorization")||x.set("Authorization",`Bearer ${p}`),i(l,Object.assign(Object.assign({},d),{headers:x}))})};var Wdt=function(e,t,r,i){function a(l){return l instanceof r?l:new r(function(d){d(l)})}return new(r||(r=Promise))(function(l,d){function s(w){try{x(i.next(w))}catch(j){d(j)}}function p(w){try{x(i.throw(w))}catch(j){d(j)}}function x(w){w.done?l(w.value):a(w.value).then(s,p)}x((i=i.apply(e,t||[])).next())})};function Kdt(e){return e.replace(/\/$/,"")}function Zdt(e,t){const{db:r,auth:i,realtime:a,global:l}=e,{db:d,auth:s,realtime:p,global:x}=t,w={db:Object.assign(Object.assign({},d),r),auth:Object.assign(Object.assign({},s),i),realtime:Object.assign(Object.assign({},p),a),global:Object.assign(Object.assign({},x),l),accessToken:()=>Wdt(this,void 0,void 0,function*(){return""})};return e.accessToken?w.accessToken=e.accessToken:delete w.accessToken,w}const Ghe="2.69.1",lv=30*1e3,CL=3,RR=CL*lv,Ydt="http://localhost:9999",Xdt="supabase.auth.token",Jdt={"X-Client-Info":`gotrue-js/${Ghe}`},AL="X-Supabase-Api-Version",Hhe={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Qdt=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,eht=6e5;class D$ extends Error{constructor(t,r,i){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=i}}function si(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class tht extends D${constructor(t,r,i){super(t,r,i),this.name="AuthApiError",this.status=r,this.code=i}}function rht(e){return si(e)&&e.name==="AuthApiError"}class qhe extends D${constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class gg extends D${constructor(t,r,i,a){super(t,i,a),this.name=r,this.status=i}}class Qf extends gg{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function nht(e){return si(e)&&e.name==="AuthSessionMissingError"}class DR extends gg{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class uT extends gg{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class dT extends gg{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function iht(e){return si(e)&&e.name==="AuthImplicitGrantRedirectError"}class xY extends gg{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class TL extends gg{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function zR(e){return si(e)&&e.name==="AuthRetryableFetchError"}class yY extends gg{constructor(t,r,i){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=i}}class Zj extends gg{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const vY="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),bY=` 	
\r=`.split(""),sht=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<bY.length;t+=1)e[bY[t].charCodeAt(0)]=-2;for(let t=0;t<vY.length;t+=1)e[vY[t].charCodeAt(0)]=t;return e})();function Whe(e,t,r){const i=sht[e];if(i>-1)for(t.queue=t.queue<<6|i,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(i===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function _Y(e){const t=[],r=d=>{t.push(String.fromCodePoint(d))},i={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},l=d=>{lht(d,i,r)};for(let d=0;d<e.length;d+=1)Whe(e.charCodeAt(d),a,l);return t.join("")}function aht(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function oht(e,t){for(let r=0;r<e.length;r+=1){let i=e.charCodeAt(r);if(i>55295&&i<=56319){const a=(i-55296)*1024&65535;i=(e.charCodeAt(r+1)-56320&65535|a)+65536,r+=1}aht(i,t)}}function lht(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let i=1;i<6;i+=1)if(!(e>>7-i&1)){t.utf8seq=i;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function cht(e){const t=[],r={queue:0,queuedBits:0},i=a=>{t.push(a)};for(let a=0;a<e.length;a+=1)Whe(e.charCodeAt(a),r,i);return new Uint8Array(t)}function uht(e){const t=[];return oht(e,r=>t.push(r)),new Uint8Array(t)}function dht(e){return Math.round(Date.now()/1e3)+e}function hht(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const Yd=()=>typeof window<"u"&&typeof document<"u",g0={tested:!1,writable:!1},Yj=()=>{if(!Yd())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(g0.tested)return g0.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),g0.tested=!0,g0.writable=!0}catch{g0.tested=!0,g0.writable=!1}return g0.writable};function mht(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((a,l)=>{t[l]=a})}catch{}return r.searchParams.forEach((i,a)=>{t[a]=i}),t}const Khe=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>a_(async()=>{const{default:i}=await Promise.resolve().then(()=>G_);return{default:i}},void 0).then(({default:i})=>i(...r)):t=fetch,(...r)=>t(...r)},fht=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",Zhe=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},hT=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},mT=async(e,t)=>{await e.removeItem(t)};class O3{constructor(){this.promise=new O3.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}O3.promiseConstructor=Promise;function LR(e){const t=e.split(".");if(t.length!==3)throw new Zj("Invalid JWT structure");for(let i=0;i<t.length;i++)if(!Qdt.test(t[i]))throw new Zj("JWT not in base64url format");return{header:JSON.parse(_Y(t[0])),payload:JSON.parse(_Y(t[1])),signature:cht(t[2]),raw:{header:t[0],payload:t[1]}}}async function pht(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function ght(e,t){return new Promise((i,a)=>{(async()=>{for(let l=0;l<1/0;l++)try{const d=await e(l);if(!t(l,null,d)){i(d);return}}catch(d){if(!t(l,d)){a(d);return}}})()})}function xht(e){return("0"+e.toString(16)).substr(-2)}function yht(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",i=r.length;let a="";for(let l=0;l<56;l++)a+=r.charAt(Math.floor(Math.random()*i));return a}return crypto.getRandomValues(t),Array.from(t,xht).join("")}async function vht(e){const r=new TextEncoder().encode(e),i=await crypto.subtle.digest("SHA-256",r),a=new Uint8Array(i);return Array.from(a).map(l=>String.fromCharCode(l)).join("")}async function bht(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await vht(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function nv(e,t,r=!1){const i=yht();let a=i;r&&(a+="/PASSWORD_RECOVERY"),await Zhe(e,`${t}-code-verifier`,a);const l=await bht(i);return[l,i===l?"plain":"s256"]}const _ht=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function wht(e){const t=e.headers.get(AL);if(!t||!t.match(_ht))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function jht(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function Nht(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}var Sht=function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(e);a<i.length;a++)t.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(e,i[a])&&(r[i[a]]=e[i[a]]);return r};const N0=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Cht=[502,503,504];async function wY(e){var t;if(!fht(e))throw new TL(N0(e),0);if(Cht.includes(e.status))throw new TL(N0(e),e.status);let r;try{r=await e.json()}catch(l){throw new qhe(N0(l),l)}let i;const a=wht(e);if(a&&a.getTime()>=Hhe["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?i=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(i=r.error_code),i){if(i==="weak_password")throw new yY(N0(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(i==="session_not_found")throw new Qf}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((l,d)=>l&&typeof d=="string",!0))throw new yY(N0(r),e.status,r.weak_password.reasons);throw new tht(N0(r),e.status||500,i)}const Aht=(e,t,r,i)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),a.body=JSON.stringify(i),Object.assign(Object.assign({},a),r))};async function bi(e,t,r,i){var a;const l=Object.assign({},i==null?void 0:i.headers);l[AL]||(l[AL]=Hhe["2024-01-01"].name),i!=null&&i.jwt&&(l.Authorization=`Bearer ${i.jwt}`);const d=(a=i==null?void 0:i.query)!==null&&a!==void 0?a:{};i!=null&&i.redirectTo&&(d.redirect_to=i.redirectTo);const s=Object.keys(d).length?"?"+new URLSearchParams(d).toString():"",p=await Tht(e,t,r+s,{headers:l,noResolveJson:i==null?void 0:i.noResolveJson},{},i==null?void 0:i.body);return i!=null&&i.xform?i==null?void 0:i.xform(p):{data:Object.assign({},p),error:null}}async function Tht(e,t,r,i,a,l){const d=Aht(t,i,a,l);let s;try{s=await e(r,Object.assign({},d))}catch(p){throw console.error(p),new TL(N0(p),0)}if(s.ok||await wY(s),i!=null&&i.noResolveJson)return s;try{return await s.json()}catch(p){await wY(p)}}function ep(e){var t;let r=null;Mht(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=dht(e.expires_in)));const i=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:i},error:null}}function jY(e){const t=ep(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,i)=>r&&typeof i=="string",!0)&&(t.data.weak_password=e.weak_password),t}function hp(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function kht(e){return{data:e,error:null}}function Pht(e){const{action_link:t,email_otp:r,hashed_token:i,redirect_to:a,verification_type:l}=e,d=Sht(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),s={action_link:t,email_otp:r,hashed_token:i,redirect_to:a,verification_type:l},p=Object.assign({},d);return{data:{properties:s,user:p},error:null}}function Eht(e){return e}function Mht(e){return e.access_token&&e.refresh_token&&e.expires_in}var Iht=function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(e);a<i.length;a++)t.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(e,i[a])&&(r[i[a]]=e[i[a]]);return r};class Oht{constructor({url:t="",headers:r={},fetch:i}){this.url=t,this.headers=r,this.fetch=Khe(i),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,r="global"){try{return await bi(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(i){if(si(i))return{data:null,error:i};throw i}}async inviteUserByEmail(t,r={}){try{return await bi(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:hp})}catch(i){if(si(i))return{data:{user:null},error:i};throw i}}async generateLink(t){try{const{options:r}=t,i=Iht(t,["options"]),a=Object.assign(Object.assign({},i),r);return"newEmail"in i&&(a.new_email=i==null?void 0:i.newEmail,delete a.newEmail),await bi(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:Pht,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(si(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await bi(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:hp})}catch(r){if(si(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,i,a,l,d,s,p;try{const x={nextPage:null,lastPage:0,total:0},w=await bi(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(i=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&i!==void 0?i:"",per_page:(l=(a=t==null?void 0:t.perPage)===null||a===void 0?void 0:a.toString())!==null&&l!==void 0?l:""},xform:Eht});if(w.error)throw w.error;const j=await w.json(),S=(d=w.headers.get("x-total-count"))!==null&&d!==void 0?d:0,P=(p=(s=w.headers.get("link"))===null||s===void 0?void 0:s.split(","))!==null&&p!==void 0?p:[];return P.length>0&&(P.forEach(F=>{const L=parseInt(F.split(";")[0].split("=")[1].substring(0,1)),B=JSON.parse(F.split(";")[1].split("=")[1]);x[`${B}Page`]=L}),x.total=parseInt(S)),{data:Object.assign(Object.assign({},j),x),error:null}}catch(x){if(si(x))return{data:{users:[]},error:x};throw x}}async getUserById(t){try{return await bi(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:hp})}catch(r){if(si(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){try{return await bi(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:hp})}catch(i){if(si(i))return{data:{user:null},error:i};throw i}}async deleteUser(t,r=!1){try{return await bi(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:hp})}catch(i){if(si(i))return{data:{user:null},error:i};throw i}}async _listFactors(t){try{const{data:r,error:i}=await bi(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:r,error:i}}catch(r){if(si(r))return{data:null,error:r};throw r}}async _deleteFactor(t){try{return{data:await bi(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(si(r))return{data:null,error:r};throw r}}}const Rht={getItem:e=>Yj()?globalThis.localStorage.getItem(e):null,setItem:(e,t)=>{Yj()&&globalThis.localStorage.setItem(e,t)},removeItem:e=>{Yj()&&globalThis.localStorage.removeItem(e)}};function NY(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}function Dht(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const iv={debug:!!(globalThis&&Yj()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Yhe extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class zht extends Yhe{}async function Lht(e,t,r){iv.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const i=new globalThis.AbortController;return t>0&&setTimeout(()=>{i.abort(),iv.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:i.signal},async a=>{if(a){iv.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,a.name);try{return await r()}finally{iv.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,a.name)}}else{if(t===0)throw iv.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new zht(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(iv.debug)try{const l=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(l,null,"  "))}catch(l){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",l)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}Dht();const Fht={url:Ydt,storageKey:Xdt,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Jdt,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function SY(e,t,r){return await r()}class EN{constructor(t){var r,i;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=EN.nextInstanceID,EN.nextInstanceID+=1,this.instanceID>0&&Yd()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const a=Object.assign(Object.assign({},Fht),t);if(this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.persistSession=a.persistSession,this.storageKey=a.storageKey,this.autoRefreshToken=a.autoRefreshToken,this.admin=new Oht({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=Khe(a.fetch),this.lock=a.lock||SY,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,a.lock?this.lock=a.lock:Yd()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=Lht:this.lock=SY,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?a.storage?this.storage=a.storage:Yj()?this.storage=Rht:(this.memoryStorage={},this.storage=NY(this.memoryStorage)):(this.memoryStorage={},this.storage=NY(this.memoryStorage)),Yd()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(l){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",l)}(i=this.broadcastChannel)===null||i===void 0||i.addEventListener("message",async l=>{this._debug("received broadcast notification from other tab or client",l),await this._notifyAllSubscribers(l.data.event,l.data.session,!1)})}this.initialize()}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Ghe}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const r=mht(window.location.href);let i="none";if(this._isImplicitGrantCallback(r)?i="implicit":await this._isPKCECallback(r)&&(i="pkce"),Yd()&&this.detectSessionInUrl&&i!=="none"){const{data:a,error:l}=await this._getSessionFromURL(r,i);if(l){if(this._debug("#_initialize()","error detecting session from URL",l),iht(l)){const p=(t=l.details)===null||t===void 0?void 0:t.code;if(p==="identity_already_exists"||p==="identity_not_found"||p==="single_identity_not_deletable")return{error:l}}return await this._removeSession(),{error:l}}const{session:d,redirectType:s}=a;return this._debug("#_initialize()","detected session in URL",d,"redirect type",s),await this._saveSession(d),setTimeout(async()=>{s==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",d):await this._notifyAllSubscribers("SIGNED_IN",d)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return si(r)?{error:r}:{error:new qhe("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,i,a;try{const l=await bi(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(i=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&i!==void 0?i:{},gotrue_meta_security:{captcha_token:(a=t==null?void 0:t.options)===null||a===void 0?void 0:a.captchaToken}},xform:ep}),{data:d,error:s}=l;if(s||!d)return{data:{user:null,session:null},error:s};const p=d.session,x=d.user;return d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",p)),{data:{user:x,session:p},error:null}}catch(l){if(si(l))return{data:{user:null,session:null},error:l};throw l}}async signUp(t){var r,i,a;try{let l;if("email"in t){const{email:w,password:j,options:S}=t;let P=null,F=null;this.flowType==="pkce"&&([P,F]=await nv(this.storage,this.storageKey)),l=await bi(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:S==null?void 0:S.emailRedirectTo,body:{email:w,password:j,data:(r=S==null?void 0:S.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:S==null?void 0:S.captchaToken},code_challenge:P,code_challenge_method:F},xform:ep})}else if("phone"in t){const{phone:w,password:j,options:S}=t;l=await bi(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:w,password:j,data:(i=S==null?void 0:S.data)!==null&&i!==void 0?i:{},channel:(a=S==null?void 0:S.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:S==null?void 0:S.captchaToken}},xform:ep})}else throw new uT("You must provide either an email or phone number and a password");const{data:d,error:s}=l;if(s||!d)return{data:{user:null,session:null},error:s};const p=d.session,x=d.user;return d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",p)),{data:{user:x,session:p},error:null}}catch(l){if(si(l))return{data:{user:null,session:null},error:l};throw l}}async signInWithPassword(t){try{let r;if("email"in t){const{email:l,password:d,options:s}=t;r=await bi(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:l,password:d,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},xform:jY})}else if("phone"in t){const{phone:l,password:d,options:s}=t;r=await bi(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:l,password:d,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},xform:jY})}else throw new uT("You must provide either an email or phone number and a password");const{data:i,error:a}=r;return a?{data:{user:null,session:null},error:a}:!i||!i.session||!i.user?{data:{user:null,session:null},error:new DR}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign({user:i.user,session:i.session},i.weak_password?{weakPassword:i.weak_password}:null),error:a})}catch(r){if(si(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(t){var r,i,a,l;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(i=t.options)===null||i===void 0?void 0:i.scopes,queryParams:(a=t.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(l=t.options)===null||l===void 0?void 0:l.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async _exchangeCodeForSession(t){const r=await hT(this.storage,`${this.storageKey}-code-verifier`),[i,a]=(r??"").split("/");try{const{data:l,error:d}=await bi(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:i},xform:ep});if(await mT(this.storage,`${this.storageKey}-code-verifier`),d)throw d;return!l||!l.session||!l.user?{data:{user:null,session:null,redirectType:null},error:new DR}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:Object.assign(Object.assign({},l),{redirectType:a??null}),error:d})}catch(l){if(si(l))return{data:{user:null,session:null,redirectType:null},error:l};throw l}}async signInWithIdToken(t){try{const{options:r,provider:i,token:a,access_token:l,nonce:d}=t,s=await bi(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:i,id_token:a,access_token:l,nonce:d,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:ep}),{data:p,error:x}=s;return x?{data:{user:null,session:null},error:x}:!p||!p.session||!p.user?{data:{user:null,session:null},error:new DR}:(p.session&&(await this._saveSession(p.session),await this._notifyAllSubscribers("SIGNED_IN",p.session)),{data:p,error:x})}catch(r){if(si(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(t){var r,i,a,l,d;try{if("email"in t){const{email:s,options:p}=t;let x=null,w=null;this.flowType==="pkce"&&([x,w]=await nv(this.storage,this.storageKey));const{error:j}=await bi(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:s,data:(r=p==null?void 0:p.data)!==null&&r!==void 0?r:{},create_user:(i=p==null?void 0:p.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken},code_challenge:x,code_challenge_method:w},redirectTo:p==null?void 0:p.emailRedirectTo});return{data:{user:null,session:null},error:j}}if("phone"in t){const{phone:s,options:p}=t,{data:x,error:w}=await bi(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:s,data:(a=p==null?void 0:p.data)!==null&&a!==void 0?a:{},create_user:(l=p==null?void 0:p.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken},channel:(d=p==null?void 0:p.channel)!==null&&d!==void 0?d:"sms"}});return{data:{user:null,session:null,messageId:x==null?void 0:x.message_id},error:w}}throw new uT("You must provide either an email or phone number.")}catch(s){if(si(s))return{data:{user:null,session:null},error:s};throw s}}async verifyOtp(t){var r,i;try{let a,l;"options"in t&&(a=(r=t.options)===null||r===void 0?void 0:r.redirectTo,l=(i=t.options)===null||i===void 0?void 0:i.captchaToken);const{data:d,error:s}=await bi(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:l}}),redirectTo:a,xform:ep});if(s)throw s;if(!d)throw new Error("An error occurred on token verification.");const p=d.session,x=d.user;return p!=null&&p.access_token&&(await this._saveSession(p),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",p)),{data:{user:x,session:p},error:null}}catch(a){if(si(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithSSO(t){var r,i,a;try{let l=null,d=null;return this.flowType==="pkce"&&([l,d]=await nv(this.storage,this.storageKey)),await bi(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(i=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&i!==void 0?i:void 0}),!((a=t==null?void 0:t.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:l,code_challenge_method:d}),headers:this.headers,xform:kht})}catch(l){if(si(l))return{data:null,error:l};throw l}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:i}=t;if(i)throw i;if(!r)throw new Qf;const{error:a}=await bi(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:a}})}catch(t){if(si(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:i,type:a,options:l}=t,{error:d}=await bi(this.fetch,"POST",r,{headers:this.headers,body:{email:i,type:a,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:d}}else if("phone"in t){const{phone:i,type:a,options:l}=t,{data:d,error:s}=await bi(this.fetch,"POST",r,{headers:this.headers,body:{phone:i,type:a,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}}});return{data:{user:null,session:null,messageId:d==null?void 0:d.message_id},error:s}}throw new uT("You must provide either an email or phone number and a type")}catch(r){if(si(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const i=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await i,await r()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const i=r();for(this.pendingInLock.push((async()=>{try{await i}catch{}})()),await i;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await i}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await hT(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const i=t.expires_at?t.expires_at*1e3-Date.now()<RR:!1;if(this._debug("#__loadSession()",`session has${i?"":" not"} expired`,"expires_at",t.expires_at),!i){if(this.storage.isServer){let d=this.suppressGetSessionWarning;t=new Proxy(t,{get:(p,x,w)=>(!d&&x==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),d=!0,this.suppressGetSessionWarning=!0),Reflect.get(p,x,w))})}return{data:{session:t},error:null}}const{session:a,error:l}=await this._callRefreshToken(t.refresh_token);return l?{data:{session:null},error:l}:{data:{session:a},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await bi(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:hp}):await this._useSession(async r=>{var i,a,l;const{data:d,error:s}=r;if(s)throw s;return!(!((i=d.session)===null||i===void 0)&&i.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Qf}:await bi(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(l=(a=d.session)===null||a===void 0?void 0:a.access_token)!==null&&l!==void 0?l:void 0,xform:hp})})}catch(r){if(si(r))return nht(r)&&(await this._removeSession(),await mT(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async i=>{const{data:a,error:l}=i;if(l)throw l;if(!a.session)throw new Qf;const d=a.session;let s=null,p=null;this.flowType==="pkce"&&t.email!=null&&([s,p]=await nv(this.storage,this.storageKey));const{data:x,error:w}=await bi(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:s,code_challenge_method:p}),jwt:d.access_token,xform:hp});if(w)throw w;return d.user=x.user,await this._saveSession(d),await this._notifyAllSubscribers("USER_UPDATED",d),{data:{user:d.user},error:null}})}catch(i){if(si(i))return{data:{user:null},error:i};throw i}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Qf;const r=Date.now()/1e3;let i=r,a=!0,l=null;const{payload:d}=LR(t.access_token);if(d.exp&&(i=d.exp,a=i<=r),a){const{session:s,error:p}=await this._callRefreshToken(t.refresh_token);if(p)return{data:{user:null,session:null},error:p};if(!s)return{data:{user:null,session:null},error:null};l=s}else{const{data:s,error:p}=await this._getUser(t.access_token);if(p)throw p;l={access_token:t.access_token,refresh_token:t.refresh_token,user:s.user,token_type:"bearer",expires_in:i-r,expires_at:i},await this._saveSession(l),await this._notifyAllSubscribers("SIGNED_IN",l)}return{data:{user:l.user,session:l},error:null}}catch(r){if(si(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var i;if(!t){const{data:d,error:s}=r;if(s)throw s;t=(i=d.session)!==null&&i!==void 0?i:void 0}if(!(t!=null&&t.refresh_token))throw new Qf;const{session:a,error:l}=await this._callRefreshToken(t.refresh_token);return l?{data:{user:null,session:null},error:l}:a?{data:{user:a.user,session:a},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(si(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(t,r){try{if(!Yd())throw new dT("No browser detected.");if(t.error||t.error_description||t.error_code)throw new dT(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new xY("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new dT("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new xY("No code detected.");const{data:$,error:G}=await this._exchangeCodeForSession(t.code);if(G)throw G;const W=new URL(window.location.href);return W.searchParams.delete("code"),window.history.replaceState(window.history.state,"",W.toString()),{data:{session:$.session,redirectType:null},error:null}}const{provider_token:i,provider_refresh_token:a,access_token:l,refresh_token:d,expires_in:s,expires_at:p,token_type:x}=t;if(!l||!s||!d||!x)throw new dT("No session defined in URL");const w=Math.round(Date.now()/1e3),j=parseInt(s);let S=w+j;p&&(S=parseInt(p));const P=S-w;P*1e3<=lv&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${P}s, should have been closer to ${j}s`);const F=S-j;w-F>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",F,S,w):w-F<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",F,S,w);const{data:L,error:B}=await this._getUser(l);if(B)throw B;const V={provider_token:i,provider_refresh_token:a,access_token:l,expires_in:j,expires_at:S,refresh_token:d,token_type:x,user:L.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:V,redirectType:t.type},error:null}}catch(i){if(si(i))return{data:{session:null,redirectType:null},error:i};throw i}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await hT(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var i;const{data:a,error:l}=r;if(l)return{error:l};const d=(i=a.session)===null||i===void 0?void 0:i.access_token;if(d){const{error:s}=await this.admin.signOut(d,t);if(s&&!(rht(s)&&(s.status===404||s.status===401||s.status===403)))return{error:s}}return t!=="others"&&(await this._removeSession(),await mT(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const r=hht(),i={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,i),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:i}}}async _emitInitialSession(t){return await this._useSession(async r=>{var i,a;try{const{data:{session:l},error:d}=r;if(d)throw d;await((i=this.stateChangeEmitters.get(t))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",l)),this._debug("INITIAL_SESSION","callback id",t,"session",l)}catch(l){await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",l),console.error(l)}})}async resetPasswordForEmail(t,r={}){let i=null,a=null;this.flowType==="pkce"&&([i,a]=await nv(this.storage,this.storageKey,!0));try{return await bi(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:i,code_challenge_method:a,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(l){if(si(l))return{data:null,error:l};throw l}}async getUserIdentities(){var t;try{const{data:r,error:i}=await this.getUser();if(i)throw i;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(si(r))return{data:null,error:r};throw r}}async linkIdentity(t){var r;try{const{data:i,error:a}=await this._useSession(async l=>{var d,s,p,x,w;const{data:j,error:S}=l;if(S)throw S;const P=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(d=t.options)===null||d===void 0?void 0:d.redirectTo,scopes:(s=t.options)===null||s===void 0?void 0:s.scopes,queryParams:(p=t.options)===null||p===void 0?void 0:p.queryParams,skipBrowserRedirect:!0});return await bi(this.fetch,"GET",P,{headers:this.headers,jwt:(w=(x=j.session)===null||x===void 0?void 0:x.access_token)!==null&&w!==void 0?w:void 0})});if(a)throw a;return Yd()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(i==null?void 0:i.url),{data:{provider:t.provider,url:i==null?void 0:i.url},error:null}}catch(i){if(si(i))return{data:{provider:t.provider,url:null},error:i};throw i}}async unlinkIdentity(t){try{return await this._useSession(async r=>{var i,a;const{data:l,error:d}=r;if(d)throw d;return await bi(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(a=(i=l.session)===null||i===void 0?void 0:i.access_token)!==null&&a!==void 0?a:void 0})})}catch(r){if(si(r))return{data:null,error:r};throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const i=Date.now();return await ght(async a=>(a>0&&await pht(200*Math.pow(2,a-1)),this._debug(r,"refreshing attempt",a),await bi(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:ep})),(a,l)=>{const d=200*Math.pow(2,a);return l&&zR(l)&&Date.now()+d-i<lv})}catch(i){if(this._debug(r,"error",i),si(i))return{data:{session:null,user:null},error:i};throw i}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const i=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",i),Yd()&&!r.skipBrowserRedirect&&window.location.assign(i),{data:{provider:t,url:i},error:null}}async _recoverAndRefresh(){var t;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const i=await hT(this.storage,this.storageKey);if(this._debug(r,"session from storage",i),!this._isValidSession(i)){this._debug(r,"session is not valid"),i!==null&&await this._removeSession();return}const a=((t=i.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<RR;if(this._debug(r,`session has${a?"":" not"} expired with margin of ${RR}s`),a){if(this.autoRefreshToken&&i.refresh_token){const{error:l}=await this._callRefreshToken(i.refresh_token);l&&(console.error(l),zR(l)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",l),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",i)}catch(i){this._debug(r,"error",i),console.error(i);return}finally{this._debug(r,"end")}}async _callRefreshToken(t){var r,i;if(!t)throw new Qf;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new O3;const{data:l,error:d}=await this._refreshAccessToken(t);if(d)throw d;if(!l.session)throw new Qf;await this._saveSession(l.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",l.session);const s={session:l.session,error:null};return this.refreshingDeferred.resolve(s),s}catch(l){if(this._debug(a,"error",l),si(l)){const d={session:null,error:l};return zR(l)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(d),d}throw(i=this.refreshingDeferred)===null||i===void 0||i.reject(l),l}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(t,r,i=!0){const a=`#_notifyAllSubscribers(${t})`;this._debug(a,"begin",r,`broadcast = ${i}`);try{this.broadcastChannel&&i&&this.broadcastChannel.postMessage({event:t,session:r});const l=[],d=Array.from(this.stateChangeEmitters.values()).map(async s=>{try{await s.callback(t,r)}catch(p){l.push(p)}});if(await Promise.all(d),l.length>0){for(let s=0;s<l.length;s+=1)console.error(l[s]);throw l[0]}}finally{this._debug(a,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await Zhe(this.storage,this.storageKey,t)}async _removeSession(){this._debug("#_removeSession()"),await mT(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&Yd()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),lv);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:i}}=r;if(!i||!i.refresh_token||!i.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((i.expires_at*1e3-t)/lv);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${lv}ms, refresh threshold is ${CL} ticks`),a<=CL&&await this._callRefreshToken(i.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof Yhe)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Yd()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,i){const a=[`provider=${encodeURIComponent(r)}`];if(i!=null&&i.redirectTo&&a.push(`redirect_to=${encodeURIComponent(i.redirectTo)}`),i!=null&&i.scopes&&a.push(`scopes=${encodeURIComponent(i.scopes)}`),this.flowType==="pkce"){const[l,d]=await nv(this.storage,this.storageKey),s=new URLSearchParams({code_challenge:`${encodeURIComponent(l)}`,code_challenge_method:`${encodeURIComponent(d)}`});a.push(s.toString())}if(i!=null&&i.queryParams){const l=new URLSearchParams(i.queryParams);a.push(l.toString())}return i!=null&&i.skipBrowserRedirect&&a.push(`skip_http_redirect=${i.skipBrowserRedirect}`),`${t}?${a.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var i;const{data:a,error:l}=r;return l?{data:null,error:l}:await bi(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(i=a==null?void 0:a.session)===null||i===void 0?void 0:i.access_token})})}catch(r){if(si(r))return{data:null,error:r};throw r}}async _enroll(t){try{return await this._useSession(async r=>{var i,a;const{data:l,error:d}=r;if(d)return{data:null,error:d};const s=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:p,error:x}=await bi(this.fetch,"POST",`${this.url}/factors`,{body:s,headers:this.headers,jwt:(i=l==null?void 0:l.session)===null||i===void 0?void 0:i.access_token});return x?{data:null,error:x}:(t.factorType==="totp"&&(!((a=p==null?void 0:p.totp)===null||a===void 0)&&a.qr_code)&&(p.totp.qr_code=`data:image/svg+xml;utf-8,${p.totp.qr_code}`),{data:p,error:null})})}catch(r){if(si(r))return{data:null,error:r};throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var i;const{data:a,error:l}=r;if(l)return{data:null,error:l};const{data:d,error:s}=await bi(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(i=a==null?void 0:a.session)===null||i===void 0?void 0:i.access_token});return s?{data:null,error:s}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+d.expires_in},d)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",d),{data:d,error:s})})}catch(r){if(si(r))return{data:null,error:r};throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var i;const{data:a,error:l}=r;return l?{data:null,error:l}:await bi(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(i=a==null?void 0:a.session)===null||i===void 0?void 0:i.access_token})})}catch(r){if(si(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(t){const{data:r,error:i}=await this._challenge({factorId:t.factorId});return i?{data:null,error:i}:await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const i=(t==null?void 0:t.factors)||[],a=i.filter(d=>d.factor_type==="totp"&&d.status==="verified"),l=i.filter(d=>d.factor_type==="phone"&&d.status==="verified");return{data:{all:i,totp:a,phone:l},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var r,i;const{data:{session:a},error:l}=t;if(l)return{data:null,error:l};if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:d}=LR(a.access_token);let s=null;d.aal&&(s=d.aal);let p=s;((i=(r=a.user.factors)===null||r===void 0?void 0:r.filter(j=>j.status==="verified"))!==null&&i!==void 0?i:[]).length>0&&(p="aal2");const w=d.amr||[];return{data:{currentLevel:s,nextLevel:p,currentAuthenticationMethods:w},error:null}}))}async fetchJwk(t,r={keys:[]}){let i=r.keys.find(d=>d.kid===t);if(i||(i=this.jwks.keys.find(d=>d.kid===t),i&&this.jwks_cached_at+eht>Date.now()))return i;const{data:a,error:l}=await bi(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(l)throw l;if(!a.keys||a.keys.length===0)throw new Zj("JWKS is empty");if(this.jwks=a,this.jwks_cached_at=Date.now(),i=a.keys.find(d=>d.kid===t),!i)throw new Zj("No matching signing key found in JWKS");return i}async getClaims(t,r={keys:[]}){try{let i=t;if(!i){const{data:P,error:F}=await this.getSession();if(F||!P.session)return{data:null,error:F};i=P.session.access_token}const{header:a,payload:l,signature:d,raw:{header:s,payload:p}}=LR(i);if(jht(l.exp),!a.kid||a.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:P}=await this.getUser(i);if(P)throw P;return{data:{claims:l,header:a,signature:d},error:null}}const x=Nht(a.alg),w=await this.fetchJwk(a.kid,r),j=await crypto.subtle.importKey("jwk",w,x,!0,["verify"]);if(!await crypto.subtle.verify(x,j,d,uht(`${s}.${p}`)))throw new Zj("Invalid JWT signature");return{data:{claims:l,header:a,signature:d},error:null}}catch(i){if(si(i))return{data:null,error:i};throw i}}}EN.nextInstanceID=0;const Bht=EN;class $ht extends Bht{constructor(t){super(t)}}var Vht=function(e,t,r,i){function a(l){return l instanceof r?l:new r(function(d){d(l)})}return new(r||(r=Promise))(function(l,d){function s(w){try{x(i.next(w))}catch(j){d(j)}}function p(w){try{x(i.throw(w))}catch(j){d(j)}}function x(w){w.done?l(w.value):a(w.value).then(s,p)}x((i=i.apply(e,t||[])).next())})};class Uht{constructor(t,r,i){var a,l,d;if(this.supabaseUrl=t,this.supabaseKey=r,!t)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const s=Kdt(t);this.realtimeUrl=`${s}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${s}/auth/v1`,this.storageUrl=`${s}/storage/v1`,this.functionsUrl=`${s}/functions/v1`;const p=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,x={db:Bdt,realtime:Vdt,auth:Object.assign(Object.assign({},$dt),{storageKey:p}),global:Fdt},w=Zdt(i??{},x);this.storageKey=(a=w.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(l=w.global.headers)!==null&&l!==void 0?l:{},w.accessToken?(this.accessToken=w.accessToken,this.auth=new Proxy({},{get:(j,S)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(S)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((d=w.auth)!==null&&d!==void 0?d:{},this.headers,w.global.fetch),this.fetch=qdt(r,this._getAccessToken.bind(this),w.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},w.realtime)),this.rest=new odt(`${s}/rest/v1`,{headers:this.headers,schema:w.db.schema,fetch:this.fetch}),w.accessToken||this._listenForAuthEvents()}get functions(){return new zut(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new Ddt(this.storageUrl,this.headers,this.fetch)}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},i={}){return this.rest.rpc(t,r,i)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,r;return Vht(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:i}=yield this.auth.getSession();return(r=(t=i.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:null})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:i,storage:a,storageKey:l,flowType:d,lock:s,debug:p},x,w){const j={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new $ht({url:this.authUrl,headers:Object.assign(Object.assign({},j),x),storageKey:l,autoRefreshToken:t,persistSession:r,detectSessionInUrl:i,storage:a,flowType:d,lock:s,debug:p,fetch:w,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(t){return new wdt(this.realtimeUrl,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,i)=>{this._handleTokenChanged(r,"CLIENT",i==null?void 0:i.access_token)})}_handleTokenChanged(t,r,i){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==i?this.changedAccessToken=i:t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Ght=(e,t,r)=>new Uht(e,t,r),Hht="https://dkjtdubmpcatqtlzlthf.supabase.co",qht="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRranRkdWJtcGNhdHF0bHpsdGhmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDc0OTM2ODEsImV4cCI6MjA2MzA2OTY4MX0.OgNWv5RHpR851BSz5TPA4YHZ8k0bI3P4oe_1-9NL3nk",Wht=Ght(Hht,qht),sv=Wht,Kht=e=>{switch(e){case"free":return"bg-emerald-500/20 text-emerald-300 border-emerald-500/30";case"standard":return"bg-blue-500/20 text-blue-300 border-blue-500/30";case"premium":return"bg-purple-500/20 text-purple-300 border-purple-500/30";case"enterprise":return"bg-amber-500/20 text-amber-300 border-amber-500/30";default:return"bg-gray-500/20 text-gray-300 border-gray-500/30"}},Zht=e=>{switch(e){case"active":return"bg-emerald-500/20 text-emerald-300 border-emerald-500/30";case"pending":return"bg-amber-500/20 text-amber-300 border-amber-500/30";case"expired":return"bg-rose-500/20 text-rose-300 border-rose-500/30";case"inactive":return"bg-gray-500/20 text-gray-300 border-gray-500/30";default:return"bg-gray-500/20 text-gray-300 border-gray-500/30"}},z$=e=>{switch(e.toLowerCase()){case"customer support":return n.jsx(qi,{className:"h-4 w-4"});case"security":return n.jsx(dn,{className:"h-4 w-4"});case"network":return n.jsx(Zs,{className:"h-4 w-4"});case"content":return n.jsx(Nh,{className:"h-4 w-4"});case"operations":return n.jsx(ws,{className:"h-4 w-4"});case"finance":return n.jsx(En,{className:"h-4 w-4"});default:return n.jsx(ti,{className:"h-4 w-4"})}},Yht=e=>({"Network Performance Monitor":"Claude Sonnet 4","Customer Care Assistant":"GPT-4.1","Revenue Assurance Agent":"Claude Opus 4","Field Service Optimizer":"GPT-4.1","Spectrum Management AI":"Claude Opus 4","Churn Prediction Engine":"GPT-4.1","Network Capacity Planner":"Claude Sonnet 4","Regulatory Compliance Monitor":"GPT-4.1"})[e]||"GPT-4.1",Xht=e=>({"Network Performance Monitor":["Cell Tower DB","Signal Metrics","Fault Logs","Performance KPIs"],"Customer Care Assistant":["CRM Database","Billing System","Service History","Knowledge Base"],"Revenue Assurance Agent":["Billing Records","Usage Data","Payment History","Fraud Database"],"Field Service Optimizer":["Work Orders","Technician Schedules","Inventory DB","Traffic Data"],"Spectrum Management AI":["Spectrum Database","Interference Logs","Regulatory DB","RF Measurements"],"Churn Prediction Engine":["Customer Analytics","Usage Patterns","Payment Data","Support Tickets"],"Network Capacity Planner":["Traffic Analytics","Network Topology","Growth Forecasts","Infrastructure DB"],"Regulatory Compliance Monitor":["Compliance DB","Audit Logs","Regulatory Updates","QoS Metrics"]})[e]||["Internal Database","Analytics Platform"],Jht=e=>({"Network Performance Monitor":["NetAct","Grafana","AlertManager","OSS/BSS"],"Customer Care Assistant":["ServiceNow","Salesforce","Zendesk","SMS Gateway"],"Revenue Assurance Agent":["AMDOCS","Oracle BRM","Risk Engine","Fraud Detection"],"Field Service Optimizer":["SAP FSM","Google Maps","Mobile App","Inventory System"],"Spectrum Management AI":["Spectrum Analyzer","RFSIM","Compliance Portal","RF Planning Tools"],"Churn Prediction Engine":["Tableau","Campaign Manager","Email Platform","ML Pipeline"],"Network Capacity Planner":["NetPlanner","Forecast Engine","Asset Management","GIS Platform"],"Regulatory Compliance Monitor":["Audit Portal","Document System","Reporting Engine","Alert System"]})[e]||["API Gateway","Dashboard","Reporting"],Qht=()=>{const[e,t]=U.useState([]),[r,i]=U.useState([]),[a,l]=U.useState([]),[d,s]=U.useState(!0),[p,x]=U.useState(""),[w,j]=U.useState("all"),[S,P]=U.useState("all"),[F,L]=U.useState("marketplace"),{toast:B}=Ah();U.useEffect(()=>{V()},[]);const V=async()=>{try{s(!0);const{data:se,error:ae}=await sv.from("agent_catalog").select("*").order("created_at",{ascending:!1});if(ae)throw ae;t(se||[]);const{data:{user:ce}}=await sv.auth.getUser();if(ce){const[Pe,we]=await Promise.all([sv.from("agent_subscriptions").select("*").eq("user_id",ce.id),sv.from("agent_requests").select("*").eq("user_id",ce.id).order("requested_at",{ascending:!1})]);if(Pe.error)throw Pe.error;if(we.error)throw we.error;i(Pe.data||[]),l(we.data||[])}}catch(se){console.error("Error fetching data:",se),B({title:"Error",description:"Failed to load marketplace data",variant:"destructive"})}finally{s(!1)}},$=async(se,ae,ce)=>{try{const{data:{user:Pe}}=await sv.auth.getUser();if(!Pe){B({title:"Authentication Required",description:"Please log in to subscribe to agents",variant:"destructive"});return}const{error:we}=await sv.from("agent_requests").insert({user_id:Pe.id,agent_id:se.id,request_type:"subscribe",justification:ce});if(we)throw we;B({title:"Request Submitted",description:`Your subscription request for ${se.name} has been submitted for approval.`}),V()}catch(Pe){console.error("Error submitting request:",Pe),B({title:"Error",description:"Failed to submit subscription request",variant:"destructive"})}},G=e.filter(se=>{const ae=se.name.toLowerCase().includes(p.toLowerCase())||se.description.toLowerCase().includes(p.toLowerCase())||se.tags.some(we=>we.toLowerCase().includes(p.toLowerCase())),ce=w==="all"||se.category===w,Pe=S==="all"||se.tier===S;return ae&&ce&&Pe}),W=[...new Set(e.map(se=>se.category))],Z=["free","standard","premium","enterprise"];return d?n.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-400"})}):n.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 relative overflow-hidden",children:[n.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[n.jsx("div",{className:"absolute -top-40 -right-32 w-96 h-96 bg-gradient-to-r from-purple-500/30 to-blue-500/30 rounded-full blur-3xl"}),n.jsx("div",{className:"absolute -bottom-40 -left-32 w-96 h-96 bg-gradient-to-r from-blue-500/30 to-purple-500/30 rounded-full blur-3xl"})]}),n.jsxs("div",{className:"relative z-10 p-6 space-y-8",children:[n.jsxs("div",{className:"text-center mb-12",children:[n.jsx("h1",{className:"text-4xl font-bold text-white mb-4",children:"Agent Marketplace"}),n.jsx("p",{className:"text-purple-200 text-lg max-w-2xl mx-auto",children:"Discover and subscribe to AI agents that transform your workflow"}),n.jsx("div",{className:"flex items-center justify-center mt-4",children:n.jsxs(Tt,{className:"bg-purple-500/20 text-purple-300 border-purple-500/30",variant:"outline",children:[n.jsx(DF,{className:"h-3 w-3 mr-1"}),e.length," Agents Available"]})})]}),n.jsxs($i,{value:F,onValueChange:L,className:"w-full max-w-7xl mx-auto",children:[n.jsxs(Di,{className:"grid w-full grid-cols-4 bg-white/5 backdrop-blur-md border-white/10",children:[n.jsx(Jt,{value:"marketplace",className:"text-white data-[state=active]:bg-purple-500/30",children:"Marketplace"}),n.jsx(Jt,{value:"subscriptions",className:"text-white data-[state=active]:bg-purple-500/30",children:"My Subscriptions"}),n.jsx(Jt,{value:"requests",className:"text-white data-[state=active]:bg-purple-500/30",children:"My Requests"}),n.jsx(Jt,{value:"analytics",className:"text-white data-[state=active]:bg-purple-500/30",children:"Analytics"})]}),n.jsxs(ur,{value:"marketplace",className:"space-y-8",children:[n.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 bg-white/5 backdrop-blur-md border border-white/10 rounded-2xl p-6",children:[n.jsxs("div",{className:"relative flex-1",children:[n.jsx($c,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-purple-300"}),n.jsx(An,{placeholder:"Search agents by name, description, or tags...",value:p,onChange:se=>x(se.target.value),className:"pl-10 bg-white/5 border-white/10 text-white placeholder:text-purple-200 focus:border-purple-400"})]}),n.jsxs(_n,{value:w,onValueChange:j,children:[n.jsx(xn,{className:"w-[180px] bg-white/5 border-white/10 text-white",children:n.jsx(wn,{placeholder:"Category"})}),n.jsxs(yn,{className:"bg-slate-800 border-slate-700",children:[n.jsx(yt,{value:"all",children:"All Categories"}),W.map(se=>n.jsx(yt,{value:se,children:se},se))]})]}),n.jsxs(_n,{value:S,onValueChange:P,children:[n.jsx(xn,{className:"w-[150px] bg-white/5 border-white/10 text-white",children:n.jsx(wn,{placeholder:"Tier"})}),n.jsxs(yn,{className:"bg-slate-800 border-slate-700",children:[n.jsx(yt,{value:"all",children:"All Tiers"}),Z.map(se=>n.jsx(yt,{value:se,children:se.charAt(0).toUpperCase()+se.slice(1)},se))]})]})]}),n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:G.map(se=>{const ae=r.some(Pe=>Pe.agent_id===se.id&&Pe.status==="active"),ce=a.some(Pe=>Pe.agent_id===se.id&&Pe.status==="pending");return n.jsx(emt,{agent:se,isSubscribed:ae,hasPendingRequest:ce,onSubscribeRequest:$},se.id)})}),G.length===0&&n.jsxs("div",{className:"text-center py-12 bg-white/5 backdrop-blur-md border border-white/10 rounded-2xl",children:[n.jsx(Hi,{className:"h-12 w-12 text-purple-300 mx-auto mb-4"}),n.jsx("h3",{className:"text-lg font-semibold text-white",children:"No agents found"}),n.jsx("p",{className:"text-purple-200",children:"Try adjusting your search criteria"})]})]}),n.jsx(ur,{value:"subscriptions",className:"space-y-6",children:n.jsx(rmt,{subscriptions:r,agents:e})}),n.jsx(ur,{value:"requests",className:"space-y-6",children:n.jsx(nmt,{requests:a,agents:e})}),n.jsx(ur,{value:"analytics",className:"space-y-6",children:n.jsx(imt,{subscriptions:r,requests:a})})]})]})]})},emt=({agent:e,isSubscribed:t,hasPendingRequest:r,onSubscribeRequest:i})=>{const[a,l]=U.useState(!1);return n.jsxs(jt,{className:"h-full flex flex-col bg-white/5 backdrop-blur-md border-white/10 hover:border-purple-400/50 transition-all duration-300 group",children:[n.jsx(wr,{className:"pb-4",children:n.jsx("div",{className:"flex items-start justify-between",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs(S3,{className:"h-12 w-12 bg-gradient-to-r from-purple-500 to-blue-500",children:[n.jsx(C3,{src:e.icon}),n.jsx(A3,{className:"bg-transparent text-white",children:z$(e.category)})]}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx(fr,{className:"text-lg text-white truncate",children:e.name}),n.jsx(Ii,{className:"text-purple-200",children:Yht(e.name)})]})]})})}),n.jsxs(Ht,{className:"flex-1 space-y-4",children:[n.jsx("p",{className:"text-sm text-purple-100 line-clamp-3",children:e.description}),n.jsx("div",{className:"flex items-center gap-2",children:n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(FF,{className:"h-4 w-4 fill-yellow-400 text-yellow-400"}),n.jsx("span",{className:"text-sm font-medium text-white",children:e.rating}),n.jsxs("span",{className:"text-sm text-purple-200",children:["(",e.total_reviews," reviews)"]})]})}),n.jsxs("div",{className:"flex flex-wrap gap-1",children:[e.tags.slice(0,3).map(d=>n.jsx(Tt,{className:"bg-purple-500/20 text-purple-300 border-purple-500/30",variant:"outline",children:d},d)),e.tags.length>3&&n.jsxs(Tt,{className:"bg-gray-500/20 text-gray-300 border-gray-500/30",variant:"outline",children:["+",e.tags.length-3]})]}),n.jsxs("div",{className:"space-y-4 bg-white/5 rounded-lg p-4",children:[n.jsx("div",{className:"text-sm font-medium text-white mb-3",children:"Agent Capabilities"}),n.jsx("div",{className:"text-sm text-white mb-4",children:e.description}),n.jsxs("div",{className:"space-y-2",children:[n.jsx("div",{className:"text-xs text-purple-200 uppercase tracking-wide",children:"Data Sources"}),n.jsx("div",{className:"flex flex-wrap gap-1",children:Xht(e.name).map(d=>n.jsx(Tt,{className:"bg-blue-500/20 text-blue-300 border-blue-500/30 text-xs",variant:"outline",children:d},d))})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx("div",{className:"text-xs text-purple-200 uppercase tracking-wide",children:"Tools & Integrations"}),n.jsx("div",{className:"flex flex-wrap gap-1",children:Jht(e.name).map(d=>n.jsx(Tt,{className:"bg-green-500/20 text-green-300 border-green-500/30 text-xs",variant:"outline",children:d},d))})]}),e.metrics&&Object.keys(e.metrics).length>0&&n.jsx("div",{className:"grid grid-cols-2 gap-3 text-xs pt-2 border-t border-white/10",children:Object.entries(e.metrics).slice(0,2).map(([d,s])=>n.jsxs("div",{className:"space-y-1",children:[n.jsx("div",{className:"text-purple-200 capitalize",children:d.replace(/_/g," ")}),n.jsxs("div",{className:"text-white font-medium",children:[typeof s=="number"?s.toFixed(1):String(s),d.includes("accuracy")||d.includes("rate")?"%":d.includes("time")?"s":""]})]},d))})]})]}),n.jsx(WE,{className:"pt-4 space-y-2",children:n.jsxs("div",{className:"flex gap-2 w-full",children:[t?n.jsxs(lt,{className:"flex-1 bg-emerald-500/20 text-emerald-300 border-emerald-500/30 hover:bg-emerald-500/30",variant:"outline",disabled:!0,children:[n.jsx(ro,{className:"h-4 w-4 mr-2"}),"Subscribed"]}):r?n.jsxs(lt,{className:"flex-1 bg-amber-500/20 text-amber-300 border-amber-500/30 hover:bg-amber-500/30",variant:"outline",disabled:!0,children:[n.jsx($a,{className:"h-4 w-4 mr-2"}),"Request Pending"]}):n.jsxs(lt,{className:"flex-1 bg-gradient-to-r from-purple-500 to-blue-500 hover:from-purple-600 hover:to-blue-600 text-white border-0",onClick:()=>l(!0),children:[n.jsx(Sh,{className:"h-4 w-4 mr-2"}),"Request Access"]}),e.documentation_url&&n.jsx(lt,{variant:"outline",size:"icon",className:"bg-white/5 border-white/10 text-white hover:bg-white/10",asChild:!0,children:n.jsx("a",{href:e.documentation_url,target:"_blank",rel:"noopener noreferrer",children:n.jsx(IF,{className:"h-4 w-4"})})})]})}),a&&n.jsx(tmt,{agent:e,onSubmit:i,onClose:()=>l(!1)})]})},tmt=({agent:e,onSubmit:t,onClose:r})=>{const[i,a]=U.useState(""),l=()=>{i.trim()&&(t(e,"",i),r())};return n.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:n.jsxs(jt,{className:"w-full max-w-md bg-slate-800/90 backdrop-blur-md border-slate-700",children:[n.jsxs(wr,{children:[n.jsx(fr,{className:"text-white",children:"Request Agent Access"}),n.jsxs(Ii,{className:"text-purple-200",children:["Submit a subscription request for ",e.name," from ",e.provider]})]}),n.jsx(Ht,{className:"space-y-4",children:n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium text-white mb-2 block",children:"Business Justification"}),n.jsx("textarea",{className:"w-full p-3 bg-white/5 border border-white/10 rounded-md text-white placeholder:text-purple-200 focus:border-purple-400 text-sm",rows:4,placeholder:"Explain why your department needs access to this agent and how it will be used in your workflow...",value:i,onChange:d=>a(d.target.value)})]})}),n.jsxs(WE,{className:"flex gap-2",children:[n.jsx(lt,{variant:"outline",onClick:r,className:"flex-1 bg-white/5 border-white/10 text-white hover:bg-white/10",children:"Cancel"}),n.jsx(lt,{onClick:l,className:"flex-1 bg-gradient-to-r from-purple-500 to-blue-500 hover:from-purple-600 hover:to-blue-600 text-white border-0",disabled:!i.trim(),children:"Submit Request"})]})]})})},rmt=({subscriptions:e,agents:t})=>n.jsxs("div",{className:"space-y-4 max-w-7xl mx-auto",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("h2",{className:"text-xl font-semibold text-white",children:"My Subscriptions"}),n.jsxs(Tt,{variant:"outline",className:"bg-purple-500/20 text-purple-300 border-purple-500/30",children:[e.filter(r=>r.status==="active").length," Active"]})]}),e.length===0?n.jsxs("div",{className:"text-center py-12 bg-white/5 backdrop-blur-md border border-white/10 rounded-2xl",children:[n.jsx(DF,{className:"h-12 w-12 text-purple-300 mx-auto mb-4"}),n.jsx("h3",{className:"text-lg font-semibold text-white",children:"No subscriptions yet"}),n.jsx("p",{className:"text-purple-200",children:"Start by requesting access to agents from the marketplace"})]}):n.jsx("div",{className:"grid gap-4",children:e.map(r=>{const i=t.find(a=>a.id===r.agent_id);return i?n.jsx(jt,{className:"bg-white/5 backdrop-blur-md border-white/10",children:n.jsx(Ht,{className:"p-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs(S3,{className:"h-8 w-8 bg-gradient-to-r from-purple-500 to-blue-500",children:[n.jsx(C3,{src:i.icon}),n.jsx(A3,{className:"bg-transparent text-white",children:z$(i.category)})]}),n.jsxs("div",{children:[n.jsx("div",{className:"font-medium text-white",children:i.name}),n.jsx("div",{className:"text-sm text-purple-200",children:i.category})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Tt,{className:Kht(r.tier),variant:"outline",children:r.tier}),n.jsx(Tt,{className:Zht(r.status),variant:"outline",children:r.status})]})]})})},r.id):null})})]}),nmt=({requests:e,agents:t})=>{const r=i=>{switch(i){case"approved":return"bg-emerald-500/20 text-emerald-300 border-emerald-500/30";case"pending":return"bg-amber-500/20 text-amber-300 border-amber-500/30";case"rejected":return"bg-rose-500/20 text-rose-300 border-rose-500/30";case"deployed":return"bg-blue-500/20 text-blue-300 border-blue-500/30";default:return"bg-gray-500/20 text-gray-300 border-gray-500/30"}};return n.jsxs("div",{className:"space-y-4 max-w-7xl mx-auto",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("h2",{className:"text-xl font-semibold text-white",children:"My Requests"}),n.jsxs(Tt,{variant:"outline",className:"bg-purple-500/20 text-purple-300 border-purple-500/30",children:[e.filter(i=>i.status==="pending").length," Pending"]})]}),e.length===0?n.jsxs("div",{className:"text-center py-12 bg-white/5 backdrop-blur-md border border-white/10 rounded-2xl",children:[n.jsx($a,{className:"h-12 w-12 text-purple-300 mx-auto mb-4"}),n.jsx("h3",{className:"text-lg font-semibold text-white",children:"No requests yet"}),n.jsx("p",{className:"text-purple-200",children:"Submit requests for agent access from the marketplace"})]}):n.jsx("div",{className:"grid gap-4",children:e.map(i=>{const a=t.find(l=>l.id===i.agent_id);return a?n.jsx(jt,{className:"bg-white/5 backdrop-blur-md border-white/10",children:n.jsxs(Ht,{className:"p-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs(S3,{className:"h-8 w-8 bg-gradient-to-r from-purple-500 to-blue-500",children:[n.jsx(C3,{src:a.icon}),n.jsx(A3,{className:"bg-transparent text-white",children:z$(a.category)})]}),n.jsxs("div",{children:[n.jsx("div",{className:"font-medium text-white",children:a.name}),n.jsxs("div",{className:"text-sm text-purple-200",children:[i.request_type," - ",i.requested_tier]})]})]}),n.jsx(Tt,{className:r(i.status),variant:"outline",children:i.status})]}),n.jsx("p",{className:"text-sm text-purple-200",children:i.justification}),n.jsxs("div",{className:"text-xs text-purple-300 mt-2",children:["Requested: ",new Date(i.requested_at).toLocaleDateString()]})]})},i.id):null})})]})},imt=({subscriptions:e,requests:t})=>{const r=e.length,i=e.filter(s=>s.status==="active").length,a=t.length,l=t.filter(s=>s.status==="pending").length,d=t.filter(s=>s.status==="approved").length;return n.jsxs("div",{className:"space-y-6 max-w-7xl mx-auto",children:[n.jsx("h2",{className:"text-xl font-semibold text-white",children:"Analytics Dashboard"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[n.jsx(jt,{className:"bg-white/5 backdrop-blur-md border-white/10",children:n.jsx(Ht,{className:"p-4",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(DF,{className:"h-8 w-8 text-purple-400"}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold text-white",children:i}),n.jsx("div",{className:"text-sm text-purple-300",children:"Active Subscriptions"})]})]})})}),n.jsx(jt,{className:"bg-white/5 backdrop-blur-md border-white/10",children:n.jsx(Ht,{className:"p-4",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx($a,{className:"h-8 w-8 text-yellow-400"}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold text-white",children:l}),n.jsx("div",{className:"text-sm text-purple-300",children:"Pending Requests"})]})]})})}),n.jsx(jt,{className:"bg-white/5 backdrop-blur-md border-white/10",children:n.jsx(Ht,{className:"p-4",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ro,{className:"h-8 w-8 text-emerald-400"}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold text-white",children:d}),n.jsx("div",{className:"text-sm text-purple-300",children:"Approved Requests"})]})]})})}),n.jsx(jt,{className:"bg-white/5 backdrop-blur-md border-white/10",children:n.jsx(Ht,{className:"p-4",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(En,{className:"h-8 w-8 text-purple-400"}),n.jsxs("div",{children:[n.jsxs("div",{className:"text-2xl font-bold text-white",children:[a>0?Math.round(d/a*100):0,"%"]}),n.jsx("div",{className:"text-sm text-purple-300",children:"Approval Rate"})]})]})})})]}),r>0&&n.jsxs(jt,{className:"bg-white/5 backdrop-blur-md border-white/10",children:[n.jsx(wr,{children:n.jsx(fr,{className:"text-white",children:"Subscription Status Overview"})}),n.jsx(Ht,{children:n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex justify-between text-sm text-purple-300",children:[n.jsx("span",{children:"Active Subscriptions"}),n.jsxs("span",{children:[i,"/",r]})]}),n.jsx(vn,{value:i/r*100,className:"h-2"})]})})]})]})};function smt(){return n.jsx(Qht,{})}const amt=()=>n.jsx("div",{className:"glass-panel backdrop-blur-md bg-beam-dark-accent/30 border border-gray-700/50 rounded-xl p-6 shadow-lg",children:n.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[n.jsxs("div",{className:"mb-4 md:mb-0",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"h-2 w-2 rounded-full bg-green-500 animate-pulse"}),n.jsx("span",{className:"text-green-400 text-sm",children:"Active"})]}),n.jsx("h1",{className:"text-3xl font-bold text-white mt-1 mb-2",children:"Cell Site Digital Twin"}),n.jsx("p",{className:"text-gray-300",children:"Analyze cell site distribution and performance with AI-powered models"})]}),n.jsxs("div",{className:"flex flex-wrap gap-4 items-center",children:[n.jsxs("div",{className:"flex items-center gap-3 px-4 py-2 bg-beam-dark-accent/50 rounded-lg border border-gray-700/50",children:[n.jsx(kc,{size:20,className:"text-ptt-blue"}),n.jsxs("div",{className:"flex flex-col",children:[n.jsx("span",{className:"text-sm text-gray-300",children:"Cell Sites"}),n.jsx("span",{className:"text-lg font-semibold text-white",children:"420"})]})]}),n.jsxs("div",{className:"flex items-center gap-3 px-4 py-2 bg-beam-dark-accent/50 rounded-lg border border-gray-700/50",children:[n.jsx(Ov,{size:20,className:"text-ptt-blue"}),n.jsxs("div",{className:"flex flex-col",children:[n.jsx("span",{className:"text-sm text-gray-300",children:"Coverage"}),n.jsx("span",{className:"text-lg font-semibold text-white",children:"92%"})]})]}),n.jsxs("div",{className:"hidden md:flex items-center gap-3 px-4 py-2 bg-beam-dark-accent/50 rounded-lg border border-gray-700/50",children:[n.jsx(ex,{size:20,className:"text-ptt-blue"}),n.jsxs("div",{className:"flex flex-col",children:[n.jsx("span",{className:"text-sm text-gray-300",children:"Districts"}),n.jsx("span",{className:"text-lg font-semibold text-white",children:"18"})]})]})]})]})}),omt=({simulationType:e,trafficGrowthRate:t,capacityConstraint:r,forecastPeriod:i})=>{const a=()=>Array.from({length:i+1}).map((j,S)=>{const F=100*(1+t/100*S/i),L=100*(r/100);return{name:`Month ${S}`,Traffic:Math.round(F),"Capacity Threshold":L}}),l=()=>[{name:"Northern",value:25+Math.floor(Math.random()*15)},{name:"Central",value:35+Math.floor(Math.random()*20)},{name:"Eastern",value:15+Math.floor(Math.random()*10)},{name:"Western",value:20+Math.floor(Math.random()*12)},{name:"Southern",value:18+Math.floor(Math.random()*14)}],d=()=>[{name:"Core Routers",Utilization:78+Math.floor(t/2)},{name:"Dist. Switches",Utilization:65+Math.floor(t/3)},{name:"Edge Nodes",Utilization:45+Math.floor(t/4)},{name:"Cell Sites",Utilization:55+Math.floor(t/3.5)}],s=a(),p=l(),x=d(),w=["#e61e2b","#f15761","#7a1915","#b01722","#240908"];return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-center justify-between gap-4",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"text-lg font-bold text-white",children:"Simulation Results"}),n.jsxs("p",{className:"text-sm text-gray-400",children:[e==="traffic"?"Traffic Growth":e==="failure"?"Failure Scenarios":e==="expansion"?"Network Expansion":"Capacity Optimization","• Growth Rate: ",t,"% • Forecast: ",i," months"]})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs(lt,{variant:"outline",className:"border-gray-700 text-gray-300 hover:bg-beam-dark-accent/50",children:[n.jsx(Nu,{className:"mr-2 h-4 w-4"}),"Export Results"]}),n.jsxs(lt,{variant:"outline",className:"border-gray-700 text-gray-300 hover:bg-beam-dark-accent/50",children:[n.jsx(ave,{className:"mr-2 h-4 w-4"}),"Save Scenario"]})]})]}),n.jsxs($i,{defaultValue:"forecast",className:"w-full",children:[n.jsxs(Di,{className:"grid grid-cols-3 mb-4 bg-beam-dark-accent/40 border border-gray-700/50 rounded-lg p-1 gap-1",children:[n.jsx(Jt,{value:"forecast",className:"rounded-md data-[state=active]:bg-beam-blue data-[state=active]:text-white",children:"Traffic Forecast"}),n.jsx(Jt,{value:"utilization",className:"rounded-md data-[state=active]:bg-beam-blue data-[state=active]:text-white",children:"Utilization"}),n.jsx(Jt,{value:"recommendations",className:"rounded-md data-[state=active]:bg-beam-blue data-[state=active]:text-white",children:"Recommendations"})]}),n.jsx(ur,{value:"forecast",className:"mt-0",children:n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[n.jsxs(jt,{className:"p-4 bg-beam-dark-accent/50 border-gray-700 rounded-lg col-span-3",children:[n.jsx("h4",{className:"text-base font-medium text-white mb-3",children:"Traffic Growth Forecast"}),n.jsx("div",{className:"h-[300px] w-full",children:n.jsx(ms,{width:"100%",height:"100%",children:n.jsxs(uS,{data:s,margin:{top:10,right:30,left:0,bottom:0},children:[n.jsx("defs",{children:n.jsxs("linearGradient",{id:"colorTraffic",x1:"0",y1:"0",x2:"0",y2:"1",children:[n.jsx("stop",{offset:"5%",stopColor:"#e61e2b",stopOpacity:.8}),n.jsx("stop",{offset:"95%",stopColor:"#e61e2b",stopOpacity:.1})]})}),n.jsx($s,{strokeDasharray:"3 3",stroke:"#333"}),n.jsx(is,{dataKey:"name",stroke:"#666"}),n.jsx(Gi,{stroke:"#666"}),n.jsx(yi,{contentStyle:{backgroundColor:"#1a0604",borderColor:"#333",color:"#fff"}}),n.jsx(xa,{}),n.jsx(Zo,{type:"monotone",dataKey:"Traffic",stroke:"#e61e2b",fillOpacity:1,fill:"url(#colorTraffic)"}),n.jsx(Zo,{type:"monotone",dataKey:"Capacity Threshold",stroke:"#666",strokeDasharray:"5 5",fill:"none"})]})})})]}),n.jsxs(jt,{className:"p-4 bg-beam-dark-accent/50 border-gray-700 rounded-lg col-span-2",children:[n.jsx("h4",{className:"text-base font-medium text-white mb-3",children:"Utilization by Node Type"}),n.jsx("div",{className:"h-[260px] w-full",children:n.jsx(ms,{width:"100%",height:"100%",children:n.jsxs(nc,{data:x,margin:{top:10,right:30,left:0,bottom:0},children:[n.jsx($s,{strokeDasharray:"3 3",stroke:"#333"}),n.jsx(is,{dataKey:"name",stroke:"#666"}),n.jsx(Gi,{stroke:"#666"}),n.jsx(yi,{contentStyle:{backgroundColor:"#1a0604",borderColor:"#333",color:"#fff"}}),n.jsx(pi,{dataKey:"Utilization",fill:"#e61e2b"})]})})})]}),n.jsxs(jt,{className:"p-4 bg-beam-dark-accent/50 border-gray-700 rounded-lg",children:[n.jsx("h4",{className:"text-base font-medium text-white mb-3",children:"Traffic Distribution by Region"}),n.jsx("div",{className:"h-[260px] w-full",children:n.jsx(ms,{width:"100%",height:"100%",children:n.jsxs(oN,{children:[n.jsx(Gc,{data:p,cx:"50%",cy:"50%",outerRadius:80,fill:"#8884d8",dataKey:"value",label:({name:j,percent:S})=>`${j} ${(S*100).toFixed(0)}%`,children:p.map((j,S)=>n.jsx(jd,{fill:w[S%w.length]},`cell-${S}`))}),n.jsx(yi,{contentStyle:{backgroundColor:"#1a0604",borderColor:"#333",color:"#fff"}})]})})})]})]})}),n.jsx(ur,{value:"utilization",className:"mt-0",children:n.jsxs(jt,{className:"p-6 bg-beam-dark-accent/50 border-gray-700 rounded-lg",children:[n.jsx("h4",{className:"text-base font-medium text-white mb-4",children:"Network Utilization Analysis"}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[n.jsxs("div",{className:"bg-beam-dark-accent/30 p-4 rounded-lg border border-gray-700/50",children:[n.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"Overall Network Utilization"}),n.jsxs("div",{className:"text-2xl font-bold text-white",children:[55+Math.floor(t/2),"%"]}),n.jsxs("div",{className:"text-xs text-gray-500",children:["+",t,"% growth in ",i," months"]})]}),n.jsxs("div",{className:"bg-beam-dark-accent/30 p-4 rounded-lg border border-gray-700/50",children:[n.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"Peak Hour Utilization"}),n.jsxs("div",{className:"text-2xl font-bold text-white",children:[72+Math.floor(t/1.5),"%"]}),n.jsx("div",{className:"text-xs text-gray-500",children:"Critical threshold: 85%"})]}),n.jsxs("div",{className:"bg-beam-dark-accent/30 p-4 rounded-lg border border-gray-700/50",children:[n.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"Congested Network Segments"}),n.jsx("div",{className:"text-2xl font-bold text-white",children:Math.floor(t/2)}),n.jsxs("div",{className:"text-xs text-gray-500",children:["Above ",r,"% capacity threshold"]})]})]}),n.jsxs("div",{className:"mt-6 space-y-4",children:[n.jsx("h5",{className:"text-sm font-medium text-white",children:"Potential Bottlenecks"}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"bg-beam-dark-accent/30 p-3 rounded-lg border border-gray-700/50",children:[n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-sm font-medium text-white",children:"Core Router CR-12"}),n.jsx("div",{className:"text-xs text-gray-400",children:"Central Region"})]}),n.jsxs("div",{className:"text-ptt-blue font-bold",children:[85+Math.floor(t/3),"%"]})]}),n.jsx("div",{className:"mt-2 w-full bg-gray-700 rounded-full h-1.5",children:n.jsx("div",{className:"bg-ptt-blue h-1.5 rounded-full",style:{width:`${85+Math.floor(t/3)}%`}})})]}),n.jsxs("div",{className:"bg-beam-dark-accent/30 p-3 rounded-lg border border-gray-700/50",children:[n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-sm font-medium text-white",children:"Backbone Link BL-05"}),n.jsx("div",{className:"text-xs text-gray-400",children:"North-Central Connection"})]}),n.jsxs("div",{className:"text-amber-400 font-bold",children:[78+Math.floor(t/2),"%"]})]}),n.jsx("div",{className:"mt-2 w-full bg-gray-700 rounded-full h-1.5",children:n.jsx("div",{className:"bg-amber-400 h-1.5 rounded-full",style:{width:`${78+Math.floor(t/2)}%`}})})]}),n.jsxs("div",{className:"bg-beam-dark-accent/30 p-3 rounded-lg border border-gray-700/50",children:[n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-sm font-medium text-white",children:"Edge Gateway EG-28"}),n.jsx("div",{className:"text-xs text-gray-400",children:"Eastern Region"})]}),n.jsxs("div",{className:"text-green-400 font-bold",children:[70+Math.floor(t/4),"%"]})]}),n.jsx("div",{className:"mt-2 w-full bg-gray-700 rounded-full h-1.5",children:n.jsx("div",{className:"bg-green-400 h-1.5 rounded-full",style:{width:`${70+Math.floor(t/4)}%`}})})]})]})]})]})]})}),n.jsx(ur,{value:"recommendations",className:"mt-0",children:n.jsxs(jt,{className:"p-6 bg-beam-dark-accent/50 border-gray-700 rounded-lg",children:[n.jsx("h4",{className:"text-base font-medium text-white mb-4",children:"AI-Generated Recommendations"}),n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"bg-beam-dark-accent/30 p-4 rounded-lg border border-gray-700/50",children:[n.jsx("h5",{className:"text-base font-medium text-white mb-2",children:"Capacity Enhancement Recommendations"}),n.jsxs("ul",{className:"space-y-2 text-gray-300 text-sm",children:[n.jsxs("li",{className:"flex items-start gap-2",children:[n.jsx("div",{className:"min-w-[24px] h-6 flex items-center justify-center rounded-full bg-ptt-red/20 text-ptt-blue",children:"1"}),n.jsxs("div",{children:["Upgrade Core Router CR-12 capacity by additional 40% to handle projected traffic growth in the next ",i," months."]})]}),n.jsxs("li",{className:"flex items-start gap-2",children:[n.jsx("div",{className:"min-w-[24px] h-6 flex items-center justify-center rounded-full bg-ptt-red/20 text-ptt-blue",children:"2"}),n.jsx("div",{children:"Implement link aggregation on Backbone Link BL-05 to increase bandwidth capacity by 25% before month 3."})]}),n.jsxs("li",{className:"flex items-start gap-2",children:[n.jsx("div",{className:"min-w-[24px] h-6 flex items-center justify-center rounded-full bg-ptt-red/20 text-ptt-blue",children:"3"}),n.jsx("div",{children:"Consider load balancing configuration updates on Edge Gateway EG-28 to optimize traffic distribution."})]})]})]}),n.jsxs("div",{className:"bg-beam-dark-accent/30 p-4 rounded-lg border border-gray-700/50",children:[n.jsx("h5",{className:"text-base font-medium text-white mb-2",children:"Traffic Optimization Strategies"}),n.jsxs("ul",{className:"space-y-2 text-gray-300 text-sm",children:[n.jsxs("li",{className:"flex items-start gap-2",children:[n.jsx("div",{className:"min-w-[24px] h-6 flex items-center justify-center rounded-full bg-ptt-red/20 text-ptt-blue",children:"1"}),n.jsx("div",{children:"Implement Quality of Service (QoS) policies to prioritize critical traffic during peak hours."})]}),n.jsxs("li",{className:"flex items-start gap-2",children:[n.jsx("div",{className:"min-w-[24px] h-6 flex items-center justify-center rounded-full bg-ptt-red/20 text-ptt-blue",children:"2"}),n.jsx("div",{children:"Deploy traffic shaping for high-bandwidth applications during the 18:00-22:00 timeframe to reduce congestion."})]}),n.jsxs("li",{className:"flex items-start gap-2",children:[n.jsx("div",{className:"min-w-[24px] h-6 flex items-center justify-center rounded-full bg-ptt-red/20 text-ptt-blue",children:"3"}),n.jsx("div",{children:"Consider implementing caching mechanisms at edge nodes to reduce redundant data transfers."})]})]})]}),n.jsxs("div",{className:"bg-beam-dark-accent/30 p-4 rounded-lg border border-gray-700/50",children:[n.jsx("h5",{className:"text-base font-medium text-white mb-2",children:"Investment Recommendations"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mt-3",children:[n.jsxs("div",{className:"p-3 bg-ptt-red/10 rounded-lg",children:[n.jsxs("div",{className:"text-lg font-bold text-white",children:["$",Math.floor(80+t*15),"K"]}),n.jsx("div",{className:"text-xs text-gray-400",children:"Immediate Investment"}),n.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"High priority upgrades"})]}),n.jsxs("div",{className:"p-3 bg-ptt-red/10 rounded-lg",children:[n.jsxs("div",{className:"text-lg font-bold text-white",children:["$",Math.floor(150+t*25),"K"]}),n.jsx("div",{className:"text-xs text-gray-400",children:"3-Month Plan"}),n.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"Medium priority upgrades"})]}),n.jsxs("div",{className:"p-3 bg-ptt-red/10 rounded-lg",children:[n.jsxs("div",{className:"text-lg font-bold text-white",children:["$",Math.floor(320+t*40),"K"]}),n.jsx("div",{className:"text-xs text-gray-400",children:"6-Month Plan"}),n.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"Complete enhancement"})]})]})]})]})]})})]})]})},lmt=({onSimulationComplete:e})=>{const[t,r]=U.useState("traffic"),[i,a]=U.useState([5]),[l,d]=U.useState([80]),[s,p]=U.useState("6"),[x,w]=U.useState(!1),[j,S]=U.useState(!1),P=()=>{w(!0),setTimeout(()=>{w(!1),S(!0),e==null||e({type:t,parameters:{trafficGrowthRate:i,capacityConstraint:l,forecastPeriod:s},timestamp:new Date().toISOString()})},2e3)},F=()=>{S(!1)};return n.jsx("div",{className:"glass-panel backdrop-blur-md bg-beam-dark-accent/30 border border-gray-700/50 rounded-xl p-6 shadow-lg",children:n.jsxs("div",{className:"flex flex-col gap-6",children:[n.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[n.jsx("h2",{className:"text-xl font-bold text-white",children:"Network Simulation & Forecasting"}),n.jsx("div",{className:"flex flex-wrap gap-3",children:n.jsxs(lt,{variant:"default",className:"bg-ptt-red hover:bg-ptt-red/90",onClick:j?F:P,disabled:x,children:[x?"Simulating...":j?"New Simulation":"Run Simulation",!x&&!j&&n.jsx($Q,{className:"ml-2 h-4 w-4"})]})})]}),j?n.jsx(omt,{simulationType:t,trafficGrowthRate:i[0],capacityConstraint:l[0],forecastPeriod:parseInt(s)}):n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[n.jsxs(jt,{className:"p-4 bg-beam-dark-accent/50 border-gray-700 rounded-lg",children:[n.jsx("h3",{className:"text-lg font-medium text-white mb-4",children:"Simulation Parameters"}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx(mr,{htmlFor:"simulation-type",className:"text-sm text-gray-300",children:"Simulation Type"}),n.jsxs(_n,{value:t,onValueChange:r,children:[n.jsx(xn,{id:"simulation-type",className:"w-full bg-beam-dark-accent/50 border-gray-700 mt-1",children:n.jsx(wn,{placeholder:"Select Type"})}),n.jsxs(yn,{className:"bg-beam-dark border-gray-700",children:[n.jsx(yt,{value:"traffic",children:"Traffic Growth"}),n.jsx(yt,{value:"failure",children:"Failure Scenarios"}),n.jsx(yt,{value:"expansion",children:"Network Expansion"}),n.jsx(yt,{value:"optimization",children:"Capacity Optimization"})]})]})]}),n.jsxs("div",{children:[n.jsx(mr,{htmlFor:"forecast-period",className:"text-sm text-gray-300",children:"Forecast Period (months)"}),n.jsxs(_n,{value:s,onValueChange:p,children:[n.jsx(xn,{id:"forecast-period",className:"w-full bg-beam-dark-accent/50 border-gray-700 mt-1",children:n.jsx(wn,{placeholder:"Select Period"})}),n.jsxs(yn,{className:"bg-beam-dark border-gray-700",children:[n.jsx(yt,{value:"3",children:"3 Months"}),n.jsx(yt,{value:"6",children:"6 Months"}),n.jsx(yt,{value:"12",children:"12 Months"}),n.jsx(yt,{value:"24",children:"24 Months"})]})]})]}),n.jsxs("div",{children:[n.jsx(mr,{className:"text-sm text-gray-300",children:"Traffic Growth Rate (%)"}),n.jsxs("div",{className:"flex items-center gap-4 mt-1",children:[n.jsx(oh,{value:i,onValueChange:a,max:20,step:1,className:"flex-1"}),n.jsxs("span",{className:"text-white min-w-[40px] text-center",children:[i[0],"%"]})]})]}),n.jsxs("div",{children:[n.jsx(mr,{className:"text-sm text-gray-300",children:"Capacity Constraint (%)"}),n.jsxs("div",{className:"flex items-center gap-4 mt-1",children:[n.jsx(oh,{value:l,onValueChange:d,max:100,step:5,className:"flex-1"}),n.jsxs("span",{className:"text-white min-w-[40px] text-center",children:[l[0],"%"]})]})]})]})]}),n.jsxs(jt,{className:"p-4 bg-beam-dark-accent/50 border-gray-700 rounded-lg",children:[n.jsx("h3",{className:"text-lg font-medium text-white mb-4",children:"Agent Selection"}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center gap-2 p-3 bg-beam-dark-accent/30 rounded-lg border border-gray-700/50 hover:border-ptt-red/50 cursor-pointer",children:[n.jsx("div",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-ptt-red/20",children:n.jsx(ga,{size:16,className:"text-ptt-blue"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("div",{className:"text-sm font-medium text-white",children:"Network Topology Agent"}),n.jsx("div",{className:"text-xs text-gray-400",children:"Analyzes network structure and connectivity"})]}),n.jsx("div",{className:"h-4 w-4 rounded-full bg-green-500"})]}),n.jsxs("div",{className:"flex items-center gap-2 p-3 bg-beam-dark-accent/30 rounded-lg border border-gray-700/50 hover:border-ptt-red/50 cursor-pointer",children:[n.jsx("div",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-ptt-red/20",children:n.jsx(FD,{size:16,className:"text-ptt-blue"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("div",{className:"text-sm font-medium text-white",children:"Traffic Forecast Agent"}),n.jsx("div",{className:"text-xs text-gray-400",children:"Predicts traffic growth patterns"})]}),n.jsx("div",{className:"h-4 w-4 rounded-full bg-green-500"})]}),n.jsxs("div",{className:"flex items-center gap-2 p-3 bg-beam-dark-accent/30 rounded-lg border border-gray-700/50 hover:border-ptt-red/50 cursor-pointer",children:[n.jsx("div",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-ptt-red/20",children:n.jsx(MQ,{size:16,className:"text-ptt-blue"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("div",{className:"text-sm font-medium text-white",children:"Capacity Analysis Agent"}),n.jsx("div",{className:"text-xs text-gray-400",children:"Evaluates network capacity utilization"})]}),n.jsx("div",{className:"h-4 w-4 rounded-full bg-green-500"})]})]})]}),n.jsxs(jt,{className:"p-4 bg-beam-dark-accent/50 border-gray-700 rounded-lg",children:[n.jsx("h3",{className:"text-lg font-medium text-white mb-4",children:"Scenario Configuration"}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx(mr,{htmlFor:"scenario-name",className:"text-sm text-gray-300",children:"Scenario Name"}),n.jsx(An,{id:"scenario-name",placeholder:"Enter scenario name",className:"bg-beam-dark-accent/30 border-gray-700 mt-1"})]}),n.jsxs("div",{children:[n.jsx(mr,{htmlFor:"network-subset",className:"text-sm text-gray-300",children:"Network Subset"}),n.jsxs(_n,{defaultValue:"all",children:[n.jsx(xn,{id:"network-subset",className:"w-full bg-beam-dark-accent/50 border-gray-700 mt-1",children:n.jsx(wn,{placeholder:"Select Network Subset"})}),n.jsxs(yn,{className:"bg-beam-dark border-gray-700",children:[n.jsx(yt,{value:"all",children:"All Network"}),n.jsx(yt,{value:"core",children:"Core Network"}),n.jsx(yt,{value:"metro",children:"Metro Networks"}),n.jsx(yt,{value:"access",children:"Access Network"})]})]})]}),n.jsx("div",{className:"pt-2",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx("input",{type:"checkbox",id:"save-scenario",className:"mr-2"}),n.jsx(mr,{htmlFor:"save-scenario",className:"text-sm text-gray-300",children:"Save scenario for future reference"})]})}),n.jsx("div",{className:"pt-2",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx("input",{type:"checkbox",id:"compare-historical",className:"mr-2"}),n.jsx(mr,{htmlFor:"compare-historical",className:"text-sm text-gray-300",children:"Compare with historical data"})]})})]})]})]})]})})},cmt=({viewType:e,region:t,model:r,district:i})=>{const a=s=>{switch(s){case"churn":return"Churn Model";case"propensity":return"Propensity Model";case"arpu":return"ARPU Model";case"apra":return"APRA Model";default:return"Network Model"}},l=s=>{switch(s){case"physical":return"Physical Network";case"district":return"By District";case"state":return"By State";case"capacity":return"Capacity Heat Map";default:return"Network View"}},d=()=>e==="district"&&i&&i!=="all"?` in ${i.charAt(0).toUpperCase()+i.slice(1)} District`:e==="state"&&t&&t!=="all"?` in ${t.charAt(0).toUpperCase()+t.slice(1)} State`:t!=="all"?` in ${t.charAt(0).toUpperCase()+t.slice(1)} Region`:"";return n.jsx("div",{className:"w-full h-full flex flex-col items-center justify-center",children:n.jsxs("div",{className:"relative w-full h-[500px] bg-beam-dark-accent/20 rounded-lg overflow-hidden border border-gray-700/50",children:[n.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"mb-4 text-ptt-blue",children:n.jsx("svg",{className:"w-16 h-16 mx-auto",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:n.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM7 13.5C6.17 13.5 5.5 12.83 5.5 12C5.5 11.17 6.17 10.5 7 10.5C7.83 10.5 8.5 11.17 8.5 12C8.5 12.83 7.83 13.5 7 13.5ZM12 13.5C11.17 13.5 10.5 12.83 10.5 12C10.5 11.17 11.17 10.5 12 10.5C12.83 10.5 13.5 11.17 13.5 12C13.5 12.83 12.83 13.5 12 13.5ZM17 13.5C16.17 13.5 15.5 12.83 15.5 12C15.5 11.17 16.17 10.5 17 10.5C17.83 10.5 18.5 11.17 18.5 12C18.5 12.83 17.83 13.5 17 13.5Z",fill:"currentColor"})})}),n.jsx("p",{className:"text-lg text-white mb-2",children:"Cell Site Visualization"}),n.jsxs("p",{className:"text-sm text-gray-400 mb-4",children:["Currently displaying: ",n.jsx("span",{className:"font-medium",children:a(r)})," with ",n.jsx("span",{className:"font-medium",children:l(e)}),n.jsx("span",{className:"font-medium",children:d()})]}),n.jsx("p",{className:"text-xs text-gray-500",children:"Interactive network visualization will be implemented in a future update"})]})}),n.jsxs("div",{className:"absolute inset-0 flex items-center justify-center opacity-20",children:[Array.from({length:30}).map((s,p)=>n.jsx("div",{className:"absolute w-2 h-2 bg-ptt-blue rounded-full animate-pulse",style:{left:`${Math.random()*100}%`,top:`${Math.random()*100}%`,animationDelay:`${Math.random()*2}s`,width:`${Math.max(3,Math.random()*6)}px`,height:`${Math.max(3,Math.random()*6)}px`}},p)),Array.from({length:20}).map((s,p)=>n.jsx("div",{className:"absolute bg-ptt-blue/30",style:{left:`${Math.random()*100}%`,top:`${Math.random()*100}%`,width:"1px",height:`${20+Math.random()*80}px`,transform:`rotate(${Math.random()*360}deg)`}},p))]}),n.jsxs("div",{className:"absolute bottom-4 right-4 px-3 py-2 bg-beam-dark-accent/70 rounded-md border border-gray-700/50",children:[n.jsx("div",{className:"text-xs text-gray-400",children:"Model Overlay"}),n.jsx("div",{className:"text-sm font-medium text-white",children:a(r)})]})]})})};var Xhe={exports:{}};(function(e,t){(function(r,i){e.exports=i()})(To,function(){var r,i,a;function l(s,p){if(!r)r=p;else if(!i)i=p;else{var x="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+r+")(sharedChunk); ("+i+")(sharedChunk); self.onerror = null;",w={};r(w),a=p(w),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(a.workerUrl=window.URL.createObjectURL(new Blob([x],{type:"text/javascript"})))}}l(["exports"],function(s){function p(m){return m&&m.__esModule&&Object.prototype.hasOwnProperty.call(m,"default")?m.default:m}var x,w={},j={};function S(){if(x)return j;x=1,Object.defineProperty(j,"__esModule",{value:!0}),j.setMatrixArrayType=function(y){j.ARRAY_TYPE=o=y},j.toRadian=function(y){return y*f},j.equals=function(y,g){return Math.abs(y-g)<=m*Math.max(1,Math.abs(y),Math.abs(g))},j.RANDOM=j.ARRAY_TYPE=j.EPSILON=void 0;var m=1e-6;j.EPSILON=m;var o=typeof Float32Array<"u"?Float32Array:Array;j.ARRAY_TYPE=o;var u=Math.random;j.RANDOM=u;var f=Math.PI/180;return Math.hypot||(Math.hypot=function(){for(var y=0,g=arguments.length;g--;)y+=arguments[g]*arguments[g];return Math.sqrt(y)}),j}var P,F={};function L(){if(P)return F;function m(g){return m=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(_){return typeof _}:function(_){return _&&typeof Symbol=="function"&&_.constructor===Symbol&&_!==Symbol.prototype?"symbol":typeof _},m(g)}P=1,Object.defineProperty(F,"__esModule",{value:!0}),F.create=function(){var g=new o.ARRAY_TYPE(4);return o.ARRAY_TYPE!=Float32Array&&(g[1]=0,g[2]=0),g[0]=1,g[3]=1,g},F.clone=function(g){var _=new o.ARRAY_TYPE(4);return _[0]=g[0],_[1]=g[1],_[2]=g[2],_[3]=g[3],_},F.copy=function(g,_){return g[0]=_[0],g[1]=_[1],g[2]=_[2],g[3]=_[3],g},F.identity=function(g){return g[0]=1,g[1]=0,g[2]=0,g[3]=1,g},F.fromValues=function(g,_,T,E){var O=new o.ARRAY_TYPE(4);return O[0]=g,O[1]=_,O[2]=T,O[3]=E,O},F.set=function(g,_,T,E,O){return g[0]=_,g[1]=T,g[2]=E,g[3]=O,g},F.transpose=function(g,_){if(g===_){var T=_[1];g[1]=_[2],g[2]=T}else g[0]=_[0],g[1]=_[2],g[2]=_[1],g[3]=_[3];return g},F.invert=function(g,_){var T=_[0],E=_[1],O=_[2],C=_[3],M=T*C-O*E;return M?(g[0]=C*(M=1/M),g[1]=-E*M,g[2]=-O*M,g[3]=T*M,g):null},F.adjoint=function(g,_){var T=_[0];return g[0]=_[3],g[1]=-_[1],g[2]=-_[2],g[3]=T,g},F.determinant=function(g){return g[0]*g[3]-g[2]*g[1]},F.multiply=f,F.rotate=function(g,_,T){var E=_[0],O=_[1],C=_[2],M=_[3],D=Math.sin(T),I=Math.cos(T);return g[0]=E*I+C*D,g[1]=O*I+M*D,g[2]=E*-D+C*I,g[3]=O*-D+M*I,g},F.scale=function(g,_,T){var E=_[1],O=_[2],C=_[3],M=T[0],D=T[1];return g[0]=_[0]*M,g[1]=E*M,g[2]=O*D,g[3]=C*D,g},F.fromRotation=function(g,_){var T=Math.sin(_),E=Math.cos(_);return g[0]=E,g[1]=T,g[2]=-T,g[3]=E,g},F.fromScaling=function(g,_){return g[0]=_[0],g[1]=0,g[2]=0,g[3]=_[1],g},F.str=function(g){return"mat2("+g[0]+", "+g[1]+", "+g[2]+", "+g[3]+")"},F.frob=function(g){return Math.hypot(g[0],g[1],g[2],g[3])},F.LDU=function(g,_,T,E){return g[2]=E[2]/E[0],T[0]=E[0],T[1]=E[1],T[3]=E[3]-g[2]*T[1],[g,_,T]},F.add=function(g,_,T){return g[0]=_[0]+T[0],g[1]=_[1]+T[1],g[2]=_[2]+T[2],g[3]=_[3]+T[3],g},F.subtract=y,F.exactEquals=function(g,_){return g[0]===_[0]&&g[1]===_[1]&&g[2]===_[2]&&g[3]===_[3]},F.equals=function(g,_){var T=g[0],E=g[1],O=g[2],C=g[3],M=_[0],D=_[1],I=_[2],R=_[3];return Math.abs(T-M)<=o.EPSILON*Math.max(1,Math.abs(T),Math.abs(M))&&Math.abs(E-D)<=o.EPSILON*Math.max(1,Math.abs(E),Math.abs(D))&&Math.abs(O-I)<=o.EPSILON*Math.max(1,Math.abs(O),Math.abs(I))&&Math.abs(C-R)<=o.EPSILON*Math.max(1,Math.abs(C),Math.abs(R))},F.multiplyScalar=function(g,_,T){return g[0]=_[0]*T,g[1]=_[1]*T,g[2]=_[2]*T,g[3]=_[3]*T,g},F.multiplyScalarAndAdd=function(g,_,T,E){return g[0]=_[0]+T[0]*E,g[1]=_[1]+T[1]*E,g[2]=_[2]+T[2]*E,g[3]=_[3]+T[3]*E,g},F.sub=F.mul=void 0;var o=function(g,_){if(g&&g.__esModule)return g;if(g===null||m(g)!=="object"&&typeof g!="function")return{default:g};var T=u(void 0);if(T&&T.has(g))return T.get(g);var E={},O=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var C in g)if(C!=="default"&&Object.prototype.hasOwnProperty.call(g,C)){var M=O?Object.getOwnPropertyDescriptor(g,C):null;M&&(M.get||M.set)?Object.defineProperty(E,C,M):E[C]=g[C]}return E.default=g,T&&T.set(g,E),E}(S());function u(g){if(typeof WeakMap!="function")return null;var _=new WeakMap,T=new WeakMap;return(u=function(E){return E?T:_})(g)}function f(g,_,T){var E=_[0],O=_[1],C=_[2],M=_[3],D=T[0],I=T[1],R=T[2],H=T[3];return g[0]=E*D+C*I,g[1]=O*D+M*I,g[2]=E*R+C*H,g[3]=O*R+M*H,g}function y(g,_,T){return g[0]=_[0]-T[0],g[1]=_[1]-T[1],g[2]=_[2]-T[2],g[3]=_[3]-T[3],g}return F.mul=f,F.sub=y,F}var B,V={};function $(){if(B)return V;function m(g){return m=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(_){return typeof _}:function(_){return _&&typeof Symbol=="function"&&_.constructor===Symbol&&_!==Symbol.prototype?"symbol":typeof _},m(g)}B=1,Object.defineProperty(V,"__esModule",{value:!0}),V.create=function(){var g=new o.ARRAY_TYPE(6);return o.ARRAY_TYPE!=Float32Array&&(g[1]=0,g[2]=0,g[4]=0,g[5]=0),g[0]=1,g[3]=1,g},V.clone=function(g){var _=new o.ARRAY_TYPE(6);return _[0]=g[0],_[1]=g[1],_[2]=g[2],_[3]=g[3],_[4]=g[4],_[5]=g[5],_},V.copy=function(g,_){return g[0]=_[0],g[1]=_[1],g[2]=_[2],g[3]=_[3],g[4]=_[4],g[5]=_[5],g},V.identity=function(g){return g[0]=1,g[1]=0,g[2]=0,g[3]=1,g[4]=0,g[5]=0,g},V.fromValues=function(g,_,T,E,O,C){var M=new o.ARRAY_TYPE(6);return M[0]=g,M[1]=_,M[2]=T,M[3]=E,M[4]=O,M[5]=C,M},V.set=function(g,_,T,E,O,C,M){return g[0]=_,g[1]=T,g[2]=E,g[3]=O,g[4]=C,g[5]=M,g},V.invert=function(g,_){var T=_[0],E=_[1],O=_[2],C=_[3],M=_[4],D=_[5],I=T*C-E*O;return I?(g[0]=C*(I=1/I),g[1]=-E*I,g[2]=-O*I,g[3]=T*I,g[4]=(O*D-C*M)*I,g[5]=(E*M-T*D)*I,g):null},V.determinant=function(g){return g[0]*g[3]-g[1]*g[2]},V.multiply=f,V.rotate=function(g,_,T){var E=_[0],O=_[1],C=_[2],M=_[3],D=_[4],I=_[5],R=Math.sin(T),H=Math.cos(T);return g[0]=E*H+C*R,g[1]=O*H+M*R,g[2]=E*-R+C*H,g[3]=O*-R+M*H,g[4]=D,g[5]=I,g},V.scale=function(g,_,T){var E=_[1],O=_[2],C=_[3],M=_[4],D=_[5],I=T[0],R=T[1];return g[0]=_[0]*I,g[1]=E*I,g[2]=O*R,g[3]=C*R,g[4]=M,g[5]=D,g},V.translate=function(g,_,T){var E=_[0],O=_[1],C=_[2],M=_[3],D=_[4],I=_[5],R=T[0],H=T[1];return g[0]=E,g[1]=O,g[2]=C,g[3]=M,g[4]=E*R+C*H+D,g[5]=O*R+M*H+I,g},V.fromRotation=function(g,_){var T=Math.sin(_),E=Math.cos(_);return g[0]=E,g[1]=T,g[2]=-T,g[3]=E,g[4]=0,g[5]=0,g},V.fromScaling=function(g,_){return g[0]=_[0],g[1]=0,g[2]=0,g[3]=_[1],g[4]=0,g[5]=0,g},V.fromTranslation=function(g,_){return g[0]=1,g[1]=0,g[2]=0,g[3]=1,g[4]=_[0],g[5]=_[1],g},V.str=function(g){return"mat2d("+g[0]+", "+g[1]+", "+g[2]+", "+g[3]+", "+g[4]+", "+g[5]+")"},V.frob=function(g){return Math.hypot(g[0],g[1],g[2],g[3],g[4],g[5],1)},V.add=function(g,_,T){return g[0]=_[0]+T[0],g[1]=_[1]+T[1],g[2]=_[2]+T[2],g[3]=_[3]+T[3],g[4]=_[4]+T[4],g[5]=_[5]+T[5],g},V.subtract=y,V.multiplyScalar=function(g,_,T){return g[0]=_[0]*T,g[1]=_[1]*T,g[2]=_[2]*T,g[3]=_[3]*T,g[4]=_[4]*T,g[5]=_[5]*T,g},V.multiplyScalarAndAdd=function(g,_,T,E){return g[0]=_[0]+T[0]*E,g[1]=_[1]+T[1]*E,g[2]=_[2]+T[2]*E,g[3]=_[3]+T[3]*E,g[4]=_[4]+T[4]*E,g[5]=_[5]+T[5]*E,g},V.exactEquals=function(g,_){return g[0]===_[0]&&g[1]===_[1]&&g[2]===_[2]&&g[3]===_[3]&&g[4]===_[4]&&g[5]===_[5]},V.equals=function(g,_){var T=g[0],E=g[1],O=g[2],C=g[3],M=g[4],D=g[5],I=_[0],R=_[1],H=_[2],X=_[3],J=_[4],ne=_[5];return Math.abs(T-I)<=o.EPSILON*Math.max(1,Math.abs(T),Math.abs(I))&&Math.abs(E-R)<=o.EPSILON*Math.max(1,Math.abs(E),Math.abs(R))&&Math.abs(O-H)<=o.EPSILON*Math.max(1,Math.abs(O),Math.abs(H))&&Math.abs(C-X)<=o.EPSILON*Math.max(1,Math.abs(C),Math.abs(X))&&Math.abs(M-J)<=o.EPSILON*Math.max(1,Math.abs(M),Math.abs(J))&&Math.abs(D-ne)<=o.EPSILON*Math.max(1,Math.abs(D),Math.abs(ne))},V.sub=V.mul=void 0;var o=function(g,_){if(g&&g.__esModule)return g;if(g===null||m(g)!=="object"&&typeof g!="function")return{default:g};var T=u(void 0);if(T&&T.has(g))return T.get(g);var E={},O=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var C in g)if(C!=="default"&&Object.prototype.hasOwnProperty.call(g,C)){var M=O?Object.getOwnPropertyDescriptor(g,C):null;M&&(M.get||M.set)?Object.defineProperty(E,C,M):E[C]=g[C]}return E.default=g,T&&T.set(g,E),E}(S());function u(g){if(typeof WeakMap!="function")return null;var _=new WeakMap,T=new WeakMap;return(u=function(E){return E?T:_})(g)}function f(g,_,T){var E=_[0],O=_[1],C=_[2],M=_[3],D=_[4],I=_[5],R=T[0],H=T[1],X=T[2],J=T[3],ne=T[4],re=T[5];return g[0]=E*R+C*H,g[1]=O*R+M*H,g[2]=E*X+C*J,g[3]=O*X+M*J,g[4]=E*ne+C*re+D,g[5]=O*ne+M*re+I,g}function y(g,_,T){return g[0]=_[0]-T[0],g[1]=_[1]-T[1],g[2]=_[2]-T[2],g[3]=_[3]-T[3],g[4]=_[4]-T[4],g[5]=_[5]-T[5],g}return V.mul=f,V.sub=y,V}var G,W={};function Z(){if(G)return W;function m(g){return m=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(_){return typeof _}:function(_){return _&&typeof Symbol=="function"&&_.constructor===Symbol&&_!==Symbol.prototype?"symbol":typeof _},m(g)}G=1,Object.defineProperty(W,"__esModule",{value:!0}),W.create=function(){var g=new o.ARRAY_TYPE(9);return o.ARRAY_TYPE!=Float32Array&&(g[1]=0,g[2]=0,g[3]=0,g[5]=0,g[6]=0,g[7]=0),g[0]=1,g[4]=1,g[8]=1,g},W.fromMat4=function(g,_){return g[0]=_[0],g[1]=_[1],g[2]=_[2],g[3]=_[4],g[4]=_[5],g[5]=_[6],g[6]=_[8],g[7]=_[9],g[8]=_[10],g},W.clone=function(g){var _=new o.ARRAY_TYPE(9);return _[0]=g[0],_[1]=g[1],_[2]=g[2],_[3]=g[3],_[4]=g[4],_[5]=g[5],_[6]=g[6],_[7]=g[7],_[8]=g[8],_},W.copy=function(g,_){return g[0]=_[0],g[1]=_[1],g[2]=_[2],g[3]=_[3],g[4]=_[4],g[5]=_[5],g[6]=_[6],g[7]=_[7],g[8]=_[8],g},W.fromValues=function(g,_,T,E,O,C,M,D,I){var R=new o.ARRAY_TYPE(9);return R[0]=g,R[1]=_,R[2]=T,R[3]=E,R[4]=O,R[5]=C,R[6]=M,R[7]=D,R[8]=I,R},W.set=function(g,_,T,E,O,C,M,D,I,R){return g[0]=_,g[1]=T,g[2]=E,g[3]=O,g[4]=C,g[5]=M,g[6]=D,g[7]=I,g[8]=R,g},W.identity=function(g){return g[0]=1,g[1]=0,g[2]=0,g[3]=0,g[4]=1,g[5]=0,g[6]=0,g[7]=0,g[8]=1,g},W.transpose=function(g,_){if(g===_){var T=_[1],E=_[2],O=_[5];g[1]=_[3],g[2]=_[6],g[3]=T,g[5]=_[7],g[6]=E,g[7]=O}else g[0]=_[0],g[1]=_[3],g[2]=_[6],g[3]=_[1],g[4]=_[4],g[5]=_[7],g[6]=_[2],g[7]=_[5],g[8]=_[8];return g},W.invert=function(g,_){var T=_[0],E=_[1],O=_[2],C=_[3],M=_[4],D=_[5],I=_[6],R=_[7],H=_[8],X=H*M-D*R,J=-H*C+D*I,ne=R*C-M*I,re=T*X+E*J+O*ne;return re?(g[0]=X*(re=1/re),g[1]=(-H*E+O*R)*re,g[2]=(D*E-O*M)*re,g[3]=J*re,g[4]=(H*T-O*I)*re,g[5]=(-D*T+O*C)*re,g[6]=ne*re,g[7]=(-R*T+E*I)*re,g[8]=(M*T-E*C)*re,g):null},W.adjoint=function(g,_){var T=_[0],E=_[1],O=_[2],C=_[3],M=_[4],D=_[5],I=_[6],R=_[7],H=_[8];return g[0]=M*H-D*R,g[1]=O*R-E*H,g[2]=E*D-O*M,g[3]=D*I-C*H,g[4]=T*H-O*I,g[5]=O*C-T*D,g[6]=C*R-M*I,g[7]=E*I-T*R,g[8]=T*M-E*C,g},W.determinant=function(g){var _=g[3],T=g[4],E=g[5],O=g[6],C=g[7],M=g[8];return g[0]*(M*T-E*C)+g[1]*(-M*_+E*O)+g[2]*(C*_-T*O)},W.multiply=f,W.translate=function(g,_,T){var E=_[0],O=_[1],C=_[2],M=_[3],D=_[4],I=_[5],R=_[6],H=_[7],X=_[8],J=T[0],ne=T[1];return g[0]=E,g[1]=O,g[2]=C,g[3]=M,g[4]=D,g[5]=I,g[6]=J*E+ne*M+R,g[7]=J*O+ne*D+H,g[8]=J*C+ne*I+X,g},W.rotate=function(g,_,T){var E=_[0],O=_[1],C=_[2],M=_[3],D=_[4],I=_[5],R=_[6],H=_[7],X=_[8],J=Math.sin(T),ne=Math.cos(T);return g[0]=ne*E+J*M,g[1]=ne*O+J*D,g[2]=ne*C+J*I,g[3]=ne*M-J*E,g[4]=ne*D-J*O,g[5]=ne*I-J*C,g[6]=R,g[7]=H,g[8]=X,g},W.scale=function(g,_,T){var E=T[0],O=T[1];return g[0]=E*_[0],g[1]=E*_[1],g[2]=E*_[2],g[3]=O*_[3],g[4]=O*_[4],g[5]=O*_[5],g[6]=_[6],g[7]=_[7],g[8]=_[8],g},W.fromTranslation=function(g,_){return g[0]=1,g[1]=0,g[2]=0,g[3]=0,g[4]=1,g[5]=0,g[6]=_[0],g[7]=_[1],g[8]=1,g},W.fromRotation=function(g,_){var T=Math.sin(_),E=Math.cos(_);return g[0]=E,g[1]=T,g[2]=0,g[3]=-T,g[4]=E,g[5]=0,g[6]=0,g[7]=0,g[8]=1,g},W.fromScaling=function(g,_){return g[0]=_[0],g[1]=0,g[2]=0,g[3]=0,g[4]=_[1],g[5]=0,g[6]=0,g[7]=0,g[8]=1,g},W.fromMat2d=function(g,_){return g[0]=_[0],g[1]=_[1],g[2]=0,g[3]=_[2],g[4]=_[3],g[5]=0,g[6]=_[4],g[7]=_[5],g[8]=1,g},W.fromQuat=function(g,_){var T=_[0],E=_[1],O=_[2],C=_[3],M=T+T,D=E+E,I=O+O,R=T*M,H=E*M,X=E*D,J=O*M,ne=O*D,re=O*I,te=C*M,oe=C*D,ue=C*I;return g[0]=1-X-re,g[3]=H-ue,g[6]=J+oe,g[1]=H+ue,g[4]=1-R-re,g[7]=ne-te,g[2]=J-oe,g[5]=ne+te,g[8]=1-R-X,g},W.normalFromMat4=function(g,_){var T=_[0],E=_[1],O=_[2],C=_[3],M=_[4],D=_[5],I=_[6],R=_[7],H=_[8],X=_[9],J=_[10],ne=_[11],re=_[12],te=_[13],oe=_[14],ue=_[15],me=T*D-E*M,Me=T*I-O*M,Se=T*R-C*M,Ae=E*I-O*D,Ve=E*R-C*D,Ie=O*R-C*I,Ge=H*te-X*re,Ze=H*oe-J*re,We=H*ue-ne*re,Qe=X*oe-J*te,Je=X*ue-ne*te,ot=J*ue-ne*oe,nt=me*ot-Me*Je+Se*Qe+Ae*We-Ve*Ze+Ie*Ge;return nt?(g[0]=(D*ot-I*Je+R*Qe)*(nt=1/nt),g[1]=(I*We-M*ot-R*Ze)*nt,g[2]=(M*Je-D*We+R*Ge)*nt,g[3]=(O*Je-E*ot-C*Qe)*nt,g[4]=(T*ot-O*We+C*Ze)*nt,g[5]=(E*We-T*Je-C*Ge)*nt,g[6]=(te*Ie-oe*Ve+ue*Ae)*nt,g[7]=(oe*Se-re*Ie-ue*Me)*nt,g[8]=(re*Ve-te*Se+ue*me)*nt,g):null},W.projection=function(g,_,T){return g[0]=2/_,g[1]=0,g[2]=0,g[3]=0,g[4]=-2/T,g[5]=0,g[6]=-1,g[7]=1,g[8]=1,g},W.str=function(g){return"mat3("+g[0]+", "+g[1]+", "+g[2]+", "+g[3]+", "+g[4]+", "+g[5]+", "+g[6]+", "+g[7]+", "+g[8]+")"},W.frob=function(g){return Math.hypot(g[0],g[1],g[2],g[3],g[4],g[5],g[6],g[7],g[8])},W.add=function(g,_,T){return g[0]=_[0]+T[0],g[1]=_[1]+T[1],g[2]=_[2]+T[2],g[3]=_[3]+T[3],g[4]=_[4]+T[4],g[5]=_[5]+T[5],g[6]=_[6]+T[6],g[7]=_[7]+T[7],g[8]=_[8]+T[8],g},W.subtract=y,W.multiplyScalar=function(g,_,T){return g[0]=_[0]*T,g[1]=_[1]*T,g[2]=_[2]*T,g[3]=_[3]*T,g[4]=_[4]*T,g[5]=_[5]*T,g[6]=_[6]*T,g[7]=_[7]*T,g[8]=_[8]*T,g},W.multiplyScalarAndAdd=function(g,_,T,E){return g[0]=_[0]+T[0]*E,g[1]=_[1]+T[1]*E,g[2]=_[2]+T[2]*E,g[3]=_[3]+T[3]*E,g[4]=_[4]+T[4]*E,g[5]=_[5]+T[5]*E,g[6]=_[6]+T[6]*E,g[7]=_[7]+T[7]*E,g[8]=_[8]+T[8]*E,g},W.exactEquals=function(g,_){return g[0]===_[0]&&g[1]===_[1]&&g[2]===_[2]&&g[3]===_[3]&&g[4]===_[4]&&g[5]===_[5]&&g[6]===_[6]&&g[7]===_[7]&&g[8]===_[8]},W.equals=function(g,_){var T=g[0],E=g[1],O=g[2],C=g[3],M=g[4],D=g[5],I=g[6],R=g[7],H=g[8],X=_[0],J=_[1],ne=_[2],re=_[3],te=_[4],oe=_[5],ue=_[6],me=_[7],Me=_[8];return Math.abs(T-X)<=o.EPSILON*Math.max(1,Math.abs(T),Math.abs(X))&&Math.abs(E-J)<=o.EPSILON*Math.max(1,Math.abs(E),Math.abs(J))&&Math.abs(O-ne)<=o.EPSILON*Math.max(1,Math.abs(O),Math.abs(ne))&&Math.abs(C-re)<=o.EPSILON*Math.max(1,Math.abs(C),Math.abs(re))&&Math.abs(M-te)<=o.EPSILON*Math.max(1,Math.abs(M),Math.abs(te))&&Math.abs(D-oe)<=o.EPSILON*Math.max(1,Math.abs(D),Math.abs(oe))&&Math.abs(I-ue)<=o.EPSILON*Math.max(1,Math.abs(I),Math.abs(ue))&&Math.abs(R-me)<=o.EPSILON*Math.max(1,Math.abs(R),Math.abs(me))&&Math.abs(H-Me)<=o.EPSILON*Math.max(1,Math.abs(H),Math.abs(Me))},W.sub=W.mul=void 0;var o=function(g,_){if(g&&g.__esModule)return g;if(g===null||m(g)!=="object"&&typeof g!="function")return{default:g};var T=u(void 0);if(T&&T.has(g))return T.get(g);var E={},O=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var C in g)if(C!=="default"&&Object.prototype.hasOwnProperty.call(g,C)){var M=O?Object.getOwnPropertyDescriptor(g,C):null;M&&(M.get||M.set)?Object.defineProperty(E,C,M):E[C]=g[C]}return E.default=g,T&&T.set(g,E),E}(S());function u(g){if(typeof WeakMap!="function")return null;var _=new WeakMap,T=new WeakMap;return(u=function(E){return E?T:_})(g)}function f(g,_,T){var E=_[0],O=_[1],C=_[2],M=_[3],D=_[4],I=_[5],R=_[6],H=_[7],X=_[8],J=T[0],ne=T[1],re=T[2],te=T[3],oe=T[4],ue=T[5],me=T[6],Me=T[7],Se=T[8];return g[0]=J*E+ne*M+re*R,g[1]=J*O+ne*D+re*H,g[2]=J*C+ne*I+re*X,g[3]=te*E+oe*M+ue*R,g[4]=te*O+oe*D+ue*H,g[5]=te*C+oe*I+ue*X,g[6]=me*E+Me*M+Se*R,g[7]=me*O+Me*D+Se*H,g[8]=me*C+Me*I+Se*X,g}function y(g,_,T){return g[0]=_[0]-T[0],g[1]=_[1]-T[1],g[2]=_[2]-T[2],g[3]=_[3]-T[3],g[4]=_[4]-T[4],g[5]=_[5]-T[5],g[6]=_[6]-T[6],g[7]=_[7]-T[7],g[8]=_[8]-T[8],g}return W.mul=f,W.sub=y,W}var se,ae={};function ce(){if(se)return ae;function m(C){return m=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(M){return typeof M}:function(M){return M&&typeof Symbol=="function"&&M.constructor===Symbol&&M!==Symbol.prototype?"symbol":typeof M},m(C)}se=1,Object.defineProperty(ae,"__esModule",{value:!0}),ae.create=function(){var C=new o.ARRAY_TYPE(16);return o.ARRAY_TYPE!=Float32Array&&(C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[11]=0,C[12]=0,C[13]=0,C[14]=0),C[0]=1,C[5]=1,C[10]=1,C[15]=1,C},ae.clone=function(C){var M=new o.ARRAY_TYPE(16);return M[0]=C[0],M[1]=C[1],M[2]=C[2],M[3]=C[3],M[4]=C[4],M[5]=C[5],M[6]=C[6],M[7]=C[7],M[8]=C[8],M[9]=C[9],M[10]=C[10],M[11]=C[11],M[12]=C[12],M[13]=C[13],M[14]=C[14],M[15]=C[15],M},ae.copy=function(C,M){return C[0]=M[0],C[1]=M[1],C[2]=M[2],C[3]=M[3],C[4]=M[4],C[5]=M[5],C[6]=M[6],C[7]=M[7],C[8]=M[8],C[9]=M[9],C[10]=M[10],C[11]=M[11],C[12]=M[12],C[13]=M[13],C[14]=M[14],C[15]=M[15],C},ae.fromValues=function(C,M,D,I,R,H,X,J,ne,re,te,oe,ue,me,Me,Se){var Ae=new o.ARRAY_TYPE(16);return Ae[0]=C,Ae[1]=M,Ae[2]=D,Ae[3]=I,Ae[4]=R,Ae[5]=H,Ae[6]=X,Ae[7]=J,Ae[8]=ne,Ae[9]=re,Ae[10]=te,Ae[11]=oe,Ae[12]=ue,Ae[13]=me,Ae[14]=Me,Ae[15]=Se,Ae},ae.set=function(C,M,D,I,R,H,X,J,ne,re,te,oe,ue,me,Me,Se,Ae){return C[0]=M,C[1]=D,C[2]=I,C[3]=R,C[4]=H,C[5]=X,C[6]=J,C[7]=ne,C[8]=re,C[9]=te,C[10]=oe,C[11]=ue,C[12]=me,C[13]=Me,C[14]=Se,C[15]=Ae,C},ae.identity=f,ae.transpose=function(C,M){if(C===M){var D=M[1],I=M[2],R=M[3],H=M[6],X=M[7],J=M[11];C[1]=M[4],C[2]=M[8],C[3]=M[12],C[4]=D,C[6]=M[9],C[7]=M[13],C[8]=I,C[9]=H,C[11]=M[14],C[12]=R,C[13]=X,C[14]=J}else C[0]=M[0],C[1]=M[4],C[2]=M[8],C[3]=M[12],C[4]=M[1],C[5]=M[5],C[6]=M[9],C[7]=M[13],C[8]=M[2],C[9]=M[6],C[10]=M[10],C[11]=M[14],C[12]=M[3],C[13]=M[7],C[14]=M[11],C[15]=M[15];return C},ae.invert=function(C,M){var D=M[0],I=M[1],R=M[2],H=M[3],X=M[4],J=M[5],ne=M[6],re=M[7],te=M[8],oe=M[9],ue=M[10],me=M[11],Me=M[12],Se=M[13],Ae=M[14],Ve=M[15],Ie=D*J-I*X,Ge=D*ne-R*X,Ze=D*re-H*X,We=I*ne-R*J,Qe=I*re-H*J,Je=R*re-H*ne,ot=te*Se-oe*Me,nt=te*Ae-ue*Me,ct=te*Ve-me*Me,Ot=oe*Ae-ue*Se,Mt=oe*Ve-me*Se,cr=ue*Ve-me*Ae,Lt=Ie*cr-Ge*Mt+Ze*Ot+We*ct-Qe*nt+Je*ot;return Lt?(C[0]=(J*cr-ne*Mt+re*Ot)*(Lt=1/Lt),C[1]=(R*Mt-I*cr-H*Ot)*Lt,C[2]=(Se*Je-Ae*Qe+Ve*We)*Lt,C[3]=(ue*Qe-oe*Je-me*We)*Lt,C[4]=(ne*ct-X*cr-re*nt)*Lt,C[5]=(D*cr-R*ct+H*nt)*Lt,C[6]=(Ae*Ze-Me*Je-Ve*Ge)*Lt,C[7]=(te*Je-ue*Ze+me*Ge)*Lt,C[8]=(X*Mt-J*ct+re*ot)*Lt,C[9]=(I*ct-D*Mt-H*ot)*Lt,C[10]=(Me*Qe-Se*Ze+Ve*Ie)*Lt,C[11]=(oe*Ze-te*Qe-me*Ie)*Lt,C[12]=(J*nt-X*Ot-ne*ot)*Lt,C[13]=(D*Ot-I*nt+R*ot)*Lt,C[14]=(Se*Ge-Me*We-Ae*Ie)*Lt,C[15]=(te*We-oe*Ge+ue*Ie)*Lt,C):null},ae.adjoint=function(C,M){var D=M[0],I=M[1],R=M[2],H=M[3],X=M[4],J=M[5],ne=M[6],re=M[7],te=M[8],oe=M[9],ue=M[10],me=M[11],Me=M[12],Se=M[13],Ae=M[14],Ve=M[15];return C[0]=J*(ue*Ve-me*Ae)-oe*(ne*Ve-re*Ae)+Se*(ne*me-re*ue),C[1]=-(I*(ue*Ve-me*Ae)-oe*(R*Ve-H*Ae)+Se*(R*me-H*ue)),C[2]=I*(ne*Ve-re*Ae)-J*(R*Ve-H*Ae)+Se*(R*re-H*ne),C[3]=-(I*(ne*me-re*ue)-J*(R*me-H*ue)+oe*(R*re-H*ne)),C[4]=-(X*(ue*Ve-me*Ae)-te*(ne*Ve-re*Ae)+Me*(ne*me-re*ue)),C[5]=D*(ue*Ve-me*Ae)-te*(R*Ve-H*Ae)+Me*(R*me-H*ue),C[6]=-(D*(ne*Ve-re*Ae)-X*(R*Ve-H*Ae)+Me*(R*re-H*ne)),C[7]=D*(ne*me-re*ue)-X*(R*me-H*ue)+te*(R*re-H*ne),C[8]=X*(oe*Ve-me*Se)-te*(J*Ve-re*Se)+Me*(J*me-re*oe),C[9]=-(D*(oe*Ve-me*Se)-te*(I*Ve-H*Se)+Me*(I*me-H*oe)),C[10]=D*(J*Ve-re*Se)-X*(I*Ve-H*Se)+Me*(I*re-H*J),C[11]=-(D*(J*me-re*oe)-X*(I*me-H*oe)+te*(I*re-H*J)),C[12]=-(X*(oe*Ae-ue*Se)-te*(J*Ae-ne*Se)+Me*(J*ue-ne*oe)),C[13]=D*(oe*Ae-ue*Se)-te*(I*Ae-R*Se)+Me*(I*ue-R*oe),C[14]=-(D*(J*Ae-ne*Se)-X*(I*Ae-R*Se)+Me*(I*ne-R*J)),C[15]=D*(J*ue-ne*oe)-X*(I*ue-R*oe)+te*(I*ne-R*J),C},ae.determinant=function(C){var M=C[0],D=C[1],I=C[2],R=C[3],H=C[4],X=C[5],J=C[6],ne=C[7],re=C[8],te=C[9],oe=C[10],ue=C[11],me=C[12],Me=C[13],Se=C[14],Ae=C[15];return(M*X-D*H)*(oe*Ae-ue*Se)-(M*J-I*H)*(te*Ae-ue*Me)+(M*ne-R*H)*(te*Se-oe*Me)+(D*J-I*X)*(re*Ae-ue*me)-(D*ne-R*X)*(re*Se-oe*me)+(I*ne-R*J)*(re*Me-te*me)},ae.multiply=y,ae.translate=function(C,M,D){var I,R,H,X,J,ne,re,te,oe,ue,me,Me,Se=D[0],Ae=D[1],Ve=D[2];return M===C?(C[12]=M[0]*Se+M[4]*Ae+M[8]*Ve+M[12],C[13]=M[1]*Se+M[5]*Ae+M[9]*Ve+M[13],C[14]=M[2]*Se+M[6]*Ae+M[10]*Ve+M[14],C[15]=M[3]*Se+M[7]*Ae+M[11]*Ve+M[15]):(R=M[1],H=M[2],X=M[3],J=M[4],ne=M[5],re=M[6],te=M[7],oe=M[8],ue=M[9],me=M[10],Me=M[11],C[0]=I=M[0],C[1]=R,C[2]=H,C[3]=X,C[4]=J,C[5]=ne,C[6]=re,C[7]=te,C[8]=oe,C[9]=ue,C[10]=me,C[11]=Me,C[12]=I*Se+J*Ae+oe*Ve+M[12],C[13]=R*Se+ne*Ae+ue*Ve+M[13],C[14]=H*Se+re*Ae+me*Ve+M[14],C[15]=X*Se+te*Ae+Me*Ve+M[15]),C},ae.scale=function(C,M,D){var I=D[0],R=D[1],H=D[2];return C[0]=M[0]*I,C[1]=M[1]*I,C[2]=M[2]*I,C[3]=M[3]*I,C[4]=M[4]*R,C[5]=M[5]*R,C[6]=M[6]*R,C[7]=M[7]*R,C[8]=M[8]*H,C[9]=M[9]*H,C[10]=M[10]*H,C[11]=M[11]*H,C[12]=M[12],C[13]=M[13],C[14]=M[14],C[15]=M[15],C},ae.rotate=function(C,M,D,I){var R,H,X,J,ne,re,te,oe,ue,me,Me,Se,Ae,Ve,Ie,Ge,Ze,We,Qe,Je,ot,nt,ct,Ot,Mt=I[0],cr=I[1],Lt=I[2],Gt=Math.hypot(Mt,cr,Lt);return Gt<o.EPSILON?null:(Mt*=Gt=1/Gt,cr*=Gt,Lt*=Gt,R=Math.sin(D),H=Math.cos(D),ne=M[1],re=M[2],te=M[3],ue=M[5],me=M[6],Me=M[7],Ae=M[9],Ve=M[10],Ie=M[11],Ge=Mt*Mt*(X=1-H)+H,Qe=Mt*cr*X-Lt*R,Je=cr*cr*X+H,ot=Lt*cr*X+Mt*R,nt=Mt*Lt*X+cr*R,ct=cr*Lt*X-Mt*R,Ot=Lt*Lt*X+H,C[0]=(J=M[0])*Ge+(oe=M[4])*(Ze=cr*Mt*X+Lt*R)+(Se=M[8])*(We=Lt*Mt*X-cr*R),C[1]=ne*Ge+ue*Ze+Ae*We,C[2]=re*Ge+me*Ze+Ve*We,C[3]=te*Ge+Me*Ze+Ie*We,C[4]=J*Qe+oe*Je+Se*ot,C[5]=ne*Qe+ue*Je+Ae*ot,C[6]=re*Qe+me*Je+Ve*ot,C[7]=te*Qe+Me*Je+Ie*ot,C[8]=J*nt+oe*ct+Se*Ot,C[9]=ne*nt+ue*ct+Ae*Ot,C[10]=re*nt+me*ct+Ve*Ot,C[11]=te*nt+Me*ct+Ie*Ot,M!==C&&(C[12]=M[12],C[13]=M[13],C[14]=M[14],C[15]=M[15]),C)},ae.rotateX=function(C,M,D){var I=Math.sin(D),R=Math.cos(D),H=M[4],X=M[5],J=M[6],ne=M[7],re=M[8],te=M[9],oe=M[10],ue=M[11];return M!==C&&(C[0]=M[0],C[1]=M[1],C[2]=M[2],C[3]=M[3],C[12]=M[12],C[13]=M[13],C[14]=M[14],C[15]=M[15]),C[4]=H*R+re*I,C[5]=X*R+te*I,C[6]=J*R+oe*I,C[7]=ne*R+ue*I,C[8]=re*R-H*I,C[9]=te*R-X*I,C[10]=oe*R-J*I,C[11]=ue*R-ne*I,C},ae.rotateY=function(C,M,D){var I=Math.sin(D),R=Math.cos(D),H=M[0],X=M[1],J=M[2],ne=M[3],re=M[8],te=M[9],oe=M[10],ue=M[11];return M!==C&&(C[4]=M[4],C[5]=M[5],C[6]=M[6],C[7]=M[7],C[12]=M[12],C[13]=M[13],C[14]=M[14],C[15]=M[15]),C[0]=H*R-re*I,C[1]=X*R-te*I,C[2]=J*R-oe*I,C[3]=ne*R-ue*I,C[8]=H*I+re*R,C[9]=X*I+te*R,C[10]=J*I+oe*R,C[11]=ne*I+ue*R,C},ae.rotateZ=function(C,M,D){var I=Math.sin(D),R=Math.cos(D),H=M[0],X=M[1],J=M[2],ne=M[3],re=M[4],te=M[5],oe=M[6],ue=M[7];return M!==C&&(C[8]=M[8],C[9]=M[9],C[10]=M[10],C[11]=M[11],C[12]=M[12],C[13]=M[13],C[14]=M[14],C[15]=M[15]),C[0]=H*R+re*I,C[1]=X*R+te*I,C[2]=J*R+oe*I,C[3]=ne*R+ue*I,C[4]=re*R-H*I,C[5]=te*R-X*I,C[6]=oe*R-J*I,C[7]=ue*R-ne*I,C},ae.fromTranslation=function(C,M){return C[0]=1,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=1,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[10]=1,C[11]=0,C[12]=M[0],C[13]=M[1],C[14]=M[2],C[15]=1,C},ae.fromScaling=function(C,M){return C[0]=M[0],C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=M[1],C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[10]=M[2],C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C},ae.fromRotation=function(C,M,D){var I,R,H,X=D[0],J=D[1],ne=D[2],re=Math.hypot(X,J,ne);return re<o.EPSILON?null:(X*=re=1/re,J*=re,ne*=re,I=Math.sin(M),R=Math.cos(M),C[0]=X*X*(H=1-R)+R,C[1]=J*X*H+ne*I,C[2]=ne*X*H-J*I,C[3]=0,C[4]=X*J*H-ne*I,C[5]=J*J*H+R,C[6]=ne*J*H+X*I,C[7]=0,C[8]=X*ne*H+J*I,C[9]=J*ne*H-X*I,C[10]=ne*ne*H+R,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C)},ae.fromXRotation=function(C,M){var D=Math.sin(M),I=Math.cos(M);return C[0]=1,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=I,C[6]=D,C[7]=0,C[8]=0,C[9]=-D,C[10]=I,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C},ae.fromYRotation=function(C,M){var D=Math.sin(M),I=Math.cos(M);return C[0]=I,C[1]=0,C[2]=-D,C[3]=0,C[4]=0,C[5]=1,C[6]=0,C[7]=0,C[8]=D,C[9]=0,C[10]=I,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C},ae.fromZRotation=function(C,M){var D=Math.sin(M),I=Math.cos(M);return C[0]=I,C[1]=D,C[2]=0,C[3]=0,C[4]=-D,C[5]=I,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[10]=1,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C},ae.fromRotationTranslation=g,ae.fromQuat2=function(C,M){var D=new o.ARRAY_TYPE(3),I=-M[0],R=-M[1],H=-M[2],X=M[3],J=M[4],ne=M[5],re=M[6],te=M[7],oe=I*I+R*R+H*H+X*X;return oe>0?(D[0]=2*(J*X+te*I+ne*H-re*R)/oe,D[1]=2*(ne*X+te*R+re*I-J*H)/oe,D[2]=2*(re*X+te*H+J*R-ne*I)/oe):(D[0]=2*(J*X+te*I+ne*H-re*R),D[1]=2*(ne*X+te*R+re*I-J*H),D[2]=2*(re*X+te*H+J*R-ne*I)),g(C,M,D),C},ae.getTranslation=function(C,M){return C[0]=M[12],C[1]=M[13],C[2]=M[14],C},ae.getScaling=_,ae.getRotation=function(C,M){var D=new o.ARRAY_TYPE(3);_(D,M);var I=1/D[0],R=1/D[1],H=1/D[2],X=M[0]*I,J=M[1]*R,ne=M[2]*H,re=M[4]*I,te=M[5]*R,oe=M[6]*H,ue=M[8]*I,me=M[9]*R,Me=M[10]*H,Se=X+te+Me,Ae=0;return Se>0?(Ae=2*Math.sqrt(Se+1),C[3]=.25*Ae,C[0]=(oe-me)/Ae,C[1]=(ue-ne)/Ae,C[2]=(J-re)/Ae):X>te&&X>Me?(Ae=2*Math.sqrt(1+X-te-Me),C[3]=(oe-me)/Ae,C[0]=.25*Ae,C[1]=(J+re)/Ae,C[2]=(ue+ne)/Ae):te>Me?(Ae=2*Math.sqrt(1+te-X-Me),C[3]=(ue-ne)/Ae,C[0]=(J+re)/Ae,C[1]=.25*Ae,C[2]=(oe+me)/Ae):(Ae=2*Math.sqrt(1+Me-X-te),C[3]=(J-re)/Ae,C[0]=(ue+ne)/Ae,C[1]=(oe+me)/Ae,C[2]=.25*Ae),C},ae.fromRotationTranslationScale=function(C,M,D,I){var R=M[0],H=M[1],X=M[2],J=M[3],ne=R+R,re=H+H,te=X+X,oe=R*ne,ue=R*re,me=R*te,Me=H*re,Se=H*te,Ae=X*te,Ve=J*ne,Ie=J*re,Ge=J*te,Ze=I[0],We=I[1],Qe=I[2];return C[0]=(1-(Me+Ae))*Ze,C[1]=(ue+Ge)*Ze,C[2]=(me-Ie)*Ze,C[3]=0,C[4]=(ue-Ge)*We,C[5]=(1-(oe+Ae))*We,C[6]=(Se+Ve)*We,C[7]=0,C[8]=(me+Ie)*Qe,C[9]=(Se-Ve)*Qe,C[10]=(1-(oe+Me))*Qe,C[11]=0,C[12]=D[0],C[13]=D[1],C[14]=D[2],C[15]=1,C},ae.fromRotationTranslationScaleOrigin=function(C,M,D,I,R){var H=M[0],X=M[1],J=M[2],ne=M[3],re=H+H,te=X+X,oe=J+J,ue=H*re,me=H*te,Me=H*oe,Se=X*te,Ae=X*oe,Ve=J*oe,Ie=ne*re,Ge=ne*te,Ze=ne*oe,We=I[0],Qe=I[1],Je=I[2],ot=R[0],nt=R[1],ct=R[2],Ot=(1-(Se+Ve))*We,Mt=(me+Ze)*We,cr=(Me-Ge)*We,Lt=(me-Ze)*Qe,Gt=(1-(ue+Ve))*Qe,Rt=(Ae+Ie)*Qe,Pr=(Me+Ge)*Je,ir=(Ae-Ie)*Je,pr=(1-(ue+Se))*Je;return C[0]=Ot,C[1]=Mt,C[2]=cr,C[3]=0,C[4]=Lt,C[5]=Gt,C[6]=Rt,C[7]=0,C[8]=Pr,C[9]=ir,C[10]=pr,C[11]=0,C[12]=D[0]+ot-(Ot*ot+Lt*nt+Pr*ct),C[13]=D[1]+nt-(Mt*ot+Gt*nt+ir*ct),C[14]=D[2]+ct-(cr*ot+Rt*nt+pr*ct),C[15]=1,C},ae.fromQuat=function(C,M){var D=M[0],I=M[1],R=M[2],H=M[3],X=D+D,J=I+I,ne=R+R,re=D*X,te=I*X,oe=I*J,ue=R*X,me=R*J,Me=R*ne,Se=H*X,Ae=H*J,Ve=H*ne;return C[0]=1-oe-Me,C[1]=te+Ve,C[2]=ue-Ae,C[3]=0,C[4]=te-Ve,C[5]=1-re-Me,C[6]=me+Se,C[7]=0,C[8]=ue+Ae,C[9]=me-Se,C[10]=1-re-oe,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C},ae.frustum=function(C,M,D,I,R,H,X){var J=1/(D-M),ne=1/(R-I),re=1/(H-X);return C[0]=2*H*J,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=2*H*ne,C[6]=0,C[7]=0,C[8]=(D+M)*J,C[9]=(R+I)*ne,C[10]=(X+H)*re,C[11]=-1,C[12]=0,C[13]=0,C[14]=X*H*2*re,C[15]=0,C},ae.perspectiveNO=T,ae.perspectiveZO=function(C,M,D,I,R){var H,X=1/Math.tan(M/2);return C[0]=X/D,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=X,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[11]=-1,C[12]=0,C[13]=0,C[15]=0,R!=null&&R!==1/0?(C[10]=R*(H=1/(I-R)),C[14]=R*I*H):(C[10]=-1,C[14]=-I),C},ae.perspectiveFromFieldOfView=function(C,M,D,I){var R=Math.tan(M.upDegrees*Math.PI/180),H=Math.tan(M.downDegrees*Math.PI/180),X=Math.tan(M.leftDegrees*Math.PI/180),J=Math.tan(M.rightDegrees*Math.PI/180),ne=2/(X+J),re=2/(R+H);return C[0]=ne,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=re,C[6]=0,C[7]=0,C[8]=-(X-J)*ne*.5,C[9]=(R-H)*re*.5,C[10]=I/(D-I),C[11]=-1,C[12]=0,C[13]=0,C[14]=I*D/(D-I),C[15]=0,C},ae.orthoNO=E,ae.orthoZO=function(C,M,D,I,R,H,X){var J=1/(M-D),ne=1/(I-R),re=1/(H-X);return C[0]=-2*J,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=-2*ne,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[10]=re,C[11]=0,C[12]=(M+D)*J,C[13]=(R+I)*ne,C[14]=H*re,C[15]=1,C},ae.lookAt=function(C,M,D,I){var R,H,X,J,ne,re,te,oe,ue,me,Me=M[0],Se=M[1],Ae=M[2],Ve=I[0],Ie=I[1],Ge=I[2],Ze=D[0],We=D[1],Qe=D[2];return Math.abs(Me-Ze)<o.EPSILON&&Math.abs(Se-We)<o.EPSILON&&Math.abs(Ae-Qe)<o.EPSILON?f(C):(te=Me-Ze,oe=Se-We,ue=Ae-Qe,R=Ie*(ue*=me=1/Math.hypot(te,oe,ue))-Ge*(oe*=me),H=Ge*(te*=me)-Ve*ue,X=Ve*oe-Ie*te,(me=Math.hypot(R,H,X))?(R*=me=1/me,H*=me,X*=me):(R=0,H=0,X=0),J=oe*X-ue*H,ne=ue*R-te*X,re=te*H-oe*R,(me=Math.hypot(J,ne,re))?(J*=me=1/me,ne*=me,re*=me):(J=0,ne=0,re=0),C[0]=R,C[1]=J,C[2]=te,C[3]=0,C[4]=H,C[5]=ne,C[6]=oe,C[7]=0,C[8]=X,C[9]=re,C[10]=ue,C[11]=0,C[12]=-(R*Me+H*Se+X*Ae),C[13]=-(J*Me+ne*Se+re*Ae),C[14]=-(te*Me+oe*Se+ue*Ae),C[15]=1,C)},ae.targetTo=function(C,M,D,I){var R=M[0],H=M[1],X=M[2],J=I[0],ne=I[1],re=I[2],te=R-D[0],oe=H-D[1],ue=X-D[2],me=te*te+oe*oe+ue*ue;me>0&&(te*=me=1/Math.sqrt(me),oe*=me,ue*=me);var Me=ne*ue-re*oe,Se=re*te-J*ue,Ae=J*oe-ne*te;return(me=Me*Me+Se*Se+Ae*Ae)>0&&(Me*=me=1/Math.sqrt(me),Se*=me,Ae*=me),C[0]=Me,C[1]=Se,C[2]=Ae,C[3]=0,C[4]=oe*Ae-ue*Se,C[5]=ue*Me-te*Ae,C[6]=te*Se-oe*Me,C[7]=0,C[8]=te,C[9]=oe,C[10]=ue,C[11]=0,C[12]=R,C[13]=H,C[14]=X,C[15]=1,C},ae.str=function(C){return"mat4("+C[0]+", "+C[1]+", "+C[2]+", "+C[3]+", "+C[4]+", "+C[5]+", "+C[6]+", "+C[7]+", "+C[8]+", "+C[9]+", "+C[10]+", "+C[11]+", "+C[12]+", "+C[13]+", "+C[14]+", "+C[15]+")"},ae.frob=function(C){return Math.hypot(C[0],C[1],C[2],C[3],C[4],C[5],C[6],C[7],C[8],C[9],C[10],C[11],C[12],C[13],C[14],C[15])},ae.add=function(C,M,D){return C[0]=M[0]+D[0],C[1]=M[1]+D[1],C[2]=M[2]+D[2],C[3]=M[3]+D[3],C[4]=M[4]+D[4],C[5]=M[5]+D[5],C[6]=M[6]+D[6],C[7]=M[7]+D[7],C[8]=M[8]+D[8],C[9]=M[9]+D[9],C[10]=M[10]+D[10],C[11]=M[11]+D[11],C[12]=M[12]+D[12],C[13]=M[13]+D[13],C[14]=M[14]+D[14],C[15]=M[15]+D[15],C},ae.subtract=O,ae.multiplyScalar=function(C,M,D){return C[0]=M[0]*D,C[1]=M[1]*D,C[2]=M[2]*D,C[3]=M[3]*D,C[4]=M[4]*D,C[5]=M[5]*D,C[6]=M[6]*D,C[7]=M[7]*D,C[8]=M[8]*D,C[9]=M[9]*D,C[10]=M[10]*D,C[11]=M[11]*D,C[12]=M[12]*D,C[13]=M[13]*D,C[14]=M[14]*D,C[15]=M[15]*D,C},ae.multiplyScalarAndAdd=function(C,M,D,I){return C[0]=M[0]+D[0]*I,C[1]=M[1]+D[1]*I,C[2]=M[2]+D[2]*I,C[3]=M[3]+D[3]*I,C[4]=M[4]+D[4]*I,C[5]=M[5]+D[5]*I,C[6]=M[6]+D[6]*I,C[7]=M[7]+D[7]*I,C[8]=M[8]+D[8]*I,C[9]=M[9]+D[9]*I,C[10]=M[10]+D[10]*I,C[11]=M[11]+D[11]*I,C[12]=M[12]+D[12]*I,C[13]=M[13]+D[13]*I,C[14]=M[14]+D[14]*I,C[15]=M[15]+D[15]*I,C},ae.exactEquals=function(C,M){return C[0]===M[0]&&C[1]===M[1]&&C[2]===M[2]&&C[3]===M[3]&&C[4]===M[4]&&C[5]===M[5]&&C[6]===M[6]&&C[7]===M[7]&&C[8]===M[8]&&C[9]===M[9]&&C[10]===M[10]&&C[11]===M[11]&&C[12]===M[12]&&C[13]===M[13]&&C[14]===M[14]&&C[15]===M[15]},ae.equals=function(C,M){var D=C[0],I=C[1],R=C[2],H=C[3],X=C[4],J=C[5],ne=C[6],re=C[7],te=C[8],oe=C[9],ue=C[10],me=C[11],Me=C[12],Se=C[13],Ae=C[14],Ve=C[15],Ie=M[0],Ge=M[1],Ze=M[2],We=M[3],Qe=M[4],Je=M[5],ot=M[6],nt=M[7],ct=M[8],Ot=M[9],Mt=M[10],cr=M[11],Lt=M[12],Gt=M[13],Rt=M[14],Pr=M[15];return Math.abs(D-Ie)<=o.EPSILON*Math.max(1,Math.abs(D),Math.abs(Ie))&&Math.abs(I-Ge)<=o.EPSILON*Math.max(1,Math.abs(I),Math.abs(Ge))&&Math.abs(R-Ze)<=o.EPSILON*Math.max(1,Math.abs(R),Math.abs(Ze))&&Math.abs(H-We)<=o.EPSILON*Math.max(1,Math.abs(H),Math.abs(We))&&Math.abs(X-Qe)<=o.EPSILON*Math.max(1,Math.abs(X),Math.abs(Qe))&&Math.abs(J-Je)<=o.EPSILON*Math.max(1,Math.abs(J),Math.abs(Je))&&Math.abs(ne-ot)<=o.EPSILON*Math.max(1,Math.abs(ne),Math.abs(ot))&&Math.abs(re-nt)<=o.EPSILON*Math.max(1,Math.abs(re),Math.abs(nt))&&Math.abs(te-ct)<=o.EPSILON*Math.max(1,Math.abs(te),Math.abs(ct))&&Math.abs(oe-Ot)<=o.EPSILON*Math.max(1,Math.abs(oe),Math.abs(Ot))&&Math.abs(ue-Mt)<=o.EPSILON*Math.max(1,Math.abs(ue),Math.abs(Mt))&&Math.abs(me-cr)<=o.EPSILON*Math.max(1,Math.abs(me),Math.abs(cr))&&Math.abs(Me-Lt)<=o.EPSILON*Math.max(1,Math.abs(Me),Math.abs(Lt))&&Math.abs(Se-Gt)<=o.EPSILON*Math.max(1,Math.abs(Se),Math.abs(Gt))&&Math.abs(Ae-Rt)<=o.EPSILON*Math.max(1,Math.abs(Ae),Math.abs(Rt))&&Math.abs(Ve-Pr)<=o.EPSILON*Math.max(1,Math.abs(Ve),Math.abs(Pr))},ae.sub=ae.mul=ae.ortho=ae.perspective=void 0;var o=function(C,M){if(C&&C.__esModule)return C;if(C===null||m(C)!=="object"&&typeof C!="function")return{default:C};var D=u(void 0);if(D&&D.has(C))return D.get(C);var I={},R=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var H in C)if(H!=="default"&&Object.prototype.hasOwnProperty.call(C,H)){var X=R?Object.getOwnPropertyDescriptor(C,H):null;X&&(X.get||X.set)?Object.defineProperty(I,H,X):I[H]=C[H]}return I.default=C,D&&D.set(C,I),I}(S());function u(C){if(typeof WeakMap!="function")return null;var M=new WeakMap,D=new WeakMap;return(u=function(I){return I?D:M})(C)}function f(C){return C[0]=1,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=1,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[10]=1,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C}function y(C,M,D){var I=M[0],R=M[1],H=M[2],X=M[3],J=M[4],ne=M[5],re=M[6],te=M[7],oe=M[8],ue=M[9],me=M[10],Me=M[11],Se=M[12],Ae=M[13],Ve=M[14],Ie=M[15],Ge=D[0],Ze=D[1],We=D[2],Qe=D[3];return C[0]=Ge*I+Ze*J+We*oe+Qe*Se,C[1]=Ge*R+Ze*ne+We*ue+Qe*Ae,C[2]=Ge*H+Ze*re+We*me+Qe*Ve,C[3]=Ge*X+Ze*te+We*Me+Qe*Ie,C[4]=(Ge=D[4])*I+(Ze=D[5])*J+(We=D[6])*oe+(Qe=D[7])*Se,C[5]=Ge*R+Ze*ne+We*ue+Qe*Ae,C[6]=Ge*H+Ze*re+We*me+Qe*Ve,C[7]=Ge*X+Ze*te+We*Me+Qe*Ie,C[8]=(Ge=D[8])*I+(Ze=D[9])*J+(We=D[10])*oe+(Qe=D[11])*Se,C[9]=Ge*R+Ze*ne+We*ue+Qe*Ae,C[10]=Ge*H+Ze*re+We*me+Qe*Ve,C[11]=Ge*X+Ze*te+We*Me+Qe*Ie,C[12]=(Ge=D[12])*I+(Ze=D[13])*J+(We=D[14])*oe+(Qe=D[15])*Se,C[13]=Ge*R+Ze*ne+We*ue+Qe*Ae,C[14]=Ge*H+Ze*re+We*me+Qe*Ve,C[15]=Ge*X+Ze*te+We*Me+Qe*Ie,C}function g(C,M,D){var I=M[0],R=M[1],H=M[2],X=M[3],J=I+I,ne=R+R,re=H+H,te=I*J,oe=I*ne,ue=I*re,me=R*ne,Me=R*re,Se=H*re,Ae=X*J,Ve=X*ne,Ie=X*re;return C[0]=1-(me+Se),C[1]=oe+Ie,C[2]=ue-Ve,C[3]=0,C[4]=oe-Ie,C[5]=1-(te+Se),C[6]=Me+Ae,C[7]=0,C[8]=ue+Ve,C[9]=Me-Ae,C[10]=1-(te+me),C[11]=0,C[12]=D[0],C[13]=D[1],C[14]=D[2],C[15]=1,C}function _(C,M){var D=M[4],I=M[5],R=M[6],H=M[8],X=M[9],J=M[10];return C[0]=Math.hypot(M[0],M[1],M[2]),C[1]=Math.hypot(D,I,R),C[2]=Math.hypot(H,X,J),C}function T(C,M,D,I,R){var H,X=1/Math.tan(M/2);return C[0]=X/D,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=X,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[11]=-1,C[12]=0,C[13]=0,C[15]=0,R!=null&&R!==1/0?(C[10]=(R+I)*(H=1/(I-R)),C[14]=2*R*I*H):(C[10]=-1,C[14]=-2*I),C}function E(C,M,D,I,R,H,X){var J=1/(M-D),ne=1/(I-R),re=1/(H-X);return C[0]=-2*J,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=-2*ne,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[10]=2*re,C[11]=0,C[12]=(M+D)*J,C[13]=(R+I)*ne,C[14]=(X+H)*re,C[15]=1,C}function O(C,M,D){return C[0]=M[0]-D[0],C[1]=M[1]-D[1],C[2]=M[2]-D[2],C[3]=M[3]-D[3],C[4]=M[4]-D[4],C[5]=M[5]-D[5],C[6]=M[6]-D[6],C[7]=M[7]-D[7],C[8]=M[8]-D[8],C[9]=M[9]-D[9],C[10]=M[10]-D[10],C[11]=M[11]-D[11],C[12]=M[12]-D[12],C[13]=M[13]-D[13],C[14]=M[14]-D[14],C[15]=M[15]-D[15],C}return ae.perspective=T,ae.ortho=E,ae.mul=y,ae.sub=O,ae}var Pe,we={},xe={};function Ne(){if(Pe)return xe;function m(R){return m=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(H){return typeof H}:function(H){return H&&typeof Symbol=="function"&&H.constructor===Symbol&&H!==Symbol.prototype?"symbol":typeof H},m(R)}Pe=1,Object.defineProperty(xe,"__esModule",{value:!0}),xe.create=f,xe.clone=function(R){var H=new o.ARRAY_TYPE(3);return H[0]=R[0],H[1]=R[1],H[2]=R[2],H},xe.length=y,xe.fromValues=function(R,H,X){var J=new o.ARRAY_TYPE(3);return J[0]=R,J[1]=H,J[2]=X,J},xe.copy=function(R,H){return R[0]=H[0],R[1]=H[1],R[2]=H[2],R},xe.set=function(R,H,X,J){return R[0]=H,R[1]=X,R[2]=J,R},xe.add=function(R,H,X){return R[0]=H[0]+X[0],R[1]=H[1]+X[1],R[2]=H[2]+X[2],R},xe.subtract=g,xe.multiply=_,xe.divide=T,xe.ceil=function(R,H){return R[0]=Math.ceil(H[0]),R[1]=Math.ceil(H[1]),R[2]=Math.ceil(H[2]),R},xe.floor=function(R,H){return R[0]=Math.floor(H[0]),R[1]=Math.floor(H[1]),R[2]=Math.floor(H[2]),R},xe.min=function(R,H,X){return R[0]=Math.min(H[0],X[0]),R[1]=Math.min(H[1],X[1]),R[2]=Math.min(H[2],X[2]),R},xe.max=function(R,H,X){return R[0]=Math.max(H[0],X[0]),R[1]=Math.max(H[1],X[1]),R[2]=Math.max(H[2],X[2]),R},xe.round=function(R,H){return R[0]=Math.round(H[0]),R[1]=Math.round(H[1]),R[2]=Math.round(H[2]),R},xe.scale=function(R,H,X){return R[0]=H[0]*X,R[1]=H[1]*X,R[2]=H[2]*X,R},xe.scaleAndAdd=function(R,H,X,J){return R[0]=H[0]+X[0]*J,R[1]=H[1]+X[1]*J,R[2]=H[2]+X[2]*J,R},xe.distance=E,xe.squaredDistance=O,xe.squaredLength=C,xe.negate=function(R,H){return R[0]=-H[0],R[1]=-H[1],R[2]=-H[2],R},xe.inverse=function(R,H){return R[0]=1/H[0],R[1]=1/H[1],R[2]=1/H[2],R},xe.normalize=function(R,H){var X=H[0],J=H[1],ne=H[2],re=X*X+J*J+ne*ne;return re>0&&(re=1/Math.sqrt(re)),R[0]=H[0]*re,R[1]=H[1]*re,R[2]=H[2]*re,R},xe.dot=M,xe.cross=function(R,H,X){var J=H[0],ne=H[1],re=H[2],te=X[0],oe=X[1],ue=X[2];return R[0]=ne*ue-re*oe,R[1]=re*te-J*ue,R[2]=J*oe-ne*te,R},xe.lerp=function(R,H,X,J){var ne=H[0],re=H[1],te=H[2];return R[0]=ne+J*(X[0]-ne),R[1]=re+J*(X[1]-re),R[2]=te+J*(X[2]-te),R},xe.hermite=function(R,H,X,J,ne,re){var te=re*re,oe=te*(2*re-3)+1,ue=te*(re-2)+re,me=te*(re-1),Me=te*(3-2*re);return R[0]=H[0]*oe+X[0]*ue+J[0]*me+ne[0]*Me,R[1]=H[1]*oe+X[1]*ue+J[1]*me+ne[1]*Me,R[2]=H[2]*oe+X[2]*ue+J[2]*me+ne[2]*Me,R},xe.bezier=function(R,H,X,J,ne,re){var te=1-re,oe=te*te,ue=re*re,me=oe*te,Me=3*re*oe,Se=3*ue*te,Ae=ue*re;return R[0]=H[0]*me+X[0]*Me+J[0]*Se+ne[0]*Ae,R[1]=H[1]*me+X[1]*Me+J[1]*Se+ne[1]*Ae,R[2]=H[2]*me+X[2]*Me+J[2]*Se+ne[2]*Ae,R},xe.random=function(R,H){H=H||1;var X=2*o.RANDOM()*Math.PI,J=2*o.RANDOM()-1,ne=Math.sqrt(1-J*J)*H;return R[0]=Math.cos(X)*ne,R[1]=Math.sin(X)*ne,R[2]=J*H,R},xe.transformMat4=function(R,H,X){var J=H[0],ne=H[1],re=H[2],te=X[3]*J+X[7]*ne+X[11]*re+X[15];return R[0]=(X[0]*J+X[4]*ne+X[8]*re+X[12])/(te=te||1),R[1]=(X[1]*J+X[5]*ne+X[9]*re+X[13])/te,R[2]=(X[2]*J+X[6]*ne+X[10]*re+X[14])/te,R},xe.transformMat3=function(R,H,X){var J=H[0],ne=H[1],re=H[2];return R[0]=J*X[0]+ne*X[3]+re*X[6],R[1]=J*X[1]+ne*X[4]+re*X[7],R[2]=J*X[2]+ne*X[5]+re*X[8],R},xe.transformQuat=function(R,H,X){var J=X[0],ne=X[1],re=X[2],te=H[0],oe=H[1],ue=H[2],me=ne*ue-re*oe,Me=re*te-J*ue,Se=J*oe-ne*te,Ae=ne*Se-re*Me,Ve=re*me-J*Se,Ie=J*Me-ne*me,Ge=2*X[3];return Me*=Ge,Se*=Ge,Ve*=2,Ie*=2,R[0]=te+(me*=Ge)+(Ae*=2),R[1]=oe+Me+Ve,R[2]=ue+Se+Ie,R},xe.rotateX=function(R,H,X,J){var ne=[],re=[];return ne[0]=H[0]-X[0],ne[1]=H[1]-X[1],ne[2]=H[2]-X[2],re[0]=ne[0],re[1]=ne[1]*Math.cos(J)-ne[2]*Math.sin(J),re[2]=ne[1]*Math.sin(J)+ne[2]*Math.cos(J),R[0]=re[0]+X[0],R[1]=re[1]+X[1],R[2]=re[2]+X[2],R},xe.rotateY=function(R,H,X,J){var ne=[],re=[];return ne[0]=H[0]-X[0],ne[1]=H[1]-X[1],ne[2]=H[2]-X[2],re[0]=ne[2]*Math.sin(J)+ne[0]*Math.cos(J),re[1]=ne[1],re[2]=ne[2]*Math.cos(J)-ne[0]*Math.sin(J),R[0]=re[0]+X[0],R[1]=re[1]+X[1],R[2]=re[2]+X[2],R},xe.rotateZ=function(R,H,X,J){var ne=[],re=[];return ne[0]=H[0]-X[0],ne[1]=H[1]-X[1],ne[2]=H[2]-X[2],re[0]=ne[0]*Math.cos(J)-ne[1]*Math.sin(J),re[1]=ne[0]*Math.sin(J)+ne[1]*Math.cos(J),re[2]=ne[2],R[0]=re[0]+X[0],R[1]=re[1]+X[1],R[2]=re[2]+X[2],R},xe.angle=function(R,H){var X=R[0],J=R[1],ne=R[2],re=H[0],te=H[1],oe=H[2],ue=Math.sqrt(X*X+J*J+ne*ne)*Math.sqrt(re*re+te*te+oe*oe),me=ue&&M(R,H)/ue;return Math.acos(Math.min(Math.max(me,-1),1))},xe.zero=function(R){return R[0]=0,R[1]=0,R[2]=0,R},xe.str=function(R){return"vec3("+R[0]+", "+R[1]+", "+R[2]+")"},xe.exactEquals=function(R,H){return R[0]===H[0]&&R[1]===H[1]&&R[2]===H[2]},xe.equals=function(R,H){var X=R[0],J=R[1],ne=R[2],re=H[0],te=H[1],oe=H[2];return Math.abs(X-re)<=o.EPSILON*Math.max(1,Math.abs(X),Math.abs(re))&&Math.abs(J-te)<=o.EPSILON*Math.max(1,Math.abs(J),Math.abs(te))&&Math.abs(ne-oe)<=o.EPSILON*Math.max(1,Math.abs(ne),Math.abs(oe))},xe.forEach=xe.sqrLen=xe.len=xe.sqrDist=xe.dist=xe.div=xe.mul=xe.sub=void 0;var o=function(R,H){if(R&&R.__esModule)return R;if(R===null||m(R)!=="object"&&typeof R!="function")return{default:R};var X=u(void 0);if(X&&X.has(R))return X.get(R);var J={},ne=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var re in R)if(re!=="default"&&Object.prototype.hasOwnProperty.call(R,re)){var te=ne?Object.getOwnPropertyDescriptor(R,re):null;te&&(te.get||te.set)?Object.defineProperty(J,re,te):J[re]=R[re]}return J.default=R,X&&X.set(R,J),J}(S());function u(R){if(typeof WeakMap!="function")return null;var H=new WeakMap,X=new WeakMap;return(u=function(J){return J?X:H})(R)}function f(){var R=new o.ARRAY_TYPE(3);return o.ARRAY_TYPE!=Float32Array&&(R[0]=0,R[1]=0,R[2]=0),R}function y(R){return Math.hypot(R[0],R[1],R[2])}function g(R,H,X){return R[0]=H[0]-X[0],R[1]=H[1]-X[1],R[2]=H[2]-X[2],R}function _(R,H,X){return R[0]=H[0]*X[0],R[1]=H[1]*X[1],R[2]=H[2]*X[2],R}function T(R,H,X){return R[0]=H[0]/X[0],R[1]=H[1]/X[1],R[2]=H[2]/X[2],R}function E(R,H){return Math.hypot(H[0]-R[0],H[1]-R[1],H[2]-R[2])}function O(R,H){var X=H[0]-R[0],J=H[1]-R[1],ne=H[2]-R[2];return X*X+J*J+ne*ne}function C(R){var H=R[0],X=R[1],J=R[2];return H*H+X*X+J*J}function M(R,H){return R[0]*H[0]+R[1]*H[1]+R[2]*H[2]}xe.sub=g,xe.mul=_,xe.div=T,xe.dist=E,xe.sqrDist=O,xe.len=y,xe.sqrLen=C;var D,I=(D=f(),function(R,H,X,J,ne,re){var te,oe;for(H||(H=3),X||(X=0),oe=J?Math.min(J*H+X,R.length):R.length,te=X;te<oe;te+=H)D[0]=R[te],D[1]=R[te+1],D[2]=R[te+2],ne(D,D,re),R[te]=D[0],R[te+1]=D[1],R[te+2]=D[2];return R});return xe.forEach=I,xe}var ze,ye,ve={};function _e(){if(ze)return ve;function m(I){return m=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(R){return typeof R}:function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R},m(I)}ze=1,Object.defineProperty(ve,"__esModule",{value:!0}),ve.create=f,ve.clone=function(I){var R=new o.ARRAY_TYPE(4);return R[0]=I[0],R[1]=I[1],R[2]=I[2],R[3]=I[3],R},ve.fromValues=function(I,R,H,X){var J=new o.ARRAY_TYPE(4);return J[0]=I,J[1]=R,J[2]=H,J[3]=X,J},ve.copy=function(I,R){return I[0]=R[0],I[1]=R[1],I[2]=R[2],I[3]=R[3],I},ve.set=function(I,R,H,X,J){return I[0]=R,I[1]=H,I[2]=X,I[3]=J,I},ve.add=function(I,R,H){return I[0]=R[0]+H[0],I[1]=R[1]+H[1],I[2]=R[2]+H[2],I[3]=R[3]+H[3],I},ve.subtract=y,ve.multiply=g,ve.divide=_,ve.ceil=function(I,R){return I[0]=Math.ceil(R[0]),I[1]=Math.ceil(R[1]),I[2]=Math.ceil(R[2]),I[3]=Math.ceil(R[3]),I},ve.floor=function(I,R){return I[0]=Math.floor(R[0]),I[1]=Math.floor(R[1]),I[2]=Math.floor(R[2]),I[3]=Math.floor(R[3]),I},ve.min=function(I,R,H){return I[0]=Math.min(R[0],H[0]),I[1]=Math.min(R[1],H[1]),I[2]=Math.min(R[2],H[2]),I[3]=Math.min(R[3],H[3]),I},ve.max=function(I,R,H){return I[0]=Math.max(R[0],H[0]),I[1]=Math.max(R[1],H[1]),I[2]=Math.max(R[2],H[2]),I[3]=Math.max(R[3],H[3]),I},ve.round=function(I,R){return I[0]=Math.round(R[0]),I[1]=Math.round(R[1]),I[2]=Math.round(R[2]),I[3]=Math.round(R[3]),I},ve.scale=function(I,R,H){return I[0]=R[0]*H,I[1]=R[1]*H,I[2]=R[2]*H,I[3]=R[3]*H,I},ve.scaleAndAdd=function(I,R,H,X){return I[0]=R[0]+H[0]*X,I[1]=R[1]+H[1]*X,I[2]=R[2]+H[2]*X,I[3]=R[3]+H[3]*X,I},ve.distance=T,ve.squaredDistance=E,ve.length=O,ve.squaredLength=C,ve.negate=function(I,R){return I[0]=-R[0],I[1]=-R[1],I[2]=-R[2],I[3]=-R[3],I},ve.inverse=function(I,R){return I[0]=1/R[0],I[1]=1/R[1],I[2]=1/R[2],I[3]=1/R[3],I},ve.normalize=function(I,R){var H=R[0],X=R[1],J=R[2],ne=R[3],re=H*H+X*X+J*J+ne*ne;return re>0&&(re=1/Math.sqrt(re)),I[0]=H*re,I[1]=X*re,I[2]=J*re,I[3]=ne*re,I},ve.dot=function(I,R){return I[0]*R[0]+I[1]*R[1]+I[2]*R[2]+I[3]*R[3]},ve.cross=function(I,R,H,X){var J=H[0]*X[1]-H[1]*X[0],ne=H[0]*X[2]-H[2]*X[0],re=H[0]*X[3]-H[3]*X[0],te=H[1]*X[2]-H[2]*X[1],oe=H[1]*X[3]-H[3]*X[1],ue=H[2]*X[3]-H[3]*X[2],me=R[0],Me=R[1],Se=R[2],Ae=R[3];return I[0]=Me*ue-Se*oe+Ae*te,I[1]=-me*ue+Se*re-Ae*ne,I[2]=me*oe-Me*re+Ae*J,I[3]=-me*te+Me*ne-Se*J,I},ve.lerp=function(I,R,H,X){var J=R[0],ne=R[1],re=R[2],te=R[3];return I[0]=J+X*(H[0]-J),I[1]=ne+X*(H[1]-ne),I[2]=re+X*(H[2]-re),I[3]=te+X*(H[3]-te),I},ve.random=function(I,R){var H,X,J,ne,re,te;R=R||1;do re=(H=2*o.RANDOM()-1)*H+(X=2*o.RANDOM()-1)*X;while(re>=1);do te=(J=2*o.RANDOM()-1)*J+(ne=2*o.RANDOM()-1)*ne;while(te>=1);var oe=Math.sqrt((1-re)/te);return I[0]=R*H,I[1]=R*X,I[2]=R*J*oe,I[3]=R*ne*oe,I},ve.transformMat4=function(I,R,H){var X=R[0],J=R[1],ne=R[2],re=R[3];return I[0]=H[0]*X+H[4]*J+H[8]*ne+H[12]*re,I[1]=H[1]*X+H[5]*J+H[9]*ne+H[13]*re,I[2]=H[2]*X+H[6]*J+H[10]*ne+H[14]*re,I[3]=H[3]*X+H[7]*J+H[11]*ne+H[15]*re,I},ve.transformQuat=function(I,R,H){var X=R[0],J=R[1],ne=R[2],re=H[0],te=H[1],oe=H[2],ue=H[3],me=ue*X+te*ne-oe*J,Me=ue*J+oe*X-re*ne,Se=ue*ne+re*J-te*X,Ae=-re*X-te*J-oe*ne;return I[0]=me*ue+Ae*-re+Me*-oe-Se*-te,I[1]=Me*ue+Ae*-te+Se*-re-me*-oe,I[2]=Se*ue+Ae*-oe+me*-te-Me*-re,I[3]=R[3],I},ve.zero=function(I){return I[0]=0,I[1]=0,I[2]=0,I[3]=0,I},ve.str=function(I){return"vec4("+I[0]+", "+I[1]+", "+I[2]+", "+I[3]+")"},ve.exactEquals=function(I,R){return I[0]===R[0]&&I[1]===R[1]&&I[2]===R[2]&&I[3]===R[3]},ve.equals=function(I,R){var H=I[0],X=I[1],J=I[2],ne=I[3],re=R[0],te=R[1],oe=R[2],ue=R[3];return Math.abs(H-re)<=o.EPSILON*Math.max(1,Math.abs(H),Math.abs(re))&&Math.abs(X-te)<=o.EPSILON*Math.max(1,Math.abs(X),Math.abs(te))&&Math.abs(J-oe)<=o.EPSILON*Math.max(1,Math.abs(J),Math.abs(oe))&&Math.abs(ne-ue)<=o.EPSILON*Math.max(1,Math.abs(ne),Math.abs(ue))},ve.forEach=ve.sqrLen=ve.len=ve.sqrDist=ve.dist=ve.div=ve.mul=ve.sub=void 0;var o=function(I,R){if(I&&I.__esModule)return I;if(I===null||m(I)!=="object"&&typeof I!="function")return{default:I};var H=u(void 0);if(H&&H.has(I))return H.get(I);var X={},J=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ne in I)if(ne!=="default"&&Object.prototype.hasOwnProperty.call(I,ne)){var re=J?Object.getOwnPropertyDescriptor(I,ne):null;re&&(re.get||re.set)?Object.defineProperty(X,ne,re):X[ne]=I[ne]}return X.default=I,H&&H.set(I,X),X}(S());function u(I){if(typeof WeakMap!="function")return null;var R=new WeakMap,H=new WeakMap;return(u=function(X){return X?H:R})(I)}function f(){var I=new o.ARRAY_TYPE(4);return o.ARRAY_TYPE!=Float32Array&&(I[0]=0,I[1]=0,I[2]=0,I[3]=0),I}function y(I,R,H){return I[0]=R[0]-H[0],I[1]=R[1]-H[1],I[2]=R[2]-H[2],I[3]=R[3]-H[3],I}function g(I,R,H){return I[0]=R[0]*H[0],I[1]=R[1]*H[1],I[2]=R[2]*H[2],I[3]=R[3]*H[3],I}function _(I,R,H){return I[0]=R[0]/H[0],I[1]=R[1]/H[1],I[2]=R[2]/H[2],I[3]=R[3]/H[3],I}function T(I,R){return Math.hypot(R[0]-I[0],R[1]-I[1],R[2]-I[2],R[3]-I[3])}function E(I,R){var H=R[0]-I[0],X=R[1]-I[1],J=R[2]-I[2],ne=R[3]-I[3];return H*H+X*X+J*J+ne*ne}function O(I){return Math.hypot(I[0],I[1],I[2],I[3])}function C(I){var R=I[0],H=I[1],X=I[2],J=I[3];return R*R+H*H+X*X+J*J}ve.sub=y,ve.mul=g,ve.div=_,ve.dist=T,ve.sqrDist=E,ve.len=O,ve.sqrLen=C;var M,D=(M=f(),function(I,R,H,X,J,ne){var re,te;for(R||(R=4),H||(H=0),te=X?Math.min(X*R+H,I.length):I.length,re=H;re<te;re+=R)M[0]=I[re],M[1]=I[re+1],M[2]=I[re+2],M[3]=I[re+3],J(M,M,ne),I[re]=M[0],I[re+1]=M[1],I[re+2]=M[2],I[re+3]=M[3];return I});return ve.forEach=D,ve}function Ee(){if(ye)return we;function m(Ie){return m=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Ge){return typeof Ge}:function(Ge){return Ge&&typeof Symbol=="function"&&Ge.constructor===Symbol&&Ge!==Symbol.prototype?"symbol":typeof Ge},m(Ie)}ye=1,Object.defineProperty(we,"__esModule",{value:!0}),we.create=T,we.identity=function(Ie){return Ie[0]=0,Ie[1]=0,Ie[2]=0,Ie[3]=1,Ie},we.setAxisAngle=E,we.getAxisAngle=function(Ie,Ge){var Ze=2*Math.acos(Ge[3]),We=Math.sin(Ze/2);return We>o.EPSILON?(Ie[0]=Ge[0]/We,Ie[1]=Ge[1]/We,Ie[2]=Ge[2]/We):(Ie[0]=1,Ie[1]=0,Ie[2]=0),Ze},we.getAngle=function(Ie,Ge){var Ze=H(Ie,Ge);return Math.acos(2*Ze*Ze-1)},we.multiply=O,we.rotateX=function(Ie,Ge,Ze){Ze*=.5;var We=Ge[0],Qe=Ge[1],Je=Ge[2],ot=Ge[3],nt=Math.sin(Ze),ct=Math.cos(Ze);return Ie[0]=We*ct+ot*nt,Ie[1]=Qe*ct+Je*nt,Ie[2]=Je*ct-Qe*nt,Ie[3]=ot*ct-We*nt,Ie},we.rotateY=function(Ie,Ge,Ze){Ze*=.5;var We=Ge[0],Qe=Ge[1],Je=Ge[2],ot=Ge[3],nt=Math.sin(Ze),ct=Math.cos(Ze);return Ie[0]=We*ct-Je*nt,Ie[1]=Qe*ct+ot*nt,Ie[2]=Je*ct+We*nt,Ie[3]=ot*ct-Qe*nt,Ie},we.rotateZ=function(Ie,Ge,Ze){Ze*=.5;var We=Ge[0],Qe=Ge[1],Je=Ge[2],ot=Ge[3],nt=Math.sin(Ze),ct=Math.cos(Ze);return Ie[0]=We*ct+Qe*nt,Ie[1]=Qe*ct-We*nt,Ie[2]=Je*ct+ot*nt,Ie[3]=ot*ct-Je*nt,Ie},we.calculateW=function(Ie,Ge){var Ze=Ge[0],We=Ge[1],Qe=Ge[2];return Ie[0]=Ze,Ie[1]=We,Ie[2]=Qe,Ie[3]=Math.sqrt(Math.abs(1-Ze*Ze-We*We-Qe*Qe)),Ie},we.exp=C,we.ln=M,we.pow=function(Ie,Ge,Ze){return M(Ie,Ge),R(Ie,Ie,Ze),C(Ie,Ie),Ie},we.slerp=D,we.random=function(Ie){var Ge=o.RANDOM(),Ze=o.RANDOM(),We=o.RANDOM(),Qe=Math.sqrt(1-Ge),Je=Math.sqrt(Ge);return Ie[0]=Qe*Math.sin(2*Math.PI*Ze),Ie[1]=Qe*Math.cos(2*Math.PI*Ze),Ie[2]=Je*Math.sin(2*Math.PI*We),Ie[3]=Je*Math.cos(2*Math.PI*We),Ie},we.invert=function(Ie,Ge){var Ze=Ge[0],We=Ge[1],Qe=Ge[2],Je=Ge[3],ot=Ze*Ze+We*We+Qe*Qe+Je*Je,nt=ot?1/ot:0;return Ie[0]=-Ze*nt,Ie[1]=-We*nt,Ie[2]=-Qe*nt,Ie[3]=Je*nt,Ie},we.conjugate=function(Ie,Ge){return Ie[0]=-Ge[0],Ie[1]=-Ge[1],Ie[2]=-Ge[2],Ie[3]=Ge[3],Ie},we.fromMat3=I,we.fromEuler=function(Ie,Ge,Ze,We){var Qe=.5*Math.PI/180;Ge*=Qe,Ze*=Qe,We*=Qe;var Je=Math.sin(Ge),ot=Math.cos(Ge),nt=Math.sin(Ze),ct=Math.cos(Ze),Ot=Math.sin(We),Mt=Math.cos(We);return Ie[0]=Je*ct*Mt-ot*nt*Ot,Ie[1]=ot*nt*Mt+Je*ct*Ot,Ie[2]=ot*ct*Ot-Je*nt*Mt,Ie[3]=ot*ct*Mt+Je*nt*Ot,Ie},we.str=function(Ie){return"quat("+Ie[0]+", "+Ie[1]+", "+Ie[2]+", "+Ie[3]+")"},we.setAxes=we.sqlerp=we.rotationTo=we.equals=we.exactEquals=we.normalize=we.sqrLen=we.squaredLength=we.len=we.length=we.lerp=we.dot=we.scale=we.mul=we.add=we.set=we.copy=we.fromValues=we.clone=void 0;var o=_(S()),u=_(Z()),f=_(Ne()),y=_(_e());function g(Ie){if(typeof WeakMap!="function")return null;var Ge=new WeakMap,Ze=new WeakMap;return(g=function(We){return We?Ze:Ge})(Ie)}function _(Ie,Ge){if(Ie&&Ie.__esModule)return Ie;if(Ie===null||m(Ie)!=="object"&&typeof Ie!="function")return{default:Ie};var Ze=g(Ge);if(Ze&&Ze.has(Ie))return Ze.get(Ie);var We={},Qe=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var Je in Ie)if(Je!=="default"&&Object.prototype.hasOwnProperty.call(Ie,Je)){var ot=Qe?Object.getOwnPropertyDescriptor(Ie,Je):null;ot&&(ot.get||ot.set)?Object.defineProperty(We,Je,ot):We[Je]=Ie[Je]}return We.default=Ie,Ze&&Ze.set(Ie,We),We}function T(){var Ie=new o.ARRAY_TYPE(4);return o.ARRAY_TYPE!=Float32Array&&(Ie[0]=0,Ie[1]=0,Ie[2]=0),Ie[3]=1,Ie}function E(Ie,Ge,Ze){Ze*=.5;var We=Math.sin(Ze);return Ie[0]=We*Ge[0],Ie[1]=We*Ge[1],Ie[2]=We*Ge[2],Ie[3]=Math.cos(Ze),Ie}function O(Ie,Ge,Ze){var We=Ge[0],Qe=Ge[1],Je=Ge[2],ot=Ge[3],nt=Ze[0],ct=Ze[1],Ot=Ze[2],Mt=Ze[3];return Ie[0]=We*Mt+ot*nt+Qe*Ot-Je*ct,Ie[1]=Qe*Mt+ot*ct+Je*nt-We*Ot,Ie[2]=Je*Mt+ot*Ot+We*ct-Qe*nt,Ie[3]=ot*Mt-We*nt-Qe*ct-Je*Ot,Ie}function C(Ie,Ge){var Ze=Ge[0],We=Ge[1],Qe=Ge[2],Je=Ge[3],ot=Math.sqrt(Ze*Ze+We*We+Qe*Qe),nt=Math.exp(Je),ct=ot>0?nt*Math.sin(ot)/ot:0;return Ie[0]=Ze*ct,Ie[1]=We*ct,Ie[2]=Qe*ct,Ie[3]=nt*Math.cos(ot),Ie}function M(Ie,Ge){var Ze=Ge[0],We=Ge[1],Qe=Ge[2],Je=Ge[3],ot=Math.sqrt(Ze*Ze+We*We+Qe*Qe),nt=ot>0?Math.atan2(ot,Je)/ot:0;return Ie[0]=Ze*nt,Ie[1]=We*nt,Ie[2]=Qe*nt,Ie[3]=.5*Math.log(Ze*Ze+We*We+Qe*Qe+Je*Je),Ie}function D(Ie,Ge,Ze,We){var Qe,Je,ot,nt,ct,Ot=Ge[0],Mt=Ge[1],cr=Ge[2],Lt=Ge[3],Gt=Ze[0],Rt=Ze[1],Pr=Ze[2],ir=Ze[3];return(Je=Ot*Gt+Mt*Rt+cr*Pr+Lt*ir)<0&&(Je=-Je,Gt=-Gt,Rt=-Rt,Pr=-Pr,ir=-ir),1-Je>o.EPSILON?(Qe=Math.acos(Je),ot=Math.sin(Qe),nt=Math.sin((1-We)*Qe)/ot,ct=Math.sin(We*Qe)/ot):(nt=1-We,ct=We),Ie[0]=nt*Ot+ct*Gt,Ie[1]=nt*Mt+ct*Rt,Ie[2]=nt*cr+ct*Pr,Ie[3]=nt*Lt+ct*ir,Ie}function I(Ie,Ge){var Ze,We=Ge[0]+Ge[4]+Ge[8];if(We>0)Ze=Math.sqrt(We+1),Ie[3]=.5*Ze,Ie[0]=(Ge[5]-Ge[7])*(Ze=.5/Ze),Ie[1]=(Ge[6]-Ge[2])*Ze,Ie[2]=(Ge[1]-Ge[3])*Ze;else{var Qe=0;Ge[4]>Ge[0]&&(Qe=1),Ge[8]>Ge[3*Qe+Qe]&&(Qe=2);var Je=(Qe+1)%3,ot=(Qe+2)%3;Ze=Math.sqrt(Ge[3*Qe+Qe]-Ge[3*Je+Je]-Ge[3*ot+ot]+1),Ie[Qe]=.5*Ze,Ie[3]=(Ge[3*Je+ot]-Ge[3*ot+Je])*(Ze=.5/Ze),Ie[Je]=(Ge[3*Je+Qe]+Ge[3*Qe+Je])*Ze,Ie[ot]=(Ge[3*ot+Qe]+Ge[3*Qe+ot])*Ze}return Ie}we.clone=y.clone,we.fromValues=y.fromValues,we.copy=y.copy,we.set=y.set,we.add=y.add,we.mul=O;var R=y.scale;we.scale=R;var H=y.dot;we.dot=H,we.lerp=y.lerp;var X=y.length;we.length=X,we.len=X;var J=y.squaredLength;we.squaredLength=J,we.sqrLen=J;var ne=y.normalize;we.normalize=ne,we.exactEquals=y.exactEquals,we.equals=y.equals;var re,te,oe,ue=(re=f.create(),te=f.fromValues(1,0,0),oe=f.fromValues(0,1,0),function(Ie,Ge,Ze){var We=f.dot(Ge,Ze);return We<-.999999?(f.cross(re,te,Ge),f.len(re)<1e-6&&f.cross(re,oe,Ge),f.normalize(re,re),E(Ie,re,Math.PI),Ie):We>.999999?(Ie[0]=0,Ie[1]=0,Ie[2]=0,Ie[3]=1,Ie):(f.cross(re,Ge,Ze),Ie[0]=re[0],Ie[1]=re[1],Ie[2]=re[2],Ie[3]=1+We,ne(Ie,Ie))});we.rotationTo=ue;var me,Me,Se=(me=T(),Me=T(),function(Ie,Ge,Ze,We,Qe,Je){return D(me,Ge,Qe,Je),D(Me,Ze,We,Je),D(Ie,me,Me,2*Je*(1-Je)),Ie});we.sqlerp=Se;var Ae,Ve=(Ae=u.create(),function(Ie,Ge,Ze,We){return Ae[0]=Ze[0],Ae[3]=Ze[1],Ae[6]=Ze[2],Ae[1]=We[0],Ae[4]=We[1],Ae[7]=We[2],Ae[2]=-Ge[0],Ae[5]=-Ge[1],Ae[8]=-Ge[2],ne(Ie,I(Ie,Ae))});return we.setAxes=Ve,we}var je,Ce={};function tt(){if(je)return Ce;function m(D){return m=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(I){return typeof I}:function(I){return I&&typeof Symbol=="function"&&I.constructor===Symbol&&I!==Symbol.prototype?"symbol":typeof I},m(D)}je=1,Object.defineProperty(Ce,"__esModule",{value:!0}),Ce.create=function(){var D=new o.ARRAY_TYPE(8);return o.ARRAY_TYPE!=Float32Array&&(D[0]=0,D[1]=0,D[2]=0,D[4]=0,D[5]=0,D[6]=0,D[7]=0),D[3]=1,D},Ce.clone=function(D){var I=new o.ARRAY_TYPE(8);return I[0]=D[0],I[1]=D[1],I[2]=D[2],I[3]=D[3],I[4]=D[4],I[5]=D[5],I[6]=D[6],I[7]=D[7],I},Ce.fromValues=function(D,I,R,H,X,J,ne,re){var te=new o.ARRAY_TYPE(8);return te[0]=D,te[1]=I,te[2]=R,te[3]=H,te[4]=X,te[5]=J,te[6]=ne,te[7]=re,te},Ce.fromRotationTranslationValues=function(D,I,R,H,X,J,ne){var re=new o.ARRAY_TYPE(8);re[0]=D,re[1]=I,re[2]=R,re[3]=H;var te=.5*X,oe=.5*J,ue=.5*ne;return re[4]=te*H+oe*R-ue*I,re[5]=oe*H+ue*D-te*R,re[6]=ue*H+te*I-oe*D,re[7]=-te*D-oe*I-ue*R,re},Ce.fromRotationTranslation=_,Ce.fromTranslation=function(D,I){return D[0]=0,D[1]=0,D[2]=0,D[3]=1,D[4]=.5*I[0],D[5]=.5*I[1],D[6]=.5*I[2],D[7]=0,D},Ce.fromRotation=function(D,I){return D[0]=I[0],D[1]=I[1],D[2]=I[2],D[3]=I[3],D[4]=0,D[5]=0,D[6]=0,D[7]=0,D},Ce.fromMat4=function(D,I){var R=u.create();f.getRotation(R,I);var H=new o.ARRAY_TYPE(3);return f.getTranslation(H,I),_(D,R,H),D},Ce.copy=T,Ce.identity=function(D){return D[0]=0,D[1]=0,D[2]=0,D[3]=1,D[4]=0,D[5]=0,D[6]=0,D[7]=0,D},Ce.set=function(D,I,R,H,X,J,ne,re,te){return D[0]=I,D[1]=R,D[2]=H,D[3]=X,D[4]=J,D[5]=ne,D[6]=re,D[7]=te,D},Ce.getDual=function(D,I){return D[0]=I[4],D[1]=I[5],D[2]=I[6],D[3]=I[7],D},Ce.setDual=function(D,I){return D[4]=I[0],D[5]=I[1],D[6]=I[2],D[7]=I[3],D},Ce.getTranslation=function(D,I){var R=I[4],H=I[5],X=I[6],J=I[7],ne=-I[0],re=-I[1],te=-I[2],oe=I[3];return D[0]=2*(R*oe+J*ne+H*te-X*re),D[1]=2*(H*oe+J*re+X*ne-R*te),D[2]=2*(X*oe+J*te+R*re-H*ne),D},Ce.translate=function(D,I,R){var H=I[0],X=I[1],J=I[2],ne=I[3],re=.5*R[0],te=.5*R[1],oe=.5*R[2],ue=I[4],me=I[5],Me=I[6],Se=I[7];return D[0]=H,D[1]=X,D[2]=J,D[3]=ne,D[4]=ne*re+X*oe-J*te+ue,D[5]=ne*te+J*re-H*oe+me,D[6]=ne*oe+H*te-X*re+Me,D[7]=-H*re-X*te-J*oe+Se,D},Ce.rotateX=function(D,I,R){var H=-I[0],X=-I[1],J=-I[2],ne=I[3],re=I[4],te=I[5],oe=I[6],ue=I[7],me=re*ne+ue*H+te*J-oe*X,Me=te*ne+ue*X+oe*H-re*J,Se=oe*ne+ue*J+re*X-te*H,Ae=ue*ne-re*H-te*X-oe*J;return u.rotateX(D,I,R),D[4]=me*(ne=D[3])+Ae*(H=D[0])+Me*(J=D[2])-Se*(X=D[1]),D[5]=Me*ne+Ae*X+Se*H-me*J,D[6]=Se*ne+Ae*J+me*X-Me*H,D[7]=Ae*ne-me*H-Me*X-Se*J,D},Ce.rotateY=function(D,I,R){var H=-I[0],X=-I[1],J=-I[2],ne=I[3],re=I[4],te=I[5],oe=I[6],ue=I[7],me=re*ne+ue*H+te*J-oe*X,Me=te*ne+ue*X+oe*H-re*J,Se=oe*ne+ue*J+re*X-te*H,Ae=ue*ne-re*H-te*X-oe*J;return u.rotateY(D,I,R),D[4]=me*(ne=D[3])+Ae*(H=D[0])+Me*(J=D[2])-Se*(X=D[1]),D[5]=Me*ne+Ae*X+Se*H-me*J,D[6]=Se*ne+Ae*J+me*X-Me*H,D[7]=Ae*ne-me*H-Me*X-Se*J,D},Ce.rotateZ=function(D,I,R){var H=-I[0],X=-I[1],J=-I[2],ne=I[3],re=I[4],te=I[5],oe=I[6],ue=I[7],me=re*ne+ue*H+te*J-oe*X,Me=te*ne+ue*X+oe*H-re*J,Se=oe*ne+ue*J+re*X-te*H,Ae=ue*ne-re*H-te*X-oe*J;return u.rotateZ(D,I,R),D[4]=me*(ne=D[3])+Ae*(H=D[0])+Me*(J=D[2])-Se*(X=D[1]),D[5]=Me*ne+Ae*X+Se*H-me*J,D[6]=Se*ne+Ae*J+me*X-Me*H,D[7]=Ae*ne-me*H-Me*X-Se*J,D},Ce.rotateByQuatAppend=function(D,I,R){var H=R[0],X=R[1],J=R[2],ne=R[3],re=I[0],te=I[1],oe=I[2],ue=I[3];return D[0]=re*ne+ue*H+te*J-oe*X,D[1]=te*ne+ue*X+oe*H-re*J,D[2]=oe*ne+ue*J+re*X-te*H,D[3]=ue*ne-re*H-te*X-oe*J,D[4]=(re=I[4])*ne+(ue=I[7])*H+(te=I[5])*J-(oe=I[6])*X,D[5]=te*ne+ue*X+oe*H-re*J,D[6]=oe*ne+ue*J+re*X-te*H,D[7]=ue*ne-re*H-te*X-oe*J,D},Ce.rotateByQuatPrepend=function(D,I,R){var H=I[0],X=I[1],J=I[2],ne=I[3],re=R[0],te=R[1],oe=R[2],ue=R[3];return D[0]=H*ue+ne*re+X*oe-J*te,D[1]=X*ue+ne*te+J*re-H*oe,D[2]=J*ue+ne*oe+H*te-X*re,D[3]=ne*ue-H*re-X*te-J*oe,D[4]=H*(ue=R[7])+ne*(re=R[4])+X*(oe=R[6])-J*(te=R[5]),D[5]=X*ue+ne*te+J*re-H*oe,D[6]=J*ue+ne*oe+H*te-X*re,D[7]=ne*ue-H*re-X*te-J*oe,D},Ce.rotateAroundAxis=function(D,I,R,H){if(Math.abs(H)<o.EPSILON)return T(D,I);var X=Math.hypot(R[0],R[1],R[2]);H*=.5;var J=Math.sin(H),ne=J*R[0]/X,re=J*R[1]/X,te=J*R[2]/X,oe=Math.cos(H),ue=I[0],me=I[1],Me=I[2],Se=I[3];D[0]=ue*oe+Se*ne+me*te-Me*re,D[1]=me*oe+Se*re+Me*ne-ue*te,D[2]=Me*oe+Se*te+ue*re-me*ne,D[3]=Se*oe-ue*ne-me*re-Me*te;var Ae=I[4],Ve=I[5],Ie=I[6],Ge=I[7];return D[4]=Ae*oe+Ge*ne+Ve*te-Ie*re,D[5]=Ve*oe+Ge*re+Ie*ne-Ae*te,D[6]=Ie*oe+Ge*te+Ae*re-Ve*ne,D[7]=Ge*oe-Ae*ne-Ve*re-Ie*te,D},Ce.add=function(D,I,R){return D[0]=I[0]+R[0],D[1]=I[1]+R[1],D[2]=I[2]+R[2],D[3]=I[3]+R[3],D[4]=I[4]+R[4],D[5]=I[5]+R[5],D[6]=I[6]+R[6],D[7]=I[7]+R[7],D},Ce.multiply=E,Ce.scale=function(D,I,R){return D[0]=I[0]*R,D[1]=I[1]*R,D[2]=I[2]*R,D[3]=I[3]*R,D[4]=I[4]*R,D[5]=I[5]*R,D[6]=I[6]*R,D[7]=I[7]*R,D},Ce.lerp=function(D,I,R,H){var X=1-H;return O(I,R)<0&&(H=-H),D[0]=I[0]*X+R[0]*H,D[1]=I[1]*X+R[1]*H,D[2]=I[2]*X+R[2]*H,D[3]=I[3]*X+R[3]*H,D[4]=I[4]*X+R[4]*H,D[5]=I[5]*X+R[5]*H,D[6]=I[6]*X+R[6]*H,D[7]=I[7]*X+R[7]*H,D},Ce.invert=function(D,I){var R=M(I);return D[0]=-I[0]/R,D[1]=-I[1]/R,D[2]=-I[2]/R,D[3]=I[3]/R,D[4]=-I[4]/R,D[5]=-I[5]/R,D[6]=-I[6]/R,D[7]=I[7]/R,D},Ce.conjugate=function(D,I){return D[0]=-I[0],D[1]=-I[1],D[2]=-I[2],D[3]=I[3],D[4]=-I[4],D[5]=-I[5],D[6]=-I[6],D[7]=I[7],D},Ce.normalize=function(D,I){var R=M(I);if(R>0){R=Math.sqrt(R);var H=I[0]/R,X=I[1]/R,J=I[2]/R,ne=I[3]/R,re=I[4],te=I[5],oe=I[6],ue=I[7],me=H*re+X*te+J*oe+ne*ue;D[0]=H,D[1]=X,D[2]=J,D[3]=ne,D[4]=(re-H*me)/R,D[5]=(te-X*me)/R,D[6]=(oe-J*me)/R,D[7]=(ue-ne*me)/R}return D},Ce.str=function(D){return"quat2("+D[0]+", "+D[1]+", "+D[2]+", "+D[3]+", "+D[4]+", "+D[5]+", "+D[6]+", "+D[7]+")"},Ce.exactEquals=function(D,I){return D[0]===I[0]&&D[1]===I[1]&&D[2]===I[2]&&D[3]===I[3]&&D[4]===I[4]&&D[5]===I[5]&&D[6]===I[6]&&D[7]===I[7]},Ce.equals=function(D,I){var R=D[0],H=D[1],X=D[2],J=D[3],ne=D[4],re=D[5],te=D[6],oe=D[7],ue=I[0],me=I[1],Me=I[2],Se=I[3],Ae=I[4],Ve=I[5],Ie=I[6],Ge=I[7];return Math.abs(R-ue)<=o.EPSILON*Math.max(1,Math.abs(R),Math.abs(ue))&&Math.abs(H-me)<=o.EPSILON*Math.max(1,Math.abs(H),Math.abs(me))&&Math.abs(X-Me)<=o.EPSILON*Math.max(1,Math.abs(X),Math.abs(Me))&&Math.abs(J-Se)<=o.EPSILON*Math.max(1,Math.abs(J),Math.abs(Se))&&Math.abs(ne-Ae)<=o.EPSILON*Math.max(1,Math.abs(ne),Math.abs(Ae))&&Math.abs(re-Ve)<=o.EPSILON*Math.max(1,Math.abs(re),Math.abs(Ve))&&Math.abs(te-Ie)<=o.EPSILON*Math.max(1,Math.abs(te),Math.abs(Ie))&&Math.abs(oe-Ge)<=o.EPSILON*Math.max(1,Math.abs(oe),Math.abs(Ge))},Ce.sqrLen=Ce.squaredLength=Ce.len=Ce.length=Ce.dot=Ce.mul=Ce.setReal=Ce.getReal=void 0;var o=g(S()),u=g(Ee()),f=g(ce());function y(D){if(typeof WeakMap!="function")return null;var I=new WeakMap,R=new WeakMap;return(y=function(H){return H?R:I})(D)}function g(D,I){if(D&&D.__esModule)return D;if(D===null||m(D)!=="object"&&typeof D!="function")return{default:D};var R=y(I);if(R&&R.has(D))return R.get(D);var H={},X=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var J in D)if(J!=="default"&&Object.prototype.hasOwnProperty.call(D,J)){var ne=X?Object.getOwnPropertyDescriptor(D,J):null;ne&&(ne.get||ne.set)?Object.defineProperty(H,J,ne):H[J]=D[J]}return H.default=D,R&&R.set(D,H),H}function _(D,I,R){var H=.5*R[0],X=.5*R[1],J=.5*R[2],ne=I[0],re=I[1],te=I[2],oe=I[3];return D[0]=ne,D[1]=re,D[2]=te,D[3]=oe,D[4]=H*oe+X*te-J*re,D[5]=X*oe+J*ne-H*te,D[6]=J*oe+H*re-X*ne,D[7]=-H*ne-X*re-J*te,D}function T(D,I){return D[0]=I[0],D[1]=I[1],D[2]=I[2],D[3]=I[3],D[4]=I[4],D[5]=I[5],D[6]=I[6],D[7]=I[7],D}function E(D,I,R){var H=I[0],X=I[1],J=I[2],ne=I[3],re=R[4],te=R[5],oe=R[6],ue=R[7],me=I[4],Me=I[5],Se=I[6],Ae=I[7],Ve=R[0],Ie=R[1],Ge=R[2],Ze=R[3];return D[0]=H*Ze+ne*Ve+X*Ge-J*Ie,D[1]=X*Ze+ne*Ie+J*Ve-H*Ge,D[2]=J*Ze+ne*Ge+H*Ie-X*Ve,D[3]=ne*Ze-H*Ve-X*Ie-J*Ge,D[4]=H*ue+ne*re+X*oe-J*te+me*Ze+Ae*Ve+Me*Ge-Se*Ie,D[5]=X*ue+ne*te+J*re-H*oe+Me*Ze+Ae*Ie+Se*Ve-me*Ge,D[6]=J*ue+ne*oe+H*te-X*re+Se*Ze+Ae*Ge+me*Ie-Me*Ve,D[7]=ne*ue-H*re-X*te-J*oe+Ae*Ze-me*Ve-Me*Ie-Se*Ge,D}Ce.getReal=u.copy,Ce.setReal=u.copy,Ce.mul=E;var O=u.dot;Ce.dot=O;var C=u.length;Ce.length=C,Ce.len=C;var M=u.squaredLength;return Ce.squaredLength=M,Ce.sqrLen=M,Ce}var it,mt,gt={};function qt(){if(it)return gt;function m(I){return m=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(R){return typeof R}:function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R},m(I)}it=1,Object.defineProperty(gt,"__esModule",{value:!0}),gt.create=f,gt.clone=function(I){var R=new o.ARRAY_TYPE(2);return R[0]=I[0],R[1]=I[1],R},gt.fromValues=function(I,R){var H=new o.ARRAY_TYPE(2);return H[0]=I,H[1]=R,H},gt.copy=function(I,R){return I[0]=R[0],I[1]=R[1],I},gt.set=function(I,R,H){return I[0]=R,I[1]=H,I},gt.add=function(I,R,H){return I[0]=R[0]+H[0],I[1]=R[1]+H[1],I},gt.subtract=y,gt.multiply=g,gt.divide=_,gt.ceil=function(I,R){return I[0]=Math.ceil(R[0]),I[1]=Math.ceil(R[1]),I},gt.floor=function(I,R){return I[0]=Math.floor(R[0]),I[1]=Math.floor(R[1]),I},gt.min=function(I,R,H){return I[0]=Math.min(R[0],H[0]),I[1]=Math.min(R[1],H[1]),I},gt.max=function(I,R,H){return I[0]=Math.max(R[0],H[0]),I[1]=Math.max(R[1],H[1]),I},gt.round=function(I,R){return I[0]=Math.round(R[0]),I[1]=Math.round(R[1]),I},gt.scale=function(I,R,H){return I[0]=R[0]*H,I[1]=R[1]*H,I},gt.scaleAndAdd=function(I,R,H,X){return I[0]=R[0]+H[0]*X,I[1]=R[1]+H[1]*X,I},gt.distance=T,gt.squaredDistance=E,gt.length=O,gt.squaredLength=C,gt.negate=function(I,R){return I[0]=-R[0],I[1]=-R[1],I},gt.inverse=function(I,R){return I[0]=1/R[0],I[1]=1/R[1],I},gt.normalize=function(I,R){var H=R[0],X=R[1],J=H*H+X*X;return J>0&&(J=1/Math.sqrt(J)),I[0]=R[0]*J,I[1]=R[1]*J,I},gt.dot=function(I,R){return I[0]*R[0]+I[1]*R[1]},gt.cross=function(I,R,H){var X=R[0]*H[1]-R[1]*H[0];return I[0]=I[1]=0,I[2]=X,I},gt.lerp=function(I,R,H,X){var J=R[0],ne=R[1];return I[0]=J+X*(H[0]-J),I[1]=ne+X*(H[1]-ne),I},gt.random=function(I,R){R=R||1;var H=2*o.RANDOM()*Math.PI;return I[0]=Math.cos(H)*R,I[1]=Math.sin(H)*R,I},gt.transformMat2=function(I,R,H){var X=R[0],J=R[1];return I[0]=H[0]*X+H[2]*J,I[1]=H[1]*X+H[3]*J,I},gt.transformMat2d=function(I,R,H){var X=R[0],J=R[1];return I[0]=H[0]*X+H[2]*J+H[4],I[1]=H[1]*X+H[3]*J+H[5],I},gt.transformMat3=function(I,R,H){var X=R[0],J=R[1];return I[0]=H[0]*X+H[3]*J+H[6],I[1]=H[1]*X+H[4]*J+H[7],I},gt.transformMat4=function(I,R,H){var X=R[0],J=R[1];return I[0]=H[0]*X+H[4]*J+H[12],I[1]=H[1]*X+H[5]*J+H[13],I},gt.rotate=function(I,R,H,X){var J=R[0]-H[0],ne=R[1]-H[1],re=Math.sin(X),te=Math.cos(X);return I[0]=J*te-ne*re+H[0],I[1]=J*re+ne*te+H[1],I},gt.angle=function(I,R){var H=I[0],X=I[1],J=R[0],ne=R[1],re=Math.sqrt(H*H+X*X)*Math.sqrt(J*J+ne*ne);return Math.acos(Math.min(Math.max(re&&(H*J+X*ne)/re,-1),1))},gt.zero=function(I){return I[0]=0,I[1]=0,I},gt.str=function(I){return"vec2("+I[0]+", "+I[1]+")"},gt.exactEquals=function(I,R){return I[0]===R[0]&&I[1]===R[1]},gt.equals=function(I,R){var H=I[0],X=I[1],J=R[0],ne=R[1];return Math.abs(H-J)<=o.EPSILON*Math.max(1,Math.abs(H),Math.abs(J))&&Math.abs(X-ne)<=o.EPSILON*Math.max(1,Math.abs(X),Math.abs(ne))},gt.forEach=gt.sqrLen=gt.sqrDist=gt.dist=gt.div=gt.mul=gt.sub=gt.len=void 0;var o=function(I,R){if(I&&I.__esModule)return I;if(I===null||m(I)!=="object"&&typeof I!="function")return{default:I};var H=u(void 0);if(H&&H.has(I))return H.get(I);var X={},J=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ne in I)if(ne!=="default"&&Object.prototype.hasOwnProperty.call(I,ne)){var re=J?Object.getOwnPropertyDescriptor(I,ne):null;re&&(re.get||re.set)?Object.defineProperty(X,ne,re):X[ne]=I[ne]}return X.default=I,H&&H.set(I,X),X}(S());function u(I){if(typeof WeakMap!="function")return null;var R=new WeakMap,H=new WeakMap;return(u=function(X){return X?H:R})(I)}function f(){var I=new o.ARRAY_TYPE(2);return o.ARRAY_TYPE!=Float32Array&&(I[0]=0,I[1]=0),I}function y(I,R,H){return I[0]=R[0]-H[0],I[1]=R[1]-H[1],I}function g(I,R,H){return I[0]=R[0]*H[0],I[1]=R[1]*H[1],I}function _(I,R,H){return I[0]=R[0]/H[0],I[1]=R[1]/H[1],I}function T(I,R){return Math.hypot(R[0]-I[0],R[1]-I[1])}function E(I,R){var H=R[0]-I[0],X=R[1]-I[1];return H*H+X*X}function O(I){return Math.hypot(I[0],I[1])}function C(I){var R=I[0],H=I[1];return R*R+H*H}gt.len=O,gt.sub=y,gt.mul=g,gt.div=_,gt.dist=T,gt.sqrDist=E,gt.sqrLen=C;var M,D=(M=f(),function(I,R,H,X,J,ne){var re,te;for(R||(R=2),H||(H=0),te=X?Math.min(X*R+H,I.length):I.length,re=H;re<te;re+=R)M[0]=I[re],M[1]=I[re+1],J(M,M,ne),I[re]=M[0],I[re+1]=M[1];return I});return gt.forEach=D,gt}function yr(){if(mt)return w;function m(I){return m=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(R){return typeof R}:function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R},m(I)}mt=1,Object.defineProperty(w,"__esModule",{value:!0}),w.vec4=w.vec3=w.vec2=w.quat2=w.quat=w.mat4=w.mat3=w.mat2d=w.mat2=w.glMatrix=void 0;var o=D(S());w.glMatrix=o;var u=D(L());w.mat2=u;var f=D($());w.mat2d=f;var y=D(Z());w.mat3=y;var g=D(ce());w.mat4=g;var _=D(Ee());w.quat=_;var T=D(tt());w.quat2=T;var E=D(qt());w.vec2=E;var O=D(Ne());w.vec3=O;var C=D(_e());function M(I){if(typeof WeakMap!="function")return null;var R=new WeakMap,H=new WeakMap;return(M=function(X){return X?H:R})(I)}function D(I,R){if(I&&I.__esModule)return I;if(I===null||m(I)!=="object"&&typeof I!="function")return{default:I};var H=M(R);if(H&&H.has(I))return H.get(I);var X={},J=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ne in I)if(ne!=="default"&&Object.prototype.hasOwnProperty.call(I,ne)){var re=J?Object.getOwnPropertyDescriptor(I,ne):null;re&&(re.get||re.set)?Object.defineProperty(X,ne,re):X[ne]=I[ne]}return X.default=I,H&&H.set(I,X),X}return w.vec4=C,w}var tr,Ft,er,Dt,ge=yr(),sr=function(){if(Ft)return tr;function m(o,u,f,y){this.cx=3*o,this.bx=3*(f-o)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*u,this.by=3*(y-u)-this.cy,this.ay=1-this.cy-this.by,this.p1x=o,this.p1y=u,this.p2x=f,this.p2y=y}return Ft=1,tr=m,m.prototype={sampleCurveX:function(o){return((this.ax*o+this.bx)*o+this.cx)*o},sampleCurveY:function(o){return((this.ay*o+this.by)*o+this.cy)*o},sampleCurveDerivativeX:function(o){return(3*this.ax*o+2*this.bx)*o+this.cx},solveCurveX:function(o,u){if(u===void 0&&(u=1e-6),o<0)return 0;if(o>1)return 1;for(var f=o,y=0;y<8;y++){var g=this.sampleCurveX(f)-o;if(Math.abs(g)<u)return f;var _=this.sampleCurveDerivativeX(f);if(Math.abs(_)<1e-6)break;f-=g/_}var T=0,E=1;for(f=o,y=0;y<20&&(g=this.sampleCurveX(f),!(Math.abs(g-o)<u));y++)o>g?T=f:E=f,f=.5*(E-T)+T;return f},solve:function(o,u){return this.sampleCurveY(this.solveCurveX(o,u))}},tr}(),St=p(sr);function jr(){if(Dt)return er;function m(o,u){this.x=o,this.y=u}return Dt=1,er=m,m.prototype={clone:function(){return new m(this.x,this.y)},add:function(o){return this.clone()._add(o)},sub:function(o){return this.clone()._sub(o)},multByPoint:function(o){return this.clone()._multByPoint(o)},divByPoint:function(o){return this.clone()._divByPoint(o)},mult:function(o){return this.clone()._mult(o)},div:function(o){return this.clone()._div(o)},rotate:function(o){return this.clone()._rotate(o)},rotateAround:function(o,u){return this.clone()._rotateAround(o,u)},matMult:function(o){return this.clone()._matMult(o)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(o){return this.x===o.x&&this.y===o.y},dist:function(o){return Math.sqrt(this.distSqr(o))},distSqr:function(o){var u=o.x-this.x,f=o.y-this.y;return u*u+f*f},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(o){return Math.atan2(this.y-o.y,this.x-o.x)},angleWith:function(o){return this.angleWithSep(o.x,o.y)},angleWithSep:function(o,u){return Math.atan2(this.x*u-this.y*o,this.x*o+this.y*u)},_matMult:function(o){var u=o[2]*this.x+o[3]*this.y;return this.x=o[0]*this.x+o[1]*this.y,this.y=u,this},_add:function(o){return this.x+=o.x,this.y+=o.y,this},_sub:function(o){return this.x-=o.x,this.y-=o.y,this},_mult:function(o){return this.x*=o,this.y*=o,this},_div:function(o){return this.x/=o,this.y/=o,this},_multByPoint:function(o){return this.x*=o.x,this.y*=o.y,this},_divByPoint:function(o){return this.x/=o.x,this.y/=o.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var o=this.y;return this.y=this.x,this.x=-o,this},_rotate:function(o){var u=Math.cos(o),f=Math.sin(o),y=f*this.x+u*this.y;return this.x=u*this.x-f*this.y,this.y=y,this},_rotateAround:function(o,u){var f=Math.cos(o),y=Math.sin(o),g=u.y+y*(this.x-u.x)+f*(this.y-u.y);return this.x=u.x+f*(this.x-u.x)-y*(this.y-u.y),this.y=g,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},m.convert=function(o){return o instanceof m?o:Array.isArray(o)?new m(o[0],o[1]):o},er}var dt=p(jr());function Yr(m,o){if(Array.isArray(m)){if(!Array.isArray(o)||m.length!==o.length)return!1;for(let u=0;u<m.length;u++)if(!Yr(m[u],o[u]))return!1;return!0}if(typeof m=="object"&&m!==null&&o!==null){if(typeof o!="object"||Object.keys(m).length!==Object.keys(o).length)return!1;for(const u in m)if(!Yr(m[u],o[u]))return!1;return!0}return m===o}const Vr=Math.PI/180,Yn=180/Math.PI;function Ye(m){return m*Vr}function Nt(m){return m*Yn}const zt=[[0,0],[1,0],[1,1],[0,1]];function Nr(m){if(m<=0)return 0;if(m>=1)return 1;const o=m*m,u=o*m;return 4*(m<.5?u:3*(m-o)+u-.75)}function br(m,o,u,f){const y=new St(m,o,u,f);return function(g){return y.solve(g)}}const hr=br(.25,.1,.25,1);function rr(m,o,u){return Math.min(u,Math.max(o,m))}function an(m,o,u){return(u=rr((u-m)/(o-m),0,1))*u*(3-2*u)}function ai(m,o,u){const f=u-o,y=((m-o)%f+f)%f+o;return y===o?u:y}function ri(m,o,u){if(!m.length)return u(null,[]);let f=m.length;const y=new Array(m.length);let g=null;m.forEach((_,T)=>{o(_,(E,O)=>{E&&(g=E),y[T]=O,--f==0&&u(g,y)})})}function Ui(m,...o){for(const u of o)for(const f in u)m[f]=u[f];return m}let oa=1;function Xs(){return oa++}function rl(m){return m<=1?1:Math.pow(2,Math.ceil(Math.log(m)/Math.LN2))}function Il(m,o){m.forEach(u=>{o[u]&&(o[u]=o[u].bind(o))})}function xo(m,o,u){const f={};for(const y in m)f[y]=o.call(this,m[y],y,m);return f}function nl(m,o,u){const f={};for(const y in m)o.call(this,m[y],y,m)&&(f[y]=m[y]);return f}function Vs(m){return Array.isArray(m)?m.map(Vs):typeof m=="object"&&m?xo(m,Vs):m}const Ua={};function _i(m){Ua[m]||(typeof console<"u"&&console.warn(m),Ua[m]=!0)}function Ir(m,o,u){return(u.y-m.y)*(o.x-m.x)>(o.y-m.y)*(u.x-m.x)}function wi(m){let o=0;for(let u,f,y=0,g=m.length,_=g-1;y<g;_=y++)u=m[y],f=m[_],o+=(f.x-u.x)*(u.y+f.y);return o}function gi([m,o,u]){const f=Ye(o+90),y=Ye(u);return{x:m*Math.cos(f)*Math.sin(y),y:m*Math.sin(f)*Math.sin(y),z:m*Math.cos(y),azimuthal:o,polar:u}}function Ji(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function la(m){const o={};if(m.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(u,f,y,g)=>{const _=y||g;return o[f]=!_||_.toLowerCase(),""}),o["max-age"]){const u=parseInt(o["max-age"],10);isNaN(u)?delete o["max-age"]:o["max-age"]=u}return o}let Ol=null;function Kc(m,o){return[m[4*o],m[4*o+1],m[4*o+2],m[4*o+3]]}function Ih(m,o,u,f){for(;o<u;){const y=o+u>>1;m[y]<f?o=y+1:u=y}return o}function Hm(m,o,u,f){for(;o<u;){const y=o+u>>1;m[y]<=f?o=y+1:u=y}return o}function Oh(m){return m>0?1/(1.001-m):1+m}function bt(m){return m>0?1-1/(1.001-m):-m}const pe={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!pe.API_URL)return null;try{const m=new URL(pe.API_URL);return m.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":m.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",RASTERARRAYS_URL_PREFIX:"rasterarrays/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",MESHOPT_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_base_v0.20.wasm",MESHOPT_SIMD_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_simd_v0.20.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf",TILES3D_URL_PREFIX:"3dtiles/v1"};function be(m){return pe.API_URL_REGEX.test(m)}function De(m){return pe.API_SPRITE_REGEX.test(m)}let qe,Ue,Xe,ht,et,xt;function wt(){return qe==null&&(qe=self.OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap=="function"),qe}const vt={now:()=>ht!==void 0?ht:performance.now(),setNow(m){ht=m},restoreNow(){ht=void 0},frame(m){const o=requestAnimationFrame(m);return{cancel:()=>cancelAnimationFrame(o)}},getImageData(m,o=0){const{width:u,height:f}=m;et||(et=document.createElement("canvas"));const y=et.getContext("2d",{willReadFrequently:!0});if(!y)throw new Error("failed to create canvas 2d context");return(u>et.width||f>et.height)&&(et.width=u,et.height=f),y.clearRect(-o,-o,u+2*o,f+2*o),y.drawImage(m,0,0,u,f),y.getImageData(-o,-o,u+2*o,f+2*o)},resolveURL:m=>(Ue||(Ue=document.createElement("a")),Ue.href=m,Ue.href),get devicePixelRatio(){return window.devicePixelRatio},get prefersReducedMotion(){return!!window.matchMedia&&(Xe==null&&(Xe=window.matchMedia("(prefers-reduced-motion: reduce)")),Xe.matches)},hasCanvasFingerprintNoise(){if(xt!==void 0)return xt;if(!wt())return xt=!1,!1;const m=new OffscreenCanvas(85,1),o=m.getContext("2d",{willReadFrequently:!0});let u=0;for(let y=0;y<m.width;++y)o.fillStyle=`rgba(${u++},${u++},${u++}, 255)`,o.fillRect(y,0,1,1);const f=o.getImageData(0,0,m.width,m.height);u=0;for(let y=0;y<f.data.length;++y)if(y%4!=3&&u++!==f.data[y])return xt=!0,!0;return xt=!1,!1}};function $t(m,o){const u=m.indexOf("?");if(u<0)return`${m}?${new URLSearchParams(o).toString()}`;const f=new URLSearchParams(m.slice(u));for(const y in o)f.set(y,o[y]);return`${m.slice(0,u)}?${f.toString()}`}function nr(m,o={persistentParams:[]}){const u=m.indexOf("?");if(u<0)return m;const f=new URLSearchParams,y=new URLSearchParams(m.slice(u));for(const _ of o.persistentParams){const T=y.get(_);T&&f.set(_,T)}const g=f.toString();return`${m.slice(0,u)}${g.length>0?`?${g}`:""}`}const or="mapbox-tiles";let Ur=500,Jr=50;const Qr=["language","worldview","jobid"];let nn,di;function Ci(){try{return caches}catch{}}function hn(){const m=Ci();m&&nn==null&&(nn=m.open(or))}let Ln=1/0;const Wn={supported:!1,testSupport:function(m){!Us&&Qi&&(ya?Ca(m):Kn=m)}};let Kn,Qi,Us=!1,ya=!1;const Io=typeof self<"u"?self:{};function Ca(m){const o=m.createTexture();m.bindTexture(m.TEXTURE_2D,o);try{if(m.texImage2D(m.TEXTURE_2D,0,m.RGBA,m.RGBA,m.UNSIGNED_BYTE,Qi),m.isContextLost())return;Wn.supported=!0}catch{}m.deleteTexture(o),Us=!0}Io.document&&(Qi=Io.document.createElement("img"),Qi.onload=function(){Kn&&Ca(Kn),Kn=null,ya=!0},Qi.onerror=function(){Us=!0,Kn=null},Qi.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const Ps={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Iconset:"Iconset",Image:"Image",Model:"Model"};typeof Object.freeze=="function"&&Object.freeze(Ps);class Js extends Error{constructor(o,u,f){u===401&&be(f)&&(o+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(o),this.status=u,this.url=f}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const Pd=Ji()?()=>self.worker&&self.worker.referrer:()=>(location.protocol==="blob:"?parent:self).location.href,Oo=function(m,o){if(!(/^file:/.test(u=m.url)||/^file:/.test(Pd())&&!/^\w+:/.test(u))){if(self.fetch&&self.Request&&self.AbortController&&Request.prototype.hasOwnProperty("signal"))return function(f,y){const g=new AbortController,_=new Request(f.url,{method:f.method||"GET",body:f.body,credentials:f.credentials,headers:f.headers,referrer:Pd(),referrerPolicy:f.referrerPolicy,signal:g.signal});let T=!1,E=!1;const O=(C=_.url).indexOf("sku=")>0&&be(C);var C;f.type==="json"&&_.headers.set("Accept","application/json");const M=(I,R,H)=>{if(E)return;if(I&&I.message!=="SecurityError"&&_i(I.toString()),R&&H)return D(R);const X=Date.now();fetch(_).then(J=>{if(J.ok){const ne=O?J.clone():null;return D(J,ne,X)}return y(new Js(J.statusText,J.status,f.url))}).catch(J=>{J.name!=="AbortError"&&y(new Error(`${J.message} ${f.url}`))})},D=(I,R,H)=>{(f.type==="arrayBuffer"?I.arrayBuffer():f.type==="json"?I.json():I.text()).then(X=>{E||(R&&H&&function(J,ne,re){if(hn(),nn==null)return;const te=la(ne.headers.get("Cache-Control")||"");if(te["no-store"])return;const oe={status:ne.status,statusText:ne.statusText,headers:new Headers};ne.headers.forEach((Me,Se)=>oe.headers.set(Se,Me)),te["max-age"]&&oe.headers.set("Expires",new Date(re+1e3*te["max-age"]).toUTCString());const ue=oe.headers.get("Expires");if(!ue||new Date(ue).getTime()-re<42e4)return;let me=nr(J.url,{persistentParams:Qr});if(ne.status===206){const Me=J.headers.get("Range");if(!Me)return;oe.status=200,me=$t(me,{range:Me})}(function(Me,Se){if(di===void 0)try{new Response(new ReadableStream),di=!0}catch{di=!1}di?Se(Me.body):Me.blob().then(Se)})(ne,Me=>{const Se=new Response((Ae=ne.status)!==200&&Ae!==404&&[101,103,204,205,304].includes(Ae)?null:Me,oe);var Ae;hn(),nn!=null&&nn.then(Ve=>Ve.put(me,Se)).catch(Ve=>_i(Ve.message))})}(_,R,H),T=!0,y(null,X,I.headers.get("Cache-Control"),I.headers.get("Expires")))}).catch(X=>{E||y(new Error(X.message))})};return O?function(I,R){if(hn(),nn==null)return R(null);nn.then(H=>{let X=nr(I.url,{persistentParams:Qr});const J=I.headers.get("Range");J&&(X=$t(X,{range:J})),H.match(X).then(ne=>{const re=function(te){if(!te)return!1;const oe=new Date(te.headers.get("Expires")||0),ue=la(te.headers.get("Cache-Control")||"");return oe>Date.now()&&!ue["no-cache"]}(ne);H.delete(X),re&&H.put(X,ne.clone()),R(null,ne,re)}).catch(R)}).catch(R)}(_,M):M(null,null),{cancel:()=>{E=!0,T||g.abort()}}}(m,o);if(Ji()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",m,o,void 0,!0)}var u;return function(f,y){const g=new XMLHttpRequest;g.open(f.method||"GET",f.url,!0),f.type==="arrayBuffer"&&(g.responseType="arraybuffer");for(const _ in f.headers)g.setRequestHeader(_,f.headers[_]);return f.type==="json"&&(g.responseType="text",g.setRequestHeader("Accept","application/json")),g.withCredentials=f.credentials==="include",g.onerror=()=>{y(new Error(g.statusText))},g.onload=()=>{if((g.status>=200&&g.status<300||g.status===0)&&g.response!==null){let _=g.response;if(f.type==="json")try{_=JSON.parse(g.response)}catch(T){return y(T)}y(null,_,g.getResponseHeader("Cache-Control"),g.getResponseHeader("Expires"))}else y(new Js(g.statusText,g.status,f.url))},g.send(f.body),{cancel:()=>g.abort()}}(m,o)},Rl=function(m,o){return Oo(Ui(m,{type:"arrayBuffer"}),o)};function xg(m){const o=document.createElement("a");return o.href=m,o.protocol===location.protocol&&o.host===location.host}const qm="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Rh,Ed;Rh=[],Ed=0;const Md=function(m,o){if(Wn.supported&&(m.headers||(m.headers={}),m.headers.accept="image/webp,*/*"),Ed>=pe.MAX_PARALLEL_IMAGE_REQUESTS){const g={requestParameters:m,callback:o,cancelled:!1,cancel(){this.cancelled=!0}};return Rh.push(g),g}Ed++;let u=!1;const f=()=>{if(!u)for(u=!0,Ed--;Rh.length&&Ed<pe.MAX_PARALLEL_IMAGE_REQUESTS;){const g=Rh.shift(),{requestParameters:_,callback:T,cancelled:E}=g;E||(g.cancel=Md(_,T).cancel)}},y=Rl(m,(g,_,T,E)=>{f(),g?o(g):_&&(self.createImageBitmap?function(O,C){const M=new Blob([new Uint8Array(O)],{type:"image/png"});createImageBitmap(M).then(D=>{C(null,D)}).catch(D=>{C(new Error(`Could not load image because of ${D.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(_,(O,C)=>o(O,C,T,E)):function(O,C){const M=new Image;M.onload=()=>{C(null,M),URL.revokeObjectURL(M.src),M.onload=null,requestAnimationFrame(()=>{M.src=qm})},M.onerror=()=>C(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const D=new Blob([new Uint8Array(O)],{type:"image/png"});M.src=O.byteLength?URL.createObjectURL(D):qm}(_,(O,C)=>o(O,C,T,E)))});return{cancel:()=>{y.cancel(),f()}}};var Px,Ex,yg,Zc={exports:{}},yo={exports:{}},il={exports:{}},oc=function(){if(yg)return Zc.exports;yg=1;var m=(Px||(Px=1,yo.exports=function(u,f){var y,g,_,T,E,O,C,M;for(g=u.length-(y=3&u.length),_=f,E=3432918353,O=461845907,M=0;M<g;)C=255&u.charCodeAt(M)|(255&u.charCodeAt(++M))<<8|(255&u.charCodeAt(++M))<<16|(255&u.charCodeAt(++M))<<24,++M,_=27492+(65535&(T=5*(65535&(_=(_^=C=(65535&(C=(C=(65535&C)*E+(((C>>>16)*E&65535)<<16)&4294967295)<<15|C>>>17))*O+(((C>>>16)*O&65535)<<16)&4294967295)<<13|_>>>19))+((5*(_>>>16)&65535)<<16)&4294967295))+((58964+(T>>>16)&65535)<<16);switch(C=0,y){case 3:C^=(255&u.charCodeAt(M+2))<<16;case 2:C^=(255&u.charCodeAt(M+1))<<8;case 1:_^=C=(65535&(C=(C=(65535&(C^=255&u.charCodeAt(M)))*E+(((C>>>16)*E&65535)<<16)&4294967295)<<15|C>>>17))*O+(((C>>>16)*O&65535)<<16)&4294967295}return _^=u.length,_=2246822507*(65535&(_^=_>>>16))+((2246822507*(_>>>16)&65535)<<16)&4294967295,_=3266489909*(65535&(_^=_>>>13))+((3266489909*(_>>>16)&65535)<<16)&4294967295,(_^=_>>>16)>>>0}),yo.exports),o=(Ex||(Ex=1,il.exports=function(u,f){for(var y,g=u.length,_=f^g,T=0;g>=4;)y=1540483477*(65535&(y=255&u.charCodeAt(T)|(255&u.charCodeAt(++T))<<8|(255&u.charCodeAt(++T))<<16|(255&u.charCodeAt(++T))<<24))+((1540483477*(y>>>16)&65535)<<16),_=1540483477*(65535&_)+((1540483477*(_>>>16)&65535)<<16)^(y=1540483477*(65535&(y^=y>>>24))+((1540483477*(y>>>16)&65535)<<16)),g-=4,++T;switch(g){case 3:_^=(255&u.charCodeAt(T+2))<<16;case 2:_^=(255&u.charCodeAt(T+1))<<8;case 1:_=1540483477*(65535&(_^=255&u.charCodeAt(T)))+((1540483477*(_>>>16)&65535)<<16)}return _=1540483477*(65535&(_^=_>>>13))+((1540483477*(_>>>16)&65535)<<16),(_^=_>>>15)>>>0}),il.exports);return Zc.exports=m,Zc.exports.murmur3=m,Zc.exports.murmur2=o,Zc.exports}(),sl=p(oc);class Ro{constructor(o,...u){Ui(this,u[0]||{}),this.type=o}}class Wm extends Ro{constructor(o,u={}){super("error",Ui({error:o},u))}}function q_(m,o,u){u[m]&&u[m].indexOf(o)!==-1||(u[m]=u[m]||[],u[m].push(o))}function Mx(m,o,u){if(u&&u[m]){const f=u[m].indexOf(o);f!==-1&&u[m].splice(f,1)}}class lc{on(o,u){return this._listeners=this._listeners||{},q_(o,u,this._listeners),this}off(o,u){return Mx(o,u,this._listeners),Mx(o,u,this._oneTimeListeners),this}once(o,u){return u?(this._oneTimeListeners=this._oneTimeListeners||{},q_(o,u,this._oneTimeListeners),this):new Promise(f=>{this.once(o,f)})}fire(o,u){const f=typeof o=="string"?new Ro(o,u):o,y=f.type;if(this.listens(y)){f.target=this;const g=this._listeners&&this._listeners[y]?this._listeners[y].slice():[];for(const E of g)E.call(this,f);const _=this._oneTimeListeners&&this._oneTimeListeners[y]?this._oneTimeListeners[y].slice():[];for(const E of _)Mx(y,E,this._oneTimeListeners),E.call(this,f);const T=this._eventedParent;T&&(Ui(f,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),T.fire(f))}else f instanceof Wm&&console.error(f.error);return this}listens(o){return!!(this._listeners&&this._listeners[o]&&this._listeners[o].length>0||this._oneTimeListeners&&this._oneTimeListeners[o]&&this._oneTimeListeners[o].length>0||this._eventedParent&&this._eventedParent.listens(o))}setEventedParent(o,u){return this._eventedParent=o,this._eventedParentData=u,this}}class vo{constructor(o){typeof o=="string"?this.name=o:(this.name=o.name,this.iconsetId=o.iconsetId)}static from(o){return new vo(o)}static toString(o){return o.iconsetId?`${o.name}${o.iconsetId}`:o.name}static parse(o){const[u,f]=o.split("");return new vo({name:u,iconsetId:f})}static isEqual(o,u){return o.name===u.name&&o.iconsetId===u.iconsetId}toString(){return vo.toString(this)}serialize(){return{name:this.name,iconsetId:this.iconsetId}}}var AS,W_={},Dl=function(){if(AS)return W_;AS=1;var m={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function o(g){return(g=Math.round(g))<0?0:g>255?255:g}function u(g){return o(g[g.length-1]==="%"?parseFloat(g)/100*255:parseInt(g))}function f(g){return(_=g[g.length-1]==="%"?parseFloat(g)/100:parseFloat(g))<0?0:_>1?1:_;var _}function y(g,_,T){return T<0?T+=1:T>1&&(T-=1),6*T<1?g+(_-g)*T*6:2*T<1?_:3*T<2?g+(_-g)*(2/3-T)*6:g}try{W_.parseCSSColor=function(g){var _,T=g.replace(/ /g,"").toLowerCase();if(T in m)return m[T].slice();if(T[0]==="#")return T.length===4?(_=parseInt(T.substr(1),16))>=0&&_<=4095?[(3840&_)>>4|(3840&_)>>8,240&_|(240&_)>>4,15&_|(15&_)<<4,1]:null:T.length===7&&(_=parseInt(T.substr(1),16))>=0&&_<=16777215?[(16711680&_)>>16,(65280&_)>>8,255&_,1]:null;var E=T.indexOf("("),O=T.indexOf(")");if(E!==-1&&O+1===T.length){var C=T.substr(0,E),M=T.substr(E+1,O-(E+1)).split(","),D=1;switch(C){case"rgba":if(M.length!==4)return null;D=f(M.pop());case"rgb":return M.length!==3?null:[u(M[0]),u(M[1]),u(M[2]),D];case"hsla":if(M.length!==4)return null;D=f(M.pop());case"hsl":if(M.length!==3)return null;var I=(parseFloat(M[0])%360+360)%360/360,R=f(M[1]),H=f(M[2]),X=H<=.5?H*(R+1):H+R-H*R,J=2*H-X;return[o(255*y(J,X,I+1/3)),o(255*y(J,X,I)),o(255*y(J,X,I-1/3)),D];default:return null}}return null}}catch{}return W_}();class Xn{constructor(o,u,f,y=1){this.r=o,this.g=u,this.b=f,this.a=y}static parse(o){if(!o)return;if(o instanceof Xn)return o;if(typeof o!="string")return;const u=Dl.parseCSSColor(o);return u?new Xn(u[0]/255*u[3],u[1]/255*u[3],u[2]/255*u[3],u[3]):void 0}toStringPremultipliedAlpha(){const[o,u,f,y]=this.a===0?[0,0,0,0]:[255*this.r/this.a,255*this.g/this.a,255*this.b/this.a,this.a];return`rgba(${Math.round(o)},${Math.round(u)},${Math.round(f)},${y})`}toString(){const[o,u,f,y]=[this.r,this.g,this.b,this.a];return`rgba(${Math.round(255*o)},${Math.round(255*u)},${Math.round(255*f)},${y})`}toRenderColor(o){const{r:u,g:f,b:y,a:g}=this;return new K_(o,u,f,y,g)}clone(){return new Xn(this.r,this.g,this.b,this.a)}}class K_{constructor(o,u,f,y,g){if(o){const _=o.image.height,T=_*_;u=g===0?0:u/g*(_-1),f=g===0?0:f/g*(_-1),y=g===0?0:y/g*(_-1);const E=Math.floor(u),O=Math.floor(f),C=Math.floor(y),M=Math.ceil(u),D=Math.ceil(f),I=Math.ceil(y),R=u-E,H=f-O,X=y-C,J=o.image.data,ne=4*(E+O*T+C*_),re=4*(E+O*T+I*_),te=4*(E+D*T+C*_),oe=4*(E+D*T+I*_),ue=4*(M+O*T+C*_),me=4*(M+O*T+I*_),Me=4*(M+D*T+C*_),Se=4*(M+D*T+I*_);if(ne<0||Se>=J.length)throw new Error("out of range");this.r=Mr(Mr(Mr(J[ne],J[re],X),Mr(J[te],J[oe],X),H),Mr(Mr(J[ue],J[me],X),Mr(J[Me],J[Se],X),H),R)/255*g,this.g=Mr(Mr(Mr(J[ne+1],J[re+1],X),Mr(J[te+1],J[oe+1],X),H),Mr(Mr(J[ue+1],J[me+1],X),Mr(J[Me+1],J[Se+1],X),H),R)/255*g,this.b=Mr(Mr(Mr(J[ne+2],J[re+2],X),Mr(J[te+2],J[oe+2],X),H),Mr(Mr(J[ue+2],J[me+2],X),Mr(J[Me+2],J[Se+2],X),H),R)/255*g,this.a=g}else this.r=u,this.g=f,this.b=y,this.a=g}toArray(){const{r:o,g:u,b:f,a:y}=this;return y===0?[0,0,0,0]:[255*o/y,255*u/y,255*f/y,y]}toHslaArray(){if(this.a===0)return[0,0,0,0];const{r:o,g:u,b:f,a:y}=this,g=Math.min(Math.max(o/y,0),1),_=Math.min(Math.max(u/y,0),1),T=Math.min(Math.max(f/y,0),1),E=Math.min(g,_,T),O=Math.max(g,_,T),C=(E+O)/2;if(E===O)return[0,0,100*C,y];const M=O-E,D=C>.5?M/(2-O-E):M/(O+E);let I=0;return O===g?I=(_-T)/M+(_<T?6:0):O===_?I=(T-g)/M+2:O===T&&(I=(g-_)/M+4),I*=60,[Math.min(Math.max(I,0),360),Math.min(Math.max(100*D,0),100),Math.min(Math.max(100*C,0),100),y]}toArray01(){const{r:o,g:u,b:f,a:y}=this;return y===0?[0,0,0,0]:[o/y,u/y,f/y,y]}toArray01Scaled(o){const{r:u,g:f,b:y,a:g}=this;return g===0?[0,0,0]:[u/g*o,f/g*o,y/g*o]}toArray01PremultipliedAlpha(){const{r:o,g:u,b:f,a:y}=this;return[o,u,f,y]}toArray01Linear(){const{r:o,g:u,b:f,a:y}=this;return y===0?[0,0,0,0]:[Math.pow(o/y,2.2),Math.pow(u/y,2.2),Math.pow(f/y,2.2),y]}}function Mr(m,o,u){return m*(1-u)+o*u}function TS(m,o,u){return m.map((f,y)=>Mr(f,o[y],u))}function kS(m){return m*m*m*m*m}Xn.black=new Xn(0,0,0,1),Xn.white=new Xn(1,1,1,1),Xn.transparent=new Xn(0,0,0,0),Xn.red=new Xn(1,0,0,1),Xn.blue=new Xn(0,0,1,1);var vg=Object.freeze({__proto__:null,array:TS,color:function(m,o,u){return new Xn(Mr(m.r,o.r,u),Mr(m.g,o.g,u),Mr(m.b,o.b,u),Mr(m.a,o.a,u))},easeIn:kS,number:Mr});function kn(m,...o){for(const u of o)for(const f in u)m[f]=u[f];return m}class zl extends Error{constructor(o,u){super(u),this.message=u,this.key=o}}class Ix{constructor(o,u=[]){this.parent=o,this.bindings={};for(const[f,y]of u)this.bindings[f]=y}concat(o){return new Ix(this,o)}get(o){if(this.bindings[o])return this.bindings[o];if(this.parent)return this.parent.get(o);throw new Error(`${o} not found in scope.`)}has(o){return!!this.bindings[o]||!!this.parent&&this.parent.has(o)}}const Km={kind:"null"},vr={kind:"number"},Zn={kind:"string"},In={kind:"boolean"},Ga={kind:"color"},Zm={kind:"object"},Fn={kind:"value"},ku={kind:"collator"},bg={kind:"formatted"},Pu={kind:"resolvedImage"};function Aa(m,o){return{kind:"array",itemType:m,N:o}}function us(m){if(m.kind==="array"){const o=us(m.itemType);return typeof m.N=="number"?`array<${o}, ${m.N}>`:m.itemType.kind==="value"?"array":`array<${o}>`}return m.kind}const cc=[Km,vr,Zn,In,Ga,bg,Zm,Aa(Fn),Pu];function Ym(m,o){if(o.kind==="error")return null;if(m.kind==="array"){if(o.kind==="array"&&(o.N===0&&o.itemType.kind==="value"||!Ym(m.itemType,o.itemType))&&(typeof m.N!="number"||m.N===o.N))return null}else{if(m.kind===o.kind)return null;if(m.kind==="value"){for(const u of cc)if(!Ym(u,o))return null}}return`Expected ${us(m)} but found ${us(o)} instead.`}function Z_(m,o){return o.some(u=>u.kind===m.kind)}function Xm(m,o){return o.some(u=>u==="null"?m===null:u==="array"?Array.isArray(m):u==="object"?m&&!Array.isArray(m)&&typeof m=="object":u===typeof m)}class Ox{constructor(o,u,f){this.sensitivity=o?u?"variant":"case":u?"accent":"base",this.locale=f,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(o,u){return this.collator.compare(o,u)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class _g{constructor(o,u,f,y,g){this.text=o.normalize?o.normalize():o,this.image=u,this.scale=f,this.fontStack=y,this.textColor=g}}class Ha{constructor(o){this.sections=o}static fromString(o){return new Ha([new _g(o,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(o=>o.text.length!==0||!!o.image&&o.image.hasPrimary())}static factory(o){return o instanceof Ha?o:Ha.fromString(o)}toString(){return this.sections.length===0?"":this.sections.map(o=>o.text).join("")}serialize(){const o=["format"];for(const u of this.sections){if(u.image){const y=u.image.getPrimary().id.toString();o.push(["image",y]);continue}o.push(u.text);const f={};u.fontStack&&(f["text-font"]=["literal",u.fontStack.split(",")]),u.scale&&(f["font-scale"]=u.scale),u.textColor&&(f["text-color"]=["rgba"].concat(u.textColor.toRenderColor(null).toArray())),o.push(f)}return o}}class Yc{constructor(o,u={}){if(this.id=vo.from(o),this.options=Object.assign({},u),u.transform){const{a:f,b:y,c:g,d:_,e:T,f:E}=u.transform;this.options.transform=new DOMMatrix([f,y,g,_,T,E])}else this.options.transform=new DOMMatrix([1,0,0,1,0,0])}toString(){const{a:o,b:u,c:f,d:y,e:g,f:_}=this.options.transform;return JSON.stringify({name:this.id.name,iconsetId:this.id.iconsetId,params:this.options.params,transform:{a:o,b:u,c:f,d:y,e:g,f:_}})}static parse(o){let u,f,y,g;try{({name:u,iconsetId:f,params:y,transform:g}=JSON.parse(o)||{})}catch{return null}if(!u)return null;const{a:_,b:T,c:E,d:O,e:C,f:M}=g||{};return new Yc({name:u,iconsetId:f},{params:y,transform:new DOMMatrix([_,T,E,O,C,M])})}scaleSelf(o){return this.options.transform.scaleSelf(o),this}}class qa{constructor(o,u,f,y,g=!1){this.primaryId=vo.from(o),this.primaryOptions=u,f&&(this.secondaryId=vo.from(f)),this.secondaryOptions=y,this.available=g}toString(){return this.primaryId&&this.secondaryId?`[${this.primaryId.name},${this.secondaryId.name}]`:this.primaryId.name}hasPrimary(){return!!this.primaryId}getPrimary(){return new Yc(this.primaryId,this.primaryOptions)}hasSecondary(){return!!this.secondaryId}getSecondary(){return this.secondaryId?new Yc(this.secondaryId,this.secondaryOptions):null}static from(o){return typeof o=="string"?qa.build({name:o}):o}static build(o,u,f,y){return!o||typeof o=="object"&&!("name"in o)?null:new qa(o,f,u,y)}}function wg(m,o,u,f){return typeof m=="number"&&m>=0&&m<=255&&typeof o=="number"&&o>=0&&o<=255&&typeof u=="number"&&u>=0&&u<=255?f===void 0||typeof f=="number"&&f>=0&&f<=1?null:`Invalid rgba value [${[m,o,u,f].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof f=="number"?[m,o,u,f]:[m,o,u]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function uc(m){if(m===null||typeof m=="string"||typeof m=="boolean"||typeof m=="number"||m instanceof Xn||m instanceof Ox||m instanceof Ha||m instanceof qa)return!0;if(Array.isArray(m)){for(const o of m)if(!uc(o))return!1;return!0}if(typeof m=="object"){for(const o in m)if(!uc(m[o]))return!1;return!0}return!1}function Es(m){if(m===null)return Km;if(typeof m=="string")return Zn;if(typeof m=="boolean")return In;if(typeof m=="number")return vr;if(m instanceof Xn)return Ga;if(m instanceof Ox)return ku;if(m instanceof Ha)return bg;if(m instanceof qa)return Pu;if(Array.isArray(m)){const o=m.length;let u;for(const f of m){const y=Es(f);if(u){if(u===y)continue;u=Fn;break}u=y}return Aa(u||Fn,o)}return Zm}function ca(m){const o=typeof m;return m===null?"":o==="string"||o==="number"||o==="boolean"?String(m):m instanceof Xn?m.toStringPremultipliedAlpha():m instanceof Ha||m instanceof qa?m.toString():JSON.stringify(m)}class Eu{constructor(o,u){this.type=o,this.value=u}static parse(o,u){if(o.length!==2)return u.error(`'literal' expression requires exactly one argument, but found ${o.length-1} instead.`);if(!uc(o[1]))return u.error("invalid value");const f=o[1];let y=Es(f);const g=u.expectedType;return y.kind!=="array"||y.N!==0||!g||g.kind!=="array"||typeof g.N=="number"&&g.N!==0||(y=g),new Eu(y,f)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Xn?["rgba"].concat(this.value.toRenderColor(null).toArray()):this.value instanceof Ha?this.value.serialize():this.value}}class ps{constructor(o){this.name="ExpressionEvaluationError",this.message=o}toJSON(){return this.message}}const Y_={string:Zn,number:vr,boolean:In,object:Zm};class al{constructor(o,u){this.type=o,this.args=u}static parse(o,u){if(o.length<2)return u.error("Expected at least one argument.");let f,y=1;const g=o[0];if(g==="array"){let T,E;if(o.length>2){const O=o[1];if(typeof O!="string"||!(O in Y_)||O==="object")return u.error('The item type argument of "array" must be one of string, number, boolean',1);T=Y_[O],y++}else T=Fn;if(o.length>3){if(o[2]!==null&&(typeof o[2]!="number"||o[2]<0||o[2]!==Math.floor(o[2])))return u.error('The length argument to "array" must be a positive integer literal',2);E=o[2],y++}f=Aa(T,E)}else f=Y_[g];const _=[];for(;y<o.length;y++){const T=u.parse(o[y],y,Fn);if(!T)return null;_.push(T)}return new al(f,_)}evaluate(o){for(let u=0;u<this.args.length;u++){const f=this.args[u].evaluate(o);if(!Ym(this.type,Es(f)))return f;if(u===this.args.length-1)throw new ps(`The expression ${JSON.stringify(this.args[u].serialize())} evaluated to ${us(Es(f))} but was expected to be of type ${us(this.type)}.`)}return null}eachChild(o){this.args.forEach(o)}outputDefined(){return this.args.every(o=>o.outputDefined())}serialize(){const o=this.type,u=[o.kind];if(o.kind==="array"){const f=o.itemType;if(f.kind==="string"||f.kind==="number"||f.kind==="boolean"){u.push(f.kind);const y=o.N;(typeof y=="number"||this.args.length>1)&&u.push(y)}}return u.concat(this.args.map(f=>f.serialize()))}}class Jm{constructor(o){this.type=bg,this.sections=o}static parse(o,u){if(o.length<2)return u.error("Expected at least one argument.");const f=o[1];if(!Array.isArray(f)&&typeof f=="object")return u.error("First argument must be an image or text section.");const y=[];let g=!1;for(let _=1;_<=o.length-1;++_){const T=o[_];if(g&&typeof T=="object"&&!Array.isArray(T)){g=!1;let E=null;if(T["font-scale"]&&(E=u.parseObjectValue(T["font-scale"],_,"font-scale",vr),!E))return null;let O=null;if(T["text-font"]&&(O=u.parseObjectValue(T["text-font"],_,"text-font",Aa(Zn)),!O))return null;let C=null;if(T["text-color"]&&(C=u.parseObjectValue(T["text-color"],_,"text-color",Ga),!C))return null;const M=y[y.length-1];M.scale=E,M.font=O,M.textColor=C}else{const E=u.parse(o[_],_,Fn);if(!E)return null;const O=E.type.kind;if(O!=="string"&&O!=="value"&&O!=="null"&&O!=="resolvedImage")return u.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");g=!0,y.push({content:E,scale:null,font:null,textColor:null})}}return new Jm(y)}evaluate(o){return new Ha(this.sections.map(u=>{const f=u.content.evaluate(o);return Es(f)===Pu?new _g("",f,null,null,null):new _g(ca(f),null,u.scale?u.scale.evaluate(o):null,u.font?u.font.evaluate(o).join(","):null,u.textColor?u.textColor.evaluate(o):null)}))}eachChild(o){for(const u of this.sections)o(u.content),u.scale&&o(u.scale),u.font&&o(u.font),u.textColor&&o(u.textColor)}outputDefined(){return!1}serialize(){const o=["format"];for(const u of this.sections){o.push(u.content.serialize());const f={};u.scale&&(f["font-scale"]=u.scale.serialize()),u.font&&(f["text-font"]=u.font.serialize()),u.textColor&&(f["text-color"]=u.textColor.serialize()),o.push(f)}return o}}class Id{constructor(o,u,f,y){this._imageWarnHistory={},this.type=Pu,this.namePrimary=o,this.nameSecondary=u,f&&(this.paramsPrimary=f.params,this.iconsetIdPrimary=f.iconset?f.iconset.id:void 0),y&&(this.paramsSecondary=y.params,this.iconsetIdSecondary=y.iconset?y.iconset.id:void 0)}static parse(o,u){if(o.length<2)return u.error("Expected two or more arguments.");let f=1;const y=[];function g(){if(f<o.length){const T=u.parse(o[f],f++,Zn);return T?(y.push({image:T,options:{}}),!0):(u.error(y.length?"Secondary image variant is not a string.":"No image name provided."),!1)}return!0}function _(){if(f<o.length){const E=o[f];if((T=E)===null||typeof T!="object"||Array.isArray(T))return!0;const O=E.params,C=E.iconset,M=u.concat(f);if(!O&&!C)return f++,!0;if(O){if(typeof O!="object"||O.constructor!==Object)return M.error('Image options "params" should be an object'),!1;const D={},I=M.concat(void 0,"params");for(const R in O){if(!R)return I.error("Image parameter name should be non-empty"),!1;const H=I.concat(void 0,R).parse(O[R],void 0,Ga,void 0,{typeAnnotation:"coerce"});if(!H)return!1;D[R]=H}y[y.length-1].options.params=D}if(C){if(typeof C!="object"||C.constructor!==Object)return M.error('Image options "iconset" should be an object'),!1;if(!C.id)return M.error('Image options "iconset" should have an "id" property'),!1;y[y.length-1].options.iconset=C}return f++,!0}var T;return!0}for(let T=0;T<2;T++)if(!g()||!_())return;return new Id(y[0].image,y[1]?y[1].image:void 0,y[0].options,y[1]?y[1].options:void 0)}evaluateParams(o,u){const f={};if(u){for(const y in u)if(u[y])try{f[y]=u[y].evaluate(o)}catch{continue}if(Object.keys(f).length!==0)return{params:f}}}evaluate(o){const u={name:this.namePrimary.evaluate(o),iconsetId:this.iconsetIdPrimary},f=this.nameSecondary?{name:this.nameSecondary.evaluate(o),iconsetId:this.iconsetIdSecondary}:void 0,y=qa.build(u,f,this.paramsPrimary?this.evaluateParams(o,this.paramsPrimary):void 0,this.paramsSecondary?this.evaluateParams(o,this.paramsSecondary):void 0);if(y&&o.availableImages){const g=y.getPrimary().id;if(y.available=o.availableImages.some(_=>vo.isEqual(_,g)),y.available){const _=y.getSecondary()?y.getSecondary().id:null;_&&(y.available=o.availableImages.some(T=>vo.isEqual(T,_)))}}return y}eachChild(o){if(o(this.namePrimary),this.paramsPrimary)for(const u in this.paramsPrimary)this.paramsPrimary[u]&&o(this.paramsPrimary[u]);if(this.nameSecondary&&(o(this.nameSecondary),this.paramsSecondary))for(const u in this.paramsSecondary)this.paramsSecondary[u]&&o(this.paramsSecondary[u])}outputDefined(){return!1}serializeOptions(o,u){const f={};if(u&&(f.iconset={id:u}),o){f.params={};for(const y in o)o[y]&&(f.params[y]=o[y].serialize())}return Object.keys(f).length>0?f:void 0}serialize(){const o=["image",this.namePrimary.serialize()];if(this.paramsPrimary||this.iconsetIdPrimary){const u=this.serializeOptions(this.paramsPrimary,this.iconsetIdPrimary);u&&o.push(u)}if(this.nameSecondary&&(o.push(this.nameSecondary.serialize()),this.paramsSecondary||this.iconsetIdSecondary)){const u=this.serializeOptions(this.paramsSecondary,this.iconsetIdSecondary);u&&o.push(u)}return o}}function Mu(m){return m instanceof Number?"number":m instanceof String?"string":m instanceof Boolean?"boolean":Array.isArray(m)?"array":m===null?"null":typeof m}const R3={"to-boolean":In,"to-color":Ga,"to-number":vr,"to-string":Zn};class Iu{constructor(o,u){this.type=o,this.args=u}static parse(o,u){if(o.length<2)return u.error("Expected at least one argument.");const f=o[0],y=[];let g=Km;if(f==="to-array"){if(!Array.isArray(o[1]))return null;const _=o[1].length;if(u.expectedType){if(u.expectedType.kind!=="array")return u.error(`Expected ${u.expectedType.kind} but found array.`);g=Aa(u.expectedType.itemType,_)}else{if(!(_>0&&uc(o[1][0])))return null;g=Aa(Es(o[1][0]),_)}for(let T=0;T<_;T++){const E=o[1][T];let O;if(Mu(E)==="array")O=u.parse(E,void 0,g.itemType);else{const C=Mu(E);if(C!==g.itemType.kind)return u.error(`Expected ${g.itemType.kind} but found ${C}.`);O=u.registry.literal.parse(["literal",E===void 0?null:E],u)}if(!O)return null;y.push(O)}}else{if((f==="to-boolean"||f==="to-string")&&o.length!==2)return u.error("Expected one argument.");g=R3[f];for(let _=1;_<o.length;_++){const T=u.parse(o[_],_,Fn);if(!T)return null;y.push(T)}}return new Iu(g,y)}evaluate(o){if(this.type.kind==="boolean")return!!this.args[0].evaluate(o);if(this.type.kind==="color"){let u,f;for(const y of this.args){if(u=y.evaluate(o),f=null,u instanceof Xn)return u;if(typeof u=="string"){const g=o.parseColor(u);if(g)return g}else if(Array.isArray(u)&&(f=u.length<3||u.length>4?`Invalid rbga value ${JSON.stringify(u)}: expected an array containing either three or four numeric values.`:wg(u[0],u[1],u[2],u[3]),!f))return new Xn(u[0]/255,u[1]/255,u[2]/255,u[3])}throw new ps(f||`Could not parse color from value '${typeof u=="string"?u:String(JSON.stringify(u))}'`)}if(this.type.kind==="number"){let u=null;for(const f of this.args){if(u=f.evaluate(o),u===null)return 0;const y=Number(u);if(!isNaN(y))return y}throw new ps(`Could not convert ${JSON.stringify(u)} to number.`)}return this.type.kind==="formatted"?Ha.fromString(ca(this.args[0].evaluate(o))):this.type.kind==="resolvedImage"?qa.build(ca(this.args[0].evaluate(o))):this.type.kind==="array"?this.args.map(u=>u.evaluate(o)):ca(this.args[0].evaluate(o))}eachChild(o){this.args.forEach(o)}outputDefined(){return this.args.every(o=>o.outputDefined())}serialize(){if(this.type.kind==="formatted")return new Jm([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Id(this.args[0]).serialize();const o=this.type.kind==="array"?[]:[`to-${this.type.kind}`];return this.eachChild(u=>{o.push(u.serialize())}),o}}const D3=["Unknown","Point","LineString","Polygon"];class Rx{constructor(o,u){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.scope=o,this.options=u}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?D3[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(o){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const o=this.featureDistanceData.center,u=this.featureDistanceData.scale,{x:f,y}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(f*u-o[0])+this.featureDistanceData.bearing[1]*(y*u-o[1])}return 0}parseColor(o){let u=this._parseColorCache[o];return u||(u=this._parseColorCache[o]=Xn.parse(o)),u}getConfig(o){return this.options?this.options.get(o):null}}class ao{constructor(o,u,f,y,g){this.name=o,this.type=u,this._evaluate=f,this.args=y,this._overloadIndex=g}evaluate(o){if(!this._evaluate){const u=ao.definitions[this.name];this._evaluate=Array.isArray(u)?u[2]:u.overloads[this._overloadIndex][1]}return this._evaluate(o,this.args)}eachChild(o){this.args.forEach(o)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(o=>o.serialize()))}static parse(o,u){const f=o[0],y=ao.definitions[f];if(!y)return u.error(`Unknown expression "${f}". If you wanted a literal array, use ["literal", [...]].`,0);const g=Array.isArray(y)?y[0]:y.type,_=Array.isArray(y)?[[y[1],y[2]]]:y.overloads,T=[];let E=null,O=-1;for(const[C,M]of _){if(Array.isArray(C)&&C.length!==o.length-1)continue;T.push(C),O++,E=new n1(u.registry,u.path,null,u.scope,void 0,u._scope,u.options);const D=[];let I=!1;for(let R=1;R<o.length;R++){const H=o[R],X=Array.isArray(C)?C[R-1]:C.type,J=E.parse(H,1+D.length,X);if(!J){I=!0;break}D.push(J)}if(!I)if(Array.isArray(C)&&C.length!==D.length)E.error(`Expected ${C.length} arguments, but found ${D.length} instead.`);else{for(let R=0;R<D.length;R++){const H=Array.isArray(C)?C[R]:C.type,X=D[R];E.concat(R+1).checkSubtype(H,X.type)}if(E.errors.length===0)return new ao(f,g,M,D,O)}}if(T.length===1)u.errors.push(...E.errors);else{const C=(T.length?T:_.map(([D])=>D)).map(z3).join(" | "),M=[];for(let D=1;D<o.length;D++){const I=u.parse(o[D],1+M.length);if(!I)return null;M.push(us(I.type))}u.error(`Expected arguments of type ${C}, but found (${M.join(", ")}) instead.`)}return null}static register(o,u){ao.definitions=u;for(const f in u)o[f]=ao}}function z3(m){return Array.isArray(m)?`(${m.map(us).join(", ")})`:`(${us(m.type)}...)`}class Dh{constructor(o,u,f){this.type=ku,this.locale=f,this.caseSensitive=o,this.diacriticSensitive=u}static parse(o,u){if(o.length!==2)return u.error("Expected one argument.");const f=o[1];if(typeof f!="object"||Array.isArray(f))return u.error("Collator options argument must be an object.");const y=f["case-sensitive"]===void 0?u.parse(!1,1,In):u.parseObjectValue(f["case-sensitive"],1,"case-sensitive",In);if(!y)return null;const g=f["diacritic-sensitive"]===void 0?u.parse(!1,1,In):u.parseObjectValue(f["diacritic-sensitive"],1,"diacritic-sensitive",In);if(!g)return null;let _=null;return f.locale&&(_=u.parseObjectValue(f.locale,1,"locale",Zn),!_)?null:new Dh(y,g,_)}evaluate(o){return new Ox(this.caseSensitive.evaluate(o),this.diacriticSensitive.evaluate(o),this.locale?this.locale.evaluate(o):null)}eachChild(o){o(this.caseSensitive),o(this.diacriticSensitive),this.locale&&o(this.locale)}outputDefined(){return!1}serialize(){const o={};return o["case-sensitive"]=this.caseSensitive.serialize(),o["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(o.locale=this.locale.serialize()),["collator",o]}}function PS(m,o,u=0,f=m.length-1,y=L3){for(;f>u;){if(f-u>600){const E=f-u+1,O=o-u+1,C=Math.log(E),M=.5*Math.exp(2*C/3),D=.5*Math.sqrt(C*M*(E-M)/E)*(O-E/2<0?-1:1);PS(m,o,Math.max(u,Math.floor(o-O*M/E+D)),Math.min(f,Math.floor(o+(E-O)*M/E+D)),y)}const g=m[o];let _=u,T=f;for(jg(m,u,o),y(m[f],g)>0&&jg(m,u,f);_<T;){for(jg(m,_,T),_++,T--;y(m[_],g)<0;)_++;for(;y(m[T],g)>0;)T--}y(m[u],g)===0?jg(m,u,T):(T++,jg(m,T,f)),T<=o&&(u=T+1),o<=T&&(f=T-1)}}function jg(m,o,u){const f=m[o];m[o]=m[u],m[u]=f}function L3(m,o){return m<o?-1:m>o?1:0}function F3(m){let o=0;for(let u,f,y=0,g=m.length,_=g-1;y<g;_=y++)u=m[y],f=m[_],o+=(f.x-u.x)*(u.y+f.y);return o}function Ng(m,o){m[0]=Math.min(m[0],o[0]),m[1]=Math.min(m[1],o[1]),m[2]=Math.max(m[2],o[0]),m[3]=Math.max(m[3],o[1])}function Sg(m,o){return!(m[0]<=o[0]||m[2]>=o[2]||m[1]<=o[1]||m[3]>=o[3])}function B3(m,o,u){const f=m[0]-o[0],y=m[1]-o[1],g=m[0]-u[0],_=m[1]-u[1];return f*_-g*y==0&&f*g<=0&&y*_<=0}function zh(m,o,u=!1){let f=!1;for(let T=0,E=o.length;T<E;T++){const O=o[T];for(let C=0,M=O.length,D=M-1;C<M;D=C++){const I=O[D],R=O[C];if(B3(m,I,R))return u;(g=I)[1]>(y=m)[1]!=(_=R)[1]>y[1]&&y[0]<(_[0]-g[0])*(y[1]-g[1])/(_[1]-g[1])+g[0]&&(f=!f)}}var y,g,_;return f}function Lh(m,o,u,f){const y=f[0]-u[0],g=f[1]-u[1],_=(m[0]-u[0])*g-y*(m[1]-u[1]),T=(o[0]-u[0])*g-y*(o[1]-u[1]);return _>0&&T<0||_<0&&T>0}function Dx(m,o,u,f){return(y=[f[0]-u[0],f[1]-u[1]])[0]*(g=[o[0]-m[0],o[1]-m[1]])[1]-y[1]*g[0]!=0&&!(!Lh(m,o,u,f)||!Lh(u,f,m,o));var y,g}const Od=8192;function X_(m,o){const u=(180+m[0])/360,f=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+m[1]*Math.PI/360)))/360,y=Math.pow(2,o.z);return[Math.round(u*y*Od),Math.round(f*y*Od)]}function $3(m,o){for(let u=0;u<o.length;u++)if(zh(m,o[u]))return!0;return!1}function V3(m,o,u){for(const f of u)for(let y=0,g=f.length,_=g-1;y<g;_=y++)if(Dx(m,o,f[_],f[y]))return!0;return!1}function ES(m,o){for(let u=0;u<m.length;++u)if(!zh(m[u],o))return!1;for(let u=0;u<m.length-1;++u)if(V3(m[u],m[u+1],o))return!1;return!0}function U3(m,o){for(let u=0;u<o.length;u++)if(ES(m,o[u]))return!0;return!1}function Rd(m,o,u){const f=[];for(let y=0;y<m.length;y++){const g=[];for(let _=0;_<m[y].length;_++){const T=X_(m[y][_],u);Ng(o,T),g.push(T)}f.push(g)}return f}function mn(m,o,u){const f=[];for(let y=0;y<m.length;y++){const g=Rd(m[y],o,u);f.push(g)}return f}function Cr(m,o,u,f){if(m[0]<u[0]||m[0]>u[2]){const y=.5*f;let g=m[0]-u[0]>y?-f:u[0]-m[0]>y?f:0;g===0&&(g=m[0]-u[2]>y?-f:u[2]-m[0]>y?f:0),m[0]+=g}Ng(o,m)}function zx(m,o,u,f){const y=Math.pow(2,f.z)*Od,g=[f.x*Od,f.y*Od],_=[];if(!m)return _;for(const T of m)for(const E of T){const O=[E.x+g[0],E.y+g[1]];Cr(O,o,u,y),_.push(O)}return _}function Kr(m,o,u,f){const y=Math.pow(2,f.z)*Od,g=[f.x*Od,f.y*Od],_=[];if(!m)return _;for(const E of m){const O=[];for(const C of E){const M=[C.x+g[0],C.y+g[1]];Ng(o,M),O.push(M)}_.push(O)}if(o[2]-o[0]<=y/2){(T=o)[0]=T[1]=1/0,T[2]=T[3]=-1/0;for(const E of _)for(const O of E)Cr(O,o,u,y)}var T;return _}class Ou{constructor(o,u){this.type=In,this.geojson=o,this.geometries=u}static parse(o,u){if(o.length!==2)return u.error(`'within' expression requires exactly one argument, but found ${o.length-1} instead.`);if(uc(o[1])){const f=o[1];if(f.type==="FeatureCollection")for(let y=0;y<f.features.length;++y){const g=f.features[y].geometry.type;if(g==="Polygon"||g==="MultiPolygon")return new Ou(f,f.features[y].geometry)}else if(f.type==="Feature"){const y=f.geometry.type;if(y==="Polygon"||y==="MultiPolygon")return new Ou(f,f.geometry)}else if(f.type==="Polygon"||f.type==="MultiPolygon")return new Ou(f,f)}return u.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(o){if(o.geometry()!=null&&o.canonicalID()!=null){if(o.geometryType()==="Point")return function(u,f){const y=[1/0,1/0,-1/0,-1/0],g=[1/0,1/0,-1/0,-1/0],_=u.canonicalID();if(!_)return!1;if(f.type==="Polygon"){const T=Rd(f.coordinates,g,_),E=zx(u.geometry(),y,g,_);if(!Sg(y,g))return!1;for(const O of E)if(!zh(O,T))return!1}if(f.type==="MultiPolygon"){const T=mn(f.coordinates,g,_),E=zx(u.geometry(),y,g,_);if(!Sg(y,g))return!1;for(const O of E)if(!$3(O,T))return!1}return!0}(o,this.geometries);if(o.geometryType()==="LineString")return function(u,f){const y=[1/0,1/0,-1/0,-1/0],g=[1/0,1/0,-1/0,-1/0],_=u.canonicalID();if(!_)return!1;if(f.type==="Polygon"){const T=Rd(f.coordinates,g,_),E=Kr(u.geometry(),y,g,_);if(!Sg(y,g))return!1;for(const O of E)if(!ES(O,T))return!1}if(f.type==="MultiPolygon"){const T=mn(f.coordinates,g,_),E=Kr(u.geometry(),y,g,_);if(!Sg(y,g))return!1;for(const O of E)if(!U3(O,T))return!1}return!0}(o,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}const Qm={kilometers:1,miles:1e3/1609.344,nauticalmiles:1e3/1852,meters:1e3,metres:1e3,yards:1e3/.9144,feet:1e3/.3048,inches:1e3/.0254},Gr=1/298.257223563,J_=Gr*(2-Gr),Fh=Math.PI/180;class ef{static fromTile(o,u,f){const y=Math.PI*(1-2*(o+.5)/Math.pow(2,u)),g=Math.atan(.5*(Math.exp(y)-Math.exp(-y)))/Fh;return new ef(g,f)}static get units(){return Qm}constructor(o,u){if(o===void 0)throw new Error("No latitude given.");if(u&&!Qm[u])throw new Error(`Unknown unit ${u}. Use one of: ${Object.keys(Qm).join(", ")}`);const f=6378.137*Fh*(u?Qm[u]:1),y=Math.cos(o*Fh),g=1/(1-J_*(1-y*y)),_=Math.sqrt(g);this.kx=f*_*y,this.ky=f*_*g*(1-J_)}distance(o,u){const f=ss(o[0]-u[0])*this.kx,y=(o[1]-u[1])*this.ky;return Math.sqrt(f*f+y*y)}bearing(o,u){const f=ss(u[0]-o[0])*this.kx;return Math.atan2(f,(u[1]-o[1])*this.ky)/Fh}destination(o,u,f){const y=f*Fh;return this.offset(o,Math.sin(y)*u,Math.cos(y)*u)}offset(o,u,f){return[o[0]+u/this.kx,o[1]+f/this.ky]}lineDistance(o){let u=0;for(let f=0;f<o.length-1;f++)u+=this.distance(o[f],o[f+1]);return u}area(o){let u=0;for(let f=0;f<o.length;f++){const y=o[f];for(let g=0,_=y.length,T=_-1;g<_;T=g++)u+=ss(y[g][0]-y[T][0])*(y[g][1]+y[T][1])*(f?-1:1)}return Math.abs(u)/2*this.kx*this.ky}along(o,u){let f=0;if(u<=0)return o[0];for(let y=0;y<o.length-1;y++){const g=o[y],_=o[y+1],T=this.distance(g,_);if(f+=T,f>u)return tf(g,_,(u-(f-T))/T)}return o[o.length-1]}pointToSegmentDistance(o,u,f){let[y,g]=u,_=ss(f[0]-y)*this.kx,T=(f[1]-g)*this.ky;if(_!==0||T!==0){const E=(ss(o[0]-y)*this.kx*_+(o[1]-g)*this.ky*T)/(_*_+T*T);E>1?(y=f[0],g=f[1]):E>0&&(y+=_/this.kx*E,g+=T/this.ky*E)}return _=ss(o[0]-y)*this.kx,T=(o[1]-g)*this.ky,Math.sqrt(_*_+T*T)}pointOnLine(o,u){let f=1/0,y=o[0][0],g=o[0][1],_=0,T=0;for(let E=0;E<o.length-1;E++){let O=o[E][0],C=o[E][1],M=ss(o[E+1][0]-O)*this.kx,D=(o[E+1][1]-C)*this.ky,I=0;M===0&&D===0||(I=(ss(u[0]-O)*this.kx*M+(u[1]-C)*this.ky*D)/(M*M+D*D),I>1?(O=o[E+1][0],C=o[E+1][1]):I>0&&(O+=M/this.kx*I,C+=D/this.ky*I)),M=ss(u[0]-O)*this.kx,D=(u[1]-C)*this.ky;const R=M*M+D*D;R<f&&(f=R,y=O,g=C,_=E,T=I)}return{point:[y,g],index:_,t:Math.max(0,Math.min(1,T))}}lineSlice(o,u,f){let y=this.pointOnLine(f,o),g=this.pointOnLine(f,u);if(y.index>g.index||y.index===g.index&&y.t>g.t){const O=y;y=g,g=O}const _=[y.point],T=y.index+1,E=g.index;!Q_(f[T],_[0])&&T<=E&&_.push(f[T]);for(let O=T+1;O<=E;O++)_.push(f[O]);return Q_(f[E],g.point)||_.push(g.point),_}lineSliceAlong(o,u,f){let y=0;const g=[];for(let _=0;_<f.length-1;_++){const T=f[_],E=f[_+1],O=this.distance(T,E);if(y+=O,y>o&&g.length===0&&g.push(tf(T,E,(o-(y-O))/O)),y>=u)return g.push(tf(T,E,(u-(y-O))/O)),g;y>o&&g.push(E)}return g}bufferPoint(o,u){const f=u/this.ky,y=u/this.kx;return[o[0]-y,o[1]-f,o[0]+y,o[1]+f]}bufferBBox(o,u){const f=u/this.ky,y=u/this.kx;return[o[0]-y,o[1]-f,o[2]+y,o[3]+f]}insideBBox(o,u){return ss(o[0]-u[0])>=0&&ss(o[0]-u[2])<=0&&o[1]>=u[1]&&o[1]<=u[3]}}function Q_(m,o){return m[0]===o[0]&&m[1]===o[1]}function tf(m,o,u){const f=ss(o[0]-m[0]);return[m[0]+f*u,m[1]+(o[1]-m[1])*u]}function ss(m){for(;m<-180;)m+=360;for(;m>180;)m-=360;return m}class Cg{constructor(o=[],u=(f,y)=>f<y?-1:f>y?1:0){if(this.data=o,this.length=this.data.length,this.compare=u,this.length>0)for(let f=(this.length>>1)-1;f>=0;f--)this._down(f)}push(o){this.data.push(o),this._up(this.length++)}pop(){if(this.length===0)return;const o=this.data[0],u=this.data.pop();return--this.length>0&&(this.data[0]=u,this._down(0)),o}peek(){return this.data[0]}_up(o){const{data:u,compare:f}=this,y=u[o];for(;o>0;){const g=o-1>>1,_=u[g];if(f(y,_)>=0)break;u[o]=_,o=g}u[o]=y}_down(o){const{data:u,compare:f}=this,y=this.length>>1,g=u[o];for(;o<y;){let _=1+(o<<1);const T=_+1;if(T<this.length&&f(u[T],u[_])<0&&(_=T),f(u[_],g)>=0)break;u[o]=u[_],o=_}u[o]=g}}var Wt=8192;function Lx(m,o){return o.dist-m.dist}const Ru=100,Ta=50;function MS(m){const o=[1/0,1/0,-1/0,-1/0];if(o.length!==m.length)return!1;for(let u=0;u<o.length;u++)if(o[u]!==m[u])return!1;return!0}function Fx(m){return m[1]-m[0]+1}function Du(m,o){const u=m[1]>=m[0]&&m[1]<o;return u||console.warn("Distance Expression: Index is out of range"),u}function rf(m,o){if(m[0]>m[1])return[null,null];const u=Fx(m);if(o){if(u===2)return[m,null];const f=Math.floor(u/2);return[[m[0],m[0]+f],[m[0]+f,m[1]]]}{if(u===1)return[m,null];const f=Math.floor(u/2)-1;return[[m[0],m[0]+f],[m[0]+f+1,m[1]]]}}function Dd(m,o){const u=[1/0,1/0,-1/0,-1/0];if(!Du(o,m.length))return u;for(let f=o[0];f<=o[1];++f)Ng(u,m[f]);return u}function nf(m){const o=[1/0,1/0,-1/0,-1/0];for(let u=0;u<m.length;++u)for(let f=0;f<m[u].length;++f)Ng(o,m[u][f]);return o}function sf(m,o,u){if(MS(m)||MS(o))return NaN;let f=0,y=0;return m[2]<o[0]&&(f=o[0]-m[2]),m[0]>o[2]&&(f=m[0]-o[2]),m[1]>o[3]&&(y=m[1]-o[3]),m[3]<o[1]&&(y=o[1]-m[3]),u.distance([0,0],[f,y])}function G3(m){return 360*m-180}function H3(m){return 360/Math.PI*Math.atan(Math.exp((180-360*m)*Math.PI/180))-90}function e1(m,o){const u=Math.pow(2,o.z),f=(m.y/Wt+o.y)/u;return[G3((m.x/Wt+o.x)/u),H3(f)]}function IS(m,o){const u=[];for(let f=0;f<m.length;++f)u.push(e1(m[f],o));return u}function OS(m,o,u){const f=u.pointOnLine(o,m).point;return u.distance(m,f)}function RS(m,o,u,f,y){const g=u.slice(f[0],f[1]+1);let _=1/0;for(let T=o[0];T<=o[1];++T)if((_=Math.min(_,OS(m[T],g,y)))===0)return 0;return _}function Bx(m,o,u,f,y){const g=Math.min(y.pointToSegmentDistance(m,u,f),y.pointToSegmentDistance(o,u,f)),_=Math.min(y.pointToSegmentDistance(u,m,o),y.pointToSegmentDistance(f,m,o));return Math.min(g,_)}function q3(m,o,u,f,y){if(!Du(o,m.length)||!Du(f,u.length))return NaN;let g=1/0;for(let _=o[0];_<o[1];++_)for(let T=f[0];T<f[1];++T){if(Dx(m[_],m[_+1],u[T],u[T+1]))return 0;g=Math.min(g,Bx(m[_],m[_+1],u[T],u[T+1],y))}return g}function Bh(m,o,u,f,y){if(!Du(o,m.length)||!Du(f,u.length))return NaN;let g=1/0;for(let _=o[0];_<=o[1];++_)for(let T=f[0];T<=f[1];++T)if((g=Math.min(g,y.distance(m[_],u[T])))===0)return g;return g}function W3(m,o,u){if(zh(m,o,!0))return 0;let f=1/0;for(const y of o){const g=y.length;if(g<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(y[0]!==y[g-1]&&(f=Math.min(f,u.pointToSegmentDistance(m,y[g-1],y[0])))===0||(f=Math.min(f,OS(m,y,u)))===0)return f}return f}function K3(m,o,u,f){if(!Du(o,m.length))return NaN;for(let g=o[0];g<=o[1];++g)if(zh(m[g],u,!0))return 0;let y=1/0;for(let g=o[0];g<o[1];++g)for(const _ of u)for(let T=0,E=_.length,O=E-1;T<E;O=T++){if(Dx(m[g],m[g+1],_[O],_[T]))return 0;y=Math.min(y,Bx(m[g],m[g+1],_[O],_[T],f))}return y}function $x(m,o){for(const u of m)for(let f=0;f<=u.length-1;++f)if(zh(u[f],o,!0))return!0;return!1}function DS(m,o,u,f=1/0){const y=nf(m),g=nf(o);if(f!==1/0&&sf(y,g,u)>=f)return f;if(Sg(y,g)){if($x(m,o))return 0}else if($x(o,m))return 0;let _=f;for(const T of m)for(let E=0,O=T.length,C=O-1;E<O;C=E++)for(const M of o)for(let D=0,I=M.length,R=I-1;D<I;R=D++){if(Dx(T[C],T[E],M[R],M[D]))return 0;_=Math.min(_,Bx(T[C],T[E],M[R],M[D],u))}return _}function Ag(m,o,u,f,y,g,_){if(g===null||_===null)return;const T=sf(Dd(f,g),Dd(y,_),u);T<o&&m.push({dist:T,range1:g,range2:_})}function dc(m,o,u,f,y=1/0){let g=Math.min(f.distance(m[0],u[0][0]),y);if(g===0)return g;const _=new Cg([{dist:0,range1:[0,m.length-1],range2:[0,0]}],Lx),T=o?Ta:Ru,E=nf(u);for(;_.length;){const O=_.pop();if(O.dist>=g)continue;const C=O.range1;if(Fx(C)<=T){if(!Du(C,m.length))return NaN;if(o){const M=K3(m,C,u,f);if((g=Math.min(g,M))===0)return g}else for(let M=C[0];M<=C[1];++M){const D=W3(m[M],u,f);if((g=Math.min(g,D))===0)return g}}else{const M=rf(C,o);if(M[0]!==null){const D=sf(Dd(m,M[0]),E,f);D<g&&_.push({dist:D,range1:M[0],range2:[0,0]})}if(M[1]!==null){const D=sf(Dd(m,M[1]),E,f);D<g&&_.push({dist:D,range1:M[1],range2:[0,0]})}}}return g}function t1(m,o,u,f,y,g=1/0){let _=Math.min(g,y.distance(m[0],u[0]));if(_===0)return _;const T=new Cg([{dist:0,range1:[0,m.length-1],range2:[0,u.length-1]}],Lx),E=o?Ta:Ru,O=f?Ta:Ru;for(;T.length;){const C=T.pop();if(C.dist>=_)continue;const M=C.range1,D=C.range2;if(Fx(M)<=E&&Fx(D)<=O){if(!Du(M,m.length)||!Du(D,u.length))return NaN;if(o&&f?_=Math.min(_,q3(m,M,u,D,y)):o||f?o&&!f?_=Math.min(_,RS(u,D,m,M,y)):!o&&f&&(_=Math.min(_,RS(m,M,u,D,y))):_=Math.min(_,Bh(m,M,u,D,y)),_===0)return _}else{const I=rf(M,o),R=rf(D,f);Ag(T,_,y,m,u,I[0],R[0]),Ag(T,_,y,m,u,I[0],R[1]),Ag(T,_,y,m,u,I[1],R[0]),Ag(T,_,y,m,u,I[1],R[1])}}return _}function Vx(m,o,u,f,y=1/0){let g=y;const _=Dd(m,[0,m.length-1]);for(const T of u)if(!(g!==1/0&&sf(_,Dd(T,[0,T.length-1]),f)>=g)&&(g=Math.min(g,t1(m,o,T,!0,f,g)),g===0))return g;return g}function Tg(m,o,u,f,y=1/0){let g=y;const _=Dd(m,[0,m.length-1]);for(const T of u){if(g!==1/0&&sf(_,nf(T),f)>=g)continue;const E=dc(m,o,T,f,g);if(isNaN(E))return E;if((g=Math.min(g,E))===0)return g}return g}function Ux(m){return m==="Point"||m==="MultiPoint"||m==="LineString"||m==="MultiLineString"||m==="Polygon"||m==="MultiPolygon"}class zd{constructor(o,u){this.type=vr,this.geojson=o,this.geometries=u}static parse(o,u){if(o.length!==2)return u.error(`'distance' expression requires either one argument, but found ' ${o.length-1} instead.`);if(uc(o[1])){const f=o[1];if(f.type==="FeatureCollection"){for(let y=0;y<f.features.length;++y)if(Ux(f.features[y].geometry.type))return new zd(f,f.features[y].geometry)}else if(f.type==="Feature"){if(Ux(f.geometry.type))return new zd(f,f.geometry)}else if(Ux(f.type))return new zd(f,f)}return u.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(o){const u=o.geometry(),f=o.canonicalID();if(u!=null&&f!=null){if(o.geometryType()==="Point")return function(y,g,_){const T=[];for(const O of y)for(const C of O)T.push(e1(C,g));const E=new ef(T[0][1],"meters");return _.type==="Point"||_.type==="MultiPoint"||_.type==="LineString"?t1(T,!1,_.type==="Point"?[_.coordinates]:_.coordinates,_.type==="LineString",E):_.type==="MultiLineString"?Vx(T,!1,_.coordinates,E):_.type==="Polygon"||_.type==="MultiPolygon"?Tg(T,!1,_.type==="Polygon"?[_.coordinates]:_.coordinates,E):null}(u,f,this.geometries);if(o.geometryType()==="LineString")return function(y,g,_){const T=[];for(const O of y){const C=[];for(const M of O)C.push(e1(M,g));T.push(C)}const E=new ef(T[0][0][1],"meters");if(_.type==="Point"||_.type==="MultiPoint"||_.type==="LineString")return Vx(_.type==="Point"?[_.coordinates]:_.coordinates,_.type==="LineString",T,E);if(_.type==="MultiLineString"){let O=1/0;for(let C=0;C<_.coordinates.length;C++){const M=Vx(_.coordinates[C],!0,T,E,O);if(isNaN(M))return M;if((O=Math.min(O,M))===0)return O}return O}if(_.type==="Polygon"||_.type==="MultiPolygon"){let O=1/0;for(let C=0;C<T.length;C++){const M=Tg(T[C],!0,_.type==="Polygon"?[_.coordinates]:_.coordinates,E,O);if(isNaN(M))return M;if((O=Math.min(O,M))===0)return O}return O}return null}(u,f,this.geometries);if(o.geometryType()==="Polygon")return function(y,g,_){const T=[];for(const O of function(C,M){const D=C.length;if(D<=1)return[C];const I=[];let R,H;for(let X=0;X<D;X++){const J=F3(C[X]);J!==0&&(C[X].area=Math.abs(J),H===void 0&&(H=J<0),H===J<0?(R&&I.push(R),R=[C[X]]):R.push(C[X]))}return R&&I.push(R),I}(y)){const C=[];for(let M=0;M<O.length;++M)C.push(IS(O[M],g));T.push(C)}const E=new ef(T[0][0][0][1],"meters");if(_.type==="Point"||_.type==="MultiPoint"||_.type==="LineString")return Tg(_.type==="Point"?[_.coordinates]:_.coordinates,_.type==="LineString",T,E);if(_.type==="MultiLineString"){let O=1/0;for(let C=0;C<_.coordinates.length;C++){const M=Tg(_.coordinates[C],!0,T,E,O);if(isNaN(M))return M;if((O=Math.min(O,M))===0)return O}return O}return _.type==="Polygon"||_.type==="MultiPolygon"?function(O,C,M){let D=1/0;for(const I of O)for(const R of C){const H=DS(I,R,M,D);if(isNaN(H))return H;if((D=Math.min(D,H))===0)return D}return D}(_.type==="Polygon"?[_.coordinates]:_.coordinates,T,E):null}(u,f,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}function Gx(m,o){switch(m){case"string":return ca(o);case"number":return+o;case"boolean":return!!o;case"color":return Xn.parse(o);case"formatted":return Ha.fromString(ca(o));case"resolvedImage":return qa.build(ca(o))}return o}function r1(m,o,u,f){return f!==void 0&&(m=f*Math.round(m/f)),o!==void 0&&m<o&&(m=o),u!==void 0&&m>u&&(m=u),m}class $h{constructor(o,u,f){this.type=o,this.key=u,this.scope=f}static parse(o,u){let f=u.expectedType;if(f==null&&(f=Fn),o.length<2||o.length>3)return u.error("Invalid number of arguments for 'config' expression.");const y=u.parse(o[1],1);if(!(y instanceof Eu))return u.error("Key name of 'config' expression must be a string literal.");if(o.length>=3){const g=u.parse(o[2],2);return g instanceof Eu?new $h(f,ca(y.value),ca(g.value)):u.error("Scope of 'config' expression must be a string literal.")}return new $h(f,ca(y.value))}evaluate(o){const u=[this.key,this.scope,o.scope].filter(Boolean).join(""),f=o.getConfig(u);if(!f)return null;const{type:y,value:g,values:_,minValue:T,maxValue:E,stepValue:O}=f,C=f.default.evaluate(o);let M=C;if(g){const D=o.scope;o.scope=(D||"").split("").slice(1).join(""),M=g.evaluate(o),o.scope=D}return y&&(M=Gx(y,M)),M===void 0||T===void 0&&E===void 0&&O===void 0||(typeof M=="number"?M=r1(M,T,E,O):Array.isArray(M)&&(M=M.map(D=>typeof D=="number"?r1(D,T,E,O):D))),g!==void 0&&M!==void 0&&_&&!_.includes(M)&&(M=C,y&&(M=Gx(y,M))),(y&&y!==this.type||M!==void 0&&Es(M)!==this.type)&&(M=Gx(this.type.kind,M)),M}eachChild(){}outputDefined(){return!1}serialize(){const o=["config",this.key];return this.scope&&o.concat(this.key),o}}function af(m){if(m instanceof ao&&(m.name==="get"&&m.args.length===1||m.name==="feature-state"||m.name==="has"&&m.args.length===1||m.name==="properties"||m.name==="geometry-type"||m.name==="id"||/^filter-/.test(m.name))||m instanceof Ou||m instanceof zd)return!1;let o=!0;return m.eachChild(u=>{o&&!af(u)&&(o=!1)}),o}function kg(m){if(m instanceof ao&&m.name==="feature-state")return!1;let o=!0;return m.eachChild(u=>{o&&!kg(u)&&(o=!1)}),o}function Pg(m){if(m instanceof $h)return new Set([m.key]);let o=new Set;return m.eachChild(u=>{o=new Set([...o,...Pg(u)])}),o}function zu(m,o){if(m instanceof ao&&o.indexOf(m.name)>=0)return!1;let u=!0;return m.eachChild(f=>{u&&!zu(f,o)&&(u=!1)}),u}class Vh{constructor(o,u){this.type=u.type,this.name=o,this.boundExpression=u}static parse(o,u){if(o.length!==2||typeof o[1]!="string")return u.error("'var' expression requires exactly one string literal argument.");const f=o[1];return u.scope.has(f)?new Vh(f,u.scope.get(f)):u.error(`Unknown variable "${f}". Make sure "${f}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(o){return this.boundExpression.evaluate(o)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class of{constructor(o,u=[],f,y=new Ix,g=[],_,T){this.registry=o,this.path=u,this.key=u.map(E=>typeof E=="string"?`['${E}']`:`[${E}]`).join(""),this.scope=y,this.errors=g,this.expectedType=f,this._scope=_,this.options=T}parse(o,u,f,y,g={}){return u||f?this.concat(u,null,f,y)._parse(o,g):this._parse(o,g)}parseObjectValue(o,u,f,y,g,_={}){return this.concat(u,f,y,g)._parse(o,_)}_parse(o,u){function f(y,g,_){return _==="assert"?new al(g,[y]):_==="coerce"?new Iu(g,[y]):y}if(o!==null&&typeof o!="string"&&typeof o!="boolean"&&typeof o!="number"||(o=["literal",o]),Array.isArray(o)){if(o.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const y=typeof o[0]=="string"?this.registry[o[0]]:void 0;if(y){let g=y.parse(o,this);if(!g)return null;if(this.expectedType){const _=this.expectedType,T=g.type;if(_.kind!=="string"&&_.kind!=="number"&&_.kind!=="boolean"&&_.kind!=="object"&&_.kind!=="array"||T.kind!=="value")if(_.kind!=="color"&&_.kind!=="formatted"&&_.kind!=="resolvedImage"||T.kind!=="value"&&T.kind!=="string"){if(this.checkSubtype(_,T))return null}else g=f(g,_,u.typeAnnotation||"coerce");else g=f(g,_,u.typeAnnotation||"assert")}if(!(g instanceof Eu)&&g.type.kind!=="resolvedImage"&&Hx(g)){const _=new Rx(this._scope,this.options);try{g=new Eu(g.type,g.evaluate(_))}catch(T){return this.error(T.message),null}}return g}return Iu.parse(["to-array",o],this)}return this.error(o===void 0?"'undefined' value invalid. Use null instead.":typeof o=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof o} instead.`)}concat(o,u,f,y){let g=typeof o=="number"?this.path.concat(o):this.path;g=typeof u=="string"?g.concat(u):g;const _=y?this.scope.concat(y):this.scope;return new of(this.registry,g,f||null,_,this.errors,this._scope,this.options)}error(o,...u){const f=`${this.key}${u.map(y=>`[${y}]`).join("")}`;this.errors.push(new zl(f,o))}checkSubtype(o,u){const f=Ym(o,u);return f&&this.error(f),f}}var n1=of;function Hx(m){if(m instanceof Vh)return Hx(m.boundExpression);if(m instanceof ao&&m.name==="error"||m instanceof Dh||m instanceof Ou||m instanceof zd||m instanceof $h)return!1;const o=m instanceof Iu||m instanceof al;let u=!0;return m.eachChild(f=>{u=o?u&&Hx(f):u&&f instanceof Eu}),!!u&&af(m)&&zu(m,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])}function Eg(m,o){const u=m.length-1;let f,y,g=0,_=u,T=0;for(;g<=_;)if(T=Math.floor((g+_)/2),f=m[T],y=m[T+1],f<=o){if(T===u||o<y)return T;g=T+1}else{if(!(f>o))throw new ps("Input is not a number.");_=T-1}return 0}class Xc{constructor(o,u,f){this.type=o,this.input=u,this.labels=[],this.outputs=[];for(const[y,g]of f)this.labels.push(y),this.outputs.push(g)}static parse(o,u){if(o.length-1<4)return u.error(`Expected at least 4 arguments, but found only ${o.length-1}.`);if((o.length-1)%2!=0)return u.error("Expected an even number of arguments.");const f=u.parse(o[1],1,vr);if(!f)return null;const y=[];let g=null;u.expectedType&&u.expectedType.kind!=="value"&&(g=u.expectedType);for(let _=1;_<o.length;_+=2){const T=_===1?-1/0:o[_],E=o[_+1],O=_,C=_+1;if(typeof T!="number")return u.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',O);if(y.length&&y[y.length-1][0]>=T)return u.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',O);const M=u.parse(E,C,g);if(!M)return null;g=g||M.type,y.push([T,M])}return new Xc(g,f,y)}evaluate(o){const u=this.labels,f=this.outputs;if(u.length===1)return f[0].evaluate(o);const y=this.input.evaluate(o);if(y<=u[0])return f[0].evaluate(o);const g=u.length;return y>=u[g-1]?f[g-1].evaluate(o):f[Eg(u,y)].evaluate(o)}eachChild(o){o(this.input);for(const u of this.outputs)o(u)}outputDefined(){return this.outputs.every(o=>o.outputDefined())}serialize(){const o=["step",this.input.serialize()];for(let u=0;u<this.labels.length;u++)u>0&&o.push(this.labels[u]),o.push(this.outputs[u].serialize());return o}}const jn=.95047,zS=1.08883,LS=4/29,lf=6/29,i1=3*lf*lf,Z3=lf*lf*lf,Ai=Math.PI/180,Y3=180/Math.PI;function s1(m){return m>Z3?Math.pow(m,1/3):m/i1+LS}function a1(m){return m>lf?m*m*m:i1*(m-LS)}function o1(m){return 255*(m<=.0031308?12.92*m:1.055*Math.pow(m,1/2.4)-.055)}function l1(m){return(m/=255)<=.04045?m/12.92:Math.pow((m+.055)/1.055,2.4)}function FS(m){const o=l1(m.r),u=l1(m.g),f=l1(m.b),y=s1((.4124564*o+.3575761*u+.1804375*f)/jn),g=s1((.2126729*o+.7151522*u+.072175*f)/1);return{l:116*g-16,a:500*(y-g),b:200*(g-s1((.0193339*o+.119192*u+.9503041*f)/zS)),alpha:m.a}}function BS(m){let o=(m.l+16)/116,u=isNaN(m.a)?o:o+m.a/500,f=isNaN(m.b)?o:o-m.b/200;return o=1*a1(o),u=jn*a1(u),f=zS*a1(f),new Xn(o1(3.2404542*u-1.5371385*o-.4985314*f),o1(-.969266*u+1.8760108*o+.041556*f),o1(.0556434*u-.2040259*o+1.0572252*f),m.alpha)}function X3(m,o,u){const f=o-m;return m+u*(f>180||f<-180?f-360*Math.round(f/360):f)}const Mg={forward:FS,reverse:BS,interpolate:function(m,o,u){return{l:Mr(m.l,o.l,u),a:Mr(m.a,o.a,u),b:Mr(m.b,o.b,u),alpha:Mr(m.alpha,o.alpha,u)}}},Ig={forward:function(m){const{l:o,a:u,b:f}=FS(m),y=Math.atan2(f,u)*Y3;return{h:y<0?y+360:y,c:Math.sqrt(u*u+f*f),l:o,alpha:m.a}},reverse:function(m){const o=m.h*Ai,u=m.c;return BS({l:m.l,a:Math.cos(o)*u,b:Math.sin(o)*u,alpha:m.alpha})},interpolate:function(m,o,u){return{h:X3(m.h,o.h,u),c:Mr(m.c,o.c,u),l:Mr(m.l,o.l,u),alpha:Mr(m.alpha,o.alpha,u)}}};var $S=Object.freeze({__proto__:null,hcl:Ig,lab:Mg});class ol{constructor(o,u,f,y,g){this.type=o,this.operator=u,this.interpolation=f,this.input=y,this.labels=[],this.outputs=[];for(const[_,T]of g)this.labels.push(_),this.outputs.push(T)}static interpolationFactor(o,u,f,y){let g=0;if(o.name==="exponential")g=c1(u,o.base,f,y);else if(o.name==="linear")g=c1(u,1,f,y);else if(o.name==="cubic-bezier"){const _=o.controlPoints;g=new St(_[0],_[1],_[2],_[3]).solve(c1(u,1,f,y))}return g}static parse(o,u){let[f,y,g,..._]=o;if(!Array.isArray(y)||y.length===0)return u.error("Expected an interpolation type expression.",1);if(y[0]==="linear")y={name:"linear"};else if(y[0]==="exponential"){const O=y[1];if(typeof O!="number")return u.error("Exponential interpolation requires a numeric base.",1,1);y={name:"exponential",base:O}}else{if(y[0]!=="cubic-bezier")return u.error(`Unknown interpolation type ${String(y[0])}`,1,0);{const O=y.slice(1);if(O.length!==4||O.some(C=>typeof C!="number"||C<0||C>1))return u.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);y={name:"cubic-bezier",controlPoints:O}}}if(o.length-1<4)return u.error(`Expected at least 4 arguments, but found only ${o.length-1}.`);if(o.length-1>3&&(o.length-1)%2!=0)return u.error("Expected an even number of arguments.");if(g=u.parse(g,2,vr),!g)return null;const T=[];let E=null;f==="interpolate-hcl"||f==="interpolate-lab"?E=Ga:u.expectedType&&u.expectedType.kind!=="value"&&(E=u.expectedType);for(let O=0;O<_.length;O+=2){const C=_[O],M=_[O+1],D=O+3,I=O+4;if(typeof C!="number")return u.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',D);if(T.length&&T[T.length-1][0]>=C)return u.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',D);const R=u.parse(M,I,E);if(!R)return null;E=E||R.type,T.push([C,R])}return E.kind==="number"||E.kind==="color"||E.kind==="array"&&E.itemType.kind==="number"&&typeof E.N=="number"?new ol(E,f,y,g,T):u.error(`Type ${us(E)} is not interpolatable.`)}evaluate(o){const u=this.labels,f=this.outputs;if(u.length===1)return f[0].evaluate(o);const y=this.input.evaluate(o);if(y<=u[0])return f[0].evaluate(o);const g=u.length;if(y>=u[g-1])return f[g-1].evaluate(o);const _=Eg(u,y),T=ol.interpolationFactor(this.interpolation,y,u[_],u[_+1]),E=f[_].evaluate(o),O=f[_+1].evaluate(o);return this.operator==="interpolate"?vg[this.type.kind.toLowerCase()](E,O,T):this.operator==="interpolate-hcl"?Ig.reverse(Ig.interpolate(Ig.forward(E),Ig.forward(O),T)):Mg.reverse(Mg.interpolate(Mg.forward(E),Mg.forward(O),T))}eachChild(o){o(this.input);for(const u of this.outputs)o(u)}outputDefined(){return this.outputs.every(o=>o.outputDefined())}serialize(){let o;o=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier",...this.interpolation.controlPoints];const u=[this.operator,o,this.input.serialize()];for(let f=0;f<this.labels.length;f++)u.push(this.labels[f],this.outputs[f].serialize());return u}}function c1(m,o,u,f){const y=f-u,g=m-u;return y===0?0:o===1?g/y:(Math.pow(o,g)-1)/(Math.pow(o,y)-1)}class qx{constructor(o,u){this.type=o,this.args=u}static parse(o,u){if(o.length<2)return u.error("Expectected at least one argument.");let f=null;const y=u.expectedType;y&&y.kind!=="value"&&(f=y);const g=[];for(const T of o.slice(1)){const E=u.parse(T,1+g.length,f,void 0,{typeAnnotation:"omit"});if(!E)return null;f=f||E.type,g.push(E)}const _=y&&g.some(T=>Ym(y,T.type));return new qx(_?Fn:f,g)}evaluate(o){let u,f=null,y=0;for(const g of this.args){if(y++,f=g.evaluate(o),f&&f instanceof qa&&!f.available&&(u||(u=f),f=null,y===this.args.length))return u;if(f!==null)break}return f}eachChild(o){this.args.forEach(o)}outputDefined(){return this.args.every(o=>o.outputDefined())}serialize(){const o=["coalesce"];return this.eachChild(u=>{o.push(u.serialize())}),o}}class Wx{constructor(o,u){this.type=u.type,this.bindings=[].concat(o),this.result=u}evaluate(o){return this.result.evaluate(o)}eachChild(o){for(const u of this.bindings)o(u[1]);o(this.result)}static parse(o,u){if(o.length<4)return u.error(`Expected at least 3 arguments, but found ${o.length-1} instead.`);const f=[];for(let g=1;g<o.length-1;g+=2){const _=o[g];if(typeof _!="string")return u.error(`Expected string, but found ${typeof _} instead.`,g);if(/[^a-zA-Z0-9_]/.test(_))return u.error("Variable names must contain only alphanumeric characters or '_'.",g);const T=u.parse(o[g+1],g+1);if(!T)return null;f.push([_,T])}const y=u.parse(o[o.length-1],o.length-1,u.expectedType,f);return y?new Wx(f,y):null}outputDefined(){return this.result.outputDefined()}serialize(){const o=["let"];for(const[u,f]of this.bindings)o.push(u,f.serialize());return o.push(this.result.serialize()),o}}class u1{constructor(o,u,f){this.type=o,this.index=u,this.input=f}static parse(o,u){if(o.length!==3)return u.error(`Expected 2 arguments, but found ${o.length-1} instead.`);const f=u.parse(o[1],1,vr),y=u.parse(o[2],2,Aa(u.expectedType||Fn));return f&&y?new u1(y.type.itemType,f,y):null}evaluate(o){const u=this.index.evaluate(o),f=this.input.evaluate(o);if(u<0)throw new ps(`Array index out of bounds: ${u} < 0.`);if(u>=f.length)throw new ps(`Array index out of bounds: ${u} > ${f.length-1}.`);if(u!==Math.floor(u))throw new ps(`Array index must be an integer, but found ${u} instead. Use at-interpolated to retrieve interpolated result with a fractional index.`);return f[u]}eachChild(o){o(this.index),o(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class d1{constructor(o,u,f){this.type=o,this.index=u,this.input=f}static parse(o,u){if(o.length!==3)return u.error(`Expected 2 arguments, but found ${o.length-1} instead.`);const f=u.parse(o[1],1,vr),y=u.parse(o[2],2,Aa(u.expectedType||Fn));return f&&y?new d1(y.type.itemType,f,y):null}evaluate(o){const u=this.index.evaluate(o),f=this.input.evaluate(o);if(u<0)throw new ps(`Array index out of bounds: ${u} < 0.`);if(u>f.length-1)throw new ps(`Array index out of bounds: ${u} > ${f.length-1}.`);if(u===Math.floor(u))return f[u];const y=Math.floor(u),g=Math.ceil(u),_=f[y],T=f[g];if(typeof _!="number"||typeof T!="number")throw new ps(`Cannot interpolate between non-number values at index ${u}.`);const E=u-y;return _*(1-E)+T*E}eachChild(o){o(this.index),o(this.input)}outputDefined(){return!1}serialize(){return["at-interpolated",this.index.serialize(),this.input.serialize()]}}class h1{constructor(o,u){this.type=In,this.needle=o,this.haystack=u}static parse(o,u){if(o.length!==3)return u.error(`Expected 2 arguments, but found ${o.length-1} instead.`);const f=u.parse(o[1],1,Fn),y=u.parse(o[2],2,Fn);return f&&y?Z_(f.type,[In,Zn,vr,Km,Fn])?new h1(f,y):u.error(`Expected first argument to be of type boolean, string, number or null, but found ${us(f.type)} instead`):null}evaluate(o){const u=this.needle.evaluate(o),f=this.haystack.evaluate(o);if(f==null)return!1;if(!Xm(u,["boolean","string","number","null"]))throw new ps(`Expected first argument to be of type boolean, string, number or null, but found ${us(Es(u))} instead.`);if(!Xm(f,["string","array"]))throw new ps(`Expected second argument to be of type array or string, but found ${us(Es(f))} instead.`);return f.indexOf(u)>=0}eachChild(o){o(this.needle),o(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class Kx{constructor(o,u,f){this.type=vr,this.needle=o,this.haystack=u,this.fromIndex=f}static parse(o,u){if(o.length<=2||o.length>=5)return u.error(`Expected 3 or 4 arguments, but found ${o.length-1} instead.`);const f=u.parse(o[1],1,Fn),y=u.parse(o[2],2,Fn);if(!f||!y)return null;if(!Z_(f.type,[In,Zn,vr,Km,Fn]))return u.error(`Expected first argument to be of type boolean, string, number or null, but found ${us(f.type)} instead`);if(o.length===4){const g=u.parse(o[3],3,vr);return g?new Kx(f,y,g):null}return new Kx(f,y)}evaluate(o){const u=this.needle.evaluate(o),f=this.haystack.evaluate(o);if(!Xm(u,["boolean","string","number","null"]))throw new ps(`Expected first argument to be of type boolean, string, number or null, but found ${us(Es(u))} instead.`);if(!Xm(f,["string","array"]))throw new ps(`Expected second argument to be of type array or string, but found ${us(Es(f))} instead.`);if(this.fromIndex){const y=this.fromIndex.evaluate(o);return f.indexOf(u,y)}return f.indexOf(u)}eachChild(o){o(this.needle),o(this.haystack),this.fromIndex&&o(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const o=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),o]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class m1{constructor(o,u,f,y,g,_){this.inputType=o,this.type=u,this.input=f,this.cases=y,this.outputs=g,this.otherwise=_}static parse(o,u){if(o.length<5)return u.error(`Expected at least 4 arguments, but found only ${o.length-1}.`);if(o.length%2!=1)return u.error("Expected an even number of arguments.");let f,y;u.expectedType&&u.expectedType.kind!=="value"&&(y=u.expectedType);const g={},_=[];for(let O=2;O<o.length-1;O+=2){let C=o[O];const M=o[O+1];Array.isArray(C)||(C=[C]);const D=u.concat(O);if(C.length===0)return D.error("Expected at least one branch label.");for(const R of C){if(typeof R!="number"&&typeof R!="string")return D.error("Branch labels must be numbers or strings.");if(typeof R=="number"&&Math.abs(R)>Number.MAX_SAFE_INTEGER)return D.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof R=="number"&&Math.floor(R)!==R)return D.error("Numeric branch labels must be integer values.");if(f){if(D.checkSubtype(f,Es(R)))return null}else f=Es(R);if(g[String(R)]!==void 0)return D.error("Branch labels must be unique.");g[String(R)]=_.length}const I=u.parse(M,O,y);if(!I)return null;y=y||I.type,_.push(I)}const T=u.parse(o[1],1,Fn);if(!T)return null;const E=u.parse(o[o.length-1],o.length-1,y);return E?T.type.kind!=="value"&&u.concat(1).checkSubtype(f,T.type)?null:new m1(f,y,T,g,_,E):null}evaluate(o){const u=this.input.evaluate(o);return(Es(u)===this.inputType&&this.outputs[this.cases[u]]||this.otherwise).evaluate(o)}eachChild(o){o(this.input),this.outputs.forEach(o),o(this.otherwise)}outputDefined(){return this.outputs.every(o=>o.outputDefined())&&this.otherwise.outputDefined()}serialize(){const o=["match",this.input.serialize()],u=Object.keys(this.cases).sort(),f=[],y={};for(const _ of u){const T=y[this.cases[_]];T===void 0?(y[this.cases[_]]=f.length,f.push([this.cases[_],[_]])):f[T][1].push(_)}const g=_=>this.inputType.kind==="number"?Number(_):_;for(const[_,T]of f)o.push(T.length===1?g(T[0]):T.map(g)),o.push(this.outputs[_].serialize());return o.push(this.otherwise.serialize()),o}}class f1{constructor(o,u,f){this.type=o,this.branches=u,this.otherwise=f}static parse(o,u){if(o.length<4)return u.error(`Expected at least 3 arguments, but found only ${o.length-1}.`);if(o.length%2!=0)return u.error("Expected an odd number of arguments.");let f;u.expectedType&&u.expectedType.kind!=="value"&&(f=u.expectedType);const y=[];for(let _=1;_<o.length-1;_+=2){const T=u.parse(o[_],_,In);if(!T)return null;const E=u.parse(o[_+1],_+1,f);if(!E)return null;y.push([T,E]),f=f||E.type}const g=u.parse(o[o.length-1],o.length-1,f);return g?new f1(f,y,g):null}evaluate(o){for(const[u,f]of this.branches)if(u.evaluate(o))return f.evaluate(o);return this.otherwise.evaluate(o)}eachChild(o){for(const[u,f]of this.branches)o(u),o(f);o(this.otherwise)}outputDefined(){return this.branches.every(([o,u])=>u.outputDefined())&&this.otherwise.outputDefined()}serialize(){const o=["case"];return this.eachChild(u=>{o.push(u.serialize())}),o}}class Zx{constructor(o,u,f,y){this.type=o,this.input=u,this.beginIndex=f,this.endIndex=y}static parse(o,u){if(o.length<=2||o.length>=5)return u.error(`Expected 3 or 4 arguments, but found ${o.length-1} instead.`);const f=u.parse(o[1],1,Fn),y=u.parse(o[2],2,vr);if(!f||!y)return null;if(!Z_(f.type,[Aa(Fn),Zn,Fn]))return u.error(`Expected first argument to be of type array or string, but found ${us(f.type)} instead`);if(o.length===4){const g=u.parse(o[3],3,vr);return g?new Zx(f.type,f,y,g):null}return new Zx(f.type,f,y)}evaluate(o){const u=this.input.evaluate(o),f=this.beginIndex.evaluate(o);if(!Xm(u,["string","array"]))throw new ps(`Expected first argument to be of type array or string, but found ${us(Es(u))} instead.`);if(this.endIndex){const y=this.endIndex.evaluate(o);return u.slice(f,y)}return u.slice(f)}eachChild(o){o(this.input),o(this.beginIndex),this.endIndex&&o(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const o=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),o]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function VS(m,o){return m==="=="||m==="!="?o.kind==="boolean"||o.kind==="string"||o.kind==="number"||o.kind==="null"||o.kind==="value":o.kind==="string"||o.kind==="number"||o.kind==="value"}function US(m,o,u,f){return f.compare(o,u)===0}function cf(m,o,u){const f=m!=="=="&&m!=="!=";return class Jhe{constructor(g,_,T){this.type=In,this.lhs=g,this.rhs=_,this.collator=T,this.hasUntypedArgument=g.type.kind==="value"||_.type.kind==="value"}static parse(g,_){if(g.length!==3&&g.length!==4)return _.error("Expected two or three arguments.");const T=g[0];let E=_.parse(g[1],1,Fn);if(!E)return null;if(!VS(T,E.type))return _.concat(1).error(`"${T}" comparisons are not supported for type '${us(E.type)}'.`);let O=_.parse(g[2],2,Fn);if(!O)return null;if(!VS(T,O.type))return _.concat(2).error(`"${T}" comparisons are not supported for type '${us(O.type)}'.`);if(E.type.kind!==O.type.kind&&E.type.kind!=="value"&&O.type.kind!=="value")return _.error(`Cannot compare types '${us(E.type)}' and '${us(O.type)}'.`);f&&(E.type.kind==="value"&&O.type.kind!=="value"?E=new al(O.type,[E]):E.type.kind!=="value"&&O.type.kind==="value"&&(O=new al(E.type,[O])));let C=null;if(g.length===4){if(E.type.kind!=="string"&&O.type.kind!=="string"&&E.type.kind!=="value"&&O.type.kind!=="value")return _.error("Cannot use collator to compare non-string types.");if(C=_.parse(g[3],3,ku),!C)return null}return new Jhe(E,O,C)}evaluate(g){const _=this.lhs.evaluate(g),T=this.rhs.evaluate(g);if(f&&this.hasUntypedArgument){const E=Es(_),O=Es(T);if(E.kind!==O.kind||E.kind!=="string"&&E.kind!=="number")throw new ps(`Expected arguments for "${m}" to be (string, string) or (number, number), but found (${E.kind}, ${O.kind}) instead.`)}if(this.collator&&!f&&this.hasUntypedArgument){const E=Es(_),O=Es(T);if(E.kind!=="string"||O.kind!=="string")return o(g,_,T)}return this.collator?u(g,_,T,this.collator.evaluate(g)):o(g,_,T)}eachChild(g){g(this.lhs),g(this.rhs),this.collator&&g(this.collator)}outputDefined(){return!0}serialize(){const g=[m];return this.eachChild(_=>{g.push(_.serialize())}),g}}}const J3=cf("==",function(m,o,u){return o===u},US),Q3=cf("!=",function(m,o,u){return o!==u},function(m,o,u,f){return!US(0,o,u,f)}),e4=cf("<",function(m,o,u){return o<u},function(m,o,u,f){return f.compare(o,u)<0}),t4=cf(">",function(m,o,u){return o>u},function(m,o,u,f){return f.compare(o,u)>0}),r4=cf("<=",function(m,o,u){return o<=u},function(m,o,u,f){return f.compare(o,u)<=0}),n4=cf(">=",function(m,o,u){return o>=u},function(m,o,u,f){return f.compare(o,u)>=0});class Og{constructor(o,u,f,y,g,_){this.type=Zn,this.number=o,this.locale=u,this.currency=f,this.unit=y,this.minFractionDigits=g,this.maxFractionDigits=_}static parse(o,u){if(o.length!==3)return u.error("Expected two arguments.");const f=u.parse(o[1],1,vr);if(!f)return null;const y=o[2];if(typeof y!="object"||Array.isArray(y))return u.error("NumberFormat options argument must be an object.");let g=null;if(y.locale&&(g=u.parseObjectValue(y.locale,2,"locale",Zn),!g))return null;let _=null;if(y.currency&&(_=u.parseObjectValue(y.currency,2,"currency",Zn),!_))return null;let T=null;if(y.unit&&(T=u.parseObjectValue(y.unit,2,"unit",Zn),!T))return null;let E=null;if(y["min-fraction-digits"]&&(E=u.parseObjectValue(y["min-fraction-digits"],2,"min-fraction-digits",vr),!E))return null;let O=null;return y["max-fraction-digits"]&&(O=u.parseObjectValue(y["max-fraction-digits"],2,"max-fraction-digits",vr),!O)?null:new Og(f,g,_,T,E,O)}evaluate(o){return new Intl.NumberFormat(this.locale?this.locale.evaluate(o):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(o):void 0,unit:this.unit?this.unit.evaluate(o):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(o):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(o):void 0}).format(this.number.evaluate(o))}eachChild(o){o(this.number),this.locale&&o(this.locale),this.currency&&o(this.currency),this.unit&&o(this.unit),this.minFractionDigits&&o(this.minFractionDigits),this.maxFractionDigits&&o(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const o={};return this.locale&&(o.locale=this.locale.serialize()),this.currency&&(o.currency=this.currency.serialize()),this.unit&&(o.unit=this.unit.serialize()),this.minFractionDigits&&(o["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(o["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),o]}}class p1{constructor(o){this.type=vr,this.input=o}static parse(o,u){if(o.length!==2)return u.error(`Expected 1 argument, but found ${o.length-1} instead.`);const f=u.parse(o[1],1);return f?f.type.kind!=="array"&&f.type.kind!=="string"&&f.type.kind!=="value"?u.error(`Expected argument of type string or array, but found ${us(f.type)} instead.`):new p1(f):null}evaluate(o){const u=this.input.evaluate(o);if(typeof u=="string"||Array.isArray(u))return u.length;throw new ps(`Expected value to be of type string or array, but found ${us(Es(u))} instead.`)}eachChild(o){o(this.input)}outputDefined(){return!1}serialize(){const o=["length"];return this.eachChild(u=>{o.push(u.serialize())}),o}}function g1(m){return function(){m=1831565813+(m|=0)|0;let o=Math.imul(m^m>>>15,1|m);return o=o+Math.imul(o^o>>>7,61|o)^o,((o^o>>>14)>>>0)/4294967296}}const uf={"==":J3,"!=":Q3,">":t4,"<":e4,">=":n4,"<=":r4,array:al,at:u1,"at-interpolated":d1,boolean:al,case:f1,coalesce:qx,collator:Dh,format:Jm,image:Id,in:h1,"index-of":Kx,interpolate:ol,"interpolate-hcl":ol,"interpolate-lab":ol,length:p1,let:Wx,literal:Eu,match:m1,number:al,"number-format":Og,object:al,slice:Zx,step:Xc,string:al,"to-boolean":Iu,"to-color":Iu,"to-number":Iu,"to-string":Iu,var:Vh,within:Ou,distance:zd,config:$h};function GS(m,[o,u,f,y]){o=o.evaluate(m),u=u.evaluate(m),f=f.evaluate(m);const g=y?y.evaluate(m):1,_=wg(o,u,f,g);if(_)throw new ps(_);return new Xn(o/255*g,u/255*g,f/255*g,g)}function HS(m,[o,u,f,y]){o=o.evaluate(m),u=u.evaluate(m),f=f.evaluate(m);const g=y?y.evaluate(m):1,_=function(O,C,M,D){return typeof O=="number"&&O>=0&&O<=360?typeof C=="number"&&C>=0&&C<=100&&typeof M=="number"&&M>=0&&M<=100?D===void 0||typeof D=="number"&&D>=0&&D<=1?null:`Invalid hsla value [${[O,C,M,D].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${(typeof D=="number"?[O,C,M,D]:[O,C,M]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${(typeof D=="number"?[O,C,M,D]:[O,C,M]).join(", ")}]: 'h' must be between 0 and 360.`}(o,u,f,g);if(_)throw new ps(_);const T=`hsla(${o}, ${u}%, ${f}%, ${g})`,E=Xn.parse(T);if(!E)throw new ps(`Failed to parse HSLA color: ${T}`);return E}function x1(m,o){return m in o}function Yx(m,o){const u=o[m];return u===void 0?null:u}function Ll(m){return{type:m}}function y1(m){return{result:"success",value:m}}function Lu(m){return{result:"error",value:m}}function v1(m,o){return!!m&&!!m.parameters&&m.parameters.indexOf(o)>-1}function df(m){return m["property-type"]==="data-driven"}function Xx(m){return v1(m.expression,"measure-light")}function qS(m){return v1(m.expression,"zoom")}function b1(m){return!!m.expression&&m.expression.interpolated}function Jx(m){return typeof m=="object"&&m!==null&&!Array.isArray(m)}function WS(m){return m}function KS(m,o){const u=o.type==="color",f=m.stops&&typeof m.stops[0][0]=="object",y=f||!(f||m.property!==void 0),g=m.type||(b1(o)?"exponential":"interval");if(u&&((m=kn({},m)).stops&&(m.stops=m.stops.map(O=>[O[0],Xn.parse(O[1])])),m.default=Xn.parse(m.default?m.default:o.default)),m.colorSpace&&m.colorSpace!=="rgb"&&!$S[m.colorSpace])throw new Error(`Unknown color space: ${m.colorSpace}`);let _,T,E;if(g==="exponential")_=_1;else if(g==="interval")_=ZS;else if(g==="categorical"){_=i4,T=Object.create(null);for(const O of m.stops)T[O[0]]=O[1];E=typeof m.stops[0][0]}else{if(g!=="identity")throw new Error(`Unknown function type "${g}"`);_=Qx}if(f){const O={},C=[];for(let I=0;I<m.stops.length;I++){const R=m.stops[I],H=R[0].zoom;O[H]===void 0&&(O[H]={zoom:H,type:m.type,property:m.property,default:m.default,stops:[]},C.push(H)),O[H].stops.push([R[0].value,R[1]])}const M=[];for(const I of C)M.push([O[I].zoom,KS(O[I],o)]);const D={name:"linear"};return{kind:"composite",interpolationType:D,interpolationFactor:ol.interpolationFactor.bind(void 0,D),zoomStops:M.map(I=>I[0]),evaluate:({zoom:I},R)=>_1({stops:M,base:m.base},o,I).evaluate(I,R)}}if(y){const O=g==="exponential"?{name:"exponential",base:m.base!==void 0?m.base:1}:null;return{kind:"camera",interpolationType:O,interpolationFactor:ol.interpolationFactor.bind(void 0,O),zoomStops:m.stops.map(C=>C[0]),evaluate:({zoom:C})=>_(m,o,C,T,E)}}return{kind:"source",evaluate(O,C){const M=C&&C.properties?C.properties[m.property]:void 0;return M===void 0?Rg(m.default,o.default):_(m,o,M,T,E)}}}function Rg(m,o,u){return m!==void 0?m:o!==void 0?o:u!==void 0?u:void 0}function i4(m,o,u,f,y){return Rg(typeof u===y?f[u]:void 0,m.default,o.default)}function ZS(m,o,u){if(Mu(u)!=="number")return Rg(m.default,o.default);const f=m.stops.length;if(f===1||u<=m.stops[0][0])return m.stops[0][1];if(u>=m.stops[f-1][0])return m.stops[f-1][1];const y=Eg(m.stops.map(g=>g[0]),u);return m.stops[y][1]}function _1(m,o,u){const f=m.base!==void 0?m.base:1;if(Mu(u)!=="number")return Rg(m.default,o.default);const y=m.stops.length;if(y===1||u<=m.stops[0][0])return m.stops[0][1];if(u>=m.stops[y-1][0])return m.stops[y-1][1];const g=Eg(m.stops.map(C=>C[0]),u),_=function(C,M,D,I){const R=I-D,H=C-D;return R===0?0:M===1?H/R:(Math.pow(M,H)-1)/(Math.pow(M,R)-1)}(u,f,m.stops[g][0],m.stops[g+1][0]),T=m.stops[g][1],E=m.stops[g+1][1];let O=vg[o.type]||WS;if(m.colorSpace&&m.colorSpace!=="rgb"){const C=$S[m.colorSpace];O=(M,D)=>C.reverse(C.interpolate(C.forward(M),C.forward(D),_))}return typeof T.evaluate=="function"?{evaluate(...C){const M=T.evaluate.apply(void 0,C),D=E.evaluate.apply(void 0,C);if(M!==void 0&&D!==void 0)return O(M,D,_)}}:O(T,E,_)}function Qx(m,o,u){return o.type==="color"?u=Xn.parse(u):o.type==="formatted"?u=Ha.fromString(u.toString()):o.type==="resolvedImage"?u=qa.build(u.toString()):Mu(u)===o.type||o.type==="enum"&&o.values[u]||(u=void 0),Rg(u,m.default,o.default)}ao.register(uf,{error:[{kind:"error"},[Zn],(m,[o])=>{throw new ps(o.evaluate(m))}],typeof:[Zn,[Fn],(m,[o])=>us(Es(o.evaluate(m)))],"to-rgba":[Aa(vr,4),[Ga],(m,[o])=>o.evaluate(m).toRenderColor(null).toArray()],"to-hsla":[Aa(vr,4),[Ga],(m,[o])=>o.evaluate(m).toRenderColor(null).toHslaArray()],rgb:[Ga,[vr,vr,vr],GS],rgba:[Ga,[vr,vr,vr,vr],GS],hsl:[Ga,[vr,vr,vr],HS],hsla:[Ga,[vr,vr,vr,vr],HS],has:{type:In,overloads:[[[Zn],(m,[o])=>x1(o.evaluate(m),m.properties())],[[Zn,Zm],(m,[o,u])=>x1(o.evaluate(m),u.evaluate(m))]]},get:{type:Fn,overloads:[[[Zn],(m,[o])=>Yx(o.evaluate(m),m.properties())],[[Zn,Zm],(m,[o,u])=>Yx(o.evaluate(m),u.evaluate(m))]]},"feature-state":[Fn,[Zn],(m,[o])=>Yx(o.evaluate(m),m.featureState||{})],properties:[Zm,[],m=>m.properties()],"geometry-type":[Zn,[],m=>m.geometryType()],id:[Fn,[],m=>m.id()],zoom:[vr,[],m=>m.globals.zoom],pitch:[vr,[],m=>m.globals.pitch||0],"distance-from-center":[vr,[],m=>m.distanceFromCenter()],"measure-light":[vr,[Zn],(m,[o])=>m.measureLight(o.evaluate(m))],"heatmap-density":[vr,[],m=>m.globals.heatmapDensity||0],"line-progress":[vr,[],m=>m.globals.lineProgress||0],"raster-value":[vr,[],m=>m.globals.rasterValue||0],"raster-particle-speed":[vr,[],m=>m.globals.rasterParticleSpeed||0],"sky-radial-progress":[vr,[],m=>m.globals.skyRadialProgress||0],accumulated:[Fn,[],m=>m.globals.accumulated===void 0?null:m.globals.accumulated],"+":[vr,Ll(vr),(m,o)=>{let u=0;for(const f of o)u+=f.evaluate(m);return u}],"*":[vr,Ll(vr),(m,o)=>{let u=1;for(const f of o)u*=f.evaluate(m);return u}],"-":{type:vr,overloads:[[[vr,vr],(m,[o,u])=>o.evaluate(m)-u.evaluate(m)],[[vr],(m,[o])=>-o.evaluate(m)]]},"/":[vr,[vr,vr],(m,[o,u])=>o.evaluate(m)/u.evaluate(m)],"%":[vr,[vr,vr],(m,[o,u])=>o.evaluate(m)%u.evaluate(m)],ln2:[vr,[],()=>Math.LN2],pi:[vr,[],()=>Math.PI],e:[vr,[],()=>Math.E],"^":[vr,[vr,vr],(m,[o,u])=>Math.pow(o.evaluate(m),u.evaluate(m))],sqrt:[vr,[vr],(m,[o])=>Math.sqrt(o.evaluate(m))],log10:[vr,[vr],(m,[o])=>Math.log(o.evaluate(m))/Math.LN10],ln:[vr,[vr],(m,[o])=>Math.log(o.evaluate(m))],log2:[vr,[vr],(m,[o])=>Math.log(o.evaluate(m))/Math.LN2],sin:[vr,[vr],(m,[o])=>Math.sin(o.evaluate(m))],cos:[vr,[vr],(m,[o])=>Math.cos(o.evaluate(m))],tan:[vr,[vr],(m,[o])=>Math.tan(o.evaluate(m))],asin:[vr,[vr],(m,[o])=>Math.asin(o.evaluate(m))],acos:[vr,[vr],(m,[o])=>Math.acos(o.evaluate(m))],atan:[vr,[vr],(m,[o])=>Math.atan(o.evaluate(m))],min:[vr,Ll(vr),(m,o)=>Math.min(...o.map(u=>u.evaluate(m)))],max:[vr,Ll(vr),(m,o)=>Math.max(...o.map(u=>u.evaluate(m)))],abs:[vr,[vr],(m,[o])=>Math.abs(o.evaluate(m))],round:[vr,[vr],(m,[o])=>{const u=o.evaluate(m);return u<0?-Math.round(-u):Math.round(u)}],floor:[vr,[vr],(m,[o])=>Math.floor(o.evaluate(m))],ceil:[vr,[vr],(m,[o])=>Math.ceil(o.evaluate(m))],"filter-==":[In,[Zn,Fn],(m,[o,u])=>m.properties()[o.value]===u.value],"filter-id-==":[In,[Fn],(m,[o])=>m.id()===o.value],"filter-type-==":[In,[Zn],(m,[o])=>m.geometryType()===o.value],"filter-<":[In,[Zn,Fn],(m,[o,u])=>{const f=m.properties()[o.value],y=u.value;return typeof f==typeof y&&f<y}],"filter-id-<":[In,[Fn],(m,[o])=>{const u=m.id(),f=o.value;return typeof u==typeof f&&u<f}],"filter->":[In,[Zn,Fn],(m,[o,u])=>{const f=m.properties()[o.value],y=u.value;return typeof f==typeof y&&f>y}],"filter-id->":[In,[Fn],(m,[o])=>{const u=m.id(),f=o.value;return typeof u==typeof f&&u>f}],"filter-<=":[In,[Zn,Fn],(m,[o,u])=>{const f=m.properties()[o.value],y=u.value;return typeof f==typeof y&&f<=y}],"filter-id-<=":[In,[Fn],(m,[o])=>{const u=m.id(),f=o.value;return typeof u==typeof f&&u<=f}],"filter->=":[In,[Zn,Fn],(m,[o,u])=>{const f=m.properties()[o.value],y=u.value;return typeof f==typeof y&&f>=y}],"filter-id->=":[In,[Fn],(m,[o])=>{const u=m.id(),f=o.value;return typeof u==typeof f&&u>=f}],"filter-has":[In,[Fn],(m,[o])=>o.value in m.properties()],"filter-has-id":[In,[],m=>m.id()!==null&&m.id()!==void 0],"filter-type-in":[In,[Aa(Zn)],(m,[o])=>o.value.indexOf(m.geometryType())>=0],"filter-id-in":[In,[Aa(Fn)],(m,[o])=>o.value.indexOf(m.id())>=0],"filter-in-small":[In,[Zn,Aa(Fn)],(m,[o,u])=>u.value.indexOf(m.properties()[o.value])>=0],"filter-in-large":[In,[Zn,Aa(Fn)],(m,[o,u])=>function(f,y,g,_){for(;g<=_;){const T=g+_>>1;if(y[T]===f)return!0;y[T]>f?_=T-1:g=T+1}return!1}(m.properties()[o.value],u.value,0,u.value.length-1)],all:{type:In,overloads:[[[In,In],(m,[o,u])=>o.evaluate(m)&&u.evaluate(m)],[Ll(In),(m,o)=>{for(const u of o)if(!u.evaluate(m))return!1;return!0}]]},any:{type:In,overloads:[[[In,In],(m,[o,u])=>o.evaluate(m)||u.evaluate(m)],[Ll(In),(m,o)=>{for(const u of o)if(u.evaluate(m))return!0;return!1}]]},"!":[In,[In],(m,[o])=>!o.evaluate(m)],"is-supported-script":[In,[Zn],(m,[o])=>{const u=m.globals&&m.globals.isSupportedScript;return!u||u(o.evaluate(m))}],upcase:[Zn,[Zn],(m,[o])=>o.evaluate(m).toUpperCase()],downcase:[Zn,[Zn],(m,[o])=>o.evaluate(m).toLowerCase()],concat:[Zn,Ll(Fn),(m,o)=>o.map(u=>ca(u.evaluate(m))).join("")],"resolved-locale":[Zn,[ku],(m,[o])=>o.evaluate(m).resolvedLocale()],random:[vr,[vr,vr,Fn],(m,o)=>{const[u,f,y]=o.map(_=>_.evaluate(m));if(u>f||u===f)return u;let g;if(typeof y=="string")g=function(_){let T=0;if(_.length===0)return T;for(let E=0;E<_.length;E++)T=(T<<5)-T+_.charCodeAt(E),T|=0;return T}(y);else{if(typeof y!="number")throw new ps(`Invalid seed input: ${y}`);g=y}return u+g1(g)()*(f-u)}]});class w1{constructor(o,u,f,y){this.expression=o,this._warningHistory={},this._evaluator=new Rx(f,y),this._defaultValue=u?function(g){return g.type==="color"&&(Jx(g.default)||Array.isArray(g.default))?new Xn(0,0,0,0):g.type==="color"?Xn.parse(g.default)||null:g.default===void 0?null:g.default}(u):null,this._enumValues=u&&u.type==="enum"?u.values:null,this.configDependencies=Pg(o)}evaluateWithoutErrorHandling(o,u,f,y,g,_,T,E){return this._evaluator.globals=o,this._evaluator.feature=u,this._evaluator.featureState=f,this._evaluator.canonical=y||null,this._evaluator.availableImages=g||null,this._evaluator.formattedSection=_,this._evaluator.featureTileCoord=T||null,this._evaluator.featureDistanceData=E||null,this.expression.evaluate(this._evaluator)}evaluate(o,u,f,y,g,_,T,E){this._evaluator.globals=o,this._evaluator.feature=u||null,this._evaluator.featureState=f||null,this._evaluator.canonical=y||null,this._evaluator.availableImages=g||null,this._evaluator.formattedSection=_||null,this._evaluator.featureTileCoord=T||null,this._evaluator.featureDistanceData=E||null;try{const O=this.expression.evaluate(this._evaluator);if(O==null||typeof O=="number"&&O!=O)return this._defaultValue;if(this._enumValues&&!(O in this._enumValues))throw new ps(`Expected value to be one of ${Object.keys(this._enumValues).map(C=>JSON.stringify(C)).join(", ")}, but found ${JSON.stringify(O)} instead.`);return O}catch(O){return this._warningHistory[O.message]||(this._warningHistory[O.message]=!0,typeof console<"u"&&console.warn(`Failed to evaluate expression "${JSON.stringify(this.expression.serialize())}". ${O.message}`)),this._defaultValue}}}function ey(m){return Array.isArray(m)&&m.length>0&&typeof m[0]=="string"&&m[0]in uf}function hf(m,o,u,f){const y=new n1(uf,[],o?function(_){const T={color:Ga,string:Zn,number:vr,enum:Zn,boolean:In,formatted:bg,resolvedImage:Pu};return _.type==="array"?Aa(T[_.value]||Fn,_.length):T[_.type]}(o):void 0,void 0,void 0,u,f),g=y.parse(m,void 0,void 0,void 0,o&&o.type==="string"?{typeAnnotation:"coerce"}:void 0);return g?y1(new w1(g,o,u,f)):Lu(y.errors)}class j1{constructor(o,u,f,y){this.kind=o,this._styleExpression=u,this.isLightConstant=f,this.isLineProgressConstant=y,this.isStateDependent=o!=="constant"&&!kg(u.expression),this.configDependencies=Pg(u.expression)}evaluateWithoutErrorHandling(o,u,f,y,g,_){return this._styleExpression.evaluateWithoutErrorHandling(o,u,f,y,g,_)}evaluate(o,u,f,y,g,_){return this._styleExpression.evaluate(o,u,f,y,g,_)}}class mf{constructor(o,u,f,y,g,_){this.kind=o,this.zoomStops=f,this._styleExpression=u,this.isStateDependent=o!=="camera"&&!kg(u.expression),this.isLightConstant=g,this.isLineProgressConstant=_,this.configDependencies=Pg(u.expression),this.interpolationType=y}evaluateWithoutErrorHandling(o,u,f,y,g,_){return this._styleExpression.evaluateWithoutErrorHandling(o,u,f,y,g,_)}evaluate(o,u,f,y,g,_){return this._styleExpression.evaluate(o,u,f,y,g,_)}interpolationFactor(o,u,f){return this.interpolationType?ol.interpolationFactor(this.interpolationType,o,u,f):0}}function N1(m,o,u,f){if((m=hf(m,o,u,f)).result==="error")return m;const y=m.value.expression,g=af(y);if(!g&&!df(o))return Lu([new zl("","data expressions not supported")]);const _=zu(y,["zoom","pitch","distance-from-center"]);if(!_&&!qS(o))return Lu([new zl("","zoom expressions not supported")]);const T=zu(y,["measure-light"]);if(!T&&!Xx(o))return Lu([new zl("","measure-light expression not supported")]);const E=zu(y,["line-progress"]);if(!E&&!function(M){return v1(M.expression,"line-progress")}(o))return Lu([new zl("","line-progress expression not supported")]);const O=o.expression&&o.expression.relaxZoomRestriction,C=ry(y);return C||_||O?C instanceof zl?Lu([C]):C instanceof ol&&!b1(o)?Lu([new zl("",'"interpolate" expressions cannot be used with this property')]):y1(C?new mf(g&&E?"camera":"composite",m.value,C.labels,C instanceof ol?C.interpolation:void 0,T,E):new j1(g&&E?"constant":"source",m.value,T,E)):Lu([new zl("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class ty{constructor(o,u){this._parameters=o,this._specification=u,kn(this,KS(this._parameters,this._specification))}static deserialize(o){return new ty(o._parameters,o._specification)}static serialize(o){return{_parameters:o._parameters,_specification:o._specification}}}function ry(m){let o=null;if(m instanceof Wx)o=ry(m.result);else if(m instanceof qx){for(const u of m.args)if(o=ry(u),o)break}else(m instanceof Xc||m instanceof ol)&&m.input instanceof ao&&m.input.name==="zoom"&&(o=m);return o instanceof zl||m.eachChild(u=>{const f=ry(u);f instanceof zl?o=f:o&&f&&o!==f&&(o=new zl("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),o}var Dg,YS,XS=function(){if(YS)return Dg;YS=1,Dg=o;var m=3;function o(u,f,y){var g=this.cells=[];if(u instanceof ArrayBuffer){this.arrayBuffer=u;var _=new Int32Array(this.arrayBuffer);u=_[0],this.d=(f=_[1])+2*(y=_[2]);for(var T=0;T<this.d*this.d;T++){var E=_[m+T],O=_[m+T+1];g.push(E===O?null:_.subarray(E,O))}var C=_[m+g.length+1];this.keys=_.subarray(_[m+g.length],C),this.bboxes=_.subarray(C),this.insert=this._insertReadonly}else{this.d=f+2*y;for(var M=0;M<this.d*this.d;M++)g.push([]);this.keys=[],this.bboxes=[]}this.n=f,this.extent=u,this.padding=y,this.scale=f/u,this.uid=0;var D=y/f*u;this.min=-D,this.max=u+D}return o.prototype.insert=function(u,f,y,g,_){this._forEachCell(f,y,g,_,this._insertCell,this.uid++),this.keys.push(u),this.bboxes.push(f),this.bboxes.push(y),this.bboxes.push(g),this.bboxes.push(_)},o.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},o.prototype._insertCell=function(u,f,y,g,_,T){this.cells[_].push(T)},o.prototype.query=function(u,f,y,g,_){var T=this.min,E=this.max;if(u<=T&&f<=T&&E<=y&&E<=g&&!_)return Array.prototype.slice.call(this.keys);var O=[];return this._forEachCell(u,f,y,g,this._queryCell,O,{},_),O},o.prototype._queryCell=function(u,f,y,g,_,T,E,O){var C=this.cells[_];if(C!==null)for(var M=this.keys,D=this.bboxes,I=0;I<C.length;I++){var R=C[I];if(E[R]===void 0){var H=4*R;(O?O(D[H+0],D[H+1],D[H+2],D[H+3]):u<=D[H+2]&&f<=D[H+3]&&y>=D[H+0]&&g>=D[H+1])?(E[R]=!0,T.push(M[R])):E[R]=!1}}},o.prototype._forEachCell=function(u,f,y,g,_,T,E,O){for(var C=this._convertToCellCoord(u),M=this._convertToCellCoord(f),D=this._convertToCellCoord(y),I=this._convertToCellCoord(g),R=C;R<=D;R++)for(var H=M;H<=I;H++){var X=this.d*H+R;if((!O||O(this._convertFromCellCoord(R),this._convertFromCellCoord(H),this._convertFromCellCoord(R+1),this._convertFromCellCoord(H+1)))&&_.call(this,u,f,y,g,X,T,E,O))return}},o.prototype._convertFromCellCoord=function(u){return(u-this.padding)/this.scale},o.prototype._convertToCellCoord=function(u){return Math.max(0,Math.min(this.d-1,Math.floor(u*this.scale)+this.padding))},o.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var u=this.cells,f=m+this.cells.length+1+1,y=0,g=0;g<this.cells.length;g++)y+=this.cells[g].length;var _=new Int32Array(f+y+this.keys.length+this.bboxes.length);_[0]=this.extent,_[1]=this.n,_[2]=this.padding;for(var T=f,E=0;E<u.length;E++){var O=u[E];_[m+E]=T,_.set(O,T),T+=O.length}return _[m+u.length]=T,_.set(this.keys,T),_[m+u.length+1]=T+=this.keys.length,_.set(this.bboxes,T),T+=this.bboxes.length,_.buffer},Dg}(),ff=p(XS);const ny={};function lr(m,o,u={}){Object.defineProperty(m,"_classRegistryKey",{value:o,writable:!1}),ny[o]={klass:m,omit:u.omit||[]}}lr(Object,"Object"),ff.serialize=function(m,o){const u=m.toArrayBuffer();return o&&o.add(u),{buffer:u}},ff.deserialize=function(m){return new ff(m.buffer)},Object.defineProperty(ff,"name",{value:"Grid"}),lr(ff,"Grid"),typeof DOMMatrix<"u"&&lr(DOMMatrix,"DOMMatrix"),lr(Xn,"Color"),lr(Error,"Error"),lr(Ha,"Formatted"),lr(_g,"FormattedSection"),lr(Js,"AJAXError"),lr(qa,"ResolvedImage"),lr(ty,"StylePropertyFunction"),lr(w1,"StyleExpression",{omit:["_evaluator"]}),lr(vo,"ImageId"),lr(Yc,"ImageVariant"),lr(mf,"ZoomDependentExpression"),lr(j1,"ZoomConstantExpression"),lr(ao,"CompoundExpression",{omit:["_evaluate"]});for(const m in uf)ny[uf[m]._classRegistryKey]||lr(uf[m],`Expression${m}`);function S1(m){return m&&typeof ArrayBuffer<"u"&&(m instanceof ArrayBuffer||m.constructor&&m.constructor.name==="ArrayBuffer")}function C1(m){return self.ImageBitmap&&m instanceof ImageBitmap}function Ld(m,o){if(m==null||typeof m=="boolean"||typeof m=="number"||typeof m=="string"||m instanceof Boolean||m instanceof Number||m instanceof String||m instanceof Date||m instanceof RegExp)return m;if(S1(m)||C1(m))return o&&o.add(m),m;if(ArrayBuffer.isView(m))return o&&o.add(m.buffer),m;if(m instanceof ImageData)return o&&o.add(m.data.buffer),m;if(Array.isArray(m)){const u=[];for(const f of m)u.push(Ld(f,o));return u}if(m instanceof Map){const u={$name:"Map",entries:[]};for(const[f,y]of m.entries())u.entries.push(Ld(f),Ld(y));return u}if(m instanceof Set){const u={$name:"Set"};let f=0;for(const y of m.values())u[++f]=Ld(y);return u}if(m instanceof DOMMatrix){const u={$name:"DOMMatrix"},f=["is2D","m11","m12","m13","m14","m21","m22","m23","m24","m31","m32","m33","m34","m41","m42","m43","m44","a","b","c","d","e","f"];for(const y of f)u[y]=m[y];return u}if(typeof m=="bigint")return{$name:"BigInt",value:m.toString()};if(typeof m=="object"){const u=m.constructor,f=u._classRegistryKey;if(!f)throw new Error(`Can't serialize object of unregistered class "${u.name}".`);const y=u.serialize?u.serialize(m,o):{};if(!u.serialize){for(const g in m)m.hasOwnProperty(g)&&(ny[f].omit.indexOf(g)>=0||(y[g]=Ld(m[g],o)));m instanceof Error&&(y.message=m.message)}if(y.$name)throw new Error("$name property is reserved for worker serialization logic.");return f!=="Object"&&(y.$name=f),y}throw new Error("can't serialize object of type "+typeof m)}function ll(m){if(m==null||typeof m=="boolean"||typeof m=="number"||typeof m=="string"||m instanceof Boolean||m instanceof Number||m instanceof String||m instanceof Date||m instanceof RegExp||S1(m)||C1(m)||ArrayBuffer.isView(m)||m instanceof ImageData)return m;if(Array.isArray(m))return m.map(ll);if(typeof m=="object"){const o=m.$name||"Object";if(o==="Map"){const y=m.entries||[],g=new Map;for(let _=0;_<y.length;_+=2)g.set(ll(y[_]),ll(y[_+1]));return g}if(o==="Set"){const y=new Set;for(const g of Object.keys(m))g!=="$name"&&y.add(ll(m[g]));return y}if(o==="DOMMatrix"){let y;return y=m.is2D?[m.a,m.b,m.c,m.d,m.e,m.f]:[m.m11,m.m12,m.m13,m.m14,m.m21,m.m22,m.m23,m.m24,m.m31,m.m32,m.m33,m.m34,m.m41,m.m42,m.m43,m.m44],new DOMMatrix(y)}if(o==="BigInt")return BigInt(m.value);const{klass:u}=ny[o];if(!u)throw new Error(`Can't deserialize unregistered class "${o}".`);if(u.deserialize)return u.deserialize(m);const f=Object.create(u.prototype);for(const y of Object.keys(m))y!=="$name"&&(f[y]=ll(m[y]));return f}throw new Error("can't deserialize object of type "+typeof m)}const Tr={"Latin-1 Supplement":m=>m>=128&&m<=255,Arabic:m=>m>=1536&&m<=1791,"Arabic Supplement":m=>m>=1872&&m<=1919,"Arabic Extended-A":m=>m>=2208&&m<=2303,"Hangul Jamo":m=>m>=4352&&m<=4607,"Unified Canadian Aboriginal Syllabics":m=>m>=5120&&m<=5759,Khmer:m=>m>=6016&&m<=6143,"Unified Canadian Aboriginal Syllabics Extended":m=>m>=6320&&m<=6399,"General Punctuation":m=>m>=8192&&m<=8303,"Letterlike Symbols":m=>m>=8448&&m<=8527,"Number Forms":m=>m>=8528&&m<=8591,"Miscellaneous Technical":m=>m>=8960&&m<=9215,"Control Pictures":m=>m>=9216&&m<=9279,"Optical Character Recognition":m=>m>=9280&&m<=9311,"Enclosed Alphanumerics":m=>m>=9312&&m<=9471,"Geometric Shapes":m=>m>=9632&&m<=9727,"Miscellaneous Symbols":m=>m>=9728&&m<=9983,"Miscellaneous Symbols and Arrows":m=>m>=11008&&m<=11263,"CJK Radicals Supplement":m=>m>=11904&&m<=12031,"Kangxi Radicals":m=>m>=12032&&m<=12255,"Ideographic Description Characters":m=>m>=12272&&m<=12287,"CJK Symbols and Punctuation":m=>m>=12288&&m<=12351,Hiragana:m=>m>=12352&&m<=12447,Katakana:m=>m>=12448&&m<=12543,Bopomofo:m=>m>=12544&&m<=12591,"Hangul Compatibility Jamo":m=>m>=12592&&m<=12687,Kanbun:m=>m>=12688&&m<=12703,"Bopomofo Extended":m=>m>=12704&&m<=12735,"CJK Strokes":m=>m>=12736&&m<=12783,"Katakana Phonetic Extensions":m=>m>=12784&&m<=12799,"Enclosed CJK Letters and Months":m=>m>=12800&&m<=13055,"CJK Compatibility":m=>m>=13056&&m<=13311,"CJK Unified Ideographs Extension A":m=>m>=13312&&m<=19903,"Yijing Hexagram Symbols":m=>m>=19904&&m<=19967,"CJK Unified Ideographs":m=>m>=19968&&m<=40959,"Yi Syllables":m=>m>=40960&&m<=42127,"Yi Radicals":m=>m>=42128&&m<=42191,"Hangul Jamo Extended-A":m=>m>=43360&&m<=43391,"Hangul Syllables":m=>m>=44032&&m<=55215,"Hangul Jamo Extended-B":m=>m>=55216&&m<=55295,"Private Use Area":m=>m>=57344&&m<=63743,"CJK Compatibility Ideographs":m=>m>=63744&&m<=64255,"Arabic Presentation Forms-A":m=>m>=64336&&m<=65023,"Vertical Forms":m=>m>=65040&&m<=65055,"CJK Compatibility Forms":m=>m>=65072&&m<=65103,"Small Form Variants":m=>m>=65104&&m<=65135,"Arabic Presentation Forms-B":m=>m>=65136&&m<=65279,"Halfwidth and Fullwidth Forms":m=>m>=65280&&m<=65519,Osage:m=>m>=66736&&m<=66815,"CJK Unified Ideographs Extension B":m=>m>=131072&&m<=173791};function A1(m){for(const o of m)if(iy(o.charCodeAt(0)))return!0;return!1}function s4(m){for(const o of m)if(!JS(o.charCodeAt(0)))return!1;return!0}function JS(m){return!(Tr.Arabic(m)||Tr["Arabic Supplement"](m)||Tr["Arabic Extended-A"](m)||Tr["Arabic Presentation Forms-A"](m)||Tr["Arabic Presentation Forms-B"](m))}function iy(m){return!(m!==746&&m!==747&&(m<4352||!(Tr["Bopomofo Extended"](m)||Tr.Bopomofo(m)||Tr["CJK Compatibility Forms"](m)&&!(m>=65097&&m<=65103)||Tr["CJK Compatibility Ideographs"](m)||Tr["CJK Compatibility"](m)||Tr["CJK Radicals Supplement"](m)||Tr["CJK Strokes"](m)||!(!Tr["CJK Symbols and Punctuation"](m)||m>=12296&&m<=12305||m>=12308&&m<=12319||m===12336)||Tr["CJK Unified Ideographs Extension A"](m)||Tr["CJK Unified Ideographs"](m)||Tr["Enclosed CJK Letters and Months"](m)||Tr["Hangul Compatibility Jamo"](m)||Tr["Hangul Jamo Extended-A"](m)||Tr["Hangul Jamo Extended-B"](m)||Tr["Hangul Jamo"](m)||Tr["Hangul Syllables"](m)||Tr.Hiragana(m)||Tr["Ideographic Description Characters"](m)||Tr.Kanbun(m)||Tr["Kangxi Radicals"](m)||Tr["Katakana Phonetic Extensions"](m)||Tr.Katakana(m)&&m!==12540||!(!Tr["Halfwidth and Fullwidth Forms"](m)||m===65288||m===65289||m===65293||m>=65306&&m<=65310||m===65339||m===65341||m===65343||m>=65371&&m<=65503||m===65507||m>=65512&&m<=65519)||!(!Tr["Small Form Variants"](m)||m>=65112&&m<=65118||m>=65123&&m<=65126)||Tr["Unified Canadian Aboriginal Syllabics"](m)||Tr["Unified Canadian Aboriginal Syllabics Extended"](m)||Tr["Vertical Forms"](m)||Tr["Yijing Hexagram Symbols"](m)||Tr["Yi Syllables"](m)||Tr["Yi Radicals"](m))))}function T1(m){return!(iy(m)||function(o){return!!(Tr["Latin-1 Supplement"](o)&&(o===167||o===169||o===174||o===177||o===188||o===189||o===190||o===215||o===247)||Tr["General Punctuation"](o)&&(o===8214||o===8224||o===8225||o===8240||o===8241||o===8251||o===8252||o===8258||o===8263||o===8264||o===8265||o===8273)||Tr["Letterlike Symbols"](o)||Tr["Number Forms"](o)||Tr["Miscellaneous Technical"](o)&&(o>=8960&&o<=8967||o>=8972&&o<=8991||o>=8996&&o<=9e3||o===9003||o>=9085&&o<=9114||o>=9150&&o<=9165||o===9167||o>=9169&&o<=9179||o>=9186&&o<=9215)||Tr["Control Pictures"](o)&&o!==9251||Tr["Optical Character Recognition"](o)||Tr["Enclosed Alphanumerics"](o)||Tr["Geometric Shapes"](o)||Tr["Miscellaneous Symbols"](o)&&!(o>=9754&&o<=9759)||Tr["Miscellaneous Symbols and Arrows"](o)&&(o>=11026&&o<=11055||o>=11088&&o<=11097||o>=11192&&o<=11243)||Tr["CJK Symbols and Punctuation"](o)||Tr.Katakana(o)||Tr["Private Use Area"](o)||Tr["CJK Compatibility Forms"](o)||Tr["Small Form Variants"](o)||Tr["Halfwidth and Fullwidth Forms"](o)||o===8734||o===8756||o===8757||o>=9984&&o<=10087||o>=10102&&o<=10131||o===65532||o===65533)}(m))}function QS(m){return Tr.Arabic(m)||Tr["Arabic Supplement"](m)||Tr["Arabic Extended-A"](m)||Tr["Arabic Presentation Forms-A"](m)||Tr["Arabic Presentation Forms-B"](m)}function sy(m){return m>=1424&&m<=2303||Tr["Arabic Presentation Forms-A"](m)||Tr["Arabic Presentation Forms-B"](m)}function k1(m,o){return!(!o&&sy(m)||m>=2304&&m<=3583||m>=3840&&m<=4255||Tr.Khmer(m))}function eC(m){for(const o of m)if(sy(o.charCodeAt(0)))return!0;return!1}const P1="deferred",Jc="loading",E1="loaded";let M1=null,bo="unavailable",Fd=null;const zg=function(m){m&&typeof m=="string"&&m.indexOf("NetworkError")>-1&&(bo="error"),M1&&M1(m)};function ay(){pf.fire(new Ro("pluginStateChange",{pluginStatus:bo,pluginURL:Fd}))}const pf=new lc,oy=function(){return bo},tC=function(){if(bo!==P1||!Fd)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");bo=Jc,ay(),Fd&&Rl({url:Fd},m=>{m?zg(m):(bo=E1,ay())})},Fl={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>bo===E1||Fl.applyArabicShaping!=null,isLoading:()=>bo===Jc,setState(m){bo=m.pluginStatus,Fd=m.pluginURL},isParsed:()=>Fl.applyArabicShaping!=null&&Fl.processBidirectionalText!=null&&Fl.processStyledBidirectionalText!=null,getPluginURL:()=>Fd};class hi{constructor(o,u){this.zoom=o,u?(this.now=u.now,this.fadeDuration=u.fadeDuration,this.transition=u.transition,this.pitch=u.pitch,this.brightness=u.brightness):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(o){return function(u,f){for(const y of u)if(!k1(y.charCodeAt(0),f))return!1;return!0}(o,Fl.isLoaded())}}class gf{constructor(o,u,f,y){this.property=o,this.value=u,this.expression=function(g,_,T,E){if(Jx(g))return new ty(g,_);if(ey(g)||Array.isArray(g)&&g.length>0){const O=N1(g,_,T,E);if(O.result==="error")throw new Error(O.value.map(C=>`${C.key}: ${C.message}`).join(", "));return O.value}{let O=g;return typeof g=="string"&&_.type==="color"&&(O=Xn.parse(g)),{kind:"constant",configDependencies:new Set,evaluate:()=>O}}}(u===void 0?o.specification.default:u,o.specification,f,y)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(o,u,f){return this.property.possiblyEvaluate(this,o,u,f)}}class I1{constructor(o,u,f){this.property=o,this.value=new gf(o,void 0,u,f)}transitioned(o,u){return new ly(this.property,this.value,u,Ui({},o.transition,this.transition),o.now)}untransitioned(){return new ly(this.property,this.value,null,{},0)}}class O1{constructor(o,u,f){this._properties=o,this._values=Object.create(o.defaultTransitionablePropertyValues),this._scope=u,this._options=f,this.configDependencies=new Set}getValue(o){return Vs(this._values[o].value.value)}setValue(o,u){this._values.hasOwnProperty(o)||(this._values[o]=new I1(this._values[o].property,this._scope,this._options)),this._values[o].value=new gf(this._values[o].property,u===null?void 0:Vs(u),this._scope,this._options),this._values[o].value.expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[o].value.expression.configDependencies]))}setTransitionOrValue(o,u){u&&(this._options=u);const f=this._properties.properties;if(o)for(const y in o){const g=o[y];if(y.endsWith("-transition")){const _=y.slice(0,-11);f[_]&&this.setTransition(_,g)}else f.hasOwnProperty(y)&&this.setValue(y,g)}}getTransition(o){return Vs(this._values[o].transition)}setTransition(o,u){this._values.hasOwnProperty(o)||(this._values[o]=new I1(this._values[o].property)),this._values[o].transition=Vs(u)||void 0}serialize(){const o={};for(const u of Object.keys(this._values)){const f=this.getValue(u);f!==void 0&&(o[u]=f);const y=this.getTransition(u);y!==void 0&&(o[`${u}-transition`]=y)}return o}transitioned(o,u){const f=new Lg(this._properties);for(const y of Object.keys(this._values))f._values[y]=this._values[y].transitioned(o,u._values[y]);return f}untransitioned(){const o=new Lg(this._properties);for(const u of Object.keys(this._values))o._values[u]=this._values[u].untransitioned();return o}}class ly{constructor(o,u,f,y,g){const _=y.delay||0,T=y.duration||0;g=g||0,this.property=o,this.value=u,this.begin=g+_,this.end=this.begin+T,o.specification.transition&&(y.delay||y.duration)&&(this.prior=f)}possiblyEvaluate(o,u,f){const y=o.now||0,g=this.value.possiblyEvaluate(o,u,f),_=this.prior;if(_){if(y>this.end)return this.prior=null,g;if(this.value.isDataDriven())return this.prior=null,g;if(y<this.begin)return _.possiblyEvaluate(o,u,f);{const T=(y-this.begin)/(this.end-this.begin);return this.property.interpolate(_.possiblyEvaluate(o,u,f),g,Nr(T))}}return g}}class Lg{constructor(o){this._properties=o,this._values=Object.create(o.defaultTransitioningPropertyValues)}possiblyEvaluate(o,u,f){const y=new vf(this._properties);for(const g of Object.keys(this._values))y._values[g]=this._values[g].possiblyEvaluate(o,u,f);return y}hasTransition(){for(const o of Object.keys(this._values))if(this._values[o].prior)return!0;return!1}}class xf{constructor(o,u,f){this._properties=o,this._values=Object.create(o.defaultPropertyValues),this._scope=u,this._options=f,this.configDependencies=new Set}getValue(o){return Vs(this._values[o].value)}setValue(o,u){this._values[o]=new gf(this._values[o].property,u===null?void 0:Vs(u),this._scope,this._options),this._values[o].expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[o].expression.configDependencies]))}serialize(){const o={};for(const u of Object.keys(this._values)){const f=this.getValue(u);f!==void 0&&(o[u]=f)}return o}possiblyEvaluate(o,u,f){const y=new vf(this._properties);for(const g of Object.keys(this._values))y._values[g]=this._values[g].possiblyEvaluate(o,u,f);return y}}class yf{constructor(o,u,f){this.property=o,this.value=u,this.parameters=f}isConstant(){return this.value.kind==="constant"}constantOr(o){return this.value.kind==="constant"?this.value.value:o}evaluate(o,u,f,y){return this.property.evaluate(this.value,this.parameters,o,u,f,y)}}class vf{constructor(o){this._properties=o,this._values=Object.create(o.defaultPossiblyEvaluatedValues)}get(o){return this._values[o]}}class Vt{constructor(o){this.specification=o}possiblyEvaluate(o,u){return o.expression.evaluate(u)}interpolate(o,u,f){const y=vg[this.specification.type];return y?y(o,u,f):o}}class ar{constructor(o,u){this.specification=o,this.overrides=u}possiblyEvaluate(o,u,f,y){return new yf(this,o.expression.kind==="constant"||o.expression.kind==="camera"?{kind:"constant",value:o.expression.evaluate(u,null,{},f,y)}:o.expression,u)}interpolate(o,u,f){if(o.value.kind!=="constant"||u.value.kind!=="constant")return o;if(o.value.value===void 0||u.value.value===void 0)return new yf(this,{kind:"constant",value:void 0},o.parameters);const y=vg[this.specification.type];return y?new yf(this,{kind:"constant",value:y(o.value.value,u.value.value,f)},o.parameters):o}evaluate(o,u,f,y,g,_){return o.kind==="constant"?o.value:o.evaluate(u,f,y,g,_)}}class bf{constructor(o){this.specification=o}possiblyEvaluate(o,u,f,y){return!!o.expression.evaluate(u,null,{},f,y)}interpolate(){return!1}}class Ki{constructor(o){this.properties=o,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const u=new hi(0,{});for(const f in o){const y=o[f];y.specification.overridable&&this.overridableProperties.push(f);const g=this.defaultPropertyValues[f]=new gf(y,void 0),_=this.defaultTransitionablePropertyValues[f]=new I1(y);this.defaultTransitioningPropertyValues[f]=_.untransitioned(),this.defaultPossiblyEvaluatedValues[f]=g.possiblyEvaluate(u)}}}lr(ar,"DataDrivenProperty"),lr(Vt,"DataConstantProperty"),lr(bf,"ColorRampProperty");var ut=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"required":false,"type":"array","value":"light-3d"},"terrain":{"type":"terrain","optional":true},"fog":{"type":"fog"},"snow":{"type":"snow","experimental":true},"rain":{"type":"rain","experimental":true},"camera":{"type":"camera"},"color-theme":{"type":"colorTheme"},"indoor":{"type":"indoor","experimental":true},"imports":{"type":"array","value":"import"},"iconsets":{"experimental":true,"type":"iconsets"},"schema":{"type":"schema"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"},"models":{"type":"models"},"featuresets":{"experimental":true,"type":"featuresets"}},"featuresets":{"experimental":true,"*":{"type":"featureset"}},"featureset":{"experimental":true,"metadata":{"experimental":true,"type":"*"},"selectors":{"experimental":true,"type":"array","value":"selector"}},"selector":{"experimental":true,"layer":{"experimental":true,"type":"string","required":true},"properties":{"experimental":true,"type":"selectorProperty","required":false},"featureNamespace":{"experimental":true,"type":"string","required":false},"_uniqueFeatureID":{"experimental":true,"type":"boolean","private":true,"required":false}},"selectorProperty":{"experimental":true,"*":{"experimental":true,"type":"*"}},"model":{"type":"string","required":true},"import":{"id":{"type":"string","required":true},"url":{"type":"string","required":true},"config":{"type":"config"},"data":{"type":"$root"},"color-theme":{"type":"colorTheme","optional":true}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","property-type":"data-constant","expression":{},"required":true},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string","required":true},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false,"property-type":"data-constant"},"shadow-quality":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"parameters":["zoom"]},"experimental":true},"shadow-intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"iconsets":{"*":{"type":"iconset"}},"iconset":["iconset_sprite","iconset_source"],"iconset_sprite":{"type":{"required":true,"type":"enum","values":{"sprite":1}},"url":{"required":true,"type":"string"}},"iconset_source":{"type":{"required":true,"type":"enum","values":{"source":1}},"source":{"required":true,"type":"string"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_raster_array","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_array":{"experimental":true,"type":{"required":true,"type":"enum","values":{"raster-array":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"rasterLayers":{"type":"*"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"},"dynamic":{"type":"boolean","default":false}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":1}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":1}},"url":{"required":false,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_model":{"type":{"required":true,"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"raster-particle":{"experimental":true},"hillshade":{},"model":{"experimental":true},"background":{},"sky":{},"slot":{},"clip":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_clip","layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_raster-particle","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_clip":{"clip-layer-types":{"type":"array","value":"enum","values":{"model":1,"symbol":1},"default":[],"expression":{},"property-type":"data-constant"},"clip-layer-scope":{"type":"array","value":"string","default":[],"expression":{},"property-type":"data-constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-base":1,"hd-road-markup":1},"default":"none","experimental":true,"private":true,"expression":{},"property-type":"data-constant"},"fill-construct-bridge-guard-rail":{"type":"boolean","default":"true","experimental":true,"private":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"circle-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-markup":1},"default":"none","experimental":true,"expression":{},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","experimental":true,"default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1,"none":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-z-offset":{"type":"number","experimental":true,"default":0,"expression":{"parameters":["zoom","feature","line-progress"]},"property-type":"data-driven"},"line-elevation-reference":{"type":"enum","values":{"none":1,"sea":1,"ground":1,"hd-road-markup":1},"default":"none","experimental":true,"expression":{},"property-type":"data-constant"},"line-cross-slope":{"type":"number","experimental":true,"expression":{},"property-type":"constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"line-width-unit":{"type":"enum","values":{"pixels":1,"meters":1},"default":"pixels","experimental":true,"private":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-elevation-reference":{"type":"enum","values":{"sea":1,"ground":1,"hd-road-markup":1},"default":"ground","experimental":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"experimental":true,"private":true,"expression":{},"property-type":"data-constant"},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"experimental":true,"private":true,"expression":{},"property-type":"data-constant"},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster-particle":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_hillshade":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster-particle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_clip":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_model":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"snow":{"density":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,0.85],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"opacity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,0.3],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","property-type":"data-constant","default":"#ffffff","experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"center-thinning":{"type":"number","property-type":"data-constant","default":0.4,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,50],"minimum":0,"maximum":360,"length":2,"value":"number","property-type":"data-constant","transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"flake-size":{"type":"number","property-type":"data-constant","default":0.71,"minimum":0,"maximum":5,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"rain":{"density":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,0.5],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["measure-light","brightness"],0,"#03113d",0.3,"#a8adbc"],"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"opacity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["measure-light","brightness"],0,0.88,1,0.7],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,1],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["measure-light","brightness"],0,"#001736",0.3,"#464646"],"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"center-thinning":{"type":"number","property-type":"data-constant","default":0.57,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,80],"minimum":0,"maximum":360,"length":2,"value":"number","property-type":"data-constant","transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"droplet-size":{"type":"array","default":[2.6,18.2],"minimum":0,"maximum":50,"length":2,"value":"number","property-type":"data-constant","transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"distortion-strength":{"type":"number","property-type":"data-constant","default":0.7,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective","property-type":"data-constant"}},"colorTheme":{"data":{"type":"string","property-type":"data-constant","expression":{}}},"indoor":{"floorplanFeaturesetId":{"type":"string","experimental":true,"property-type":"data-constant","expression":{}},"buildingFeaturesetId":{"type":"string","experimental":true,"property-type":"data-constant","expression":{}}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_raster-particle","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"fill-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-bridge-guard-rail-color":{"type":"color","default":"rgba(241, 236, 225, 255)","experimental":true,"private":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature"]},"property-type":"data-driven"},"fill-tunnel-structure-color":{"type":"color","default":"rgba(241, 236, 225, 255)","transition":true,"experimental":true,"private":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-height-alignment":{"type":"enum","experimental":true,"values":{"terrain":1,"flat":1},"default":"flat","property-type":"data-constant"},"fill-extrusion-base-alignment":{"type":"enum","experimental":true,"values":{"terrain":1,"flat":1},"default":"terrain","property-type":"data-constant"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"property-type":"data-constant","type":"color","experimental":true,"default":"#ffffff","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"property-type":"data-constant","type":"number","experimental":true,"default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"property-type":"data-constant","type":"number","experimental":true,"default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"property-type":"data-constant","type":"boolean","default":true,"experimental":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"fill-extrusion-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"fill-extrusion-line-width":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-cast-shadows":{"type":"boolean","default":true,"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light","line-progress"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"property-type":"constant"},"line-trim-fade-range":{"type":"array","value":"number","experimental":true,"length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-trim-color":{"type":"color","experimental":true,"default":"transparent","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-border-width":{"type":"number","private":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","private":true,"default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-occlusion-opacity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"property-type":"data-constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-image-cross-fade":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"transition":true},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-color-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"symbol-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-value"]},"property-type":"color-ramp"},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"raster-array-band":{"type":"string","required":false,"experimental":true,"property-type":"data-constant"},"raster-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster-particle":{"raster-particle-array-band":{"type":"string","required":false,"property-type":"data-constant"},"raster-particle-count":{"type":"number","default":512,"minimum":1,"property-type":"data-constant"},"raster-particle-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-particle-speed"]},"property-type":"color-ramp"},"raster-particle-max-speed":{"type":"number","default":1,"minimum":1,"property-type":"data-constant"},"raster-particle-speed-factor":{"type":"number","default":0.2,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-fade-opacity-factor":{"type":"number","default":0.98,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-reset-rate-factor":{"type":"number","default":0.8,"minimum":0,"maximum":1,"property-type":"data-constant"},"raster-particle-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_background":{"background-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":[]},"experimental":true,"property-type":"data-constant"},"background-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"property-type":"data-driven"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d","property-type":"data-constant"},"model-cast-shadows":{"type":"boolean","default":true,"property-type":"data-constant"},"model-receive-shadows":{"type":"boolean","default":true,"property-type":"data-constant"},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant","transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"model-front-cutoff":{"type":"array","private":true,"value":"number","property-type":"data-constant","expression":{"interpolated":true,"parameters":["zoom"]},"length":3,"default":[0,0,1],"minimum":[0,0,0],"maximum":[1,1,1]}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"*"}}}');function rC(m){return m instanceof Number||m instanceof String||m instanceof Boolean?m.valueOf():m}function cy(m){if(Array.isArray(m))return m.map(cy);if(m instanceof Object&&!(m instanceof Number||m instanceof String||m instanceof Boolean)){const o={};for(const u in m)o[u]=cy(m[u]);return o}return rC(m)}function R1(m){if(m===!0||m===!1)return!0;if(!Array.isArray(m)||m.length===0)return!1;switch(m[0]){case"has":return m.length>=2&&m[1]!=="$id"&&m[1]!=="$type";case"in":return m.length>=3&&(typeof m[1]!="string"||Array.isArray(m[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return m.length!==3||Array.isArray(m[1])||Array.isArray(m[2]);case"any":case"all":for(const o of m.slice(1))if(!R1(o)&&typeof o!="boolean")return!1;return!0;default:return!0}}function D1(m,o="",u=null,f="fill"){if(m==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};R1(m)||(m=uy(m));const y=m;let g=!0;try{g=function(C){if(!_f(C))return C;let M=cy(C);return iC(M),M=nC(M),M}(y)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(y,null,2)}
        `)}let _=null,T=null;if(f!=="background"&&f!=="sky"&&f!=="slot"){T=ut[`filter_${f}`];const C=hf(g,T,o,u);if(C.result==="error")throw new Error(C.value.map(M=>`${M.key}: ${M.message}`).join(", "));_=(M,D,I)=>C.value.evaluate(M,D,{},I)}let E=null,O=null;if(g!==y){const C=hf(y,T,o,u);if(C.result==="error")throw new Error(C.value.map(M=>`${M.key}: ${M.message}`).join(", "));E=(M,D,I,R,H)=>C.value.evaluate(M,D,{},I,void 0,void 0,R,H),O=!af(C.value.expression)}return{filter:_,dynamicFilter:E||void 0,needGeometry:sC(g),needFeature:!!O}}function nC(m){if(!Array.isArray(m))return m;const o=function(u){if(a4.has(u[0])){for(let f=1;f<u.length;f++)if(_f(u[f]))return!0}return u}(m);return o===!0?o:o.map(u=>nC(u))}function iC(m){let o=!1;const u=[];if(m[0]==="case"){for(let f=1;f<m.length-1;f+=2)o=o||_f(m[f]),u.push(m[f+1]);u.push(m[m.length-1])}else if(m[0]==="match"){o=o||_f(m[1]);for(let f=2;f<m.length-1;f+=2)u.push(m[f+1]);u.push(m[m.length-1])}else if(m[0]==="step"){o=o||_f(m[1]);for(let f=1;f<m.length-1;f+=2)u.push(m[f+1])}o&&(m.length=0,m.push("any",...u));for(let f=1;f<m.length;f++)iC(m[f])}function _f(m){if(!Array.isArray(m))return!1;if((o=m[0])==="pitch"||o==="distance-from-center")return!0;var o;for(let u=1;u<m.length;u++)if(_f(m[u]))return!0;return!1}const a4=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function o4(m,o){return m<o?-1:m>o?1:0}function sC(m){if(!Array.isArray(m))return!1;if(m[0]==="within"||m[0]==="distance")return!0;for(let o=1;o<m.length;o++)if(sC(m[o]))return!0;return!1}function uy(m){if(!m)return!0;const o=m[0];return m.length<=1?o!=="any":o==="=="?Bd(m[1],m[2],"=="):o==="!="?Uh(Bd(m[1],m[2],"==")):o==="<"||o===">"||o==="<="||o===">="?Bd(m[1],m[2],o):o==="any"?(u=m.slice(1),["any"].concat(u.map(uy))):o==="all"?["all"].concat(m.slice(1).map(uy)):o==="none"?["all"].concat(m.slice(1).map(uy).map(Uh)):o==="in"?z1(m[1],m.slice(2)):o==="!in"?Uh(z1(m[1],m.slice(2))):o==="has"?L1(m[1]):o!=="!has"||Uh(L1(m[1]));var u}function Bd(m,o,u){switch(m){case"$type":return[`filter-type-${u}`,o];case"$id":return[`filter-id-${u}`,o];default:return[`filter-${u}`,m,o]}}function z1(m,o){if(o.length===0)return!1;switch(m){case"$type":return["filter-type-in",["literal",o]];case"$id":return["filter-id-in",["literal",o]];default:return o.length>200&&!o.some(u=>typeof u!=typeof o[0])?["filter-in-large",m,["literal",o.sort(o4)]]:["filter-in-small",m,["literal",o]]}}function L1(m){switch(m){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",m]}}function Uh(m){return["!",m]}const dy="";function wf(m,o){return o?`${m}${dy}${o}`:m}const Fu="-transition",aC=new Set(["fill","line","background","hillshade","raster"]);class ua extends lc{constructor(o,u,f,y,g){if(super(),this.id=o.id,this.fqid=wf(this.id,f),this.type=o.type,this.scope=f,this.lut=y,this.options=g,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.configDependencies=new Set,o.type!=="custom"){if(this.metadata=o.metadata,this.minzoom=o.minzoom,this.maxzoom=o.maxzoom,o.type&&o.type!=="background"&&o.type!=="sky"&&o.type!=="slot"){this.source=o.source,this.sourceLayer=o["source-layer"],this.filter=o.filter;const _=hf(this.filter,ut[`filter_${o.type}`]);_.result!=="error"&&(this.configDependencies=new Set([...this.configDependencies,..._.value.configDependencies]))}if(o.slot&&(this.slot=o.slot),u.layout&&(this._unevaluatedLayout=new xf(u.layout,this.scope,g),this.configDependencies=new Set([...this.configDependencies,...this._unevaluatedLayout.configDependencies])),u.paint){this._transitionablePaint=new O1(u.paint,this.scope,g);for(const _ in o.paint)this.setPaintProperty(_,o.paint[_]);for(const _ in o.layout)this.setLayoutProperty(_,o.layout[_]);this.configDependencies=new Set([...this.configDependencies,...this._transitionablePaint.configDependencies]),this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new vf(u.paint)}}}onAdd(o){}onRemove(o){}isDraped(o){return!this.is3D(!0)&&aC.has(this.type)}getLayoutProperty(o){return o==="visibility"?this.visibility:this._unevaluatedLayout.getValue(o)}setLayoutProperty(o,u){if(this.type==="custom"&&o==="visibility")return void(this.visibility=u);const f=this._unevaluatedLayout;f._properties.properties[o]&&(f.setValue(o,u),this.configDependencies=new Set([...this.configDependencies,...f.configDependencies]),o==="visibility"&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this._unevaluatedLayout._values.visibility&&(this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0}))}getPaintProperty(o){return o.endsWith(Fu)?this._transitionablePaint.getTransition(o.slice(0,-11)):this._transitionablePaint.getValue(o)}setPaintProperty(o,u){const f=this._transitionablePaint,y=f._properties.properties;if(o.endsWith(Fu)){const M=o.slice(0,-11);return y[M]&&f.setTransition(M,u||void 0),!1}if(!y[o])return!1;const g=f._values[o],_=g.value.isDataDriven(),T=g.value;f.setValue(o,u),this.configDependencies=new Set([...this.configDependencies,...f.configDependencies]),this._handleSpecialPaintPropertyUpdate(o);const E=f._values[o].value,O=E.isDataDriven(),C=o.endsWith("pattern")||o==="line-dasharray";return O||_||C||this._handleOverridablePaintPropertyUpdate(o,T,E)}_handleSpecialPaintPropertyUpdate(o){}getProgramIds(){return null}getDefaultProgramParams(o,u,f){return null}_handleOverridablePaintPropertyUpdate(o,u,f){return!1}isHidden(o){return!!(this.minzoom&&o<this.minzoom)||!!(this.maxzoom&&o>=this.maxzoom)||this.visibility==="none"}updateTransitions(o){this._transitioningPaint=this._transitionablePaint.transitioned(o,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(o,u){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(o,void 0,u)),this.paint=this._transitioningPaint.possiblyEvaluate(o,void 0,u)}serialize(){return nl({id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()},(o,u)=>!(o===void 0||u==="layout"&&!Object.keys(o).length||u==="paint"&&!Object.keys(o).length))}is3D(o){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}tileCoverLift(){return 0}resize(){}isStateDependent(){for(const o in this.paint._values){const u=this.paint.get(o);if(u instanceof yf&&df(u.property.specification)&&(u.value.kind==="source"||u.value.kind==="composite")&&u.value.isStateDependent)return!0}return!1}compileFilter(o){this._filterCompiled||(this._featureFilter=D1(this.filter,this.scope,o),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}getLayerRenderingStats(){return this._stats}resetLayerRenderingStats(o){this._stats&&(o.renderPass==="shadow"?this._stats.numRenderedVerticesInShadowPass=0:this._stats.numRenderedVerticesInTransparentPass=0)}queryRadius(o){}queryIntersectsFeature(o,u,f,y,g,_,T,E,O){}}const l4={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Fg{constructor(o,u){this._structArray=o,this._pos1=u*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class xi{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(o,u){return o._trim(),u&&(o.isTransferred=!0,u.add(o.arrayBuffer)),{length:o.length,arrayBuffer:o.arrayBuffer}}static deserialize(o){const u=Object.create(this.prototype);return u.arrayBuffer=o.arrayBuffer,u.length=o.length,u.capacity=o.arrayBuffer.byteLength/u.bytesPerElement,u._refreshViews(),u}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(o){this.reserve(o),this.length=o}reserve(o){if(o>this.capacity){this.capacity=Math.max(o,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const u=this.uint8;this._refreshViews(),u&&this.uint8.set(u)}}_refreshViews(){throw new Error("StructArray#_refreshViews() must be implemented by each concrete StructArray layout")}emplace(...o){throw new Error("StructArray#emplace() must be implemented by each concrete StructArray layout")}emplaceBack(...o){throw new Error("StructArray#emplaceBack() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Bn(m,o=1){let u=0,f=0;return{members:m.map(y=>{const g=l4[y.type].BYTES_PER_ELEMENT,_=u=oC(u,Math.max(o,g)),T=y.components||1;return f=Math.max(f,g),u+=g*T,{name:y.name,type:y.type,components:T,offset:_}}),size:oC(u,Math.max(f,o)),alignment:o}}function oC(m,o){return Math.ceil(m/o)*o}class Bu extends xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,u){const f=this.length;return this.resize(f+1),this.emplace(f,o,u)}emplace(o,u,f){const y=2*o;return this.int16[y+0]=u,this.int16[y+1]=f,o}}Bu.prototype.bytesPerElement=4,lr(Bu,"StructArrayLayout2i4");class jf extends xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,u,f){const y=this.length;return this.resize(y+1),this.emplace(y,o,u,f)}emplace(o,u,f,y){const g=3*o;return this.int16[g+0]=u,this.int16[g+1]=f,this.int16[g+2]=y,o}}jf.prototype.bytesPerElement=6,lr(jf,"StructArrayLayout3i6");class $u extends xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,u,f,y){const g=this.length;return this.resize(g+1),this.emplace(g,o,u,f,y)}emplace(o,u,f,y,g){const _=4*o;return this.int16[_+0]=u,this.int16[_+1]=f,this.int16[_+2]=y,this.int16[_+3]=g,o}}$u.prototype.bytesPerElement=8,lr($u,"StructArrayLayout4i8");class Gh extends xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o){const u=this.length;return this.resize(u+1),this.emplace(u,o)}emplace(o,u){return this.float32[1*o+0]=u,o}}Gh.prototype.bytesPerElement=4,lr(Gh,"StructArrayLayout1f4");class Bg extends xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,u,f){const y=this.length;return this.resize(y+1),this.emplace(y,o,u,f)}emplace(o,u,f,y){const g=4*o,_=2*o;return this.int16[g+0]=u,this.int16[g+1]=f,this.float32[_+1]=y,o}}Bg.prototype.bytesPerElement=8,lr(Bg,"StructArrayLayout2i1f8");class F1 extends xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,u,f){const y=this.length;return this.resize(y+1),this.emplace(y,o,u,f)}emplace(o,u,f,y){const g=4*o;return this.int16[g+0]=u,this.int16[g+1]=f,this.int16[g+2]=y,o}}F1.prototype.bytesPerElement=8,lr(F1,"StructArrayLayout3i8");class Bl extends xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,u,f,y,g){const _=this.length;return this.resize(_+1),this.emplace(_,o,u,f,y,g)}emplace(o,u,f,y,g,_){const T=5*o;return this.int16[T+0]=u,this.int16[T+1]=f,this.int16[T+2]=y,this.int16[T+3]=g,this.int16[T+4]=_,o}}Bl.prototype.bytesPerElement=10,lr(Bl,"StructArrayLayout5i10");class B1 extends xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,u,f,y,g,_,T){const E=this.length;return this.resize(E+1),this.emplace(E,o,u,f,y,g,_,T)}emplace(o,u,f,y,g,_,T,E){const O=6*o,C=12*o,M=3*o;return this.int16[O+0]=u,this.int16[O+1]=f,this.uint8[C+4]=y,this.uint8[C+5]=g,this.uint8[C+6]=_,this.uint8[C+7]=T,this.float32[M+2]=E,o}}B1.prototype.bytesPerElement=12,lr(B1,"StructArrayLayout2i4ub1f12");class hc extends xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,u,f){const y=this.length;return this.resize(y+1),this.emplace(y,o,u,f)}emplace(o,u,f,y){const g=3*o;return this.float32[g+0]=u,this.float32[g+1]=f,this.float32[g+2]=y,o}}hc.prototype.bytesPerElement=12,lr(hc,"StructArrayLayout3f12");class $d extends xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,u,f,y,g){const _=this.length;return this.resize(_+1),this.emplace(_,o,u,f,y,g)}emplace(o,u,f,y,g,_){const T=6*o,E=3*o;return this.uint16[T+0]=u,this.uint16[T+1]=f,this.uint16[T+2]=y,this.uint16[T+3]=g,this.float32[E+2]=_,o}}$d.prototype.bytesPerElement=12,lr($d,"StructArrayLayout4ui1f12");class hy extends xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,u,f,y){const g=this.length;return this.resize(g+1),this.emplace(g,o,u,f,y)}emplace(o,u,f,y,g){const _=4*o;return this.uint16[_+0]=u,this.uint16[_+1]=f,this.uint16[_+2]=y,this.uint16[_+3]=g,o}}hy.prototype.bytesPerElement=8,lr(hy,"StructArrayLayout4ui8");class my extends xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,u,f,y,g,_){const T=this.length;return this.resize(T+1),this.emplace(T,o,u,f,y,g,_)}emplace(o,u,f,y,g,_,T){const E=6*o;return this.int16[E+0]=u,this.int16[E+1]=f,this.int16[E+2]=y,this.int16[E+3]=g,this.int16[E+4]=_,this.int16[E+5]=T,o}}my.prototype.bytesPerElement=12,lr(my,"StructArrayLayout6i12");class $1 extends xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,u,f,y,g,_,T,E,O,C,M,D){const I=this.length;return this.resize(I+1),this.emplace(I,o,u,f,y,g,_,T,E,O,C,M,D)}emplace(o,u,f,y,g,_,T,E,O,C,M,D,I){const R=12*o;return this.int16[R+0]=u,this.int16[R+1]=f,this.int16[R+2]=y,this.int16[R+3]=g,this.uint16[R+4]=_,this.uint16[R+5]=T,this.uint16[R+6]=E,this.uint16[R+7]=O,this.int16[R+8]=C,this.int16[R+9]=M,this.int16[R+10]=D,this.int16[R+11]=I,o}}$1.prototype.bytesPerElement=24,lr($1,"StructArrayLayout4i4ui4i24");class V1 extends xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,u,f,y,g,_){const T=this.length;return this.resize(T+1),this.emplace(T,o,u,f,y,g,_)}emplace(o,u,f,y,g,_,T){const E=10*o,O=5*o;return this.int16[E+0]=u,this.int16[E+1]=f,this.int16[E+2]=y,this.float32[O+2]=g,this.float32[O+3]=_,this.float32[O+4]=T,o}}V1.prototype.bytesPerElement=20,lr(V1,"StructArrayLayout3i3f20");class Hh extends xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,u,f,y){const g=this.length;return this.resize(g+1),this.emplace(g,o,u,f,y)}emplace(o,u,f,y,g){const _=4*o;return this.float32[_+0]=u,this.float32[_+1]=f,this.float32[_+2]=y,this.float32[_+3]=g,o}}Hh.prototype.bytesPerElement=16,lr(Hh,"StructArrayLayout4f16");class U1 extends xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(o){const u=this.length;return this.resize(u+1),this.emplace(u,o)}emplace(o,u){return this.uint32[1*o+0]=u,o}}U1.prototype.bytesPerElement=4,lr(U1,"StructArrayLayout1ul4");class Vd extends xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,u){const f=this.length;return this.resize(f+1),this.emplace(f,o,u)}emplace(o,u,f){const y=2*o;return this.uint16[y+0]=u,this.uint16[y+1]=f,o}}Vd.prototype.bytesPerElement=4,lr(Vd,"StructArrayLayout2ui4");class G1 extends xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,u,f,y,g,_,T,E,O,C,M,D,I){const R=this.length;return this.resize(R+1),this.emplace(R,o,u,f,y,g,_,T,E,O,C,M,D,I)}emplace(o,u,f,y,g,_,T,E,O,C,M,D,I,R){const H=20*o,X=10*o;return this.int16[H+0]=u,this.int16[H+1]=f,this.int16[H+2]=y,this.int16[H+3]=g,this.int16[H+4]=_,this.float32[X+3]=T,this.float32[X+4]=E,this.float32[X+5]=O,this.float32[X+6]=C,this.int16[H+14]=M,this.uint32[X+8]=D,this.uint16[H+18]=I,this.uint16[H+19]=R,o}}G1.prototype.bytesPerElement=40,lr(G1,"StructArrayLayout5i4f1i1ul2ui40");class $g extends xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,u,f,y,g,_,T){const E=this.length;return this.resize(E+1),this.emplace(E,o,u,f,y,g,_,T)}emplace(o,u,f,y,g,_,T,E){const O=8*o;return this.int16[O+0]=u,this.int16[O+1]=f,this.int16[O+2]=y,this.int16[O+4]=g,this.int16[O+5]=_,this.int16[O+6]=T,this.int16[O+7]=E,o}}$g.prototype.bytesPerElement=16,lr($g,"StructArrayLayout3i2i2i16");class H1 extends xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,u,f,y,g){const _=this.length;return this.resize(_+1),this.emplace(_,o,u,f,y,g)}emplace(o,u,f,y,g,_){const T=4*o,E=8*o;return this.float32[T+0]=u,this.float32[T+1]=f,this.float32[T+2]=y,this.int16[E+6]=g,this.int16[E+7]=_,o}}H1.prototype.bytesPerElement=16,lr(H1,"StructArrayLayout2f1f2i16");class q1 extends xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,u,f,y,g,_){const T=this.length;return this.resize(T+1),this.emplace(T,o,u,f,y,g,_)}emplace(o,u,f,y,g,_,T){const E=20*o,O=5*o;return this.uint8[E+0]=u,this.uint8[E+1]=f,this.float32[O+1]=y,this.float32[O+2]=g,this.float32[O+3]=_,this.float32[O+4]=T,o}}q1.prototype.bytesPerElement=20,lr(q1,"StructArrayLayout2ub4f20");class va extends xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,u,f){const y=this.length;return this.resize(y+1),this.emplace(y,o,u,f)}emplace(o,u,f,y){const g=3*o;return this.uint16[g+0]=u,this.uint16[g+1]=f,this.uint16[g+2]=y,o}}va.prototype.bytesPerElement=6,lr(va,"StructArrayLayout3ui6");class fy extends xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(o,u,f,y,g,_,T,E,O,C,M,D,I,R,H,X,J,ne,re,te,oe){const ue=this.length;return this.resize(ue+1),this.emplace(ue,o,u,f,y,g,_,T,E,O,C,M,D,I,R,H,X,J,ne,re,te,oe)}emplace(o,u,f,y,g,_,T,E,O,C,M,D,I,R,H,X,J,ne,re,te,oe,ue){const me=30*o,Me=15*o,Se=60*o;return this.int16[me+0]=u,this.int16[me+1]=f,this.int16[me+2]=y,this.float32[Me+2]=g,this.float32[Me+3]=_,this.uint16[me+8]=T,this.uint16[me+9]=E,this.uint32[Me+5]=O,this.uint32[Me+6]=C,this.uint32[Me+7]=M,this.uint16[me+16]=D,this.uint16[me+17]=I,this.uint16[me+18]=R,this.float32[Me+10]=H,this.float32[Me+11]=X,this.uint8[Se+48]=J,this.uint8[Se+49]=ne,this.uint8[Se+50]=re,this.uint32[Me+13]=te,this.int16[me+28]=oe,this.uint8[Se+58]=ue,o}}fy.prototype.bytesPerElement=60,lr(fy,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class py extends xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(o,u,f,y,g,_,T,E,O,C,M,D,I,R,H,X,J,ne,re,te,oe,ue,me,Me,Se,Ae,Ve,Ie,Ge,Ze,We,Qe,Je){const ot=this.length;return this.resize(ot+1),this.emplace(ot,o,u,f,y,g,_,T,E,O,C,M,D,I,R,H,X,J,ne,re,te,oe,ue,me,Me,Se,Ae,Ve,Ie,Ge,Ze,We,Qe,Je)}emplace(o,u,f,y,g,_,T,E,O,C,M,D,I,R,H,X,J,ne,re,te,oe,ue,me,Me,Se,Ae,Ve,Ie,Ge,Ze,We,Qe,Je,ot){const nt=20*o,ct=40*o,Ot=80*o;return this.float32[nt+0]=u,this.float32[nt+1]=f,this.int16[ct+4]=y,this.int16[ct+5]=g,this.int16[ct+6]=_,this.int16[ct+7]=T,this.int16[ct+8]=E,this.int16[ct+9]=O,this.int16[ct+10]=C,this.int16[ct+11]=M,this.int16[ct+12]=D,this.uint16[ct+13]=I,this.uint16[ct+14]=R,this.uint16[ct+15]=H,this.uint16[ct+16]=X,this.uint16[ct+17]=J,this.uint16[ct+18]=ne,this.uint16[ct+19]=re,this.uint16[ct+20]=te,this.uint16[ct+21]=oe,this.uint16[ct+22]=ue,this.uint16[ct+23]=me,this.uint16[ct+24]=Me,this.uint16[ct+25]=Se,this.uint16[ct+26]=Ae,this.uint16[ct+27]=Ve,this.uint32[nt+14]=Ie,this.float32[nt+15]=Ge,this.float32[nt+16]=Ze,this.float32[nt+17]=We,this.float32[nt+18]=Qe,this.uint8[Ot+76]=Je,this.uint16[ct+39]=ot,o}}py.prototype.bytesPerElement=80,lr(py,"StructArrayLayout2f9i15ui1ul4f1ub1ui80");class Do extends xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,u,f,y,g){const _=this.length;return this.resize(_+1),this.emplace(_,o,u,f,y,g)}emplace(o,u,f,y,g,_){const T=5*o;return this.float32[T+0]=u,this.float32[T+1]=f,this.float32[T+2]=y,this.float32[T+3]=g,this.float32[T+4]=_,o}}Do.prototype.bytesPerElement=20,lr(Do,"StructArrayLayout5f20");class gy extends xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,u,f,y,g,_,T){const E=this.length;return this.resize(E+1),this.emplace(E,o,u,f,y,g,_,T)}emplace(o,u,f,y,g,_,T,E){const O=7*o;return this.float32[O+0]=u,this.float32[O+1]=f,this.float32[O+2]=y,this.float32[O+3]=g,this.float32[O+4]=_,this.float32[O+5]=T,this.float32[O+6]=E,o}}gy.prototype.bytesPerElement=28,lr(gy,"StructArrayLayout7f28");class W1 extends xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,u,f,y,g,_,T,E,O,C,M){const D=this.length;return this.resize(D+1),this.emplace(D,o,u,f,y,g,_,T,E,O,C,M)}emplace(o,u,f,y,g,_,T,E,O,C,M,D){const I=11*o;return this.float32[I+0]=u,this.float32[I+1]=f,this.float32[I+2]=y,this.float32[I+3]=g,this.float32[I+4]=_,this.float32[I+5]=T,this.float32[I+6]=E,this.float32[I+7]=O,this.float32[I+8]=C,this.float32[I+9]=M,this.float32[I+10]=D,o}}W1.prototype.bytesPerElement=44,lr(W1,"StructArrayLayout11f44");class K1 extends xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,u,f,y,g,_,T,E,O){const C=this.length;return this.resize(C+1),this.emplace(C,o,u,f,y,g,_,T,E,O)}emplace(o,u,f,y,g,_,T,E,O,C){const M=9*o;return this.float32[M+0]=u,this.float32[M+1]=f,this.float32[M+2]=y,this.float32[M+3]=g,this.float32[M+4]=_,this.float32[M+5]=T,this.float32[M+6]=E,this.float32[M+7]=O,this.float32[M+8]=C,o}}K1.prototype.bytesPerElement=36,lr(K1,"StructArrayLayout9f36");class Nf extends xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,u){const f=this.length;return this.resize(f+1),this.emplace(f,o,u)}emplace(o,u,f){const y=2*o;return this.float32[y+0]=u,this.float32[y+1]=f,o}}Nf.prototype.bytesPerElement=8,lr(Nf,"StructArrayLayout2f8");class Vg extends xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,u,f,y){const g=this.length;return this.resize(g+1),this.emplace(g,o,u,f,y)}emplace(o,u,f,y,g){const _=6*o;return this.uint32[3*o+0]=u,this.uint16[_+2]=f,this.uint16[_+3]=y,this.uint16[_+4]=g,o}}Vg.prototype.bytesPerElement=12,lr(Vg,"StructArrayLayout1ul3ui12");class xy extends xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o){const u=this.length;return this.resize(u+1),this.emplace(u,o)}emplace(o,u){return this.uint16[1*o+0]=u,o}}xy.prototype.bytesPerElement=2,lr(xy,"StructArrayLayout1ui2");class yy extends xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,u,f,y,g,_,T,E,O,C,M,D,I,R,H,X){const J=this.length;return this.resize(J+1),this.emplace(J,o,u,f,y,g,_,T,E,O,C,M,D,I,R,H,X)}emplace(o,u,f,y,g,_,T,E,O,C,M,D,I,R,H,X,J){const ne=16*o;return this.float32[ne+0]=u,this.float32[ne+1]=f,this.float32[ne+2]=y,this.float32[ne+3]=g,this.float32[ne+4]=_,this.float32[ne+5]=T,this.float32[ne+6]=E,this.float32[ne+7]=O,this.float32[ne+8]=C,this.float32[ne+9]=M,this.float32[ne+10]=D,this.float32[ne+11]=I,this.float32[ne+12]=R,this.float32[ne+13]=H,this.float32[ne+14]=X,this.float32[ne+15]=J,o}}yy.prototype.bytesPerElement=64,lr(yy,"StructArrayLayout16f64");class vy extends xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,u,f,y,g,_,T){const E=this.length;return this.resize(E+1),this.emplace(E,o,u,f,y,g,_,T)}emplace(o,u,f,y,g,_,T,E){const O=10*o,C=5*o;return this.uint16[O+0]=u,this.uint16[O+1]=f,this.uint16[O+2]=y,this.uint16[O+3]=g,this.float32[C+2]=_,this.float32[C+3]=T,this.float32[C+4]=E,o}}vy.prototype.bytesPerElement=20,lr(vy,"StructArrayLayout4ui3f20");class by extends xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o){const u=this.length;return this.resize(u+1),this.emplace(u,o)}emplace(o,u){return this.int16[1*o+0]=u,o}}by.prototype.bytesPerElement=2,lr(by,"StructArrayLayout1i2");class Z1 extends xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(o){const u=this.length;return this.resize(u+1),this.emplace(u,o)}emplace(o,u){return this.uint8[1*o+0]=u,o}}Z1.prototype.bytesPerElement=1,lr(Z1,"StructArrayLayout1ub1");class Y1 extends Fg{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}Y1.prototype.size=40;class Ug extends G1{get(o){return new Y1(this,o)}}lr(Ug,"CollisionBoxArray");class lC extends Fg{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(o){this._structArray.uint8[this._pos1+49]=o}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(o){this._structArray.uint8[this._pos1+50]=o}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(o){this._structArray.uint32[this._pos4+13]=o}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(o){this._structArray.uint8[this._pos1+58]=o}}lC.prototype.size=60;class cC extends fy{get(o){return new lC(this,o)}}lr(cC,"PlacedSymbolArray");class uC extends Fg{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(o){this._structArray.uint32[this._pos4+14]=o}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(o){this._structArray.float32[this._pos4+18]=o}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}get elevationFeatureIndex(){return this._structArray.uint16[this._pos2+39]}}uC.prototype.size=80;class dC extends py{get(o){return new uC(this,o)}}lr(dC,"SymbolInstanceArray");class hC extends Gh{getoffsetX(o){return this.float32[1*o+0]}}lr(hC,"GlyphOffsetArray");class Gg extends Bu{getx(o){return this.int16[2*o+0]}gety(o){return this.int16[2*o+1]}}lr(Gg,"SymbolLineVertexArray");class Hg extends Fg{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}Hg.prototype.size=12;class zo extends Vg{get(o){return new Hg(this,o)}}lr(zo,"FeatureIndexArray");class qg extends Vd{geta_centroid_pos0(o){return this.uint16[2*o+0]}geta_centroid_pos1(o){return this.uint16[2*o+1]}}lr(qg,"FillExtrusionCentroidArray");class mC extends Fg{get a_join_normal_inside0(){return this._structArray.int16[this._pos2+0]}get a_join_normal_inside1(){return this._structArray.int16[this._pos2+1]}get a_join_normal_inside2(){return this._structArray.int16[this._pos2+2]}}mC.prototype.size=6;class fC extends jf{get(o){return new mC(this,o)}}lr(fC,"FillExtrusionWallArray");const c4=Bn([{name:"a_pos",components:2,type:"Int16"}],4),u4=Bn([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class Ti{constructor(o=[]){this.segments=o}_prepareSegment(o,u,f,y){let g=this.segments[this.segments.length-1];return o>Ti.MAX_VERTEX_ARRAY_LENGTH&&_i(`Max vertices per segment is ${Ti.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${o}`),(!g||g.vertexLength+o>Ti.MAX_VERTEX_ARRAY_LENGTH||g.sortKey!==y)&&(g={vertexOffset:u,primitiveOffset:f,vertexLength:0,primitiveLength:0},y!==void 0&&(g.sortKey=y),this.segments.push(g)),g}prepareSegment(o,u,f,y){return this._prepareSegment(o,u.length,f.length,y)}get(){return this.segments}destroy(){for(const o of this.segments)for(const u in o.vaos)o.vaos[u].destroy()}static simpleSegment(o,u,f,y){return new Ti([{vertexOffset:o,primitiveOffset:u,vertexLength:f,primitiveLength:y,vaos:{},sortKey:0}])}}function pC(m,o){return 256*(m=rr(Math.floor(m),0,255))+rr(Math.floor(o),0,255)}Ti.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,lr(Ti,"SegmentVector");const X1=Bn([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),d4=Bn([{name:"a_dash",components:4,type:"Uint16"}]);class Wg{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(o,u,f,y){this.ids.push(J1(o)),this.positions.push(u,f,y)}eachPosition(o,u){const f=J1(o);let y=0,g=this.ids.length-1;for(;y<g;){const _=y+g>>1;this.ids[_]>=f?g=_:y=_+1}for(;this.ids[y]===f;)u(this.positions[3*y],this.positions[3*y+1],this.positions[3*y+2]),y++}static serialize(o,u){const f=new Float64Array(o.ids),y=new Uint32Array(o.positions);return Kg(f,y,0,f.length-1),u&&(u.add(f.buffer),u.add(y.buffer)),{ids:f,positions:y}}static deserialize(o){const u=new Wg;let f;u.ids=o.ids,u.positions=o.positions;for(const y of u.ids)y!==f&&u.uniqueIds.push(y),f=y;return u.indexed=!0,u}}function J1(m){const o=+m;return!isNaN(o)&&Number.MIN_SAFE_INTEGER<=o&&o<=Number.MAX_SAFE_INTEGER?o:sl(String(m))}function Kg(m,o,u,f){for(;u<f;){const y=m[u+f>>1];let g=u-1,_=f+1;for(;;){do g++;while(m[g]<y);do _--;while(m[_]>y);if(g>=_)break;_y(m,g,_),_y(o,3*g,3*_),_y(o,3*g+1,3*_+1),_y(o,3*g+2,3*_+2)}_-u<f-_?(Kg(m,o,u,_),u=_+1):(Kg(m,o,_+1,f),f=_)}}function _y(m,o,u){const f=m[o];m[o]=m[u],m[u]=f}lr(Wg,"FeaturePositionMap");class Qc{constructor(o){this.gl=o.gl,this.initialized=!1}fetchUniformLocation(o,u){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(o,u),this.initialized=!0),!!this.location}set(o,u,f){throw new Error("Uniform#set() must be implemented by each concrete Uniform")}}class Zg extends Qc{constructor(o){super(o),this.current=0}set(o,u,f){this.fetchUniformLocation(o,u)&&this.current!==f&&(this.current=f,this.gl.uniform1i(this.location,f))}}class gs extends Qc{constructor(o){super(o),this.current=0}set(o,u,f){this.fetchUniformLocation(o,u)&&this.current!==f&&(this.current=f,this.gl.uniform1f(this.location,f))}}class $l extends Qc{constructor(o){super(o),this.current=[0,0]}set(o,u,f){this.fetchUniformLocation(o,u)&&(f[0]===this.current[0]&&f[1]===this.current[1]||(this.current=f,this.gl.uniform2f(this.location,f[0],f[1])))}}class Sf extends Qc{constructor(o){super(o),this.current=[0,0,0]}set(o,u,f){this.fetchUniformLocation(o,u)&&(f[0]===this.current[0]&&f[1]===this.current[1]&&f[2]===this.current[2]||(this.current=f,this.gl.uniform3f(this.location,f[0],f[1],f[2])))}}class Yg extends Qc{constructor(o){super(o),this.current=[0,0,0,0]}set(o,u,f){this.fetchUniformLocation(o,u)&&(f[0]===this.current[0]&&f[1]===this.current[1]&&f[2]===this.current[2]&&f[3]===this.current[3]||(this.current=f,this.gl.uniform4f(this.location,f[0],f[1],f[2],f[3])))}}class gC extends Qc{constructor(o){super(o),this.current=Xn.transparent.toRenderColor(null)}set(o,u,f){this.fetchUniformLocation(o,u)&&(f.r===this.current.r&&f.g===this.current.g&&f.b===this.current.b&&f.a===this.current.a||(this.current=f,this.gl.uniform4f(this.location,f.r,f.g,f.b,f.a)))}}const xC=new Float32Array(16);class Xg extends Qc{constructor(o){super(o),this.current=xC}set(o,u,f){if(this.fetchUniformLocation(o,u)){if(f[12]!==this.current[12]||f[0]!==this.current[0])return this.current=f,void this.gl.uniformMatrix4fv(this.location,!1,f);for(let y=1;y<16;y++)if(f[y]!==this.current[y]){this.current=f,this.gl.uniformMatrix4fv(this.location,!1,f);break}}}}const Q1=new Float32Array(9),h4=new Float32Array(4);class ew extends Qc{constructor(o){super(o),this.current=h4}set(o,u,f){if(this.fetchUniformLocation(o,u)){for(let y=0;y<4;y++)if(f[y]!==this.current[y]){this.current=f,this.gl.uniformMatrix2fv(this.location,!1,f);break}}}}function tw(m){return[pC(255*m.r,255*m.g),pC(255*m.b,255*m.a)]}class Jg{constructor(o,u,f,y){this.value=o,this.uniformNames=u.map(g=>`u_${g}`),this.type=f,this.context=y}setUniform(o,u,f,y,g){const _=y.constantOr(this.value);u.set(o,g,_ instanceof Xn?_.toRenderColor(this.lutExpression&&this.lutExpression.value==="none"?null:this.context.lut):_)}getBinding(o,u){return this.type==="color"?new gC(o):new gs(o)}}class qh{constructor(o,u){this.uniformNames=u.map(f=>`u_${f}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(o){this.pixelRatio=o.pixelRatio||1,this.pattern=o.tl.concat(o.br)}setUniform(o,u,f,y,g){const _=g==="u_pattern"||g==="u_dash"?this.pattern:g==="u_pixel_ratio"?this.pixelRatio:null;_&&u.set(o,g,_)}getBinding(o,u){return u==="u_pattern"||u==="u_dash"?new Yg(o):new gs(o)}}class Vu{constructor(o,u,f,y){this.expression=o,this.type=f,this.maxValue=0,this.paintVertexAttributes=u.map(g=>({name:`a_${g}`,type:"Float32",components:f==="color"?2:1,offset:0})),this.paintVertexArray=new y}populatePaintArray(o,u,f,y,g,_,T){const E=this.paintVertexArray.length,O=this.expression.kind==="composite"||this.expression.kind==="source"?this.expression.evaluate(new hi(0,{brightness:_}),u,{},g,y,T):this.expression.kind==="constant"&&this.expression.value,C=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new hi(0,{brightness:_}),u,{},g,y,T):this.lutExpression.value)==="none";this.paintVertexArray.resize(o),this._setPaintValue(E,o,O,C?null:this.context.lut)}updatePaintArray(o,u,f,y,g,_,T){const E=this.expression.kind==="composite"||this.expression.kind==="source"?this.expression.evaluate({zoom:0,brightness:T},f,y,void 0,g):this.expression.kind==="constant"&&this.expression.value,O=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new hi(0,{brightness:T}),f,y,void 0,g):this.lutExpression.value)==="none";this._setPaintValue(o,u,E,O?null:this.context.lut)}_setPaintValue(o,u,f,y){if(this.type==="color"){const g=tw(f.toRenderColor(y));for(let _=o;_<u;_++)this.paintVertexArray.emplace(_,g[0],g[1])}else{for(let g=o;g<u;g++)this.paintVertexArray.emplace(g,f);this.maxValue=Math.max(this.maxValue,Math.abs(f))}}upload(o){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=o.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.lutExpression&&this.lutExpression.kind!=="constant"&&(this.lutExpression.isStateDependent||!this.lutExpression.isLightConstant)||this.expression.kind!=="constant"&&(this.expression.isStateDependent||!this.expression.isLightConstant)))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class mc{constructor(o,u,f,y,g,_){this.expression=o,this.uniformNames=u.map(T=>`u_${T}_t`),this.type=f,this.useIntegerZoom=y,this.context=g,this.maxValue=0,this.paintVertexAttributes=u.map(T=>({name:`a_${T}`,type:"Float32",components:f==="color"?4:2,offset:0})),this.paintVertexArray=new _}populatePaintArray(o,u,f,y,g,_,T){const E=this.expression.evaluate(new hi(this.context.zoom,{brightness:_}),u,{},g,y,T),O=this.expression.evaluate(new hi(this.context.zoom+1,{brightness:_}),u,{},g,y,T),C=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new hi(0,{brightness:_}),u,{},g,y,T):this.lutExpression.value)==="none",M=this.paintVertexArray.length;this.paintVertexArray.resize(o),this._setPaintValue(M,o,E,O,C?null:this.context.lut)}updatePaintArray(o,u,f,y,g,_,T){const E=this.expression.evaluate({zoom:this.context.zoom,brightness:T},f,y,void 0,g),O=this.expression.evaluate({zoom:this.context.zoom+1,brightness:T},f,y,void 0,g),C=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new hi(0,{brightness:T}),f,y,void 0,g):this.lutExpression.value)==="none";this._setPaintValue(o,u,E,O,C?null:this.context.lut)}_setPaintValue(o,u,f,y,g){if(this.type==="color"){const _=tw(f.toRenderColor(g)),T=tw(f.toRenderColor(g));for(let E=o;E<u;E++)this.paintVertexArray.emplace(E,_[0],_[1],T[0],T[1])}else{for(let _=o;_<u;_++)this.paintVertexArray.emplace(_,f,y);this.maxValue=Math.max(this.maxValue,Math.abs(f),Math.abs(y))}}upload(o){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=o.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(o,u,f,y,g){const _=this.useIntegerZoom?Math.floor(f.zoom):f.zoom,T=rr(this.expression.interpolationFactor(_,this.context.zoom,this.context.zoom+1),0,1);u.set(o,g,T)}getBinding(o,u){return new gs(o)}}class Ud{constructor(o,u,f,y,g){this.expression=o,this.layerId=g,this.paintVertexAttributes=(f==="array"?d4:X1).members;for(let _=0;_<u.length;++_);this.paintVertexArray=new y}populatePaintArray(o,u,f,y){const g=this.paintVertexArray.length;this.paintVertexArray.resize(o),this._setPaintValues(g,o,u.patterns&&u.patterns[this.layerId],f)}updatePaintArray(o,u,f,y,g,_,T){this._setPaintValues(o,u,f.patterns&&f.patterns[this.layerId],_)}_setPaintValues(o,u,f,y){if(!y||!f)return;const g=y[f];if(!g)return;const{tl:_,br:T,pixelRatio:E}=g;for(let O=o;O<u;O++)this.paintVertexArray.emplace(O,_[0],_[1],T[0],T[1],E)}upload(o){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=o.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Wh{constructor(o,u,f=()=>!0){this.binders={},this._buffers=[],this.context=u;const y=[];for(const g in o.paint._values){const _=o.paint.get(g);if(g.endsWith("-use-theme")||!f(g)||!(_ instanceof yf&&df(_.property.specification)))continue;const T=f4(g,o.type),E=_.value,O=_.property.specification.type,C=!!_.property.useIntegerZoom,M=g==="line-dasharray"||g.endsWith("pattern"),D=o.paint.get(`${g}-use-theme`),I=g==="line-dasharray"&&o.layout.get("line-cap").value.kind!=="constant"||D&&D.value.kind!=="constant";if(E.kind!=="constant"||I)if(E.kind==="source"||I||M){const R=yC(g,O,"source");this.binders[g]=M?new Ud(E,T,O,R,o.id):new Vu(E,T,O,R),y.push(`/a_${g}`)}else{const R=yC(g,O,"composite");this.binders[g]=new mc(E,T,O,C,u,R),y.push(`/z_${g}`)}else this.binders[g]=M?new qh(E.value,T):new Jg(E.value,T,O,u),y.push(`/u_${g}`);D&&(this.binders[g].lutExpression=D.value)}this.cacheKey=y.sort().join("")}getMaxValue(o){const u=this.binders[o];return u instanceof Vu||u instanceof mc?u.maxValue:0}populatePaintArrays(o,u,f,y,g,_,T){for(const E in this.binders){const O=this.binders[E];O.context=this.context,(O instanceof Vu||O instanceof mc||O instanceof Ud)&&O.populatePaintArray(o,u,f,y,g,_,T)}}setConstantPatternPositions(o){for(const u in this.binders){const f=this.binders[u];f instanceof qh&&f.setConstantPatternPositions(o)}}updatePaintArrays(o,u,f,y,g,_,T,E,O){let C=!1;const M=Object.keys(o),D=M.length!==0&&!E,I=D?M:u.uniqueIds;this.context.lut=g.lut;for(const R in this.binders){const H=this.binders[R];if(H.context=this.context,(H instanceof Vu||H instanceof mc||H instanceof Ud)&&H.expression&&H.expression.kind&&H.expression.kind!=="constant"&&(H.expression.isStateDependent===!0||H.expression.isLightConstant===!1)){const X=g.paint.get(R);H.expression=X.value;for(const J of I){const ne=o[J.toString()];u.eachPosition(J,(re,te,oe)=>{const ue=y.feature(re);H.updatePaintArray(te,oe,ue,ne,_,T,O)})}if(!D)for(const J of f.uniqueIds){const ne=o[J.toString()];f.eachPosition(J,(re,te,oe)=>{const ue=y.feature(re);H.updatePaintArray(te,oe,ue,ne,_,T,O)})}C=!0}}return C}defines(){const o=[];for(const u in this.binders){const f=this.binders[u];(f instanceof Jg||f instanceof qh)&&o.push(...f.uniformNames.map(y=>`#define HAS_UNIFORM_${y}`))}return o}getBinderAttributes(){const o=[];for(const u in this.binders){const f=this.binders[u];if(f instanceof Vu||f instanceof mc||f instanceof Ud)for(let y=0;y<f.paintVertexAttributes.length;y++)o.push(f.paintVertexAttributes[y].name)}return o}getBinderUniforms(){const o=[];for(const u in this.binders){const f=this.binders[u];if(f instanceof Jg||f instanceof qh||f instanceof mc)for(const y of f.uniformNames)o.push(y)}return o}getPaintVertexBuffers(){return this._buffers}getUniforms(o){const u=[];for(const f in this.binders){const y=this.binders[f];if(y instanceof Jg||y instanceof qh||y instanceof mc)for(const g of y.uniformNames)u.push({name:g,property:f,binding:y.getBinding(o,g)})}return u}setUniforms(o,u,f,y,g){for(const{name:_,property:T,binding:E}of f)this.binders[T].setUniform(o,E,g,y.get(T),_)}updatePaintBuffers(){this._buffers=[];for(const o in this.binders){const u=this.binders[o];(u instanceof Vu||u instanceof mc||u instanceof Ud)&&u.paintVertexBuffer&&this._buffers.push(u.paintVertexBuffer)}}upload(o){for(const u in this.binders){const f=this.binders[u];(f instanceof Vu||f instanceof mc||f instanceof Ud)&&f.upload(o)}this.updatePaintBuffers()}destroy(){for(const o in this.binders){const u=this.binders[o];(u instanceof Vu||u instanceof mc||u instanceof Ud)&&u.destroy()}}}class Gd{constructor(o,u,f=()=>!0){this.programConfigurations={};for(const y of o)this.programConfigurations[y.id]=new Wh(y,u,f);this.needsUpload=!1,this._featureMap=new Wg,this._featureMapWithoutIds=new Wg,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(o,u,f,y,g,_,T,E){for(const O in this.programConfigurations)this.programConfigurations[O].populatePaintArrays(o,u,y,g,_,T,E);u.id!==void 0?this._featureMap.add(u.id,f,this._bufferOffset,o):(this._featureMapWithoutIds.add(this._idlessCounter,f,this._bufferOffset,o),this._idlessCounter+=1),this._bufferOffset=o,this.needsUpload=!0}updatePaintArrays(o,u,f,y,g,_,T){for(const E of f)this.needsUpload=this.programConfigurations[E.id].updatePaintArrays(o,this._featureMap,this._featureMapWithoutIds,u,E,y,g,_,T||0)||this.needsUpload}get(o){return this.programConfigurations[o]}upload(o){if(this.needsUpload){for(const u in this.programConfigurations)this.programConfigurations[u].upload(o);this.needsUpload=!1}}destroy(){for(const o in this.programConfigurations)this.programConfigurations[o].destroy()}}const m4={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-occlusion-opacity":["occlusion_opacity"],"icon-occlusion-opacity":["occlusion_opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"symbol-z-offset":["z_offset"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function f4(m,o){return m4[m]||[m.replace(`${o}-`,"").replace(/-/g,"_")]}const p4={"line-pattern":{source:$d,composite:$d},"fill-pattern":{source:$d,composite:$d},"fill-extrusion-pattern":{source:$d,composite:$d},"line-dasharray":{source:hy,composite:hy}},wy={color:{source:Nf,composite:Hh},number:{source:Gh,composite:Nf}};function yC(m,o,u){const f=p4[m];return f&&f[u]||wy[o][u]}lr(Jg,"ConstantBinder"),lr(qh,"PatternConstantBinder"),lr(Vu,"SourceExpressionBinder"),lr(Ud,"PatternCompositeBinder"),lr(mc,"CompositeExpressionBinder"),lr(Wh,"ProgramConfiguration",{omit:["_buffers"]}),lr(Gd,"ProgramConfigurationSet");const oo=Wt/Math.PI/2,Cf=5,vC=6,bC=16383,Af=64,jy=[Af,32,16],cl=-oo,ul=oo;function Tf(m,o,u,f=oo){return u=Ye(u),[m*Math.sin(u)*f,-o*f,m*Math.cos(u)*f]}function Kh(m,o,u){return Tf(Math.cos(Ye(m)),Math.sin(Ye(m)),o,u)}const Zh=63710088e-1,rw=2*Math.PI*Zh;class $n{constructor(o,u){if(isNaN(o)||isNaN(u))throw new Error(`Invalid LngLat object: (${o}, ${u})`);if(this.lng=+o,this.lat=+u,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new $n(ai(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(o){const u=Math.PI/180,f=this.lat*u,y=o.lat*u,g=Math.sin(f)*Math.sin(y)+Math.cos(f)*Math.cos(y)*Math.cos((o.lng-this.lng)*u);return Zh*Math.acos(Math.min(g,1))}toBounds(o=0){const u=360*o/40075017,f=u/Math.cos(Math.PI/180*this.lat);return new Hd({lng:this.lng-f,lat:this.lat-u},{lng:this.lng+f,lat:this.lat+u})}toEcef(o){return Kh(this.lat,this.lng,oo+o*oo/Zh)}static convert(o){if(o instanceof $n)return o;if(Array.isArray(o)&&(o.length===2||o.length===3))return new $n(Number(o[0]),Number(o[1]));if(!Array.isArray(o)&&typeof o=="object"&&o!==null)return new $n(Number("lng"in o?o.lng:o.lon),Number(o.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class Hd{constructor(o,u){if(o)if(u)this.setSouthWest(o).setNorthEast(u);else if(o.length===4){const f=o;this.setSouthWest([f[0],f[1]]).setNorthEast([f[2],f[3]])}else{const f=o;this.setSouthWest(f[0]).setNorthEast(f[1])}}setNorthEast(o){return this._ne=o instanceof $n?new $n(o.lng,o.lat):$n.convert(o),this}setSouthWest(o){return this._sw=o instanceof $n?new $n(o.lng,o.lat):$n.convert(o),this}extend(o){const u=this._sw,f=this._ne;let y,g;if(o instanceof $n)y=o,g=o;else{if(!(o instanceof Hd))return Array.isArray(o)?o.length===4||o.every(Array.isArray)?this.extend(Hd.convert(o)):this.extend($n.convert(o)):typeof o=="object"&&o!==null&&o.hasOwnProperty("lat")&&(o.hasOwnProperty("lon")||o.hasOwnProperty("lng"))?this.extend($n.convert(o)):this;if(y=o._sw,g=o._ne,!y||!g)return this}return u||f?(u.lng=Math.min(y.lng,u.lng),u.lat=Math.min(y.lat,u.lat),f.lng=Math.max(g.lng,f.lng),f.lat=Math.max(g.lat,f.lat)):(this._sw=new $n(y.lng,y.lat),this._ne=new $n(g.lng,g.lat)),this}getCenter(){return new $n((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new $n(this.getWest(),this.getNorth())}getSouthEast(){return new $n(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(o){const{lng:u,lat:f}=$n.convert(o);let y=this._sw.lng<=u&&u<=this._ne.lng;return this._sw.lng>this._ne.lng&&(y=this._sw.lng>=u&&u>=this._ne.lng),this._sw.lat<=f&&f<=this._ne.lat&&y}static convert(o){if(o)return o instanceof Hd?o:new Hd(o)}}const g4=0,x4=25.5;function Ny(m){return rw*Math.cos(m*Math.PI/180)}function eu(m){return(180+m)/360}function ka(m){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+m*Math.PI/360)))/360}function Pa(m,o){return m/Ny(o)}function Lo(m){return 360*m-180}function ba(m){return 360/Math.PI*Math.atan(Math.exp((180-360*m)*Math.PI/180))-90}function nw(m,o){return m*Ny(ba(o))}const ds=85.051129;function _C(m){return Math.cos(Ye(rr(m,-ds,ds)))}function qd(m,o){const u=rr(o,g4,x4),f=Math.pow(2,u);return _C(m)*rw/(512*f)}function y4(m){return 1/Math.cos(m*Math.PI/180)}function b(m,o=0){const u=Math.exp(Math.PI*(1-(m.y+o/Wt)/(1<<m.z)*2));return 80150034*u/(u*u+1)/Wt/(1<<m.z)}class c{constructor(o,u,f=0){this.x=+o,this.y=+u,this.z=+f}static fromLngLat(o,u=0){const f=$n.convert(o);return new c(eu(f.lng),ka(f.lat),Pa(u,f.lat))}toLngLat(){return new $n(Lo(this.x),ba(this.y))}toAltitude(){return nw(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/rw*y4(ba(this.y))}}function h(m,o,u,f,y,g,_,T,E){const O=(o+f)/2,C=(u+y)/2,M=new dt(O,C);T(M),function(D,I,R,H,X,J){const ne=R-X,re=H-J;return Math.abs((H-I)*ne-(R-D)*re)/Math.hypot(ne,re)}(M.x,M.y,g.x,g.y,_.x,_.y)>=E?(h(m,o,u,O,C,g,M,T,E),h(m,O,C,f,y,M,_,T,E)):m.push(_)}function v(m,o,u){let f=m[0],y=f.x,g=f.y;o(f);const _=[f];for(let T=1;T<m.length;T++){const E=m[T],{x:O,y:C}=E;o(E),h(_,y,g,O,C,f,E,o,u),y=O,g=C,f=E}return _}function N(m,o,u,f){if(f(o,u)){const y=o.add(u)._mult(.5);N(m,o,y,f),N(m,y,u,f)}else m.push(u)}function A(m,o){let u=m[0];const f=[u];for(let y=1;y<m.length;y++){const g=m[y];N(f,u,g,o),u=g}return f}const k=Math.pow(2,14)-1,z=-k-1;function q(m,o){const u=Math.round(m.x*o),f=Math.round(m.y*o);return m.x=rr(u,z,k),m.y=rr(f,z,k),(u<m.x||u>m.x+1||f<m.y||f>m.y+1)&&_i("Geometry exceeds allowed extent, reduce your vector tile buffer size"),m}function K(m,o,u){const f=m.loadGeometry(),y=m.extent,g=Wt/y;if(o&&u&&u.projection.isReprojectedInTileSpace){const _=1<<o.z,{scale:T,x:E,y:O,projection:C}=u,M=D=>{const I=Lo((o.x+D.x/y)/_),R=ba((o.y+D.y/y)/_),H=C.project(I,R);D.x=(H.x*T-E)*y,D.y=(H.y*T-O)*y};for(let D=0;D<f.length;D++)if(m.type!==1)f[D]=v(f[D],M,1);else{const I=[];for(const R of f[D])R.x<0||R.x>=y||R.y<0||R.y>=y||(M(R),I.push(R));f[D]=I}}for(const _ of f)for(const T of _)q(T,g);return f}function Y(m,o){return{type:m.type,id:m.id,properties:m.properties,geometry:o?K(m):[]}}function ee(m,o,u,f,y){m.emplaceBack(2*o+(f+1)/2,2*u+(y+1)/2)}function Q(m,o,u){m.emplaceBack(o.x,o.y,o.z,u[0]*16384,u[1]*16384,u[2]*16384)}class ie{constructor(o){this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(u=>u.fqid),this.index=o.index,this.hasPattern=!1,this.projection=o.projection,this.layoutVertexArray=new Bu,this.indexArray=new va,this.segments=new Ti,this.programConfigurations=new Gd(o.layers,{zoom:o.zoom,lut:o.lut}),this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id)}updateFootprints(o,u){}populate(o,u,f,y){const g=this.layers[0],_=[];let T=null;g.type==="circle"&&(T=g.layout.get("circle-sort-key"));for(const{feature:O,id:C,index:M,sourceLayerIndex:D}of o){const I=this.layers[0]._featureFilter.needGeometry,R=Y(O,I);if(!this.layers[0]._featureFilter.filter(new hi(this.zoom),R,f))continue;const H=T?T.evaluate(R,{},f):void 0,X={id:C,properties:O.properties,type:O.type,sourceLayerIndex:D,index:M,geometry:I?R.geometry:K(O,f,y),patterns:{},sortKey:H};_.push(X)}T&&_.sort((O,C)=>O.sortKey-C.sortKey);let E=null;y.projection.name==="globe"&&(this.globeExtVertexArray=new my,E=y.projection);for(const O of _){const{geometry:C,index:M,sourceLayerIndex:D}=O,I=o[M].feature;this.addFeature(O,C,M,u.availableImages,f,E,u.brightness),u.featureIndex.insert(I,C,M,D,this.index)}}update(o,u,f,y,g,_,T){this.programConfigurations.updatePaintArrays(o,u,g,f,y,_,T)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,c4.members),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=o.createVertexBuffer(this.globeExtVertexArray,u4.members))),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(o,u,f,y,g,_,T){for(const E of u)for(const O of E){const C=O.x,M=O.y;if(C<0||C>=Wt||M<0||M>=Wt)continue;if(_){const R=_.projectTilePoint(C,M,g),H=_.upVector(g,C,M),X=this.globeExtVertexArray;Q(X,R,H),Q(X,R,H),Q(X,R,H),Q(X,R,H)}const D=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,o.sortKey),I=D.vertexLength;ee(this.layoutVertexArray,C,M,-1,-1),ee(this.layoutVertexArray,C,M,1,-1),ee(this.layoutVertexArray,C,M,1,1),ee(this.layoutVertexArray,C,M,-1,1),this.indexArray.emplaceBack(I,I+1,I+2),this.indexArray.emplaceBack(I,I+2,I+3),D.vertexLength+=4,D.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,f,{},y,g,T)}}function de(m,o){for(let u=0;u<m.length;u++)if(Fe(o,m[u]))return!0;for(let u=0;u<o.length;u++)if(Fe(m,o[u]))return!0;return!!Te(m,o)}function le(m,o,u){return!!Fe(m,o)||!!Oe(o,m,u)}function he(m,o){if(m.length===1)return Le(o,m[0]);for(let u=0;u<o.length;u++){const f=o[u];for(let y=0;y<f.length;y++)if(Fe(m,f[y]))return!0}for(let u=0;u<m.length;u++)if(Le(o,m[u]))return!0;for(let u=0;u<o.length;u++)if(Te(m,o[u]))return!0;return!1}function fe(m,o,u){if(m.length>1){if(Te(m,o))return!0;for(let f=0;f<o.length;f++)if(Oe(o[f],m,u))return!0}for(let f=0;f<m.length;f++)if(Oe(m[f],o,u))return!0;return!1}function Te(m,o){if(m.length===0||o.length===0)return!1;for(let u=0;u<m.length-1;u++){const f=m[u],y=m[u+1];for(let g=0;g<o.length-1;g++)if(Re(f,y,o[g],o[g+1]))return!0}return!1}function Re(m,o,u,f){return Ir(m,u,f)!==Ir(o,u,f)&&Ir(m,o,u)!==Ir(m,o,f)}function Oe(m,o,u){const f=u*u;if(o.length===1)return m.distSqr(o[0])<f;for(let y=1;y<o.length;y++)if($e(m,o[y-1],o[y])<f)return!0;return!1}function $e(m,o,u){const f=o.distSqr(u);if(f===0)return m.distSqr(o);const y=((m.x-o.x)*(u.x-o.x)+(m.y-o.y)*(u.y-o.y))/f;return m.distSqr(y<0?o:y>1?u:u.sub(o)._mult(y)._add(o))}function Le(m,o){let u,f,y,g=!1;for(let _=0;_<m.length;_++){u=m[_];for(let T=0,E=u.length-1;T<u.length;E=T++)f=u[T],y=u[E],f.y>o.y!=y.y>o.y&&o.x<(y.x-f.x)*(o.y-f.y)/(y.y-f.y)+f.x&&(g=!g)}return g}function Fe(m,o){let u=!1;for(let f=0,y=m.length-1;f<m.length;y=f++){const g=m[f],_=m[y];g.y>o.y!=_.y>o.y&&o.x<(_.x-g.x)*(o.y-g.y)/(_.y-g.y)+g.x&&(u=!u)}return u}function Be(m,o,u,f,y){for(const _ of m)if(o<=_.x&&u<=_.y&&f>=_.x&&y>=_.y)return!0;const g=[new dt(o,u),new dt(o,y),new dt(f,y),new dt(f,u)];if(m.length>2){for(const _ of g)if(Fe(m,_))return!0}for(let _=0;_<m.length-1;_++)if(He(m[_],m[_+1],g))return!0;return!1}function He(m,o,u){const f=u[0],y=u[2];if(m.x<f.x&&o.x<f.x||m.x>y.x&&o.x>y.x||m.y<f.y&&o.y<f.y||m.y>y.y&&o.y>y.y)return!1;const g=Ir(m,o,u[0]);return g!==Ir(m,o,u[1])||g!==Ir(m,o,u[2])||g!==Ir(m,o,u[3])}function Ke(m,o,u,f,y,g){let _=o.y-m.y,T=m.x-o.x;if(g=g||0){const E=_*_+T*T;if(E===0)return!0;const O=Math.sqrt(E);_/=O,T/=O}return!((u.x-m.x)*_+(u.y-m.y)*T-g<0||(f.x-m.x)*_+(f.y-m.y)*T-g<0||(y.x-m.x)*_+(y.y-m.y)*T-g<0)}function ft(m,o,u,f,y,g,_){return!(Ke(m,o,f,y,g,_)||Ke(o,u,f,y,g,_)||Ke(u,m,f,y,g,_)||Ke(f,y,m,o,u,_)||Ke(y,g,m,o,u,_)||Ke(g,f,m,o,u,_))}function at(m,o,u){const f=o.paint.get(m).value;return f.kind==="constant"?f.value:u.programConfigurations.get(o.id).getMaxValue(m)}function kt(m){return Math.sqrt(m[0]*m[0]+m[1]*m[1])}function Pt(m,o,u,f,y){if(!o[0]&&!o[1])return m;const g=dt.convert(o)._mult(y);u==="viewport"&&g._rotate(-f);const _=[];for(let T=0;T<m.length;T++)_.push(m[T].sub(g));return _}function Bt(m,o,u,f){const y=dt.convert(m)._mult(f);return o==="viewport"&&y._rotate(-u),y}let st,At;lr(ie,"CircleBucket",{omit:["layers"]});var rt,Ct={exports:{}},_t=(rt||(rt=1,function(m,o){(function(u){function f(g,_,T){var E=y(256*g,256*(_=Math.pow(2,T)-_-1),T),O=y(256*(g+1),256*(_+1),T);return E[0]+","+E[1]+","+O[0]+","+O[1]}function y(g,_,T){var E=2*Math.PI*6378137/256/Math.pow(2,T);return[g*E-2*Math.PI*6378137/2,_*E-2*Math.PI*6378137/2]}u.getURL=function(g,_,T,E,O,C){return C=C||{},g+"?"+["bbox="+f(T,E,O),"format="+(C.format||"image/png"),"service="+(C.service||"WMS"),"version="+(C.version||"1.1.1"),"request="+(C.request||"GetMap"),"srs="+(C.srs||"EPSG:3857"),"width="+(C.width||256),"height="+(C.height||256),"layers="+_].join("&")},u.getTileBBox=f,u.getMercCoords=y,Object.defineProperty(u,"__esModule",{value:!0})})(o)}(0,Ct.exports)),Ct.exports);class Et{constructor(o,u,f){this.z=o,this.x=u,this.y=f,this.key=Kt(0,o,o,u,f)}equals(o){return this.z===o.z&&this.x===o.x&&this.y===o.y}url(o,u){const f=_t.getTileBBox(this.x,this.y,this.z),y=function(g,_,T){let E,O="";for(let C=g;C>0;C--)E=1<<C-1,O+=(_&E?1:0)+(T&E?2:0);return O}(this.z,this.x,this.y);return o[(this.x+this.y)%o.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(u==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",y).replace("{bbox-epsg-3857}",f)}toString(){return`${this.z}/${this.x}/${this.y}`}}class pt{constructor(o,u){this.wrap=o,this.canonical=u,this.key=Kt(o,u.z,u.z,u.x,u.y)}}class It{constructor(o,u,f,y,g){this.overscaledZ=o,this.wrap=u,this.canonical=new Et(f,+y,+g),this.key=u===0&&o===f?this.canonical.key:Kt(u,o,f,y,g)}equals(o){return this.overscaledZ===o.overscaledZ&&this.wrap===o.wrap&&this.canonical.equals(o.canonical)}scaledTo(o){const u=this.canonical.z-o;return o>this.canonical.z?new It(o,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new It(o,this.wrap,o,this.canonical.x>>u,this.canonical.y>>u)}calculateScaledKey(o,u=!0){if(this.overscaledZ===o&&u)return this.key;if(o>this.canonical.z)return Kt(this.wrap*+u,o,this.canonical.z,this.canonical.x,this.canonical.y);{const f=this.canonical.z-o;return Kt(this.wrap*+u,o,o,this.canonical.x>>f,this.canonical.y>>f)}}isChildOf(o){if(o.wrap!==this.wrap)return!1;const u=this.canonical.z-o.canonical.z;return o.overscaledZ===0||o.overscaledZ<this.overscaledZ&&o.canonical.z<this.canonical.z&&o.canonical.x===this.canonical.x>>u&&o.canonical.y===this.canonical.y>>u}children(o){if(this.overscaledZ>=o)return[new It(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const u=this.canonical.z+1,f=2*this.canonical.x,y=2*this.canonical.y;return[new It(u,this.wrap,u,f,y),new It(u,this.wrap,u,f+1,y),new It(u,this.wrap,u,f,y+1),new It(u,this.wrap,u,f+1,y+1)]}isLessThan(o){return this.wrap<o.wrap||!(this.wrap>o.wrap)&&(this.overscaledZ<o.overscaledZ||!(this.overscaledZ>o.overscaledZ)&&(this.canonical.x<o.canonical.x||!(this.canonical.x>o.canonical.x)&&this.canonical.y<o.canonical.y))}wrapped(){return new It(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(o){return new It(this.overscaledZ,o,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new pt(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Kt(m,o,u,f,y){const g=1<<Math.min(u,22);let _=g*(y%g)+f%g;return m&&u<22&&(_+=g*g*((m<0?-2*m-1:2*m)%(1<<2*(22-u)))),16*(32*_+u)+(o-u)}const Zt=[m=>{let o=m.canonical.x-1,u=m.wrap;return o<0&&(o=(1<<m.canonical.z)-1,u--),new It(m.overscaledZ,u,m.canonical.z,o,m.canonical.y)},m=>{let o=m.canonical.x+1,u=m.wrap;return o===1<<m.canonical.z&&(o=0,u++),new It(m.overscaledZ,u,m.canonical.z,o,m.canonical.y)},m=>new It(m.overscaledZ,m.wrap,m.canonical.z,m.canonical.x,(m.canonical.y===0?1<<m.canonical.z:m.canonical.y)-1),m=>new It(m.overscaledZ,m.wrap,m.canonical.z,m.canonical.x,m.canonical.y===(1<<m.canonical.z)-1?0:m.canonical.y+1)];lr(Et,"CanonicalTileID"),lr(It,"OverscaledTileID",{omit:["projMatrix","expandedProjMatrix"]});const Qt=Bn([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:gr}=Qt,qr=Bn([{name:"a_pos_3",components:3,type:"Int16"}]);var Er=Bn([{name:"a_pos",type:"Int16",components:2}]);class Br{constructor(o,u){this.pos=o,this.dir=u}intersectsPlane(o,u,f){const y=ge.vec2.dot(u,this.dir);if(Math.abs(y)<1e-6)return!1;const g=((o[0]-this.pos[0])*u[0]+(o[1]-this.pos[1])*u[1])/y;return f[0]=this.pos[0]+this.dir[0]*g,f[1]=this.pos[1]+this.dir[1]*g,!0}}class zr{constructor(o,u){this.pos=o,this.dir=u}intersectsPlane(o,u,f){const y=ge.vec3.dot(u,this.dir);if(Math.abs(y)<1e-6)return!1;const g=((o[0]-this.pos[0])*u[0]+(o[1]-this.pos[1])*u[1]+(o[2]-this.pos[2])*u[2])/y;return f[0]=this.pos[0]+this.dir[0]*g,f[1]=this.pos[1]+this.dir[1]*g,f[2]=this.pos[2]+this.dir[2]*g,!0}closestPointOnSphere(o,u,f){if(ge.vec3.equals(this.pos,o)||u===0)return f[0]=f[1]=f[2]=0,!1;const[y,g,_]=this.dir,T=this.pos[0]-o[0],E=this.pos[1]-o[1],O=this.pos[2]-o[2],C=y*y+g*g+_*_,M=2*(T*y+E*g+O*_),D=M*M-4*C*(T*T+E*E+O*O-u*u);if(D<0){const I=Math.max(-M/2,0),R=T+y*I,H=E+g*I,X=O+_*I,J=Math.hypot(R,H,X);return f[0]=R*u/J,f[1]=H*u/J,f[2]=X*u/J,!1}{const I=(-M-Math.sqrt(D))/(2*C);if(I<0){const R=Math.hypot(T,E,O);return f[0]=T*u/R,f[1]=E*u/R,f[2]=O*u/R,!1}return f[0]=T+y*I,f[1]=E+g*I,f[2]=O+_*I,!0}}}class bn{constructor(o,u,f,y,g){this.TL=o,this.TR=u,this.BR=f,this.BL=y,this.horizon=g}static fromInvProjectionMatrix(o,u,f){const y=[-1,1,1],g=[1,1,1],_=[1,-1,1],T=[-1,-1,1],E=ge.vec3.transformMat4(y,y,o),O=ge.vec3.transformMat4(g,g,o),C=ge.vec3.transformMat4(_,_,o),M=ge.vec3.transformMat4(T,T,o);return new bn(E,O,C,M,u/f)}}function Vn(m,o,u){let f=1/0,y=-1/0;const g=[];for(const _ of m){ge.vec3.sub(g,_,o);const T=ge.vec3.dot(g,u);f=Math.min(f,T),y=Math.max(y,T)}return[f,y]}function fi(m,o){let u=!0;for(let f=0;f<m.planes.length;f++){const y=m.planes[f];let g=0;for(let _=0;_<o.length;_++)g+=ge.vec3.dot(y,o[_])+y[3]>=0;if(g===0)return 0;g!==o.length&&(u=!1)}return u?2:1}function un(m,o){for(const u of m.projections){const f=Vn(o,m.points[0],u.axis);if(u.projection[1]<f[0]||u.projection[0]>f[1])return 0}return 1}function ki(m,o){let u=0;const f=[0,0,0,0];for(let y=0;y<m.length;y++)f[0]=m[y][0],f[1]=m[y][1],f[2]=m[y][2],f[3]=1,ge.vec4.dot(f,o)>=0&&u++;return u}class Zr{constructor(o,u){this.points=o||new Array(8).fill([0,0,0]),this.planes=u||new Array(6).fill([0,0,0,0]),this.bounds=xr.fromPoints(this.points),this.projections=[],this.frustumEdges=[ge.vec3.sub([],this.points[2],this.points[3]),ge.vec3.sub([],this.points[0],this.points[3]),ge.vec3.sub([],this.points[4],this.points[0]),ge.vec3.sub([],this.points[5],this.points[1]),ge.vec3.sub([],this.points[6],this.points[2]),ge.vec3.sub([],this.points[7],this.points[3])];for(const f of this.frustumEdges){const y=[0,-f[2],f[1]],g=[f[2],0,-f[0]];this.projections.push({axis:y,projection:Vn(this.points,this.points[0],y)}),this.projections.push({axis:g,projection:Vn(this.points,this.points[0],g)})}}static fromInvProjectionMatrix(o,u,f,y){const g=Math.pow(2,f),_=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(O=>{const C=ge.vec4.transformMat4([],O,o),M=1/C[3]/u*g;return ge.vec4.mul(C,C,[M,M,y?1/C[3]:M,M])}),T=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(O=>{const C=ge.vec3.sub([],_[O[0]],_[O[1]]),M=ge.vec3.sub([],_[O[2]],_[O[1]]),D=ge.vec3.normalize([],ge.vec3.cross([],C,M)),I=-ge.vec3.dot(D,_[O[1]]);return D.concat(I)}),E=[];for(let O=0;O<_.length;O++)E.push([_[O][0],_[O][1],_[O][2]]);return new Zr(E,T)}intersectsPrecise(o,u,f){for(let y=0;y<u.length;y++)if(!ki(o,u[y]))return 0;for(let y=0;y<this.planes.length;y++)if(!ki(o,this.planes[y]))return 0;for(const y of f)for(const g of this.frustumEdges){const _=ge.vec3.cross([],y,g),T=ge.vec3.length(_);if(T===0)continue;ge.vec3.scale(_,_,1/T);const E=Vn(this.points,this.points[0],_),O=Vn(o,this.points[0],_);if(E[0]>O[1]||O[0]>E[1])return 0}return 1}containsPoint(o){for(const u of this.planes){const f=u[3];if(ge.vec3.dot([u[0],u[1],u[2]],o)+f<0)return!1}return!0}}class xr{static fromPoints(o){const u=[1/0,1/0,1/0],f=[-1/0,-1/0,-1/0];for(const y of o)ge.vec3.min(u,u,y),ge.vec3.max(f,f,y);return new xr(u,f)}static fromTileIdAndHeight(o,u,f){const y=1<<o.canonical.z,g=o.canonical.x,_=o.canonical.y;return new xr([g/y,_/y,u],[(g+1)/y,(_+1)/y,f])}static applyTransform(o,u){const f=o.getCorners();for(let y=0;y<f.length;++y)ge.vec3.transformMat4(f[y],f[y],u);return xr.fromPoints(f)}static applyTransformFast(o,u){const f=[u[12],u[13],u[14]],y=[...f];for(let g=0;g<3;g++)for(let _=0;_<3;_++){const T=u[4*_+g],E=T*o.min[_],O=T*o.max[_];f[g]+=Math.min(E,O),y[g]+=Math.max(E,O)}return new xr(f,y)}static projectAabbCorners(o,u){const f=o.getCorners();for(let y=0;y<f.length;++y)ge.vec3.transformMat4(f[y],f[y],u);return f}constructor(o,u){this.min=o,this.max=u,this.center=ge.vec3.scale([],ge.vec3.add([],this.min,this.max),.5)}quadrant(o){const u=[o%2==0,o<2],f=ge.vec3.clone(this.min),y=ge.vec3.clone(this.max);for(let g=0;g<u.length;g++)f[g]=u[g]?this.min[g]:this.center[g],y[g]=u[g]?this.center[g]:this.max[g];return y[2]=this.max[2],new xr(f,y)}distanceX(o){return Math.max(Math.min(this.max[0],o[0]),this.min[0])-o[0]}distanceY(o){return Math.max(Math.min(this.max[1],o[1]),this.min[1])-o[1]}distanceZ(o){return Math.max(Math.min(this.max[2],o[2]),this.min[2])-o[2]}getCorners(){const o=this.min,u=this.max;return[[o[0],o[1],o[2]],[u[0],o[1],o[2]],[u[0],u[1],o[2]],[o[0],u[1],o[2]],[o[0],o[1],u[2]],[u[0],o[1],u[2]],[u[0],u[1],u[2]],[o[0],u[1],u[2]]]}intersects(o){return this.intersectsAabb(o.bounds)?fi(o,this.getCorners()):0}intersectsFlat(o){return this.intersectsAabb(o.bounds)?fi(o,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(o,u){return u||this.intersects(o)?un(o,this.getCorners()):0}intersectsPreciseFlat(o,u){return u||this.intersectsFlat(o)?un(o,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(o){for(let u=0;u<3;++u)if(this.min[u]>o.max[u]||o.min[u]>this.max[u])return!1;return!0}intersectsAabbXY(o){return!(this.min[0]>o.max[0]||o.min[0]>this.max[0]||this.min[1]>o.max[1]||o.min[1]>this.max[1])}encapsulate(o){for(let u=0;u<3;u++)this.min[u]=Math.min(this.min[u],o.min[u]),this.max[u]=Math.max(this.max[u],o.max[u])}encapsulatePoint(o){for(let u=0;u<3;u++)this.min[u]=Math.min(this.min[u],o[u]),this.max[u]=Math.max(this.max[u],o[u])}closestPoint(o){return[Math.max(Math.min(this.max[0],o[0]),this.min[0]),Math.max(Math.min(this.max[1],o[1]),this.min[1]),Math.max(Math.min(this.max[2],o[2]),this.min[2])]}}function Nn(m){return m*oo/Zh}lr(xr,"Aabb");const Jn=[new xr([cl,cl,cl],[ul,ul,ul]),new xr([cl,cl,cl],[0,0,ul]),new xr([0,cl,cl],[ul,0,ul]),new xr([cl,0,cl],[0,ul,ul]),new xr([0,0,cl],[ul,ul,ul])];function On(m,o,u,f=!0){const y=ge.vec3.scale([],m._camera.position,m.worldSize),g=[o,u,1,1];ge.vec4.transformMat4(g,g,m.pixelMatrixInverse),ge.vec4.scale(g,g,1/g[3]);const _=ge.vec3.sub([],g,y),T=ge.vec3.normalize([],_),E=m.globeMatrix,O=[E[12],E[13],E[14]],C=ge.vec3.sub([],O,y),M=ge.vec3.length(C),D=ge.vec3.normalize([],C),I=m.worldSize/(2*Math.PI),R=ge.vec3.dot(D,T),H=Math.asin(I/M);if(H<Math.acos(R)){if(!f)return null;const Ve=[],Ie=[];ge.vec3.scale(Ve,T,M/R),ge.vec3.normalize(Ie,ge.vec3.sub(Ie,Ve,C)),ge.vec3.normalize(T,ge.vec3.add(T,C,ge.vec3.scale(T,Ie,Math.tan(H)*M)))}const X=[];new zr(y,T).closestPointOnSphere(O,I,X);const J=ge.vec3.normalize([],Kc(E,0)),ne=ge.vec3.normalize([],Kc(E,1)),re=ge.vec3.normalize([],Kc(E,2)),te=ge.vec3.dot(J,X),oe=ge.vec3.dot(ne,X),ue=ge.vec3.dot(re,X),me=Nt(Math.asin(-oe/I));let Me=Nt(Math.atan2(te,ue));Me=m.center.lng+function(Ve,Ie){const Ge=(Ie-Ve+180)%360-180;return Ge<-180?Ge+360:Ge}(m.center.lng,Me);const Se=eu(Me),Ae=rr(ka(me),0,1);return new c(Se,Ae)}class es{constructor(o,u,f){this.a=ge.vec3.sub([],o,f),this.b=ge.vec3.sub([],u,f),this.center=f;const y=ge.vec3.normalize([],this.a),g=ge.vec3.normalize([],this.b);this.angle=Math.acos(ge.vec3.dot(y,g))}}function js(m,o){if(m.angle===0)return null;let u;return u=m.a[o]===0?1/m.angle*.5*Math.PI:1/m.angle*Math.atan(m.b[o]/m.a[o]/Math.sin(m.angle)-1/Math.tan(m.angle)),u<0||u>1?null:function(f,y,g,_){const T=Math.sin(g);return f*(Math.sin((1-_)*g)/T)+y*(Math.sin(_*g)/T)}(m.a[o],m.b[o],m.angle,rr(u,0,1))+m.center[o]}function Gs(m){if(m.z<=1)return Jn[m.z+2*m.y+m.x];const o=Pi(Pn(m));return xr.fromPoints(o)}function Qs(m,o,u){return ge.vec3.scale(m,m,1-u),ge.vec3.scaleAndAdd(m,m,o,u)}function dl(m,o,u){for(const f of m)ge.vec3.transformMat4(f,f,o),ge.vec3.scale(f,f,u)}function Wa(m,o,u,f){const y=o/m.worldSize,g=m.globeMatrix;if(u.z<=1){const Se=Gs(u).getCorners();return dl(Se,g,y),xr.fromPoints(Se)}const _=Pn(u,f),T=Pi(_,oo+Nn(m._tileCoverLift));dl(T,g,y);const E=Number.MAX_VALUE,O=[-E,-E,-E],C=[E,E,E];if(_.contains(m.center)){for(const Ve of T)ge.vec3.min(C,C,Ve),ge.vec3.max(O,O,Ve);O[2]=0;const Se=m.point,Ae=[Se.x*y,Se.y*y,0];return ge.vec3.min(C,C,Ae),ge.vec3.max(O,O,Ae),new xr(C,O)}if(m._tileCoverLift>0){for(const Se of T)ge.vec3.min(C,C,Se),ge.vec3.max(O,O,Se);return new xr(C,O)}const M=[g[12]*y,g[13]*y,g[14]*y],D=_.getCenter(),I=rr(m.center.lat,-ds,ds),R=rr(D.lat,-ds,ds),H=eu(m.center.lng),X=ka(I);let J=H-eu(D.lng);const ne=X-ka(R);J>.5?J-=1:J<-.5&&(J+=1);let re=0;if(Math.abs(J)>Math.abs(ne))re=J>=0?1:3;else{re=ne>=0?0:2;const Se=[g[4]*y,g[5]*y,g[6]*y],Ae=-Math.sin(Ye(ne>=0?_.getSouth():_.getNorth()))*oo;ge.vec3.scaleAndAdd(M,M,Se,Ae)}const te=T[re],oe=T[(re+1)%4],ue=new es(te,oe,M),me=[js(ue,0)||te[0],js(ue,1)||te[1],js(ue,2)||te[2]],Me=_o(m.zoom);if(Me>0){const Se=function({x:Ve,y:Ie,z:Ge},Ze,We,Qe,Je){const ot=1/(1<<Ge);let nt=Ve*ot,ct=nt+ot,Ot=Ie*ot,Mt=Ot+ot,cr=0;const Lt=(nt+ct)/2-Qe;return Lt>.5?cr=-1:Lt<-.5&&(cr=1),nt=((nt+cr)*Ze-(Qe*=Ze))*We+Qe,ct=((ct+cr)*Ze-Qe)*We+Qe,Ot=(Ot*Ze-(Je*=Ze))*We+Je,Mt=(Mt*Ze-Je)*We+Je,[[nt,Mt,0],[ct,Mt,0],[ct,Ot,0],[nt,Ot,0]]}(u,o,m._pixelsPerMercatorPixel,H,X);for(let Ve=0;Ve<T.length;Ve++)Qs(T[Ve],Se[Ve],Me);const Ae=ge.vec3.add([],Se[re],Se[(re+1)%4]);ge.vec3.scale(Ae,Ae,.5),Qs(me,Ae,Me)}for(const Se of T)ge.vec3.min(C,C,Se),ge.vec3.max(O,O,Se);return C[2]=Math.min(te[2],oe[2]),ge.vec3.min(C,C,me),ge.vec3.max(O,O,me),new xr(C,O)}function Pn({x:m,y:o,z:u},f=!1){const y=1/(1<<u),g=new $n(Lo(m*y),o===(1<<u)-1&&f?-90:ba((o+1)*y)),_=new $n(Lo((m+1)*y),o===0&&f?90:ba(o*y));return new Hd(g,_)}function Pi(m,o=oo){const u=Ye(m.getNorth()),f=Ye(m.getSouth()),y=Math.cos(u),g=Math.cos(f),_=Math.sin(u),T=Math.sin(f),E=m.getWest(),O=m.getEast();return[Tf(g,T,E,o),Tf(g,T,O,o),Tf(y,_,O,o),Tf(y,_,E,o)]}function Un(m,o,u,f){const y=1<<u.z,g=(m/Wt+u.x)/y;return Kh(ba((o/Wt+u.y)/y),Lo(g),f)}function oi({min:m,max:o}){return bC/Math.max(o[0]-m[0],o[1]-m[1],o[2]-m[2])}const _a=new Float64Array(16);function ji(m){const o=oi(m),u=ge.mat4.fromScaling(_a,[o,o,o]);return ge.mat4.translate(u,u,ge.vec3.negate([],m.min))}function Hs(m){const o=ge.mat4.fromTranslation(_a,m.min),u=1/oi(m);return ge.mat4.scale(o,o,[u,u,u])}function tu(m){const o=Wt/(2*Math.PI);return m/(2*Math.PI)/o}function Fo(m,o){return Wt/(512*Math.pow(2,m))*oi(Gs(o))}function Vl(m,o,u,f,y){const g=tu(u),_=[m,o,-u/(2*Math.PI)],T=ge.mat4.identity(new Float64Array(16));return ge.mat4.translate(T,T,_),ge.mat4.scale(T,T,[g,g,g]),ge.mat4.rotateX(T,T,Ye(-y)),ge.mat4.rotateY(T,T,Ye(-f)),T}function _o(m){return an(Cf,vC,m)}function Ul(m,o){const u=Kh(o.lat,o.lng),f=function(g){const _=Kh(g._center.lat,g._center.lng),T=ge.vec3.fromValues(0,1,0);let E=ge.vec3.cross([],T,_);const O=ge.mat4.fromRotation([],-g.angle,_);E=ge.vec3.transformMat4(E,E,O),ge.mat4.fromRotation(O,-g._pitch,E);const C=ge.vec3.normalize([],_);return ge.vec3.scale(C,C,Nn(g.cameraToCenterDistance/g.pixelsPerMeter)),ge.vec3.transformMat4(C,C,O),ge.vec3.add([],_,C)}(m),y=ge.vec3.subtract([],f,u);return ge.vec3.angle(y,u)}function Bo(m,o){return Ul(m,o)>Math.PI/2*1.01}const Uu=Ye(85),ru=Math.cos(Uu),Gu=Math.sin(Uu),iw=ge.mat4.create(),kf=m=>{const o=[];return m.paint.get("circle-pitch-alignment")==="map"&&o.push("PITCH_WITH_MAP"),m.paint.get("circle-pitch-scale")==="map"&&o.push("SCALE_WITH_MAP"),o};function Sy(m,o,u,f,y,g,_,T,E){if(g&&m.queryGeometry.isAboveHorizon)return!1;g&&(E*=m.pixelToTileUnitsFactor);const O=m.tileID.canonical,C=u.projection.upVectorScale(O,u.center.lat,u.worldSize).metersToTile;for(const M of o)for(const D of M){const I=D.add(T),R=y&&u.elevation?u.elevation.exaggeration()*y.getElevationAt(I.x,I.y,!0):0,H=u.projection.projectTilePoint(I.x,I.y,O);if(R>0){const re=u.projection.upVector(O,I.x,I.y);H.x+=re[0]*C*R,H.y+=re[1]*C*R,H.z+=re[2]*C*R}const X=g?I:sw(H.x,H.y,H.z,f),J=g?m.tilespaceRays.map(re=>eme(re,R)):m.queryGeometry.screenGeometry,ne=ge.vec4.transformMat4([],[H.x,H.y,H.z,1],f);if(!_&&g?E*=ne[3]/u.cameraToCenterDistance:_&&!g&&(E*=u.cameraToCenterDistance/ne[3]),g){const re=ba((D.y/Wt+O.y)/(1<<O.z));E/=u.projection.pixelsPerMeter(re,1)/Pa(1,re)}if(le(J,X,E))return!0}return!1}function sw(m,o,u,f){const y=ge.vec4.transformMat4([],[m,o,u,1],f);return new dt(y[0]/y[3],y[1]/y[3])}const L$=ge.vec3.fromValues(0,0,0),Qhe=ge.vec3.fromValues(0,0,1);function eme(m,o){const u=ge.vec3.create();return L$[2]=o,m.intersectsPlane(L$,Qhe,u),new dt(u[0],u[1])}class F$ extends ie{}let B$,$$,V$,U$;function G$(m,{width:o,height:u},f,y){if(y){if(y instanceof Uint8ClampedArray)y=new Uint8Array(y.buffer);else if(y.length!==o*u*f)throw new RangeError("mismatched image size")}else y=new Uint8Array(o*u*f);return m.width=o,m.height=u,m.data=y,m}function H$(m,o,u){const{width:f,height:y}=o;f===m.width&&y===m.height||(v4(m,o,{x:0,y:0},{x:0,y:0},{width:Math.min(m.width,f),height:Math.min(m.height,y)},u,null),m.width=f,m.height=y,m.data=o.data)}function v4(m,o,u,f,y,g,_,T){if(y.width===0||y.height===0)return o;if(y.width>m.width||y.height>m.height||u.x>m.width-y.width||u.y>m.height-y.height)throw new RangeError("out of range source coordinates for image copy");if(y.width>o.width||y.height>o.height||f.x>o.width-y.width||f.y>o.height-y.height)throw new RangeError("out of range destination coordinates for image copy");const E=m.data,O=o.data,C=g===4&&T;for(let M=0;M<y.height;M++){const D=((u.y+M)*m.width+u.x)*g,I=((f.y+M)*o.width+f.x)*g;if(C)for(let R=0;R<y.width;R++){const H=D+R*g+3,X=I+R*g;O[X+0]=255,O[X+1]=255,O[X+2]=255,O[X+3]=E[H]}else if(_)for(let R=0;R<y.width;R++){const H=D+R*g,X=I+R*g,J=E[H+3],ne=new Xn(E[H+0]/255*J,E[H+1]/255*J,E[H+2]/255*J,J).toRenderColor(_).toArray();O[X+0]=ne[0],O[X+1]=ne[1],O[X+2]=ne[2],O[X+3]=ne[3]}else for(let R=0;R<y.width*g;R++)O[I+R]=E[D+R]}return o}lr(F$,"HeatmapBucket",{omit:["layers"]});class Pf{constructor(o,u){G$(this,o,1,u)}resize(o){H$(this,new Pf(o),1)}clone(){return new Pf({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(o,u,f,y,g){v4(o,u,f,y,g,1,null)}}class Ea{constructor(o,u){G$(this,o,4,u)}resize(o){H$(this,new Ea(o),4)}replace(o,u){u?this.data.set(o):this.data=o instanceof Uint8ClampedArray?new Uint8Array(o.buffer):o}clone(){return new Ea({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(o,u,f,y,g,_,T){v4(o,u,f,y,g,4,_,T)}}class q${constructor(o,u){this.width=o.width,this.height=o.height,this.data=u instanceof Uint8Array?new Float32Array(u.buffer):u}}function aw(m){const o={},u=m.resolution||256,f=m.clips?m.clips.length:1,y=m.image||new Ea({width:u,height:f}),g=(_,T,E)=>{o[m.evaluationKey]=E;const O=m.expression.evaluate(o);O&&(y.data[_+T+0]=Math.floor(255*O.r/O.a),y.data[_+T+1]=Math.floor(255*O.g/O.a),y.data[_+T+2]=Math.floor(255*O.b/O.a),y.data[_+T+3]=Math.floor(255*O.a))};if(m.clips)for(let _=0,T=0;_<f;++_,T+=4*u)for(let E=0,O=0;E<u;E++,O+=4){const C=E/(u-1),{start:M,end:D}=m.clips[_];g(T,O,M*(1-C)+D*C)}else for(let _=0,T=0;_<u;_++,T+=4)g(0,T,_/(u-1));return y}lr(Pf,"AlphaImage"),lr(Ea,"RGBAImage");const tme=Bn([{name:"a_pos",components:2,type:"Int16"}],4),rme=Bn([{name:"a_road_z_offset",components:1,type:"Float32"}],4),nme=Bn([{name:"a_pos",components:2,type:"Int16"},{name:"a_height",components:1,type:"Float32"}],4),ime=Bn([{name:"a_pos_normal_3",components:3,type:"Int16"}],4);function ow(m,o,u=2){const f=o&&o.length,y=f?o[0]*u:m.length;let g=W$(m,0,y,u,!0);const _=[];if(!g||g.next===g.prev)return _;let T,E,O;if(f&&(g=function(C,M,D,I){const R=[];for(let H=0,X=M.length;H<X;H++){const J=W$(C,M[H]*I,H<X-1?M[H+1]*I:C.length,I,!1);J===J.next&&(J.steiner=!0),R.push(hme(J))}R.sort(cme);for(let H=0;H<R.length;H++)D=ume(R[H],D);return D}(m,o,g,u)),m.length>80*u){T=1/0,E=1/0;let C=-1/0,M=-1/0;for(let D=u;D<y;D+=u){const I=m[D],R=m[D+1];I<T&&(T=I),R<E&&(E=R),I>C&&(C=I),R>M&&(M=R)}O=Math.max(C-T,M-E),O=O!==0?32767/O:0}return lw(g,_,u,T,E,O,0),_}function W$(m,o,u,f,y){let g;if(y===function(_,T,E,O){let C=0;for(let M=T,D=E-O;M<E;M+=O)C+=(_[D]-_[M])*(_[M+1]+_[D+1]),D=M;return C}(m,o,u,f)>0)for(let _=o;_<u;_+=f)g=Y$(_/f|0,m[_],m[_+1],g);else for(let _=u-f;_>=o;_-=f)g=Y$(_/f|0,m[_],m[_+1],g);return g&&wC(g,g.next)&&(uw(g),g=g.next),g}function Qg(m,o){if(!m)return m;o||(o=m);let u,f=m;do if(u=!1,f.steiner||!wC(f,f.next)&&ea(f.prev,f,f.next)!==0)f=f.next;else{if(uw(f),f=o=f.prev,f===f.next)break;u=!0}while(u||f!==o);return o}function lw(m,o,u,f,y,g,_){if(!m)return;!_&&g&&function(E,O,C,M){let D=E;do D.z===0&&(D.z=b4(D.x,D.y,O,C,M)),D.prevZ=D.prev,D.nextZ=D.next,D=D.next;while(D!==E);D.prevZ.nextZ=null,D.prevZ=null,function(I){let R,H=1;do{let X,J=I;I=null;let ne=null;for(R=0;J;){R++;let re=J,te=0;for(let ue=0;ue<H&&(te++,re=re.nextZ,re);ue++);let oe=H;for(;te>0||oe>0&&re;)te!==0&&(oe===0||!re||J.z<=re.z)?(X=J,J=J.nextZ,te--):(X=re,re=re.nextZ,oe--),ne?ne.nextZ=X:I=X,X.prevZ=ne,ne=X;J=re}ne.nextZ=null,H*=2}while(R>1)}(D)}(m,f,y,g);let T=m;for(;m.prev!==m.next;){const E=m.prev,O=m.next;if(g?ame(m,f,y,g):sme(m))o.push(E.i,m.i,O.i),uw(m),m=O.next,T=O.next;else if((m=O)===T){_?_===1?lw(m=ome(Qg(m),o),o,u,f,y,g,2):_===2&&lme(m,o,u,f,y,g):lw(Qg(m),o,u,f,y,g,1);break}}}function sme(m){const o=m.prev,u=m,f=m.next;if(ea(o,u,f)>=0)return!1;const y=o.x,g=u.x,_=f.x,T=o.y,E=u.y,O=f.y,C=y<g?y<_?y:_:g<_?g:_,M=T<E?T<O?T:O:E<O?E:O,D=y>g?y>_?y:_:g>_?g:_,I=T>E?T>O?T:O:E>O?E:O;let R=f.next;for(;R!==o;){if(R.x>=C&&R.x<=D&&R.y>=M&&R.y<=I&&Cy(y,T,g,E,_,O,R.x,R.y)&&ea(R.prev,R,R.next)>=0)return!1;R=R.next}return!0}function ame(m,o,u,f){const y=m.prev,g=m,_=m.next;if(ea(y,g,_)>=0)return!1;const T=y.x,E=g.x,O=_.x,C=y.y,M=g.y,D=_.y,I=T<E?T<O?T:O:E<O?E:O,R=C<M?C<D?C:D:M<D?M:D,H=T>E?T>O?T:O:E>O?E:O,X=C>M?C>D?C:D:M>D?M:D,J=b4(I,R,o,u,f),ne=b4(H,X,o,u,f);let re=m.prevZ,te=m.nextZ;for(;re&&re.z>=J&&te&&te.z<=ne;){if(re.x>=I&&re.x<=H&&re.y>=R&&re.y<=X&&re!==y&&re!==_&&Cy(T,C,E,M,O,D,re.x,re.y)&&ea(re.prev,re,re.next)>=0||(re=re.prevZ,te.x>=I&&te.x<=H&&te.y>=R&&te.y<=X&&te!==y&&te!==_&&Cy(T,C,E,M,O,D,te.x,te.y)&&ea(te.prev,te,te.next)>=0))return!1;te=te.nextZ}for(;re&&re.z>=J;){if(re.x>=I&&re.x<=H&&re.y>=R&&re.y<=X&&re!==y&&re!==_&&Cy(T,C,E,M,O,D,re.x,re.y)&&ea(re.prev,re,re.next)>=0)return!1;re=re.prevZ}for(;te&&te.z<=ne;){if(te.x>=I&&te.x<=H&&te.y>=R&&te.y<=X&&te!==y&&te!==_&&Cy(T,C,E,M,O,D,te.x,te.y)&&ea(te.prev,te,te.next)>=0)return!1;te=te.nextZ}return!0}function ome(m,o){let u=m;do{const f=u.prev,y=u.next.next;!wC(f,y)&&K$(f,u,u.next,y)&&cw(f,y)&&cw(y,f)&&(o.push(f.i,u.i,y.i),uw(u),uw(u.next),u=m=y),u=u.next}while(u!==m);return Qg(u)}function lme(m,o,u,f,y,g){let _=m;do{let T=_.next.next;for(;T!==_.prev;){if(_.i!==T.i&&mme(_,T)){let E=Z$(_,T);return _=Qg(_,_.next),E=Qg(E,E.next),lw(_,o,u,f,y,g,0),void lw(E,o,u,f,y,g,0)}T=T.next}_=_.next}while(_!==m)}function cme(m,o){return m.x-o.x}function ume(m,o){const u=function(y,g){let _=g;const T=y.x,E=y.y;let O,C=-1/0;do{if(E<=_.y&&E>=_.next.y&&_.next.y!==_.y){const H=_.x+(E-_.y)*(_.next.x-_.x)/(_.next.y-_.y);if(H<=T&&H>C&&(C=H,O=_.x<_.next.x?_:_.next,H===T))return O}_=_.next}while(_!==g);if(!O)return null;const M=O,D=O.x,I=O.y;let R=1/0;_=O;do{if(T>=_.x&&_.x>=D&&T!==_.x&&Cy(E<I?T:C,E,D,I,E<I?C:T,E,_.x,_.y)){const H=Math.abs(E-_.y)/(T-_.x);cw(_,y)&&(H<R||H===R&&(_.x>O.x||_.x===O.x&&dme(O,_)))&&(O=_,R=H)}_=_.next}while(_!==M);return O}(m,o);if(!u)return o;const f=Z$(u,m);return Qg(f,f.next),Qg(u,u.next)}function dme(m,o){return ea(m.prev,m,o.prev)<0&&ea(o.next,m,m.next)<0}function b4(m,o,u,f,y){return(m=1431655765&((m=858993459&((m=252645135&((m=16711935&((m=(m-u)*y|0)|m<<8))|m<<4))|m<<2))|m<<1))|(o=1431655765&((o=858993459&((o=252645135&((o=16711935&((o=(o-f)*y|0)|o<<8))|o<<4))|o<<2))|o<<1))<<1}function hme(m){let o=m,u=m;do(o.x<u.x||o.x===u.x&&o.y<u.y)&&(u=o),o=o.next;while(o!==m);return u}function Cy(m,o,u,f,y,g,_,T){return(y-_)*(o-T)>=(m-_)*(g-T)&&(m-_)*(f-T)>=(u-_)*(o-T)&&(u-_)*(g-T)>=(y-_)*(f-T)}function mme(m,o){return m.next.i!==o.i&&m.prev.i!==o.i&&!function(u,f){let y=u;do{if(y.i!==u.i&&y.next.i!==u.i&&y.i!==f.i&&y.next.i!==f.i&&K$(y,y.next,u,f))return!0;y=y.next}while(y!==u);return!1}(m,o)&&(cw(m,o)&&cw(o,m)&&function(u,f){let y=u,g=!1;const _=(u.x+f.x)/2,T=(u.y+f.y)/2;do y.y>T!=y.next.y>T&&y.next.y!==y.y&&_<(y.next.x-y.x)*(T-y.y)/(y.next.y-y.y)+y.x&&(g=!g),y=y.next;while(y!==u);return g}(m,o)&&(ea(m.prev,m,o.prev)||ea(m,o.prev,o))||wC(m,o)&&ea(m.prev,m,m.next)>0&&ea(o.prev,o,o.next)>0)}function ea(m,o,u){return(o.y-m.y)*(u.x-o.x)-(o.x-m.x)*(u.y-o.y)}function wC(m,o){return m.x===o.x&&m.y===o.y}function K$(m,o,u,f){const y=NC(ea(m,o,u)),g=NC(ea(m,o,f)),_=NC(ea(u,f,m)),T=NC(ea(u,f,o));return y!==g&&_!==T||!(y!==0||!jC(m,u,o))||!(g!==0||!jC(m,f,o))||!(_!==0||!jC(u,m,f))||!(T!==0||!jC(u,o,f))}function jC(m,o,u){return o.x<=Math.max(m.x,u.x)&&o.x>=Math.min(m.x,u.x)&&o.y<=Math.max(m.y,u.y)&&o.y>=Math.min(m.y,u.y)}function NC(m){return m>0?1:m<0?-1:0}function cw(m,o){return ea(m.prev,m,m.next)<0?ea(m,o,m.next)>=0&&ea(m,m.prev,o)>=0:ea(m,o,m.prev)<0||ea(m,m.next,o)<0}function Z$(m,o){const u=_4(m.i,m.x,m.y),f=_4(o.i,o.x,o.y),y=m.next,g=o.prev;return m.next=o,o.prev=m,u.next=y,y.prev=u,f.next=u,u.prev=f,g.next=f,f.prev=g,f}function Y$(m,o,u,f){const y=_4(m,o,u);return f?(y.next=f.next,y.prev=f,f.next.prev=y,f.next=y):(y.prev=y,y.next=y),y}function uw(m){m.next.prev=m.prev,m.prev.next=m.next,m.prevZ&&(m.prevZ.nextZ=m.nextZ),m.nextZ&&(m.nextZ.prevZ=m.prevZ)}function _4(m,o,u){return{i:m,x:o,y:u,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function SC(m,o){const u=m.length;if(u<=1)return[m];const f=[];let y,g;for(let _=0;_<u;_++){const T=wi(m[_]);T!==0&&(m[_].area=Math.abs(T),g===void 0&&(g=T<0),g===T<0?(y&&f.push(y),y=[m[_]]):y.push(m[_]))}if(y&&f.push(y),o>1)for(let _=0;_<f.length;_++)f[_].length<=o||(PS(f[_],o,1,f[_].length-1,fme),f[_]=f[_].slice(0,o));return f}function fme(m,o){return o.area-m.area}function X$(m,o,u=1){if(!m)return null;const f=typeof m=="string"?qa.from(m).getPrimary():m.getPrimary(),y=f.id.toString();return o.has(y)||o.set(y,[]),f.scaleSelf(u),o.get(y).push(f),f.toString()}function w4(m,o,u,f){const y=f.patternDependencies;let g=!1;for(const _ of o){const T=_.paint.get(`${m}-pattern`);T.isConstant()||(g=!0),X$(T.constantOr(null),y,u)&&(g=!0)}return g}function j4(m,o,u,f,y,g){const _=g.patternDependencies;for(const T of o){const E=T.paint.get(`${m}-pattern`).value;if(E.kind!=="constant"){let O=E.evaluate({zoom:f},u,{},g.availableImages);O=O&&O.name?O.name:O;const C=X$(O,_,y);C&&(u.patterns[T.id]=C)}}return u}var N4,J$,S4,Q$,C4,e8,t8,CC={};function r8(){if(J$)return N4;J$=1;var m=jr();function o(y,g,_,T,E){this.properties={},this.extent=_,this.type=0,this._pbf=y,this._geometry=-1,this._keys=T,this._values=E,y.readFields(u,this,g)}function u(y,g,_){y==1?g.id=_.readVarint():y==2?function(T,E){for(var O=T.readVarint()+T.pos;T.pos<O;){var C=E._keys[T.readVarint()],M=E._values[T.readVarint()];E.properties[C]=M}}(_,g):y==3?g.type=_.readVarint():y==4&&(g._geometry=_.pos)}function f(y){for(var g,_,T=0,E=0,O=y.length,C=O-1;E<O;C=E++)T+=((_=y[C]).x-(g=y[E]).x)*(g.y+_.y);return T}return N4=o,o.types=["Unknown","Point","LineString","Polygon"],o.prototype.loadGeometry=function(){var y=this._pbf;y.pos=this._geometry;for(var g,_=y.readVarint()+y.pos,T=1,E=0,O=0,C=0,M=[];y.pos<_;){if(E<=0){var D=y.readVarint();T=7&D,E=D>>3}if(E--,T===1||T===2)O+=y.readSVarint(),C+=y.readSVarint(),T===1&&(g&&M.push(g),g=[]),g.push(new m(O,C));else{if(T!==7)throw new Error("unknown command "+T);g&&g.push(g[0].clone())}}return g&&M.push(g),M},o.prototype.bbox=function(){var y=this._pbf;y.pos=this._geometry;for(var g=y.readVarint()+y.pos,_=1,T=0,E=0,O=0,C=1/0,M=-1/0,D=1/0,I=-1/0;y.pos<g;){if(T<=0){var R=y.readVarint();_=7&R,T=R>>3}if(T--,_===1||_===2)(E+=y.readSVarint())<C&&(C=E),E>M&&(M=E),(O+=y.readSVarint())<D&&(D=O),O>I&&(I=O);else if(_!==7)throw new Error("unknown command "+_)}return[C,D,M,I]},o.prototype.toGeoJSON=function(y,g,_){var T,E,O=this.extent*Math.pow(2,_),C=this.extent*y,M=this.extent*g,D=this.loadGeometry(),I=o.types[this.type];function R(J){for(var ne=0;ne<J.length;ne++){var re=J[ne];J[ne]=[360*(re.x+C)/O-180,360/Math.PI*Math.atan(Math.exp((180-360*(re.y+M)/O)*Math.PI/180))-90]}}switch(this.type){case 1:var H=[];for(T=0;T<D.length;T++)H[T]=D[T][0];R(D=H);break;case 2:for(T=0;T<D.length;T++)R(D[T]);break;case 3:for(D=function(J){var ne=J.length;if(ne<=1)return[J];for(var re,te,oe=[],ue=0;ue<ne;ue++){var me=f(J[ue]);me!==0&&(te===void 0&&(te=me<0),te===me<0?(re&&oe.push(re),re=[J[ue]]):re.push(J[ue]))}return re&&oe.push(re),oe}(D),T=0;T<D.length;T++)for(E=0;E<D[T].length;E++)R(D[T][E])}D.length===1?D=D[0]:I="Multi"+I;var X={type:"Feature",geometry:{type:I,coordinates:D},properties:this.properties};return"id"in this&&(X.id=this.id),X},N4}function n8(){if(Q$)return S4;Q$=1;var m=r8();function o(f,y){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=f,this._keys=[],this._values=[],this._features=[],f.readFields(u,this,y),this.length=this._features.length}function u(f,y,g){f===15?y.version=g.readVarint():f===1?y.name=g.readString():f===5?y.extent=g.readVarint():f===2?y._features.push(g.pos):f===3?y._keys.push(g.readString()):f===4&&y._values.push(function(_){for(var T=null,E=_.readVarint()+_.pos;_.pos<E;){var O=_.readVarint()>>3;T=O===1?_.readString():O===2?_.readFloat():O===3?_.readDouble():O===4?_.readVarint64():O===5?_.readVarint():O===6?_.readSVarint():O===7?_.readBoolean():null}return T}(g))}return S4=o,o.prototype.feature=function(f){if(f<0||f>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[f];var y=this._pbf.readVarint()+this._pbf.pos;return new m(this._pbf,y,this.extent,this._keys,this._values)},S4}function i8(){return t8||(t8=1,CC.VectorTile=function(){if(e8)return C4;e8=1;var m=n8();function o(u,f,y){if(u===3){var g=new m(y,y.readVarint()+y.pos);g.length&&(f[g.name]=g)}}return C4=function(u,f){this.layers=u.readFields(o,{},f)},C4}(),CC.VectorTileFeature=r8(),CC.VectorTileLayer=n8()),CC}var Ef=i8();const e0="3d_elevation_id",s8="level";class pme{constructor(){this._valid=!1}reset(o){return this.feature=o,this._valid=!0,this._geometry=o.loadGeometry(),this._geometry.length!==0&&this._geometry[0].length!==0||(this._valid=!1),this}geometry(o,u){return this._valid&&o(u(this._geometry)),this}require(o,u,f){return this.get(o,!0,u,f)}optional(o,u,f){return this.get(o,!1,u,f)}success(){return this._valid}get(o,u,f,y){const g=this.feature.properties.hasOwnProperty(o)?+this.feature.properties[o]:void 0;return this._valid&&g!==void 0?f(y?y(g):g):u&&(this._valid=!1),this}}class a8{constructor(o,u){this.featureFunc=o,this.vertexFunc=u}parseFeature(o,u,f){return this.featureFunc(o,u,f)}parseVertex(o,u,f){return this.vertexFunc(o,u,f)}}const gme=new a8((m,o,u)=>m.reset(o).require(e0,f=>{u.id=f}).optional("fixed_height_relative",f=>{u.constantHeight=f},Yh.decodeRelativeHeight).geometry(f=>{u.bounds=f},Yh.computeBounds).success(),(m,o,u)=>m.reset(o).require(e0,f=>{u.id=f}).require("elevation_idx",f=>{u.idx=f}).require("extent",f=>{u.extent=f}).require("height_relative",f=>{u.height=f},Yh.decodeRelativeHeight).geometry(f=>{u.position=f},Yh.getPoint).success()),xme=new a8((m,o,u)=>m.reset(o).require(e0,f=>{u.id=f}).optional("fixed_height",f=>{u.constantHeight=f},Yh.decodeMetricHeight).geometry(f=>{u.bounds=f},Yh.computeBounds).success(),(m,o,u)=>m.reset(o).require(e0,f=>{u.id=f}).require("elevation_idx",f=>{u.idx=f}).require("extent",f=>{u.extent=f}).require("height",f=>{u.height=f},Yh.decodeMetricHeight).geometry(f=>{u.position=f},Yh.getPoint).success());class Yh{static computeBounds(o){const u=new dt(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),f=new dt(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY);for(const y of o[0])u.x>y.x&&(u.x=y.x),u.y>y.y&&(u.y=y.y),f.x<y.x&&(f.x=y.x),f.y<y.y&&(f.y=y.y);return{min:u,max:f}}static getPoint(o){return ge.vec2.fromValues(o[0][0].x,o[0][0].y)}static decodeRelativeHeight(o){return 1e-4*o*5}static decodeMetricHeight(o){return 1e-4*o}static parse(o){const u=[],f=[],y=o.length,g=new pme;for(let T=0;T<y;T++){const E=o.feature(T),O=E.properties.hasOwnProperty("version")?String(E.properties.version):void 0,C=(_=O)?_==="1.0.1"?xme:void 0:gme;if(C===void 0){_i(`Unknown elevation feature version number ${O||"(unknown)"}`);continue}const M=E.properties.hasOwnProperty("type")?E.properties.type:void 0;if(M){if(Ef.VectorTileFeature.types[E.type]==="Point"&&M==="curve_point"){const D={};C.parseVertex(g,E,D)&&u.push(D)}else if(Ef.VectorTileFeature.types[E.type]==="Polygon"&&M==="curve_meta"){const D={};C.parseFeature(g,E,D)&&f.push(D)}}}var _;return{vertices:u,features:f}}}class A4{constructor(o,u,f,y,g,_){if(this.vertices=new Array,this.vertexProps=new Array,this.edges=new Array,this.edgeProps=new Array,this.id=o,this.heightRange={min:f,max:f},this.safeArea=u,this.constantHeight=f,this.constantHeight==null&&(this.constantHeight!=null||y.length!==0)){this.vertices=y,this.edges=g,this.edges=this.edges.filter(T=>T.a<this.vertices.length&&T.b<this.vertices.length&&!ge.vec2.exactEquals(this.vertices[T.a].position,this.vertices[T.b].position)),this.heightRange={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};for(const T of this.vertices)this.vertexProps.push({dir:ge.vec2.fromValues(0,0)}),this.heightRange.min=Math.min(this.heightRange.min,T.height),this.heightRange.max=Math.max(this.heightRange.max,T.height);for(const T of this.edges){const E=this.vertices[T.a].position,O=this.vertices[T.b].position,C=ge.vec2.subtract(ge.vec2.create(),O,E),M=ge.vec2.length(C),D=ge.vec2.scale(ge.vec2.create(),C,1/M);this.edgeProps.push({vec:C,dir:D,len:M});const I=this.vertexProps[T.a].dir,R=this.vertexProps[T.b].dir;ge.vec2.add(I,I,D),ge.vec2.add(R,R,D)}for(const T of this.vertexProps)T.dir[0]===0&&T.dir[1]===0||ge.vec2.normalize(T.dir,T.dir);this.tessellate(_)}}pointElevation(o){if(this.constantHeight!=null)return this.constantHeight;const u=this.getClosestEdge(o);if(u==null)return 0;const[f,y]=u;return((g,_,T)=>(1-T)*g+T*_)(this.vertices[this.edges[f].a].height,this.vertices[this.edges[f].b].height,y)}getSafeArea(){return this.safeArea}isTunnel(){return this.heightRange.max<=-5}getClosestEdge(o){if(this.edges.length===0)return;let u=0,f=Number.POSITIVE_INFINITY,y=0;const g=ge.vec2.fromValues(o.x,o.y);for(let _=0;_<this.edges.length;_++){const T=this.edges[_],E=this.edgeProps[_].dir,O=new Br(g,this.edgeProps[_].dir),C=this.vertices[T.a].position,M=this.vertices[T.b].position,D=ge.vec2.create(),I=ge.vec2.create(),R=O.intersectsPlane(C,this.vertexProps[T.a].dir,D),H=O.intersectsPlane(M,this.vertexProps[T.b].dir,I);if(!R||!H)continue;const X=ge.vec2.subtract(ge.vec2.create(),I,D),J=ge.vec2.subtract(ge.vec2.create(),g,D),ne=ge.vec2.dot(X,X),re=ne>0?ge.vec2.dot(J,X)/ne:0,te=rr(re,0,1),oe=Math.abs((re-te)*this.edgeProps[_].len),ue=ge.vec2.subtract(ge.vec2.create(),g,C),me=oe+Math.abs(ge.vec2.dot(ue,ge.vec2.fromValues(E[1],-E[0])));me<f&&(u=_,f=me,y=te)}return[u,y]}tessellate(o){for(let u=this.edges.length-1;u>=0;--u){const f=this.edges[u].a,y=this.edges[u].b,{position:g,height:_,extent:T}=this.vertices[f],{position:E,height:O,extent:C}=this.vertices[y],M=this.vertexProps[f].dir,D=this.vertexProps[y].dir,I=ge.vec3.fromValues(g[0]/o,g[1]/o,_),R=ge.vec3.fromValues(E[0]/o,E[1]/o,O),H=ge.vec3.fromValues(M[1],-M[0],0);ge.vec3.scale(H,H,T);const X=ge.vec3.fromValues(D[1],-D[0],0);if(ge.vec3.scale(X,X,C),this.distSqLines(ge.vec3.fromValues(I[0]+.5*H[0],I[1]+.5*H[1],I[2]+.5*H[2]),ge.vec3.fromValues(R[0]-.5*X[0],R[1]-.5*X[1],R[2]-.5*X[2]),ge.vec3.fromValues(I[0]-.5*H[0],I[1]-.5*H[1],I[2]-.5*H[2]),ge.vec3.fromValues(R[0]+.5*X[0],R[1]+.5*X[1],R[2]+.5*X[2]))<=.05*.05)continue;const J=this.vertices.length,ne=ge.vec2.add(ge.vec2.create(),g,E);this.vertices.push({position:ge.vec2.scale(ne,ne,.5),height:.5*(_+O),extent:.5*(T+C)});const re=ge.vec2.add(ge.vec2.create(),M,D);this.vertexProps.push({dir:ge.vec2.normalize(re,re)}),this.edges.splice(u,1),this.edgeProps.splice(u,1),this.edges.push({a:f,b:J}),this.edges.push({a:J,b:y});const te=ge.vec2.subtract(ge.vec2.create(),this.vertices[J].position,g),oe=ge.vec2.length(te),ue={vec:te,dir:ge.vec2.scale(ge.vec2.create(),te,1/oe),len:oe};this.edgeProps.push(ue),this.edgeProps.push(ue)}}distSqLines(o,u,f,y){const g=ge.vec3.subtract(ge.vec3.create(),u,o),_=ge.vec3.subtract(ge.vec3.create(),y,f),T=ge.vec3.subtract(ge.vec3.create(),o,f),E=ge.vec3.dot(g,g),O=ge.vec3.dot(g,_),C=ge.vec3.dot(g,T),M=ge.vec3.dot(_,_),D=ge.vec3.dot(_,T),I=E*M-O*O;if(I===0){const ne=ge.vec3.dot(T,_)/ge.vec3.dot(_,_),re=ge.vec3.lerp(ge.vec3.create(),f,y,ne);return ge.vec3.squaredDistance(re,o)}const R=(O*D-C*M)/I,H=(E*D-O*C)/I,X=ge.vec3.lerp(ge.vec3.create(),o,u,R),J=ge.vec3.lerp(ge.vec3.create(),f,y,H);return ge.vec3.squaredDistance(X,J)}}class yme{constructor(o,u){this.zScale=1,this.xOffset=0,this.yOffset=0,o.equals(u)||(this.zScale=Math.pow(2,u.z-o.z),this.xOffset=(o.x*this.zScale-u.x)*Wt,this.yOffset=(o.y*this.zScale-u.y)*Wt)}constantElevation(o,u){if(o.constantHeight!=null)return this.computeBiasedHeight(o.constantHeight,u)}pointElevation(o,u,f){const y=this.constantElevation(u,f);return y??(o.x=o.x*this.zScale+this.xOffset,o.y=o.y*this.zScale+this.yOffset,this.computeBiasedHeight(u.pointElevation(o),f))}computeBiasedHeight(o,u){return u<=0?o:o+u*an(0,u,o>=0?o:Math.abs(.5*o))}}lr(A4,"ElevationFeature");class o8{constructor(){this.polygons=new Map}add(o,...u){this.polygons.has(o)?this.polygons.get(o).push(...u):this.polygons.set(o,u)}merge(o){for(const[u,f]of o.polygons)this.add(u,...f)}}class t0{constructor(){this.portals=[]}static evaluate(o){if(o.length===0)return new t0;let u=[];for(const O of o)u.push(...O.portals);if(u.length===0)return new t0;const f=(O,C)=>O<=0&&C<=0||O>=Wt&&C>=Wt;for(const O of u){const C=O.va,M=O.vb;(f(C.x,M.x)||f(C.y,M.y))&&(O.type="border")}const y=u.filter(O=>O.type!=="unevaluated"),g=u.filter(O=>O.type==="unevaluated");if(g.length===0)return new t0;g.sort((O,C)=>O.hash===C.hash?O.isTunnel===C.isTunnel?0:O.isTunnel?-1:1:O.hash<C.hash?1:-1),u=y.concat(g);let _=y.length,T=_,E=_;do if(T++,T===u.length||u[_].hash!==u[T].hash){if(T-_==2){E<_&&(u[E]=u[_],u[_]=null);const O=u[E],C=u[T-1];O.type=O.isTunnel!==C.isTunnel?"tunnel":"polygon",O.connection={a:O.connection.a,b:C.connection.a},E++}_=T}while(_!==u.length);return u.splice(E),u.sort((O,C)=>O.hash<C.hash?1:-1),{portals:u}}}lr(t0,"ElevationPortalGraph"),lr(o8,"ElevationPolygons");class vme{constructor(o,u,f){this.outPositions=o,this.outNormals=u,this.outIndices=f,this.vertexLookup=new Map,this.buffer=new ArrayBuffer(4),this.view=new DataView(this.buffer)}addVertex(o,u,f){let y=o[2];f!=null&&(y*=f);const g=this.getVec3Bits(o)<<96n|this.getVec3Bits(u),_=this.vertexLookup.get(g);if(_!=null)return _;const T=this.outPositions.length;this.vertexLookup.set(g,T);const E=Math.trunc(16384*u[0]),O=Math.trunc(16384*u[1]),C=Math.trunc(16384*u[2]);return this.outPositions.emplaceBack(o[0],o[1],y),this.outNormals.emplaceBack(E,O,C),T}addVertices(o,u,...f){const y=[];for(const g of f){const _=this.addVertex(g,o,u);y.push(_)}return y}addTriangles(o,u,f){if(u&&f){const y=f.length===1,g=ge.vec3.fromValues(0,0,0);for(let _=0;_<o.length;_+=3){const T=u[o[_+0]],E=u[o[_+1]],O=u[o[_+2]],C=y?f[0]:f[o[_+1]],M=y?f[0]:f[o[_+2]],D=this.addVertex(ge.vec3.fromValues(T.x,T.y,y?f[0]:f[o[_+0]]),g),I=this.addVertex(ge.vec3.fromValues(E.x,E.y,C),g),R=this.addVertex(ge.vec3.fromValues(O.x,O.y,M),g);this.outIndices.emplaceBack(D,I,R)}}else for(let y=0;y<o.length;y+=3)this.outIndices.emplaceBack(o[y+0],o[y+1],o[y+2])}addQuad(o,u){const f=this.addVertices(u,void 0,...o.map(E=>ge.vec3.fromValues(E.coord.x,E.coord.y,E.height))),[y,g,_,T]=f;this.addTriangles([y,g,_,_,T,y])}getBits(o){return this.view.setFloat32(0,o),BigInt(this.view.getUint32(0))}getVec3Bits(o){return this.getBits(o[0])<<64n|this.getBits(o[1])<<32n|this.getBits(o[2])}}class Hu{constructor(o){this.unevaluatedPortals=new t0,this.portalPolygons=new o8,this.vertexHashLookup=new Map,this.unevalVertices=[],this.unevalHeights=[],this.unevalTriangles=[],this.unevalTunnelTriangles=[],this.unevalEdges=[],this.vertexPositions=new Bg,this.vertexNormals=new F1,this.indexArray=new va,this.tileToMeters=b(o)}addVertices(o,u){const f=this.unevalVertices.length;for(let y=0;y<o.length;y++)this.unevalVertices.push(o[y]),this.unevalHeights.push(u[y]);return f}addTriangles(o,u,f){const y=f?this.unevalTunnelTriangles:this.unevalTriangles;for(const g of o)y.push(g+u)}addRenderableRing(o,u,f,y,g){const _=[new dt(g.min.x,g.min.y),new dt(g.max.x,g.min.y),new dt(g.max.x,g.max.y),new dt(g.min.x,g.max.y)];for(let T=0;T<f-1;T++){const E=u+T,O=E+1,C=this.unevalVertices[E],M=this.unevalVertices[O];if(!(C.x>=g.min.x&&C.x<=g.max.x&&C.y>=g.min.y&&C.y<=g.max.y||M.x>=g.min.x&&M.x<=g.max.x&&M.y>=g.min.y&&M.y<=g.max.y||He(C,M,_))||this.isOnBorder(C.x,M.x)||this.isOnBorder(C.y,M.y))continue;const D=Hu.computeEdgeHash(this.unevalVertices[E],this.unevalVertices[O]);let I,R=this.vertexHashLookup.get(Hu.computePosHash(C));R!=null?I=R.next:(R=this.vertexHashLookup.get(Hu.computePosHash(M)),I=R!=null?R.prev:D),this.unevalEdges.push({polygonIdx:o,a:E,b:O,hash:D,portalHash:I,isTunnel:y,type:"unevaluated"})}}addPortalCandidates(o,u,f,y,g){if(u.length===0)return;this.portalPolygons.add(o,{geometry:u,zLevel:g});const _=u[0];this.vertexHashLookup.clear();let T=Hu.computeEdgeHash(_[_.length-2],_[_.length-1]);for(let E=0;E<_.length-1;E++){const O=_[E+0],C=_[E+1],M=ge.vec2.fromValues(C.x-O.x,C.y-O.y),D=ge.vec2.length(M);if(D===0)continue;let I="unevaluated";const R=y.pointElevation(O),H=y.pointElevation(C);Math.abs(R)<.01&&Math.abs(H)<.01?I="entrance":(this.isOnBorder(O.x,C.x)||this.isOnBorder(O.y,C.y))&&(I="border");const X=Hu.computeEdgeHash(O,C);this.unevaluatedPortals.portals.push({connection:{a:o,b:void 0},va:O,vb:C,vab:M,length:D,hash:X,isTunnel:f,type:I});const J=Hu.computePosHash(O);this.vertexHashLookup.set(J,{prev:T,next:X}),T=X}}construct(o){if(this.unevalVertices.length===0)return;const u=()=>({vertexOffset:0,primitiveOffset:this.indexArray.length}),f=M=>{M.primitiveLength=this.indexArray.length-M.primitiveOffset},y=new vme(this.vertexPositions,this.vertexNormals,this.indexArray);this.prepareEdges(o.portals,this.unevalEdges);const g=u(),_=u(),T=u(),E=(M,D)=>{M.sort((R,H)=>R.type===D&&H.type!==D?-1:R.type!==D&&H.type===D?1:0);const I=M.findIndex(R=>R.type!==D);return I>=0?I:M.length};let O=0;this.unevalEdges.length>0&&(O=E(this.unevalEdges,"none"),this.constructBridgeStructures(y,this.unevalVertices,this.unevalHeights,this.unevalEdges,{min:0,max:O},this.tileToMeters));const C=u();if(this.unevalEdges.length>0){const M=this.unevalEdges.splice(O),D=E(M,"tunnel")+O;this.unevalEdges.push(...M),this.constructTunnelStructures(y,this.unevalVertices,this.unevalHeights,this.unevalEdges,{min:0,max:O},{min:O,max:D})}f(T),y.addTriangles(this.unevalTriangles,this.unevalVertices,this.unevalHeights),f(C),y.addTriangles(this.unevalTunnelTriangles,this.unevalVertices,this.unevalHeights),f(_),y.addTriangles(this.unevalTunnelTriangles,this.unevalVertices,[-.1]),f(g),this.maskSegments=Ti.simpleSegment(0,C.primitiveOffset,0,C.primitiveLength),this.depthSegments=Ti.simpleSegment(0,_.primitiveOffset,0,_.primitiveLength),this.renderableSegments=Ti.simpleSegment(0,T.primitiveOffset,0,T.primitiveLength),this.shadowCasterSegments=Ti.simpleSegment(0,g.primitiveOffset,0,g.primitiveLength)}upload(o){this.vertexBuffer||this.vertexPositions.length===0||this.vertexNormals.length===0||this.indexArray.length===0||(this.vertexBuffer=o.createVertexBuffer(this.vertexPositions,nme.members),this.vertexBufferNormal=o.createVertexBuffer(this.vertexNormals,ime.members),this.indexBuffer=o.createIndexBuffer(this.indexArray))}destroy(){this.vertexBuffer&&(this.vertexBuffer.destroy(),this.vertexBufferNormal.destroy(),this.indexBuffer.destroy()),this.maskSegments&&(this.maskSegments.destroy(),this.depthSegments.destroy(),this.renderableSegments.destroy(),this.shadowCasterSegments.destroy())}computeVertexConnections(o,u,f,y){const g=new Map;for(let _=f;_<y;_++){const T=u[_],E=T.a,O=T.b;g.has(E)||g.set(E,{}),g.has(O)||g.set(O,{});const C=g.get(E),M=g.get(O);o[O]>0&&(C.to=O),o[E]>0&&(M.from=E)}return g}constructBridgeStructures(o,u,f,y,g,_){const T=this.computeVertexConnections(f,y,g.min,g.max),E=1/_,O=.5*E,C=D=>ge.vec3.fromValues(u[D].x,u[D].y,f[D]*E),M=D=>{const I=T.get(D),R=I.from,H=I.to;if(!R||!H)return;const X=C(R),J=C(D),ne=C(H),re=ge.vec3.fromValues(0,0,0);if(!ge.vec3.exactEquals(X,J)){const oe=ge.vec3.sub(ge.vec3.create(),J,X);ge.vec3.add(re,re,ge.vec3.normalize(oe,oe))}if(!ge.vec3.exactEquals(ne,J)){const oe=ge.vec3.sub(ge.vec3.create(),ne,J);ge.vec3.add(re,re,ge.vec3.normalize(oe,oe))}const te=ge.vec3.len(re);return te>0?ge.vec3.scale(re,re,1/te):void 0};for(let D=g.min;D<g.max;D++){const I=y[D],R=this.prepareEdgePoints(u,f,I,(Rt,Pr)=>Rt>=Pr);if(R==null)continue;const H=R[0],X=R[1],J=ge.vec3.fromValues(H.coord.x,H.coord.y,E*H.height),ne=ge.vec3.fromValues(X.coord.x,X.coord.y,E*X.height);if(ge.vec3.exactEquals(J,ne))continue;const re=ge.vec3.sub(ge.vec3.create(),ne,J);ge.vec3.normalize(re,re);const te=Rt=>ge.vec3.normalize(Rt,Rt),oe=M(I.a)||re,ue=M(I.b)||re,me=te(ge.vec3.fromValues(oe[1],-oe[0],0)),Me=te(ge.vec3.fromValues(ue[1],-ue[0],0)),Se=te(ge.vec3.cross(ge.vec3.create(),me,oe)),Ae=te(ge.vec3.cross(ge.vec3.create(),Me,ue)),Ve=ge.vec3.create(),Ie=[ge.vec3.add(ge.vec3.create(),J,ge.vec3.scale(Ve,ge.vec3.sub(Ve,me,Se),O)),ge.vec3.add(ge.vec3.create(),J,ge.vec3.scale(Ve,ge.vec3.add(Ve,me,Se),O)),ge.vec3.add(ge.vec3.create(),J,ge.vec3.scale(Ve,Se,O)),J],Ge=[ge.vec3.add(ge.vec3.create(),ne,ge.vec3.scale(Ve,ge.vec3.sub(Ve,Me,Ae),O)),ge.vec3.add(ge.vec3.create(),ne,ge.vec3.scale(Ve,ge.vec3.add(Ve,Me,Ae),O)),ge.vec3.add(ge.vec3.create(),ne,ge.vec3.scale(Ve,Ae,O)),ne],[Ze,We]=o.addVertices(me,_,Ie[0],Ie[1]),[Qe,Je]=o.addVertices(Me,_,Ge[0],Ge[1]);o.addTriangles([Ze,We,Qe,We,Je,Qe]);const[ot,nt]=o.addVertices(Se,_,Ie[1],Ie[2]),[ct,Ot]=o.addVertices(Ae,_,Ge[1],Ge[2]);o.addTriangles([ot,nt,ct,nt,Ot,ct]);const[Mt,cr]=o.addVertices(ge.vec3.negate(me,me),_,Ie[2],Ie[3]),[Lt,Gt]=o.addVertices(ge.vec3.negate(Me,Me),_,Ge[2],Ge[3]);o.addTriangles([Mt,cr,Lt,cr,Gt,Lt])}}constructTunnelStructures(o,u,f,y,g,_){const T=E=>ge.vec3.normalize(E,E);for(let E=g.min;E<g.max;E++){const O=this.prepareEdgePoints(u,f,y[E],(I,R)=>I<=R);if(O==null)continue;const[C,M]=O,D=T(ge.vec3.fromValues(M.coord.y-C.coord.y,-(M.coord.x-C.coord.x),0));o.addQuad([C,M,{coord:M.coord,height:y[E].isTunnel?-.1:0},{coord:C.coord,height:y[E].isTunnel?-.1:0}],D)}for(let E=_.min;E<_.max;E++){const O=y[E],C=u[O.a],M=u[O.b],D=T(ge.vec3.fromValues(M.y-C.y,-(M.x-C.x),0));o.addQuad([{coord:M,height:0},{coord:C,height:0},{coord:C,height:f[O.a]+4},{coord:M,height:f[O.b]+4}],D),o.addQuad([{coord:C,height:0},{coord:M,height:0},{coord:M,height:f[O.b]+4},{coord:C,height:f[O.a]+4}],D)}}prepareEdgePoints(o,u,f,y){const g=o[f.a],_=o[f.b];let T=u[f.a],E=u[f.b];if(!(T!==0&&y(T,0)||E!==0&&y(E,0)))return;const O=g.clone(),C=_.clone();if(y(T,0)){if(!y(E,0)){const M=E/(E-T);C.x=Mr(C.x,O.x,M),C.y=Mr(C.y,O.y,M),E=Mr(E,T,M)}}else{const M=T/(T-E);O.x=Mr(O.x,C.x,M),O.y=Mr(O.y,C.y,M),T=Mr(T,E,M)}return[{coord:O,height:T},{coord:C,height:E}]}prepareEdges(o,u){if(u.length===0)return;u.sort((T,E)=>T.hash===E.hash?E.polygonIdx-T.polygonIdx:E.hash>T.hash?1:-1);let f=0,y=0,g=0,_=u[f].polygonIdx;do y++,(y===u.length||u[f].hash!==u[y].hash)&&((y-f==1||u[y-1].polygonIdx!==_)&&(g<f&&(u[g]=u[f],u[f]=null),u[g].type="none",g++),f=y,f!==u.length&&(_=u[f].polygonIdx));while(f!==u.length);if(u.splice(g),u.length!==0&&o.length!==0){u.sort((O,C)=>O.hash<C.hash?1:-1);let T=0,E=0;for(;T!==u.length&&E!==o.length;){const O=u[T],C=o[E];O.portalHash>C.hash?T++:C.hash>O.portalHash?E++:(O.type=C.type,T++)}}}isOnBorder(o,u){return o<=0&&u<=0||o>=Wt&&u>=Wt}static computeEdgeHash(o,u){return(o.y===u.y&&o.x>u.x||o.y>u.y)&&([o,u]=[u,o]),BigInt(Hu.computePosHash(o))<<32n|BigInt(Hu.computePosHash(u))}static computePosHash(o){return((65535&o.x)<<16|65535&o.y)>>>0}}class T4{constructor(o,u){this.layoutVertexArray=new Bu,this.indexArray=new va,this.lineIndexArray=new Vd,this.triangleSegments=new Ti,this.lineSegments=new Ti,this.programConfigurations=new Gd(o.layers,{zoom:o.zoom,lut:o.lut}),this.uploaded=!1,u&&(this.elevatedLayoutVertexArray=new Gh)}update(o,u,f,y,g,_,T){this.programConfigurations.updatePaintArrays(o,u,g,f,y,_,T)}isEmpty(){return this.layoutVertexArray.length===0}needsUpload(){return this.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,tme.members),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.lineIndexBuffer=o.createIndexBuffer(this.lineIndexArray),this.elevatedLayoutVertexArray&&this.elevatedLayoutVertexArray.length>0&&(this.elevatedLayoutVertexBuffer=o.createVertexBuffer(this.elevatedLayoutVertexArray,rme.members))),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.elevatedLayoutVertexBuffer&&this.elevatedLayoutVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.lineIndexBuffer.destroy(),this.programConfigurations.destroy(),this.triangleSegments.destroy(),this.lineSegments.destroy())}populatePaintArrays(o,u,f,y,g,_){this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,u,f,y,g,_)}}class k4{constructor(o){this.zoom=o.zoom,this.pixelRatio=o.pixelRatio,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(u=>u.fqid),this.index=o.index,this.hasPattern=!1,this.patternFeatures=[],this.bufferData=new T4(o,!1),this.elevationBufferData=new T4(o,!0),this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id),this.projection=o.projection,this.elevationMode=this.layers[0].layout.get("fill-elevation-reference")}updateFootprints(o,u){}populate(o,u,f,y){this.hasPattern=w4("fill",this.layers,this.pixelRatio,u);const g=this.layers[0].layout.get("fill-sort-key"),_=[];for(const{feature:T,id:E,index:O,sourceLayerIndex:C}of o){const M=this.layers[0]._featureFilter.needGeometry,D=Y(T,M);if(!this.layers[0]._featureFilter.filter(new hi(this.zoom),D,f))continue;const I=g?g.evaluate(D,{},f,u.availableImages):void 0,R={id:E,properties:T.properties,type:T.type,sourceLayerIndex:C,index:O,geometry:M?D.geometry:K(T,f,y),patterns:{},sortKey:I};_.push(R)}g&&_.sort((T,E)=>T.sortKey-E.sortKey);for(const T of _){const{geometry:E,index:O,sourceLayerIndex:C}=T;if(this.hasPattern){const M=j4("fill",this.layers,T,this.zoom,this.pixelRatio,u);this.patternFeatures.push(M)}else this.addFeature(T,E,O,f,{},u.availableImages,u.brightness,u.elevationFeatures);u.featureIndex.insert(o[O].feature,E,O,C,this.index)}}update(o,u,f,y,g,_,T){this.bufferData.update(o,u,f,y,g,_,T),this.elevationBufferData.update(o,u,f,y,g,_,T)}addFeatures(o,u,f,y,g,_){for(const T of this.patternFeatures)this.addFeature(T,T.geometry,T.index,u,f,y,_,o.elevationFeatures)}isEmpty(){return this.bufferData.isEmpty()&&this.elevationBufferData.isEmpty()}uploadPending(){return!this.uploaded||this.bufferData.needsUpload()||this.elevationBufferData.needsUpload()}upload(o){this.bufferData.upload(o),this.elevationBufferData.upload(o),this.elevatedStructures&&this.elevatedStructures.upload(o)}destroy(){this.bufferData.destroy(),this.elevationBufferData.destroy(),this.elevatedStructures&&this.elevatedStructures.destroy()}addFeature(o,u,f,y,g,_=[],T,E){const O=SC(u,500);this.elevationMode!=="none"?this.addElevatedRoadFeature(o,O,y,f,E):this.addGeometry(O,this.bufferData),this.bufferData.populatePaintArrays(o,f,g,_,y,T),this.elevationBufferData.populatePaintArrays(o,f,g,_,y,T)}getUnevaluatedPortalGraph(){return this.elevatedStructures?this.elevatedStructures.unevaluatedPortals:void 0}getElevationPolygons(){return this.elevatedStructures?this.elevatedStructures.portalPolygons:void 0}setEvaluatedPortalGraph(o){this.elevatedStructures&&this.elevatedStructures.construct(o)}addElevatedRoadFeature(o,u,f,y,g){const _=new Array,T=this.getElevationFeature(o,g);if(T){_.push({polygons:u,elevationFeature:T,elevationTileID:f});for(const E of _)if(E.elevationFeature){if(this.elevationMode==="hd-road-base"){this.elevatedStructures||(this.elevatedStructures=new Hu(E.elevationTileID));const C=E.elevationFeature.isTunnel();let M=0;o.properties.hasOwnProperty(s8)&&(M=+o.properties[s8]);for(const D of E.polygons)this.elevatedStructures.addPortalCandidates(E.elevationFeature.id,D,C,E.elevationFeature,M)}const O=new yme(f,E.elevationTileID);this.addElevatedGeometry(E.polygons,O,E.elevationFeature,this.elevationMode==="hd-road-base"?0:.05,y)}}else this.addGeometry(u,this.bufferData)}addElevatedGeometry(o,u,f,y,g){const _={elevation:f,elevationSampler:u,bias:y,index:g},[T,E]=this.addGeometry(o,this.elevationBufferData,_);this.elevationBufferData.heightRange==null?this.elevationBufferData.heightRange={min:T,max:E}:(this.elevationBufferData.heightRange.min=Math.min(this.elevationBufferData.heightRange.min,T),this.elevationBufferData.heightRange.max=Math.max(this.elevationBufferData.heightRange.max,E))}addGeometry(o,u,f){let y=Number.POSITIVE_INFINITY,g=Number.NEGATIVE_INFINITY,_=null;f&&(_=f.elevationSampler.constantElevation(f.elevation,f.bias),_!=null&&(y=_,g=_));const T=(E,O,C)=>{if(f!=null)if(O.push(E),_!=null)u.elevatedLayoutVertexArray.emplaceBack(_),C.push(_);else{const M=f.elevationSampler.pointElevation(E,f.elevation,f.bias);u.elevatedLayoutVertexArray.emplaceBack(M),C.push(M),y=Math.min(y,M),g=Math.max(g,M)}};for(const E of o){let O=0;for(const re of E)O+=re.length;const C=u.triangleSegments.prepareSegment(O,u.layoutVertexArray,u.indexArray),M=C.vertexLength,D=[],I=[],R=[],H=[],X=[],J=u.layoutVertexArray.length;for(const re of E){if(re.length===0)continue;re!==E[0]&&I.push(D.length/2);const te=u.lineSegments.prepareSegment(re.length,u.layoutVertexArray,u.lineIndexArray),oe=te.vertexLength;f&&X.push(u.layoutVertexArray.length-J),T(re[0],R,H),u.layoutVertexArray.emplaceBack(re[0].x,re[0].y),u.lineIndexArray.emplaceBack(oe+re.length-1,oe),D.push(re[0].x),D.push(re[0].y);for(let ue=1;ue<re.length;ue++)T(re[ue],R,H),u.layoutVertexArray.emplaceBack(re[ue].x,re[ue].y),u.lineIndexArray.emplaceBack(oe+ue-1,oe+ue),D.push(re[ue].x),D.push(re[ue].y);te.vertexLength+=re.length,te.primitiveLength+=re.length}const ne=ow(D,I);for(let re=0;re<ne.length;re+=3)u.indexArray.emplaceBack(M+ne[re],M+ne[re+1],M+ne[re+2]);if(f&&this.elevationMode==="hd-road-base"){const re=f.elevation.isTunnel(),te=f.elevation.safeArea,oe=this.elevatedStructures.addVertices(R,H);this.elevatedStructures.addTriangles(ne,oe,re);const ue=X.length;if(ue>0){for(let me=0;me<ue-1;me++)this.elevatedStructures.addRenderableRing(f.index,X[me]+oe,X[me+1]-X[me],re,te);this.elevatedStructures.addRenderableRing(f.index,X[ue-1]+oe,R.length-X[ue-1],re,te)}}C.vertexLength+=O,C.primitiveLength+=ne.length/3}return[y,g]}getElevationFeature(o,u){if(!u)return;const f=+o.properties[e0];return f!=null?u.find(y=>y.id===f):void 0}}let l8,c8,u8,d8;lr(k4,"FillBucket",{omit:["layers","patternFeatures"]}),lr(T4,"FillBufferData"),lr(Hu,"ElevatedStructures");class P4{constructor(o,u,f,y){if(this.triangleCount=u.length/3,this.min=new dt(0,0),this.max=new dt(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],this.triangleCount===0||o.length===0)return;const[g,_]=[o[0].clone(),o[0].clone()];for(let M=1;M<o.length;++M){const D=o[M];g.x=Math.min(g.x,D.x),g.y=Math.min(g.y,D.y),_.x=Math.max(_.x,D.x),_.y=Math.max(_.y,D.y)}if(y){const M=Math.ceil(Math.max(_.x-g.x,_.y-g.y)/y);f=Math.max(f,M)}if(f===0)return;this.min=g,this.max=_;const T=this.max.sub(this.min);T.x=Math.max(T.x,1),T.y=Math.max(T.y,1);const E=Math.max(T.x,T.y)/f;this.cellsX=Math.max(1,Math.ceil(T.x/E)),this.cellsY=Math.max(1,Math.ceil(T.y/E)),this.xScale=1/E,this.yScale=1/E;const O=[];for(let M=0;M<this.triangleCount;M++){const D=o[u[3*M+0]].sub(this.min),I=o[u[3*M+1]].sub(this.min),R=o[u[3*M+2]].sub(this.min),H=Wd(Math.floor(Math.min(D.x,I.x,R.x)),this.xScale,this.cellsX),X=Wd(Math.floor(Math.max(D.x,I.x,R.x)),this.xScale,this.cellsX),J=Wd(Math.floor(Math.min(D.y,I.y,R.y)),this.yScale,this.cellsY),ne=Wd(Math.floor(Math.max(D.y,I.y,R.y)),this.yScale,this.cellsY),re=new dt(0,0),te=new dt(0,0),oe=new dt(0,0),ue=new dt(0,0);for(let me=J;me<=ne;++me){re.y=te.y=me*E,oe.y=ue.y=(me+1)*E;for(let Me=H;Me<=X;++Me)re.x=oe.x=Me*E,te.x=ue.x=(Me+1)*E,(ft(D,I,R,re,te,ue)||ft(D,I,R,re,ue,oe))&&O.push({cellIdx:me*this.cellsX+Me,triIdx:M})}}if(O.length===0)return;O.sort((M,D)=>M.cellIdx-D.cellIdx||M.triIdx-D.triIdx);let C=0;for(;C<O.length;){const M=O[C].cellIdx,D={start:this.payload.length,len:0};for(;C<O.length&&O[C].cellIdx===M;)++D.len,this.payload.push(O[C++].triIdx);this.cells[M]=D}}_lazyInitLookup(){this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8))),this.lookup.fill(0)}queryPoint(o,u){if(this.triangleCount===0||this.cells.length===0||o.x>this.max.x||this.min.x>o.x||o.y>this.max.y||this.min.y>o.y)return;const f=Wd(o.x-this.min.x,this.xScale,this.cellsX),y=Wd(o.y-this.min.y,this.yScale,this.cellsY),g=this.cells[y*this.cellsX+f];if(g){this._lazyInitLookup();for(let _=0;_<g.len;_++){const T=this.payload[g.start+_],E=Math.floor(T/8),O=1<<T%8;if(!(this.lookup[E]&O)&&(this.lookup[E]|=O,u.push(T),u.length===this.triangleCount))return}}}query(o,u,f){if(this.triangleCount===0||this.cells.length===0||o.x>this.max.x||this.min.x>u.x||o.y>this.max.y||this.min.y>u.y)return;this._lazyInitLookup();const y=Wd(o.x-this.min.x,this.xScale,this.cellsX),g=Wd(u.x-this.min.x,this.xScale,this.cellsX),_=Wd(o.y-this.min.y,this.yScale,this.cellsY),T=Wd(u.y-this.min.y,this.yScale,this.cellsY);for(let E=_;E<=T;E++)for(let O=y;O<=g;O++){const C=this.cells[E*this.cellsX+O];if(C)for(let M=0;M<C.len;M++){const D=this.payload[C.start+M],I=Math.floor(D/8),R=1<<D%8;if(!(this.lookup[I]&R)&&(this.lookup[I]|=R,f.push(D),f.length===this.triangleCount))return}}}}function Wd(m,o,u){return Math.max(0,Math.min(u-1,Math.floor(m*o)))}lr(P4,"TriangleGridIndex");class h8{constructor(o){this.zoom=o.zoom,this.layers=o.layers,this.layerIds=this.layers.map(u=>u.fqid),this.index=o.index,this.hasPattern=!1,this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id),this.footprints=[]}updateFootprints(o,u){for(const f of this.footprints)u.push({footprint:f,id:o})}populate(o,u,f,y){const g=[];for(const{feature:_,id:T,index:E,sourceLayerIndex:O}of o){const C=this.layers[0]._featureFilter.needGeometry,M=Y(_,C);if(!this.layers[0]._featureFilter.filter(new hi(this.zoom),M,f))continue;const D={id:T,properties:_.properties,type:_.type,sourceLayerIndex:O,index:E,geometry:C?M.geometry:K(_,f,y),patterns:{}};g.push(D)}for(const _ of g){const{geometry:T,index:E,sourceLayerIndex:O}=_;this.addFeature(_,T,E,f,{},u.availableImages,u.brightness),u.featureIndex.insert(o[E].feature,T,E,O,this.index)}}isEmpty(){return this.footprints.length===0}uploadPending(){return!1}upload(o){}update(o,u,f,y,g,_,T){}destroy(){}addFeature(o,u,f,y,g,_=[],T){for(const E of SC(u,2)){const O=[],C=[],M=[],D=new dt(1/0,1/0),I=new dt(-1/0,-1/0);for(const X of E)if(X.length!==0){X!==E[0]&&M.push(C.length/2);for(let J=0;J<X.length;J++)C.push(X[J].x),C.push(X[J].y),O.push(X[J]),D.x=Math.min(D.x,X[J].x),D.y=Math.min(D.y,X[J].y),I.x=Math.max(I.x,X[J].x),I.y=Math.max(I.y,X[J].y)}const R=ow(C,M),H=new P4(O,R,8,256);this.footprints.push({vertices:O,indices:R,grid:H,min:D,max:I})}}}lr(h8,"ClipBucket",{omit:["layers"]});const bme=Bn([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),_me=Bn([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),wme=Bn([{name:"a_centroid_pos",components:2,type:"Uint16"}]),jme=Bn([{name:"a_join_normal_inside",components:3,type:"Int16"}]),Nme=Bn([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),Sme=Bn([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:Cme}=bme;class r0 extends dt{constructor(o,u,f){super(o,u),this.z=f}}class m8 extends r0{constructor(o,u,f,y){super(o,u,f),this.w=y}}function AC(m,o,u,f){const y=[],g=f===0?(_,T,E,O,C,M)=>{_.push(new dt(M,E+(M-T)/(O-T)*(C-E)))}:(_,T,E,O,C,M)=>{_.push(new dt(T+(M-E)/(C-E)*(O-T),M))};for(const _ of m){const T=[];for(const E of _){if(E.length<=2)continue;const O=[];for(let D=0;D<E.length-1;D++){const I=E[D].x,R=E[D].y,H=E[D+1].x,X=E[D+1].y,J=f===0?I:R,ne=f===0?H:X;J<o?ne>o&&g(O,I,R,H,X,o):J>u?ne<u&&g(O,I,R,H,X,u):O.push(E[D]),ne<o&&J>=o&&g(O,I,R,H,X,o),ne>u&&J<=u&&g(O,I,R,H,X,u)}let C=E[E.length-1];const M=f===0?C.x:C.y;M>=o&&M<=u&&O.push(C),O.length&&(C=O[O.length-1],O[0].x===C.x&&O[0].y===C.y||O.push(O[0]),T.push(O))}T.length&&y.push(T)}return y}function f8(m,o,u,f){const y=u==="x"?"y":"x",g=(f-m[u])/(o[u]-m[u]);m[y]=m[y]+(o[y]-m[y])*g,m[u]=f,m.hasOwnProperty("z")&&(m.z=Mr(m.z,o.z,g)),m.hasOwnProperty("w")&&(m.w=Mr(m.w,o.w,g))}function p8(m,o,u,f){const y=u,g=f;for(const _ of["x","y"]){let T=m,E=o;T[_]>=E[_]&&(T=o,E=m),T[_]<y&&E[_]>y&&f8(T,E,_,y),T[_]<g&&E[_]>g&&f8(E,T,_,g)}}const TC=Number.MAX_SAFE_INTEGER;function g8(m,o,u,f){return m.order<o||m.order===TC||!(m.clipMask&u)||function(y,g){return g.length!==0&&g.find(_=>_===y)===void 0}(f,m.clipScope)}function kC(m,o){return m.x-o.x||m.y-o.y}function x8(m,o){return kC(m.min,o.min)===0&&kC(m.max,o.max)===0}function E4(m,o){return!(m.min.x>o.max.x||m.max.x<o.min.x||m.min.y>o.max.y||m.max.y<o.min.y)}function M4(m,o){if(m.length!==o.length)return!1;for(let u=0;u<m.length;u++)if(m[u].sourceId!==o[u].sourceId||!x8(m[u],o[u])||m[u].order!==o[u].order||m[u].clipMask!==o[u].clipMask||!Yr(m[u].clipScope,o[u].clipScope))return!1;return!0}function y8(m,o,u){const f=1/Wt,y=1/(1<<u.canonical.z),g=(o.x*f+u.canonical.x)*y+u.wrap,_=(o.y*f+u.canonical.y)*y;return{min:new dt((m.x*f+u.canonical.x)*y+u.wrap,(m.y*f+u.canonical.y)*y),max:new dt(g,_)}}function Ame(m,o,u){const f=1<<u.canonical.z,y=((o.x-u.wrap)*f-u.canonical.x)*Wt,g=(o.y*f-u.canonical.y)*Wt;return{min:new dt(((m.x-u.wrap)*f-u.canonical.x)*Wt,(m.y*f-u.canonical.y)*Wt),max:new dt(y,g)}}function v8(m,o,u,f,y,g,_){const T=m.indices,E=m.vertices,O=[];for(let C=f;C<f+y;C+=3){const M=o[u[C+0]+g],D=o[u[C+1]+g],I=o[u[C+2]+g],R=Math.min(M.x,D.x,I.x),H=Math.max(M.x,D.x,I.x),X=Math.min(M.y,D.y,I.y),J=Math.max(M.y,D.y,I.y);O.length=0,m.grid.query(new dt(R,X),new dt(H,J),O);for(let ne=0;ne<O.length;ne++){const re=O[ne];if(ft(E[T[3*re+0]],E[T[3*re+1]],E[T[3*re+2]],M,D,I,_))return!0}}return!1}function b8(m,o,u,f){if(!m||!u)return!1;let y=m.vertices;if(!o.canonical.equals(f.canonical)||o.wrap!==f.wrap){if(u.vertices.length<m.vertices.length)return b8(u,f,m,o);const g=o.canonical,_=f.canonical,T=Math.pow(2,_.z-g.z);y=m.vertices.map(E=>new dt((E.x+g.x*Wt)*T-_.x*Wt,(E.y+g.y*Wt)*T-_.y*Wt))}return v8(u,y,m.indices,0,m.indices.length,0,0)}function _8(m,o,u,f){const y=Math.pow(2,f.z-u.z);return new dt((m+u.x*Wt)*y-f.x*Wt,(o+u.y*Wt)*y-f.y*Wt)}function w8(m,o){const u=[];o.grid.queryPoint(m,u);const f=o.indices,y=o.vertices;for(let g=0;g<u.length;g++){const _=u[g];if(Fe([y[f[3*_+0]],y[f[3*_+1]],y[f[3*_+2]]],m))return!0}return!1}const I4=[new dt(0,0),new dt(Wt,0),new dt(Wt,Wt),new dt(0,Wt)];function j8(m,o){const u=[];let f=[];if(!o||m.length<2)return[m];if(m.length===2)return He(m[0],m[1],I4)?[m]:[];for(let y=0;y<m.length+2;y++){const g=m[y%m.length],_=m[(y+1)%m.length],T=He(y===0?m[m.length-1]:m[(y-1)%m.length],g,I4),E=He(g,_,I4),O=T||E;O&&f.push(g),O&&E||f.length>0&&(f.length>1&&u.push(f),f=[])}return f.length>1&&u.push(f),u}const O4=Ef.VectorTileFeature.types,Tme=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius","fill-extrusion-line-width","fill-extrusion-emissive-strength"],kme=["fill-extrusion-flood-light-ground-radius"],Pme=Math.pow(2,13),Eme=Math.pow(2,15)-1,N8=new dt(0,1),Mf=2147483648;function dw(m,o,u,f,y,g,_,T){m.emplaceBack((o<<1)+_,(u<<1)+g,(Math.floor(f*Pme)<<1)+y,Math.round(T))}function hw(m,o,u){m.emplaceBack(o.x*Wt,o.y*Wt,u?1:0)}function PC(m,o,u,f,y,g){m.emplaceBack(o.x,o.y,(u.x<<1)+f,(u.y<<1)+y,g)}function mw(m,o,u){m.emplaceBack(o.x,o.y,o.z,u[0]*16384,u[1]*16384,u[2]*16384)}class S8{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class C8{constructor(){this.centroidXY=new dt(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.polygonSegIdx=-1,this.polygonSegLen=0,this.min=new dt(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new dt(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0}span(){return new dt(this.max.x-this.min.x,this.max.y-this.min.y)}}class A8{constructor(){this.acc=new dt(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(o,u){o.min.x===Number.MAX_VALUE&&(o.min.x=o.max.x=u.x,o.min.y=o.max.y=u.y)}appendEdge(o,u,f){this.accCount++,this.acc._add(u);let y=!!this.borders;u.x<o.min.x?(o.min.x=u.x,y=!0):u.x>o.max.x&&(o.max.x=u.x,y=!0),u.y<o.min.y?(o.min.y=u.y,y=!0):u.y>o.max.y&&(o.max.y=u.y,y=!0),((u.x===0||u.x===Wt)&&u.x===f.x)!=((u.y===0||u.y===Wt)&&u.y===f.y)&&this.processBorderOverlap(u,f),y&&this.checkBorderIntersection(u,f)}checkBorderIntersection(o,u){u.x<0!=o.x<0&&this.addBorderIntersection(0,Mr(u.y,o.y,(0-u.x)/(o.x-u.x))),u.x>Wt!=o.x>Wt&&this.addBorderIntersection(1,Mr(u.y,o.y,(Wt-u.x)/(o.x-u.x))),u.y<0!=o.y<0&&this.addBorderIntersection(2,Mr(u.x,o.x,(0-u.y)/(o.y-u.y))),u.y>Wt!=o.y>Wt&&this.addBorderIntersection(3,Mr(u.x,o.x,(Wt-u.y)/(o.y-u.y)))}addBorderIntersection(o,u){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const f=this.borders[o];u<f[0]&&(f[0]=u),u>f[1]&&(f[1]=u)}processBorderOverlap(o,u){if(o.x===u.x){if(o.y===u.y)return;const f=o.x===0?0:1;this.addBorderIntersection(f,u.y),this.addBorderIntersection(f,o.y)}else{const f=o.y===0?2:3;this.addBorderIntersection(f,u.x),this.addBorderIntersection(f,o.x)}}centroid(){return this.accCount===0?new dt(0,0):new dt(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce((o,u)=>o+ +(u[0]!==Number.MAX_VALUE),0):0}}function T8(m,o){const u=m.add(o)._unit(),f=rr(m.x*u.x+m.y*u.y,-1,1);var y,g,_;return _=Math.acos(f),Math.min(4,Math.max(-4,Math.tan(_)))/4*Eme*((y=m).x*(g=o).y-y.y*g.x<0?-1:1)}const Mme=[m=>m.x<0,m=>m.x>Wt,m=>m.y<0,m=>m.y>Wt];function Ime(m,o,u,f){const y=[4];if(f===0)return y;u._mult(f);const g=m.sub(u),_=o.sub(u),T=[m,o,g,_];for(let E=0;E<4;E++)for(const O of T)if(Mme[E](O)){y.push(E);break}return y}class k8{constructor(o){this.vertexArray=new Bl,this.indexArray=new va,this.programConfigurations=new Gd(o.layers,{zoom:o.zoom,lut:o.lut},u=>kme.includes(u)),this._segments=new Ti,this.hiddenByLandmarkVertexArray=new Z1,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new Ti}getDefaultSegment(){return this.regionSegments[4]}hasData(){return this.vertexArray.length!==0}addData(o,u,f,y=!1){const g=o.length;if(g>2){let _=Math.max(0,this._segments.get().length-1);const T=this._segments._prepareSegment(4*g,this.vertexArray.length,2*this._segmentToGroundQuads[_].length);let E;_!==this._segments.get().length-1&&(_++,this._segmentToGroundQuads[_]=[],this._segmentToRegionTriCounts[_]=[0,0,0,0,0]);{const O=o[0],C=o[1];E=T8(O.sub(o[g-1])._perp()._unit(),C.sub(O)._perp()._unit())}for(let O=0;O<g;O++){const C=O===g-1?0:O+1,M=o[O],D=o[C],I=o[C===g-1?0:C+1],R=D.sub(M)._perp()._unit(),H=T8(R,I.sub(D)._perp()._unit()),X=E,J=H;if(R4(M,D,u)||y&&M8(M,u)&&M8(D,u)){E=H;continue}const ne=T.vertexLength;PC(this.vertexArray,M,D,1,1,X),PC(this.vertexArray,M,D,1,0,X),PC(this.vertexArray,M,D,0,1,J),PC(this.vertexArray,M,D,0,0,J),T.vertexLength+=4;const re=Ime(M,D,R,f);for(const te of re)this._segmentToGroundQuads[_].push({id:ne,region:te}),this._segmentToRegionTriCounts[_][te]+=2,T.primitiveLength+=2;E=H}}}prepareBorderSegments(){if(!this.hasData())return;const o=this._segments.get(),u=o.length;for(let f=0;f<u;f++)this._segmentToGroundQuads[f].sort((y,g)=>y.region-g.region);for(let f=0;f<u;f++){const y=this._segmentToGroundQuads[f],g=o[f],_=this._segmentToRegionTriCounts[f];_.reduce((E,O)=>E+O,0);let T=0;for(let E=0;E<=4;E++){const O=_[E];if(O!==0){let C=this.regionSegments[E];C||(C=this.regionSegments[E]=new Ti);const M={vertexOffset:g.vertexOffset,primitiveOffset:g.primitiveOffset+T,vertexLength:g.vertexLength,primitiveLength:O};C.get().push(M)}T+=O}for(let E=0;E<y.length;E++){const O=y[E].id;this.indexArray.emplaceBack(O,O+1,O+3),this.indexArray.emplaceBack(O,O+3,O+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(o,u,f,y,g,_){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,o,u,f,y,g,_)}upload(o){this.hasData()&&(this.vertexBuffer=o.createVertexBuffer(this.vertexArray,_me.members),this.indexBuffer=o.createIndexBuffer(this.indexArray))}uploadPaintProperties(o){this.hasData()&&this.programConfigurations.upload(o)}update(o,u,f,y,g,_,T){this.hasData()&&this.programConfigurations.updatePaintArrays(o,u,f,y,g,_,T)}updateHiddenByLandmark(o){if(!this.hasData())return;const u=o.groundVertexCount+o.groundVertexArrayOffset;if(o.groundVertexCount===0)return;const f=o.flags&Mf?1:0;for(let y=o.groundVertexArrayOffset;y<u;++y)this.hiddenByLandmarkVertexArray.emplace(y,f);this._needsHiddenByLandmarkUpdate=!0}uploadHiddenByLandmark(o){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=o.createVertexBuffer(this.hiddenByLandmarkVertexArray,Nme.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let o=0;o<=4;o++){const u=this.regionSegments[o];u&&u.destroy()}}}}class EC{constructor(o){this.zoom=o.zoom,this.canonical=o.canonical,this.overscaling=o.overscaling,this.layers=o.layers,this.pixelRatio=o.pixelRatio,this.layerIds=this.layers.map(u=>u.fqid),this.index=o.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=o.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new va,this.footprintVertices=new Bu,this.footprintSegments=[],this.layoutVertexArray=new $u,this.centroidVertexArray=new qg,this.wallVertexArray=new fC,this.indexArray=new va,this.programConfigurations=new Gd(o.layers,{zoom:o.zoom,lut:o.lut},u=>Tme.includes(u)),this.segments=new Ti,this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id),this.groundEffect=new k8(o),this.maxHeight=0,this.partLookup={},this.triangleSubSegments=[],this.polygonSegments=[]}updateFootprints(o,u){}populate(o,u,f,y){this.features=[],this.hasPattern=w4("fill-extrusion",this.layers,this.pixelRatio,u),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.selfDEMTileTimestamp=Number.MAX_VALUE,this.borderDEMTileTimestamp=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE],this.tileToMeter=b(f),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter,this.wallMode=this.layers[0].paint.get("fill-extrusion-line-width").constantOr(1)!==0;for(const{feature:g,id:_,index:T,sourceLayerIndex:E}of o){const O=this.layers[0]._featureFilter.needGeometry,C=Y(g,O);if(!this.layers[0]._featureFilter.filter(new hi(this.zoom),C,f))continue;const M={id:_,sourceLayerIndex:E,index:T,geometry:O?C.geometry:K(g,f,y),properties:g.properties,type:g.type,patterns:{}},D=this.layoutVertexArray.length,I=O4[M.type]==="Polygon";if(this.hasPattern)this.features.push(j4("fill-extrusion",this.layers,M,this.zoom,this.pixelRatio,u));else if(this.wallMode)for(const R of M.geometry)for(const H of j8(R,I))this.addFeature(M,[H],T,f,{},u.availableImages,y,u.brightness);else this.addFeature(M,M.geometry,T,f,{},u.availableImages,y,u.brightness);u.featureIndex.insert(g,M.geometry,T,E,this.index,D)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles(),this.groundEffect.prepareBorderSegments(),this.polygonSegments.length=0}addFeatures(o,u,f,y,g,_){for(const T of this.features){const E=O4[T.type]==="Polygon",{geometry:O}=T;if(this.wallMode)for(const C of O)for(const M of j8(C,E))this.addFeature(T,[M],T.index,u,f,y,g,_);else this.addFeature(T,O,T.index,u,f,y,g,_)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles()}update(o,u,f,y,g,_,T){this.programConfigurations.updatePaintArrays(o,u,g,f,y,_,T),this.groundEffect.update(o,u,g,f,y,_,T)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,Cme),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.wallVertexBuffer=o.createVertexBuffer(this.wallVertexArray,jme.members),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=o.createVertexBuffer(this.layoutVertexExtArray,Sme.members,!0)),this.groundEffect.upload(o)),this.groundEffect.uploadPaintProperties(o),this.programConfigurations.upload(o),this.uploaded=!0}uploadCentroid(o){this.groundEffect.uploadHiddenByLandmark(o),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=o.createVertexBuffer(this.centroidVertexArray,wme.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(o,u,f,y,g,_,T,E){const O=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(o,{})/this.tileToMeter,C=[new dt(0,0),new dt(Wt,Wt)],M=T.projection,D=M.name==="globe",I=this.wallMode||O4[o.type]==="Polygon",R=new A8;R.centroidDataIndex=this.centroidData.length;const H=new C8,X=this.layers[0].paint.get("fill-extrusion-base").evaluate(o,{},y)<=0,J=this.layers[0].paint.get("fill-extrusion-height").evaluate(o,{},y);let ne;if(H.height=J,H.vertexArrayOffset=this.layoutVertexArray.length,H.groundVertexArrayOffset=this.groundEffect.vertexArray.length,D&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new my),this.wallMode){if(D)return void _i("Non zero fill-extrusion-line-width is not yet supported on globe.");if(u.length!==1)return;ne=function(Ae){const Ve=Ae[0].x===Ae[Ae.length-1].x&&Ae[0].y===Ae[Ae.length-1].y;(function(Gt){let Rt=0;const Pr=Gt.length;for(let ir=0;ir<Pr;ir++)Rt+=(Gt[(ir+1)%Pr].x-Gt[ir].x)*(Gt[(ir+1)%Pr].y+Gt[ir].y);return Rt>=0})(Ae)||(Ae=Ae.reverse());const Ge={geometry:[],joinNormals:[],indices:[]},Ze=[],We=[],Qe=[];let Je=Ae.length;for(;Je>=2&&Ae[Je-1].equals(Ae[Je-2]);)Je--;if(Je<(Ve?3:2))return Ge;let ot,nt,ct,Ot,Mt,cr=0;for(;cr<Je-1&&Ae[cr].equals(Ae[cr+1]);)cr++;Ve&&(ot=Ae[Je-2],Mt=Ae[cr].sub(ot)._unit()._perp());for(let Gt=cr;Gt<Je;Gt++){if(ct=Gt===Je-1?Ve?Ae[cr+1]:void 0:Ae[Gt+1],ct&&Ae[Gt].equals(ct))continue;Mt&&(Ot=Mt),ot&&(nt=ot),ot=Ae[Gt],Mt=ct?ct.sub(ot)._unit()._perp():Ot,Ot=Ot||Mt;let Rt=Ot.add(Mt);Rt.x===0&&Rt.y===0||Rt._unit();const Pr=Rt.x*Mt.x+Rt.y*Mt.y,ir=Pr!==0?1/Pr:1/0,pr=Ot.x*Mt.y-Ot.y*Mt.x>0;let Lr="miter";const on=2;Lr==="miter"&&ir>on&&(Lr="bevel"),Lr==="bevel"&&(ir>100&&(Lr="flipbevel"),ir<on&&(Lr="miter"));const $r=(fn,sn,pn,Rn)=>{const mi=new dt(fn.x,fn.y),Fr=new dt(fn.x,fn.y);mi.x+=sn.x*Rn,mi.y+=sn.y*Rn,Fr.x-=sn.x*Math.max(pn,1),Fr.y-=sn.y*Math.max(pn,1),Qe.push(sn),Ze.push(mi),We.push(Fr)};if(Lr==="miter")Rt._mult(ir),$r(ot,Rt,0,0);else if(Lr==="flipbevel")Rt=Mt.mult(-1),$r(ot,Rt,0,0),$r(ot,Rt.mult(-1),0,0);else{const fn=-Math.sqrt(ir*ir-1),sn=pr?fn:0,pn=pr?0:fn;nt&&$r(ot,Ot,sn,pn),ct&&$r(ot,Mt,sn,pn)}}Ge.geometry=[...Ze,...We.reverse(),Ze[0]],Ge.joinNormals=[...Qe,...Qe.reverse(),Qe[Qe.length-1]];const Lt=Ge.geometry.length-1;for(let Gt=0;Gt<Lt/2;Gt++)if(Gt+1<Lt/2){let Rt=Gt,Pr=Gt+1,ir=Lt-1-Gt,pr=Lt-2-Gt;Rt=Rt===0?Lt-1:Rt-1,Pr=Pr===0?Lt-1:Pr-1,ir=ir===0?Lt-1:ir-1,pr=pr===0?Lt-1:pr-1,Ge.indices.push(ir),Ge.indices.push(Pr),Ge.indices.push(Rt),Ge.indices.push(ir),Ge.indices.push(pr),Ge.indices.push(Pr)}return Ge}(u[0]),u=[ne.geometry]}const re=(Ae,Ve)=>Ae<(Ve.length-1)/2||Ae===Ve.length-1,te=this.wallMode?[u]:SC(u,500);for(let Ae=te.length-1;Ae>=0;Ae--){const Ve=te[Ae];(Ve.length===0||(oe=Ve[0]).every(Ie=>Ie.x<=0)||oe.every(Ie=>Ie.x>=Wt)||oe.every(Ie=>Ie.y<=0)||oe.every(Ie=>Ie.y>=Wt))&&te.splice(Ae,1)}var oe;let ue;if(D)ue=D8(te,C,y);else{ue=[];for(const Ae of te)ue.push({polygon:Ae,bounds:C})}const me=I?this.edgeRadius:0,Me=me>0&&this.zoom<17,Se=(Ae,Ve)=>{if(Ae.length===0)return!1;const Ie=Ae[Ae.length-1];return Ve.x===Ie.x&&Ve.y===Ie.y};for(const{polygon:Ae,bounds:Ve}of ue){let Ie=0,Ge=0;for(const Je of Ae)I&&!Je[0].equals(Je[Je.length-1])&&Je.push(Je[0]),Ge+=I?Je.length-1:Je.length;const Ze=this.segments.prepareSegment((I?5:4)*Ge,this.layoutVertexArray,this.indexArray);H.footprintSegIdx<0&&(H.footprintSegIdx=this.footprintSegments.length),H.polygonSegIdx<0&&(H.polygonSegIdx=this.polygonSegments.length);const We={triangleArrayOffset:this.indexArray.length,triangleCount:0,triangleSegIdx:this.segments.segments.length-1},Qe=new S8;if(Qe.vertexOffset=this.footprintVertices.length,Qe.indexOffset=3*this.footprintIndices.length,Qe.ringIndices=[],I){const Je=[],ot=[];Ie=Ze.vertexLength;for(let ct=0;ct<Ae.length;ct++){const Ot=Ae[ct];Ot.length&&ct!==0&&ot.push(Je.length/2);const Mt=[];let cr,Lt;cr=Ot[1].sub(Ot[0])._perp()._unit(),Qe.ringIndices.push(Ot.length-1);for(let Gt=1;Gt<Ot.length;Gt++){const Rt=Ot[Gt],Pr=Ot[Gt===Ot.length-1?1:Gt+1],ir=Rt.clone();if(me){Lt=Pr.sub(Rt)._perp()._unit();const pr=cr.add(Lt)._unit(),Lr=me*Math.min(4,1/(cr.x*pr.x+cr.y*pr.y));ir.x+=Lr*pr.x,ir.y+=Lr*pr.y,ir.x=Math.round(ir.x),ir.y=Math.round(ir.y),cr=Lt}if(!X||me!==0&&!Me||Se(Mt,ir)||Mt.push(ir),dw(this.layoutVertexArray,ir.x,ir.y,0,0,1,1,0),this.wallMode){const pr=re(Gt,Ot);hw(this.wallVertexArray,ne.joinNormals[Gt],!pr)}Ze.vertexLength++,this.footprintVertices.emplaceBack(Rt.x,Rt.y),Je.push(Rt.x,Rt.y),D&&mw(this.layoutVertexExtArray,M.projectTilePoint(ir.x,ir.y,y),M.upVector(y,ir.x,ir.y))}X&&(me===0||Me)&&(Mt.length!==0&&Se(Mt,Mt[0])&&Mt.pop(),this.groundEffect.addData(Mt,Ve,O))}const nt=this.wallMode?ne.indices:ow(Je,ot);for(let ct=0;ct<nt.length;ct+=3)this.footprintIndices.emplaceBack(Qe.vertexOffset+nt[ct+0],Qe.vertexOffset+nt[ct+1],Qe.vertexOffset+nt[ct+2]),this.indexArray.emplaceBack(Ie+nt[ct],Ie+nt[ct+2],Ie+nt[ct+1]),Ze.primitiveLength++;Qe.indexCount+=nt.length,Qe.vertexCount+=this.footprintVertices.length-Qe.vertexOffset}for(let Je=0;Je<Ae.length;Je++){const ot=Ae[Je];R.startRing(H,ot[0]);let nt=ot.length>4&&I8(ot[ot.length-2],ot[0],ot[1]),ct=me?Ome(ot[ot.length-2],ot[0],ot[1],me):0;const Ot=[];let Mt,cr,Lt;cr=ot[1].sub(ot[0])._perp()._unit();let Gt=!0;for(let Rt=1,Pr=0;Rt<ot.length;Rt++){let ir=ot[Rt-1],pr=ot[Rt];const Lr=ot[Rt===ot.length-1?1:Rt+1];if(R.appendEdge(H,pr,ir),R4(pr,ir,Ve)){me&&(cr=Lr.sub(pr)._perp()._unit(),Gt=!Gt);continue}const on=pr.sub(ir)._perp(),$r=on.x/(Math.abs(on.x)+Math.abs(on.y)),fn=on.y>0?1:0,sn=ir.dist(pr);if(Pr+sn>32768&&(Pr=0),me){Lt=Lr.sub(pr)._perp()._unit();let Fr=E8(ir,pr,Lr,P8(cr,Lt),me);isNaN(Fr)&&(Fr=0);const Sn=pr.sub(ir)._unit();ir=ir.add(Sn.mult(ct))._round(),pr=pr.add(Sn.mult(-Fr))._round(),ct=Fr,cr=Lt,X&&this.zoom>=17&&(Se(Ot,ir)||Ot.push(ir),Se(Ot,pr)||Ot.push(pr))}const pn=Ze.vertexLength,Rn=ot.length>4&&I8(ir,pr,Lr);let mi=O8(Pr,nt,Gt);if(dw(this.layoutVertexArray,ir.x,ir.y,$r,fn,0,0,mi),dw(this.layoutVertexArray,ir.x,ir.y,$r,fn,0,1,mi),this.wallMode){const Fr=re(Rt-1,ot),Sn=ne.joinNormals[Rt-1];hw(this.wallVertexArray,Sn,Fr),hw(this.wallVertexArray,Sn,Fr)}if(Pr+=sn,mi=O8(Pr,Rn,!Gt),nt=Rn,dw(this.layoutVertexArray,pr.x,pr.y,$r,fn,0,0,mi),dw(this.layoutVertexArray,pr.x,pr.y,$r,fn,0,1,mi),this.wallMode){const Fr=re(Rt,ot),Sn=ne.joinNormals[Rt];hw(this.wallVertexArray,Sn,Fr),hw(this.wallVertexArray,Sn,Fr)}if(Ze.vertexLength+=4,this.indexArray.emplaceBack(pn+0,pn+1,pn+2),this.indexArray.emplaceBack(pn+1,pn+3,pn+2),Ze.primitiveLength+=2,me){const Fr=Ie+(Rt===1?ot.length-2:Rt-2),Sn=Rt===1?Ie:Fr+1;if(this.indexArray.emplaceBack(pn+1,Fr,pn+3),this.indexArray.emplaceBack(Fr,Sn,pn+3),Ze.primitiveLength+=2,Mt===void 0&&(Mt=pn),!R4(Lr,ot[Rt],Ve)){const Ni=Rt===ot.length-1?Mt:Ze.vertexLength;this.indexArray.emplaceBack(pn+2,pn+3,Ni),this.indexArray.emplaceBack(pn+3,Ni+1,Ni),this.indexArray.emplaceBack(pn+3,Sn,Ni+1),Ze.primitiveLength+=3}Gt=!Gt}if(D){const Fr=this.layoutVertexExtArray,Sn=M.projectTilePoint(ir.x,ir.y,y),Ni=M.projectTilePoint(pr.x,pr.y,y),zi=M.upVector(y,ir.x,ir.y),Zi=M.upVector(y,pr.x,pr.y);mw(Fr,Sn,zi),mw(Fr,Sn,zi),mw(Fr,Ni,Zi),mw(Fr,Ni,Zi)}}I&&(Ie+=ot.length-1),X&&me&&this.zoom>=17&&(Ot.length!==0&&Se(Ot,Ot[0])&&Ot.pop(),this.groundEffect.addData(Ot,Ve,O,me>0))}this.footprintSegments.push(Qe),We.triangleCount=this.indexArray.length-We.triangleArrayOffset,this.polygonSegments.push(We),++H.footprintSegLen,++H.polygonSegLen}if(H.vertexCount=this.layoutVertexArray.length-H.vertexArrayOffset,H.groundVertexCount=this.groundEffect.vertexArray.length-H.groundVertexArrayOffset,H.vertexCount!==0){if(H.centroidXY=R.borders?N8:this.encodeCentroid(R,H),this.centroidData.push(H),R.borders){this.featuresOnBorder.push(R);const Ae=this.featuresOnBorder.length-1;for(let Ve=0;Ve<R.borders.length;Ve++)R.borders[Ve][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[Ve].push(Ae)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,f,g,_,y,E),this.groundEffect.addPaintPropertiesData(o,f,g,_,y,E),this.maxHeight=Math.max(this.maxHeight,J)}}sortBorders(){for(let o=0;o<this.borderFeatureIndices.length;o++)this.borderFeatureIndices[o].sort((u,f)=>this.featuresOnBorder[u].borders[o][0]-this.featuresOnBorder[f].borders[o][0])}splitToSubtiles(){const o=[];for(let T=0;T<this.centroidData.length;T++){const E=this.centroidData[T],O=+(E.min.y+E.max.y>Wt),C=2*O+(+(E.min.x+E.max.x>Wt)^O);for(let M=0;M<E.polygonSegLen;M++){const D=E.polygonSegIdx+M;o.push({centroidIdx:T,subtile:C,polygonSegmentIdx:D,triangleSegmentIdx:this.polygonSegments[D].triangleSegIdx})}}const u=new va;o.sort((T,E)=>T.triangleSegmentIdx===E.triangleSegmentIdx?T.subtile-E.subtile:T.triangleSegmentIdx-E.triangleSegmentIdx);let f=0,y=0,g=0;for(const T of o){if(T.triangleSegmentIdx!==f)break;g++}const _=o.length;for(;y!==o.length;){f=o[y].triangleSegmentIdx;let T=0,E=y,O=y;for(let C=E;C<g&&o[C].subtile===T;C++)O++;for(;E!==g;){const C=o[E];T=C.subtile;const M=this.centroidData[C.centroidIdx].min.clone(),D=this.centroidData[C.centroidIdx].max.clone(),I={vertexOffset:this.segments.segments[f].vertexOffset,primitiveOffset:u.length,vertexLength:this.segments.segments[f].vertexLength,primitiveLength:0,sortKey:void 0,vaos:{}};for(let R=E;R<O;R++){const H=o[R],X=this.polygonSegments[H.polygonSegmentIdx],J=this.centroidData[H.centroidIdx].min,ne=this.centroidData[H.centroidIdx].max,re=this.indexArray.uint16;for(let te=X.triangleArrayOffset;te<X.triangleArrayOffset+X.triangleCount;te++)u.emplaceBack(re[3*te],re[3*te+1],re[3*te+2]);I.primitiveLength+=X.triangleCount,M.x=Math.min(M.x,J.x),M.y=Math.min(M.y,J.y),D.x=Math.max(D.x,ne.x),D.y=Math.max(D.y,ne.y)}I.primitiveLength>0&&this.triangleSubSegments.push({segment:I,min:M,max:D}),E=O;for(let R=E;R<g&&o[R].subtile===o[E].subtile;R++)O++}y=g;for(let C=y;C<_&&o[C].triangleSegmentIdx===o[y].triangleSegmentIdx;C++)g++}u._trim(),this.indexArray=u}getVisibleSegments(o,u,f){const y=new Ti;if(this.wallMode){for(const H of this.triangleSubSegments)y.segments.push(H.segment);return y}let g=0,_=0;const T=1<<o.canonical.z;if(u){const H=u.getMinMaxForTile(o);H&&(g=H.min,_=H.max)}_+=this.maxHeight;const E=o.toUnwrapped();let O;const C=[E.canonical.x/T+E.wrap,E.canonical.y/T],M=[(E.canonical.x+1)/T+E.wrap,(E.canonical.y+1)/T],D=(H,X,J)=>[H[0]*(1-J[0])+X[0]*J[0],H[1]*(1-J[1])+X[1]*J[1]],I=[],R=[];for(const H of this.triangleSubSegments){I[0]=H.min.x/Wt,I[1]=H.min.y/Wt,R[0]=H.max.x/Wt,R[1]=H.max.y/Wt;const X=D(C,M,I),J=D(C,M,R);if(new xr([X[0],X[1],g],[J[0],J[1],_]).intersectsPrecise(f)===0){O&&(y.segments.push(O),O=void 0);continue}const ne=H.segment;O&&O.vertexOffset!==ne.vertexOffset&&(y.segments.push(O),O=void 0),O?(O.vertexLength+=ne.vertexLength,O.primitiveLength+=ne.primitiveLength):O={vertexOffset:ne.vertexOffset,primitiveLength:ne.primitiveLength,vertexLength:ne.vertexLength,primitiveOffset:ne.primitiveOffset,sortKey:void 0,vaos:{}}}return O&&y.segments.push(O),y}encodeCentroid(o,u){const f=o.centroid(),y=u.span(),g=Math.min(7,Math.round(y.x*this.tileToMeter/10)),_=Math.min(7,Math.round(y.y*this.tileToMeter/10));return new dt(rr(f.x,1,Wt-1)<<3|g,rr(f.y,1,Wt-1)<<3|_)}encodeBorderCentroid(o){if(!o.borders)return new dt(0,0);const u=o.borders,f=Number.MAX_VALUE;if(u[0][0]!==f||u[1][0]!==f){const y=u[0][0]!==f?0:1;return new dt(6|(u[0][0]!==f?0:65528),(u[y][0]+u[y][1])/2<<3|6)}{const y=u[2][0]!==f?2:3;return new dt((u[y][0]+u[y][1])/2<<3|6,6|(u[2][0]!==f?0:65528))}}showCentroid(o){const u=this.centroidData[o.centroidDataIndex];u.flags&=Mf,u.centroidXY.x=0,u.centroidXY.y=0,this.writeCentroidToBuffer(u)}writeCentroidToBuffer(o){this.groundEffect.updateHiddenByLandmark(o);const u=o.vertexArrayOffset,f=o.vertexCount+o.vertexArrayOffset,y=o.flags&Mf?N8:o.centroidXY,g=this.centroidVertexArray.geta_centroid_pos0(u);if(this.centroidVertexArray.geta_centroid_pos1(u)!==y.y||g!==y.x){for(let _=u;_<f;++_)this.centroidVertexArray.emplace(_,y.x,y.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const o of this.centroidData)this.writeCentroidToBuffer(o)}updateReplacement(o,u,f){if(u.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=u.updateTime;const y=u.getReplacementRegionsForTile(o.toUnwrapped());if(M4(this.activeReplacements,y))return;if(this.activeReplacements=y,this.centroidVertexArray.length===0)this.createCentroidsBuffer();else for(const _ of this.centroidData)_.flags&=2147483647;const g=[];for(const _ of this.activeReplacements){if(_.order<f)continue;const T=Math.max(1,Math.pow(2,_.footprintTileId.canonical.z-o.canonical.z));for(const E of this.centroidData)if(!(E.flags&Mf||_.min.x>E.max.x||E.min.x>_.max.x||_.min.y>E.max.y||E.min.y>_.max.y))for(let O=0;O<E.footprintSegLen;O++){const C=this.footprintSegments[E.footprintSegIdx+O];if(g.length=0,Rme(this.footprintVertices,C.vertexOffset,C.vertexCount,_.footprintTileId.canonical,o.canonical,g),v8(_.footprint,g,this.footprintIndices.uint16,C.indexOffset,C.indexCount,-C.vertexOffset,-T)){E.flags|=Mf;break}}}for(const _ of this.centroidData)this.writeCentroidToBuffer(_);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(o,u,f){let y=!1;for(let g=0;g<f.footprintSegLen;g++){const _=this.footprintSegments[f.footprintSegIdx+g];let T=0;for(const E of _.ringIndices){for(let O=T,C=E+T-1;O<E+T;C=O++){const M=this.footprintVertices.int16[2*(O+_.vertexOffset)+0],D=this.footprintVertices.int16[2*(O+_.vertexOffset)+1],I=this.footprintVertices.int16[2*(C+_.vertexOffset)+1];D>u!=I>u&&o<(this.footprintVertices.int16[2*(C+_.vertexOffset)+0]-M)*(u-D)/(I-D)+M&&(y=!y)}T=E}}return y}getHeightAtTileCoord(o,u){let f=Number.NEGATIVE_INFINITY,y=!0;const g=4*(o+Wt)*Wt+(u+Wt);if(this.partLookup.hasOwnProperty(g)){const _=this.partLookup[g];return _?{height:_.height,hidden:!!(_.flags&Mf)}:void 0}for(const _ of this.centroidData)o>_.max.x||_.min.x>o||u>_.max.y||_.min.y>u||this.footprintContainsPoint(o,u,_)&&_&&_.height>f&&(f=_.height,this.partLookup[g]=_,y=!!(_.flags&Mf));if(f!==Number.NEGATIVE_INFINITY)return{height:f,hidden:y};this.partLookup[g]=void 0}}function P8(m,o){const u=m.add(o)._unit();return m.x*u.x+m.y*u.y}function Ome(m,o,u,f){const y=o.sub(m)._perp()._unit(),g=u.sub(o)._perp()._unit();return E8(m,o,u,P8(y,g),f)}function E8(m,o,u,f,y){const g=Math.sqrt(1-f*f);return Math.min(m.dist(o)/3,o.dist(u)/3,y*g/f)}function R4(m,o,u){return m.x<u[0].x&&o.x<u[0].x||m.x>u[1].x&&o.x>u[1].x||m.y<u[0].y&&o.y<u[0].y||m.y>u[1].y&&o.y>u[1].y}function M8(m,o){return m.x<o[0].x||m.x>o[1].x||m.y<o[0].y||m.y>o[1].y}function I8(m,o,u){if(m.x<0||m.x>=Wt||o.x<0||o.x>=Wt||u.x<0||u.x>=Wt)return!1;const f=u.sub(o),y=f.perp(),g=m.sub(o);return(f.x*g.x+f.y*g.y)/Math.sqrt((f.x*f.x+f.y*f.y)*(g.x*g.x+g.y*g.y))>-.866&&y.x*g.x+y.y*g.y<0}function O8(m,o,u){const f=o?2|m:-3&m;return u?1|f:-2&f}function R8(){const m=Math.PI/32,o=Math.tan(m),u=Zh;return u*Math.sqrt(1+2*o*o)-u}function D8(m,o,u){const f=1<<u.z,y=Lo(u.x/f),g=Lo((u.x+1)/f),_=ba(u.y/f),T=ba((u.y+1)/f);return function(E,O,C,M,D=0,I){const R=[];if(!E.length||!C||!M)return R;const H=(ue,me)=>{for(const Me of ue)R.push({polygon:Me,bounds:me})},X=Math.ceil(Math.log2(C)),J=Math.ceil(Math.log2(M)),ne=X-J,re=[];for(let ue=0;ue<Math.abs(ne);ue++)re.push(ne>0?0:1);for(let ue=0;ue<Math.min(X,J);ue++)re.push(0),re.push(1);let te=E;if(te=AC(te,O[0].y-D,O[1].y+D,1),te=AC(te,O[0].x-D,O[1].x+D,0),!te.length)return R;const oe=[];for(re.length?oe.push({polygons:te,bounds:O,depth:0}):H(te,O);oe.length;){const ue=oe.pop(),me=ue.depth,Me=re[me],Se=ue.bounds[0],Ae=ue.bounds[1],Ve=Me===0?Se.x:Se.y,Ie=Me===0?Ae.x:Ae.y,Ge=I?I(Me,Ve,Ie):.5*(Ve+Ie),Ze=AC(ue.polygons,Ve-D,Ge+D,Me),We=AC(ue.polygons,Ge-D,Ie+D,Me);if(Ze.length){const Qe=[Se,new dt(Me===0?Ge:Ae.x,Me===1?Ge:Ae.y)];re.length>me+1?oe.push({polygons:Ze,bounds:Qe,depth:me+1}):H(Ze,Qe)}if(We.length){const Qe=[new dt(Me===0?Ge:Se.x,Me===1?Ge:Se.y),Ae];re.length>me+1?oe.push({polygons:We,bounds:Qe,depth:me+1}):H(We,Qe)}}return R}(m,o,Math.ceil((g-y)/11.25),Math.ceil((_-T)/11.25),1,(E,O,C)=>{if(E===0)return .5*(O+C);{const M=ba((u.y+O/Wt)/f);return(ka(.5*(ba((u.y+C/Wt)/f)+M))*f-u.y)*Wt}})}function Rme(m,o,u,f,y,g){const _=Math.pow(2,f.z-y.z);for(let T=0;T<u;T++){let E=m.int16[2*(T+o)+0],O=m.int16[2*(T+o)+1];E=(E+y.x*Wt)*_-f.x*Wt,O=(O+y.y*Wt)*_-f.y*Wt,g.push(new dt(E,O))}}let z8,L8;function fw(m,o){return m.x*o.x+m.y*o.y}function F8(m,o){if(m.length===1){let u=0;const f=o[u++];let y;for(;!y||f.equals(y);)if(y=o[u++],!y)return 1/0;for(;u<o.length;u++){const g=o[u],_=m[0],T=y.sub(f),E=g.sub(f),O=_.sub(f),C=fw(T,T),M=fw(T,E),D=fw(E,E),I=fw(O,T),R=fw(O,E),H=C*D-M*M,X=(D*I-M*R)/H,J=(C*R-M*I)/H,ne=f.z*(1-X-J)+y.z*X+g.z*J;if(isFinite(ne))return ne}return 1/0}{let u=1/0;for(const f of o)u=Math.min(u,f.z);return u}}function B8(m,o,u,f,y,g,_,T){const E=_*y.getElevationAt(m,o,!0,!0),O=g[0]!==0,C=O?g[1]===0?_*(g[0]/7-450):_*function(M,D,I){const R=Math.floor(D[0]/8),H=Math.floor(D[1]/8),X=10*(D[0]-8*R),J=10*(D[1]-8*H),ne=M.getElevationAt(R,H,!0,!0),re=M.getMeterToDEM(I),te=Math.floor(.5*(X*re-1)),oe=Math.floor(.5*(J*re-1)),ue=M.tileCoordToPixel(R,H),me=2*te+1,Me=2*oe+1,Se=function(We,Qe,Je,ot,nt){return[We.getElevationAtPixel(Qe,Je,!0),We.getElevationAtPixel(Qe+nt,Je,!0),We.getElevationAtPixel(Qe,Je+nt,!0),We.getElevationAtPixel(Qe+ot,Je+nt,!0)]}(M,ue.x-te,ue.y-oe,me,Me),Ae=Math.abs(Se[0]-Se[1]),Ve=Math.abs(Se[2]-Se[3]),Ie=Math.abs(Se[0]-Se[2])+Math.abs(Se[1]-Se[3]),Ge=Math.min(.25,.5*re*(Ae+Ve)/me),Ze=Math.min(.25,.5*re*Ie/Me);return ne+Math.max(Ge*X,Ze*J)}(y,g,T):E;return{base:E+(u===0?-1:u),top:O?Math.max(C+f,E+u+2):E+f}}lr(EC,"FillExtrusionBucket",{omit:["layers","features"]}),lr(C8,"PartData"),lr(S8,"FootprintSegment"),lr(A8,"BorderCentroidData"),lr(k8,"GroundEffect");const Dme=Bn([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),zme=Bn([{name:"a_z_offset_width",components:3,type:"Float32"}],4),{members:Lme}=Dme,Fme=Bn([{name:"a_packed",components:3,type:"Float32"}]),{members:Bme}=Fme,$me=Bn([{name:"a_pattern_data",components:3,type:"Float32"}]),{members:Vme}=$me;class $8{constructor(o,u){this.width=o,this.height=u,this.nextRow=0,this.image=new Pf({width:o,height:u}),this.positions={},this.uploaded=!1}getDash(o,u){const f=this.getKey(o,u);return this.positions[f]}trim(){const o=this.width,u=this.height=rl(this.nextRow);this.image.resize({width:o,height:u})}getKey(o,u){return o.join(",")+u}getDashRanges(o,u,f){const y=[];let g=o.length%2==1?-o[o.length-1]*f:0,_=o[0]*f,T=!0;y.push({left:g,right:_,isDash:T,zeroLength:o[0]===0});let E=o[0];for(let O=1;O<o.length;O++){T=!T;const C=o[O];g=E*f,E+=C,_=E*f,y.push({left:g,right:_,isDash:T,zeroLength:C===0})}return y}addRoundDash(o,u,f){const y=u/2;for(let g=-f;g<=f;g++){const _=this.width*(this.nextRow+f+g);let T=0,E=o[T];for(let O=0;O<this.width;O++){O/E.right>1&&(E=o[++T]);const C=Math.abs(O-E.left),M=Math.abs(O-E.right),D=Math.min(C,M);let I;const R=g/f*(y+1);if(E.isDash){const H=y-Math.abs(R);I=Math.sqrt(D*D+H*H)}else I=y-Math.sqrt(D*D+R*R);this.image.data[_+O]=Math.max(0,Math.min(255,I+128))}}}addRegularDash(o,u){for(let E=o.length-1;E>=0;--E){const O=o[E],C=o[E+1];O.zeroLength?o.splice(E,1):C&&C.isDash===O.isDash&&(C.left=O.left,o.splice(E,1))}const f=o[0],y=o[o.length-1];f.isDash===y.isDash&&(f.left=y.left-this.width,y.right=f.right+this.width);const g=this.width*this.nextRow;let _=0,T=o[_];for(let E=0;E<this.width;E++){E/T.right>1&&(T=o[++_]);const O=Math.abs(E-T.left),C=Math.abs(E-T.right),M=Math.min(O,C);this.image.data[g+E]=Math.max(0,Math.min(255,(T.isDash?M:-M)+u+128))}}addDash(o,u){const f=this.getKey(o,u);if(this.positions[f])return this.positions[f];const y=u==="round",g=y?7:0,_=2*g+1;if(this.nextRow+_>this.height)return _i("LineAtlas out of space"),null;o.length===0&&o.push(1);let T=0;for(let C=0;C<o.length;C++)o[C]<0&&(_i("Negative value is found in line dasharray, replacing values with 0"),o[C]=0),T+=o[C];if(T!==0){const C=this.width/T,M=this.getDashRanges(o,this.width,C);y?this.addRoundDash(M,C,g):this.addRegularDash(M,u==="square"?.5*C:0)}const E=this.nextRow+g;this.nextRow+=_;const O={tl:[E,g],br:[T,0]};return this.positions[f]=O,O}}lr($8,"LineAtlas");const Ume=Ef.VectorTileFeature.types,Gme=Math.cos(Math.PI/180*37.5),Hme=Math.cos(Math.PI/180*5);class D4{constructor(o){this.evaluationGlobals={zoom:0,lineProgress:void 0},this.zoom=o.zoom,this.evaluationGlobals.zoom=this.zoom,this.overscaling=o.overscaling,this.pixelRatio=o.pixelRatio,this.layers=o.layers,this.layerIds=this.layers.map(u=>u.fqid),this.index=o.index,this.projection=o.projection,this.hasPattern=!1,this.hasZOffset=!1,this.hasCrossSlope=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(u=>{this.gradients[u.id]={}}),this.layoutVertexArray=new B1,this.layoutVertexArray2=new hc,this.patternVertexArray=new hc,this.indexArray=new va,this.programConfigurations=new Gd(o.layers,{zoom:o.zoom,lut:o.lut}),this.segments=new Ti,this.maxLineLength=0,this.zOffsetVertexArray=new hc,this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id),this.tessellationStep=o.tessellationStep?o.tessellationStep:Wt/64}updateFootprints(o,u){}populate(o,u,f,y){this.hasPattern=w4("line",this.layers,this.pixelRatio,u);const g=this.layers[0].layout.get("line-sort-key");this.tileToMeter=b(f);const _=this.layers[0].layout.get("line-z-offset"),T=_.isConstant()&&!_.constantOr(0),E=this.layers[0].layout.get("line-elevation-reference");this.hasZOffset=E==="sea"||E==="ground"||!T&&E==="none",this.hasZOffset&&E==="none"&&_i(`line-elevation-reference: ground is used for the layer ${this.layerIds[0]} because non-zero line-z-offset value was found.`);const O=this.layers[0].layout.get("line-cross-slope");this.hasCrossSlope=this.hasZOffset&&O!==void 0;const C=[];for(const{feature:R,id:H,index:X,sourceLayerIndex:J}of o){const ne=this.layers[0]._featureFilter.needGeometry,re=Y(R,ne);if(!this.layers[0]._featureFilter.filter(new hi(this.zoom),re,f))continue;const te=g?g.evaluate(re,{},f):void 0,oe={id:H,properties:R.properties,type:R.type,sourceLayerIndex:J,index:X,geometry:ne?re.geometry:K(R,f,y),patterns:{},sortKey:te};C.push(oe)}g&&C.sort((R,H)=>R.sortKey-H.sortKey);const{lineAtlas:M,featureIndex:D}=u,I=this.addConstantDashes(M);for(const R of C){const{geometry:H,index:X,sourceLayerIndex:J}=R;if(I&&this.addFeatureDashes(R,M),this.hasPattern){const ne=j4("line",this.layers,R,this.zoom,this.pixelRatio,u);this.patternFeatures.push(ne)}else this.addFeature(R,H,X,f,M.positions,u.availableImages,u.brightness);D.insert(o[X].feature,H,X,J,this.index)}}addConstantDashes(o){let u=!1;for(const f of this.layers){const y=f.paint.get("line-dasharray").value,g=f.layout.get("line-cap").value;if(y.kind!=="constant"||g.kind!=="constant")u=!0;else{const _=g.value,T=y.value;if(!T)continue;o.addDash(T,_)}}return u}addFeatureDashes(o,u){const f=this.zoom;for(const y of this.layers){const g=y.paint.get("line-dasharray").value,_=y.layout.get("line-cap").value;if(g.kind==="constant"&&_.kind==="constant")continue;let T,E;if(g.kind==="constant"){if(T=g.value,!T)continue}else T=g.evaluate({zoom:f},o);E=_.kind==="constant"?_.value:_.evaluate({zoom:f},o),u.addDash(T,E),o.patterns[y.id]=u.getKey(T,E)}}update(o,u,f,y,g,_,T){this.programConfigurations.updatePaintArrays(o,u,g,f,y,_,T)}addFeatures(o,u,f,y,g,_){for(const T of this.patternFeatures)this.addFeature(T,T.geometry,T.index,u,f,y,_)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=o.createVertexBuffer(this.layoutVertexArray2,Bme)),this.patternVertexArray.length!==0&&(this.patternVertexBuffer=o.createVertexBuffer(this.patternVertexArray,Vme)),!this.zOffsetVertexBuffer&&this.zOffsetVertexArray.length>0&&(this.zOffsetVertexBuffer=o.createVertexBuffer(this.zOffsetVertexArray,zme.members,!0)),this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,Lme),this.indexBuffer=o.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(o){if(o.properties&&o.properties.hasOwnProperty("mapbox_clip_start")&&o.properties.hasOwnProperty("mapbox_clip_end"))return{start:+o.properties.mapbox_clip_start,end:+o.properties.mapbox_clip_end}}addFeature(o,u,f,y,g,_,T){const E=this.layers[0].layout,O=E.get("line-join").evaluate(o,{}),C=E.get("line-cap").evaluate(o,{}),M=E.get("line-miter-limit"),D=E.get("line-round-limit");this.lineClips=this.lineFeatureClips(o),this.lineFeature=o,this.zOffsetValue=E.get("line-z-offset").value;const I=this.layers[0].paint.get("line-width").value;I.kind!=="constant"&&I.isLineProgressConstant===!1&&(this.variableWidthValue=I);for(const R of u)this.addLine(R,o,y,O,C,M,D);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,f,g,_,y,T)}addLine(o,u,f,y,g,_,T){this.distance=0,this.prevDistance=0,this.scaledDistance=0,this.totalDistance=0,this.totalFeatureLength=0,this.lineSoFar=0,this.currentVertex=void 0;const E=y==="none";if(this.patternJoinNone=this.hasPattern&&E,this.segmentStart=0,this.segmentStartf32=0,this.segmentPoints=[],this.lineClips){this.lineClipsArray.push(this.lineClips);for(let re=0;re<o.length-1;re++)this.totalDistance+=o[re].dist(o[re+1]);this.totalFeatureLength=this.totalDistance/(this.lineClips.end-this.lineClips.start),this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const O=Ume[u.type]==="Polygon";let C=o.length;for(;C>=2&&o[C-1].equals(o[C-2]);)C--;let M=0;for(;M<C-1&&o[M].equals(o[M+1]);)M++;if(C<(O?3:2))return;y==="bevel"&&(_=1.05);const D=this.segments.prepareSegment(10*C,this.layoutVertexArray,this.indexArray);let I,R,H,X,J,ne;this.e1=this.e2=-1,O&&(I=o[C-2],J=o[M].sub(I)._unit()._perp());for(let re=M;re<C;re++){if(H=re===C-1?O?o[M+1]:void 0:o[re+1],H&&o[re].equals(H))continue;J&&(X=J),I&&(R=I),I=o[re],ne=this.evaluateLineProgressFeatures(R?R.dist(I):0),J=H?H.sub(I)._unit()._perp():X,X=X||J;const te=R&&H;let oe=te?y:O||E?"butt":g;const ue=X.x*J.x+X.y*J.y;if(E){const Ze=function(We){if(We.patternJoinNone){const Qe=We.segmentPoints.length/2,Je=We.lineSoFar-We.segmentStart;for(let ot=0;ot<Qe;++ot){const nt=We.segmentPoints[2*ot+1],ct=Math.round(We.segmentPoints[2*ot])+.5+.25*nt;We.patternVertexArray.emplaceBack(ct,Je,We.segmentStart),We.patternVertexArray.emplaceBack(ct,Je,We.segmentStart)}We.segmentPoints.length=0}We.e1=We.e2=-1};if(te&&ue<Hme){this.updateDistance(R,I),this.addCurrentVertex(I,X,1,1,D,ne),Ze(this),this.addCurrentVertex(I,J,-1,-1,D,ne);continue}if(R){if(!H){this.updateDistance(R,I),this.addCurrentVertex(I,X,1,1,D,ne),Ze(this);continue}oe="miter"}}let me=X.add(J);me.x===0&&me.y===0||me._unit();const Me=me.x*J.x+me.y*J.y,Se=Me!==0?1/Me:1/0,Ae=2*Math.sqrt(2-2*Me),Ve=Me<Gme&&R&&H,Ie=X.x*J.y-X.y*J.x>0,Ge=this.overscaling<=16?15*Wt/(512*this.overscaling):0;if(te&&oe==="round"){if(Se<T)oe="miter";else if(Se<=2){const Ze=z4(I,-10,Wt+10);oe=this.hasZOffset&&(Ze||this.hasCrossSlope)?"miter":"fakeround"}}if(oe==="miter"&&Se>_&&(oe="bevel"),oe==="bevel"&&(Se>2&&(oe="flipbevel"),Se<_&&(oe="miter")),R&&!(oe==="miter"&&Ve)&&this.updateDistance(R,I),oe==="miter")if(Ve){const Ze=I.dist(R);if(Ze>2*Ge){const Qe=I.sub(I.sub(R)._mult(Ge/Ze)._round());this.updateDistance(R,Qe),this.addCurrentVertex(Qe,X,0,0,D,ne),R=Qe}this.updateDistance(R,I),me._mult(Se),this.addCurrentVertex(I,me,0,0,D,ne);const We=I.dist(H);if(We>2*Ge){const Qe=I.add(H.sub(I)._mult(Ge/We)._round());this.updateDistance(I,Qe),this.addCurrentVertex(Qe,J,0,0,D,ne),I=Qe}}else me._mult(Se),this.addCurrentVertex(I,me,0,0,D,ne);else if(oe==="flipbevel"){if(Se>100)me=J.mult(-1);else{const Ze=Se*X.add(J).mag()/X.sub(J).mag();me._perp()._mult(Ze*(Ie?-1:1))}this.addCurrentVertex(I,me,0,0,D,ne),this.addCurrentVertex(I,me.mult(-1),0,0,D,ne)}else if(oe==="bevel"||oe==="fakeround"){ne!=null&&R&&this.addCurrentVertex(I,X,-1,-1,D,ne);const Ze=I.dist(R)<=2*Ge&&oe!=="bevel",We=me.mult(Ie?1:-1);We._mult(Se);const Qe=J.mult(Ie?-1:1),Je=X.mult(Ie?-1:1),ot=this.evaluateLineProgressFeatures(this.distance);if(ne==null&&(this.addHalfVertex(I,We.x,We.y,!1,!Ie,0,D,ot),Ze||this.addHalfVertex(I,We.x+2*Je.x,We.y+2*Je.y,!1,Ie,0,D,ot)),oe==="fakeround"){const nt=Math.round(180*Ae/Math.PI/20);this.addHalfVertex(I,Je.x,Je.y,!1,Ie,0,D,ot);for(let ct=0;ct<nt;ct++){let Ot=ct/nt;if(Ot!==.5){const cr=Ot-.5;Ot+=Ot*cr*(Ot-1)*((1.0904+ue*(ue*(3.55645-1.43519*ue)-3.2452))*cr*cr+(.848013+ue*(.215638*ue-1.06021)))}const Mt=Qe.sub(Je)._mult(Ot)._add(Je)._unit();this.addHalfVertex(I,Mt.x,Mt.y,!1,Ie,0,D,ot)}this.addHalfVertex(I,Qe.x,Qe.y,!1,Ie,0,D,ot)}Ze||ne!=null||this.addHalfVertex(I,We.x+2*Qe.x,We.y+2*Qe.y,!1,Ie,0,D,ot),ne!=null&&H&&this.addCurrentVertex(I,J,1,1,D,ne)}else oe==="butt"?this.addCurrentVertex(I,me,0,0,D,ne):oe==="square"?(R||this.addCurrentVertex(I,me,-1,-1,D,ne),this.addCurrentVertex(I,me,0,0,D,ne),R&&this.addCurrentVertex(I,me,1,1,D,ne)):oe==="round"&&(R&&(this.addCurrentVertex(I,X,0,0,D,ne),this.addCurrentVertex(I,X,1,1,D,ne,!0)),H&&(this.addCurrentVertex(I,J,-1,-1,D,ne,!0),this.addCurrentVertex(I,J,0,0,D,ne)))}}addVerticesTo(o,u,f,y,g,_,T,E,O,C){const M=(u.w-o.w)/this.tessellationStep|0;let D=0;const I=this.scaledDistance;if(M>1){this.lineSoFar=o.w;const H=(u.x-o.x)/M,X=(u.y-o.y)/M,J=(u.z-o.z)/M,ne=(u.w-o.w)/M;for(let re=1;re<M;++re){o.x+=H,o.y+=X,o.z+=J,this.lineSoFar+=ne,D+=ne;const te=this.evaluateLineProgressFeatures(this.prevDistance+D);this.scaledDistance=(this.prevDistance+D)/this.totalDistance,this.addHalfVertex(o,f,y,C,!1,T,O,te),this.addHalfVertex(o,g,_,C,!0,-E,O,te)}}this.lineSoFar=u.w,this.scaledDistance=I;const R=this.evaluateLineProgressFeatures(this.distance);this.addHalfVertex(u,f,y,C,!1,T,O,R),this.addHalfVertex(u,g,_,C,!0,-E,O,R)}evaluateLineProgressFeatures(o){if(!this.variableWidthValue&&!this.hasZOffset)return null;this.evaluationGlobals.lineProgress=0,this.lineClips?this.evaluationGlobals.lineProgress=Math.min(1,(this.totalFeatureLength*this.lineClips.start+o)/this.totalFeatureLength):_i(`line-progress evaluation for ${this.layerIds[0]} requires enabling 'lineMetrics' for the source.`);let u=0;return this.variableWidthValue&&this.variableWidthValue.kind!=="constant"&&(u=this.variableWidthValue.evaluate(this.evaluationGlobals,this.lineFeature)||0),this.hasZOffset?this.zOffsetValue.kind==="constant"?{zOffset:this.zOffsetValue.value,variableWidth:u}:{zOffset:this.zOffsetValue.evaluate(this.evaluationGlobals,this.lineFeature)||0,variableWidth:u}:{zOffset:0,variableWidth:u}}addCurrentVertex(o,u,f,y,g,_,T=!1){const E=u.x+u.y*f,O=u.y-u.x*f,C=u.y*y-u.x,M=-u.y-u.x*y;if(_!=null){const D=this.hasZOffset,I=-10,R=Wt+10,H=_.zOffset,X=new m8(o.x,o.y,H,this.lineSoFar),J=!!D&&z4(o,I,R),ne=this.lineSoFar,re=this.distance;if(this.currentVertex)if(J){const te=this.currentVertexIsOutside,oe=this.currentVertex,ue=new m8(o.x,o.y,H,this.lineSoFar);if(p8(oe,ue,I,R),!z4(ue,I,R)){if(te){this.e1=this.e2=-1,this.distance-=oe.dist(X),this.lineSoFar=oe.w;const me=this.evaluateLineProgressFeatures(oe.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(oe,E,O,T,!1,f,g,me),this.addHalfVertex(oe,C,M,T,!0,-y,g,me),this.prevDistance=this.distance}this.distance=this.prevDistance+oe.dist(ue),this.scaledDistance=this.distance/this.totalDistance,this.addVerticesTo(oe,ue,E,O,C,M,f,y,g,T),this.distance=re,this.scaledDistance=this.distance/this.totalDistance}}else{const te=this.currentVertex;if(this.currentVertexIsOutside){p8(te,X,I,R),this.e1=this.e2=-1,this.distance-=te.dist(X),this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=te.w;const oe=this.evaluateLineProgressFeatures(te.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(te,E,O,T,!1,f,g,oe),this.addHalfVertex(te,C,M,T,!0,-y,g,oe),this.prevDistance=this.distance,this.distance=re,this.scaledDistance=this.distance/this.totalDistance}this.addVerticesTo(te,X,E,O,C,M,f,y,g,T)}else J||(this.addHalfVertex(o,E,O,T,!1,f,g,_),this.addHalfVertex(o,C,M,T,!0,-y,g,_));this.currentVertex=X,this.currentVertexIsOutside=J,this.lineSoFar=ne}else this.addHalfVertex(o,E,O,T,!1,f,g,_),this.addHalfVertex(o,C,M,T,!0,-y,g,_)}addHalfVertex({x:o,y:u},f,y,g,_,T,E,O){if(this.patternJoinNone&&(this.segmentPoints.length===0&&(this.segmentStart=this.lineSoFar,this.segmentStartf32=Math.fround(this.lineSoFar)),_||this.segmentPoints.push(this.lineSoFar-this.segmentStart,T)),this.layoutVertexArray.emplaceBack((o<<1)+(g?1:0),(u<<1)+(_?1:0),Math.round(63*f)+128,Math.round(63*y)+128,1+(T===0?0:T<0?-1:1),0,this.lineSoFar-this.segmentStartf32),this.lineClips){const M=Mr(this.lineClips.start,this.lineClips.end,this.scaledDistance);this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,M)}const C=E.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,C),E.primitiveLength++),_?this.e2=C:this.e1=C,O!=null&&this.zOffsetVertexArray.emplaceBack(O.zOffset,O.variableWidth,O.variableWidth)}updateScaledDistance(){this.lineClips?(this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=this.totalFeatureLength*this.lineClips.start+this.distance):this.lineSoFar=this.distance}updateDistance(o,u){this.prevDistance=this.distance,this.distance+=o.dist(u),this.updateScaledDistance()}}function z4(m,o,u){return m.x<o||m.x>u||m.y<o||m.y>u}let V8,U8;function G8(m,o,u){return o*(Wt/(m.tileSize*Math.pow(2,u-m.tileID.overscaledZ)))}lr(D4,"LineBucket",{omit:["layers","patternFeatures","currentVertex","currentVertexIsOutside"]});const H8=(m,o,u)=>(1-u)*m+u*o;function q8(m,o){return 1/G8(m,1,o.tileZoom)}function W8(m,o,u,f){return m.translatePosMatrix(f||o.tileID.projMatrix,o,u.paint.get("line-translate"),u.paint.get("line-translate-anchor"))}const K8=m=>{const o=[];Z8(m)&&o.push("RENDER_LINE_DASH"),m.paint.get("line-gradient")&&o.push("RENDER_LINE_GRADIENT");const u=m.paint.get("line-trim-offset");u[0]===0&&u[1]===0||o.push("RENDER_LINE_TRIM_OFFSET"),m.paint.get("line-border-width").constantOr(1)!==0&&o.push("RENDER_LINE_BORDER");const f=m.layout.get("line-join").constantOr("miter")==="none",y=!!m.paint.get("line-pattern").constantOr(1);return f&&y&&o.push("LINE_JOIN_NONE"),o};function Z8(m){const o=m.paint.get("line-dasharray").value;return o.value||o.kind!=="constant"}let L4;const Y8=()=>L4||(L4={layout:V8||(V8=new Ki({"line-cap":new ar(ut.layout_line["line-cap"]),"line-join":new ar(ut.layout_line["line-join"]),"line-miter-limit":new Vt(ut.layout_line["line-miter-limit"]),"line-round-limit":new Vt(ut.layout_line["line-round-limit"]),"line-sort-key":new ar(ut.layout_line["line-sort-key"]),"line-z-offset":new ar(ut.layout_line["line-z-offset"]),"line-elevation-reference":new Vt(ut.layout_line["line-elevation-reference"]),"line-cross-slope":new Vt(ut.layout_line["line-cross-slope"]),visibility:new Vt(ut.layout_line.visibility),"line-width-unit":new Vt(ut.layout_line["line-width-unit"])})),paint:U8||(U8=new Ki({"line-opacity":new ar(ut.paint_line["line-opacity"]),"line-color":new ar(ut.paint_line["line-color"]),"line-translate":new Vt(ut.paint_line["line-translate"]),"line-translate-anchor":new Vt(ut.paint_line["line-translate-anchor"]),"line-width":new ar(ut.paint_line["line-width"]),"line-gap-width":new ar(ut.paint_line["line-gap-width"]),"line-offset":new ar(ut.paint_line["line-offset"]),"line-blur":new ar(ut.paint_line["line-blur"]),"line-dasharray":new ar(ut.paint_line["line-dasharray"]),"line-pattern":new ar(ut.paint_line["line-pattern"]),"line-gradient":new bf(ut.paint_line["line-gradient"]),"line-trim-offset":new Vt(ut.paint_line["line-trim-offset"]),"line-trim-fade-range":new Vt(ut.paint_line["line-trim-fade-range"]),"line-trim-color":new Vt(ut.paint_line["line-trim-color"]),"line-emissive-strength":new Vt(ut.paint_line["line-emissive-strength"]),"line-border-width":new ar(ut.paint_line["line-border-width"]),"line-border-color":new ar(ut.paint_line["line-border-color"]),"line-occlusion-opacity":new Vt(ut.paint_line["line-occlusion-opacity"]),"line-color-use-theme":new ar({type:"string",default:"default","property-type":"data-driven"}),"line-gradient-use-theme":new ar({type:"string",default:"default","property-type":"data-driven"}),"line-trim-color-use-theme":new ar({type:"string",default:"default","property-type":"data-driven"}),"line-border-color-use-theme":new ar({type:"string",default:"default","property-type":"data-driven"})}))},L4);class qme extends ar{possiblyEvaluate(o,u){return u=new hi(Math.floor(u.zoom),{now:u.now,fadeDuration:u.fadeDuration,transition:u.transition}),super.possiblyEvaluate(o,u)}evaluate(o,u,f,y){return u=Ui({},u,{zoom:Math.floor(u.zoom)}),super.evaluate(o,u,f,y)}}let pw;function X8(m,o){return o>0?o+2*m:m}const Wme=Bn([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Kme=Bn([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),Zme=Bn([{name:"a_projected_pos",components:4,type:"Float32"}],4);Bn([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Yme=Bn([{name:"a_auto_z_offset",components:1,type:"Float32"}],4),Xme=Bn([{name:"a_texb",components:2,type:"Uint16"}]),Jme=Bn([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_elevation_from_sea",components:2,type:"Float32"}]),Qme=Bn([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"},{name:"a_auto_z_offset",components:1,type:"Float32"}]);Bn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const J8=Bn([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),efe=Bn([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Bn([{name:"triangle",components:3,type:"Uint16"}]),Bn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Bn([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Uint8",name:"hasIconTextFit"},{type:"Uint16",name:"elevationFeatureIndex"}]),Bn([{type:"Float32",name:"offsetX"}]),Bn([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var Ma=24;const qu=128;function Q8(m,o,u,f,y){if(m.kind==="camera")return m.maxSize;if(m.kind==="composite"){const g=o.possiblyEvaluate(new hi(m.maxZoom),u).evaluate(y,{},u),_=o.possiblyEvaluate(new hi(m.minZoom),u).evaluate(y,{},u);return Math.max(g,_)}return o.possiblyEvaluate(new hi(f)).evaluate(y,{},u)}function F4(m,o){const{expression:u}=o;if(u.kind==="constant")return{kind:"constant",layoutSize:u.evaluate(new hi(m+1))};if(u.kind==="source")return{kind:"source"};{const{zoomStops:f,interpolationType:y}=u;let g=0;for(;g<f.length&&f[g]<=m;)g++;g=Math.max(0,g-1);let _=g;for(;_<f.length&&f[_]<m+1;)_++;_=Math.min(f.length-1,_);const T=f[g],E=f[_];return u.kind==="composite"?{kind:"composite",minZoom:T,maxZoom:E,interpolationType:y}:{kind:"camera",minZoom:T,maxZoom:E,minSize:u.evaluate(new hi(T)),maxSize:u.evaluate(new hi(E)),interpolationType:y}}}function MC(m,{uSize:o,uSizeT:u},{lowerSize:f,upperSize:y}){return m.kind==="source"?f/qu:m.kind==="composite"?Mr(f/qu,y/qu,u):o}function Ay(m,o,u=1){let f=0,y=0;if(m.kind==="constant")y=m.layoutSize*u;else if(m.kind!=="source"){const{interpolationType:g,minZoom:_,maxZoom:T}=m,E=g?rr(ol.interpolationFactor(g,o,_,T),0,1):0;m.kind==="camera"?y=Mr(m.minSize,m.maxSize,E)*u:f=E*u}return{uSizeT:f,uSize:y}}var tfe=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:qu,evaluateSizeForFeature:MC,evaluateSizeForZoom:Ay,getRasterizedIconSize:Q8,getSizeData:F4});function rfe(m,o,u){return m.sections.forEach(f=>{f.text=function(y,g,_){const T=g.layout.get("text-transform").evaluate(_,{});return T==="uppercase"?y=y.toLocaleUpperCase():T==="lowercase"&&(y=y.toLocaleLowerCase()),Fl.applyArabicShaping&&(y=Fl.applyArabicShaping(y)),y}(f.text,o,u)}),m}const gw={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂","←":"↑","→":"↓"};function nfe(m){return m==="︶"||m==="﹈"||m==="︸"||m==="﹄"||m==="﹂"||m==="︾"||m==="︼"||m==="︺"||m==="︘"||m==="﹀"||m==="︐"||m==="︓"||m==="︔"||m==="｀"||m==="￣"||m==="︑"||m==="︒"}function ife(m){return m==="︵"||m==="﹇"||m==="︷"||m==="﹃"||m==="﹁"||m==="︽"||m==="︻"||m==="︹"||m==="︗"||m==="︿"}var eV,B4,tV,$4={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function sfe(){return eV||(eV=1,$4.read=function(m,o,u,f,y){var g,_,T=8*y-f-1,E=(1<<T)-1,O=E>>1,C=-7,M=u?y-1:0,D=u?-1:1,I=m[o+M];for(M+=D,g=I&(1<<-C)-1,I>>=-C,C+=T;C>0;g=256*g+m[o+M],M+=D,C-=8);for(_=g&(1<<-C)-1,g>>=-C,C+=f;C>0;_=256*_+m[o+M],M+=D,C-=8);if(g===0)g=1-O;else{if(g===E)return _?NaN:1/0*(I?-1:1);_+=Math.pow(2,f),g-=O}return(I?-1:1)*_*Math.pow(2,g-f)},$4.write=function(m,o,u,f,y,g){var _,T,E,O=8*g-y-1,C=(1<<O)-1,M=C>>1,D=y===23?Math.pow(2,-24)-Math.pow(2,-77):0,I=f?0:g-1,R=f?1:-1,H=o<0||o===0&&1/o<0?1:0;for(o=Math.abs(o),isNaN(o)||o===1/0?(T=isNaN(o)?1:0,_=C):(_=Math.floor(Math.log(o)/Math.LN2),o*(E=Math.pow(2,-_))<1&&(_--,E*=2),(o+=_+M>=1?D/E:D*Math.pow(2,1-M))*E>=2&&(_++,E/=2),_+M>=C?(T=0,_=C):_+M>=1?(T=(o*E-1)*Math.pow(2,y),_+=M):(T=o*Math.pow(2,M-1)*Math.pow(2,y),_=0));y>=8;m[u+I]=255&T,I+=R,T/=256,y-=8);for(_=_<<y|T,O+=y;O>0;m[u+I]=255&_,I+=R,_/=256,O-=8);m[u+I-R]|=128*H}),$4}function rV(){if(tV)return B4;tV=1,B4=o;var m=sfe();function o(te){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(te)?te:new Uint8Array(te||0),this.pos=0,this.type=0,this.length=this.buf.length}o.Varint=0,o.Fixed64=1,o.Bytes=2,o.Fixed32=5;var u=4294967296,f=1/u,y=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function g(te){return te.type===o.Bytes?te.readVarint()+te.pos:te.pos+1}function _(te,oe,ue){return ue?4294967296*oe+(te>>>0):4294967296*(oe>>>0)+(te>>>0)}function T(te,oe,ue){var me=oe<=16383?1:oe<=2097151?2:oe<=268435455?3:Math.floor(Math.log(oe)/(7*Math.LN2));ue.realloc(me);for(var Me=ue.pos-1;Me>=te;Me--)ue.buf[Me+me]=ue.buf[Me]}function E(te,oe){for(var ue=0;ue<te.length;ue++)oe.writeVarint(te[ue])}function O(te,oe){for(var ue=0;ue<te.length;ue++)oe.writeSVarint(te[ue])}function C(te,oe){for(var ue=0;ue<te.length;ue++)oe.writeFloat(te[ue])}function M(te,oe){for(var ue=0;ue<te.length;ue++)oe.writeDouble(te[ue])}function D(te,oe){for(var ue=0;ue<te.length;ue++)oe.writeBoolean(te[ue])}function I(te,oe){for(var ue=0;ue<te.length;ue++)oe.writeFixed32(te[ue])}function R(te,oe){for(var ue=0;ue<te.length;ue++)oe.writeSFixed32(te[ue])}function H(te,oe){for(var ue=0;ue<te.length;ue++)oe.writeFixed64(te[ue])}function X(te,oe){for(var ue=0;ue<te.length;ue++)oe.writeSFixed64(te[ue])}function J(te,oe){return(te[oe]|te[oe+1]<<8|te[oe+2]<<16)+16777216*te[oe+3]}function ne(te,oe,ue){te[ue]=oe,te[ue+1]=oe>>>8,te[ue+2]=oe>>>16,te[ue+3]=oe>>>24}function re(te,oe){return(te[oe]|te[oe+1]<<8|te[oe+2]<<16)+(te[oe+3]<<24)}return o.prototype={destroy:function(){this.buf=null},readFields:function(te,oe,ue){for(ue=ue||this.length;this.pos<ue;){var me=this.readVarint(),Me=me>>3,Se=this.pos;this.type=7&me,te(Me,oe,this),this.pos===Se&&this.skip(me)}return oe},readMessage:function(te,oe){return this.readFields(te,oe,this.readVarint()+this.pos)},readFixed32:function(){var te=J(this.buf,this.pos);return this.pos+=4,te},readSFixed32:function(){var te=re(this.buf,this.pos);return this.pos+=4,te},readFixed64:function(){var te=J(this.buf,this.pos)+J(this.buf,this.pos+4)*u;return this.pos+=8,te},readSFixed64:function(){var te=J(this.buf,this.pos)+re(this.buf,this.pos+4)*u;return this.pos+=8,te},readFloat:function(){var te=m.read(this.buf,this.pos,!0,23,4);return this.pos+=4,te},readDouble:function(){var te=m.read(this.buf,this.pos,!0,52,8);return this.pos+=8,te},readVarint:function(te){var oe,ue,me=this.buf;return oe=127&(ue=me[this.pos++]),ue<128?oe:(oe|=(127&(ue=me[this.pos++]))<<7,ue<128?oe:(oe|=(127&(ue=me[this.pos++]))<<14,ue<128?oe:(oe|=(127&(ue=me[this.pos++]))<<21,ue<128?oe:function(Me,Se,Ae){var Ve,Ie,Ge=Ae.buf;if(Ve=(112&(Ie=Ge[Ae.pos++]))>>4,Ie<128||(Ve|=(127&(Ie=Ge[Ae.pos++]))<<3,Ie<128)||(Ve|=(127&(Ie=Ge[Ae.pos++]))<<10,Ie<128)||(Ve|=(127&(Ie=Ge[Ae.pos++]))<<17,Ie<128)||(Ve|=(127&(Ie=Ge[Ae.pos++]))<<24,Ie<128)||(Ve|=(1&(Ie=Ge[Ae.pos++]))<<31,Ie<128))return _(Me,Ve,Se);throw new Error("Expected varint not more than 10 bytes")}(oe|=(15&(ue=me[this.pos]))<<28,te,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var te=this.readVarint();return te%2==1?(te+1)/-2:te/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var te=this.readVarint()+this.pos,oe=this.pos;return this.pos=te,te-oe>=12&&y?function(ue,me,Me){return y.decode(ue.subarray(me,Me))}(this.buf,oe,te):function(ue,me,Me){for(var Se="",Ae=me;Ae<Me;){var Ve,Ie,Ge,Ze=ue[Ae],We=null,Qe=Ze>239?4:Ze>223?3:Ze>191?2:1;if(Ae+Qe>Me)break;Qe===1?Ze<128&&(We=Ze):Qe===2?(192&(Ve=ue[Ae+1]))==128&&(We=(31&Ze)<<6|63&Ve)<=127&&(We=null):Qe===3?(Ie=ue[Ae+2],(192&(Ve=ue[Ae+1]))==128&&(192&Ie)==128&&((We=(15&Ze)<<12|(63&Ve)<<6|63&Ie)<=2047||We>=55296&&We<=57343)&&(We=null)):Qe===4&&(Ie=ue[Ae+2],Ge=ue[Ae+3],(192&(Ve=ue[Ae+1]))==128&&(192&Ie)==128&&(192&Ge)==128&&((We=(15&Ze)<<18|(63&Ve)<<12|(63&Ie)<<6|63&Ge)<=65535||We>=1114112)&&(We=null)),We===null?(We=65533,Qe=1):We>65535&&(We-=65536,Se+=String.fromCharCode(We>>>10&1023|55296),We=56320|1023&We),Se+=String.fromCharCode(We),Ae+=Qe}return Se}(this.buf,oe,te)},readBytes:function(){var te=this.readVarint()+this.pos,oe=this.buf.subarray(this.pos,te);return this.pos=te,oe},readPackedVarint:function(te,oe){if(this.type!==o.Bytes)return te.push(this.readVarint(oe));var ue=g(this);for(te=te||[];this.pos<ue;)te.push(this.readVarint(oe));return te},readPackedSVarint:function(te){if(this.type!==o.Bytes)return te.push(this.readSVarint());var oe=g(this);for(te=te||[];this.pos<oe;)te.push(this.readSVarint());return te},readPackedBoolean:function(te){if(this.type!==o.Bytes)return te.push(this.readBoolean());var oe=g(this);for(te=te||[];this.pos<oe;)te.push(this.readBoolean());return te},readPackedFloat:function(te){if(this.type!==o.Bytes)return te.push(this.readFloat());var oe=g(this);for(te=te||[];this.pos<oe;)te.push(this.readFloat());return te},readPackedDouble:function(te){if(this.type!==o.Bytes)return te.push(this.readDouble());var oe=g(this);for(te=te||[];this.pos<oe;)te.push(this.readDouble());return te},readPackedFixed32:function(te){if(this.type!==o.Bytes)return te.push(this.readFixed32());var oe=g(this);for(te=te||[];this.pos<oe;)te.push(this.readFixed32());return te},readPackedSFixed32:function(te){if(this.type!==o.Bytes)return te.push(this.readSFixed32());var oe=g(this);for(te=te||[];this.pos<oe;)te.push(this.readSFixed32());return te},readPackedFixed64:function(te){if(this.type!==o.Bytes)return te.push(this.readFixed64());var oe=g(this);for(te=te||[];this.pos<oe;)te.push(this.readFixed64());return te},readPackedSFixed64:function(te){if(this.type!==o.Bytes)return te.push(this.readSFixed64());var oe=g(this);for(te=te||[];this.pos<oe;)te.push(this.readSFixed64());return te},skip:function(te){var oe=7&te;if(oe===o.Varint)for(;this.buf[this.pos++]>127;);else if(oe===o.Bytes)this.pos=this.readVarint()+this.pos;else if(oe===o.Fixed32)this.pos+=4;else{if(oe!==o.Fixed64)throw new Error("Unimplemented type: "+oe);this.pos+=8}},writeTag:function(te,oe){this.writeVarint(te<<3|oe)},realloc:function(te){for(var oe=this.length||16;oe<this.pos+te;)oe*=2;if(oe!==this.length){var ue=new Uint8Array(oe);ue.set(this.buf),this.buf=ue,this.length=oe}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(te){this.realloc(4),ne(this.buf,te,this.pos),this.pos+=4},writeSFixed32:function(te){this.realloc(4),ne(this.buf,te,this.pos),this.pos+=4},writeFixed64:function(te){this.realloc(8),ne(this.buf,-1&te,this.pos),ne(this.buf,Math.floor(te*f),this.pos+4),this.pos+=8},writeSFixed64:function(te){this.realloc(8),ne(this.buf,-1&te,this.pos),ne(this.buf,Math.floor(te*f),this.pos+4),this.pos+=8},writeVarint:function(te){(te=+te||0)>268435455||te<0?function(oe,ue){var me,Me;if(oe>=0?(me=oe%4294967296|0,Me=oe/4294967296|0):(Me=~(-oe/4294967296),4294967295^(me=~(-oe%4294967296))?me=me+1|0:(me=0,Me=Me+1|0)),oe>=18446744073709552e3||oe<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");ue.realloc(10),function(Se,Ae,Ve){Ve.buf[Ve.pos++]=127&Se|128,Se>>>=7,Ve.buf[Ve.pos++]=127&Se|128,Se>>>=7,Ve.buf[Ve.pos++]=127&Se|128,Se>>>=7,Ve.buf[Ve.pos++]=127&Se|128,Ve.buf[Ve.pos]=127&(Se>>>=7)}(me,0,ue),function(Se,Ae){var Ve=(7&Se)<<4;Ae.buf[Ae.pos++]|=Ve|((Se>>>=3)?128:0),Se&&(Ae.buf[Ae.pos++]=127&Se|((Se>>>=7)?128:0),Se&&(Ae.buf[Ae.pos++]=127&Se|((Se>>>=7)?128:0),Se&&(Ae.buf[Ae.pos++]=127&Se|((Se>>>=7)?128:0),Se&&(Ae.buf[Ae.pos++]=127&Se|((Se>>>=7)?128:0),Se&&(Ae.buf[Ae.pos++]=127&Se)))))}(Me,ue)}(te,this):(this.realloc(4),this.buf[this.pos++]=127&te|(te>127?128:0),te<=127||(this.buf[this.pos++]=127&(te>>>=7)|(te>127?128:0),te<=127||(this.buf[this.pos++]=127&(te>>>=7)|(te>127?128:0),te<=127||(this.buf[this.pos++]=te>>>7&127))))},writeSVarint:function(te){this.writeVarint(te<0?2*-te-1:2*te)},writeBoolean:function(te){this.writeVarint(!!te)},writeString:function(te){te=String(te),this.realloc(4*te.length),this.pos++;var oe=this.pos;this.pos=function(me,Me,Se){for(var Ae,Ve,Ie=0;Ie<Me.length;Ie++){if((Ae=Me.charCodeAt(Ie))>55295&&Ae<57344){if(!Ve){Ae>56319||Ie+1===Me.length?(me[Se++]=239,me[Se++]=191,me[Se++]=189):Ve=Ae;continue}if(Ae<56320){me[Se++]=239,me[Se++]=191,me[Se++]=189,Ve=Ae;continue}Ae=Ve-55296<<10|Ae-56320|65536,Ve=null}else Ve&&(me[Se++]=239,me[Se++]=191,me[Se++]=189,Ve=null);Ae<128?me[Se++]=Ae:(Ae<2048?me[Se++]=Ae>>6|192:(Ae<65536?me[Se++]=Ae>>12|224:(me[Se++]=Ae>>18|240,me[Se++]=Ae>>12&63|128),me[Se++]=Ae>>6&63|128),me[Se++]=63&Ae|128)}return Se}(this.buf,te,this.pos);var ue=this.pos-oe;ue>=128&&T(oe,ue,this),this.pos=oe-1,this.writeVarint(ue),this.pos+=ue},writeFloat:function(te){this.realloc(4),m.write(this.buf,te,this.pos,!0,23,4),this.pos+=4},writeDouble:function(te){this.realloc(8),m.write(this.buf,te,this.pos,!0,52,8),this.pos+=8},writeBytes:function(te){var oe=te.length;this.writeVarint(oe),this.realloc(oe);for(var ue=0;ue<oe;ue++)this.buf[this.pos++]=te[ue]},writeRawMessage:function(te,oe){this.pos++;var ue=this.pos;te(oe,this);var me=this.pos-ue;me>=128&&T(ue,me,this),this.pos=ue-1,this.writeVarint(me),this.pos+=me},writeMessage:function(te,oe,ue){this.writeTag(te,o.Bytes),this.writeRawMessage(oe,ue)},writePackedVarint:function(te,oe){oe.length&&this.writeMessage(te,E,oe)},writePackedSVarint:function(te,oe){oe.length&&this.writeMessage(te,O,oe)},writePackedBoolean:function(te,oe){oe.length&&this.writeMessage(te,D,oe)},writePackedFloat:function(te,oe){oe.length&&this.writeMessage(te,C,oe)},writePackedDouble:function(te,oe){oe.length&&this.writeMessage(te,M,oe)},writePackedFixed32:function(te,oe){oe.length&&this.writeMessage(te,I,oe)},writePackedSFixed32:function(te,oe){oe.length&&this.writeMessage(te,R,oe)},writePackedFixed64:function(te,oe){oe.length&&this.writeMessage(te,H,oe)},writePackedSFixed64:function(te,oe){oe.length&&this.writeMessage(te,X,oe)},writeBytesField:function(te,oe){this.writeTag(te,o.Bytes),this.writeBytes(oe)},writeFixed32Field:function(te,oe){this.writeTag(te,o.Fixed32),this.writeFixed32(oe)},writeSFixed32Field:function(te,oe){this.writeTag(te,o.Fixed32),this.writeSFixed32(oe)},writeFixed64Field:function(te,oe){this.writeTag(te,o.Fixed64),this.writeFixed64(oe)},writeSFixed64Field:function(te,oe){this.writeTag(te,o.Fixed64),this.writeSFixed64(oe)},writeVarintField:function(te,oe){this.writeTag(te,o.Varint),this.writeVarint(oe)},writeSVarintField:function(te,oe){this.writeTag(te,o.Varint),this.writeSVarint(oe)},writeStringField:function(te,oe){this.writeTag(te,o.Bytes),this.writeString(oe)},writeFloatField:function(te,oe){this.writeTag(te,o.Fixed32),this.writeFloat(oe)},writeDoubleField:function(te,oe){this.writeTag(te,o.Fixed64),this.writeDouble(oe)},writeBooleanField:function(te,oe){this.writeVarintField(te,!!oe)}},B4}var IC=p(rV());const V4=3;function afe(m,o,u){o.glyphs=[],m===1&&u.readMessage(ofe,o)}function ofe(m,o,u){if(m===3){const{id:f,bitmap:y,width:g,height:_,left:T,top:E,advance:O}=u.readMessage(lfe,{});o.glyphs.push({id:f,bitmap:new Pf({width:g+2*V4,height:_+2*V4},y),metrics:{width:g,height:_,left:T,top:E,advance:O}})}else m===4?o.ascender=u.readSVarint():m===5&&(o.descender=u.readSVarint())}function lfe(m,o,u){m===1?o.id=u.readVarint():m===2?o.bitmap=u.readBytes():m===3?o.width=u.readVarint():m===4?o.height=u.readVarint():m===5?o.left=u.readSVarint():m===6?o.top=u.readSVarint():m===7&&(o.advance=u.readVarint())}const nV=V4,hl={horizontal:1,vertical:2,horizontalOnly:3};class xw{constructor(){this.scale=1,this.fontStack="",this.image=null}static forText(o,u){const f=new xw;return f.scale=o||1,f.fontStack=u,f}static forImage(o){const u=new xw;return u.image=o,u}}class Ty{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(o,u,f){const y=new Ty;for(let g=0;g<o.sections.length;g++){const _=o.sections[g];_.image?y.addImageSection(_,f):y.addTextSection(_,u)}return y}length(){return this.text.length}getSection(o){return this.sections[this.sectionIndex[o]]}getSections(){return this.sections}getSectionIndex(o){return this.sectionIndex[o]}getCodePoint(o){return this.text.codePointAt(o)}verticalizePunctuation(o){this.text=function(u,f){let y="";for(let g=0;g<u.length;g++){const _=u.charCodeAt(g+1)||null,T=u.charCodeAt(g-1)||null;y+=!f&&(_&&T1(_)&&!gw[u[g+1]]||T&&T1(T)&&!gw[u[g-1]])||!gw[u[g]]?u[g]:gw[u[g]]}return y}(this.text,o)}trim(){let o=0;for(let f=0;f<this.text.length&&OC[this.text.charCodeAt(f)];f++)o++;let u=this.text.length;for(let f=this.text.length-1;f>=0&&f>=o&&OC[this.text.charCodeAt(f)];f--)u--;this.text=this.text.substring(o,u),this.sectionIndex=this.sectionIndex.slice(o,u)}substring(o,u){const f=new Ty;return f.text=this.text.substring(o,u),f.sectionIndex=this.sectionIndex.slice(o,u),f.sections=this.sections,f}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((o,u)=>Math.max(o,this.sections[u].scale),0)}addTextSection(o,u){this.text+=o.text,this.sections.push(xw.forText(o.scale,o.fontStack||u));const f=this.sections.length-1;for(let y=0;y<o.text.length;++y)this.sectionIndex.push(f)}addImageSection(o,u){const f=o.image?o.image.getPrimary():null;if(!f)return void _i("Can't add FormattedSection with an empty image.");f.scaleSelf(u);const y=this.getNextImageSectionCharCode();y?(this.text+=String.fromCodePoint(y),this.sections.push(xw.forImage(f)),this.sectionIndex.push(this.sections.length-1)):_i("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function U4(m,o,u,f,y,g,_,T,E,O,C,M,D,I,R,H=1){const X=Ty.fromFeature(m,y,H);M===hl.vertical&&X.verticalizePunctuation(D);let J=[];const ne=function(me,Me,Se,Ae,Ve,Ie){if(!me)return[];const Ge=[],Ze=function(ot,nt,ct,Ot,Mt,cr){let Lt=0;for(let Gt=0;Gt<ot.length();Gt++){const Rt=ot.getSection(Gt);Lt+=iV(ot.getCodePoint(Gt),Rt,Ot,Mt,nt,cr)}return Lt/Math.max(1,Math.ceil(Lt/ct))}(me,Me,Se,Ae,Ve,Ie),We=me.text.indexOf("​")>=0;let Qe=0;for(let ot=0;ot<me.length();ot++){const nt=me.getSection(ot),ct=me.getCodePoint(ot);if(OC[ct]||(Qe+=iV(ct,nt,Ae,Ve,Me,Ie)),ot<me.length()-1){const Ot=!((Je=ct)<11904||!(Tr["Bopomofo Extended"](Je)||Tr.Bopomofo(Je)||Tr["CJK Compatibility Forms"](Je)||Tr["CJK Compatibility Ideographs"](Je)||Tr["CJK Compatibility"](Je)||Tr["CJK Radicals Supplement"](Je)||Tr["CJK Strokes"](Je)||Tr["CJK Symbols and Punctuation"](Je)||Tr["CJK Unified Ideographs Extension A"](Je)||Tr["CJK Unified Ideographs"](Je)||Tr["Enclosed CJK Letters and Months"](Je)||Tr["Halfwidth and Fullwidth Forms"](Je)||Tr.Hiragana(Je)||Tr["Ideographic Description Characters"](Je)||Tr["Kangxi Radicals"](Je)||Tr["Katakana Phonetic Extensions"](Je)||Tr.Katakana(Je)||Tr["Vertical Forms"](Je)||Tr["Yi Radicals"](Je)||Tr["Yi Syllables"](Je)));(cfe[ct]||Ot||nt.image)&&Ge.push(aV(ot+1,Qe,Ze,Ge,ufe(ct,me.getCodePoint(ot+1),Ot&&We),!1))}}var Je;return oV(aV(me.length(),Qe,Ze,Ge,0,!0))}(X,O,g,o,f,I),{processBidirectionalText:re,processStyledBidirectionalText:te}=Fl;if(re&&X.sections.length===1){const me=re(X.toString(),ne);for(const Me of me){const Se=new Ty;Se.text=Me,Se.sections=X.sections;for(let Ae=0;Ae<Me.length;Ae++)Se.sectionIndex.push(0);J.push(Se)}}else if(te){const me=te(X.text,X.sectionIndex,ne);for(const Me of me){const Se=new Ty;Se.text=Me[0],Se.sectionIndex=Me[1],Se.sections=X.sections,J.push(Se)}}else J=function(me,Me){const Se=[],Ae=me.text;let Ve=0;for(const Ie of Me)Se.push(me.substring(Ve,Ie)),Ve=Ie;return Ve<Ae.length&&Se.push(me.substring(Ve,Ae.length)),Se}(X,ne);const oe=[],ue={positionedLines:oe,text:X.toString(),top:C[1],bottom:C[1],left:C[0],right:C[0],writingMode:M,iconsInText:!1,verticalizable:!1,hasBaseline:!1};if(function(me,Me,Se,Ae,Ve,Ie,Ge,Ze,We,Qe,Je,ot){let nt=0,ct=0,Ot=0;const Mt=Ze==="right"?1:Ze==="left"?0:.5;let cr=!1;for(const pr of Ve){const Lr=pr.getSections();for(const on of Lr){if(on.image)continue;const $r=Me[on.fontStack];if($r&&(cr=$r.ascender!==void 0&&$r.descender!==void 0,!cr))break}if(!cr)break}let Lt=0;for(const pr of Ve){pr.trim();const Lr=pr.getMaxScale(),on=(Lr-1)*Ma,$r={positionedGlyphs:[],lineOffset:0};me.positionedLines[Lt]=$r;const fn=$r.positionedGlyphs;let sn=0;if(!pr.length()){ct+=Ie,++Lt;continue}let pn=0,Rn=0;for(let Fr=0;Fr<pr.length();Fr++){const Sn=pr.getSection(Fr),Ni=pr.getSectionIndex(Fr),zi=pr.getCodePoint(Fr);let Zi=Sn.scale,ts=null,li=null,ta=null,wo=Ma,Ns=0;We===hl.vertical&&((Gt=zi)===12312||Gt===12313||Gt===12316||Gt===12540||Gt===12448)&&(We=hl.horizontal);const Is=!(We===hl.horizontal||!Je&&!iy(zi)||Je&&(OC[zi]||QS(zi)));if(Sn.image){const Ka=Ae.get(Sn.image.toString());if(!Ka)continue;ta=Sn.image,me.iconsInText=me.iconsInText||!0,li=Ka.paddedRect;const wa=Ka.displaySize;Zi=Zi*Ma/ot,ts={width:wa[0],height:wa[1],left:0,top:-nV,advance:Is?wa[1]:wa[0],localGlyph:!1},Ns=cr?-ts.height*Zi:Lr*Ma-17-wa[1]*Zi,wo=ts.advance;const pc=(Is?wa[0]:wa[1])*Zi-Ma*Lr;pc>0&&pc>sn&&(sn=pc)}else{const Ka=Se[Sn.fontStack];if(!Ka)continue;Ka[zi]&&(li=Ka[zi]);const wa=Me[Sn.fontStack];if(!wa)continue;const pc=wa.glyphs[zi];if(!pc)continue;if(ts=pc.metrics,wo=zi!==8203?Ma:0,cr){const Lf=wa.ascender!==void 0?Math.abs(wa.ascender):0,iu=wa.descender!==void 0?Math.abs(wa.descender):0,Xu=(Lf+iu)*Zi;pn<Xu&&(pn=Xu,Rn=(Lf-iu)/2*Zi),Ns=-Lf*Zi}else Ns=(Lr-Zi)*Ma-17}Is?(me.verticalizable=!0,fn.push({glyph:zi,image:ta,x:nt,y:ct+Ns,vertical:Is,scale:Zi,localGlyph:ts.localGlyph,fontStack:Sn.fontStack,sectionIndex:Ni,metrics:ts,rect:li}),nt+=wo*Zi+Qe):(fn.push({glyph:zi,image:ta,x:nt,y:ct+Ns,vertical:Is,scale:Zi,localGlyph:ts.localGlyph,fontStack:Sn.fontStack,sectionIndex:Ni,metrics:ts,rect:li}),nt+=ts.advance*Zi+Qe)}fn.length!==0&&(Ot=Math.max(nt-Qe,Ot),cr?lV(fn,Mt,sn,Rn,Ie*Lr/2):lV(fn,Mt,sn,0,Ie/2)),nt=0;const mi=Ie*Lr+sn;$r.lineOffset=Math.max(sn,on),ct+=mi,++Lt}var Gt;const Rt=ct,{horizontalAlign:Pr,verticalAlign:ir}=G4(Ge);(function(pr,Lr,on,$r,fn,sn){const pn=(Lr-on)*fn,Rn=-sn*$r;for(const mi of pr)for(const Fr of mi.positionedGlyphs)Fr.x+=pn,Fr.y+=Rn})(me.positionedLines,Mt,Pr,ir,Ot,Rt),me.top+=-ir*Rt,me.bottom=me.top+Rt,me.left+=-Pr*Ot,me.right=me.left+Ot,me.hasBaseline=cr}(ue,o,u,f,J,_,T,E,M,O,D,R),!function(me){for(const Me of me)if(Me.positionedGlyphs.length!==0)return!1;return!0}(oe))return ue}const OC={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},cfe={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function iV(m,o,u,f,y,g){if(o.image){const _=f.get(o.image.toString());return _?_.displaySize[0]*o.scale*Ma/g+y:0}{const _=u[o.fontStack],T=_&&_.glyphs[m];return T?T.metrics.advance*o.scale+y:0}}function sV(m,o,u,f){const y=Math.pow(m-o,2);return f?m<o?y/2:2*y:y+Math.abs(u)*u}function ufe(m,o,u){let f=0;return m===10&&(f-=1e4),u&&(f+=150),m!==40&&m!==65288||(f+=50),o!==41&&o!==65289||(f+=50),f}function aV(m,o,u,f,y,g){let _=null,T=sV(o,u,y,g);for(const E of f){const O=sV(o-E.x,u,y,g)+E.badness;O<=T&&(_=E,T=O)}return{index:m,x:o,priorBreak:_,badness:T}}function oV(m){return m?oV(m.priorBreak).concat(m.index):[]}function G4(m){let o=.5,u=.5;switch(m){case"right":case"top-right":case"bottom-right":o=1;break;case"left":case"top-left":case"bottom-left":o=0}switch(m){case"bottom":case"bottom-right":case"bottom-left":u=1;break;case"top":case"top-right":case"top-left":u=0}return{horizontalAlign:o,verticalAlign:u}}function lV(m,o,u,f,y){if(!(o||u||f||y))return;const g=m.length-1,_=m[g],T=(_.x+_.metrics.advance*_.scale)*o;for(let E=0;E<=g;E++)m[E].x-=T,m[E].y+=u+f+y}function dfe(m,o,u,f){const{horizontalAlign:y,verticalAlign:g}=G4(f),_=u[0]-m.displaySize[0]*y,T=u[1]-m.displaySize[1]*g;return{imagePrimary:m,imageSecondary:o,top:T,bottom:T+m.displaySize[1],left:_,right:_+m.displaySize[0]}}function cV(m,o,u,f,y,g){const _=m.imagePrimary;let T;if(_.content){const X=_.content,J=_.pixelRatio||1;T=[X[0]/J,X[1]/J,_.displaySize[0]-X[2]/J,_.displaySize[1]-X[3]/J]}const E=o.left*g,O=o.right*g;let C,M,D,I;u==="width"||u==="both"?(I=y[0]+E-f[3],M=y[0]+O+f[1]):(I=y[0]+(E+O-_.displaySize[0])/2,M=I+_.displaySize[0]);const R=o.top*g,H=o.bottom*g;return u==="height"||u==="both"?(C=y[1]+R-f[0],D=y[1]+H+f[2]):(C=y[1]+(R+H-_.displaySize[1])/2,D=C+_.displaySize[1]),{imagePrimary:_,imageSecondary:void 0,top:C,right:M,bottom:D,left:I,collisionPadding:T}}class Xh extends dt{constructor(o,u,f,y,g){super(o,u),this.angle=y,this.z=f,g!==void 0&&(this.segment=g)}clone(){return new Xh(this.x,this.y,this.z,this.angle,this.segment)}}function uV(m,o,u,f,y){if(o.segment===void 0)return!0;let g=o,_=o.segment+1,T=0;for(;T>-u/2;){if(_--,_<0)return!1;T-=m[_].dist(g),g=m[_]}T+=m[_].dist(m[_+1]),_++;const E=[];let O=0;for(;T<u/2;){const C=m[_],M=m[_+1];if(!M)return!1;let D=m[_-1].angleTo(C)-C.angleTo(M);for(D=Math.abs((D+3*Math.PI)%(2*Math.PI)-Math.PI),E.push({distance:T,angleDelta:D}),O+=D;T-E[0].distance>f;)O-=E.shift().angleDelta;if(O>y)return!1;_++,T+=C.dist(M)}return!0}function dV(m){let o=0;for(let u=0;u<m.length-1;u++)o+=m[u].dist(m[u+1]);return o}function hV(m,o,u){return m?.6*o*u:0}function mV(m,o){return Math.max(m?m.right-m.left:0,o?o.right-o.left:0)}function hfe(m,o,u,f,y,g){const _=hV(u,y,g),T=mV(u,f)*g;let E=0;const O=dV(m)/2;for(let C=0;C<m.length-1;C++){const M=m[C],D=m[C+1],I=M.dist(D);if(E+I>O){const R=(O-E)/I,H=Mr(M.x,D.x,R),X=Mr(M.y,D.y,R),J=new Xh(H,X,0,D.angleTo(M),C);return!_||uV(m,J,T,_,o)?J:void 0}E+=I}}function mfe(m,o,u,f,y,g,_,T,E){const O=hV(f,g,_),C=mV(f,y),M=C*_,D=m[0].x===0||m[0].x===E||m[0].y===0||m[0].y===E;return o-M<o/4&&(o=M+o/4),fV(m,D?o/2*T%o:(C/2+2*g)*_*T%o,o,O,u,M,D,!1,E)}function fV(m,o,u,f,y,g,_,T,E){const O=g/2,C=dV(m);let M=0,D=o-u,I=[];for(let R=0;R<m.length-1;R++){const H=m[R],X=m[R+1],J=H.dist(X),ne=X.angleTo(H);for(;D+u<M+J;){D+=u;const re=(D-M)/J,te=Mr(H.x,X.x,re),oe=Mr(H.y,X.y,re);if(te>=0&&te<E&&oe>=0&&oe<E&&D-O>=0&&D+O<=C){const ue=new Xh(te,oe,0,ne,R);f&&!uV(m,ue,g,f,y)||I.push(ue)}}M+=J}return T||I.length||_||(I=fV(m,M/2,u,f,y,g,_,!0,E)),I}function pV(m,o,u,f,y){const g=[];for(let _=0;_<m.length;_++){const T=m[_];let E;for(let O=0;O<T.length-1;O++){let C=T[O],M=T[O+1];C.x<o&&M.x<o||(C.x<o?C=new dt(o,C.y+(o-C.x)/(M.x-C.x)*(M.y-C.y))._round():M.x<o&&(M=new dt(o,C.y+(o-C.x)/(M.x-C.x)*(M.y-C.y))._round()),C.y<u&&M.y<u||(C.y<u?C=new dt(C.x+(u-C.y)/(M.y-C.y)*(M.x-C.x),u)._round():M.y<u&&(M=new dt(C.x+(u-C.y)/(M.y-C.y)*(M.x-C.x),u)._round()),C.x>=f&&M.x>=f||(C.x>=f?C=new dt(f,C.y+(f-C.x)/(M.x-C.x)*(M.y-C.y))._round():M.x>=f&&(M=new dt(f,C.y+(f-C.x)/(M.x-C.x)*(M.y-C.y))._round()),C.y>=y&&M.y>=y||(C.y>=y?C=new dt(C.x+(y-C.y)/(M.y-C.y)*(M.x-C.x),y)._round():M.y>=y&&(M=new dt(C.x+(y-C.y)/(M.y-C.y)*(M.x-C.x),y)._round()),E&&C.equals(E[E.length-1])||(E=[C],g.push(E)),E.push(M)))))}}return g}function gV(m){let o=0,u=0;for(const _ of m)o+=_.w*_.h,u=Math.max(u,_.w);m.sort((_,T)=>T.h-_.h);const f=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(o/.95)),u),h:1/0}];let y=0,g=0;for(const _ of m)for(let T=f.length-1;T>=0;T--){const E=f[T];if(!(_.w>E.w||_.h>E.h)){if(_.x=E.x,_.y=E.y,g=Math.max(g,_.y+_.h),y=Math.max(y,_.x+_.w),_.w===E.w&&_.h===E.h){const O=f.pop();T<f.length&&(f[T]=O)}else _.h===E.h?(E.x+=_.w,E.w-=_.w):_.w===E.w?(E.y+=_.h,E.h-=_.h):(f.push({x:E.x+_.w,y:E.y,w:E.w-_.w,h:_.h}),E.y+=_.h,E.h-=_.h);break}}return{w:y,h:g,fill:o/(y*g)||0}}lr(Xh,"Anchor");const ky=1;class yw{static getImagePositionScale(o,u,f){if(u&&o&&o.options&&o.options.transform){const y=o.options.transform;return{x:y.a,y:y.d}}return{x:f,y:f}}constructor(o,u,f,y){this.paddedRect=o;const{pixelRatio:g,version:_,stretchX:T,stretchY:E,content:O,sdf:C,usvg:M}=u;this.pixelRatio=g,this.stretchX=T,this.stretchY=E,this.content=O,this.version=_,this.padding=f,this.sdf=C,this.scale=yw.getImagePositionScale(y,M,g)}get tl(){return[this.paddedRect.x+this.padding,this.paddedRect.y+this.padding]}get br(){return[this.paddedRect.x+this.paddedRect.w-this.padding,this.paddedRect.y+this.paddedRect.h-this.padding]}get displaySize(){return[(this.paddedRect.w-2*this.padding)/this.scale.x,(this.paddedRect.h-2*this.padding)/this.scale.y]}}function xV(m,o,u){const f=Yc.parse(m),y=function(g,_,T=[1,1]){return{x:0,y:0,w:(g.data?g.data.width:g.width*T[0])+2*_,h:(g.data?g.data.height:g.height*T[1])+2*_}}(o,u,[f.options.transform.a,f.options.transform.d]);return{bin:y,imagePosition:new yw(y,o,u,f),imageVariant:f}}class yV{constructor(o,u,f){const y=new Map,g=new Map;this.haveRenderCallbacks=[];const _=[];this.addImages(o,y,ky,_),this.addImages(u,g,2,_);const{w:T,h:E}=gV(_),O=new Ea({width:T||1,height:E||1});for(const[C,M]of o.entries()){const D=y.get(C).paddedRect;Ea.copy(M.data,O,{x:0,y:0},{x:D.x+ky,y:D.y+ky},M.data,f,M.sdf)}for(const[C,M]of u.entries()){const D=g.get(C),I=D.paddedRect;let R=D.padding;const H=I.x+R,X=I.y+R,J=M.data.width,ne=M.data.height;R=R>1?R-1:R,Ea.copy(M.data,O,{x:0,y:0},{x:H,y:X},M.data,f),Ea.copy(M.data,O,{x:0,y:ne-R},{x:H,y:X-R},{width:J,height:R},f),Ea.copy(M.data,O,{x:0,y:0},{x:H,y:X+ne},{width:J,height:R},f),Ea.copy(M.data,O,{x:J-R,y:0},{x:H-R,y:X},{width:R,height:ne},f),Ea.copy(M.data,O,{x:0,y:0},{x:H+J,y:X},{width:R,height:ne},f),Ea.copy(M.data,O,{x:J-R,y:ne-R},{x:H-R,y:X-R},{width:R,height:R},f),Ea.copy(M.data,O,{x:0,y:ne-R},{x:H+J,y:X-R},{width:R,height:R},f),Ea.copy(M.data,O,{x:0,y:0},{x:H+J,y:X+ne},{width:R,height:R},f),Ea.copy(M.data,O,{x:J-R,y:0},{x:H-R,y:X+ne},{width:R,height:R},f)}this.lut=f,this.image=O,this.iconPositions=y,this.patternPositions=g}addImages(o,u,f,y){for(const[g,_]of o.entries()){const{bin:T,imagePosition:E,imageVariant:O}=xV(g,_,f);u.set(g,E),y.push(T),_.hasRenderCallback&&this.haveRenderCallbacks.push(O.id)}}patchUpdatedImages(o,u,f){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(y=>o.hasImage(y,f)),o.dispatchRenderCallbacks(this.haveRenderCallbacks,f);for(const y of o.getUpdatedImages(f)){for(const g of this.iconPositions.keys()){const _=Yc.parse(g);if(vo.isEqual(_.id,y)){const T=o.getImage(y,f);this.patchUpdatedImage(this.iconPositions.get(g),T,u)}}for(const g of this.patternPositions.keys()){const _=Yc.parse(g);if(vo.isEqual(_.id,y)){const T=o.getImage(y,f);this.patchUpdatedImage(this.patternPositions.get(g),T,u)}}}}patchUpdatedImage(o,u,f){if(!o||!u||o.version===u.version)return;o.version=u.version;const[y,g]=o.tl,_=o.sdf;if(this.lut||_){const T={width:u.data.width,height:u.data.height},E=new Ea(T);Ea.copy(u.data,E,{x:0,y:0},{x:0,y:0},T,this.lut,_),f.update(E,{position:{x:y,y:g}})}else f.update(u.data,{position:{x:y,y:g}})}}lr(yw,"ImagePosition"),lr(yV,"ImageAtlas");const vw=1e20;function vV(m,o,u,f,y,g,_,T,E){for(let O=o;O<o+f;O++)bV(m,u*g+O,g,y,_,T,E);for(let O=u;O<u+y;O++)bV(m,O*g+o,1,f,_,T,E)}function bV(m,o,u,f,y,g,_){g[0]=0,_[0]=-vw,_[1]=vw,y[0]=m[o];for(let T=1,E=0,O=0;T<f;T++){y[T]=m[o+T*u];const C=T*T;do{const M=g[E];O=(y[T]-y[M]+C-M*M)/(T-M)/2}while(O<=_[E]&&--E>-1);E++,g[E]=T,_[E]=O,_[E+1]=vw}for(let T=0,E=0;T<f;T++){for(;_[E+1]<T;)E++;const O=g[E],C=T-O;m[o+T*u]=y[O]+C*C}}const Wu=2,H4={none:0,ideographs:1,all:2};class Py{constructor(o,u,f){this.requestManager=o,this.localGlyphMode=u,this.localFontFamily=f,this.urls={},this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(o,u){this.urls[u]=o}getGlyphs(o,u,f){const y=[],g=this.urls[u]||pe.GLYPHS_URL;for(const _ in o)for(const T of o[_])y.push({stack:_,id:T});ri(y,({stack:_,id:T},E)=>{let O=this.entries[_];O||(O=this.entries[_]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let C=O.glyphs[T];if(C!==void 0)return void E(null,{stack:_,id:T,glyph:C});if(C=this._tinySDF(O,_,T),C)return O.glyphs[T]=C,void E(null,{stack:_,id:T,glyph:C});const M=Math.floor(T/256);if(256*M>65535)return _i("glyphs > 65535 not supported"),void E(null,{stack:_,id:T,glyph:C});if(O.ranges[M])return void E(null,{stack:_,id:T,glyph:C});let D=O.requests[M];D||(D=O.requests[M]=[],Py.loadGlyphRange(_,M,g,this.requestManager,(I,R)=>{if(R){O.ascender=R.ascender,O.descender=R.descender;for(const H in R.glyphs)this._doesCharSupportLocalGlyph(+H)||(O.glyphs[+H]=R.glyphs[+H]);O.ranges[M]=!0}for(const H of D)H(I,R);delete O.requests[M]})),D.push((I,R)=>{I?E(I):R&&E(null,{stack:_,id:T,glyph:R.glyphs[T]||null})})},(_,T)=>{if(_)f(_);else if(T){const E={};for(const{stack:O,id:C,glyph:M}of T)E[O]===void 0&&(E[O]={}),E[O].glyphs===void 0&&(E[O].glyphs={}),E[O].glyphs[C]=M&&{id:M.id,bitmap:M.bitmap.clone(),metrics:M.metrics},E[O].ascender=this.entries[O].ascender,E[O].descender=this.entries[O].descender;f(null,E)}})}_doesCharSupportLocalGlyph(o){return this.localGlyphMode!==H4.none&&(this.localGlyphMode===H4.all?!!this.localFontFamily:!!this.localFontFamily&&(Tr["CJK Unified Ideographs"](o)||Tr["Hangul Syllables"](o)||Tr.Hiragana(o)||Tr.Katakana(o)||Tr["CJK Symbols and Punctuation"](o)||Tr["CJK Unified Ideographs Extension A"](o)||Tr["CJK Unified Ideographs Extension B"](o)||Tr.Osage(o)))}_tinySDF(o,u,f){const y=this.localFontFamily;if(!y||!this._doesCharSupportLocalGlyph(f))return;let g=o.tinySDF;if(!g){let H="400";/bold/i.test(u)?H="900":/medium/i.test(u)?H="500":/light/i.test(u)&&(H="200"),g=o.tinySDF=new Py.TinySDF({fontFamily:y,fontWeight:H,fontSize:24*Wu,buffer:3*Wu,radius:8*Wu}),g.fontWeight=H}if(this.localGlyphs[g.fontWeight][f])return this.localGlyphs[g.fontWeight][f];const _=String.fromCodePoint(f),{data:T,width:E,height:O,glyphWidth:C,glyphHeight:M,glyphLeft:D,glyphTop:I,glyphAdvance:R}=g.draw(_);return this.localGlyphs[g.fontWeight][f]={id:f,bitmap:new Pf({width:E,height:O},T),metrics:{width:C/Wu,height:M/Wu,left:D/Wu,top:I/Wu-27,advance:R/Wu,localGlyph:!0}}}}Py.loadGlyphRange=function(m,o,u,f,y){const g=256*o,_=g+255,T=f.transformRequest(f.normalizeGlyphsURL(u).replace("{fontstack}",m).replace("{range}",`${g}-${_}`),Ps.Glyphs);Rl(T,(E,O)=>{if(E)y(E);else if(O){const C={},M=function(D){return new IC(D).readFields(afe,{})}(O);for(const D of M.glyphs)C[D.id]=D;y(null,{glyphs:C,ascender:M.ascender,descender:M.descender})}})},Py.TinySDF=class{constructor({fontSize:m=24,buffer:o=3,radius:u=8,cutoff:f=.25,fontFamily:y="sans-serif",fontWeight:g="normal",fontStyle:_="normal"}={}){this.buffer=o,this.cutoff=f,this.radius=u;const T=this.size=m+4*o,E=this._createCanvas(T),O=this.ctx=E.getContext("2d",{willReadFrequently:!0});O.font=`${_} ${g} ${m}px ${y}`,O.textBaseline="alphabetic",O.textAlign="left",O.fillStyle="black",this.gridOuter=new Float64Array(T*T),this.gridInner=new Float64Array(T*T),this.f=new Float64Array(T),this.z=new Float64Array(T+1),this.v=new Uint16Array(T)}_createCanvas(m){const o=document.createElement("canvas");return o.width=o.height=m,o}draw(m){const{width:o,actualBoundingBoxAscent:u,actualBoundingBoxDescent:f,actualBoundingBoxLeft:y,actualBoundingBoxRight:g}=this.ctx.measureText(m),_=Math.ceil(u),T=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(g-y))),E=Math.min(this.size-this.buffer,_+Math.ceil(f)),O=T+2*this.buffer,C=E+2*this.buffer,M=Math.max(O*C,0),D=new Uint8ClampedArray(M),I={data:D,width:O,height:C,glyphWidth:T,glyphHeight:E,glyphTop:_,glyphLeft:0,glyphAdvance:o};if(T===0||E===0)return I;const{ctx:R,buffer:H,gridInner:X,gridOuter:J}=this;R.clearRect(H,H,T,E),R.fillText(m,H,H+_);const ne=R.getImageData(H,H,T,E);J.fill(vw,0,M),X.fill(0,0,M);for(let re=0;re<E;re++)for(let te=0;te<T;te++){const oe=ne.data[4*(re*T+te)+3]/255;if(oe===0)continue;const ue=(re+H)*O+te+H;if(oe===1)J[ue]=0,X[ue]=vw;else{const me=.5-oe;J[ue]=me>0?me*me:0,X[ue]=me<0?me*me:0}}vV(J,0,0,O,C,O,this.f,this.v,this.z),vV(X,H,H,T,E,O,this.f,this.v,this.z);for(let re=0;re<M;re++){const te=Math.sqrt(J[re])-Math.sqrt(X[re]);D[re]=Math.round(255-255*(te/this.radius+this.cutoff))}return I}};const If=ky;function _V(m,o){return m+o[1]-o[0]}function wV(m,o,u,f,y=1){const g=[],_=m.imagePrimary,T=_.pixelRatio,E=_.paddedRect.w-2*If,O=_.paddedRect.h-2*If,C=(m.right-m.left)*y,M=(m.bottom-m.top)*y,D=_.stretchX||[[0,E]],I=_.stretchY||[[0,O]],R=D.reduce(_V,0),H=I.reduce(_V,0),X=E-R,J=O-H;let ne=0,re=R,te=0,oe=H,ue=0,me=X,Me=0,Se=J;if(_.content&&f){const Ve=_.content;ne=RC(D,0,Ve[0]),te=RC(I,0,Ve[1]),re=RC(D,Ve[0],Ve[2]),oe=RC(I,Ve[1],Ve[3]),ue=Ve[0]-ne,Me=Ve[1]-te,me=Ve[2]-Ve[0]-re,Se=Ve[3]-Ve[1]-oe}const Ae=(Ve,Ie,Ge,Ze)=>{const We=DC(Ve.stretch-ne,re,C,m.left*y),Qe=zC(Ve.fixed-ue,me,Ve.stretch,R),Je=DC(Ie.stretch-te,oe,M,m.top*y),ot=zC(Ie.fixed-Me,Se,Ie.stretch,H),nt=DC(Ge.stretch-ne,re,C,m.left*y),ct=zC(Ge.fixed-ue,me,Ge.stretch,R),Ot=DC(Ze.stretch-te,oe,M,m.top*y),Mt=zC(Ze.fixed-Me,Se,Ze.stretch,H),cr=new dt(We,Je),Lt=new dt(nt,Je),Gt=new dt(nt,Ot),Rt=new dt(We,Ot),Pr=new dt(Qe/T,ot/T),ir=new dt(ct/T,Mt/T),pr=o*Math.PI/180;if(pr){const pn=Math.sin(pr),Rn=Math.cos(pr),mi=[Rn,-pn,pn,Rn];cr._matMult(mi),Lt._matMult(mi),Rt._matMult(mi),Gt._matMult(mi)}const Lr=Ve.stretch+Ve.fixed,on=Ge.stretch+Ge.fixed,$r=Ie.stretch+Ie.fixed,fn=Ze.stretch+Ze.fixed,sn=m.imageSecondary;return{tl:cr,tr:Lt,bl:Rt,br:Gt,texPrimary:{x:_.paddedRect.x+If+Lr,y:_.paddedRect.y+If+$r,w:on-Lr,h:fn-$r},texSecondary:sn?{x:sn.paddedRect.x+If+Lr,y:sn.paddedRect.y+If+$r,w:on-Lr,h:fn-$r}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Pr,pixelOffsetBR:ir,minFontScaleX:me/T/C,minFontScaleY:Se/T/M,isSDF:u}};if(f&&(_.stretchX||_.stretchY)){const Ve=jV(D,X,R),Ie=jV(I,J,H);for(let Ge=0;Ge<Ve.length-1;Ge++){const Ze=Ve[Ge],We=Ve[Ge+1];for(let Qe=0;Qe<Ie.length-1;Qe++)g.push(Ae(Ze,Ie[Qe],We,Ie[Qe+1]))}}else g.push(Ae({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:E+1},{fixed:0,stretch:O+1}));return g}function RC(m,o,u){let f=0;for(const y of m)f+=Math.max(o,Math.min(u,y[1]))-Math.max(o,Math.min(u,y[0]));return f}function jV(m,o,u){const f=[{fixed:-If,stretch:0}];for(const[y,g]of m){const _=f[f.length-1];f.push({fixed:y-_.stretch,stretch:_.stretch}),f.push({fixed:y-_.stretch,stretch:_.stretch+(g-y)})}return f.push({fixed:o+If,stretch:u}),f}function DC(m,o,u,f){return m/o*u+f}function zC(m,o,u,f){return m-o*u/f}function ffe(m,o,u,f){const y=o+m.positionedLines[f].lineOffset;return f===0?u+y/2:u+(y+(o+m.positionedLines[f-1].lineOffset))/2}function pfe(m,o=1,u=!1){let f=1/0,y=1/0,g=-1/0,_=-1/0;const T=m[0];for(let I=0;I<T.length;I++){const R=T[I];(!I||R.x<f)&&(f=R.x),(!I||R.y<y)&&(y=R.y),(!I||R.x>g)&&(g=R.x),(!I||R.y>_)&&(_=R.y)}const E=Math.min(g-f,_-y);let O=E/2;const C=new Cg([],gfe);if(E===0)return new dt(f,y);for(let I=f;I<g;I+=E)for(let R=y;R<_;R+=E)C.push(new Ey(I+O,R+O,O,m));let M=function(I){let R=0,H=0,X=0;const J=I[0];for(let ne=0,re=J.length,te=re-1;ne<re;te=ne++){const oe=J[ne],ue=J[te],me=oe.x*ue.y-ue.x*oe.y;H+=(oe.x+ue.x)*me,X+=(oe.y+ue.y)*me,R+=3*me}return new Ey(H/R,X/R,0,I)}(m),D=C.length;for(;C.length;){const I=C.pop();(I.d>M.d||!M.d)&&(M=I,u&&console.log("found best %d after %d probes",Math.round(1e4*I.d)/1e4,D)),I.max-M.d<=o||(O=I.h/2,C.push(new Ey(I.p.x-O,I.p.y-O,O,m)),C.push(new Ey(I.p.x+O,I.p.y-O,O,m)),C.push(new Ey(I.p.x-O,I.p.y+O,O,m)),C.push(new Ey(I.p.x+O,I.p.y+O,O,m)),D+=4)}return u&&(console.log(`num probes: ${D}`),console.log(`best distance: ${M.d}`)),M.p}function gfe(m,o){return o.max-m.max}class Ey{constructor(o,u,f,y){this.p=new dt(o,u),this.h=f,this.d=function(g,_){let T=!1,E=1/0;for(let O=0;O<_.length;O++){const C=_[O];for(let M=0,D=C.length,I=D-1;M<D;I=M++){const R=C[M],H=C[I];R.y>g.y!=H.y>g.y&&g.x<(H.x-R.x)*(g.y-R.y)/(H.y-R.y)+R.x&&(T=!T),E=Math.min(E,$e(g,R,H))}}return(T?1:-1)*Math.sqrt(E)}(this.p,y),this.max=this.d+this.h*Math.SQRT2}}const q4=Number.POSITIVE_INFINITY,xfe=Math.sqrt(2);function NV(m,[o,u]){let f=0,y=0;if(u===q4){o<0&&(o=0);const g=o/xfe;switch(m){case"top-right":case"top-left":y=g-7;break;case"bottom-right":case"bottom-left":y=7-g;break;case"bottom":y=7-o;break;case"top":y=o-7}switch(m){case"top-right":case"bottom-right":f=-g;break;case"top-left":case"bottom-left":f=g;break;case"left":f=o;break;case"right":f=-o}}else{switch(o=Math.abs(o),u=Math.abs(u),m){case"top-right":case"top-left":case"top":y=u-7;break;case"bottom-right":case"bottom-left":case"bottom":y=7-u}switch(m){case"top-right":case"bottom-right":case"right":f=-o;break;case"top-left":case"bottom-left":case"left":f=o}}return[f,y]}function SV(m,o,u,f,y,g,_,T){if(!m)return;const E=Q8(o,u,f,y,g);return m.scaleSelf(E*T*_)}function CV(m,o,u,f,y,g,_,T){return{iconPrimary:SV(m.getPrimary(),o,u,f,y,g,_,T),iconSecondary:SV(m.getSecondary(),o,u,f,y,g,_,T)}}function AV(m,o,u,f){if(!m)return;const y=o.get(u.toString());if(m.imagePrimary=y,f){const g=o.get(f.toString());m.imageSecondary=g}}function yfe(m,o){for(const u in m.horizontal)TV(m.horizontal[u],o);TV(m.vertical,o)}function TV(m,o){if(m){for(const u of m.positionedLines)for(const f of u.positionedGlyphs)if(f.image!==null){const y=f.image.toString();f.rect=o.get(y).paddedRect}}}function W4(m){switch(m){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function vfe(m,o,u,f,y,g,_,T,E){const O=K4(g.horizontal)||g.vertical,C=u.get("icon-text-fit-padding").evaluate(f,{},y);let M,D=o;return o&&E!=="none"&&(m.allowVerticalPlacement&&g.vertical&&(M=cV(o,g.vertical,E,C,T,_)),O&&(D=cV(o,O,E,C,T,_))),{defaultShapedIcon:D,verticallyShapedIcon:M}}function bfe(m,o,u,f,y,g,_,T,E,O,C,M,D,I,R,H,X,J,ne,re){let te=_.textMaxSize.evaluate(o,{},D);te===void 0?te=T*_.textScaleFactor:te*=_.textScaleFactor;const oe=m.layers[0].layout,ue=K4(u.horizontal)||u.vertical,me=I.name==="globe",Me=Ma,Se=m.tilePixelRatio*te/Me,Ae=(Qe=m.overscaling,m.zoom>18&&Qe>2&&(Qe>>=1),Math.max(Wt/(512*Qe),1)*oe.get("symbol-spacing")),Ve=oe.get("text-padding")*m.tilePixelRatio,Ie=oe.get("icon-padding")*m.tilePixelRatio,Ge=Ye(oe.get("text-max-angle")),Ze=oe.get("icon-rotation-alignment")==="map"&&re!=="point",We=Ae/2;var Qe;m.hasAnyIconTextFit===!1&&X!=="none"&&(m.hasAnyIconTextFit=!0);const Je=o.properties?+o.properties[e0]:null,ot=Je&&m.elevationFeatureIdToIndex?m.elevationFeatureIdToIndex.get(Je):65535,nt=(ct,Ot,Mt)=>{if(Ot.x<0||Ot.x>=Wt||Ot.y<0||Ot.y>=Wt)return;let cr=null;if(me){const{x:Lt,y:Gt,z:Rt}=I.projectTilePoint(Ot.x,Ot.y,Mt);cr={anchor:new Xh(Lt,Gt,Rt,0,void 0),up:I.upVector(Mt,Ot.x,Ot.y)}}(function(Lt,Gt,Rt,Pr,ir,pr,Lr,on,$r,fn,sn,pn,Rn,mi,Fr,Sn,Ni,zi,Zi,ts,li,ta,wo,Ns,Is,Ka,wa,pc,Lf){const iu=Lt.addToLineVertexArray(Gt,Pr);let Xu,Ff,Bf,o0,uU,dU,hU,mU=0,fU=0,pU=0,gU=0,AI=-1,TI=-1;const Kd={};let xU=sl("");const l0=Rt?Rt.anchor:Gt,kI=pc!=="none";let PI=0,EI=0;if($r._unevaluatedLayout.getValue("text-radial-offset")===void 0?[PI,EI]=$r.layout.get("text-offset").evaluate(li,{},Is).map(gc=>gc*Ma):(PI=$r.layout.get("text-radial-offset").evaluate(li,{},Is)*Ma,EI=q4),Lt.allowVerticalPlacement&&ir.vertical){const gc=ir.vertical;if(Fr)dU=Z4(gc),on&&(hU=Z4(on));else{const ml=$r.layout.get("text-rotate").evaluate(li,{},Is)+90;Bf=LC(fn,l0,Gt,sn,pn,Rn,gc,mi,ml,Sn),on&&(o0=LC(fn,l0,Gt,sn,pn,Rn,on,zi,ml))}}if(pr){const gc=Lt.iconSizeData,ml=$r.layout.get("icon-rotate").evaluate(li,{},Is),Lw=wV(pr,ml,wo,kI,ta.iconScaleFactor),II=on?wV(on,ml,wo,kI,ta.iconScaleFactor):void 0;Ff=LC(fn,l0,Gt,sn,pn,Rn,pr,zi,ml,null),mU=4*Lw.length;let c0=null;gc.kind==="source"?(c0=[qu*$r.layout.get("icon-size").evaluate(li,{},Is)*ta.iconScaleFactor],c0[0]>Of&&_i(`${Lt.layerIds[0]}: Value for "icon-size" is >= ${bw}. Reduce your "icon-size".`)):gc.kind==="composite"&&(c0=[qu*ta.compositeIconSizes[0].evaluate(li,{},Is)*ta.iconScaleFactor,qu*ta.compositeIconSizes[1].evaluate(li,{},Is)*ta.iconScaleFactor],(c0[0]>Of||c0[1]>Of)&&_i(`${Lt.layerIds[0]}: Value for "icon-size" is >= ${bw}. Reduce your "icon-size".`)),Lt.addSymbols(Lt.icon,Lw,c0,ts,Zi,li,!1,Rt,Gt,iu.lineStartIndex,iu.lineLength,-1,Ns,Is,Ka,wa),AI=Lt.icon.placedSymbolArray.length-1,II&&(fU=4*II.length,Lt.addSymbols(Lt.icon,II,c0,ts,Zi,li,hl.vertical,Rt,Gt,iu.lineStartIndex,iu.lineLength,-1,Ns,Is,Ka,wa),TI=Lt.icon.placedSymbolArray.length-1)}for(const gc in ir.horizontal){const ml=ir.horizontal[gc];Xu||(xU=sl(ml.text),Fr?uU=Z4(ml):Xu=LC(fn,l0,Gt,sn,pn,Rn,ml,mi,$r.layout.get("text-rotate").evaluate(li,{},Is),Sn));const Lw=ml.positionedLines.length===1;if(pU+=kV(Lt,Rt,Gt,ml,Lr,$r,Fr,li,Sn,iu,ir.vertical?hl.horizontal:hl.horizontalOnly,Lw?Object.keys(ir.horizontal):[gc],Kd,AI,ta,Ns,Is,Ka),Lw)break}ir.vertical&&(gU+=kV(Lt,Rt,Gt,ir.vertical,Lr,$r,Fr,li,Sn,iu,hl.vertical,["vertical"],Kd,TI,ta,Ns,Is,Ka));let $f=-1;const MI=(gc,ml)=>gc?Math.max(gc,ml):ml;$f=MI(uU,$f),$f=MI(dU,$f),$f=MI(hU,$f);const Jpe=$f>-1?1:0;Lt.glyphOffsetArray.length>=65535&&_i("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),li.sortKey!==void 0&&Lt.addToSortKeyRanges(Lt.symbolInstances.length,li.sortKey),Lt.symbolInstances.emplaceBack(Gt.x,Gt.y,l0.x,l0.y,l0.z,Kd.right>=0?Kd.right:-1,Kd.center>=0?Kd.center:-1,Kd.left>=0?Kd.left:-1,Kd.vertical>=0?Kd.vertical:-1,AI,TI,xU,Xu!==void 0?Xu:Lt.collisionBoxArray.length,Xu!==void 0?Xu+1:Lt.collisionBoxArray.length,Bf!==void 0?Bf:Lt.collisionBoxArray.length,Bf!==void 0?Bf+1:Lt.collisionBoxArray.length,Ff!==void 0?Ff:Lt.collisionBoxArray.length,Ff!==void 0?Ff+1:Lt.collisionBoxArray.length,o0||Lt.collisionBoxArray.length,o0?o0+1:Lt.collisionBoxArray.length,sn,pU,gU,mU,fU,Jpe,0,PI,EI,$f,0,kI?1:0,Lf)})(m,Ot,cr,ct,u,f,g,y,m.layers[0],m.collisionBoxArray,o.index,o.sourceLayerIndex,m.index,Ve,ne,O,0,Ie,Ze,J,o,_,C,M,D,R,H,X,ot)};if(re==="line")for(const ct of pV(o.geometry,0,0,Wt,Wt)){const Ot=mfe(ct,Ae,Ge,u.vertical||ue,f,Me,Se,m.overscaling,Wt);for(const Mt of Ot)ue&&_fe(m,ue.text,We,Mt)||nt(ct,Mt,D)}else if(re==="line-center"){for(const ct of o.geometry)if(ct.length>1){const Ot=hfe(ct,Ge,u.vertical||ue,f,Me,Se);Ot&&nt(ct,Ot,D)}}else if(o.type==="Polygon")for(const ct of SC(o.geometry,0)){const Ot=pfe(ct,16);nt(ct[0],new Xh(Ot.x,Ot.y,0,0,void 0),D)}else if(o.type==="LineString")for(const ct of o.geometry)nt(ct,new Xh(ct[0].x,ct[0].y,0,0,void 0),D);else if(o.type==="Point")for(const ct of o.geometry)for(const Ot of ct)nt([Ot],new Xh(Ot.x,Ot.y,0,0,void 0),D)}const bw=255,Of=bw*qu;function kV(m,o,u,f,y,g,_,T,E,O,C,M,D,I,R,H,X,J){const ne=function(oe,ue,me,Me,Se,Ae,Ve,Ie){const Ge=[];if(ue.positionedLines.length===0)return Ge;const Ze=Me.layout.get("text-rotate").evaluate(Ae,{})*Math.PI/180,We=function(ct){const Ot=ct[0],Mt=ct[1],cr=Ot*Mt;return cr>0?[Ot,-Mt]:cr<0?[-Ot,Mt]:Ot===0?[Mt,Ot]:[Mt,-Ot]}(me);let Qe=Math.abs(ue.top-ue.bottom);for(const ct of ue.positionedLines)Qe-=ct.lineOffset;const Je=ue.positionedLines.length,ot=Qe/Je;let nt=ue.top-me[1];for(let ct=0;ct<Je;++ct){const Ot=ue.positionedLines[ct];nt=ffe(ue,ot,nt,ct);for(const Mt of Ot.positionedGlyphs){if(!Mt.rect)continue;const cr=Mt.rect||{};let Lt=nV+1,Gt=!0,Rt=1,Pr=0;if(Mt.image){const li=Ve.get(Mt.image.toString());if(!li)continue;if(li.sdf){_i("SDF images are not supported in formatted text and will be ignored.");continue}Gt=!1,Rt=li.pixelRatio,Lt=ky/Rt}const ir=(Se||Ie)&&Mt.vertical,pr=Mt.metrics.advance*Mt.scale/2,Lr=Mt.metrics,on=Mt.rect;if(on===null)continue;Ie&&ue.verticalizable&&(Pr=Mt.image?pr-Mt.metrics.width*Mt.scale/2:0);const $r=Se?[Mt.x+pr,Mt.y]:[0,0];let fn=[0,0],sn=[0,0],pn=!1;Se||(ir?(sn=[Mt.x+pr+We[0],Mt.y+We[1]-Pr],pn=!0):fn=[Mt.x+pr+me[0],Mt.y+me[1]-Pr]);const Rn=on.w*Mt.scale/(Rt*(Mt.localGlyph?Wu:1)),mi=on.h*Mt.scale/(Rt*(Mt.localGlyph?Wu:1));let Fr,Sn,Ni,zi;if(ir){const li=Mt.y-nt,ta=new dt(-pr,pr-li),wo=-Math.PI/2,Ns=new dt(...sn);Fr=new dt(-pr+fn[0],fn[1]),Fr._rotateAround(wo,ta)._add(Ns),Fr.x+=-li+pr,Fr.y-=(Lr.left-Lt)*Mt.scale;const Is=Mt.image?Lr.advance*Mt.scale:Ma*Mt.scale,Ka=String.fromCodePoint(Mt.glyph);nfe(Ka)?Fr.x+=(1-Lt)*Mt.scale:ife(Ka)?Fr.x+=Is-Lr.height*Mt.scale+(-Lt-1)*Mt.scale:Fr.x+=Mt.image||Lr.width+2*Lt===on.w&&Lr.height+2*Lt===on.h?(Is-mi)/2:(Is-(Lr.height+2*Lt)*Mt.scale)/2,Sn=new dt(Fr.x,Fr.y-Rn),Ni=new dt(Fr.x+mi,Fr.y),zi=new dt(Fr.x+mi,Fr.y-Rn)}else{const li=(Lr.left-Lt)*Mt.scale-pr+fn[0],ta=(-Lr.top-Lt)*Mt.scale+fn[1],wo=li+Rn,Ns=ta+mi;Fr=new dt(li,ta),Sn=new dt(wo,ta),Ni=new dt(li,Ns),zi=new dt(wo,Ns)}if(Ze){let li;li=Se?new dt(0,0):pn?new dt(We[0],We[1]):new dt(me[0],me[1]),Fr._rotateAround(Ze,li),Sn._rotateAround(Ze,li),Ni._rotateAround(Ze,li),zi._rotateAround(Ze,li)}const Zi=new dt(0,0),ts=new dt(0,0);Ge.push({tl:Fr,tr:Sn,bl:Ni,br:zi,texPrimary:cr,texSecondary:void 0,writingMode:ue.writingMode,glyphOffset:$r,sectionIndex:Mt.sectionIndex,isSDF:Gt,pixelOffsetTL:Zi,pixelOffsetBR:ts,minFontScaleX:0,minFontScaleY:0})}}return Ge}(0,f,E,g,_,T,y,m.allowVerticalPlacement),re=m.textSizeData;let te=null;re.kind==="source"?(te=[qu*g.layout.get("text-size").evaluate(T,{},X)*R.textScaleFactor],te[0]>Of&&_i(`${m.layerIds[0]}: Value for "text-size" is >= ${bw}. Reduce your "text-size".`)):re.kind==="composite"&&(te=[qu*R.compositeTextSizes[0].evaluate(T,{},X)*R.textScaleFactor,qu*R.compositeTextSizes[1].evaluate(T,{},X)*R.textScaleFactor],(te[0]>Of||te[1]>Of)&&_i(`${m.layerIds[0]}: Value for "text-size" is >= ${bw}. Reduce your "text-size".`)),m.addSymbols(m.text,ne,te,E,_,T,C,o,u,O.lineStartIndex,O.lineLength,I,H,X,J,!1);for(const oe of M)D[oe]=m.text.placedSymbolArray.length-1;return 4*ne.length}function K4(m){for(const o in m)return m[o];return null}function LC(m,o,u,f,y,g,_,T,E,O){let C=_.top,M=_.bottom,D=_.left,I=_.right;const R=_.collisionPadding;if(R&&(D-=R[0],C-=R[1],I+=R[2],M+=R[3]),E){const H=new dt(D,C),X=new dt(I,C),J=new dt(D,M),ne=new dt(I,M),re=Ye(E);let te=new dt(0,0);O&&(te=new dt(O[0],O[1])),H._rotateAround(re,te),X._rotateAround(re,te),J._rotateAround(re,te),ne._rotateAround(re,te),D=Math.min(H.x,X.x,J.x,ne.x),I=Math.max(H.x,X.x,J.x,ne.x),C=Math.min(H.y,X.y,J.y,ne.y),M=Math.max(H.y,X.y,J.y,ne.y)}return m.emplaceBack(o.x,o.y,o.z,u.x,u.y,D,C,I,M,T,f,y,g),m.length-1}function Z4(m){m.collisionPadding&&(m.top-=m.collisionPadding[1],m.bottom+=m.collisionPadding[3]);const o=m.bottom-m.top;return o>0?Math.max(10,o):null}function _fe(m,o,u,f){const y=m.compareText;if(o in y){const g=y[o];for(let _=g.length-1;_>=0;_--)if(f.dist(g[_])<u)return!0}else y[o]=[];return y[o].push(f),!1}function PV(m,o){const u=m.fovAboveCenter,f=m.elevation?m.elevation.getMinElevationBelowMSL()*o:0,y=(m._camera.position[2]*m.worldSize-f)/Math.cos(m._pitch),g=Math.sin(u)*y/Math.sin(Math.max(Math.PI/2-m._pitch-u,.01));let _=Math.sin(m._pitch)*g+y;const T=y*(1/m._horizonShift);if(!m.elevation||m.elevation.exaggeration()===0){let E=Math.max(m.zoom-17,0);m.isOrthographic&&(E/=10),_*=1+E}return Math.min(1.01*_,T)}function _w(m,o){if(!o.isReprojectedInTileSpace)return{scale:1<<m.z,x:m.x,y:m.y,x2:m.x+1,y2:m.y+1,projection:o};const u=Math.pow(2,-m.z),f=m.x*u,y=(m.x+1)*u,g=m.y*u,_=(m.y+1)*u,T=Lo(f),E=Lo(y),O=ba(g),C=ba(_),M=o.project(T,O),D=o.project(E,O),I=o.project(E,C),R=o.project(T,C);let H=Math.min(M.x,D.x,I.x,R.x),X=Math.min(M.y,D.y,I.y,R.y),J=Math.max(M.x,D.x,I.x,R.x),ne=Math.max(M.y,D.y,I.y,R.y);const re=u/16;function te(ue,me,Me,Se,Ae,Ve){const Ie=(Me+Ae)/2,Ge=(Se+Ve)/2,Ze=o.project(Lo(Ie),ba(Ge)),We=Math.max(0,H-Ze.x,X-Ze.y,Ze.x-J,Ze.y-ne);H=Math.min(H,Ze.x),J=Math.max(J,Ze.x),X=Math.min(X,Ze.y),ne=Math.max(ne,Ze.y),We>re&&(te(ue,Ze,Me,Se,Ie,Ge),te(Ze,me,Ie,Ge,Ae,Ve))}te(M,D,f,g,y,g),te(D,I,y,g,y,_),te(I,R,y,_,f,_),te(R,M,f,_,f,g),H-=re,X-=re,J+=re,ne+=re;const oe=1/Math.max(J-H,ne-X);return{scale:oe,x:H*oe,y:X*oe,x2:J*oe,y2:ne*oe,projection:o}}function EV(m,{x:o,y:u},f=0){return new dt(((o-f)*m.scale-m.x)*Wt,(u*m.scale-m.y)*Wt)}const wfe=ge.mat4.identity(new Float32Array(16));class Rf{constructor(o){this.spec=o,this.name=o.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(o,u){return{x:0,y:0,z:0}}unproject(o,u){return new $n(0,0)}projectTilePoint(o,u,f){return{x:o,y:u,z:0}}locationPoint(o,u,f,y=!0){return o._coordinatePoint(o.locationCoordinate(u,f),y)}pixelsPerMeter(o,u){return Pa(1,o)*u}pixelSpaceConversion(o,u,f){return 1}farthestPixelDistance(o){return PV(o,o.pixelsPerMeter)}pointCoordinate(o,u,f,y){const g=o.horizonLineFromTop(!1),_=new dt(u,Math.max(g,f));return o.rayIntersectionCoordinate(o.pointRayIntersection(_,y))}pointCoordinate3D(o,u,f){const y=new dt(u,f);if(o.elevation)return o.elevation.pointCoordinate(y);{const g=this.pointCoordinate(o,y.x,y.y,0);return[g.x,g.y,g.z]}}isPointAboveHorizon(o,u){if(o.elevation&&o.elevation.visibleDemTiles.length)return!this.pointCoordinate3D(o,u.x,u.y);const f=o.horizonLineFromTop();return u.y<f}createInversionMatrix(o,u){return wfe}createTileMatrix(o,u,f){let y,g,_;const T=f.canonical,E=ge.mat4.identity(new Float64Array(16));if(this.isReprojectedInTileSpace){const O=_w(T,this);y=1,g=O.x+f.wrap*O.scale,_=O.y,ge.mat4.scale(E,E,[y/O.scale,y/O.scale,o.pixelsPerMeter/u])}else y=u/o.zoomScale(T.z),g=(T.x+Math.pow(2,T.z)*f.wrap)*y,_=T.y*y;return ge.mat4.translate(E,E,[g,_,0]),ge.mat4.scale(E,E,[y/Wt,y/Wt,1]),E}upVector(o,u,f){return[0,0,1]}upVectorScale(o,u,f){return{metersToTile:1}}}class jfe extends Rf{constructor(o){super(o),this.range=[4,7],this.center=o.center||[-96,37.5];const[u,f]=this.parallels=o.parallels||[29.5,45.5],y=Math.sin(Ye(u));this.n=(y+Math.sin(Ye(f)))/2,this.c=1+y*(2*this.n-y),this.r0=Math.sqrt(this.c)/this.n}project(o,u){const{n:f,c:y,r0:g}=this,_=Ye(o-this.center[0]),T=Ye(u),E=Math.sqrt(y-2*f*Math.sin(T))/f;return{x:E*Math.sin(_*f),y:E*Math.cos(_*f)-g,z:0}}unproject(o,u){const{n:f,c:y,r0:g}=this,_=g+u;let T=Math.atan2(o,Math.abs(_))*Math.sign(_);_*f<0&&(T-=Math.PI*Math.sign(o)*Math.sign(_));const E=Ye(this.center[0])*f;T=ai(T,-Math.PI-E,Math.PI-E);const O=rr(Nt(T/f)+this.center[0],-180,180),C=Math.asin(rr((y-(o*o+_*_)*f*f)/(2*f),-1,1)),M=rr(Nt(C),-ds,ds);return new $n(O,M)}}const ww=1.340264,jw=-.081106,Nw=893e-6,Sw=.003796,FC=Math.sqrt(3)/2;class Nfe extends Rf{project(o,u){u=u/180*Math.PI,o=o/180*Math.PI;const f=Math.asin(FC*Math.sin(u)),y=f*f,g=y*y*y;return{x:.5*(o*Math.cos(f)/(FC*(ww+3*jw*y+g*(7*Nw+9*Sw*y)))/Math.PI+.5),y:1-.5*(f*(ww+jw*y+g*(Nw+Sw*y))/Math.PI+1),z:0}}unproject(o,u){o=(2*o-.5)*Math.PI;let f=u=(2*(1-u)-1)*Math.PI,y=f*f,g=y*y*y;for(let C,M,D,I=0;I<12&&(M=f*(ww+jw*y+g*(Nw+Sw*y))-u,D=ww+3*jw*y+g*(7*Nw+9*Sw*y),C=M/D,f=rr(f-C,-Math.PI/3,Math.PI/3),y=f*f,g=y*y*y,!(Math.abs(C)<1e-12));++I);const _=FC*o*(ww+3*jw*y+g*(7*Nw+9*Sw*y))/Math.cos(f),T=Math.asin(Math.sin(f)/FC),E=rr(180*_/Math.PI,-180,180),O=rr(180*T/Math.PI,-ds,ds);return new $n(E,O)}}class Sfe extends Rf{constructor(o){super(o),this.wrap=!0,this.supportsWorldCopies=!0}project(o,u){return{x:.5+o/360,y:.5-u/360,z:0}}unproject(o,u){const f=360*(o-.5),y=rr(360*(.5-u),-ds,ds);return new $n(f,y)}}const My=Math.PI/2;function BC(m){return Math.tan((My+m)/2)}class Cfe extends Rf{constructor(o){super(o),this.center=o.center||[0,30];const[u,f]=this.parallels=o.parallels||[30,30];let y=Ye(u),g=Ye(f);this.southernCenter=y+g<0,this.southernCenter&&(y=-y,g=-g);const _=Math.cos(y),T=BC(y);this.n=y===g?Math.sin(y):Math.log(_/Math.cos(g))/Math.log(BC(g)/T),this.f=_*Math.pow(BC(y),this.n)/this.n}project(o,u){u=Ye(u),this.southernCenter&&(u=-u),o=Ye(o-this.center[0]);const f=1e-6,{n:y,f:g}=this;g>0?u<-My+f&&(u=-My+f):u>My-f&&(u=My-f);const _=g/Math.pow(BC(u),y);let T=_*Math.sin(y*o),E=g-_*Math.cos(y*o);return T=.5*(T/Math.PI+.5),E=.5*(E/Math.PI+.5),{x:T,y:this.southernCenter?E:1-E,z:0}}unproject(o,u){o=(2*o-.5)*Math.PI,this.southernCenter&&(u=1-u),u=(2*(1-u)-.5)*Math.PI;const{n:f,f:y}=this,g=y-u,_=Math.sign(g),T=Math.sign(f)*Math.sqrt(o*o+g*g);let E=Math.atan2(o,Math.abs(g))*_;g*f<0&&(E-=Math.PI*Math.sign(o)*_);const O=rr(Nt(E/f)+this.center[0],-180,180),C=rr(Nt(2*Math.atan(Math.pow(y/T,1/f))-My),-ds,ds);return new $n(O,this.southernCenter?-C:C)}}class MV extends Rf{constructor(o){super(o),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(o,u){return{x:eu(o),y:ka(u),z:0}}unproject(o,u){const f=Lo(o),y=ba(u);return new $n(f,y)}}const IV=Ye(ds);class Afe extends Rf{project(o,u){const f=(u=Ye(u))*u,y=f*f;return{x:.5*((o=Ye(o))*(.8707-.131979*f+y*(y*(.003971*f-.001529*y)-.013791))/Math.PI+.5),y:1-.5*(u*(1.007226+f*(.015085+y*(.028874*f-.044475-.005916*y)))/Math.PI+1),z:0}}unproject(o,u){o=(2*o-.5)*Math.PI;let f=u=(2*(1-u)-1)*Math.PI,y=25,g=0,_=f*f;do{_=f*f;const O=_*_;g=(f*(1.007226+_*(.015085+O*(.028874*_-.044475-.005916*O)))-u)/(1.007226+_*(.045255+O*(.259866*_-.311325-.005916*11*O))),f=rr(f-g,-IV,IV)}while(Math.abs(g)>1e-6&&--y>0);_=f*f;const T=rr(Nt(o/(.8707+_*(_*(_*_*_*(.003971-.001529*_)-.013791)-.131979))),-180,180),E=Nt(f);return new $n(T,E)}}const OV=Ye(ds);class Tfe extends Rf{project(o,u){u=Ye(u),o=Ye(o);const f=Math.cos(u),y=2/Math.PI,g=Math.acos(f*Math.cos(o/2)),_=Math.sin(g)/g,T=.5*(o*y+2*f*Math.sin(o/2)/_)||0,E=.5*(u+Math.sin(u)/_)||0;return{x:.5*(T/Math.PI+.5),y:1-.5*(E/Math.PI+1),z:0}}unproject(o,u){let f=o=(2*o-.5)*Math.PI,y=u=(2*(1-u)-1)*Math.PI,g=25;const _=1e-6;let T=0,E=0;do{const O=Math.cos(y),C=Math.sin(y),M=2*C*O,D=C*C,I=O*O,R=Math.cos(f/2),H=Math.sin(f/2),X=2*R*H,J=H*H,ne=1-I*R*R,re=ne?1/ne:0,te=ne?Math.acos(O*R)*Math.sqrt(1/ne):0,oe=.5*(2*te*O*H+2*f/Math.PI)-o,ue=.5*(te*C+y)-u,me=.5*re*(I*J+te*O*R*D)+1/Math.PI,Me=re*(X*M/4-te*C*H),Se=.125*re*(M*H-te*C*I*X),Ae=.5*re*(D*R+te*J*O)+.5,Ve=Me*Se-Ae*me;T=(ue*Me-oe*Ae)/Ve,E=(oe*Se-ue*me)/Ve,f=rr(f-T,-Math.PI,Math.PI),y=rr(y-E,-OV,OV)}while((Math.abs(T)>_||Math.abs(E)>_)&&--g>0);return new $n(Nt(f),Nt(y))}}class RV extends Rf{constructor(o){super(o),this.center=o.center||[0,0],this.parallels=o.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(Ye(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(o,u){const{scale:f,cosPhi:y}=this;return{x:Ye(o)*y*f+.5,y:-Math.sin(Ye(u))/y*f+.5,z:0}}unproject(o,u){const{scale:f,cosPhi:y}=this,g=-(u-.5)/f,_=rr(Nt((o-.5)/f)/y,-180,180),T=Math.asin(rr(g*y,-1,1)),E=rr(Nt(T),-ds,ds);return new $n(_,E)}}class kfe extends MV{constructor(o){super(o),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(o,u,f){const y=Un(o,u,f),g=ji(Gs(f));return ge.vec3.transformMat4(y,y,g),{x:y[0],y:y[1],z:y[2]}}locationPoint(o,u,f){const y=Kh(u.lat,u.lng),g=ge.vec3.normalize([],y),_=f?o._centerAltitude+f:o.elevation?o.elevation.getAtPointOrZero(o.locationCoordinate(u),o._centerAltitude):o._centerAltitude,T=Pa(1,0)*Wt*_;ge.vec3.scaleAndAdd(y,y,g,T);const E=ge.mat4.identity(new Float64Array(16));return ge.mat4.multiply(E,o.pixelMatrix,o.globeMatrix),ge.vec3.transformMat4(y,y,E),new dt(y[0],y[1])}pixelsPerMeter(o,u){return Pa(1,0)*u}pixelSpaceConversion(o,u,f){const y=Pa(1,o)*u,g=Mr(Pa(1,45)*u,y,f);return this.pixelsPerMeter(o,u)/g}createTileMatrix(o,u,f){const y=Hs(Gs(f.canonical));return ge.mat4.multiply(new Float64Array(16),o.globeMatrix,y)}createInversionMatrix(o,u){const{center:f}=o,y=ji(Gs(u));return ge.mat4.rotateY(y,y,Ye(f.lng)),ge.mat4.rotateX(y,y,Ye(f.lat)),ge.mat4.scale(y,y,[o._pixelsPerMercatorPixel,o._pixelsPerMercatorPixel,1]),Float32Array.from(y)}pointCoordinate(o,u,f,y){return On(o,u,f,!0)||new c(0,0)}pointCoordinate3D(o,u,f){const y=this.pointCoordinate(o,u,f,0);return[y.x,y.y,y.z]}isPointAboveHorizon(o,u){return!On(o,u.x,u.y,!1)}farthestPixelDistance(o){const u=function(y,g){const _=y.cameraToCenterDistance,T=y._centerAltitude*g,E=y._camera,O=y._camera.forward(),C=ge.vec3.add([],ge.vec3.scale([],O,-_),[0,0,T]),M=y.worldSize/(2*Math.PI),D=[0,0,-M],I=y.width/y.height,R=Math.tan(y.fovAboveCenter),H=ge.vec3.scale([],E.up(),R),X=ge.vec3.scale([],E.right(),R*I),J=ge.vec3.normalize([],ge.vec3.add([],ge.vec3.add([],O,H),X)),ne=[];let re;if(new zr(C,J).closestPointOnSphere(D,M,ne)){const te=ge.vec3.add([],ne,D),oe=ge.vec3.sub([],te,C);re=Math.cos(y.fovAboveCenter)*ge.vec3.length(oe)}else{const te=ge.vec3.sub([],C,D),oe=ge.vec3.sub([],D,C);ge.vec3.normalize(oe,oe);const ue=ge.vec3.length(te)-M;re=Math.sqrt(ue*(ue+2*M));const me=Math.acos(re/(M+ue))-Math.acos(ge.vec3.dot(O,oe));re*=Math.cos(me)}return 1.01*re}(o,this.pixelsPerMeter(o.center.lat,o.worldSize)),f=_o(o.zoom);if(f>0){const y=PV(o,Pa(1,o.center.lat)*o.worldSize),g=o.worldSize/(2*Math.PI),_=Math.max(o.width,o.height)/o.worldSize*Math.PI;return Mr(u,y+g*(1-Math.cos(_)),Math.pow(f,10))}return u}upVector(o,u,f){return Un(u,f,o,1)}upVectorScale(o){return{metersToTile:Nn(oi(Gs(o)))}}}function DV(m){const o=m.parallels,u=!!o&&Math.abs(o[0]+o[1])<.01;switch(m.name){case"mercator":return new MV(m);case"equirectangular":return new Sfe(m);case"naturalEarth":return new Afe(m);case"equalEarth":return new Nfe(m);case"winkelTripel":return new Tfe(m);case"albers":return u?new RV(m):new jfe(m);case"lambertConformalConic":return u?new RV(m):new Cfe(m);case"globe":return new kfe(m)}throw new Error(`Invalid projection name: ${m.name}`)}const Pfe=Ef.VectorTileFeature.types,Efe=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function $C(m,o,u,f,y,g,_,T,E,O,C,M,D){const I=T?Math.min(Of,Math.round(T[0])):0,R=T?Math.min(Of,Math.round(T[1])):0;m.emplaceBack(o,u,Math.round(32*f),Math.round(32*y),g,_,(I<<1)+(E?1:0),R,16*O,16*C,256*M,256*D)}function VC(m,o,u){m.emplaceBack(o,u)}function UC(m,o,u,f,y,g,_){m.emplaceBack(o,u,f,y,g,_)}function GC(m,o,u,f,y){m.emplaceBack(o,u,f,y),m.emplaceBack(o,u,f,y),m.emplaceBack(o,u,f,y),m.emplaceBack(o,u,f,y)}function Mfe(m){for(const o of m.sections)if(eC(o.text))return!0;return!1}class Y4{constructor(o){this.layoutVertexArray=new $1,this.indexArray=new va,this.programConfigurations=o,this.segments=new Ti,this.dynamicLayoutVertexArray=new Hh,this.opacityVertexArray=new U1,this.placedSymbolArray=new cC,this.iconTransitioningVertexArray=new Vd,this.globeExtVertexArray=new V1,this.zOffsetVertexArray=new Gh}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0&&this.iconTransitioningVertexArray.length===0}upload(o,u,f,y,g){this.isEmpty()||(f&&(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,Wme.members),this.indexBuffer=o.createIndexBuffer(this.indexArray,u),this.dynamicLayoutVertexBuffer=o.createVertexBuffer(this.dynamicLayoutVertexArray,Zme.members,!0),this.opacityVertexBuffer=o.createVertexBuffer(this.opacityVertexArray,Efe,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=o.createVertexBuffer(this.iconTransitioningVertexArray,Xme.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=o.createVertexBuffer(this.globeExtVertexArray,Kme.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||g)&&(this.zOffsetVertexBuffer=o.createVertexBuffer(this.zOffsetVertexArray,Yme.members,!0)),this.opacityVertexBuffer.itemSize=1),(f||y)&&this.programConfigurations.upload(o))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy())}}lr(Y4,"SymbolBuffers");class X4{constructor(o,u,f){this.layoutVertexArray=new o,this.layoutAttributes=u,this.indexArray=new f,this.segments=new Ti,this.collisionVertexArray=new q1,this.collisionVertexArrayExt=new Hh}upload(o){this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=o.createVertexBuffer(this.collisionVertexArray,Jme.members,!0),this.collisionVertexBufferExt=o.createVertexBuffer(this.collisionVertexArrayExt,Qme.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}lr(X4,"CollisionBuffers");class HC{constructor(o){this.collisionBoxArray=o.collisionBoxArray,this.zoom=o.zoom,this.lut=o.lut,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(_=>_.fqid),this.index=o.index,this.pixelRatio=o.pixelRatio,this.sourceLayerIndex=o.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=ge.mat4.identity([]),this.placementViewportMatrix=ge.mat4.identity([]);const u=this.layers[0]._unevaluatedLayout._values;this.textSizeData=F4(this.zoom,u["text-size"]),this.iconSizeData=F4(this.zoom,u["icon-size"]);const f=this.layers[0].layout,y=f.get("symbol-sort-key"),g=f.get("symbol-z-order");this.canOverlap=f.get("text-allow-overlap")||f.get("icon-allow-overlap")||f.get("text-ignore-placement")||f.get("icon-ignore-placement"),this.sortFeaturesByKey=g!=="viewport-y"&&y.constantOr(1)!==void 0,this.sortFeaturesByY=(g==="viewport-y"||g==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=f.get("text-writing-mode").map(_=>hl[_]),this.stateDependentLayerIds=this.layers.filter(_=>_.isStateDependent()).map(_=>_.id),this.sourceID=o.sourceID,this.projection=o.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=!1,this.elevationType="none",this.elevationStateComplete=!1,this.activeReplacements=[],this.replacementUpdateTime=0}createArrays(){this.text=new Y4(new Gd(this.layers,{zoom:this.zoom,lut:this.lut},o=>o.startsWith("text")||o.startsWith("symbol"))),this.icon=new Y4(new Gd(this.layers,{zoom:this.zoom,lut:this.lut},o=>o.startsWith("icon")||o.startsWith("symbol"))),this.glyphOffsetArray=new hC,this.lineVertexArray=new Gg,this.symbolInstances=new dC}calculateGlyphDependencies(o,u,f,y,g){for(const _ of o){const T=_.codePointAt(0);if(T===void 0)break;if(u[T]=!0,y&&g&&T<=65535){const E=gw[_];E&&(u[E.charCodeAt(0)]=!0)}}}updateFootprints(o,u){}updateReplacement(o,u){if(u.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=u.updateTime;const f=u.getReplacementRegionsForTile(o.toUnwrapped(),!0);return!M4(this.activeReplacements,f)&&(this.activeReplacements=f,!0)}populate(o,u,f,y){const g=this.layers[0],_=g.layout,T=this.projection.name==="globe",E=_.get("text-font"),O=_.get("text-field"),C=_.get("icon-image"),[M,D]=_.get("icon-size-scale-range"),I=rr(u.scaleFactor||1,M,D),R=(O.value.kind!=="constant"||O.value.value instanceof Ha&&!O.value.value.isEmpty()||O.value.value.toString().length>0)&&(E.value.kind!=="constant"||E.value.value.length>0),H=C.value.kind!=="constant"||!!C.value.value||Object.keys(C.parameters).length>0,X=_.get("symbol-sort-key");if(this.features=[],!R&&!H)return;const J=u.iconDependencies,ne=u.glyphDependencies,re=u.availableImages,te=new hi(this.zoom);for(const{feature:oe,id:ue,index:me,sourceLayerIndex:Me}of o){const Se=g._featureFilter.needGeometry,Ae=Y(oe,Se);if(!g._featureFilter.filter(te,Ae,f))continue;if(Se||(Ae.geometry=K(oe,f,y)),T&&oe.type!==1&&f.z<=5){const We=Ae.geometry,Qe=.98078528056,Je=(ot,nt)=>{const ct=Un(ot.x,ot.y,f,1),Ot=Un(nt.x,nt.y,f,1);return ge.vec3.dot(ct,Ot)<Qe};for(let ot=0;ot<We.length;ot++)We[ot]=A(We[ot],Je)}let Ve,Ie;if(R){const We=g.getValueAndResolveTokens("text-field",Ae,f,re),Qe=Ha.factory(We);Mfe(Qe)&&(this.hasRTLText=!0),(!this.hasRTLText||oy()==="unavailable"||this.hasRTLText&&Fl.isParsed())&&(Ve=rfe(Qe,g,Ae))}if(H){const We=g.getValueAndResolveTokens("icon-image",Ae,f,re);Ie=We instanceof qa?We:qa.build(We)}if(!Ve&&!Ie)continue;const Ge=this.sortFeaturesByKey?X.evaluate(Ae,{},f):void 0,Ze={id:ue,text:Ve,icon:Ie,index:me,sourceLayerIndex:Me,geometry:Ae.geometry,properties:oe.properties,type:Pfe[oe.type],sortKey:Ge};if(this.features.push(Ze),Ie){const We=this.layers[0]._unevaluatedLayout._values,{iconPrimary:Qe,iconSecondary:Je}=CV(Ie,this.iconSizeData,We["icon-size"],f,this.zoom,Ze,this.pixelRatio,I),ot=Qe.id.toString();if(J.has(ot)?J.get(ot).push(Qe):J.set(ot,[Qe]),Je){const nt=Je.id.toString();J.has(nt)?J.get(nt).push(Je):J.set(nt,[Je])}}if(Ve){const We=E.evaluate(Ae,{},f).join(","),Qe=_.get("text-rotation-alignment")==="map"&&_.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(hl.vertical)>=0;for(const Je of Ve.sections)if(Je.image){const ot=Je.image.getPrimary().scaleSelf(this.pixelRatio),nt=ot.id.toString(),ct=J.get(nt)||[];ct.push(ot),J.set(nt,ct)}else{const ot=A1(Ve.toString()),nt=Je.fontStack||We,ct=ne[nt]=ne[nt]||{};this.calculateGlyphDependencies(Je.text,ct,Qe,this.allowVerticalPlacement,ot)}}}if(_.get("symbol-placement")==="line"&&(this.features=function(oe){const ue={},me={},Me=[];let Se=0;function Ae(Ze){Me.push(oe[Ze]),Se++}function Ve(Ze,We,Qe){const Je=me[Ze];return delete me[Ze],me[We]=Je,Me[Je].geometry[0].pop(),Me[Je].geometry[0]=Me[Je].geometry[0].concat(Qe[0]),Je}function Ie(Ze,We,Qe){const Je=ue[We];return delete ue[We],ue[Ze]=Je,Me[Je].geometry[0].shift(),Me[Je].geometry[0]=Qe[0].concat(Me[Je].geometry[0]),Je}function Ge(Ze,We,Qe){const Je=Qe?We[0][We[0].length-1]:We[0][0];return`${Ze}:${Je.x}:${Je.y}`}for(let Ze=0;Ze<oe.length;Ze++){const We=oe[Ze],Qe=We.geometry,Je=We.text?We.text.toString():null;if(!Je){Ae(Ze);continue}const ot=Ge(Je,Qe),nt=Ge(Je,Qe,!0);if(ot in me&&nt in ue&&me[ot]!==ue[nt]){const ct=Ie(ot,nt,Qe),Ot=Ve(ot,nt,Me[ct].geometry);delete ue[ot],delete me[nt],me[Ge(Je,Me[Ot].geometry,!0)]=Ot,Me[ct].geometry=null}else ot in me?Ve(ot,nt,Qe):nt in ue?Ie(ot,nt,Qe):(Ae(Ze),ue[ot]=Se-1,me[nt]=Se-1)}return Me.filter(Ze=>Ze.geometry)}(this.features)),_.get("symbol-elevation-reference")==="hd-road-markup"){if(this.elevationType="road",u.elevationFeatures){!this.elevationFeatures&&u.elevationFeatures.length>0&&(this.elevationFeatures=[],this.elevationFeatureIdToIndex=new Map);for(const oe of u.elevationFeatures)this.elevationFeatureIdToIndex.set(oe.id,this.elevationFeatures.length),this.elevationFeatures.push(oe)}}else _.get("symbol-z-elevate")&&(this.elevationType="offset");this.elevationType!=="none"&&(this.zOffsetBuffersNeedUpload=!0),this.sortFeaturesByKey&&this.features.sort((oe,ue)=>oe.sortKey-ue.sortKey)}update(o,u,f,y,g,_,T){this.text.programConfigurations.updatePaintArrays(o,u,g,f,y,_,T),this.icon.programConfigurations.updatePaintArrays(o,u,g,f,y,_,T)}updateRoadElevation(){if(this.elevationType!=="road"||!this.elevationFeatures||this.elevationStateComplete)return;this.elevationStateComplete=!0,this.hasAnyZOffset=!1;let o=!1;for(let u=0;u<this.symbolInstances.length;u++){const f=this.symbolInstances.get(u);if(f.elevationFeatureIndex===65535)continue;const y=this.elevationFeatures[f.elevationFeatureIndex];if(y){const g=.05+y.pointElevation(new dt(f.tileAnchorX,f.tileAnchorY));f.zOffset!==g&&(o=!0,f.zOffset=g)}}o&&(this.zOffsetBuffersNeedUpload=!0,this.zOffsetSortDirty=!0)}updateZOffset(){const o=(g,_,T)=>{f+=_,f>g.length&&g.resize(f);for(let E=-_;E<0;E++)g.emplace(E+f,T)},u=(g,_,T)=>{y+=_,y>g.length&&g.resize(y);for(let E=-_;E<0;E++)g.emplace(E+y,T)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let f=0,y=0;for(let g=0;g<this.symbolInstances.length;g++){const _=this.symbolInstances.get(g),{numHorizontalGlyphVertices:T,numVerticalGlyphVertices:E,numIconVertices:O}=_,C=_.zOffset,M=O>0;if((T>0||E>0)&&(o(this.text.zOffsetVertexArray,T,C),o(this.text.zOffsetVertexArray,E,C)),M){const{placedIconSymbolIndex:D,verticalPlacedIconSymbolIndex:I}=_;D>=0&&u(this.icon.zOffsetVertexArray,O,C),I>=0&&u(this.icon.zOffsetVertexArray,_.numVerticalIconVertices,C)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(o){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(o),this.iconCollisionBox.upload(o)),this.text.upload(o,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(o,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=DV(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(o,u){const f=this.lineVertexArray.length;if(o.segment!==void 0)for(const{x:y,y:g}of u)this.lineVertexArray.emplaceBack(y,g);return{lineStartIndex:f,lineLength:this.lineVertexArray.length-f}}addSymbols(o,u,f,y,g,_,T,E,O,C,M,D,I,R,H,X){const J=o.indexArray,ne=o.layoutVertexArray,re=o.globeExtVertexArray,te=o.segments.prepareSegment(4*u.length,ne,J,this.canOverlap?_.sortKey:void 0),oe=this.glyphOffsetArray.length,ue=te.vertexLength,me=this.allowVerticalPlacement&&T===hl.vertical?Math.PI/2:0,Me=_.text&&_.text.sections;for(let Ae=0;Ae<u.length;Ae++){const{tl:Ve,tr:Ie,bl:Ge,br:Ze,texPrimary:We,texSecondary:Qe,pixelOffsetTL:Je,pixelOffsetBR:ot,minFontScaleX:nt,minFontScaleY:ct,glyphOffset:Ot,isSDF:Mt,sectionIndex:cr}=u[Ae],Lt=te.vertexLength,Gt=Ot[1];if($C(ne,O.x,O.y,Ve.x,Gt+Ve.y,We.x,We.y,f,Mt,Je.x,Je.y,nt,ct),$C(ne,O.x,O.y,Ie.x,Gt+Ie.y,We.x+We.w,We.y,f,Mt,ot.x,Je.y,nt,ct),$C(ne,O.x,O.y,Ge.x,Gt+Ge.y,We.x,We.y+We.h,f,Mt,Je.x,ot.y,nt,ct),$C(ne,O.x,O.y,Ze.x,Gt+Ze.y,We.x+We.w,We.y+We.h,f,Mt,ot.x,ot.y,nt,ct),E){const{x:Rt,y:Pr,z:ir}=E.anchor,[pr,Lr,on]=E.up;UC(re,Rt,Pr,ir,pr,Lr,on),UC(re,Rt,Pr,ir,pr,Lr,on),UC(re,Rt,Pr,ir,pr,Lr,on),UC(re,Rt,Pr,ir,pr,Lr,on),GC(o.dynamicLayoutVertexArray,Rt,Pr,ir,me)}else GC(o.dynamicLayoutVertexArray,O.x,O.y,O.z,me);if(X){const Rt=Qe||We;VC(o.iconTransitioningVertexArray,Rt.x,Rt.y),VC(o.iconTransitioningVertexArray,Rt.x+Rt.w,Rt.y),VC(o.iconTransitioningVertexArray,Rt.x,Rt.y+Rt.h),VC(o.iconTransitioningVertexArray,Rt.x+Rt.w,Rt.y+Rt.h)}J.emplaceBack(Lt,Lt+1,Lt+2),J.emplaceBack(Lt+1,Lt+2,Lt+3),te.vertexLength+=4,te.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Ot[0]),Ae!==u.length-1&&cr===u[Ae+1].sectionIndex||o.programConfigurations.populatePaintArrays(ne.length,_,_.index,{},I,R,H,Me&&Me[cr])}const Se=E?E.anchor:O;o.placedSymbolArray.emplaceBack(Se.x,Se.y,Se.z,O.x,O.y,oe,this.glyphOffsetArray.length-oe,ue,C,M,O.segment,f?f[0]:0,f?f[1]:0,y[0],y[1],T,0,!1,0,D,0)}_commitLayoutVertex(o,u,f,y,g,_,T){o.emplaceBack(u,f,y,g,_,Math.round(T.x),Math.round(T.y))}_addCollisionDebugVertices(o,u,f,y,g,_,T){const E=f.segments.prepareSegment(4,f.layoutVertexArray,f.indexArray),O=E.vertexLength,C=T.tileAnchorX,M=T.tileAnchorY;for(let I=0;I<4;I++)f.collisionVertexArray.emplaceBack(0,0,0,0,0,0);this._commitDebugCollisionVertexUpdate(f.collisionVertexArrayExt,u,o.padding,T.zOffset),this._commitLayoutVertex(f.layoutVertexArray,y,g,_,C,M,new dt(o.x1,o.y1)),this._commitLayoutVertex(f.layoutVertexArray,y,g,_,C,M,new dt(o.x2,o.y1)),this._commitLayoutVertex(f.layoutVertexArray,y,g,_,C,M,new dt(o.x2,o.y2)),this._commitLayoutVertex(f.layoutVertexArray,y,g,_,C,M,new dt(o.x1,o.y2)),E.vertexLength+=4;const D=f.indexArray;D.emplaceBack(O,O+1),D.emplaceBack(O+1,O+2),D.emplaceBack(O+2,O+3),D.emplaceBack(O+3,O),E.primitiveLength+=4}_addTextDebugCollisionBoxes(o,u,f,y,g,_){for(let T=y;T<g;T++){const E=f.get(T),O=this.getSymbolInstanceTextSize(o,_,u,T);this._addCollisionDebugVertices(E,O,this.textCollisionBox,E.projectedAnchorX,E.projectedAnchorY,E.projectedAnchorZ,_)}}_addIconDebugCollisionBoxes(o,u,f,y,g,_){for(let T=y;T<g;T++){const E=f.get(T),O=this.getSymbolInstanceIconSize(o,u,_.placedIconSymbolIndex);this._addCollisionDebugVertices(E,O,this.iconCollisionBox,E.projectedAnchorX,E.projectedAnchorY,E.projectedAnchorZ,_)}}generateCollisionDebugBuffers(o,u,f){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new X4($g,J8.members,Vd),this.iconCollisionBox=new X4($g,J8.members,Vd);const y=Ay(this.iconSizeData,o),g=Ay(this.textSizeData,o,f);for(let _=0;_<this.symbolInstances.length;_++){const T=this.symbolInstances.get(_);this._addTextDebugCollisionBoxes(g,o,u,T.textBoxStartIndex,T.textBoxEndIndex,T),this._addTextDebugCollisionBoxes(g,o,u,T.verticalTextBoxStartIndex,T.verticalTextBoxEndIndex,T),this._addIconDebugCollisionBoxes(y,o,u,T.iconBoxStartIndex,T.iconBoxEndIndex,T),this._addIconDebugCollisionBoxes(y,o,u,T.verticalIconBoxStartIndex,T.verticalIconBoxEndIndex,T)}}getSymbolInstanceTextSize(o,u,f,y){const g=this.text.placedSymbolArray.get(u.rightJustifiedTextSymbolIndex>=0?u.rightJustifiedTextSymbolIndex:u.centerJustifiedTextSymbolIndex>=0?u.centerJustifiedTextSymbolIndex:u.leftJustifiedTextSymbolIndex>=0?u.leftJustifiedTextSymbolIndex:u.verticalPlacedTextSymbolIndex>=0?u.verticalPlacedTextSymbolIndex:y),_=MC(this.textSizeData,o,g)/Ma;return this.tilePixelRatio*_}getSymbolInstanceIconSize(o,u,f){const y=this.icon.placedSymbolArray.get(f),g=MC(this.iconSizeData,o,y);return this.tilePixelRatio*g}_commitDebugCollisionVertexUpdate(o,u,f,y){o.emplaceBack(u,-f,-f,y),o.emplaceBack(u,f,-f,y),o.emplaceBack(u,f,f,y),o.emplaceBack(u,-f,f,y)}_updateTextDebugCollisionBoxes(o,u,f,y,g,_,T){for(let E=y;E<g;E++){const O=f.get(E),C=this.getSymbolInstanceTextSize(o,_,u,E);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,C,O.padding,_.zOffset)}}_updateIconDebugCollisionBoxes(o,u,f,y,g,_,T){for(let E=y;E<g;E++){const O=f.get(E),C=this.getSymbolInstanceIconSize(o,u,_.placedIconSymbolIndex);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,C,O.padding,_.zOffset)}}updateCollisionDebugBuffers(o,u,f,y){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const g=Ay(this.iconSizeData,o,y),_=Ay(this.textSizeData,o,f);for(let T=0;T<this.symbolInstances.length;T++){const E=this.symbolInstances.get(T);this._updateTextDebugCollisionBoxes(_,o,u,E.textBoxStartIndex,E.textBoxEndIndex,E,f),this._updateTextDebugCollisionBoxes(_,o,u,E.verticalTextBoxStartIndex,E.verticalTextBoxEndIndex,E,f),this._updateIconDebugCollisionBoxes(g,o,u,E.iconBoxStartIndex,E.iconBoxEndIndex,E,y),this._updateIconDebugCollisionBoxes(g,o,u,E.verticalIconBoxStartIndex,E.verticalIconBoxEndIndex,E,y)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(o,u,f,y,g,_,T,E,O){const C={};if(u<f){const{x1:M,y1:D,x2:I,y2:R,padding:H,projectedAnchorX:X,projectedAnchorY:J,projectedAnchorZ:ne,tileAnchorX:re,tileAnchorY:te,featureIndex:oe}=o.get(u);C.textBox={x1:M,y1:D,x2:I,y2:R,padding:H,projectedAnchorX:X,projectedAnchorY:J,projectedAnchorZ:ne,tileAnchorX:re,tileAnchorY:te},C.textFeatureIndex=oe}if(y<g){const{x1:M,y1:D,x2:I,y2:R,padding:H,projectedAnchorX:X,projectedAnchorY:J,projectedAnchorZ:ne,tileAnchorX:re,tileAnchorY:te,featureIndex:oe}=o.get(y);C.verticalTextBox={x1:M,y1:D,x2:I,y2:R,padding:H,projectedAnchorX:X,projectedAnchorY:J,projectedAnchorZ:ne,tileAnchorX:re,tileAnchorY:te},C.verticalTextFeatureIndex=oe}if(_<T){const{x1:M,y1:D,x2:I,y2:R,padding:H,projectedAnchorX:X,projectedAnchorY:J,projectedAnchorZ:ne,tileAnchorX:re,tileAnchorY:te,featureIndex:oe}=o.get(_);C.iconBox={x1:M,y1:D,x2:I,y2:R,padding:H,projectedAnchorX:X,projectedAnchorY:J,projectedAnchorZ:ne,tileAnchorX:re,tileAnchorY:te},C.iconFeatureIndex=oe}if(E<O){const{x1:M,y1:D,x2:I,y2:R,padding:H,projectedAnchorX:X,projectedAnchorY:J,projectedAnchorZ:ne,tileAnchorX:re,tileAnchorY:te,featureIndex:oe}=o.get(E);C.verticalIconBox={x1:M,y1:D,x2:I,y2:R,padding:H,projectedAnchorX:X,projectedAnchorY:J,projectedAnchorZ:ne,tileAnchorX:re,tileAnchorY:te},C.verticalIconFeatureIndex=oe}return C}deserializeCollisionBoxes(o){this.collisionArrays=[];for(let u=0;u<this.symbolInstances.length;u++){const f=this.symbolInstances.get(u);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(o,f.textBoxStartIndex,f.textBoxEndIndex,f.verticalTextBoxStartIndex,f.verticalTextBoxEndIndex,f.iconBoxStartIndex,f.iconBoxEndIndex,f.verticalIconBoxStartIndex,f.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(o,u){const f=o.placedSymbolArray.get(u),y=f.vertexStartIndex+4*f.numGlyphs;for(let g=f.vertexStartIndex;g<y;g+=4)o.indexArray.emplaceBack(g,g+1,g+2),o.indexArray.emplaceBack(g+1,g+2,g+3)}getSortedSymbolIndexes(o){if(this.sortedAngle===o&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const u=Math.sin(o),f=Math.cos(o),y=[],g=[],_=[];for(let T=0;T<this.symbolInstances.length;++T){_.push(T);const E=this.symbolInstances.get(T);y.push(0|Math.round(u*E.tileAnchorX+f*E.tileAnchorY)),g.push(E.featureIndex)}return _.sort((T,E)=>y[T]-y[E]||g[E]-g[T]),_}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let o=0;o<this.symbolInstances.length;++o)this.symbolInstanceIndexesSortedZOffset.push(o)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort((o,u)=>this.symbolInstances.get(u).zOffset-this.symbolInstances.get(o).zOffset)}addToSortKeyRanges(o,u){const f=this.sortKeyRanges[this.sortKeyRanges.length-1];f&&f.sortKey===u?f.symbolInstanceEnd=o+1:this.sortKeyRanges.push({sortKey:u,symbolInstanceStart:o,symbolInstanceEnd:o+1})}sortFeatures(o){if(this.sortFeaturesByY&&this.sortedAngle!==o&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(o),this.sortedAngle=o,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const u of this.symbolInstanceIndexes){const f=this.symbolInstances.get(u);this.featureSortOrder.push(f.featureIndex);const{rightJustifiedTextSymbolIndex:y,centerJustifiedTextSymbolIndex:g,leftJustifiedTextSymbolIndex:_,verticalPlacedTextSymbolIndex:T,placedIconSymbolIndex:E,verticalPlacedIconSymbolIndex:O}=f;y>=0&&this.addIndicesForPlacedSymbol(this.text,y),g>=0&&g!==y&&this.addIndicesForPlacedSymbol(this.text,g),_>=0&&_!==g&&_!==y&&this.addIndicesForPlacedSymbol(this.text,_),T>=0&&this.addIndicesForPlacedSymbol(this.text,T),E>=0&&this.addIndicesForPlacedSymbol(this.icon,E),O>=0&&this.addIndicesForPlacedSymbol(this.icon,O)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let zV,LV,J4;lr(HC,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),HC.addDynamicAttributes=GC;class FV{constructor(o){this.type=o.property.overrides?o.property.overrides.runtimeType:Km,this.defaultValue=o}evaluate(o){if(o.formattedSection){const u=this.defaultValue.property.overrides;if(u&&u.hasOverride(o.formattedSection))return u.getOverride(o.formattedSection)}return o.feature&&o.featureState?this.defaultValue.evaluate(o.feature,o.featureState):this.defaultValue.property.specification.default}eachChild(o){this.defaultValue.isConstant()||o(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}lr(FV,"FormatSectionOverride",{omit:["defaultValue"]});const Q4=()=>J4||(J4={layout:zV||(zV=new Ki({"symbol-placement":new Vt(ut.layout_symbol["symbol-placement"]),"symbol-spacing":new Vt(ut.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Vt(ut.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new ar(ut.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Vt(ut.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new Vt(ut.layout_symbol["symbol-z-elevate"]),"symbol-elevation-reference":new Vt(ut.layout_symbol["symbol-elevation-reference"]),"icon-allow-overlap":new Vt(ut.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Vt(ut.layout_symbol["icon-ignore-placement"]),"icon-optional":new Vt(ut.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Vt(ut.layout_symbol["icon-rotation-alignment"]),"icon-size":new ar(ut.layout_symbol["icon-size"]),"icon-size-scale-range":new Vt(ut.layout_symbol["icon-size-scale-range"]),"icon-text-fit":new ar(ut.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new ar(ut.layout_symbol["icon-text-fit-padding"]),"icon-image":new ar(ut.layout_symbol["icon-image"]),"icon-rotate":new ar(ut.layout_symbol["icon-rotate"]),"icon-padding":new Vt(ut.layout_symbol["icon-padding"]),"icon-keep-upright":new Vt(ut.layout_symbol["icon-keep-upright"]),"icon-offset":new ar(ut.layout_symbol["icon-offset"]),"icon-anchor":new ar(ut.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Vt(ut.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Vt(ut.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Vt(ut.layout_symbol["text-rotation-alignment"]),"text-field":new ar(ut.layout_symbol["text-field"]),"text-font":new ar(ut.layout_symbol["text-font"]),"text-size":new ar(ut.layout_symbol["text-size"]),"text-size-scale-range":new Vt(ut.layout_symbol["text-size-scale-range"]),"text-max-width":new ar(ut.layout_symbol["text-max-width"]),"text-line-height":new ar(ut.layout_symbol["text-line-height"]),"text-letter-spacing":new ar(ut.layout_symbol["text-letter-spacing"]),"text-justify":new ar(ut.layout_symbol["text-justify"]),"text-radial-offset":new ar(ut.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Vt(ut.layout_symbol["text-variable-anchor"]),"text-anchor":new ar(ut.layout_symbol["text-anchor"]),"text-max-angle":new Vt(ut.layout_symbol["text-max-angle"]),"text-writing-mode":new Vt(ut.layout_symbol["text-writing-mode"]),"text-rotate":new ar(ut.layout_symbol["text-rotate"]),"text-padding":new Vt(ut.layout_symbol["text-padding"]),"text-keep-upright":new Vt(ut.layout_symbol["text-keep-upright"]),"text-transform":new ar(ut.layout_symbol["text-transform"]),"text-offset":new ar(ut.layout_symbol["text-offset"]),"text-allow-overlap":new Vt(ut.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Vt(ut.layout_symbol["text-ignore-placement"]),"text-optional":new Vt(ut.layout_symbol["text-optional"]),visibility:new Vt(ut.layout_symbol.visibility)})),paint:LV||(LV=new Ki({"icon-opacity":new ar(ut.paint_symbol["icon-opacity"]),"icon-occlusion-opacity":new ar(ut.paint_symbol["icon-occlusion-opacity"]),"icon-emissive-strength":new ar(ut.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new ar(ut.paint_symbol["text-emissive-strength"]),"icon-color":new ar(ut.paint_symbol["icon-color"]),"icon-halo-color":new ar(ut.paint_symbol["icon-halo-color"]),"icon-halo-width":new ar(ut.paint_symbol["icon-halo-width"]),"icon-halo-blur":new ar(ut.paint_symbol["icon-halo-blur"]),"icon-translate":new Vt(ut.paint_symbol["icon-translate"]),"icon-translate-anchor":new Vt(ut.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new ar(ut.paint_symbol["icon-image-cross-fade"]),"text-opacity":new ar(ut.paint_symbol["text-opacity"]),"text-occlusion-opacity":new ar(ut.paint_symbol["text-occlusion-opacity"]),"text-color":new ar(ut.paint_symbol["text-color"],{runtimeType:Ga,getOverride:m=>m.textColor,hasOverride:m=>!!m.textColor}),"text-halo-color":new ar(ut.paint_symbol["text-halo-color"]),"text-halo-width":new ar(ut.paint_symbol["text-halo-width"]),"text-halo-blur":new ar(ut.paint_symbol["text-halo-blur"]),"text-translate":new Vt(ut.paint_symbol["text-translate"]),"text-translate-anchor":new Vt(ut.paint_symbol["text-translate-anchor"]),"icon-color-saturation":new Vt(ut.paint_symbol["icon-color-saturation"]),"icon-color-contrast":new Vt(ut.paint_symbol["icon-color-contrast"]),"icon-color-brightness-min":new Vt(ut.paint_symbol["icon-color-brightness-min"]),"icon-color-brightness-max":new Vt(ut.paint_symbol["icon-color-brightness-max"]),"symbol-z-offset":new ar(ut.paint_symbol["symbol-z-offset"]),"icon-color-use-theme":new ar({type:"string",default:"default","property-type":"data-driven"}),"icon-halo-color-use-theme":new ar({type:"string",default:"default","property-type":"data-driven"}),"text-color-use-theme":new ar({type:"string",default:"default","property-type":"data-driven"}),"text-halo-color-use-theme":new ar({type:"string",default:"default","property-type":"data-driven"})}))},J4);class qC extends ua{constructor(o,u,f,y){super(o,Q4(),u,f,y),this._colorAdjustmentMatrix=ge.mat4.identity([]),this.hasInitialOcclusionOpacityProperties=o.paint!==void 0&&("icon-occlusion-opacity"in o.paint||"text-occlusion-opacity"in o.paint)}recalculate(o,u){super.recalculate(o,u),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const f=this.layout.get("text-writing-mode");if(f){const y=[];for(const g of f)y.indexOf(g)<0&&y.push(g);this.layout._values["text-writing-mode"]=y}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getColorAdjustmentMatrix(o,u,f,y){return this._saturation===o&&this._contrast===u&&this._brightnessMin===f&&this._brightnessMax===y||(this._colorAdjustmentMatrix=function(g,_,T,E){g=bt(g),_=Oh(_);const O=ge.mat4.create(),C=g/3,M=1-2*C,D=[M,C,C,0,C,M,C,0,C,C,M,0,0,0,0,1],I=.5-.5*_,R=E-T;return ge.mat4.multiply(O,[R,0,0,0,0,R,0,0,0,0,R,0,T,T,T,1],[_,0,0,0,0,_,0,0,0,0,_,0,I,I,I,1]),ge.mat4.multiply(O,O,D),O}(o,u,f,y),this._saturation=o,this._contrast=u,this._brightnessMin=f,this._brightnessMax=y),this._colorAdjustmentMatrix}getValueAndResolveTokens(o,u,f,y){const g=this.layout.get(o).evaluate(u,{},f,y),_=this._unevaluatedLayout._values[o];return _.isDataDriven()||ey(_.value)||!g?g:function(T,E){return E.replace(/{([^{}]+)}/g,(O,C)=>C in T?String(T[C]):"")}(u.properties,g)}createBucket(o){return new HC(o)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const o of Q4().paint.overridableProperties){if(!qC.hasPaintOverride(this.layout,o))continue;const u=this.paint.get(o),f=new FV(u),y=new w1(f,u.property.specification,this.scope,this.options);let g=null;g=u.value.kind==="constant"||u.value.kind==="source"?new j1("source",y):new mf("composite",y,u.value.zoomStops,u.value._interpolationType),this.paint._values[o]=new yf(u.property,g,u.parameters)}}_handleOverridablePaintPropertyUpdate(o,u,f){return!(!this.layout||u.isDataDriven()||f.isDataDriven())&&qC.hasPaintOverride(this.layout,o)}static hasPaintOverride(o,u){const f=o.get("text-field"),y=Q4().paint.properties[u];let g=!1;const _=T=>{for(const E of T)if(y.overrides&&y.overrides.hasOverride(E))return void(g=!0)};if(f.value.kind==="constant"&&f.value.value instanceof Ha)_(f.value.value.sections);else if(f.value.kind==="source"){const T=O=>{g||(O instanceof Eu&&Es(O.value)===bg?_(O.value.sections):O instanceof Jm?_(O.sections):O.eachChild(T))},E=f.value;E._styleExpression&&T(E._styleExpression.expression)}return g}getProgramIds(){return["symbol"]}getDefaultProgramParams(o,u,f){return{config:new Wh(this,{zoom:u,lut:f}),overrideFog:!1}}}let BV,$V,VV,UV;var eI=Bn([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);function tI(m){switch(m){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.RGBA;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.DEPTH_COMPONENT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.DEPTH_STENCIL;case WebGL2RenderingContext.R8:case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.RED}}function rI(m){switch(m){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.UNSIGNED_SHORT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.UNSIGNED_INT_24_8;case WebGL2RenderingContext.R8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.FLOAT}}class nI{constructor(o,u,f,y){this.context=o,this.format=f,this.useMipmap=y&&y.useMipmap,this.texture=o.gl.createTexture(),this.update(u,{premultiply:y&&y.premultiply})}update(o,u){const f=o&&o instanceof HTMLVideoElement&&o.width===0?o.videoWidth:o.width,y=o&&o instanceof HTMLVideoElement&&o.height===0?o.videoHeight:o.height,{context:g}=this,{gl:_}=g,{x:T,y:E}=u&&u.position?u.position:{x:0,y:0},O=T+f,C=E+y;!this.size||this.size[0]===O&&this.size[1]===C||(_.bindTexture(_.TEXTURE_2D,null),_.deleteTexture(this.texture),this.texture=_.createTexture(),this.size=null),_.bindTexture(_.TEXTURE_2D,this.texture),g.pixelStoreUnpackFlipY.set(!1),g.pixelStoreUnpack.set(1),g.pixelStoreUnpackPremultiplyAlpha.set(this.format===_.RGBA8&&(!u||u.premultiply!==!1));const M=o instanceof HTMLImageElement||o instanceof HTMLCanvasElement||o instanceof HTMLVideoElement||o instanceof ImageData||ImageBitmap&&o instanceof ImageBitmap;if(!this.size&&O>0&&C>0){const D=this.useMipmap?Math.floor(Math.log2(Math.max(O,C)))+1:1;_.texStorage2D(_.TEXTURE_2D,D,this.format,O,C),this.size=[O,C]}if(this.size)if(M)_.texSubImage2D(_.TEXTURE_2D,0,T,E,tI(this.format),rI(this.format),o);else{const D=o.data;D&&_.texSubImage2D(_.TEXTURE_2D,0,T,E,f,y,tI(this.format),rI(this.format),D)}this.useMipmap&&_.generateMipmap(_.TEXTURE_2D)}bind(o,u,f=!1){const{context:y}=this,{gl:g}=y;g.bindTexture(g.TEXTURE_2D,this.texture),o!==this.minFilter&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,o),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,this.useMipmap&&!f?o===g.NEAREST?g.NEAREST_MIPMAP_NEAREST:g.LINEAR_MIPMAP_LINEAR:o),this.minFilter=o),u!==this.wrapS&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,u),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,u),this.wrapS=u)}bindExtraParam(o,u,f,y){const{context:g}=this,{gl:_}=g;_.bindTexture(_.TEXTURE_2D,this.texture),u!==this.magFilter&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MAG_FILTER,u),this.magFilter=u),o!==this.minFilter&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MIN_FILTER,this.useMipmap?o===_.NEAREST?_.NEAREST_MIPMAP_NEAREST:_.LINEAR_MIPMAP_LINEAR:o),this.minFilter=o),f!==this.wrapS&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_S,f),this.wrapS=f),y!==this.wrapT&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_T,y),this.wrapT=y)}destroy(){const{gl:o}=this.context;o.deleteTexture(this.texture),this.texture=null}}class WC{constructor(o,u){this.context=o,this.texture=u}bind(o,u){const{context:f}=this,{gl:y}=f;y.bindTexture(y.TEXTURE_2D,this.texture),o!==this.minFilter&&(y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MAG_FILTER,o),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MIN_FILTER,o),this.minFilter=o),u!==this.wrapS&&(y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_S,u),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_T,u),this.wrapS=u)}}function KC(m,o,u,f,y,g,_,T){const E=[m,o,1,u,f,1,y,g,1],O=[_,T,1],C=ge.mat3.adjoint([],E),[M,D,I]=ge.vec3.transformMat3(O,O,C);return ge.mat3.multiply(E,E,[M,0,0,0,D,0,0,0,I])}function GV(m,o,u,f,y,g,_,T){const E=function(O,C,M,D,I,R,H,X){const J=KC(0,0,1,0,1,1,0,1),ne=KC(O,C,M,D,I,R,H,X),re=ge.mat3.adjoint([],J);return ge.mat3.multiply(ne,ne,re)}(m,o,u,f,y,g,_,T);return[E[2]/E[8]/Wt,E[5]/E[8]/Wt]}function ZC(m){return[m[0],Math.min(Math.max(m[1],-ds),ds)]}class HV extends lc{constructor(o,u,f,y){super(),this.id=o,this.dispatcher=f,this.coordinates=u.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(y),this.options=u,this._dirty=!1}load(o,u){if(this._loaded=u||!1,this.fire(new Ro("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return o&&(this.coordinates=o),this._loaded=!0,void this._finishLoading();this._imageRequest=Md(this.map._requestManager.transformRequest(this.url,Ps.Image),(f,y)=>{this._imageRequest=null,this._loaded=!0,f?this.fire(new Wm(f)):y&&(this.image=y instanceof HTMLImageElement?vt.getImageData(y):y,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,o&&(this.coordinates=o),this._finishLoading())})}loaded(){return this._loaded}updateImage(o){return o.url?(this._imageRequest&&o.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=o.url,this.load(o.coordinates,this._loaded),this):this}setTexture(o){if(!(o.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new WC(this.map.painter.context,o.handle),this.width=o.dimensions[0],this.height=o.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new Ro("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(o){this.map=o,this.load()}onRemove(o){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof WC||this.texture.destroy(),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy())}setCoordinates(o){if(this.coordinates=o,this._boundsArray=void 0,this._unsupportedCoords=!1,!o.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let u=o[0][1],f=o[0][1];for(const g of o)g[1]>f&&(f=g[1]),g[1]<u&&(u=g[1]);const y=(f+u)/2;if(y>ds?this.onNorthPole=!0:y<-ds&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const g=o.map(c.fromLngLat);this.tileID=function(_){let T=1/0,E=1/0,O=-1/0,C=-1/0;for(const H of _)T=Math.min(T,H.x),E=Math.min(E,H.y),O=Math.max(O,H.x),C=Math.max(C,H.y);const M=Math.max(O-T,C-E),D=Math.max(0,Math.floor(-Math.log(M)/Math.LN2)),I=Math.pow(2,D);let R=Math.floor((T+O)/2*I);return R>1&&(R-=1),new Et(D,R,Math.floor((E+C)/2*I))}(g),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new Ro("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0,this._unsupportedCoords=!1}_prepareData(o){for(const J in this.tiles){const ne=this.tiles[J];ne.state!=="loaded"&&(ne.state="loaded",ne.texture=this.texture)}if(this._boundsArray||this.onNorthPole||this.onSouthPole||this._unsupportedCoords)return;const u=_w(new Et(0,0,0),this.map.transform.projection),f=[u.projection.project(this.coordinates[0][0],this.coordinates[0][1]),u.projection.project(this.coordinates[1][0],this.coordinates[1][1]),u.projection.project(this.coordinates[2][0],this.coordinates[2][1]),u.projection.project(this.coordinates[3][0],this.coordinates[3][1])];if(!function(J){const ne=J[1].x-J[0].x,re=J[1].y-J[0].y,te=J[2].x-J[1].x,oe=J[2].y-J[1].y,ue=J[3].x-J[2].x,me=J[3].y-J[2].y,Me=J[0].x-J[3].x,Se=J[0].y-J[3].y,Ae=ne*oe-te*re,Ve=te*me-ue*oe,Ie=ue*Se-Me*me,Ge=Me*re-ne*Se;return Ae>0&&Ve>0&&Ie>0&&Ge>0||Ae<0&&Ve<0&&Ie<0&&Ge<0}(f))return console.warn("Image source coordinates are defining non-convex area in the Mercator projection"),void(this._unsupportedCoords=!0);const y=_w(this.tileID,this.map.transform.projection),[g,_,T,E]=this.coordinates.map(J=>{const ne=y.projection.project(J[0],J[1]);return EV(y,ne)._round()});this.perspectiveTransform=GV(g.x,g.y,_.x,_.y,T.x,T.y,E.x,E.y);const O=this._boundsArray=new $u;O.emplaceBack(g.x,g.y,0,0),O.emplaceBack(_.x,_.y,Wt,0),O.emplaceBack(E.x,E.y,0,Wt),O.emplaceBack(T.x,T.y,Wt,Wt),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy()),this.boundsBuffer=o.createVertexBuffer(O,eI.members),this.boundsSegments=Ti.simpleSegment(0,0,4,2);const C=[],M=[ZC((D=this.coordinates)[0]),ZC(D[1]),ZC(D[2]),ZC(D[3])];var D;const[I,R,H,X]=function(J){let ne=J[0][0],re=ne,te=J[0][1],oe=te;for(let ue=1;ue<J.length;ue++)J[ue][0]<ne?ne=J[ue][0]:J[ue][0]>re&&(re=J[ue][0]),J[ue][1]<te?te=J[ue][1]:J[ue][1]>oe&&(oe=J[ue][1]);return[ne,te,re-ne,oe-te]}(M);{const J=new $u,[ne,re,te,oe]=function(Je){let ot=Je[0].x,nt=ot,ct=Je[0].y,Ot=ct;for(let Mt=1;Mt<Je.length;Mt++)Je[Mt].x<ot?ot=Je[Mt].x:Je[Mt].x>nt&&(nt=Je[Mt].x),Je[Mt].y<ct?ct=Je[Mt].y:Je[Mt].y>Ot&&(Ot=Je[Mt].y);return[ot,ct,nt-ot,Ot-ct]}(f),ue=Je=>[(Je.x-ne)/te,(Je.y-re)/oe],[me,Me,Se,Ae]=f.map(ue),Ve=function(Je,ot,nt,ct,Ot,Mt,cr,Lt){const Gt=KC(0,0,1,0,1,1,0,1),Rt=KC(Je,ot,nt,ct,Ot,Mt,cr,Lt),Pr=ge.mat3.adjoint([],Rt);return ge.mat3.multiply(Gt,Gt,Pr)}(me[0],me[1],Me[0],Me[1],Se[0],Se[1],Ae[0],Ae[1]);this.elevatedGlobePerspectiveTransform=GV(me[0],me[1],Me[0],Me[1],Se[0],Se[1],Ae[0],Ae[1]);const Ie=(Je,ot)=>{C.push(Je.lng);const nt=Math.round((Je.lng-I)/H*Wt),ct=Math.round((Je.lat-R)/X*Wt),Ot=ue(ot),Mt=ge.vec3.transformMat3([],[Ot[0],Ot[1],1],Ve),cr=Math.round(Mt[0]/Mt[2]*Wt),Lt=Math.round(Mt[1]/Mt[2]*Wt);J.emplaceBack(nt,ct,cr,Lt)},Ge=f[3].x-f[0].x,Ze=f[3].y-f[0].y,We=f[2].x-f[1].x,Qe=f[2].y-f[1].y;for(let Je=0;Je<65;Je++){const ot=Je/64,nt=[f[0].x+ot*Ge,f[0].y+ot*Ze],ct=[f[1].x+ot*We,f[1].y+ot*Qe],Ot=ct[0]-nt[0],Mt=ct[1]-nt[1];for(let cr=0;cr<65;cr++){const Lt=cr/64,Gt={x:nt[0]+Ot*Lt,y:nt[1]+Mt*Lt,z:0};Ie(u.projection.unproject(Gt.x,Gt.y),Gt)}}this.elevatedGlobeVertexBuffer=o.createVertexBuffer(J,eI.members)}{this.maxLongitudeTriangleSize=0;let J=[],ne=new va;const re=(te,oe,ue)=>{ne.emplaceBack(te,oe,ue);const me=C[te],Me=C[oe],Se=C[ue],Ae=Math.min(Math.min(me,Me),Se),Ve=Math.max(Math.max(me,Me),Se)-Ae;Ve>this.maxLongitudeTriangleSize&&(this.maxLongitudeTriangleSize=Ve),J.push(Ae+Ve/2)};for(let te=0;te<64;te++)for(let oe=0;oe<64;oe++){const ue=65*te+oe,me=ue+1,Me=ue+65,Se=Me+1;re(ue,Me,me),re(me,Me,Se)}[J,ne]=function(te,oe){const ue=Array.from({length:te.length},(Se,Ae)=>Ae);ue.sort((Se,Ae)=>te[Se]-te[Ae]);const me=[],Me=new va;for(let Se=0;Se<ue.length;Se++){const Ae=ue[Se];me.push(te[Ae]);const Ve=3*Ae,Ie=Ve+1;Me.emplaceBack(oe.uint16[Ve],oe.uint16[Ie],oe.uint16[Ie+1])}return[me,Me]}(J,ne),this.elevatedGlobeTrianglesCenterLongitudes=J,this.elevatedGlobeIndexBuffer=o.createIndexBuffer(ne)}this.elevatedGlobeSegments=Ti.simpleSegment(0,0,4225,8192),this.elevatedGlobeGridMatrix=new Float32Array([0,H/Wt,0,X/Wt,0,0,R,I,0])}prepare(){const o=Object.keys(this.tiles).length!==0;if(this.tileID&&!o)return;const u=this.map.painter.context,f=u.gl;!this._dirty||this.texture instanceof WC||(this.texture?this.texture.update(this.image):(this.texture=new nI(u,this.image,f.RGBA8),this.texture.bind(f.LINEAR,f.CLAMP_TO_EDGE)),this._dirty=!1),o&&this._prepareData(u)}loadTile(o,u){this.tileID&&this.tileID.equals(o.tileID.canonical)?(this.tiles[String(o.tileID.wrap)]=o,o.buckets={},u(null)):(o.state="errored",u(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}getSegmentsForLongitude(o){const u=this.elevatedGlobeSegments;if(!this.elevatedGlobeTrianglesCenterLongitudes||!u)return null;const f=this.elevatedGlobeTrianglesCenterLongitudes;let y=(g=o+180)+360*Math.round((f[0]-g)/360);var g;const _=new Ti,T=(M,D)=>{_.segments.push({vertexOffset:0,primitiveOffset:M,vertexLength:u.segments[0].vertexLength,primitiveLength:D,sortKey:void 0,vaos:{}})},E=.51*this.maxLongitudeTriangleSize;if(Math.abs(f[0]-y)<=E){const M=Hm(f,0,f.length,y+E);return M===f.length||T(M,Ih(f,M+1,f.length,y+360-E)-M),_}y<f[0]&&(y+=360);const O=Ih(f,0,f.length,y-E);if(O===f.length)return T(0,f.length),_;T(0,O-0);const C=Hm(f,O+1,f.length,y+E);return C!==f.length&&T(C,f.length-C),_}}const Ife=(Math.pow(256,2)-1)/16907520;class qV extends ua{constructor(o,u,f,y){super(o,{layout:VV||(VV=new Ki({visibility:new Vt(ut.layout_raster.visibility)})),paint:UV||(UV=new Ki({"raster-opacity":new Vt(ut.paint_raster["raster-opacity"]),"raster-color":new bf(ut.paint_raster["raster-color"]),"raster-color-mix":new Vt(ut.paint_raster["raster-color-mix"]),"raster-color-range":new Vt(ut.paint_raster["raster-color-range"]),"raster-hue-rotate":new Vt(ut.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Vt(ut.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Vt(ut.paint_raster["raster-brightness-max"]),"raster-saturation":new Vt(ut.paint_raster["raster-saturation"]),"raster-contrast":new Vt(ut.paint_raster["raster-contrast"]),"raster-resampling":new Vt(ut.paint_raster["raster-resampling"]),"raster-fade-duration":new Vt(ut.paint_raster["raster-fade-duration"]),"raster-emissive-strength":new Vt(ut.paint_raster["raster-emissive-strength"]),"raster-array-band":new Vt(ut.paint_raster["raster-array-band"]),"raster-elevation":new Vt(ut.paint_raster["raster-elevation"]),"raster-color-use-theme":new ar({type:"string",default:"default","property-type":"data-driven"})}))},u,f,y),this.updateColorRamp(),this._curRampRange=[NaN,NaN]}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}tileCoverLift(){return this.paint.get("raster-elevation")}isDraped(o){return!(o&&o._source instanceof HV&&(o._source.onNorthPole||o._source.onSouthPole))&&this.paint.get("raster-elevation")===0}_handleSpecialPaintPropertyUpdate(o){o!=="raster-color"&&o!=="raster-color-range"||(this._curRampRange=[NaN,NaN],this.updateColorRamp())}updateColorRamp(o){if(!this.hasColorMap()||!this._curRampRange)return;const u=this._transitionablePaint._values["raster-color"].value.expression,[f,y]=o||this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0})||[NaN,NaN];isNaN(f)&&isNaN(y)||f===this._curRampRange[0]&&y===this._curRampRange[1]||(this.colorRamp=aw({expression:u,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:f,end:y}],resolution:256}),this.colorRampTexture=null,this._curRampRange=[f,y])}}let WV,KV,ZV,YV,XV;class JV extends ua{constructor(o,u,f,y){super(o,{layout:WV||(WV=new Ki({visibility:new Vt(ut["layout_raster-particle"].visibility)})),paint:KV||(KV=new Ki({"raster-particle-array-band":new Vt(ut["paint_raster-particle"]["raster-particle-array-band"]),"raster-particle-count":new Vt(ut["paint_raster-particle"]["raster-particle-count"]),"raster-particle-color":new bf(ut["paint_raster-particle"]["raster-particle-color"]),"raster-particle-max-speed":new Vt(ut["paint_raster-particle"]["raster-particle-max-speed"]),"raster-particle-speed-factor":new Vt(ut["paint_raster-particle"]["raster-particle-speed-factor"]),"raster-particle-fade-opacity-factor":new Vt(ut["paint_raster-particle"]["raster-particle-fade-opacity-factor"]),"raster-particle-reset-rate-factor":new Vt(ut["paint_raster-particle"]["raster-particle-reset-rate-factor"]),"raster-particle-elevation":new Vt(ut["paint_raster-particle"]["raster-particle-elevation"]),"raster-particle-color-use-theme":new ar({type:"string",default:"default","property-type":"data-driven"})}))},u,f,y),this._updateColorRamp(),this.lastInvalidatedAt=vt.now()}onRemove(o){this.colorRampTexture&&this.colorRampTexture.destroy(),this.tileFramebuffer&&this.tileFramebuffer.destroy(),this.particleFramebuffer&&this.particleFramebuffer.destroy()}hasColorMap(){return!!this._transitionablePaint._values["raster-particle-color"].value.value}getProgramIds(){return["rasterParticle"]}hasOffscreenPass(){return this.visibility!=="none"}isDraped(o){return!1}_handleSpecialPaintPropertyUpdate(o){o!=="raster-particle-color"&&o!=="raster-particle-max-speed"||(this._updateColorRamp(),this._invalidateAnimationState()),o==="raster-particle-count"&&this._invalidateAnimationState()}_updateColorRamp(){if(!this.hasColorMap())return;const o=this._transitionablePaint._values["raster-particle-color"].value.expression,u=this._transitionablePaint._values["raster-particle-max-speed"].value.expression.evaluate({zoom:0});this.colorRamp=aw({expression:o,evaluationKey:"rasterParticleSpeed",image:this.colorRamp,clips:[{start:0,end:u}],resolution:256}),this.colorRampTexture=null}_invalidateAnimationState(){this.lastInvalidatedAt=vt.now()}tileCoverLift(){return this.paint.get("raster-particle-elevation")}}class Ofe extends ua{constructor(o,u){super(o,{},u,null),this.implementation=o,o.slot&&(this.slot=o.slot)}is3D(o){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isDraped(o){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(o){this.implementation.onAdd&&this.implementation.onAdd(o,o.painter.context.gl)}onRemove(o){this.implementation.onRemove&&this.implementation.onRemove(o,o.painter.context.gl)}}function iI(m,o,u){const f=[0,0,1],y=ge.quat.identity([]);return ge.quat.rotateY(y,y,u?-Ye(m)+Math.PI:Ye(m)),ge.quat.rotateX(y,y,-Ye(o)),ge.vec3.transformQuat(f,f,y),ge.vec3.normalize(f,f)}function QV(m,o){const u=YC(m.projection,m.zoom,m.width,m.height),f=function(g,_,T,E,O){const C=new $n(T.lng-180*Df,T.lat),M=new $n(T.lng+180*Df,T.lat),D=g.project(C.lng,C.lat),I=g.project(M.lng,M.lat),R=-Math.atan2(I.y-D.y,I.x-D.x),H=c.fromLngLat(T);H.y=rr(H.y,-1+Df,1-Df);const X=H.toLngLat(),J=g.project(X.lng,X.lat),ne=c.fromLngLat(X);ne.x+=Df;const re=ne.toLngLat(),te=g.project(re.lng,re.lat),oe=t7(te.x-J.x,te.y-J.y,R),ue=c.fromLngLat(X);ue.y+=Df;const me=ue.toLngLat(),Me=g.project(me.lng,me.lat),Se=t7(Me.x-J.x,Me.y-J.y,R),Ae=Math.abs(oe.x)/Math.abs(Se.y),Ve=ge.mat4.identity([]);ge.mat4.rotateZ(Ve,Ve,-R*(1-(O?0:E)));const Ie=ge.mat4.identity([]);return ge.mat4.scale(Ie,Ie,[1,1-(1-Ae)*E,1]),Ie[4]=-Se.x/Se.y*E,ge.mat4.rotateZ(Ie,Ie,R),ge.mat4.multiply(Ie,Ve,Ie),Ie}(m.projection,0,m.center,u,o),y=e7(m);return ge.mat4.scale(f,f,[y,y,1]),f}function e7(m){const o=m.projection,u=YC(m.projection,m.zoom,m.width,m.height),f=sI(o,m.center),y=sI(o,$n.convert(o.center));return Math.pow(2,f*u+(1-u)*y)}function YC(m,o,u,f,y=1/0){const g=m.range;if(!g)return 0;const _=Math.min(y,Math.max(u,f)),T=Math.log(_/1024)/Math.LN2;return an(g[0]+T,g[1]+T,o)}const Df=1/4e4;function sI(m,o){const u=rr(o.lat,-ds,ds),f=new $n(o.lng-180*Df,u),y=new $n(o.lng+180*Df,u),g=m.project(f.lng,u),_=m.project(y.lng,u),T=c.fromLngLat(f),E=c.fromLngLat(y),O=_.x-g.x,C=_.y-g.y,M=E.x-T.x,D=E.y-T.y,I=Math.sqrt((M*M+D*D)/(O*O+C*C));return Math.log(I)/Math.LN2}function t7(m,o,u){const f=Math.cos(u),y=Math.sin(u);return{x:m*f-o*y,y:m*y+o*f}}function r7(m,o,u){ge.mat4.identity(m),ge.mat4.rotateZ(m,m,Ye(o[2])),ge.mat4.rotateX(m,m,Ye(o[0])),ge.mat4.rotateY(m,m,Ye(o[1])),ge.mat4.scale(m,m,u),ge.mat4.multiply(m,m,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function XC(m,o,u,f,y,g,_,T){const E=[u[0]-o[0],u[1]-o[1],0],O=[f[0]-o[0],f[1]-o[1],0];if(ge.vec3.length(E)<1e-12||ge.vec3.length(O)<1e-12)return ge.quat.identity(m);const C=ge.vec3.cross([],E,O);ge.vec3.normalize(C,C),ge.vec3.subtract(O,f,o),E[2]=(g-y)*T,O[2]=(_-y)*T;const M=E;return ge.vec3.cross(M,E,O),ge.vec3.normalize(M,M),ge.quat.rotationTo(m,C,M)}function aI(m,o,u=!1){const f=_o(o.zoom),y=function(g,_,T){const E=_.worldSize,O=[g[12],g[13],g[14]],C=ba(O[1]/E),M=Lo(O[0]/E),D=ge.mat4.identity([]),I=Pa(1,C)*E,R=Pa(1,0)*E*qd(C,_.zoom),H=1/tu(E);let X=R*H;if(T){const te=YC(_.projection,_.zoom,_.width,_.height,1024);X=H*_.projection.pixelSpaceConversion(_.center.lat,E,te)}const J=Kh(C,M);ge.vec3.add(J,J,ge.vec3.scale([],ge.vec3.normalize([],J),I*X*O[2]));const ne=function(te){const oe=[te[0],te[1],te[2]];let ue=[0,1,0];const me=ge.vec3.cross([],ue,oe);return ge.vec3.cross(ue,oe,me),ge.vec3.squaredLength(ue)===0&&(ue=[0,1,0],ge.vec3.cross(me,oe,ue)),ge.vec3.normalize(me,me),ge.vec3.normalize(ue,ue),ge.vec3.normalize(oe,oe),[me[0],me[1],me[2],0,ue[0],ue[1],ue[2],0,oe[0],oe[1],oe[2],0,te[0],te[1],te[2],1]}(J);ge.mat4.scale(D,D,[X,X,X*I]),ge.mat4.translate(D,D,[-O[0],-O[1],-O[2]]);const re=ge.mat4.multiply([],_.globeMatrix,ne);return ge.mat4.multiply(re,re,D),ge.mat4.multiply(re,re,g),re}(m,o,u);if(f>0){const g=function(_,T){const E=T.worldSize,O=Pa(1,0)*E*qd(T.center.lat,T.zoom)/tu(E),C=Pa(1,T.center.lat)*E,M=ge.mat4.identity([]);return ge.mat4.rotateY(M,M,Ye(T.center.lng)),ge.mat4.rotateX(M,M,Ye(T.center.lat)),ge.mat4.translate(M,M,[0,0,oo]),ge.mat4.scale(M,M,[O,O,O*C]),ge.mat4.translate(M,M,[T.point.x-.5*E,T.point.y-.5*E,0]),ge.mat4.multiply(M,M,_),ge.mat4.multiply(M,T.globeMatrix,M)}(m,o);return function(_,T,E){const O=(R,H,X)=>{const J=ge.vec3.length(R),ne=ge.vec3.length(H),re=Qs(R,H,X);return ge.vec3.scale(re,re,1/ge.vec3.length(re)*Mr(J,ne,X))},C=O([_[0],_[1],_[2]],[T[0],T[1],T[2]],E),M=O([_[4],_[5],_[6]],[T[4],T[5],T[6]],E),D=O([_[8],_[9],_[10]],[T[8],T[9],T[10]],E),I=Qs([_[12],_[13],_[14]],[T[12],T[13],T[14]],E);return[C[0],C[1],C[2],0,M[0],M[1],M[2],0,D[0],D[1],D[2],0,I[0],I[1],I[2],1]}(y,g,f)}return y}function n7(m,o,u,f){const y=xr.projectAabbCorners(f,u);let g=Number.MAX_VALUE,_=-1;for(let O=0;O<y.length;++O){const C=y[O];C[0]=(.5*C[0]+.5)*o.width,C[1]=(.5-.5*C[1])*o.height,C[2]<g&&(_=O,g=C[2])}const T=O=>new dt(y[O][0],y[O][1]);let E;switch(_){case 0:case 6:E=[T(1),T(5),T(4),T(7),T(3),T(2),T(1)];break;case 1:case 7:E=[T(0),T(4),T(5),T(6),T(2),T(3),T(0)];break;case 3:case 5:E=[T(1),T(0),T(4),T(7),T(6),T(2),T(1)];break;default:E=[T(1),T(5),T(6),T(7),T(3),T(0),T(1)]}if(de(m,E))return g}const Rfe=Bn([{name:"a_pos_3f",components:3,type:"Float32"}]),Dfe=Bn([{name:"a_color_3f",components:3,type:"Float32"}]),zfe=Bn([{name:"a_color_4f",components:4,type:"Float32"}]),Lfe=Bn([{name:"a_uv_2f",components:2,type:"Float32"}]),Ffe=Bn([{name:"a_normal_3f",components:3,type:"Float32"}]),Bfe=Bn([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),$fe=Bn([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]),i7={None:0,Model:1,Symbol:2,FillExtrusion:4,All:7};class JC{constructor(o,u,f,y){this.message=(o?`${o}: `:"")+f,y&&(this.identifier=y),u!=null&&u.__line__&&(this.line=u.__line__)}}function s7(m,o){const u=m.indexOf("://")===-1;try{return new URL(m,u&&o?"http://example.com":void 0),!0}catch{return!1}}class a7{constructor(o,u){this.feature=o,this.instancedDataOffset=u,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class o7{constructor(){this.instancedDataArray=new yy,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class oI{constructor(o){this.zoom=o.zoom,this.canonical=o.canonical,this.layers=o.layers,this.layerIds=this.layers.map(u=>u.fqid),this.projection=o.projection,this.index=o.index,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0},this.modelUris=[],this.modelsRequested=!1,this.activeReplacements=[],this.replacementUpdateTime=0}updateFootprints(o,u){}populate(o,u,f,y){this.tileToMeter=b(f);const g=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:_,id:T,index:E,sourceLayerIndex:O}of o){const C=T??(_.properties&&_.properties.hasOwnProperty("id")?_.properties.id:void 0),M=Y(_,g);if(!this.layers[0]._featureFilter.filter(new hi(this.zoom),M,f))continue;const D={id:C,sourceLayerIndex:O,index:E,geometry:g?M.geometry:K(_,f,y),properties:_.properties,type:_.type,patterns:{}},I=this.addFeature(D,D.geometry,M);I&&u.featureIndex.insert(_,D.geometry,E,O,this.index,this.instancesPerModel[I].instancedDataArray.length,Wt/32)}this.lookup=null}update(o,u,f,y){for(const g in this.instancesPerModel){const _=this.instancesPerModel[g];for(const T in o)_.idToFeaturesIndex.hasOwnProperty(T)&&(this.evaluate(_.features[_.idToFeaturesIndex[T]],o[T],_,!0),this.uploaded=!1)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let o=!1;for(const u in this.instancesPerModel){const f=this.instancesPerModel[u];for(const y of f.features){const g=this.layers[0],_=y.feature,T=this.canonical,E=g.paint.get("model-rotation").evaluate(_,{},T),O=g.paint.get("model-scale").evaluate(_,{},T),C=g.paint.get("model-translation").evaluate(_,{},T);ge.vec3.exactEquals(y.rotation,E)&&ge.vec3.exactEquals(y.scale,O)&&ge.vec3.exactEquals(y.translation,C)||(this.evaluate(y,y.featureStates,f,!0),o=!0)}}return o}updateReplacement(o,u,f,y){if(u.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=u.updateTime;const g=u.getReplacementRegionsForTile(o.toUnwrapped(),!0);if(M4(this.activeReplacements,g))return!1;this.activeReplacements=g;let _=!1;for(const T in this.instancesPerModel){const E=this.instancesPerModel[T],O=E.instancedDataArray;for(const C of E.features){const M=C.instancedDataOffset,D=C.instancedDataCount;for(let I=0;I<D;I++){const R=16*(I+M);let H=O.float32[R+0];const X=H>Wt;H=X?H-Wt:H;const J=Math.floor(H),ne=O.float32[R+1];let re=!1;for(const te of this.activeReplacements)if(!g8(te,f,i7.Model,y)&&!(te.min.x>J||J>te.max.x||te.min.y>ne||ne>te.max.y)&&(re=w8(_8(J,ne,o.canonical,te.footprintTileId.canonical),te.footprint),re))break;O.float32[R]=re?H+Wt:H,_=_||re!==X}}}return _}isEmpty(){for(const o in this.instancesPerModel)if(this.instancesPerModel[o].instancedDataArray.length!==0)return!1;return!0}uploadPending(){return!this.uploaded}upload(o){if(!this.uploaded)for(const u in this.instancesPerModel){const f=this.instancesPerModel[u];f.instancedDataArray.length<0||f.instancedDataArray.length===0||(f.instancedDataBuffer?f.instancedDataBuffer.updateData(f.instancedDataArray):f.instancedDataBuffer=o.createVertexBuffer(f.instancedDataArray,Bfe.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(const u in this.instancesPerModel){const f=this.instancesPerModel[u];f.instancedDataArray.length!==0&&f.instancedDataBuffer&&f.instancedDataBuffer.destroy()}const o=this.layers[0].modelManager;if(o&&this.modelUris)for(const u of this.modelUris)o.removeModel(u,"")}addFeature(o,u,f){const y=this.layers[0],g=y.layout.get("model-id").evaluate(f,{},this.canonical);if(!g)return _i(`modelId is not evaluated for layer ${y.id} and it is not going to get rendered.`),g;s7(g,!1)&&(this.modelUris.includes(g)||this.modelUris.push(g)),this.instancesPerModel[g]||(this.instancesPerModel[g]=new o7);const _=this.instancesPerModel[g],T=_.instancedDataArray,E=new a7(f,T.length);for(const O of u)for(const C of O){if(C.x<0||C.x>=Wt||C.y<0||C.y>=Wt)continue;const M=(this.lookupDim-1)/Wt,D=this.lookupDim*(C.y*M|0)+C.x*M|0;if(this.lookup){if(this.lookup[D]!==0)continue;this.lookup[D]=1}this.instanceCount++;const I=T.length;T.resize(I+1),_.instancesEvaluatedElevation.push(0),T.float32[16*I]=C.x,T.float32[16*I+1]=C.y}return E.instancedDataCount=_.instancedDataArray.length-E.instancedDataOffset,E.instancedDataCount>0&&(o.id&&(_.idToFeaturesIndex[o.id]=_.features.length),_.features.push(E),this.evaluate(E,{},_,!1)),g}getModelUris(){return this.modelUris}evaluate(o,u,f,y){const g=this.layers[0],_=o.feature,T=this.canonical,E=o.rotation=g.paint.get("model-rotation").evaluate(_,u,T),O=o.scale=g.paint.get("model-scale").evaluate(_,u,T),C=o.translation=g.paint.get("model-translation").evaluate(_,u,T),M=g.paint.get("model-color").evaluate(_,u,T);M.a=g.paint.get("model-color-mix-intensity").evaluate(_,u,T);const D=[];this.maxVerticalOffset<C[2]&&(this.maxVerticalOffset=C[2]),this.maxScale=Math.max(Math.max(this.maxScale,O[0]),Math.max(O[1],O[2])),r7(D,E,O);const I=Math.round(100*M.a)+M.b/1.05;for(let R=0;R<o.instancedDataCount;++R){const H=o.instancedDataOffset+R,X=16*H,J=f.instancedDataArray.float32;let ne=0;y&&(ne=J[X+6]-f.instancesEvaluatedElevation[H]);const re=0|J[X+1];J[X]=(0|J[X])+M.r/1.05,J[X+1]=re+M.g/1.05,J[X+2]=I,J[X+3]=1/(T.z>10?this.tileToMeter:b(T,re)),J[X+4]=C[0],J[X+5]=C[1],J[X+6]=C[2]+ne,J[X+7]=D[0],J[X+8]=D[1],J[X+9]=D[2],J[X+10]=D[4],J[X+11]=D[5],J[X+12]=D[6],J[X+13]=D[8],J[X+14]=D[9],J[X+15]=D[10],f.instancesEvaluatedElevation[H]=C[2]}}}let l7,c7;lr(oI,"ModelBucket",{omit:["layers"]}),lr(o7,"PerModelAttributes"),lr(a7,"ModelFeature");const n0=64,Iy={CoordinateSpaceTile:1,CoordinateSpaceYUp:2,HasMapboxMeshFeatures:4,HasMeshoptCompression:8};function u7(m,o,u,f,y,g,_,T,E,O=!1){const C=u.zoom,M=u.project(f),D=qd(f.lat,C),I=1/D;ge.mat4.identity(m),ge.mat4.translate(m,m,[M.x+_[0]*I,M.y+_[1]*I,_[2]]);let R=1,H=1;const X=u.worldSize;if(O){if(u.projection.name==="mercator"){let te=0;u.elevation&&(te=u.elevation.getAtPointOrZero(new c(M.x/X,M.y/X),0));const oe=ge.vec4.transformMat4([],[M.x,M.y,te,1],u.projMatrix)[3]/u.cameraToCenterDistance;R=oe,H=oe*qd(u.center.lat,C)}else if(u.projection.name==="globe"){const te=aI(m,u),oe=ge.mat4.multiply([],u.projMatrix,te),ue=[0,0,0,1];ge.vec4.transformMat4(ue,ue,oe);const me=ue[3]/u.cameraToCenterDistance,Me=_o(C),Se=u.projection.pixelsPerMeter(f.lat,X)*qd(f.lat,C),Ae=u.projection.pixelsPerMeter(u.center.lat,X)*qd(u.center.lat,C);R=me/Mr(Se,_C(u.center.lat),Me),H=me*D/Se,R*=Ae,H*=Ae}}else R=I;ge.mat4.scale(m,m,[R,R,H]);const J=[...m],ne=o.orientation,re=[];if(r7(re,[ne[0]+y[0],ne[1]+y[1],ne[2]+y[2]],g),ge.mat4.multiply(m,J,re),T&&u.elevation){let te=0;const oe=[];if(E&&u.elevation){te=function(Me,Se,Ae,Ve,Ie){const Ge=Se.elevation;if(!Ge)return 0;const Ze=xr.projectAabbCorners(Ae,Ve),We=Pa(1,Ie.lat)*Se.worldSize,Qe=function(Pr,ir){const pr=[0,0,1],Lr=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const on of Lr){const $r=Pr[on.corners[0]],fn=Pr[on.corners[1]],sn=Pr[on.corners[2]],pn=[fn[0]-$r[0],fn[1]-$r[1],ir*(fn[2]-$r[2])],Rn=ge.vec3.cross(pn,pn,[sn[0]-$r[0],sn[1]-$r[1],ir*(sn[2]-$r[2])]);ge.vec3.normalize(Rn,Rn),on.dotProductWithUp=ge.vec3.dot(Rn,pr)}return Lr.sort((on,$r)=>on.dotProductWithUp-$r.dotProductWithUp),Lr[0].corners}(Ze,We),Je=Ze[Qe[0]],ot=Ze[Qe[1]],nt=Ze[Qe[2]],ct=Ze[Qe[3]],Ot=Ge.getAtPointOrZero(new c(Je[0]/Se.worldSize,Je[1]/Se.worldSize),0),Mt=Ge.getAtPointOrZero(new c(ot[0]/Se.worldSize,ot[1]/Se.worldSize),0),cr=Ge.getAtPointOrZero(new c(nt[0]/Se.worldSize,nt[1]/Se.worldSize),0),Lt=Ge.getAtPointOrZero(new c(ct[0]/Se.worldSize,ct[1]/Se.worldSize),0),Gt=(Ot+Lt)/2,Rt=(Mt+cr)/2;return Gt>Rt?Mt<cr?XC(Me,ot,ct,Je,Mt,Lt,Ot,We):XC(Me,nt,Je,ct,cr,Ot,Lt,We):Ot<Lt?XC(Me,Je,ot,nt,Ot,Mt,cr,We):XC(Me,ct,nt,ot,Lt,cr,Mt,We),Math.max(Gt,Rt)}(oe,u,o.aabb,m,f);const ue=ge.mat4.fromQuat([],oe),me=ge.mat4.multiply([],ue,re);ge.mat4.multiply(m,J,me)}else te=u.elevation.getAtPointOrZero(new c(M.x/X,M.y/X),0);te!==0&&(m[14]+=te)}}function Cw(m,o,u=!1){m.uploaded||(m.gfxTexture=new nI(o,m.image,u?o.gl.R8:o.gl.RGBA8,{useMipmap:m.sampler.minFilter>=o.gl.NEAREST_MIPMAP_NEAREST}),m.uploaded=!0,m.image=null)}function Vfe(m,o,u){m.indexBuffer=o.createIndexBuffer(m.indexArray,!1,!0),m.vertexBuffer=o.createVertexBuffer(m.vertexArray,Rfe.members,!1,!0),m.normalArray&&(m.normalBuffer=o.createVertexBuffer(m.normalArray,Ffe.members,!1,!0)),m.texcoordArray&&(m.texcoordBuffer=o.createVertexBuffer(m.texcoordArray,Lfe.members,!1,!0)),m.colorArray&&(m.colorBuffer=o.createVertexBuffer(m.colorArray,(m.colorArray.bytesPerElement===12?Dfe:zfe).members,!1,!0)),m.featureArray&&(m.pbrBuffer=o.createVertexBuffer(m.featureArray,$fe.members,!0)),m.segments=Ti.simpleSegment(0,0,m.vertexArray.length,m.indexArray.length);const f=m.material;f.pbrMetallicRoughness.baseColorTexture&&Cw(f.pbrMetallicRoughness.baseColorTexture,o),f.pbrMetallicRoughness.metallicRoughnessTexture&&Cw(f.pbrMetallicRoughness.metallicRoughnessTexture,o),f.normalTexture&&Cw(f.normalTexture,o),f.occlusionTexture&&Cw(f.occlusionTexture,o,u),f.emissionTexture&&Cw(f.emissionTexture,o)}function lI(m,o,u){if(m.meshes)for(const f of m.meshes)Vfe(f,o,u);if(m.children)for(const f of m.children)lI(f,o,u)}function QC(m){if(m.meshes)for(const o of m.meshes)o.indexArray.destroy(),o.vertexArray.destroy(),o.colorArray&&o.colorArray.destroy(),o.normalArray&&o.normalArray.destroy(),o.texcoordArray&&o.texcoordArray.destroy(),o.featureArray&&o.featureArray.destroy();if(m.children)for(const o of m.children)QC(o)}function cI(m){if(m.meshes)for(const u of m.meshes)u.vertexBuffer&&(u.vertexBuffer.destroy(),u.indexBuffer.destroy(),u.normalBuffer&&u.normalBuffer.destroy(),u.texcoordBuffer&&u.texcoordBuffer.destroy(),u.colorBuffer&&u.colorBuffer.destroy(),u.pbrBuffer&&u.pbrBuffer.destroy(),u.segments.destroy(),u.material&&((o=u.material).pbrMetallicRoughness.baseColorTexture&&o.pbrMetallicRoughness.baseColorTexture.gfxTexture&&o.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),o.pbrMetallicRoughness.metallicRoughnessTexture&&o.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&o.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),o.normalTexture&&o.normalTexture.gfxTexture&&o.normalTexture.gfxTexture.destroy(),o.emissionTexture&&o.emissionTexture.gfxTexture&&o.emissionTexture.gfxTexture.destroy(),o.occlusionTexture&&o.occlusionTexture.gfxTexture&&o.occlusionTexture.gfxTexture.destroy()));var o;if(m.children)for(const u of m.children)cI(u)}class Oy{constructor(o,u,f){this._demTile=o,this._dem=this._demTile.dem,this._scale=u,this._offset=f}static create(o,u,f){const y=f||o.findDEMTileFor(u);if(!y||!y.dem)return;const g=y.dem,_=y.tileID,T=1<<u.canonical.z-_.canonical.z;return new Oy(y,g.dim/Wt/T,[(u.canonical.x/T-_.canonical.x)*g.dim,(u.canonical.y/T-_.canonical.y)*g.dim])}tileCoordToPixel(o,u){const f=u*this._scale+this._offset[1],y=Math.floor(o*this._scale+this._offset[0]),g=Math.floor(f);return new dt(y,g)}getElevationAt(o,u,f,y){const g=o*this._scale+this._offset[0],_=u*this._scale+this._offset[1],T=Math.floor(g),E=Math.floor(_),O=this._dem;return y=!!y,f?Mr(Mr(O.get(T,E,y),O.get(T,E+1,y),_-E),Mr(O.get(T+1,E,y),O.get(T+1,E+1,y),_-E),g-T):O.get(T,E,y)}getElevationAtPixel(o,u,f){return this._dem.get(o,u,!!f)}getMeterToDEM(o){return(1<<this._demTile.tileID.canonical.z)*Pa(1,o)*this._dem.stride}}const uI=new Float32Array(262144),i0=new Uint8Array(262144);function d7(m){let o=0;if(m.meshes)for(const u of m.meshes)o=Math.max(o,u.aabb.max[2]);if(m.children)for(const u of m.children)o=Math.max(o,d7(u));return o}function h7(m,o,u){if(m.meshes)for(const f of m.meshes){if(f.aabb.min[0]===1/0)continue;const y=xr.applyTransform(f.aabb,m.matrix);u.insert(o,y.min[0],y.min[1],y.max[0],y.max[1])}if(m.children)for(const f of m.children)h7(f,o,u)}const m7=["","wall","door","roof","window","lamp","logo"];class f7{constructor(o){this.node=o,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.cameraCollisionOpacity=1,this.feature={type:"Point",id:o.id,geometry:[],properties:{height:d7(o)}},this.aabb=this._getLocalBounds(),this.state=null}_getLocalBounds(){if(!this.node.meshes)return new xr([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);if(!this.aabb){let o=0;const u=new xr([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);for(const f of this.node.meshes)this.node.lightMeshIndex!==o&&(f.transformedAabb=xr.applyTransformFast(f.aabb,this.node.matrix),u.encapsulate(f.transformedAabb)),o++;this.aabb=u}return this.aabb}}class eA{constructor(o,u,f,y,g,_,T){this.id=f,this.layers=o,this.layerIds=this.layers.map(E=>E.fqid),this.stateDependentLayerIds=this.layers.filter(E=>E.isStateDependent()).map(E=>E.id),this.modelTraits|=Iy.CoordinateSpaceTile,this.uploaded=!1,this.hasPattern=!1,y&&(this.modelTraits|=Iy.HasMapboxMeshFeatures),g&&(this.modelTraits|=Iy.HasMeshoptCompression),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=_,this.dirty=!0,this.needsUpload=!1,this.filter=null,this.nodesInfo=[];for(const E of u)this.nodesInfo.push(new f7(E)),h7(E,T.featureIndexArray.length,T.grid),T.featureIndexArray.emplaceBack(this.nodesInfo.length-1,0,T.bucketLayerIDs.length-1,0);this.states={}}updateFootprints(o,u){for(const f of this.getNodesInfo()){const y=f.node;y.footprint&&u.push({footprint:y.footprint,id:o})}}update(o){const u=Object.keys(o).length!==0;if(u&&!this.stateDependentLayers.length)return;const f=u?this.stateDependentLayers:this.layers;if(!Yr(o,this.states))for(const y of f)this.evaluate(y,o);this.states=structuredClone(o)}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(o){if(!this.needsUpload)return;const u=this.getNodesInfo();for(const f of u){const y=f.node;this.uploaded?this.updatePbrBuffer(y):lI(y,o,!0)}for(const f of u)QC(f.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(o){let u=!1;if(!o.meshes)return u;for(const f of o.meshes)f.pbrBuffer&&(f.pbrBuffer.updateData(f.featureArray),u=!0);return u}needsReEvaluation(o,u,f){const y=o.transform.projectionOptions,g=o.style.getBrightness(),_=this.brightness!==g;if(!this.uploaded||this.dirty||y.name!==this.projection.name||Aw(f.paint.get("model-color").value,_)||Aw(f.paint.get("model-color-mix-intensity").value,_)||Aw(f.paint.get("model-roughness").value,_)||Aw(f.paint.get("model-emissive-strength").value,_)||Aw(f.paint.get("model-height-based-emissive-strength-multiplier").value,_)){this.projection=y,this.brightness=g;const T=this.getNodesInfo();for(const E of T)E.state=null;return!0}return!1}evaluateScale(o,u){if(o.transform.zoom===this.zoom)return;this.zoom=o.transform.zoom;const f=this.getNodesInfo(),y=this.id.canonical;for(const g of f){const _=g.feature;g.evaluatedScale=u.paint.get("model-scale").evaluate(_,{},y)}}evaluate(o,u){const f=this.getNodesInfo();for(const y of f){if(!y.node.meshes)continue;const g=y.feature,_=u&&u[g.id];if(Yr(_,y.state))continue;y.state=structuredClone(_);const T=y.node.meshes&&y.node.meshes[0].featureData,E=y.evaluatedColor[2],O=y.evaluatedRMEA[2],C=this.id.canonical;if(y.hasTranslucentParts=!1,T){for(let M=0;M<m7.length;M++){const D=m7[M];D.length&&(g.properties.part=D);const I=o.paint.get("model-color").evaluate(g,_,C).toRenderColor(null),R=o.paint.get("model-color-mix-intensity").evaluate(g,_,C);y.evaluatedColor[M]=[I.r,I.g,I.b,R],y.evaluatedRMEA[M][0]=o.paint.get("model-roughness").evaluate(g,_,C),y.evaluatedRMEA[M][2]=o.paint.get("model-emissive-strength").evaluate(g,_,C),y.evaluatedRMEA[M][3]=I.a,y.emissionHeightBasedParams[M]=o.paint.get("model-height-based-emissive-strength-multiplier").evaluate(g,_,C),!y.hasTranslucentParts&&I.a<1&&(y.hasTranslucentParts=!0)}delete g.properties.part,Gfe(y,E!==y.evaluatedColor[2]||O!==y.evaluatedRMEA[2],this.modelTraits)}else y.evaluatedRMEA[0][2]=o.paint.get("model-emissive-strength").evaluate(g,_,C);y.evaluatedScale=o.paint.get("model-scale").evaluate(g,_,C),this.updatePbrBuffer(y.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(o,u,f,y){const g=o.findDEMTileFor(f);if(g&&(g.tileID.canonical!==this.terrainTile||u!==this.terrainExaggeration)){if(g.dem&&g.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=g.tileID.overscaledZ;const _=Oy.create(o,f,g);if(!_)return;this.modelTraits&Iy.HasMapboxMeshFeatures&&this.updateDEM(o,_,f,y);for(const T of this.getNodesInfo()){const E=T.node;if(!E.footprint||!E.footprint.vertices||!E.footprint.vertices.length)continue;const O=E.footprint.vertices;let C=_.getElevationAt(O[0].x,O[0].y,!0,!0);for(let M=1;M<O.length;M++)C=Math.min(C,_.getElevationAt(O[M].x,O[M].y,!0,!0));E.elevation=C}}this.terrainTile=g.tileID.canonical,this.terrainExaggeration=u}}updateDEM(o,u,f,y){let g=u._dem._modifiedForSources[y];if(g===void 0&&(u._dem._modifiedForSources[y]=[],g=u._dem._modifiedForSources[y]),g.includes(f.canonical))return;const _=u._dem.dim;g.push(f.canonical);let T=!1;for(const E of this.getNodesInfo()){const O=E.node;if(!O.footprint||!O.footprint.grid)continue;const C=O.footprint.grid,M=u.tileCoordToPixel(C.min.x,C.min.y),D=u.tileCoordToPixel(C.max.x,C.max.y),I=Math.min(Math.min(_-D.y,M.x),Math.min(M.y,_-D.x));if(I<0)continue;const R=rr(I,2,5);let H=Math.max(0,M.x-R),X=Math.max(0,M.y-R),J=Math.min(D.x+R,_-1),ne=Math.min(D.y+R,_-1);for(let ue=X;ue<=ne;++ue)for(let me=H;me<=J;++me)i0[ue*_+me]=255;let re=0,te=0;for(let ue=0;ue<C.cellsY;++ue)for(let me=0;me<C.cellsX;++me){if(!C.cells[ue*C.cellsX+me])continue;const Me=u.tileCoordToPixel(C.min.x+me/C.xScale,C.min.y+ue/C.yScale),Se=u.tileCoordToPixel(C.min.x+(me+1)/C.xScale,C.min.y+(ue+1)/C.yScale);for(let Ae=Me.y;Ae<=Math.min(Se.y+1,_-1);++Ae)for(let Ve=Me.x;Ve<=Math.min(Se.x+1,_-1);++Ve)i0[Ae*_+Ve]===255&&(i0[Ae*_+Ve]=0,re+=u.getElevationAtPixel(Ve,Ae),te++)}const oe=re/te;H=Math.max(1,M.x-R),X=Math.max(1,M.y-R),J=Math.min(D.x+R,_-2),ne=Math.min(D.y+R,_-2),T=!0;for(let ue=X;ue<=ne;++ue)for(let me=H;me<=J;++me)i0[ue*_+me]===0&&(uI[ue*_+me]=u._dem.set(me,ue,oe));for(let ue=1;ue<R;++ue){H=Math.max(1,M.x-ue),X=Math.max(1,M.y-ue),J=Math.min(D.x+ue,_-2),ne=Math.min(D.y+ue,_-2);for(let me=X;me<=ne;++me)for(let Me=H;Me<=J;++Me){const Se=me*_+Me;if(i0[Se]===255){let Ae=0,Ve=0,Ie=-1,Ge=-1;for(let Ze=-1;Ze<=1;++Ze)for(let We=-1;We<=1;++We){const Qe=(me+Ze)*_+Me+We;if(i0[Qe]>=ue)continue;const Je=uI[Qe],ot=Math.abs(Je);ot>Ve&&(Ae=Je,Ve=ot,Ie=We,Ge=Ze)}if(Ve>.1){const Ze=1-(ue+.5*Math.abs(Ie*Ge))/R;let We=u._dem.get(Me,me)+Ae*Ze;const Qe=u._dem.get(Me+Ie,me+Ge),Je=u._dem.get(Me-Ie,me-Ge,!0);(We-Qe)*(We-Je)>0&&(We=(Qe+Je)/2),uI[Se]=u._dem.set(Me,me,We),i0[Se]=ue}}}}}T&&(u._demTile.needsDEMTextureUpload=!0,u._dem._timestamp=vt.now())}setFilter(o){this.filter=o?D1(o):null}getNodesInfo(){return this.filter?this.nodesInfo.filter(o=>this.filter.filter(new hi(this.id.overscaledZ),o.feature,this.id.canonical)):this.nodesInfo}destroy(){const o=this.getNodesInfo();for(const u of o)QC(u.node),cI(u.node)}isEmpty(){return!this.nodesInfo.length}updateReplacement(o,u){if(u.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=u.updateTime;const f=u.getReplacementRegionsForTile(o.toUnwrapped()),y=this.getNodesInfo();for(let g=0;g<this.nodesInfo.length;g++){const _=y[g].node;y[g].hiddenByReplacement=!!_.footprint&&!f.find(T=>T.footprint===_.footprint)}}getHeightAtTileCoord(o,u){const f=this.getNodesInfo(),y=[],g=[0,0,0],_=ge.mat4.identity([]);for(let T=0;T<this.nodesInfo.length;T++){const E=f[T],O=E.node.meshes[0],C=O.transformedAabb;if(o<C.min[0]||u<C.min[1]||o>C.max[0]||u>C.max[1])continue;if(E.node.hidden===!0)return{height:1/0,maxHeight:E.feature.properties.height,hidden:!1,verticalScale:E.evaluatedScale[2]};ge.mat4.invert(_,E.node.matrix),g[0]=o,g[1]=u,ge.vec3.transformMat4(g,g,_);const M=(g[0]-O.aabb.min[0])/(O.aabb.max[0]-O.aabb.min[0])*n0|0,D=Math.min(63,(g[1]-O.aabb.min[1])/(O.aabb.max[1]-O.aabb.min[1])*n0|0)*n0+Math.min(63,M),I=O.heightmap[D];if(!(I<0&&E.node.footprint))return E.hiddenByReplacement?void 0:{height:I,maxHeight:E.feature.properties.height,hidden:!1,verticalScale:E.evaluatedScale[2]};if(E.node.footprint.grid.query(new dt(o,u),new dt(o,u),y),y.length>0)return{height:void 0,maxHeight:E.feature.properties.height,hidden:E.hiddenByReplacement,verticalScale:E.evaluatedScale[2]}}}}function Aw(m,o){return!m.isLightConstant&&o}function Ufe(m,o,u,f,y,g,_,T){let E=(61440&o|(61440&o)>>4)>>8,O=(3840&o|(3840&o)>>4)>>4,C=240&o|(240&o)>>4;u[3]>0&&(E=Mr(E,255*u[0],u[3]),O=Mr(O,255*u[1],u[3]),C=Mr(C,255*u[2],u[3]));const M=E<<8|O,D=C<<8|Math.floor(255*f[3]),I=function(ue){const me=rr(ue,0,2);return Math.min(Math.round(.5*me*255),255)}(f[2])<<8|15*f[0]<<4|15*f[1],R=rr(y[0],0,1),H=rr(y[1],0,1),X=rr(y[2],0,1),J=rr(y[3],0,1);let ne,re,te,oe;if(R!==H&&_!==g&&H!==R){const ue=_-g;re=1/(ue*(H-R)),te=-(g+ue*R)/(ue*(H-R));const me=rr(y[4],-1,1);oe=Math.pow(10,me),ne=255*X<<8|255*J}else ne=65535,re=0,te=1,oe=1;if(m.emplaceBack(M,D,I,ne,re,te,oe),T){const ue=T.length;T.clear();for(let me=0;me<ue;me++)T.emplaceBack(M,D,I,ne,re,te,oe)}}function Gfe(m,o,u){const f=m.node;let y=0;const g=u&Iy.HasMeshoptCompression;for(const _ of f.meshes){if(f.lights&&f.lightMeshIndex===y||!_.featureData)continue;_.featureArray=new vy,_.featureArray.reserve(_.featureData.length);let T=o;for(const E of _.featureData){const O=g?65535&E:E>>16&65535,C=g?E>>16&65535:65535&E,M=(15&C)<8?15&C:0,D=m.evaluatedRMEA[M],I=m.evaluatedColor[M],R=m.emissionHeightBasedParams[M];let H;if(T&&M===2&&f.lights&&(H=new vy,H.resize(10*f.lights.length)),Ufe(_.featureArray,O,I,D,R,_.aabb.min[2],_.aabb.max[2],H),H&&T){T=!1;const X=f.meshes[f.lightMeshIndex];X.featureArray=H,X.featureArray._trim()}}_.featureArray._trim(),y++}}function p7(m,o,u,f){const y=1<<m.z;o.lat=ba((f/Wt+m.y)/y),o.lng=Lo((u/Wt+m.x)/y)}lr(eA,"Tiled3dModelBucket",{omit:["layers"]}),lr(f7,"Tiled3dModelFeature");const Hfe={circle:class extends ua{constructor(m,o,u,f){super(m,{layout:st||(st=new Ki({"circle-sort-key":new ar(ut.layout_circle["circle-sort-key"]),"circle-elevation-reference":new Vt(ut.layout_circle["circle-elevation-reference"]),visibility:new Vt(ut.layout_circle.visibility)})),paint:At||(At=new Ki({"circle-radius":new ar(ut.paint_circle["circle-radius"]),"circle-color":new ar(ut.paint_circle["circle-color"]),"circle-blur":new ar(ut.paint_circle["circle-blur"]),"circle-opacity":new ar(ut.paint_circle["circle-opacity"]),"circle-translate":new Vt(ut.paint_circle["circle-translate"]),"circle-translate-anchor":new Vt(ut.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Vt(ut.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Vt(ut.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new ar(ut.paint_circle["circle-stroke-width"]),"circle-stroke-color":new ar(ut.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new ar(ut.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new Vt(ut.paint_circle["circle-emissive-strength"]),"circle-color-use-theme":new ar({type:"string",default:"default","property-type":"data-driven"}),"circle-stroke-color-use-theme":new ar({type:"string",default:"default","property-type":"data-driven"})}))},o,u,f)}createBucket(m){return new ie(m)}queryRadius(m){const o=m;return at("circle-radius",this,o)+at("circle-stroke-width",this,o)+kt(this.paint.get("circle-translate"))}queryIntersectsFeature(m,o,u,f,y,g,_,T){const E=Bt(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),g.angle,m.pixelToTileUnitsFactor),O=this.paint.get("circle-radius").evaluate(o,u)+this.paint.get("circle-stroke-width").evaluate(o,u);return Sy(m,f,g,_,T,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",E,O)}getProgramIds(){return["circle"]}getDefaultProgramParams(m,o,u){const f=kf(this);return{config:new Wh(this,{zoom:o,lut:u}),defines:f,overrideFog:!1}}},heatmap:class extends ua{createBucket(m){return new F$(m)}constructor(m,o,u,f){super(m,{layout:B$||(B$=new Ki({visibility:new Vt(ut.layout_heatmap.visibility)})),paint:$$||($$=new Ki({"heatmap-radius":new ar(ut.paint_heatmap["heatmap-radius"]),"heatmap-weight":new ar(ut.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Vt(ut.paint_heatmap["heatmap-intensity"]),"heatmap-color":new bf(ut.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Vt(ut.paint_heatmap["heatmap-opacity"]),"heatmap-color-use-theme":new ar({type:"string",default:"default","property-type":"data-driven"})}))},o,u,f),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(m){m==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=aw({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(m){return at("heatmap-radius",this,m)}queryIntersectsFeature(m,o,u,f,y,g,_,T){const E=this.paint.get("heatmap-radius").evaluate(o,u);return Sy(m,f,g,_,T,!0,!0,new dt(0,0),E)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(m,o,u){return m==="heatmap"?{config:new Wh(this,{zoom:o,lut:u}),overrideFog:!1}:{}}},hillshade:class extends ua{constructor(m,o,u,f){super(m,{layout:V$||(V$=new Ki({visibility:new Vt(ut.layout_hillshade.visibility)})),paint:U$||(U$=new Ki({"hillshade-illumination-direction":new Vt(ut.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Vt(ut.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Vt(ut.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Vt(ut.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Vt(ut.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Vt(ut.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new Vt(ut.paint_hillshade["hillshade-emissive-strength"]),"hillshade-shadow-color-use-theme":new ar({type:"string",default:"default","property-type":"data-driven"}),"hillshade-highlight-color-use-theme":new ar({type:"string",default:"default","property-type":"data-driven"}),"hillshade-accent-color-use-theme":new ar({type:"string",default:"default","property-type":"data-driven"})}))},o,u,f)}shouldRedrape(){return this.hasOffscreenPass()&&this.paint.get("hillshade-illumination-anchor")==="viewport"}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(m,o,u){return{overrideFog:!1}}},fill:class extends ua{constructor(m,o,u,f){super(m,{layout:l8||(l8=new Ki({"fill-sort-key":new ar(ut.layout_fill["fill-sort-key"]),visibility:new Vt(ut.layout_fill.visibility),"fill-elevation-reference":new Vt(ut.layout_fill["fill-elevation-reference"]),"fill-construct-bridge-guard-rail":new ar(ut.layout_fill["fill-construct-bridge-guard-rail"])})),paint:c8||(c8=new Ki({"fill-antialias":new Vt(ut.paint_fill["fill-antialias"]),"fill-opacity":new ar(ut.paint_fill["fill-opacity"]),"fill-color":new ar(ut.paint_fill["fill-color"]),"fill-outline-color":new ar(ut.paint_fill["fill-outline-color"]),"fill-translate":new Vt(ut.paint_fill["fill-translate"]),"fill-translate-anchor":new Vt(ut.paint_fill["fill-translate-anchor"]),"fill-pattern":new ar(ut.paint_fill["fill-pattern"]),"fill-emissive-strength":new Vt(ut.paint_fill["fill-emissive-strength"]),"fill-z-offset":new ar(ut.paint_fill["fill-z-offset"]),"fill-bridge-guard-rail-color":new ar(ut.paint_fill["fill-bridge-guard-rail-color"]),"fill-tunnel-structure-color":new ar(ut.paint_fill["fill-tunnel-structure-color"]),"fill-color-use-theme":new ar({type:"string",default:"default","property-type":"data-driven"}),"fill-outline-color-use-theme":new ar({type:"string",default:"default","property-type":"data-driven"}),"fill-bridge-guard-rail-color-use-theme":new ar({type:"string",default:"default","property-type":"data-driven"}),"fill-tunnel-structure-color-use-theme":new ar({type:"string",default:"default","property-type":"data-driven"})}))},o,u,f)}getProgramIds(){const m=this.paint.get("fill-pattern"),o=m&&m.constantOr(1),u=[o?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&u.push(o&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),u}getDefaultProgramParams(m,o,u){return{config:new Wh(this,{zoom:o,lut:u}),overrideFog:!1}}recalculate(m,o){super.recalculate(m,o);const u=this.paint._values["fill-outline-color"];u.value.kind==="constant"&&u.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(m){return new k4(m)}queryRadius(){return kt(this.paint.get("fill-translate"))}queryIntersectsFeature(m,o,u,f,y,g){return!m.queryGeometry.isAboveHorizon&&he(Pt(m.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),g.angle,m.pixelToTileUnitsFactor),f)}isTileClipped(){return this.paint.get("fill-z-offset").constantOr(1)===0}is3D(m){if(this.paint.get("fill-z-offset").constantOr(1)!==0)return!0;const o=this.layout&&this.layout.get("fill-elevation-reference")!=="none";return m!=null?o&&!m:o}},"fill-extrusion":class extends ua{constructor(m,o,u,f){super(m,{layout:z8||(z8=new Ki({visibility:new Vt(ut["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new Vt(ut["layout_fill-extrusion"]["fill-extrusion-edge-radius"])})),paint:L8||(L8=new Ki({"fill-extrusion-opacity":new Vt(ut["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new ar(ut["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Vt(ut["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Vt(ut["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new ar(ut["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new ar(ut["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new ar(ut["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-height-alignment":new Vt(ut["paint_fill-extrusion"]["fill-extrusion-height-alignment"]),"fill-extrusion-base-alignment":new Vt(ut["paint_fill-extrusion"]["fill-extrusion-base-alignment"]),"fill-extrusion-vertical-gradient":new Vt(ut["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new Vt(ut["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new Vt(ut["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new Vt(ut["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new Vt(ut["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new Vt(ut["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new Vt(ut["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new Vt(ut["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new ar(ut["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new ar(ut["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new Vt(ut["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new Vt(ut["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new Vt(ut["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new Vt(ut["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"]),"fill-extrusion-emissive-strength":new ar(ut["paint_fill-extrusion"]["fill-extrusion-emissive-strength"]),"fill-extrusion-line-width":new ar(ut["paint_fill-extrusion"]["fill-extrusion-line-width"]),"fill-extrusion-cast-shadows":new Vt(ut["paint_fill-extrusion"]["fill-extrusion-cast-shadows"]),"fill-extrusion-color-use-theme":new ar({type:"string",default:"default","property-type":"data-driven"}),"fill-extrusion-flood-light-color-use-theme":new ar({type:"string",default:"default","property-type":"data-driven"})}))},o,u,f),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(m){return new EC(m)}queryRadius(){return kt(this.paint.get("fill-extrusion-translate"))}is3D(m){return!0}hasShadowPass(){return this.paint.get("fill-extrusion-cast-shadows")}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(m,o,u,f,y,g,_,T,E){const O=Bt(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),g.angle,m.pixelToTileUnitsFactor),C=this.paint.get("fill-extrusion-height").evaluate(o,u),M=this.paint.get("fill-extrusion-base").evaluate(o,u),D=[0,0],I=T&&g.elevation,R=g.elevation?g.elevation.exaggeration():1,H=m.tile.getBucket(this);if(I&&H instanceof EC){const te=H.centroidVertexArray,oe=E+1;oe<te.length&&(D[0]=te.geta_centroid_pos0(oe),D[1]=te.geta_centroid_pos1(oe))}if(D[0]===0&&D[1]===1)return!1;g.projection.name==="globe"&&(f=D8([f],[new dt(0,0),new dt(Wt,Wt)],m.tileID.canonical).map(te=>te.polygon).flat());const X=I?T:null,[J,ne]=function(te,oe,ue,me,Me,Se,Ae,Ve,Ie,Ge,Ze){return te.projection.name==="globe"?function(We,Qe,Je,ot,nt,ct,Ot,Mt,cr,Lt,Gt){const Rt=[],Pr=[],ir=We.projection.upVectorScale(Gt,We.center.lat,We.worldSize).metersToTile,pr=[0,0,0,1],Lr=[0,0,0,1],on=(fn,sn,pn,Rn)=>{fn[0]=sn,fn[1]=pn,fn[2]=Rn,fn[3]=1},$r=R8();Je>0&&(Je+=$r),ot+=$r;for(const fn of Qe){const sn=[],pn=[];for(const Rn of fn){const mi=Rn.x+nt.x,Fr=Rn.y+nt.y,Sn=We.projection.projectTilePoint(mi,Fr,Gt),Ni=We.projection.upVector(Gt,Rn.x,Rn.y);let zi=Je,Zi=ot;if(Ot){const ts=B8(mi,Fr,Je,ot,Ot,Mt,cr,Lt);zi+=ts.base,Zi+=ts.top}Je!==0?on(pr,Sn.x+Ni[0]*ir*zi,Sn.y+Ni[1]*ir*zi,Sn.z+Ni[2]*ir*zi):on(pr,Sn.x,Sn.y,Sn.z),on(Lr,Sn.x+Ni[0]*ir*Zi,Sn.y+Ni[1]*ir*Zi,Sn.z+Ni[2]*ir*Zi),ge.vec3.transformMat4(pr,pr,ct),ge.vec3.transformMat4(Lr,Lr,ct),sn.push(new r0(pr[0],pr[1],pr[2])),pn.push(new r0(Lr[0],Lr[1],Lr[2]))}Rt.push(sn),Pr.push(pn)}return[Rt,Pr]}(te,oe,ue,me,Me,Se,Ae,Ve,Ie,Ge,Ze):Ae?function(We,Qe,Je,ot,nt,ct,Ot,Mt,cr){const Lt=[],Gt=[],Rt=[0,0,0,1];for(const Pr of We){const ir=[],pr=[];for(const Lr of Pr){const on=Lr.x+ot.x,$r=Lr.y+ot.y,fn=B8(on,$r,Qe,Je,ct,Ot,Mt,cr);Rt[0]=on,Rt[1]=$r,Rt[2]=fn.base,Rt[3]=1,ge.vec4.transformMat4(Rt,Rt,nt),Rt[3]=Math.max(Rt[3],1e-5);const sn=new r0(Rt[0]/Rt[3],Rt[1]/Rt[3],Rt[2]/Rt[3]);Rt[0]=on,Rt[1]=$r,Rt[2]=fn.top,Rt[3]=1,ge.vec4.transformMat4(Rt,Rt,nt),Rt[3]=Math.max(Rt[3],1e-5);const pn=new r0(Rt[0]/Rt[3],Rt[1]/Rt[3],Rt[2]/Rt[3]);ir.push(sn),pr.push(pn)}Lt.push(ir),Gt.push(pr)}return[Lt,Gt]}(oe,ue,me,Me,Se,Ae,Ve,Ie,Ge):function(We,Qe,Je,ot,nt){const ct=[],Ot=[],Mt=nt[8]*Qe,cr=nt[9]*Qe,Lt=nt[10]*Qe,Gt=nt[11]*Qe,Rt=nt[8]*Je,Pr=nt[9]*Je,ir=nt[10]*Je,pr=nt[11]*Je;for(const Lr of We){const on=[],$r=[];for(const fn of Lr){const sn=fn.x+ot.x,pn=fn.y+ot.y,Rn=nt[0]*sn+nt[4]*pn+nt[12],mi=nt[1]*sn+nt[5]*pn+nt[13],Fr=nt[2]*sn+nt[6]*pn+nt[14],Sn=nt[3]*sn+nt[7]*pn+nt[15],Ni=Rn+Mt,zi=mi+cr,Zi=Fr+Lt,ts=Math.max(Sn+Gt,1e-5),li=Rn+Rt,ta=mi+Pr,wo=Fr+ir,Ns=Math.max(Sn+pr,1e-5);on.push(new r0(Ni/ts,zi/ts,Zi/ts)),$r.push(new r0(li/Ns,ta/Ns,wo/Ns))}ct.push(on),Ot.push($r)}return[ct,Ot]}(oe,ue,me,Me,Se)}(g,f,M,C,O,_,X,D,R,g.center.lat,m.tileID.canonical),re=m.queryGeometry;return function(te,oe,ue){let me=1/0;he(ue,oe)&&(me=F8(ue,oe[0]));for(let Me=0;Me<oe.length;Me++){const Se=oe[Me],Ae=te[Me];for(let Ve=0;Ve<Se.length-1;Ve++){const Ie=Se[Ve],Ge=[Ie,Se[Ve+1],Ae[Ve+1],Ae[Ve],Ie];de(ue,Ge)&&(me=Math.min(me,F8(ue,Ge)))}}return me!==1/0&&me}(J,ne,re.isPointQuery()?re.screenBounds:re.screenGeometry)}},line:class extends ua{constructor(m,o,u,f){const y=Y8();super(m,y,o,u,f),y.layout&&(this.layout=new vf(y.layout)),this.gradientVersion=0,this.hasElevatedBuckets=!1,this.hasNonElevatedBuckets=!1}_handleSpecialPaintPropertyUpdate(m){if(m==="line-gradient"){const o=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=o._styleExpression&&o._styleExpression.expression instanceof Xc,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(m,o){super.recalculate(m,o),this.paint._values["line-floorwidth"]=(()=>{if(pw)return pw;const u=Y8();return pw=new qme(u.paint.properties["line-width"].specification),pw.useIntegerZoom=!0,pw})().possiblyEvaluate(this._transitioningPaint._values["line-width"].value,m)}createBucket(m){return new D4(m)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(m,o,u){const f=K8(this);return{config:new Wh(this,{zoom:o,lut:u}),defines:f,overrideFog:!1}}queryRadius(m){const o=m,u=X8(at("line-width",this,o),at("line-gap-width",this,o)),f=at("line-offset",this,o);return u/2+Math.abs(f)+kt(this.paint.get("line-translate"))}queryIntersectsFeature(m,o,u,f,y,g){if(m.queryGeometry.isAboveHorizon)return!1;const _=Pt(m.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),g.angle,m.pixelToTileUnitsFactor),T=m.pixelToTileUnitsFactor/2*X8(this.paint.get("line-width").evaluate(o,u),this.paint.get("line-gap-width").evaluate(o,u)),E=this.paint.get("line-offset").evaluate(o,u);return E&&(f=function(O,C){const M=[],D=new dt(0,0);for(let I=0;I<O.length;I++){const R=O[I],H=[];for(let X=0;X<R.length;X++){const J=R[X],ne=R[X+1],re=X===0?D:J.sub(R[X-1])._unit()._perp(),te=X===R.length-1?D:ne.sub(J)._unit()._perp(),oe=re._add(te)._unit();oe._mult(1/(oe.x*te.x+oe.y*te.y)),H.push(oe._mult(C)._add(J))}M.push(H)}return M}(f,E*m.pixelToTileUnitsFactor)),function(O,C,M){for(let D=0;D<C.length;D++){const I=C[D];if(O.length>=3){for(let R=0;R<I.length;R++)if(Fe(O,I[R]))return!0}if(fe(O,I,M))return!0}return!1}(_,f,T)}isTileClipped(){return this.hasNonElevatedBuckets}isDraped(m){return!this.hasElevatedBuckets}},symbol:qC,background:class extends ua{constructor(m,o,u,f){super(m,{layout:BV||(BV=new Ki({visibility:new Vt(ut.layout_background.visibility)})),paint:$V||($V=new Ki({"background-pitch-alignment":new Vt(ut.paint_background["background-pitch-alignment"]),"background-color":new Vt(ut.paint_background["background-color"]),"background-pattern":new Vt(ut.paint_background["background-pattern"]),"background-opacity":new Vt(ut.paint_background["background-opacity"]),"background-emissive-strength":new Vt(ut.paint_background["background-emissive-strength"]),"background-color-use-theme":new ar({type:"string",default:"default","property-type":"data-driven"})}))},o,u,f)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(m,o,u){return{overrideFog:!1}}is3D(m){return this.paint.get("background-pitch-alignment")==="viewport"}},raster:qV,"raster-particle":JV,sky:class extends ua{constructor(m,o,u,f){super(m,{layout:ZV||(ZV=new Ki({visibility:new Vt(ut.layout_sky.visibility)})),paint:YV||(YV=new Ki({"sky-type":new Vt(ut.paint_sky["sky-type"]),"sky-atmosphere-sun":new Vt(ut.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Vt(ut.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Vt(ut.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Vt(ut.paint_sky["sky-gradient-radius"]),"sky-gradient":new bf(ut.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Vt(ut.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Vt(ut.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Vt(ut.paint_sky["sky-opacity"]),"sky-gradient-use-theme":new ar({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-halo-color-use-theme":new ar({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-color-use-theme":new ar({type:"string",default:"default","property-type":"data-driven"})}))},o,u,f),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(m){m==="sky-gradient"?this._updateColorRamp():m!=="sky-atmosphere-sun"&&m!=="sky-atmosphere-halo-color"&&m!=="sky-atmosphere-color"&&m!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=aw({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(m){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const o=m.style.light.properties.get("position");return this._lightPosition.azimuthal!==o.azimuthal||this._lightPosition.polar!==o.polar}return!1}getCenter(m,o){if(this.paint.get("sky-type")==="atmosphere"){const f=this.paint.get("sky-atmosphere-sun"),y=!f,g=m.style.light,_=g.properties.get("position");return y&&g.properties.get("anchor")==="viewport"&&_i("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),y?iI(_.azimuthal,90-_.polar,o):iI(f[0],90-f[1],o)}const u=this.paint.get("sky-gradient-center");return iI(u[0],90-u[1],o)}isSky(){return!0}markSkyboxValid(m){this._skyboxInvalidated=!1,this._lightPosition=m.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const m=this.paint.get("sky-type");return m==="atmosphere"?["skyboxCapture","skybox"]:m==="gradient"?["skyboxGradient"]:null}},slot:class extends ua{constructor(m,o,u,f){super(m,{paint:XV||(XV=new Ki({}))},o,null)}},model:class extends ua{constructor(m,o,u,f){super(m,{layout:l7||(l7=new Ki({visibility:new Vt(ut.layout_model.visibility),"model-id":new ar(ut.layout_model["model-id"])})),paint:c7||(c7=new Ki({"model-opacity":new ar(ut.paint_model["model-opacity"]),"model-rotation":new ar(ut.paint_model["model-rotation"]),"model-scale":new ar(ut.paint_model["model-scale"]),"model-translation":new ar(ut.paint_model["model-translation"]),"model-color":new ar(ut.paint_model["model-color"]),"model-color-mix-intensity":new ar(ut.paint_model["model-color-mix-intensity"]),"model-type":new Vt(ut.paint_model["model-type"]),"model-cast-shadows":new Vt(ut.paint_model["model-cast-shadows"]),"model-receive-shadows":new Vt(ut.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new Vt(ut.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new ar(ut.paint_model["model-emissive-strength"]),"model-roughness":new ar(ut.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new ar(ut.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new Vt(ut.paint_model["model-cutoff-fade-range"]),"model-front-cutoff":new Vt(ut.paint_model["model-front-cutoff"]),"model-color-use-theme":new ar({type:"string",default:"default","property-type":"data-driven"})}))},o,u,f),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(m){return new oI(m)}getProgramIds(){return["model"]}is3D(m){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(m){return m instanceof eA?Wt-1:0}queryIntersectsFeature(m,o,u,f,y,g){if(!this.modelManager)return!1;const _=this.modelManager,T=m.tile.getBucket(this);if(!(T&&T instanceof oI))return!1;for(const E in T.instancesPerModel){const O=T.instancesPerModel[E],C=o.id!==void 0?o.id:o.properties&&o.properties.hasOwnProperty("id")?o.properties.id:void 0;if(O.idToFeaturesIndex.hasOwnProperty(C)){const M=O.features[O.idToFeaturesIndex[C]],D=_.getModel(E,this.scope);if(!D)return!1;let I=ge.mat4.create();const R=new $n(0,0),H=T.canonical;let X=Number.MAX_VALUE;for(let J=0;J<M.instancedDataCount;++J){const ne=16*(M.instancedDataOffset+J),re=O.instancedDataArray.float32,te=[re[ne+4],re[ne+5],re[ne+6]];p7(H,R,re[ne],0|re[ne+1]),u7(I,D,g,R,M.rotation,M.scale,te,!1,!1,!1),g.projection.name==="globe"&&(I=aI(I,g));const oe=ge.mat4.multiply([],g.projMatrix,I),ue=m.queryGeometry,me=n7(ue.isPointQuery()?ue.screenBounds:ue.screenGeometry,g,oe,D.aabb);me!=null&&(X=Math.min(me,X))}return X!==Number.MAX_VALUE&&X}}return!1}_handleOverridablePaintPropertyUpdate(m,o,u){return!(!this.layout||o.isDataDriven()||u.isDataDriven()||m!=="model-color"&&m!=="model-color-mix-intensity"&&m!=="model-rotation"&&m!=="model-scale"&&m!=="model-translation"&&m!=="model-emissive-strength")}_isPropertyZoomDependent(m){const o=this._transitionablePaint._values[m];return o!=null&&o.value!=null&&o.value.expression!=null&&o.value.expression instanceof mf}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}},clip:class extends ua{constructor(m,o,u,f){super(m,{layout:u8||(u8=new Ki({"clip-layer-types":new Vt(ut.layout_clip["clip-layer-types"]),"clip-layer-scope":new Vt(ut.layout_clip["clip-layer-scope"])})),paint:d8||(d8=new Ki({}))},o,u,f)}recalculate(m,o){super.recalculate(m,o)}createBucket(m){return new h8(m)}is3D(m){return!0}}};class qfe{constructor(o){this._callback=o,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class Wfe{constructor(){this.tasks={},this.taskQueue=[],Il(["process"],this),this.invoker=new qfe(this.process),this.nextId=0}add(o,u){const f=this.nextId++,y=function({type:g,isSymbolTile:_,zoom:T}){return T=T||0,g==="message"?0:g!=="maybePrepare"||_?g!=="parseTile"||_?g==="parseTile"&&_?300-T:g==="maybePrepare"&&_?400-T:500:200-T:100-T}(u);if(y===0){try{o()}finally{}return null}return this.tasks[f]={fn:o,metadata:u,priority:y,id:f},this.taskQueue.push(f),this.invoker.trigger(),{cancel:()=>{delete this.tasks[f]}}}process(){try{if(this.taskQueue=this.taskQueue.filter(f=>!!this.tasks[f]),!this.taskQueue.length)return;const o=this.pick();if(o===null)return;const u=this.tasks[o];if(delete this.tasks[o],this.taskQueue.length&&this.invoker.trigger(),!u)return;u.fn()}finally{}}pick(){let o=null,u=1/0;for(let y=0;y<this.taskQueue.length;y++){const g=this.tasks[this.taskQueue[y]];g.priority<u&&(u=g.priority,o=y)}if(o===null)return null;const f=this.taskQueue[o];return this.taskQueue.splice(o,1),f}remove(){this.invoker.remove()}}class g7{constructor(o,u,f){this.target=o,this.parent=u,this.mapId=f,this.callbacks={},this.cancelCallbacks={},Il(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new Wfe}send(o,u,f,y,g=!1,_){const T=Math.round(1e18*Math.random()).toString(36).substring(0,10);f&&(f.metadata=_,this.callbacks[T]=f);const E=new Set;return this.target.postMessage({id:T,type:o,hasCallback:!!f,targetMapId:y,mustQueue:g,sourceMapId:this.mapId,data:Ld(u,E)},E),{cancel:()=>{f&&delete this.callbacks[T],this.target.postMessage({id:T,type:"<cancel>",targetMapId:y,sourceMapId:this.mapId})}}}receive(o){const u=o.data;if(!u)return;const f=u.id;if(f&&(!u.targetMapId||this.mapId===u.targetMapId))if(u.type==="<cancel>"){const y=this.cancelCallbacks[f];delete this.cancelCallbacks[f],y&&y.cancel()}else if(u.mustQueue||Ji()){const y=this.callbacks[f],g=this.scheduler.add(()=>this.processTask(f,u),y&&y.metadata||{type:"message"});g&&(this.cancelCallbacks[f]=g)}else this.processTask(f,u)}processTask(o,u){if(delete this.cancelCallbacks[o],u.type==="<response>"){const f=this.callbacks[o];delete this.callbacks[o],f&&(u.error?f(ll(u.error)):f(null,ll(u.data)))}else{const f=new Set,y=u.hasCallback?(_,T)=>{this.target.postMessage({id:o,type:"<response>",sourceMapId:this.mapId,error:_?Ld(_):null,data:Ld(T,f)},f)}:()=>{},g=ll(u.data);if(this.parent[u.type])this.parent[u.type](u.sourceMapId,g,y);else if(this.parent.getWorkerSource){const _=u.type.split(".");this.parent.getWorkerSource(u.sourceMapId,_[0],g.source,g.scope)[_[1]](g,y)}else y(new Error(`Could not find function ${u.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}var Tw={workerUrl:"",workerClass:null,workerParams:void 0};const dI="mapboxgl_preloaded_worker_pool";class s0{constructor(){this.active={}}acquire(o,u=s0.workerCount){if(!this.workers)for(this.workers=[];this.workers.length<u;)this.workers.push(Tw.workerClass!=null?new Tw.workerClass:new self.Worker(Tw.workerUrl,Tw.workerParams));return this.active[o]=!0,this.workers.slice()}release(o){delete this.active[o],this.workers&&this.numActive()===0&&(this.workers.forEach(u=>{u.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[dI]}numActive(){return Object.keys(this.active).length}}s0.workerCount=2;class Ry{constructor(o,u,f="Worker",y=s0.workerCount){this.workerPool=o,this.actors=[],this.currentActor=0,this.id=Xs();const g=this.workerPool.acquire(this.id,y);for(let _=0;_<g.length;_++){const T=new Ry.Actor(g[_],u,this.id);T.name=`${f} ${_}`,this.actors.push(T)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(o,u,f){ri(this.actors,(y,g)=>{y.send(o,u,g)},f=f||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(o=>{o.remove()}),this.actors=[],this.workerPool.release(this.id)}}let kw,hI;function tA(){return kw||(kw=new s0),kw}Ry.Actor=g7;const mI=new Xn(0,0,0);var fI=(m=>(m[m.PATH_RULE_UNSPECIFIED=0]="PATH_RULE_UNSPECIFIED",m[m.PATH_RULE_NON_ZERO=1]="PATH_RULE_NON_ZERO",m[m.PATH_RULE_EVEN_ODD=2]="PATH_RULE_EVEN_ODD",m))(fI||{}),rA=(m=>(m[m.LINE_CAP_UNSPECIFIED=0]="LINE_CAP_UNSPECIFIED",m[m.LINE_CAP_BUTT=1]="LINE_CAP_BUTT",m[m.LINE_CAP_ROUND=2]="LINE_CAP_ROUND",m[m.LINE_CAP_SQUARE=3]="LINE_CAP_SQUARE",m))(rA||{}),Pw=(m=>(m[m.LINE_JOIN_UNSPECIFIED=0]="LINE_JOIN_UNSPECIFIED",m[m.LINE_JOIN_MITER=1]="LINE_JOIN_MITER",m[m.LINE_JOIN_MITER_CLIP=2]="LINE_JOIN_MITER_CLIP",m[m.LINE_JOIN_ROUND=3]="LINE_JOIN_ROUND",m[m.LINE_JOIN_BEVEL=4]="LINE_JOIN_BEVEL",m))(Pw||{}),x7=(m=>(m[m.PAINT_ORDER_UNSPECIFIED=0]="PAINT_ORDER_UNSPECIFIED",m[m.PAINT_ORDER_FILL_AND_STROKE=1]="PAINT_ORDER_FILL_AND_STROKE",m[m.PAINT_ORDER_STROKE_AND_FILL=2]="PAINT_ORDER_STROKE_AND_FILL",m))(x7||{}),Dy=(m=>(m[m.PATH_COMMAND_UNSPECIFIED=0]="PATH_COMMAND_UNSPECIFIED",m[m.PATH_COMMAND_MOVE=1]="PATH_COMMAND_MOVE",m[m.PATH_COMMAND_LINE=2]="PATH_COMMAND_LINE",m[m.PATH_COMMAND_QUAD=3]="PATH_COMMAND_QUAD",m[m.PATH_COMMAND_CUBIC=4]="PATH_COMMAND_CUBIC",m[m.PATH_COMMAND_CLOSE=5]="PATH_COMMAND_CLOSE",m))(Dy||{}),y7=(m=>(m[m.MASK_TYPE_UNSPECIFIED=0]="MASK_TYPE_UNSPECIFIED",m[m.MASK_TYPE_LUMINANCE=1]="MASK_TYPE_LUMINANCE",m[m.MASK_TYPE_ALPHA=2]="MASK_TYPE_ALPHA",m))(y7||{});function Kfe(m,o,u){m===1&&o.icons.push(function(f,y){return function(g){if(g.usvg_tree.height||(g.usvg_tree.height=g.usvg_tree.width),!g.metadata)return g;const{metadata:_}=g;if(_.content_area){const{content_area:T}=_;T.top==null&&(T.top=T.left),T.width==null&&(T.width=g.usvg_tree.width),T.height==null&&(T.height=T.width)}return _.stretch_x&&_.stretch_x.length&&v7(_,"x"),_.stretch_y&&_.stretch_y.length&&v7(_,"y"),g}(f.readFields(Zfe,{name:void 0},y))}(u,u.readVarint()+u.pos))}function v7(m,o){const u=[],f=m[`stretch_${o}`];let y=null;for(let g=0;g<f.length;g++)y===null?y=u.length===0?f[0]:u[u.length-1][1]+f[g]:(u.push([y,y+f[g]]),y=null);m[`stretch_${o}_areas`]=u}function Zfe(m,o,u){m===1?o.name=u.readString():m===2?o.metadata=function(f,y){return f.readFields(Yfe,{stretch_x:null,stretch_y:null,stretch_x_areas:null,stretch_y_areas:null,variables:[]},y)}(u,u.readVarint()+u.pos):m===3&&(o.usvg_tree=function(f,y){return f.readFields(Qfe,{width:20,children:[],linear_gradients:[],radial_gradients:[],clip_paths:[],masks:[]},y)}(u,u.readVarint()+u.pos),o.data="usvg_tree")}function Yfe(m,o,u){m===1?o.stretch_x=u.readPackedVarint():m===2?o.stretch_y=u.readPackedVarint():m===3?o.content_area=function(f,y){return f.readFields(Xfe,{left:0},y)}(u,u.readVarint()+u.pos):m===4&&o.variables.push(function(f,y){return f.readFields(Jfe,{name:void 0},y)}(u,u.readVarint()+u.pos))}function Xfe(m,o,u){m===1?o.left=u.readVarint():m===2?o.width=u.readVarint():m===3?o.top=u.readVarint():m===4&&(o.height=u.readVarint())}function Jfe(m,o,u){m===1?o.name=u.readString():m===2&&(o.rgb_color=sA(u.readVarint()),o.value="rgb_color")}function Qfe(m,o,u){m===1?o.width=o.height=u.readVarint():m===2?o.height=u.readVarint():m===3?o.children.push(nA(u,u.readVarint()+u.pos)):m===4?o.linear_gradients.push(function(f,y){return f.readFields(ape,{spread_method:1,stops:[],x1:0,y1:0,x2:1,y2:0},y)}(u,u.readVarint()+u.pos)):m===5?o.radial_gradients.push(function(f,y){return f.readFields(lpe,{spread_method:1,stops:[],cx:.5,cy:.5,r:.5,fx:.5,fy:.5,fr:0},y)}(u,u.readVarint()+u.pos)):m===7?o.clip_paths.push(function(f,y){return f.readFields(cpe,{children:[]},y)}(u,u.readVarint()+u.pos)):m===8&&o.masks.push(function(f,y){const g=f.readFields(upe,{left:0,width:20,mask_type:1,children:[]},y);return g.height==null&&(g.height=g.width),g.top==null&&(g.top=g.left),g}(u,u.readVarint()+u.pos))}function nA(m,o){return m.readFields(epe,{},o)}function epe(m,o,u){m===1?(o.group=function(f,y){return f.readFields(tpe,{opacity:255,children:[]},y)}(u,u.readVarint()+u.pos),o.node="group"):m===2&&(o.path=function(f,y){return f.readFields(npe,{paint_order:1,commands:[],step:1,diffs:[],rule:1},y)}(u,u.readVarint()+u.pos),o.node="path")}function tpe(m,o,u){m===1?o.transform=iA(u,u.readVarint()+u.pos):m===2?o.opacity=u.readVarint():m===5?o.clip_path_idx=u.readVarint():m===6?o.mask_idx=u.readVarint():m===7&&o.children.push(nA(u,u.readVarint()+u.pos))}function iA(m,o){return m.readFields(rpe,{sx:1,ky:0,kx:0,sy:1,tx:0,ty:0},o)}function rpe(m,o,u){m===1?o.sx=u.readFloat():m===2?o.ky=u.readFloat():m===3?o.kx=u.readFloat():m===4?o.sy=u.readFloat():m===5?o.tx=u.readFloat():m===6&&(o.ty=u.readFloat())}function npe(m,o,u){m===1?o.fill=function(f,y){return f.readFields(ipe,{rgb_color:mI,paint:"rgb_color",opacity:255},y)}(u,u.readVarint()+u.pos):m===2?o.stroke=function(f,y){return f.readFields(spe,{rgb_color:mI,paint:"rgb_color",dasharray:[],dashoffset:0,miterlimit:4,opacity:255,width:1,linecap:1,linejoin:1},y)}(u,u.readVarint()+u.pos):m===3?o.paint_order=u.readVarint():m===5?u.readPackedVarint(o.commands):m===6?o.step=u.readFloat():m===7?u.readPackedSVarint(o.diffs):m===8&&(o.rule=u.readVarint())}function ipe(m,o,u){m===1?(o.rgb_color=sA(u.readVarint()),o.paint="rgb_color"):m===2?(o.linear_gradient_idx=u.readVarint(),o.paint="linear_gradient_idx"):m===3?(o.radial_gradient_idx=u.readVarint(),o.paint="radial_gradient_idx"):m===5&&(o.opacity=u.readVarint())}function sA(m){return new Xn((m>>16&255)/255,(m>>8&255)/255,(255&m)/255,1)}function spe(m,o,u){m===1?(o.rgb_color=sA(u.readVarint()),o.paint="rgb_color"):m===2?(o.linear_gradient_idx=u.readVarint(),o.paint="linear_gradient_idx"):m===3?(o.radial_gradient_idx=u.readVarint(),o.paint="radial_gradient_idx"):m===5?u.readPackedFloat(o.dasharray):m===6?o.dashoffset=u.readFloat():m===7?o.miterlimit=u.readFloat():m===8?o.opacity=u.readVarint():m===9?o.width=u.readFloat():m===10?o.linecap=u.readVarint():m===11&&(o.linejoin=u.readVarint())}function ape(m,o,u){m===1?o.transform=iA(u,u.readVarint()+u.pos):m===2?o.spread_method=u.readVarint():m===3?o.stops.push(b7(u,u.readVarint()+u.pos)):m===4?o.x1=u.readFloat():m===5?o.y1=u.readFloat():m===6?o.x2=u.readFloat():m===7&&(o.y2=u.readFloat())}function b7(m,o){return m.readFields(ope,{offset:0,opacity:255,rgb_color:mI},o)}function ope(m,o,u){m===1?o.offset=u.readFloat():m===2?o.opacity=u.readVarint():m===3&&(o.rgb_color=sA(u.readVarint()))}function lpe(m,o,u){m===1?o.transform=iA(u,u.readVarint()+u.pos):m===2?o.spread_method=u.readVarint():m===3?o.stops.push(b7(u,u.readVarint()+u.pos)):m===4?o.cx=u.readFloat():m===5?o.cy=u.readFloat():m===6?o.r=u.readFloat():m===7?o.fx=u.readFloat():m===8?o.fy=u.readFloat():m===9&&(o.fr=u.readFloat())}function cpe(m,o,u){m===1?o.transform=iA(u,u.readVarint()+u.pos):m===2?o.clip_path_idx=u.readVarint():m===3&&o.children.push(nA(u,u.readVarint()+u.pos))}function upe(m,o,u){m===1?o.left=o.top=u.readFloat():m===2?o.width=o.height=u.readFloat():m===3?o.top=u.readFloat():m===4?o.height=u.readFloat():m===5?o.mask_type=u.readVarint():m===6?o.mask_idx=u.readVarint():m===7&&o.children.push(nA(u,u.readVarint()+u.pos))}class dpe{static calculate(o={},u=[]){const f=new Map,y=new Map;if(Object.keys(o).length===0)return f;u.forEach(g=>{y.set(g.name,g.rgb_color||new Xn(0,0,0))});for(const[g,_]of Object.entries(o))y.has(g)?f.set(y.get(g).toStringPremultipliedAlpha(),_):console.warn(`Ignoring unknown image variable "${g}"`);return f}}function zy(m,o=255,u){const f=o/255,y=m.toStringPremultipliedAlpha(),g=u.has(y)?u.get(y).clone():m.clone();return g.a*=f,g.toString()}function Ew(m,o){if(!wt()){const u=document.createElement("canvas");return u.width=m,u.height=o,u}return new OffscreenCanvas(m,o)}function hpe(m,o){const u=dpe.calculate(o.params,m.metadata?m.metadata.variables:[]),f=m.usvg_tree,y=f.width,g=f.height,_=o.transform?o.transform:new DOMMatrix,T=Math.max(1,Math.round(y*_.a)),E=Math.max(1,Math.round(g*_.d)),O=new DOMMatrix([T/y,0,0,E/g,0,0]),C=Ew(T,E).getContext("2d");return pI(C,O,f,f,u),C.getImageData(0,0,T,E)}function pI(m,o,u,f,y){for(const g of f.children)_7(m,o,u,g,y)}function _7(m,o,u,f,y){f.group?(m.save(),function(g,_,T,E,O){const C=E.mask_idx!=null?T.masks[E.mask_idx]:null,M=E.clip_path_idx!=null?T.clip_paths[E.clip_path_idx]:null;if(E.transform&&(_=aA(E.transform).preMultiplySelf(_)),!function(R,H,X){return R.opacity!==255||H||X}(E,M!=null,C!=null))return void pI(g,_,T,E,O);const D=Ew(g.canvas.width,g.canvas.height),I=D.getContext("2d");pI(I,_,T,E,O),M&&T7(I,_,T,M),C&&k7(I,_,T,C,O),g.globalAlpha=E.opacity/255,g.drawImage(D,0,0)}(m,o,u,f.group,y),m.restore()):f.path&&(m.save(),function(g,_,T,E,O){const C=P7(E);g.setTransform(_),E.paint_order===x7.PAINT_ORDER_FILL_AND_STROKE?(w7(g,T,E,C,O),N7(g,T,E,C,O)):(N7(g,T,E,C,O),w7(g,T,E,C,O))}(m,o,u,f.path,y),m.restore())}function w7(m,o,u,f,y){const g=u.fill;if(!g)return;const _=g.opacity/255;switch(g.paint){case"rgb_color":m.fillStyle=zy(g.rgb_color,g.opacity,y);break;case"linear_gradient_idx":m.fillStyle=S7(m,o.linear_gradients[g.linear_gradient_idx],_,y);break;case"radial_gradient_idx":m.fillStyle=C7(m,o.radial_gradients[g.radial_gradient_idx],_,y)}m.fill(f,j7(u))}function j7(m){return m.rule===fI.PATH_RULE_NON_ZERO?"nonzero":m.rule===fI.PATH_RULE_EVEN_ODD?"evenodd":void 0}function N7(m,o,u,f,y){const g=u.stroke;if(!g)return;m.lineWidth=g.width,m.miterLimit=g.miterlimit,m.setLineDash(g.dasharray),m.lineDashOffset=g.dashoffset;const _=g.opacity/255;switch(g.paint){case"rgb_color":m.strokeStyle=zy(g.rgb_color,g.opacity,y);break;case"linear_gradient_idx":m.strokeStyle=S7(m,o.linear_gradients[g.linear_gradient_idx],_,y);break;case"radial_gradient_idx":m.strokeStyle=C7(m,o.radial_gradients[g.radial_gradient_idx],_,y)}switch(g.linejoin){case Pw.LINE_JOIN_MITER_CLIP:case Pw.LINE_JOIN_MITER:m.lineJoin="miter";break;case Pw.LINE_JOIN_ROUND:m.lineJoin="round";break;case Pw.LINE_JOIN_BEVEL:m.lineJoin="bevel"}switch(g.linecap){case rA.LINE_CAP_BUTT:m.lineCap="butt";break;case rA.LINE_CAP_ROUND:m.lineCap="round";break;case rA.LINE_CAP_SQUARE:m.lineCap="square"}m.stroke(f)}function S7(m,o,u,f){if(o.stops.length===1){const D=o.stops[0];return zy(D.rgb_color,D.opacity*u,f)}const y=aA(o.transform),{x1:g,y1:_,x2:T,y2:E}=o,O=y.transformPoint(new DOMPoint(g,_)),C=y.transformPoint(new DOMPoint(T,E)),M=m.createLinearGradient(O.x,O.y,C.x,C.y);for(const D of o.stops)M.addColorStop(D.offset,zy(D.rgb_color,D.opacity*u,f));return M}function C7(m,o,u,f){if(o.stops.length===1){const D=o.stops[0];return zy(D.rgb_color,D.opacity*u,f)}const y=aA(o.transform),{fx:g,fy:_,cx:T,cy:E}=o,O=y.transformPoint(new DOMPoint(g,_)),C=y.transformPoint(new DOMPoint(T,E)),M=m.createRadialGradient(O.x,O.y,0,C.x,C.y,o.r*((y.a+y.d)/2));for(const D of o.stops)M.addColorStop(D.offset,zy(D.rgb_color,D.opacity*u,f));return M}function A7(m,o,u,f){const y=f.transform?aA(f.transform).preMultiplySelf(o):o,g=Ew(m.canvas.width,m.canvas.height),_=g.getContext("2d");for(const E of f.children)if(E.group)A7(_,y,u,E.group);else if(E.path){const O=E.path,C=new Path2D;C.addPath(P7(O),y),_.fill(C,j7(O))}const T=f.clip_path_idx!=null?u.clip_paths[f.clip_path_idx]:null;T&&T7(_,y,u,T),m.globalCompositeOperation="source-over",m.drawImage(g,0,0)}function T7(m,o,u,f){const y=Ew(m.canvas.width,m.canvas.height);A7(y.getContext("2d"),o,u,f),m.globalCompositeOperation="destination-in",m.drawImage(y,0,0)}function k7(m,o,u,f,y){if(f.children.length===0)return;const g=f.mask_idx!=null?u.masks[f.mask_idx]:null;g&&k7(m,o,u,g,y);const _=m.canvas.width,T=m.canvas.height,E=Ew(_,T),O=E.getContext("2d"),C=f.width,M=f.height,D=f.left,I=f.top,R=new Path2D,H=new Path2D;H.rect(D,I,C,M),R.addPath(H,o),O.clip(R);for(const ne of f.children)_7(O,o,u,ne,y);const X=O.getImageData(0,0,_,T),J=X.data;if(f.mask_type===y7.MASK_TYPE_LUMINANCE)for(let ne=0;ne<J.length;ne+=4)J[ne+3]=J[ne+3]/255*(.2126*J[ne]+.7152*J[ne+1]+.0722*J[ne+2]);O.putImageData(X,0,0),m.globalCompositeOperation="destination-in",m.drawImage(E,0,0)}function aA(m){return m?new DOMMatrix([m.sx,m.ky,m.kx,m.sy,m.tx,m.ty]):new DOMMatrix}function P7(m){const o=new Path2D,u=m.step;let f=m.diffs[0]*u,y=m.diffs[1]*u;o.moveTo(f,y);for(let g=0,_=2;g<m.commands.length;g++)switch(m.commands[g]){case Dy.PATH_COMMAND_MOVE:f+=m.diffs[_++]*u,y+=m.diffs[_++]*u,o.moveTo(f,y);break;case Dy.PATH_COMMAND_LINE:f+=m.diffs[_++]*u,y+=m.diffs[_++]*u,o.lineTo(f,y);break;case Dy.PATH_COMMAND_QUAD:{const T=f+m.diffs[_++]*u,E=y+m.diffs[_++]*u;f=T+m.diffs[_++]*u,y=E+m.diffs[_++]*u,o.quadraticCurveTo(T,E,f,y);break}case Dy.PATH_COMMAND_CUBIC:{const T=f+m.diffs[_++]*u,E=y+m.diffs[_++]*u,O=T+m.diffs[_++]*u,C=E+m.diffs[_++]*u;f=O+m.diffs[_++]*u,y=C+m.diffs[_++]*u,o.bezierCurveTo(T,E,O,C,f,y);break}case Dy.PATH_COMMAND_CLOSE:o.closePath()}return o}class oA{constructor(o){this.capacity=o,this.cache=new Map}get(o){if(!this.cache.has(o))return;const u=this.cache.get(o);return this.cache.delete(o),this.cache.set(o,u),u}put(o,u){this.cache.has(o)?this.cache.delete(o):this.cache.size===this.capacity&&this.cache.delete(this.cache.keys().next().value),this.cache.set(o,u)}delete(o){this.cache.delete(o)}}lr(oA,"LRUCache");class gI{constructor(){this.cacheMap=new Map,this.cacheDependenciesMap=new Map}static _getImage(o){return new Ea(o,o.data)}getFromCache(o,u,f){return this.cacheMap.has(f)||this.cacheMap.set(f,new oA(150)),this.cacheMap.get(f).get(wf(o.toString(),u))}setInCache(o,u,f,y){this.cacheDependenciesMap.has(y)||this.cacheDependenciesMap.set(y,new Map),this.cacheMap.has(y)||this.cacheMap.set(y,new oA(150));const g=this.cacheDependenciesMap.get(y),_=wf(o.id.toString(),f);g.get(_)||g.set(_,new Set);const T=this.cacheMap.get(y),E=o.toString();g.get(_).add(E),T.put(wf(o.toString(),f),u)}removeImagesFromCacheByIds(o,u,f=0){if(!this.cacheMap.has(f)||!this.cacheDependenciesMap.has(f))return;const y=this.cacheMap.get(f),g=this.cacheDependenciesMap.get(f);for(const _ of o){const T=wf(_.toString(),u);if(g.has(T)){for(const E of g.get(T))y.delete(E);g.delete(T)}}}rasterize(o,u,f,y,g=hpe){const _=this.getFromCache(o,f,y);if(_)return _.clone();const T=g(u.icon,o.options),E=gI._getImage(T);return this.setInCache(o,E,f,y),E.clone()}}class E7{constructor(o){this.size=o,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(o,u){const f=this.toIdx(o,u);return{min:this.minimums[f],max:this.maximums[f]}}isLeaf(o,u){return this.leaves[this.toIdx(o,u)]}toIdx(o,u){return u*this.size+o}}function M7(m,o,u,f){let y=0,g=Number.MAX_VALUE;for(let _=0;_<3;_++)if(Math.abs(f[_])<1e-15){if(u[_]<m[_]||u[_]>o[_])return null}else{const T=1/f[_];let E=(m[_]-u[_])*T,O=(o[_]-u[_])*T;if(E>O){const C=E;E=O,O=C}if(E>y&&(y=E),O<g&&(g=O),y>g)return null}return y}function I7(m,o,u,f,y,g,_,T,E,O,C){const M=f-m,D=y-o,I=g-u,R=_-m,H=T-o,X=E-u,J=C[1]*X-C[2]*H,ne=C[2]*R-C[0]*X,re=C[0]*H-C[1]*R,te=M*J+D*ne+I*re;if(Math.abs(te)<1e-15)return null;const oe=1/te,ue=O[0]-m,me=O[1]-o,Me=O[2]-u,Se=(ue*J+me*ne+Me*re)*oe;if(Se<0||Se>1)return null;const Ae=me*I-Me*D,Ve=Me*M-ue*I,Ie=ue*D-me*M,Ge=(C[0]*Ae+C[1]*Ve+C[2]*Ie)*oe;return Ge<0||Se+Ge>1?null:(R*Ae+H*Ve+X*Ie)*oe}function O7(m,o,u){return(m-o)/(u-o)}function R7(m,o,u,f,y,g,_,T,E){const O=1<<u,C=g-f,M=_-y,D=(m+1)/O*C+f,I=(o+0)/O*M+y,R=(o+1)/O*M+y;T[0]=(m+0)/O*C+f,T[1]=I,E[0]=D,E[1]=R}class D7{constructor(o){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=o,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const u=function(g){const _=Math.ceil(Math.log2(g.dim/8)),T=[];let E=Math.ceil(Math.pow(2,_));const O=1/E,C=(I,R,H,X,J)=>{const ne=X?1:0,re=(I+1)*H-ne,te=R*H,oe=(R+1)*H-ne;J[0]=I*H,J[1]=te,J[2]=re,J[3]=oe};let M=new E7(E);const D=[];for(let I=0;I<E*E;I++){C(I%E,Math.floor(I/E),O,!1,D);const R=zf(D[0],D[1],g),H=zf(D[2],D[1],g),X=zf(D[2],D[3],g),J=zf(D[0],D[3],g);M.minimums.push(Math.min(R,H,X,J)),M.maximums.push(Math.max(R,H,X,J)),M.leaves.push(1)}for(T.push(M),E/=2;E>=1;E/=2){const I=T[T.length-1];M=new E7(E);for(let R=0;R<E*E;R++){C(R%E,Math.floor(R/E),2,!0,D);const H=I.getElevation(D[0],D[1]),X=I.getElevation(D[2],D[1]),J=I.getElevation(D[2],D[3]),ne=I.getElevation(D[0],D[3]),re=I.isLeaf(D[0],D[1]),te=I.isLeaf(D[2],D[1]),oe=I.isLeaf(D[2],D[3]),ue=I.isLeaf(D[0],D[3]),me=Math.min(H.min,X.min,J.min,ne.min),Me=Math.max(H.max,X.max,J.max,ne.max),Se=re&&te&&oe&&ue;M.maximums.push(Me),M.minimums.push(me),M.leaves.push(Me-me<=5&&Se?1:0)}T.push(M)}return T}(this.dem),f=u.length-1,y=u[f];this._addNode(y.minimums[0],y.maximums[0],y.leaves[0]),this._construct(u,0,0,f,0)}raycastRoot(o,u,f,y,g,_,T=1){return M7([o,u,-100],[f,y,this.maximums[0]*T],g,_)}raycast(o,u,f,y,g,_,T=1){if(!this.nodeCount)return null;const E=this.raycastRoot(o,u,f,y,g,_,T);if(E==null)return null;const O=[],C=[],M=[],D=[],I=[{idx:0,t:E,nodex:0,nodey:0,depth:0}];for(;I.length>0;){const{idx:R,t:H,nodex:X,nodey:J,depth:ne}=I.pop();if(this.leaves[R]){R7(X,J,ne,o,u,f,y,M,D);const te=1<<ne,oe=(X+0)/te,ue=(X+1)/te,me=(J+0)/te,Me=(J+1)/te,Se=zf(oe,me,this.dem)*T,Ae=zf(ue,me,this.dem)*T,Ve=zf(ue,Me,this.dem)*T,Ie=zf(oe,Me,this.dem)*T,Ge=I7(M[0],M[1],Se,D[0],M[1],Ae,D[0],D[1],Ve,g,_),Ze=I7(D[0],D[1],Ve,M[0],D[1],Ie,M[0],M[1],Se,g,_),We=Math.min(Ge!==null?Ge:Number.MAX_VALUE,Ze!==null?Ze:Number.MAX_VALUE);if(We!==Number.MAX_VALUE)return We;{const Qe=ge.vec3.scaleAndAdd([],g,_,H);if(z7(Se,Ae,Ie,Ve,O7(Qe[0],M[0],D[0]),O7(Qe[1],M[1],D[1]))>=Qe[2])return H}continue}let re=0;for(let te=0;te<this._siblingOffset.length;te++){R7((X<<1)+this._siblingOffset[te][0],(J<<1)+this._siblingOffset[te][1],ne+1,o,u,f,y,M,D),M[2]=-100,D[2]=this.maximums[this.childOffsets[R]+te]*T;const oe=M7(M,D,g,_);if(oe!=null){const ue=oe;O[te]=ue;let me=!1;for(let Me=0;Me<re&&!me;Me++)ue>=O[C[Me]]&&(C.splice(Me,0,te),me=!0);me||(C[re]=te),re++}}for(let te=0;te<re;te++){const oe=C[te];I.push({idx:this.childOffsets[R]+oe,t:O[oe],nodex:(X<<1)+this._siblingOffset[oe][0],nodey:(J<<1)+this._siblingOffset[oe][1],depth:ne+1})}}return null}_addNode(o,u,f){return this.minimums.push(o),this.maximums.push(u),this.leaves.push(f),this.childOffsets.push(0),this.nodeCount++}_construct(o,u,f,y,g){if(o[y].isLeaf(u,f)===1)return;this.childOffsets[g]||(this.childOffsets[g]=this.nodeCount);const _=y-1,T=o[_];let E=0,O=0;for(let C=0;C<this._siblingOffset.length;C++){const M=2*u+this._siblingOffset[C][0],D=2*f+this._siblingOffset[C][1],I=T.getElevation(M,D),R=T.isLeaf(M,D),H=this._addNode(I.min,I.max,R);R&&(E|=1<<C),O||(O=H)}for(let C=0;C<this._siblingOffset.length;C++)E&1<<C||this._construct(o,2*u+this._siblingOffset[C][0],2*f+this._siblingOffset[C][1],_,O+C)}}function z7(m,o,u,f,y,g){return Mr(Mr(m,u,g),Mr(o,f,g),y)}function zf(m,o,u){const f=u.dim,y=rr(m*f-.5,0,f-1),g=rr(o*f-.5,0,f-1),_=Math.floor(y),T=Math.floor(g),E=Math.min(_+1,f-1),O=Math.min(T+1,f-1);return z7(u.get(_,T),u.get(E,T),u.get(_,O),u.get(E,O),y-_,g-T)}const mpe={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function fpe(m,o,u){return(256*m*256+256*o+u)/10-1e4}function ppe(m,o,u){return 256*m+o+u/256-32768}class lA{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(o,u,f,y=!1){if(this.uid=o,u.height!==u.width)throw new RangeError("DEM tiles must be square");if(f&&f!=="mapbox"&&f!=="terrarium")return void _i(`"${f}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=u.height;const g=this.dim=u.height-2,_=new Uint32Array(u.data.buffer);if(this.pixels=new Uint8Array(u.data.buffer),this.floatView=new Float32Array(u.data.buffer),this.borderReady=y,this._modifiedForSources={},!y){for(let E=0;E<g;E++)_[this._idx(-1,E)]=_[this._idx(0,E)],_[this._idx(g,E)]=_[this._idx(g-1,E)],_[this._idx(E,-1)]=_[this._idx(E,0)],_[this._idx(E,g)]=_[this._idx(E,g-1)];_[this._idx(-1,-1)]=_[this._idx(0,0)],_[this._idx(g,-1)]=_[this._idx(g-1,0)],_[this._idx(-1,g)]=_[this._idx(0,g-1)],_[this._idx(g,g)]=_[this._idx(g-1,g-1)]}const T=f==="terrarium"?ppe:fpe;for(let E=0;E<_.length;++E){const O=4*E;this.floatView[E]=T(this.pixels[O],this.pixels[O+1],this.pixels[O+2])}this._timestamp=vt.now()}_buildQuadTree(){this._tree=new D7(this)}get(o,u,f=!1){f&&(o=rr(o,-1,this.dim),u=rr(u,-1,this.dim));const y=this._idx(o,u);return this.floatView[y]}set(o,u,f){const y=this._idx(o,u),g=this.floatView[y];return this.floatView[y]=f,f-g}static getUnpackVector(o){return mpe[o]}_idx(o,u){if(o<-1||o>=this.dim+1||u<-1||u>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(u+1)*this.stride+(o+1)}static pack(o,u){const f=[0,0,0,0],y=lA.getUnpackVector(u);let g=Math.floor((o+y[3])/y[2]);return f[2]=g%256,g=Math.floor(g/256),f[1]=g%256,g=Math.floor(g/256),f[0]=g,f}getPixels(){return new q$({width:this.stride,height:this.stride},this.pixels)}backfillBorder(o,u,f){if(this.dim!==o.dim)throw new Error("dem dimension mismatch");let y=u*this.dim,g=u*this.dim+this.dim,_=f*this.dim,T=f*this.dim+this.dim;switch(u){case-1:y=g-1;break;case 1:g=y+1}switch(f){case-1:_=T-1;break;case 1:T=_+1}const E=-u*this.dim,O=-f*this.dim;for(let C=_;C<T;C++)for(let M=y;M<g;M++){const D=4*this._idx(M,C),I=4*this._idx(M+E,C+O);this.pixels[D+0]=o.pixels[I+0],this.pixels[D+1]=o.pixels[I+1],this.pixels[D+2]=o.pixels[I+2],this.pixels[D+3]=o.pixels[I+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}function gpe(m,o,u){m===1?o.headerLength=u.readFixed32():m===2?o.x=u.readVarint():m===3?o.y=u.readVarint():m===4?o.z=u.readVarint():m===5&&o.layers.push(function(f,y){return f.readFields(_pe,{version:0,name:"",units:"",tileSize:0,buffer:0,pixelFormat:0,dataIndex:[]},y)}(u,u.readVarint()+u.pos))}function xpe(m,o,u){m===1?(o.delta_filter=function(f,y){return f.readFields(ype,{blockSize:0},y)}(u,u.readVarint()+u.pos),o.filter="delta_filter"):m===2?(u.readVarint(),o.filter="zigzag_filter"):m===3?(u.readVarint(),o.filter="bitshuffle_filter"):m===4&&(u.readVarint(),o.filter="byteshuffle_filter")}function ype(m,o,u){m===1&&(o.blockSize=u.readVarint())}function vpe(m,o,u){m===1?(u.readVarint(),o.codec="gzip_data"):m===2?(u.readVarint(),o.codec="jpeg_image"):m===3?(u.readVarint(),o.codec="webp_image"):m===4&&(u.readVarint(),o.codec="png_image")}function bpe(m,o,u){let f=0,y=0;m===1?o.firstByte=u.readFixed64():m===2?o.lastByte=u.readFixed64():m===3?o.filters.push(function(g,_){return g.readFields(xpe,{},_)}(u,u.readVarint()+u.pos)):m===4?o.codec=function(g,_){return g.readFields(vpe,{},_)}(u,u.readVarint()+u.pos):m===5?y=u.readFloat():m===6?f=u.readFloat():m===7?o.bands.push(u.readString()):m===8?o.offset=u.readDouble():m===9&&(o.scale=u.readDouble()),o.offset===0&&(o.offset=y),o.scale===0&&(o.scale=f)}function _pe(m,o,u){m===1?o.version=u.readVarint():m===2?o.name=u.readString():m===3?o.units=u.readString():m===4?o.tileSize=u.readVarint():m===5?o.buffer=u.readVarint():m===6?o.pixelFormat=u.readVarint():m===7&&o.dataIndex.push(function(f,y){return f.readFields(bpe,{firstByte:0,lastByte:0,filters:[],codec:null,offset:0,scale:0,bands:[]},y)}(u,u.readVarint()+u.pos))}function wpe(m,o,u){if(m===2)(function(f,y,g){f.readFields(jpe,g,y)})(u,u.readVarint()+u.pos,o);else if(m===3)throw new Error("Not implemented")}function jpe(m,o,u){if(m===1){let f=0;const y=u.readVarint()+u.pos;for(;u.pos<y;)o[f++]=u.readVarint()}}function Npe(m,o){if(o.length!==4)throw new Error(`Expected data of dimension 4 but got ${o.length}.`);let u=o[3];for(let f=2;f>=1;f--){const y=f===1?1:0,g=f===2?1:0;for(let _=0;_<o[0];_++){const T=o[1]*_;for(let E=y;E<o[1];E++){const O=o[2]*(E+T);for(let C=g;C<o[2];C++){const M=o[3]*(C+O);for(let D=0;D<o[3];D++){const I=M+D;m[I]+=m[I-u]}}}}u*=o[f]}return m}function Spe(m){for(let o=0,u=m.length;o<u;o++)m[o]=m[o]>>>1^-(1&m[o]);return m}function Cpe(m,o){switch(o){case"uint32":return m;case"uint16":for(let u=0;u<m.length;u+=2){const f=m[u],y=m[u+1];m[u]=(240&f)>>4|(61440&f)>>8|(240&y)<<4|61440&y,m[u+1]=15&f|(3840&f)>>4|(15&y)<<8|(3840&y)<<4}return m;case"uint8":for(let u=0;u<m.length;u+=4){const f=m[u],y=m[u+1],g=m[u+2],_=m[u+3];m[u+0]=(192&f)>>6|(192&y)>>4|(192&g)>>2|192&_,m[u+1]=(48&f)>>4|(48&y)>>2|48&g|(48&_)<<2,m[u+2]=(12&f)>>2|12&y|(12&g)<<2|(12&_)<<4,m[u+3]=3&f|(3&y)<<2|(3&g)<<4|(3&_)<<6}return m;default:throw new Error(`Invalid pixel format, "${o}"`)}}lr(lA,"DEMData"),lr(D7,"DemMinMaxQuadTree",{omit:["dem"]});var fc=Uint8Array,Mw=Uint16Array,Ape=Int32Array,L7=new fc([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),F7=new fc([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Tpe=new fc([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),B7=function(m,o){for(var u=new Mw(31),f=0;f<31;++f)u[f]=o+=1<<m[f-1];var y=new Ape(u[30]);for(f=1;f<30;++f)for(var g=u[f];g<u[f+1];++g)y[g]=g-u[f]<<5|f;return{b:u,r:y}},$7=B7(L7,2),V7=$7.b,kpe=$7.r;V7[28]=258,kpe[258]=28;for(var Ppe=B7(F7,0).b,U7=new Mw(32768),Ms=0;Ms<32768;++Ms){var Ly=(43690&Ms)>>1|(21845&Ms)<<1;U7[Ms]=((65280&(Ly=(61680&(Ly=(52428&Ly)>>2|(13107&Ly)<<2))>>4|(3855&Ly)<<4))>>8|(255&Ly)<<8)>>1}var Iw=function(m,o,u){for(var f=m.length,y=0,g=new Mw(o);y<f;++y)m[y]&&++g[m[y]-1];var _,T=new Mw(o);for(y=1;y<o;++y)T[y]=T[y-1]+g[y-1]<<1;_=new Mw(1<<o);var E=15-o;for(y=0;y<f;++y)if(m[y])for(var O=y<<4|m[y],C=o-m[y],M=T[m[y]-1]++<<C,D=M|(1<<C)-1;M<=D;++M)_[U7[M]>>E]=O;return _},Ow=new fc(288);for(Ms=0;Ms<144;++Ms)Ow[Ms]=8;for(Ms=144;Ms<256;++Ms)Ow[Ms]=9;for(Ms=256;Ms<280;++Ms)Ow[Ms]=7;for(Ms=280;Ms<288;++Ms)Ow[Ms]=8;var G7=new fc(32);for(Ms=0;Ms<32;++Ms)G7[Ms]=5;var Epe=Iw(Ow,9),Mpe=Iw(G7,5),xI=function(m){for(var o=m[0],u=1;u<m.length;++u)m[u]>o&&(o=m[u]);return o},Ku=function(m,o,u){var f=o/8|0;return(m[f]|m[f+1]<<8)>>(7&o)&u},yI=function(m,o){var u=o/8|0;return(m[u]|m[u+1]<<8|m[u+2]<<16)>>(7&o)},Ipe=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Zu=function(m,o,u){var f=new Error(o||Ipe[m]);if(f.code=m,Error.captureStackTrace&&Error.captureStackTrace(f,Zu),!u)throw f;return f},Ope=new fc(0),Rpe=typeof TextDecoder<"u"&&new TextDecoder;try{Rpe.decode(Ope,{stream:!0})}catch{}const Dpe={gzip_data:"gzip"};class nu extends Error{constructor(o){super(o),this.name="MRTError"}}const zpe={0:"uint32",1:"uint32",2:"uint16",3:"uint8"},H7={uint32:1,uint16:2,uint8:4},Lpe={uint32:Uint32Array,uint16:Uint16Array,uint8:Uint8Array};let vI;class cA{constructor(o=5){this.x=NaN,this.y=NaN,this.z=NaN,this.layers={},this._cacheSize=o}getLayer(o){const u=this.layers[o];if(!u)throw new nu(`Layer '${o}' not found`);return u}getHeaderLength(o){const u=new Uint8Array(o),f=new DataView(o);if(u[0]!==13)throw new nu("File is not a valid MRT.");return f.getUint32(1,!0)}parseHeader(o){const u=new Uint8Array(o),f=this.getHeaderLength(o);if(u.length<f)throw new nu(`Expected header with length >= ${f} but got buffer of length ${u.length}`);const y=function(g,_){return g.readFields(gpe,{headerLength:0,x:0,y:0,z:0,layers:[]},void 0)}(new vI(u.subarray(0,f)));if(!isNaN(this.x)&&(this.x!==y.x||this.y!==y.y||this.z!==y.z))throw new nu(`Invalid attempt to parse header ${y.z}/${y.x}/${y.y} for tile ${this.z}/${this.x}/${this.y}`);this.x=y.x,this.y=y.y,this.z=y.z;for(const g of y.layers)this.layers[g.name]=new q7(g,{cacheSize:this._cacheSize});return this}createDecodingTask(o){const u=[],f=this.getLayer(o.layerName);for(let y of o.blockIndices){const g=f.dataIndex[y],_=g.firstByte-o.firstByte,T=g.lastByte-o.firstByte;if(f._blocksInProgress.has(y))continue;const E={layerName:f.name,firstByte:_,lastByte:T,pixelFormat:f.pixelFormat,blockIndex:y,blockShape:[g.bands.length].concat(f.bandShape),buffer:f.buffer,codec:g.codec.codec,filters:g.filters.map(O=>O.filter)};f._blocksInProgress.add(y),u.push(E)}return new W7(u,()=>{u.forEach(y=>f._blocksInProgress.delete(y.blockIndex))},(y,g)=>{if(u.forEach(_=>f._blocksInProgress.delete(_.blockIndex)),y)throw y;g.forEach(_=>{this.getLayer(_.layerName).processDecodedData(_)})})}}class q7{constructor({version:o,name:u,units:f,tileSize:y,pixelFormat:g,buffer:_,dataIndex:T},E){if(this.version=o,this.version!==1)throw new nu(`Cannot parse raster layer encoded with MRT version ${o}`);this.name=u,this.units=f,this.tileSize=y,this.buffer=_,this.pixelFormat=zpe[g],this.dataIndex=T,this.bandShape=[y+2*_,y+2*_,H7[this.pixelFormat]],this._decodedBlocks=new oA(E?E.cacheSize:5),this._blocksInProgress=new Set}get dimension(){return H7[this.pixelFormat]}get cacheSize(){return this._decodedBlocks.capacity}getBandList(){return this.dataIndex.map(({bands:o})=>o).flat()}processDecodedData(o){const u=o.blockIndex.toString();this._decodedBlocks.get(u)||this._decodedBlocks.put(u,o.data)}getBlockForBand(o){let u=0;switch(typeof o){case"string":for(const[f,y]of this.dataIndex.entries()){for(const[g,_]of y.bands.entries())if(_===o)return{bandIndex:u+g,blockIndex:f,blockBandIndex:g};u+=y.bands.length}break;case"number":for(const[f,y]of this.dataIndex.entries()){if(o>=u&&o<u+y.bands.length)return{bandIndex:o,blockIndex:f,blockBandIndex:o-u};u+=y.bands.length}break;default:throw new nu(`Invalid band \`${JSON.stringify(o)}\`. Expected string or integer.`)}return{blockIndex:-1,blockBandIndex:-1}}getDataRange(o){let u=1/0,f=-1/0;const y=[],g=new Set;for(const _ of o){const{blockIndex:T}=this.getBlockForBand(_);if(T<0)throw new nu(`Invalid band: ${JSON.stringify(_)}`);const E=this.dataIndex[T];y.includes(T)||y.push(T),g.add(T),u=Math.min(u,E.firstByte),f=Math.max(f,E.lastByte)}if(g.size>this.cacheSize)throw new nu(`Number of blocks to decode (${g.size}) exceeds cache size (${this.cacheSize}).`);return{layerName:this.name,firstByte:u,lastByte:f,blockIndices:y}}hasBand(o){const{blockIndex:u}=this.getBlockForBand(o);return u>=0}hasDataForBand(o){const{blockIndex:u}=this.getBlockForBand(o);return u>=0&&!!this._decodedBlocks.get(u.toString())}getBandView(o){const{blockIndex:u,blockBandIndex:f}=this.getBlockForBand(o);if(u<0)throw new nu(`Band not found: ${JSON.stringify(o)}`);const y=this._decodedBlocks.get(u.toString());if(!y)throw new nu(`Data for band ${JSON.stringify(o)} of layer "${this.name}" not decoded.`);const g=this.dataIndex[u],_=this.bandShape.reduce((O,C)=>O*C,1),T=f*_,E=y.subarray(T,T+_);return{data:E,bytes:new Uint8Array(E.buffer).subarray(E.byteOffset,E.byteOffset+E.byteLength),tileSize:this.tileSize,buffer:this.buffer,pixelFormat:this.pixelFormat,dimension:this.dimension,offset:g.offset,scale:g.scale}}}cA.setPbf=function(m){vI=m};class W7{constructor(o,u,f){this.tasks=o,this._onCancel=u,this._onComplete=f,this._finalized=!1}cancel(){this._finalized||(this._onCancel(),this._finalized=!0)}complete(o,u){this._finalized||(this._onComplete(o,u),this._finalized=!0)}}cA.performDecoding=function(m,o){const u=new Uint8Array(m);return Promise.all(o.tasks.map(f=>{const{layerName:y,firstByte:g,lastByte:_,pixelFormat:T,blockShape:E,blockIndex:O,filters:C,codec:M}=f,D=u.subarray(g,_+1),I=new Uint32Array(E[0]*E[1]*E[2]);let R;if(M!=="gzip_data")throw new nu(`Unhandled codec: ${M}`);return R=function(H,X){if(!globalThis.DecompressionStream&&X==="gzip_data")return Promise.resolve(((te=function(me){me[0]==31&&me[1]==139&&me[2]==8||Zu(6,"invalid gzip data");var Me=me[3],Se=10;4&Me&&(Se+=2+(me[10]|me[11]<<8));for(var Ae=(Me>>3&1)+(Me>>4&1);Ae>0;Ae-=!me[Se++]);return Se+(2&Me)}(re=H))+8>re.length&&Zu(6,"invalid gzip data"),function(me,Me,Se,Ae){var Ve=me.length;if(!Ve||Me.f&&!Me.l)return Se||new fc(0);var Ie=!Se,Ge=Ie||Me.i!=2,Ze=Me.i;Ie&&(Se=new fc(3*Ve));var We,Qe,Je=function(Ff){var Bf=Se.length;if(Ff>Bf){var o0=new fc(Math.max(2*Bf,Ff));o0.set(Se),Se=o0}},ot=Me.f||0,nt=Me.p||0,ct=Me.b||0,Ot=Me.l,Mt=Me.d,cr=Me.m,Lt=Me.n,Gt=8*Ve;do{if(!Ot){ot=Ku(me,nt,1);var Rt=Ku(me,nt+1,3);if(nt+=3,!Rt){var Pr=me[(Fr=4+((nt+7)/8|0))-4]|me[Fr-3]<<8,ir=Fr+Pr;if(ir>Ve){Ze&&Zu(0);break}Ge&&Je(ct+Pr),Se.set(me.subarray(Fr,ir),ct),Me.b=ct+=Pr,Me.p=nt=8*ir,Me.f=ot;continue}if(Rt==1)Ot=Epe,Mt=Mpe,cr=9,Lt=5;else if(Rt==2){var pr=Ku(me,nt,31)+257,Lr=Ku(me,nt+10,15)+4,on=pr+Ku(me,nt+5,31)+1;nt+=14;for(var $r=new fc(on),fn=new fc(19),sn=0;sn<Lr;++sn)fn[Tpe[sn]]=Ku(me,nt+3*sn,7);nt+=3*Lr;var pn=xI(fn),Rn=(1<<pn)-1,mi=Iw(fn,pn);for(sn=0;sn<on;){var Fr,Sn=mi[Ku(me,nt,Rn)];if(nt+=15&Sn,(Fr=Sn>>4)<16)$r[sn++]=Fr;else{var Ni=0,zi=0;for(Fr==16?(zi=3+Ku(me,nt,3),nt+=2,Ni=$r[sn-1]):Fr==17?(zi=3+Ku(me,nt,7),nt+=3):Fr==18&&(zi=11+Ku(me,nt,127),nt+=7);zi--;)$r[sn++]=Ni}}var Zi=$r.subarray(0,pr),ts=$r.subarray(pr);cr=xI(Zi),Lt=xI(ts),Ot=Iw(Zi,cr),Mt=Iw(ts,Lt)}else Zu(1);if(nt>Gt){Ze&&Zu(0);break}}Ge&&Je(ct+131072);for(var li=(1<<cr)-1,ta=(1<<Lt)-1,wo=nt;;wo=nt){var Ns=(Ni=Ot[yI(me,nt)&li])>>4;if((nt+=15&Ni)>Gt){Ze&&Zu(0);break}if(Ni||Zu(2),Ns<256)Se[ct++]=Ns;else{if(Ns==256){wo=nt,Ot=null;break}var Is=Ns-254;Ns>264&&(Is=Ku(me,nt,(1<<(pc=L7[sn=Ns-257]))-1)+V7[sn],nt+=pc);var Ka=Mt[yI(me,nt)&ta],wa=Ka>>4;if(Ka||Zu(3),nt+=15&Ka,ts=Ppe[wa],wa>3){var pc=F7[wa];ts+=yI(me,nt)&(1<<pc)-1,nt+=pc}if(nt>Gt){Ze&&Zu(0);break}Ge&&Je(ct+131072);var Lf=ct+Is;if(ct<ts){var iu=0-ts,Xu=Math.min(ts,Lf);for(iu+ct<0&&Zu(3);ct<Xu;++ct)Se[ct]=(void 0)[iu+ct]}for(;ct<Lf;++ct)Se[ct]=Se[ct-ts]}}Me.l=Ot,Me.p=wo,Me.b=ct,Me.f=ot,Ot&&(ot=1,Me.m=cr,Me.d=Mt,Me.n=Lt)}while(!ot);return ct!=Se.length&&Ie?(We=Se,((Qe=ct)==null||Qe>We.length)&&(Qe=We.length),new fc(We.subarray(0,Qe))):Se.subarray(0,ct)}(re.subarray(te,-8),{i:2},new fc(((J=re)[(ne=J.length)-4]|J[ne-3]<<8|J[ne-2]<<16|J[ne-1]<<24)>>>0))));var J,ne,re,te;const oe=Dpe[X];if(!oe)throw new Error(`Unhandled codec: ${X}`);const ue=new globalThis.DecompressionStream(oe);return new Response(new Blob([H]).stream().pipeThrough(ue)).arrayBuffer().then(me=>new Uint8Array(me))}(D,M).then(H=>(function(X,J){X.readFields(wpe,J)}(new vI(H),I),new Lpe[T](I.buffer))),R.then(H=>{for(let X=C.length-1;X>=0;X--)switch(C[X]){case"delta_filter":Npe(H,E);break;case"zigzag_filter":Spe(H);break;case"bitshuffle_filter":Cpe(H,T);break;default:throw new nu(`Unhandled filter "${C[X]}"`)}return{layerName:y,blockIndex:O,data:H}}).catch(H=>{throw H})}))},lr(W7,"MRTDecodingBatch",{omit:["_onCancel","_onComplete"]}),lr(cA,"MapboxRasterTile"),lr(q7,"MapboxRasterLayer",{omit:["_blocksInProgress"]});let Rw,bI,Yu,Fy,_I,By=null;function K7(){return Ji()&&self.worker&&self.worker.dracoUrl?self.worker.dracoUrl:bI||pe.DRACO_URL}function Z7(){if(Ji()&&self.worker&&self.worker.meshoptUrl)return self.worker.meshoptUrl;if(Fy)return Fy;const m=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]);if(typeof WebAssembly!="object")throw new Error("WebAssembly not supported, cannot instantiate meshoptimizer");return Fy=WebAssembly.validate(m)?pe.MESHOPT_SIMD_URL:pe.MESHOPT_URL,Fy}const uA={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},Fpe={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",5123:"DT_UINT16",5125:"DT_UINT32",5126:"DT_FLOAT32"},Dw={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function Y7(m,o,u){const f=u.json.bufferViews.length,y=u.buffers.length;o.bufferView=f,u.json.bufferViews[f]={buffer:y,byteLength:m.byteLength},u.buffers[y]=m}const wI="KHR_draco_mesh_compression";function Bpe(m,o){const u=m.extensions&&m.extensions[wI];if(!u)return;const f=new Yu.Decoder,y=eU(o,u.bufferView),g=new Yu.Mesh;if(!f.DecodeArrayToMesh(y,y.byteLength,g))throw new Error("Failed to decode Draco mesh");const _=o.json.accessors[m.indices],T=uA[_.componentType],E=_.count*T.BYTES_PER_ELEMENT,O=Yu._malloc(E);T===Uint16Array?f.GetTrianglesUInt16Array(g,E,O):f.GetTrianglesUInt32Array(g,E,O),Y7(Yu.memory.buffer.slice(O,O+E),_,o),Yu._free(O);for(const C of Object.keys(u.attributes)){const M=f.GetAttributeByUniqueId(g,u.attributes[C]),D=o.json.accessors[m.attributes[C]],I=Fpe[D.componentType],R=D.count*Dw[D.type]*uA[D.componentType].BYTES_PER_ELEMENT,H=Yu._malloc(R);f.GetAttributeDataArrayForAllPoints(g,M,Yu[I],R,H),Y7(Yu.memory.buffer.slice(H,H+R),D,o),Yu._free(H)}f.destroy(),g.destroy(),delete m.extensions[wI]}const dA="EXT_meshopt_compression";function $pe(m,o){if(!m.extensions||!m.extensions[dA])return;const u=m.extensions[dA],f=new Uint8Array(o.buffers[u.buffer],u.byteOffset||0,u.byteLength||0),y=new Uint8Array(u.count*u.byteStride);_I.decodeGltfBuffer(y,u.count,u.byteStride,f,u.mode,u.filter),m.buffer=o.buffers.length,m.byteOffset=0,o.buffers[m.buffer]=y.buffer,delete m.extensions[dA]}const X7=1179937895,J7=new TextDecoder("utf8");function Q7(m,o){return new URL(m,o).href}function Vpe(m,o,u,f){return fetch(Q7(m.uri,f)).then(y=>y.arrayBuffer()).then(y=>{o.buffers[u]=y})}function eU(m,o){const u=m.json.bufferViews[o];return new Uint8Array(m.buffers[u.buffer],u.byteOffset||0,u.byteLength)}function Upe(m,o,u,f){if(m.uri){const y=Q7(m.uri,f);return fetch(y).then(g=>g.blob()).then(g=>createImageBitmap(g)).then(g=>{o.images[u]=g})}if(m.bufferView!==void 0){const y=eU(o,m.bufferView),g=new Blob([y],{type:m.mimeType});return createImageBitmap(g).then(_=>{o.images[u]=_})}}function tU(m,o=0,u){const f={json:null,images:[],buffers:[]};if(new Uint32Array(m,o,1)[0]===X7){const C=new Uint32Array(m,o);let M=2;const D=(C[M++]>>2)-3,I=C[M++]>>2;if(M++,f.json=JSON.parse(J7.decode(C.subarray(M,M+I))),M+=I,M<D){const R=C[M++];M++;const H=o+(M<<2);f.buffers[0]=m.slice(H,H+R)}}else f.json=JSON.parse(J7.decode(new Uint8Array(m,o)));const{buffers:y,images:g,meshes:_,extensionsUsed:T,bufferViews:E}=f.json;let O=Promise.resolve();if(y){const C=[];for(let M=0;M<y.length;M++){const D=y[M];D.uri?C.push(Vpe(D,f,M,u)):f.buffers[M]||(f.buffers[M]=null)}O=Promise.all(C)}return O.then(()=>{const C=[],M=T&&T.includes(wI),D=T&&T.includes(dA);if(M&&C.push(function(){if(!Yu)return Rw??(Rw=function(I){let R,H=null;function X(){R=new Uint8Array(H.buffer)}function J(){throw new Error("Unexpected Draco error.")}const ne={a:{a:J,d:function(re,te,oe){return R.copyWithin(re,te,te+oe)},c:function(re){const te=R.length,oe=Math.max(re>>>0,Math.ceil(1.2*te)),ue=Math.ceil((oe-te)/65536);try{return H.grow(ue),X(),!0}catch{return!1}},b:J}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(I,ne):I.then(re=>re.arrayBuffer()).then(re=>WebAssembly.instantiate(re,ne))).then(re=>{const{Rb:te,Qb:oe,P:ue,T:me,X:Me,Ja:Se,La:Ae,Qa:Ve,Va:Ie,Wa:Ge,eb:Ze,jb:We,f:Qe,e:Je,yb:ot,zb:nt,Ab:ct,Bb:Ot,Db:Mt,Gb:cr}=re.instance.exports;H=Je;const Lt=(()=>{let Gt=0,Rt=0,Pr=0,ir=0;return pr=>{Pr&&(te(ir),te(Gt),Rt+=Pr,Pr=Gt=0),Gt||(Rt+=128,Gt=oe(Rt));const Lr=pr.length+7&-8;let on=Gt;Lr>=Rt&&(Pr=Lr,on=ir=oe(Lr));for(let $r=0;$r<pr.length;$r++)R[on+$r]=pr[$r];return on}})();return X(),Qe(),{memory:Je,_free:te,_malloc:oe,Mesh:class{constructor(){this.ptr=ue()}destroy(){me(this.ptr)}},Decoder:class{constructor(){this.ptr=Se()}destroy(){We(this.ptr)}DecodeArrayToMesh(Gt,Rt,Pr){const ir=Lt(Gt),pr=Ae(this.ptr,ir,Rt,Pr.ptr);return!!Me(pr)}GetAttributeByUniqueId(Gt,Rt){return{ptr:Ve(this.ptr,Gt.ptr,Rt)}}GetTrianglesUInt16Array(Gt,Rt,Pr){Ie(this.ptr,Gt.ptr,Rt,Pr)}GetTrianglesUInt32Array(Gt,Rt,Pr){Ge(this.ptr,Gt.ptr,Rt,Pr)}GetAttributeDataArrayForAllPoints(Gt,Rt,Pr,ir,pr){Ze(this.ptr,Gt.ptr,Rt.ptr,Pr,ir,pr)}},DT_INT8:ot(),DT_UINT8:nt(),DT_INT16:ct(),DT_UINT16:Ot(),DT_UINT32:Mt(),DT_FLOAT32:cr()}})}(fetch(K7())),Rw.then(I=>{Yu=I,Rw=void 0}))}()),D&&C.push(function(){if(_I)return;const I=function(R){let H;const X=WebAssembly.instantiateStreaming(R,{}).then(re=>{H=re.instance,H.exports.__wasm_call_ctors()}),J={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},ne={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return{ready:X,supported:!0,decodeGltfBuffer(re,te,oe,ue,me,Me){(function(Se,Ae,Ve,Ie,Ge,Ze,We){const Qe=Se.exports.sbrk,Je=Ie+3&-4,ot=Qe(Je*Ge),nt=Qe(Ze.length),ct=new Uint8Array(Se.exports.memory.buffer);ct.set(Ze,nt);const Ot=Ae(ot,Ie,Ge,nt,Ze.length);if(Ot===0&&We&&We(ot,Je,Ge),Ve.set(ct.subarray(ot,ot+Ie*Ge)),Qe(ot-Qe(0)),Ot!==0)throw new Error(`Malformed buffer data: ${Ot}`)})(H,H.exports[ne[me]],re,te,oe,ue,H.exports[J[Me]])}}}(fetch(Z7()));return I.ready.then(()=>{_I=I})}()),g)for(let I=0;I<g.length;I++)C.push(Upe(g[I],f,I,u));return(C.length?Promise.all(C):Promise.resolve()).then(()=>{if(M&&_)for(const{primitives:I}of _)for(const R of I)Bpe(R,f);if(D&&_&&E)for(const I of E)$pe(I,f);return f})})}function a0(m,o){const u=m.json.bufferViews[o.bufferView],f=uA[o.componentType];return new f(m.buffers[u.buffer],(o.byteOffset||0)+(u.byteOffset||0),o.count*(u.byteStride&&u.byteStride!==Dw[o.type]*f.BYTES_PER_ELEMENT?u.byteStride/f.BYTES_PER_ELEMENT:Dw[o.type]))}function jI(m,o,u,f){const y=uA[o.componentType],g=function(C){switch(C){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:return 1}}(y),_=m.json.bufferViews[o.bufferView],T=_.byteStride?_.byteStride/y.BYTES_PER_ELEMENT:Dw[o.type],E=u.float32,O=E.length/u.capacity;for(let C=0,M=0;C<o.count*T;C+=T,M+=O)for(let D=0;D<O;D++)E[M+D]=f[C+D]*g;u._trim()}function Gpe(m,o,u){const f=m.indices,y=m.attributes,g={};g.indexArray=new va;const _=o.json.accessors[f],T=_.count/3;g.indexArray.reserve(T);const E=a0(o,_);for(let D=0;D<T;D++)g.indexArray.emplaceBack(E[3*D],E[3*D+1],E[3*D+2]);g.indexArray._trim(),g.vertexArray=new hc;const O=o.json.accessors[y.POSITION];g.vertexArray.reserve(O.count);const C=a0(o,O);for(let D=0;D<O.count;D++)g.vertexArray.emplaceBack(C[3*D],C[3*D+1],C[3*D+2]);if(g.vertexArray._trim(),g.aabb=new xr(O.min,O.max),g.centroid=function(D,I){const R=[0,0,0],H=D.length;if(H>0){for(let X=0;X<H;X++){const J=3*D[X];R[0]+=I[J],R[1]+=I[J+1],R[2]+=I[J+2]}R[0]/=H,R[1]/=H,R[2]/=H}return R}(E,C),y.COLOR_0!==void 0){const D=o.json.accessors[y.COLOR_0],I=Dw[D.type],R=a0(o,D);g.colorArray=I===3?new hc:new Hh,g.colorArray.resize(D.count),jI(o,D,g.colorArray,R)}if(y.NORMAL!==void 0){g.normalArray=new hc;const D=o.json.accessors[y.NORMAL];g.normalArray.resize(D.count);const I=a0(o,D);jI(o,D,g.normalArray,I)}if(y.TEXCOORD_0!==void 0&&u.length>0){g.texcoordArray=new Nf;const D=o.json.accessors[y.TEXCOORD_0];g.texcoordArray.resize(D.count);const I=a0(o,D);jI(o,D,g.texcoordArray,I)}if(y._FEATURE_ID_RGBA4444!==void 0){const D=o.json.accessors[y._FEATURE_ID_RGBA4444];o.json.extensionsUsed&&o.json.extensionsUsed.includes("EXT_meshopt_compression")&&(g.featureData=a0(o,D))}y._FEATURE_RGBA4444!==void 0&&(g.featureData=new Uint32Array(a0(o,o.json.accessors[y._FEATURE_RGBA4444]).buffer));const M=m.material;return g.material=function(D,I){const{emissiveFactor:R=[0,0,0],alphaMode:H="OPAQUE",alphaCutoff:X=.5,normalTexture:J,occlusionTexture:ne,emissiveTexture:re,doubleSided:te}=D,{baseColorFactor:oe=[1,1,1,1],metallicFactor:ue=1,roughnessFactor:me=1,baseColorTexture:Me,metallicRoughnessTexture:Se}=D.pbrMetallicRoughness||{},Ae=ne?I[ne.index]:void 0;if(ne&&ne.extensions&&ne.extensions.KHR_texture_transform&&Ae){const Ve=ne.extensions.KHR_texture_transform;Ae.offsetScale=[Ve.offset[0],Ve.offset[1],Ve.scale[0],Ve.scale[1]]}return{pbrMetallicRoughness:{baseColorFactor:new Xn(...oe),metallicFactor:ue,roughnessFactor:me,baseColorTexture:Me?I[Me.index]:void 0,metallicRoughnessTexture:Se?I[Se.index]:void 0},doubleSided:te,emissiveFactor:R,alphaMode:H,alphaCutoff:X,normalTexture:J?I[J.index]:void 0,occlusionTexture:Ae,emissionTexture:re?I[re.index]:void 0,defined:D.defined===void 0}}(M!==void 0?o.json.materials[M]:{defined:!1},u),g}function rU(m,o,u){const{matrix:f,rotation:y,translation:g,scale:_,mesh:T,extras:E,children:O}=m,C={};if(C.matrix=f||ge.mat4.fromRotationTranslationScale([],y||[0,0,0,1],g||[0,0,0],_||[1,1,1]),T!==void 0){C.meshes=u[T];const M=C.anchor=[0,0];for(const D of C.meshes){const{min:I,max:R}=D.aabb;M[0]+=I[0]+R[0],M[1]+=I[1]+R[1]}M[0]=Math.floor(M[0]/C.meshes.length/2),M[1]=Math.floor(M[1]/C.meshes.length/2)}if(E&&(E.id&&(C.id=E.id),E.lights&&(C.lights=function(M){if(!M.length)return[];const D=function(J){const ne=atob(J),re=new Uint8Array(ne.length);for(let te=0;te<ne.length;te++)re[te]=ne.codePointAt(te);return re}(M),I=[],R=D.length/24,H=new Uint16Array(D.buffer),X=new Float32Array(D.buffer);for(let J=0;J<R;J++){const ne=H[2*J*6]/30,re=H[2*J*6+1]/30,te=H[2*J*6+10]/100,oe=X[6*J+1],ue=X[6*J+2],me=X[6*J+3],Me=X[6*J+4],Se=me-oe,Ae=Me-ue,Ve=Math.hypot(Se,Ae);I.push({pos:[oe+.5*Se,ue+.5*Ae,re],normal:[Ae/Ve,-Se/Ve,0],width:Ve,height:ne,depth:te,points:[oe,ue,me,Me]})}return I}(E.lights))),O){const M=[];for(const D of O)M.push(rU(o.json.nodes[D],o,u));C.children=M}return C}function Hpe(m){if(m.vertices.length===0||m.indices.length===0)return null;const o=new P4(m.vertices,m.indices,8,256),[u,f]=[o.min.clone(),o.max.clone()];return{vertices:m.vertices,indices:m.indices,grid:o,min:u,max:f}}function qpe(m){if(!m.extras||!m.extras.ground)return null;const o=m.extras.ground;if(!o||!Array.isArray(o)||o.length===0)return null;const u=o[0];if(!u||!Array.isArray(u)||u.length===0)return null;const f=[];for(const _ of u){if(!Array.isArray(_)||_.length!==2)continue;const T=_[0],E=_[1];typeof T=="number"&&typeof E=="number"&&f.push(new dt(T,E))}if(f.length<3)return null;f.length>1&&f[f.length-1].equals(f[0])&&f.pop();let y=0;for(let _=0;_<f.length;_++){const T=f[_],E=f[(_+1)%f.length],O=f[(_+2)%f.length];y+=(T.x-E.x)*(O.y-E.y)-(O.x-E.x)*(T.y-E.y)}y>0&&f.reverse();const g=ow(f.flatMap(_=>[_.x,_.y]),[]);return g.length===0?null:{vertices:f,indices:g}}function Wpe(m,o){const u=[],f=[];let y=0;const g=[];for(const _ of m){y=u.length;const T=_.vertexArray.float32,E=_.indexArray.uint16;for(let O=0;O<_.vertexArray.length;O++)g[0]=T[3*O+0],g[1]=T[3*O+1],g[2]=T[3*O+2],ge.vec3.transformMat4(g,g,o),u.push(new dt(g[0],g[1]));for(let O=0;O<3*_.indexArray.length;O++)f.push(E[O]+y)}if(f.length%3!=0)return null;for(let _=0;_<f.length;_+=3){const T=u[f[_+0]],E=u[f[_+1]],O=u[f[_+2]];(T.x-E.x)*(O.y-E.y)-(O.x-E.x)*(T.y-E.y)>0&&([f[_+1],f[_+2]]=[f[_+2],f[_+1]])}return{vertices:u,indices:f}}function nU(m){const o=function(E,O){const C=[],M=WebGL2RenderingContext;if(E.json.textures)for(const D of E.json.textures){const I={magFilter:M.LINEAR,minFilter:M.NEAREST,wrapS:M.REPEAT,wrapT:M.REPEAT};D.sampler!==void 0&&Object.assign(I,E.json.samplers[D.sampler]),C.push({image:O[D.source],sampler:I,uploaded:!1})}return C}(m,m.images),u=function(E,O){const C=[];for(const M of E.json.meshes){const D=[];for(const I of M.primitives)D.push(Gpe(I,E,O));C.push(D)}return C}(m,o),{scenes:f,scene:y,nodes:g}=m.json,_=f?f[y||0].nodes:g,T=[];for(const E of _)T.push(rU(g[E],m,u));return function(E,O,C){const M={},D=new Set;for(let I=0;I<E.length;I++){const R=C[O[I]];if(!R.extras)continue;const H=R.extras["mapbox:footprint:version"],X=R.extras["mapbox:footprint:id"];(H||X)&&D.add(I),H==="1.0.0"&&X&&(M[X]=I)}for(let I=0;I<E.length;I++){if(D.has(I))continue;const R=E[I],H=C[O[I]];if(!H.extras)continue;let X=null;R.id in M&&(X=Wpe(E[M[R.id]].meshes,R.matrix)),X||(X=qpe(H)),X&&(R.footprint=Hpe(X))}if(D.size>0){const I=Array.from(D.values()).sort((R,H)=>R-H);for(let R=I.length-1;R>=0;R--)E.splice(I[R],1)}}(T,_,m.json.nodes),T}function Kpe(m){m.heightmap=new Float32Array(4096),m.heightmap.fill(-1);const o=m.vertexArray.float32,u=m.aabb.min[0]-1,f=m.aabb.min[1]-1,y=n0/(m.aabb.max[0]-u+2),g=n0/(m.aabb.max[1]-f+2);for(let _=0;_<o.length;_+=3){const T=o[_+2],E=(o[_+0]-u)*y|0,O=(o[_+1]-f)*g|0;T>m.heightmap[O*n0+E]&&(m.heightmap[O*n0+E]=T)}}function Zpe(m,o){const u={};u.indexArray=new va,u.indexArray.reserve(4*m.length),u.vertexArray=new hc,u.vertexArray.reserve(10*m.length),u.colorArray=new Hh,u.vertexArray.reserve(10*m.length);let f=0;for(const _ of m){const T=Math.min(10,Math.max(4,1.3*_.height))*o,E=[-_.normal[1],_.normal[0],0],O=Math.min(.29,.1*_.width/_.depth),C=_.width-2*_.depth*o*(O+.01),M=ge.vec3.scaleAndAdd([],_.pos,E,C/2),D=ge.vec3.scaleAndAdd([],_.pos,E,-C/2),I=[M[0],M[1],M[2]+_.height],R=[D[0],D[1],D[2]+_.height],H=ge.vec3.scaleAndAdd([],_.normal,E,O);ge.vec3.scale(H,H,T);const X=ge.vec3.scaleAndAdd([],_.normal,E,-O);ge.vec3.scale(X,X,T),ge.vec3.add(H,M,H),ge.vec3.add(X,D,X),M[2]+=.1,D[2]+=.1,u.vertexArray.emplaceBack(H[0],H[1],H[2]),u.vertexArray.emplaceBack(X[0],X[1],X[2]),u.vertexArray.emplaceBack(M[0],M[1],M[2]),u.vertexArray.emplaceBack(D[0],D[1],D[2]),u.vertexArray.emplaceBack(I[0],I[1],I[2]),u.vertexArray.emplaceBack(R[0],R[1],R[2]),u.vertexArray.emplaceBack(M[0],M[1],M[2]),u.vertexArray.emplaceBack(D[0],D[1],D[2]),u.vertexArray.emplaceBack(H[0],H[1],H[2]),u.vertexArray.emplaceBack(X[0],X[1],X[2]);const J=C/T/2;u.colorArray.emplaceBack(-J-O,-1,J,.8),u.colorArray.emplaceBack(J+O,-1,J,.8),u.colorArray.emplaceBack(-J,0,J,1.3),u.colorArray.emplaceBack(J,0,J,1.3),u.colorArray.emplaceBack(J+O,-.8,J,.7),u.colorArray.emplaceBack(J+O,-.8,J,.7),u.colorArray.emplaceBack(0,0,J,1.3),u.colorArray.emplaceBack(0,0,J,1.3),u.colorArray.emplaceBack(J+O,-1.2,J,.8),u.colorArray.emplaceBack(J+O,-1.2,J,.8),u.indexArray.emplaceBack(6+f,4+f,8+f),u.indexArray.emplaceBack(7+f,9+f,5+f),u.indexArray.emplaceBack(0+f,1+f,2+f),u.indexArray.emplaceBack(1+f,3+f,2+f),f+=10}const y={defined:!0,emissiveFactor:[0,0,0]},g={};return g.baseColorFactor=Xn.white,y.pbrMetallicRoughness=g,u.material=y,u.aabb=new xr([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),u}class iU{constructor(o){this._stringToNumber={},this._numberToString=[];for(let u=0;u<o.length;u++){const f=o[u];this._stringToNumber[f]=u,this._numberToString[u]=f}}encode(o){return this._stringToNumber[o]}decode(o){return this._numberToString[o]}}const Ype=["id","tile","layer","source","sourceLayer","state"];class $y{constructor(o,u,f,y,g){this.type="Feature",this._vectorTileFeature=o,this._z=u,this._x=f,this._y=y,this.properties=o.properties,this.id=g}clone(){const o=new $y(this._vectorTileFeature,this._z,this._x,this._y,this.id);return this.state&&(o.state=Object.assign({},this.state)),this.layer&&(o.layer=Object.assign({},this.layer)),this.source&&(o.source=this.source),this.sourceLayer&&(o.sourceLayer=this.sourceLayer),o}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(o){this._geometry=o}toJSON(){const o={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};for(const u of Ype)this[u]!==void 0&&(o[u]=this[u]);return o}}class sU{constructor(o,u){this.tileID=o,this.x=o.canonical.x,this.y=o.canonical.y,this.z=o.canonical.z,this.grid=new ff(Wt,16,0),this.featureIndexArray=new zo,this.promoteId=u,this.is3DTile=!1,this.serializedLayersCache=new Map}insert(o,u,f,y,g,_=0,T=0){const E=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(f,y,g,_);const O=this.grid;for(let C=0;C<u.length;C++){const M=u[C],D=[1/0,1/0,-1/0,-1/0];for(let I=0;I<M.length;I++){const R=M[I];D[0]=Math.min(D[0],R.x),D[1]=Math.min(D[1],R.y),D[2]=Math.max(D[2],R.x),D[3]=Math.max(D[3],R.y)}T!==0&&(D[0]-=T,D[1]-=T,D[2]+=T,D[3]+=T),D[0]<Wt&&D[1]<Wt&&D[2]>=0&&D[3]>=0&&O.insert(E,D[0],D[1],D[2],D[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new Ef.VectorTile(new IC(this.rawTileData)).layers,this.sourceLayerCoder=new iU(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const o in this.vtLayers)this.vtFeatures[o]=[]}return this.vtLayers}query(o,u){const{tilespaceGeometry:f,transform:y,tileTransform:g,pixelPosMatrix:_,availableImages:T}=u;this.loadVTLayers(),this.serializedLayersCache.clear();const E=f.bufferedTilespaceBounds,O=this.grid.query(E.min.x,E.min.y,E.max.x,E.max.y,(I,R,H,X)=>Be(f.bufferedTilespaceGeometry,I,R,H,X));O.sort(Xpe);let C=null;y.elevation&&O.length>0&&(C=Oy.create(y.elevation,this.tileID));const M={};let D;for(let I=0;I<O.length;I++){const R=O[I];if(R===D)continue;D=R;const H=this.featureIndexArray.get(R);let X=null;this.is3DTile?this.loadMatchingModelFeature(M,H,o,f,y):this.loadMatchingFeature(M,H,o,T,(J,ne,re,te=0)=>(X||(X=K(J,this.tileID.canonical,g)),ne.queryIntersectsFeature(f,J,re,X,this.z,y,_,C,te)))}return M}loadMatchingFeature(o,u,f,y,g){const{featureIndex:_,bucketIndex:T,sourceLayerIndex:E,layoutVertexArrayOffset:O}=u,C=this.bucketLayerIDs[T],M=f.layers,D=Object.keys(M);if(D.length&&!function(J,ne){for(let re=0;re<J.length;re++)if(ne.indexOf(J[re])>=0)return!0;return!1}(D,C))return;const I=f.sourceCache,R=this.sourceLayerCoder.decode(E),H=this.vtLayers[R].feature(_),X=this.getId(H,R);for(let J=0;J<C.length;J++){const ne=C[J];if(!M[ne])continue;const{styleLayer:re,targets:te}=M[ne];let oe={};X!==void 0&&(oe=I.getFeatureState(re.sourceLayer,X));const ue=!g||g(H,re,oe,O);if(!ue)continue;const me=new $y(H,this.z,this.x,this.y,X);me.tile=this.tileID.canonical,me.state=oe;let Me=this.serializedLayersCache.get(ne);Me||(Me=re.serialize(),Me.id=ne,this.serializedLayersCache.set(ne,Me)),me.source=Me.source,me.sourceLayer=Me["source-layer"],me.layer=Ui({},Me),me.layer.paint=aU(Me.paint,re.paint,H,oe,y),me.layer.layout=aU(Me.layout,re.layout,H,oe,y);let Se=!1;for(const Ae of te){this.updateFeatureProperties(me,Ae);const{filter:Ve}=Ae;if(Ve){if(H.properties=me.properties,Ve.needGeometry){const Ie=Y(H,!0);if(!Ve.filter(new hi(this.tileID.overscaledZ),Ie,this.tileID.canonical))continue}else if(!Ve.filter(new hi(this.tileID.overscaledZ),H))continue}Se=!0,Ae.targetId&&this.addFeatureVariant(me,Ae)}Se&&this.appendToResult(o,ne,_,me,ue)}}loadMatchingModelFeature(o,u,f,y,g){const _=this.bucketLayerIDs[0][0],T=f.layers;if(!T[_])return;const{styleLayer:E,targets:O}=T[_];if(E.type!=="model")return;const C=y.tile,M=u.featureIndex,D=C.getBucket(E);if(!(D&&D instanceof eA))return;const I=function(Me,Se,Ae,Ve){const Ie=Me.getNodesInfo()[Se];if(Ie.hiddenByReplacement||!Ie.node.meshes)return;let Ge=Number.MAX_VALUE;const Ze=Ie.node,We=Ae.tile,Qe=Ve.calculatePosMatrix(We.tileID.toUnwrapped(),Ve.worldSize),Je=Ie.evaluatedScale;let ot=0;Ve.elevation&&Ze.elevation&&(ot=Ze.elevation*Ve.elevation.exaggeration()),ge.mat4.translate(Qe,Qe,[(Ze.anchor?Ze.anchor[0]:0)*(Je[0]-1),(Ze.anchor?Ze.anchor[1]:0)*(Je[1]-1),ot]),ge.mat4.scale(Qe,Qe,Je);const nt=Ae.queryGeometry,ct=nt.isPointQuery()?nt.screenBounds:nt.screenGeometry,Ot=function(cr){const Lt=ge.mat4.multiply([],Qe,cr.matrix);ge.mat4.multiply(Lt,Ve.expandedFarZProjMatrix,Lt);for(let Gt=0;Gt<cr.meshes.length;++Gt){const Rt=cr.meshes[Gt];if(Gt===cr.lightMeshIndex)continue;const Pr=n7(ct,Ve,Lt,Rt.aabb);Pr!=null&&(Ge=Math.min(Pr,Ge))}if(cr.children)for(const Gt of cr.children)Ot(Gt)};if(Ot(Ze),Ge===Number.MAX_VALUE)return;const Mt=new $n(0,0);return p7(We.tileID.canonical,Mt,Ie.node.anchor[0],Ie.node.anchor[1]),{intersectionZ:Ge,position:Mt,feature:Ie.feature}}(D,M,y,g);if(!I)return;const{z:R,x:H,y:X}=C.tileID.canonical,{feature:J,intersectionZ:ne,position:re}=I;let te={};J.id!==void 0&&(te=f.sourceCache.getFeatureState(E.sourceLayer,J.id));const oe=new $y({},R,H,X,J.id);oe.tile=this.tileID.canonical,oe.state=te,oe.properties=J.properties,oe.geometry={type:"Point",coordinates:[re.lng,re.lat]};let ue=this.serializedLayersCache.get(_);ue||(ue=E.serialize(),ue.id=_,this.serializedLayersCache.set(_,ue)),oe.source=ue.source,oe.sourceLayer=ue["source-layer"],oe.layer=Ui({},ue);let me=!1;for(const Me of O){this.updateFeatureProperties(oe,Me);const{filter:Se}=Me;if(Se){if(J.properties=oe.properties,Se.needGeometry){if(!Se.filter(new hi(this.tileID.overscaledZ),J,this.tileID.canonical))continue}else if(!Se.filter(new hi(this.tileID.overscaledZ),J))continue}me=!0,Me.targetId&&this.addFeatureVariant(oe,Me)}me&&this.appendToResult(o,_,M,oe,ne)}updateFeatureProperties(o,u,f){if(u.properties){const y={};for(const g in u.properties){const _=u.properties[g].evaluate({zoom:this.z},o._vectorTileFeature,o.state,o.tile,f);_!=null&&(y[g]=_)}o.properties=y}}addFeatureVariant(o,u,f){const y={target:u.target,namespace:u.namespace,uniqueFeatureID:u.uniqueFeatureID};u.properties&&(y.properties=o.properties),o.variants=o.variants||{},o.variants[u.targetId]=o.variants[u.targetId]||[],o.variants[u.targetId].push(y)}appendToResult(o,u,f,y,g){let _=o[u];_===void 0&&(_=o[u]=[]),_.push({featureIndex:f,feature:y,intersectionZ:g})}lookupSymbolFeatures(o,u,f,y,g){const _={};this.loadVTLayers();for(const T of o)this.loadMatchingFeature(_,{bucketIndex:u,sourceLayerIndex:f,featureIndex:T,layoutVertexArrayOffset:0},y,g);return _}loadFeature(o){const{featureIndex:u,sourceLayerIndex:f}=o;this.loadVTLayers();const y=this.sourceLayerCoder.decode(f),g=this.vtFeatures[y];if(g[u])return g[u];const _=this.vtLayers[y].feature(u);return g[u]=_,_}hasLayer(o){for(const u of this.bucketLayerIDs)for(const f of u)if(o===f)return!0;return!1}getId(o,u){let f=o.id;if(this.promoteId){const y=Array.isArray(this.promoteId)||typeof this.promoteId!="object"?this.promoteId:this.promoteId[u];if(y!=null)if(Array.isArray(y)){if(!this.promoteIdExpression){const g=hf(y);if(g.result!=="success"){const _=g.value.map(T=>`${T.key}: ${T.message}`).join(", ");return void _i(`Failed to create expression for promoteId: ${_}`)}this.promoteIdExpression=g.value}this.promoteIdExpression._evaluator||(this.promoteIdExpression._evaluator=new Rx),f=this.promoteIdExpression.evaluate({zoom:0},o)}else f=o.properties[y];typeof f=="boolean"&&(f=Number(f))}return f}}function aU(m,o,u,f,y){return xo(m,(g,_)=>{const T=o instanceof vf?o.get(_):null;return T&&T.evaluate?T.evaluate(u,f,y):T})}function Xpe(m,o){return o-m}lr(sU,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});const oU=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class NI{static from(o){if(!(o instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[u,f]=new Uint8Array(o,0,2);if(u!==219)throw new Error("Data does not appear to be in a KDBush format.");const y=f>>4;if(y!==1)throw new Error(`Got v${y} data when expected v1.`);const g=oU[15&f];if(!g)throw new Error("Unrecognized array type.");const[_]=new Uint16Array(o,2,1),[T]=new Uint32Array(o,4,1);return new NI(T,_,g,o)}constructor(o,u=64,f=Float64Array,y){if(isNaN(o)||o<0)throw new Error(`Unpexpected numItems value: ${o}.`);this.numItems=+o,this.nodeSize=Math.min(Math.max(+u,2),65535),this.ArrayType=f,this.IndexArrayType=o<65536?Uint16Array:Uint32Array;const g=oU.indexOf(this.ArrayType),_=2*o*this.ArrayType.BYTES_PER_ELEMENT,T=o*this.IndexArrayType.BYTES_PER_ELEMENT,E=(8-T%8)%8;if(g<0)throw new Error(`Unexpected typed array class: ${f}.`);y&&y instanceof ArrayBuffer?(this.data=y,this.ids=new this.IndexArrayType(this.data,8,o),this.coords=new this.ArrayType(this.data,8+T+E,2*o),this._pos=2*o,this._finished=!0):(this.data=new ArrayBuffer(8+_+T+E),this.ids=new this.IndexArrayType(this.data,8,o),this.coords=new this.ArrayType(this.data,8+T+E,2*o),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+g]),new Uint16Array(this.data,2,1)[0]=u,new Uint32Array(this.data,4,1)[0]=o)}add(o,u){const f=this._pos>>1;return this.ids[f]=f,this.coords[this._pos++]=o,this.coords[this._pos++]=u,f}finish(){const o=this._pos>>1;if(o!==this.numItems)throw new Error(`Added ${o} items when expected ${this.numItems}.`);return SI(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(o,u,f,y){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:g,coords:_,nodeSize:T}=this,E=[0,g.length-1,0],O=[];for(;E.length;){const C=E.pop()||0,M=E.pop()||0,D=E.pop()||0;if(M-D<=T){for(let X=D;X<=M;X++){const J=_[2*X],ne=_[2*X+1];J>=o&&J<=f&&ne>=u&&ne<=y&&O.push(g[X])}continue}const I=D+M>>1,R=_[2*I],H=_[2*I+1];R>=o&&R<=f&&H>=u&&H<=y&&O.push(g[I]),(C===0?o<=R:u<=H)&&(E.push(D),E.push(I-1),E.push(1-C)),(C===0?f>=R:y>=H)&&(E.push(I+1),E.push(M),E.push(1-C))}return O}within(o,u,f){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:y,coords:g,nodeSize:_}=this,T=[0,y.length-1,0],E=[],O=f*f;for(;T.length;){const C=T.pop()||0,M=T.pop()||0,D=T.pop()||0;if(M-D<=_){for(let X=D;X<=M;X++)cU(g[2*X],g[2*X+1],o,u)<=O&&E.push(y[X]);continue}const I=D+M>>1,R=g[2*I],H=g[2*I+1];cU(R,H,o,u)<=O&&E.push(y[I]),(C===0?o-f<=R:u-f<=H)&&(T.push(D),T.push(I-1),T.push(1-C)),(C===0?o+f>=R:u+f>=H)&&(T.push(I+1),T.push(M),T.push(1-C))}return E}}function SI(m,o,u,f,y,g){if(y-f<=u)return;const _=f+y>>1;lU(m,o,_,f,y,g),SI(m,o,u,f,_-1,1-g),SI(m,o,u,_+1,y,1-g)}function lU(m,o,u,f,y,g){for(;y>f;){if(y-f>600){const O=y-f+1,C=u-f+1,M=Math.log(O),D=.5*Math.exp(2*M/3),I=.5*Math.sqrt(M*D*(O-D)/O)*(C-O/2<0?-1:1);lU(m,o,u,Math.max(f,Math.floor(u-C*D/O+I)),Math.min(y,Math.floor(u+(O-C)*D/O+I)),g)}const _=o[2*u+g];let T=f,E=y;for(zw(m,o,f,u),o[2*y+g]>_&&zw(m,o,f,y);T<E;){for(zw(m,o,T,E),T++,E--;o[2*T+g]<_;)T++;for(;o[2*E+g]>_;)E--}o[2*f+g]===_?zw(m,o,f,E):(E++,zw(m,o,E,y)),E<=u&&(f=E+1),u<=E&&(y=E-1)}}function zw(m,o,u,f){CI(m,u,f),CI(o,2*u,2*f),CI(o,2*u+1,2*f+1)}function CI(m,o,u){const f=m[o];m[o]=m[u],m[u]=f}function cU(m,o,u,f){const y=m-u,g=o-f;return y*y+g*g}s.$=ao,s.A=Ro,s.B=Yc,s.C=wf,s.D=Ry,s.E=lc,s.F=2,s.G=yw,s.H=gV,s.I=vo,s.J=class extends JC{},s.K=Mu,s.L=kn,s.M=rC,s.N=b1,s.O=df,s.P=dt,s.Q=qS,s.R=Ps,s.S=ey,s.T=nI,s.U=cy,s.V=JC,s.W=N1,s.X=hf,s.Y=kg,s.Z=zu,s._=af,s.a=function(m){return pe.API_CDN_URL_REGEX.test(m)},s.a$=Y,s.a0=Dl,s.a1=R1,s.a2=Jx,s.a3=Xx,s.a4=function(m){const o=m.value;let u=[];if(!o)return u;const f=Mu(o);return f!=="string"?(u=u.concat([new JC(m.key,o,`string expected, "${f}" found`)]),u):(s7(o,!0)||(u=u.concat([new JC(m.key,o,`invalid url "${o}"`)])),u)},s.a5=ut,s.a6=O1,s.a7=Ki,s.a8=Vt,s.a9=class{constructor(m){this.specification=m}possiblyEvaluate(m,o){return gi(m.expression.evaluate(o))}interpolate(m,o,u){return{x:Mr(m.x,o.x,u),y:Mr(m.y,o.y,u),z:Mr(m.z,o.z,u),azimuthal:Mr(m.azimuthal,o.azimuthal,u),polar:Mr(m.polar,o.polar,u)}}},s.aA=function(m,o){const u={};for(let f=0;f<o.length;f++){const y=o[f];y in m&&(u[y]=m[y])}return u},s.aB=Hd,s.aC=ka,s.aD=class{constructor(m){this.entries={},this.scheduler=m}request(m,o,u,f){const y=this.entries[m]=this.entries[m]||{callbacks:[]};if(y.result){const[g,_]=y.result;return this.scheduler?this.scheduler.add(()=>{f(g,_)},o):f(g,_),()=>{}}return y.callbacks.push(f),y.cancel||(y.cancel=u((g,_)=>{y.result=[g,_];for(const T of y.callbacks)this.scheduler?this.scheduler.add(()=>{T(g,_)},o):T(g,_);setTimeout(()=>delete this.entries[m],3e3)})),()=>{y.result||(y.callbacks=y.callbacks.filter(g=>g!==f),y.callbacks.length||(y.cancel(),delete this.entries[m]))}}},s.aE=function(m,o,u){const f=JSON.stringify(m.request);return m.data&&(this.deduped.entries[f]={result:[null,m.data]}),this.deduped.request(f,{type:"parseTile",isSymbolTile:m.isSymbolTile,zoom:m.tileZoom},y=>{const g=Rl(m.request,(_,T,E,O)=>{_?y(_):T&&y(null,{vectorTile:u?void 0:new Ef.VectorTile(new IC(T)),rawData:T,cacheControl:E,expires:O})});return()=>{g.cancel(),y()}},o)},s.aF=function(m){Ln++,Ln>Jr&&(m.getActor().send("enforceCacheSizeLimit",Ur),Ln=0)},s.aG=function(m){return m<=1?1:Math.pow(2,Math.floor(Math.log(m)/Math.LN2))},s.aH=It,s.aI=qV,s.aJ=JV,s.aK=HV,s.aL=function(m,o){const u=document.createElement("video");u.muted=!0,u.onloadstart=function(){o(null,u)};for(let f=0;f<m.length;f++){const y=document.createElement("source");xg(m[f])||(u.crossOrigin="Anonymous"),y.src=m[f],u.appendChild(y)}return{cancel:()=>{}}},s.aM=WC,s.aN=function(m){return fetch(m).then(o=>o.arrayBuffer()).then(o=>tU(o,0,m))},s.aO=nU,s.aP=class{constructor(m,o,u,f){this.id=m,this.position=o!=null?new $n(o[0],o[1]):new $n(0,0),this.orientation=u??[0,0,0],this.nodes=f,this.uploaded=!1,this.aabb=new xr([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(m,o){if(ge.mat4.multiply(m.matrix,o,m.matrix),m.meshes)for(const u of m.meshes){const f=xr.applyTransformFast(u.aabb,m.matrix);this.aabb.encapsulate(f)}if(m.children)for(const u of m.children)this._applyTransformations(u,m.matrix)}computeBoundsAndApplyParent(){const m=ge.mat4.identity([]);for(const o of this.nodes)this._applyTransformations(o,m)}computeModelMatrix(m,o,u,f,y,g,_=!1){u7(this.matrix,this,m.transform,this.position,o,u,f,y,g,_)}upload(m){if(!this.uploaded){for(const o of this.nodes)lI(o,m);for(const o of this.nodes)QC(o);this.uploaded=!0}}destroy(){for(const m of this.nodes)cI(m)}},s.aQ=Il,s.aR=_w,s.aS=Lo,s.aT=ba,s.aU=$u,s.aV=va,s.aW=Xs,s.aX=Ug,s.aY=HC,s.aZ=function(){Fl.isLoading()||Fl.isLoaded()||oy()!=="deferred"||tC()},s.a_=D1,s.aa=hi,s.ab=mf,s.ac=c,s.ad=ge,s.ae=an,s.af=vf,s.ag=_o,s.ah=Mr,s.ai=Wt,s.aj=TS,s.ak=Ye,s.al=Xn,s.am=class{constructor(m){this.specification=m}possiblyEvaluate(m,o){return function([u,f]){const y=gi([1,u,f]);return{x:y.x,y:y.y,z:y.z}}(m.expression.evaluate(o))}interpolate(m,o,u){return{x:Mr(m.x,o.x,u),y:Mr(m.y,o.y,u),z:Mr(m.z,o.z,u)}}},s.an=function(m,o,u=0,f=!0){const y=new dt(u,u),g=m.sub(y),_=o.add(y),T=[g,new dt(_.x,g.y),_,new dt(g.x,_.y)];return f&&T.push(g.clone()),T},s.ao=function(m,o){const u=[];for(let f=0;f<m.length;f++){const y=ai(f-1,-1,m.length-1),g=ai(f+1,-1,m.length-1),_=m[f],T=m[g],E=m[y].sub(_).unit(),O=T.sub(_).unit(),C=O.angleWithSep(E.x,E.y),M=E.add(O).unit().mult(-1*o/Math.sin(C/2));u.push(_.add(M))}return u},s.ap=EV,s.aq=Be,s.ar=function(m,o,u=0){return ge.vec3.fromValues(((o.x-u)*m.scale-m.x)*Wt,(o.y*m.scale-m.y)*Wt,nw(o.z,o.y))},s.as=zr,s.at=G8,s.au=function(m){let o=1/0,u=1/0,f=-1/0,y=-1/0;for(const g of m)o=Math.min(o,g.x),u=Math.min(u,g.y),f=Math.max(f,g.x),y=Math.max(y,g.y);return{min:new dt(o,u),max:new dt(f,y)}},s.av=eu,s.aw=Fe,s.ax=v,s.ay=rr,s.az=oo,s.b=function(m){return pe.API_FONTS_REGEX.test(m)},s.b$=YC,s.b0=$y,s.b1=la,s.b2=D4,s.b3=k4,s.b4=K,s.b5=Bu,s.b6=xy,s.b7=Er,s.b8=Ti,s.b9=ow,s.bA=w8,s.bB=W4,s.bC=NV,s.bD=G4,s.bE=NI,s.bF=ai,s.bG=Kc,s.bH=Pa,s.bI=function(m,o,u){m[4*o+0]=u[0],m[4*o+1]=u[1],m[4*o+2]=u[2],m[4*o+3]=u[3]},s.bJ=Xg,s.bK=$l,s.bL=Sf,s.bM=gs,s.bN=Zg,s.bO=$n,s.bP=DV,s.bQ=pt,s.bR=Zr,s.bS=e7,s.bT=Et,s.bU=Wa,s.bV=function(m,o,u,f,y,g,_,T,E){if(E.name==="globe")return Wa(m,o,new Et(u,f,y),!1);const O=_w({z:u,x:f,y},E);return new xr([(g+O.x/O.scale)*o,o*(O.y/O.scale),_],[(g+O.x2/O.scale)*o,o*(O.y2/O.scale),T])},s.bW=function(m,o,u){let f=0;for(let y=0;y<2;++y)m[y]>0&&(f+=(m[y]-0)*(m[y]-0)),o[y]<0&&(f+=(0-o[y])*(0-o[y]));return f},s.bX=ds,s.bY=vC,s.bZ=function(m){const o=ge.mat4.identity(new Float64Array(16));ge.mat4.multiply(o,m.pixelMatrix,m.globeMatrix);const u=[0,cl,0],f=[0,ul,0];return ge.vec3.transformMat4(u,u,o),ge.vec3.transformMat4(f,f,o),[u[0]>0&&u[0]<=m.width&&u[1]>0&&u[1]<=m.height&&!Bo(m,new $n(m.center.lat,90)),f[0]>0&&f[0]<=m.width&&f[1]>0&&f[1]<=m.height&&!Bo(m,new $n(m.center.lat,-90))]},s.b_=function(m,o){const{scale:u}=m.tileTransform,f=u*Wt/(m.tileSize*Math.pow(2,o.zoom-m.tileID.overscaledZ+m.tileID.canonical.z));return ge.mat2.scale(new Float32Array(4),o.inverseAdjustmentMatrix,[f,f])},s.ba=eI,s.bb=function(m,o){const u=_o(o.zoom);if(u===0)return Gs(m);const f=Pn(m),y=Pi(f),g=eu(f.getWest())*o.worldSize,_=eu(f.getEast())*o.worldSize,T=ka(f.getNorth())*o.worldSize,E=ka(f.getSouth())*o.worldSize,O=[g,T,0],C=[_,T,0],M=[g,E,0],D=[_,E,0],I=ge.mat4.invert([],o.globeMatrix);return ge.vec3.transformMat4(O,O,I),ge.vec3.transformMat4(C,C,I),ge.vec3.transformMat4(M,M,I),ge.vec3.transformMat4(D,D,I),y[0]=Qs(y[0],M,u),y[1]=Qs(y[1],D,u),y[2]=Qs(y[2],C,u),y[3]=Qs(y[3],O,u),xr.fromPoints(y)},s.bc=ji,s.bd=Un,s.be=Qs,s.bf=jf,s.bg=qr,s.bh=cA,s.bi=IC,s.bj=Rl,s.bk=function(m,o){const u=[];for(const f in m)f in o||u.push(f);return u},s.bl=ri,s.bm=["type","source","source-layer","minzoom","maxzoom","filter","layout"],s.bn=Yr,s.bo=function(m,o){const{x:u,y:f}=m.point,y=Vl(u,f,m.worldSize/m._pixelsPerMercatorPixel,0,0);return ge.mat4.multiply(y,y,Hs(Gs(o)))},s.bp=Ay,s.bq=hl,s.br=MC,s.bs=function(m,o,u,f,y){const g=5*o+2;m.float32[g+0]=u,m.float32[g+1]=f,m.float32[g+2]=y},s.bt=GC,s.bu=pV,s.bv=de,s.bw=Ma,s.bx=g8,s.by=i7,s.bz=_8,s.c=De,s.c$=K8,s.c0=QV,s.c1=function(m){const o=QV(m,!0);return ge.mat2.invert([],[o[0],o[1],o[4],o[5]])},s.c2=bn,s.c3=function(m){const{x:o,y:u}=m.point,{lng:f,lat:y}=m._center;return Vl(o,u,m.worldSize,f,y)},s.c4=Nt,s.c5=Kt,s.c6=Cf,s.c7=function(m){const o=Math.round((m+45+360)%360/90)%4;return zt[o]},s.c8=45,s.c9=kS,s.cA=gC,s.cB=class extends Qc{constructor(m){super(m),this.current=Q1}set(m,o,u){if(this.fetchUniformLocation(m,o)){for(let f=0;f<9;f++)if(u[f]!==this.current[f]){this.current=u,this.gl.uniformMatrix3fv(this.location,!1,u);break}}}},s.cC=Nr,s.cD=function(m,o,u){const f=_o(u.zoom),y=m.style.map._antialias,g=m.terrain&&m.terrain.exaggeration()>0;return f===0&&!y&&!g},s.cE=function(m){const o=m.pixelsPerMeter,u=o/Pa(1,m.center.lat),f=ge.mat4.identity(new Float64Array(16));return ge.mat4.translate(f,f,[m.point.x,m.point.y,0]),ge.mat4.scale(f,f,[u,u,o]),Float32Array.from(f)},s.cF=Pn,s.cG=function(m){const o=ds-5;m=rr(m,-o,o)/o*90;const u=Math.pow(Math.abs(Math.sin(Ye(m))),3);return Math.round(u*(jy.length-1))},s.cH=function(m,o,u,f){const y=o.getNorth(),g=o.getSouth(),_=o.getWest(),T=o.getEast(),E=1<<m.z,O=T-_,C=y-g,M=O/Af,D=-C/jy[u],I=[0,M,0,D,0,0,y,_,0];if(m.z>0){const R=180/f;ge.mat3.multiply(I,I,[R/O+1,0,0,0,R/C+1,0,-.5*R/M,.5*R/D,1])}return I[2]=E,I[5]=m.x,I[8]=m.y,I},s.cI=Gs,s.cJ=function(m,o,u){const f=ge.mat4.identity(new Float64Array(16)),y=(o/(1<<m)-.5)*Math.PI*2;return ge.mat4.rotateY(f,u.globeMatrix,y),Float32Array.from(f)},s.cK=class{isDataAvailableAtPoint(m){const o=this._source();if(this.isUsingMockSource()||!o||m.y<0||m.y>1)return!1;const u=o.getSource().maxzoom,f=1<<u,y=Math.floor(m.x),g=Math.floor((m.x-y)*f),_=Math.floor(m.y*f),T=this.findDEMTileFor(new It(u,y,u,g,_));return!(!T||!T.dem)}getAtPointOrZero(m,o=0){return this.getAtPoint(m,o)||0}getAtPoint(m,o,u=!0){if(this.isUsingMockSource())return null;o==null&&(o=null);const f=this._source();if(!f||m.y<0||m.y>1)return o;const y=f.getSource().maxzoom,g=1<<y,_=Math.floor(m.x),T=m.x-_,E=new It(y,_,y,Math.floor(T*g),Math.floor(m.y*g)),O=this.findDEMTileFor(E);if(!O||!O.dem)return o;const C=O.dem,M=1<<O.tileID.canonical.z,D=(T*M-O.tileID.canonical.x)*C.dim,I=(m.y*M-O.tileID.canonical.y)*C.dim,R=Math.floor(D),H=Math.floor(I);return(u?this.exaggeration():1)*Mr(Mr(C.get(R,H),C.get(R,H+1),I-H),Mr(C.get(R+1,H),C.get(R+1,H+1),I-H),D-R)}getAtTileOffset(m,o,u){const f=1<<m.canonical.z;return this.getAtPointOrZero(new c(m.wrap+(m.canonical.x+o/Wt)/f,(m.canonical.y+u/Wt)/f))}getAtTileOffsetFunc(m,o,u,f){return y=>{const g=this.getAtTileOffset(m,y.x,y.y),_=f.upVector(m.canonical,y.x,y.y),T=f.upVectorScale(m.canonical,o,u).metersToTile;return ge.vec3.scale(_,_,g*T),_}}getForTilePoints(m,o,u,f){if(this.isUsingMockSource())return!1;const y=Oy.create(this,m,f);return!!y&&(o.forEach(g=>{g[2]=this.exaggeration()*y.getElevationAt(g[0],g[1],u)}),!0)}getMinMaxForTile(m){if(this.isUsingMockSource())return null;const o=this.findDEMTileFor(m);if(!o||!o.dem)return null;const u=o.dem.tree,f=o.tileID,y=1<<m.canonical.z-f.canonical.z;let g=m.canonical.x/y-f.canonical.x,_=m.canonical.y/y-f.canonical.y,T=0;for(let E=0;E<m.canonical.z-f.canonical.z&&!u.leaves[T];E++){g*=2,_*=2;const O=2*Math.floor(_)+Math.floor(g);T=u.childOffsets[T]+O,g%=1,_%=1}return{min:this.exaggeration()*u.minimums[T],max:this.exaggeration()*u.maximums[T]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(m,o,u){throw new Error("Pure virtual method called.")}pointCoordinate(m){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(m){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}getMinMaxForVisibleTiles(){const m=this.visibleDemTiles;if(m.length===0)return null;let o=!1,u=Number.MAX_VALUE,f=Number.MIN_VALUE;for(const y of m){const g=this.getMinMaxForTile(y.tileID);g&&(u=Math.min(u,g.min),f=Math.max(f,g.max),o=!0)}return o?{min:u,max:f}:null}},s.cL=q$,s.cM=Nn,s.cN=function(m,o){return[Math.pow(m[0],2.2)*o,Math.pow(m[1],2.2)*o,Math.pow(m[2],2.2)*o]},s.cO=Fo,s.cP=bt,s.cQ=Oh,s.cR=256,s.cS=function(m,o){const u=[0,0,0],f=ji(Gs(o.canonical));return ge.vec3.transformMat4(u,u,f),ge.vec3.transformMat4(u,u,m),u},s.cT=m=>({u_camera_to_center_distance:new gs(m),u_extrude_scale:new ew(m),u_device_pixel_ratio:new gs(m),u_matrix:new Xg(m),u_inv_rot_matrix:new Xg(m),u_merc_center:new $l(m),u_tile_id:new Sf(m),u_zoom_transition:new gs(m),u_up_dir:new Sf(m),u_emissive_strength:new gs(m)}),s.cU=m=>({u_matrix:new Xg(m),u_pixels_to_tile_units:new ew(m),u_device_pixel_ratio:new gs(m),u_width_scale:new gs(m),u_floor_width_scale:new gs(m),u_units_to_pixels:new $l(m),u_dash_image:new Zg(m),u_gradient_image:new Zg(m),u_image_height:new gs(m),u_texsize:new $l(m),u_tile_units_to_pixels:new gs(m),u_alpha_discard_threshold:new gs(m),u_trim_offset:new $l(m),u_trim_fade_range:new $l(m),u_trim_color:new Yg(m),u_emissive_strength:new gs(m),u_zbias_factor:new gs(m),u_tile_to_meter:new gs(m)}),s.cV=m=>({u_matrix:new Xg(m),u_texsize:new $l(m),u_pixels_to_tile_units:new ew(m),u_device_pixel_ratio:new gs(m),u_width_scale:new gs(m),u_floor_width_scale:new gs(m),u_image:new Zg(m),u_units_to_pixels:new $l(m),u_tile_units_to_pixels:new gs(m),u_alpha_discard_threshold:new gs(m),u_trim_offset:new $l(m),u_trim_fade_range:new $l(m),u_trim_color:new Yg(m),u_emissive_strength:new gs(m),u_zbias_factor:new gs(m),u_tile_to_meter:new gs(m)}),s.cW=H1,s.cX=efe,s.cY=tfe,s.cZ=kf,s.c_=(m,o,u,f,y,g)=>{const _=m.transform,T=_.projection.name==="globe";let E;if(g.paint.get("circle-pitch-alignment")==="map")if(T){const C=Fo(_.zoom,o.canonical)*_._pixelsPerMercatorPixel;E=Float32Array.from([C,0,0,C])}else E=_.calculatePixelsToTileUnitsMatrix(u);else E=new Float32Array([_.pixelsToGLUnits[0],0,0,_.pixelsToGLUnits[1]]);const O={u_camera_to_center_distance:m.transform.getCameraToCenterDistance(_.projection),u_matrix:m.translatePosMatrix(o.projMatrix,u,g.paint.get("circle-translate"),g.paint.get("circle-translate-anchor")),u_device_pixel_ratio:vt.devicePixelRatio,u_extrude_scale:E,u_inv_rot_matrix:iw,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:g.paint.get("circle-emissive-strength")};if(T){O.u_inv_rot_matrix=f,O.u_merc_center=y,O.u_tile_id=[o.canonical.x,o.canonical.y,1<<o.canonical.z],O.u_zoom_transition=_o(_.zoom);const C=y[0]*Wt,M=y[1]*Wt;O.u_up_dir=_.projection.upVector(new Et(0,0,0),C,M)}return O},s.ca=Ny,s.cb=Yg,s.cc=function(m,o,u){const f=Math.sqrt(m*m+o*o+u*u),y=f>0?Math.acos(u/f)*Yn:0;let g=m!==0||o!==0?Math.atan2(-o,-m)*Yn+90:0;return g<0&&(g+=360),[f,g,y]},s.cd=b,s.ce=xr,s.cf=gi,s.cg=function(m){return[Math.pow(m[0],1/2.2),Math.pow(m[1],1/2.2),Math.pow(m[2],1/2.2)]},s.ch=function(m,o){return m.readFields(Kfe,{icons:[]},o)},s.ci=function(m){return m({pluginStatus:bo,pluginURL:Fd}),pf.on("pluginStateChange",m),m},s.cj=tA,s.ck=Py,s.cl=H4,s.cm=Pd,s.cn=zg,s.co=nr,s.cp=sl,s.cq=Vs,s.cr=function(m){const o=m.indexOf(dy);return o>=0?m.slice(0,o):m},s.cs=function(m){return m.indexOf(dy)>=0},s.ct=function(m){const o=m.indexOf(dy);return o>=0?m.slice(o+1):""},s.cu=function(m){const o=[],u=m.id;return u===void 0&&o.push({message:`layers.${u}: missing required property "id"`}),m.render===void 0&&o.push({message:`layers.${u}: missing required method "render"`}),m.renderingMode&&m.renderingMode!=="2d"&&m.renderingMode!=="3d"&&o.push({message:`layers.${u}: property "renderingMode" must be either "2d" or "3d"`}),o},s.cv=function(m,o,u,f){return m.type==="custom"?new Ofe(m,o):new Hfe[m.type](m,o,u,f)},s.cw=nl,s.cx=class extends $y{constructor(m,o){super(m._vectorTileFeature,m._z,m._x,m._y,m.id),m.state&&(this.state=Object.assign({},m.state)),this.target=o.target,this.namespace=o.namespace,o.properties&&(this.properties=o.properties),this.target&&("featuresetId"in this.target&&!this.target.importId||"layerId"in this.target)&&(this.source=m.source,this.sourceLayer=m.sourceLayer,this.layer=m.layer)}toJSON(){const m=super.toJSON();return m.target=this.target,m.namespace=this.namespace,m}},s.cy=pf,s.cz=Oo,s.d=function(m){return pe.API_TILEJSON_REGEX.test(m)},s.d$=iU,s.d0=qa,s.d1=(m,o,u,f,y,g,_,T)=>{const E=m.transform,O=E.pitch<15?H8(.07,.7,rr((14-E.zoom)/5,0,1)):.07,C=u.paint.get("line-trim-color-use-theme").constantOr("default")==="none";return{u_matrix:W8(m,o,u,f),u_texsize:o.imageAtlasTexture?o.imageAtlasTexture.size:[0,0],u_pixels_to_tile_units:E.calculatePixelsToTileUnitsMatrix(o),u_device_pixel_ratio:y,u_width_scale:g,u_floor_width_scale:_,u_image:0,u_tile_units_to_pixels:q8(o,E),u_units_to_pixels:[1/E.pixelsToGLUnits[0],1/E.pixelsToGLUnits[1]],u_alpha_discard_threshold:0,u_trim_offset:T,u_trim_fade_range:u.paint.get("line-trim-fade-range"),u_trim_color:u.paint.get("line-trim-color").toRenderColor(C?null:u.lut).toArray01(),u_emissive_strength:u.paint.get("line-emissive-strength"),u_zbias_factor:O,u_tile_to_meter:b(o.tileID.canonical,0)}},s.d2=(m,o,u,f,y,g,_,T,E)=>{const O=m.transform,C=O.calculatePixelsToTileUnitsMatrix(o),M=u.paint.get("line-trim-color-use-theme").constantOr("default")==="none",D=O.pitch<15?H8(.07,.7,rr((14-O.zoom)/5,0,1)):.07;return{u_matrix:W8(m,o,u,f),u_pixels_to_tile_units:C,u_device_pixel_ratio:g,u_width_scale:_,u_floor_width_scale:T,u_units_to_pixels:[1/O.pixelsToGLUnits[0],1/O.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:y,u_texsize:Z8(u)&&o.lineAtlasTexture?o.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:q8(o,m.transform),u_alpha_discard_threshold:0,u_trim_offset:E,u_trim_fade_range:u.paint.get("line-trim-fade-range"),u_trim_color:u.paint.get("line-trim-color").toRenderColor(M?null:u.lut).toArray01(),u_emissive_strength:u.paint.get("line-emissive-strength"),u_zbias_factor:D,u_tile_to_meter:b(o.tileID.canonical,0)}},s.d3=rl,s.d4=aw,s.d5=nw,s.d6=R8,s.d7=Zt,s.d8=EC,s.d9=Mf,s.dA=TC,s.dB=br,s.dC=function(){return!!document.fullscreenElement||!!document.webkitFullscreenElement},s.dD=hr,s.dE=y4,s.dF=Kh,s.dG=function([m,o,u]){const f=Math.hypot(m,o,u),y=Math.atan2(m,u),g=.5*Math.PI-Math.acos(-o/f);return new $n(Nt(y),Nt(g))},s.dH=sI,s.dI=function(m){const o=m.navigator?m.navigator.userAgent:null;return!!function(u){if(Ol==null){const f=u.navigator?u.navigator.userAgent:null;Ol=!!u.safari||!(!f||!(/\b(iPad|iPhone|iPod)\b/.test(f)||f.match("Safari")&&!f.match("Chrome")))}return Ol}(m)&&o&&(o.match("Version/15.4")||o.match("Version/15.5")||o.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},s.dJ=function(m,o){Ur=m,Jr=o},s.dK=Bo,s.dL=Ul,s.dM=function(m){const o=[0,0,0],u=ge.mat4.identity(new Float64Array(16));return ge.mat4.multiply(u,m.pixelMatrix,m.globeMatrix),ge.vec3.transformMat4(o,o,u),new dt(o[0],o[1])},s.dN=function(m,o,u=!1){if(bo===P1||bo===Jc||bo===E1)throw new Error("setRTLTextPlugin cannot be called multiple times.");Fd=vt.resolveURL(m),bo=P1,M1=o,ay(),u||tC()},s.dO=oy,s.dP=function(){tA().acquire(dI)},s.dQ=function(){const m=kw;m&&(m.isPreloaded()&&m.numActive()===1?(m.release(dI),kw=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},s.dR=s0,s.dS=function(m){const o=Ci();if(!o)return;const u=o.delete(or);m&&u.catch(m).then(()=>m())},s.dT=Tw,s.dU=K7,s.dV=function(m){bI=vt.resolveURL(m),By||(By=new Ry(tA(),new lc)),By.broadcast("setDracoUrl",bI)},s.dW=Z7,s.dX=function(m){Fy=vt.resolveURL(m),By||(By=new Ry(tA(),new lc)),By.broadcast("setMeshoptUrl",Fy)},s.dY=lr,s.dZ=Pf,s.d_=Wu,s.da=450,s.db=7,s.dc=Ife,s.dd=Bn,s.de=by,s.df=256,s.dg=Hs,s.dh=hc,s.di=Do,s.dj=gy,s.dk=function(m,o,u,f,y){return rr((m-o)/(u-o)*(y-f)+f,f,y)},s.dl=g1,s.dm=qd,s.dn=class{constructor(m,o,u,f){this.context=m,this.format=f,this.size=u,this.texture=m.gl.createTexture();const[y,g,_]=this.size,{gl:T}=m;T.bindTexture(T.TEXTURE_3D,this.texture),m.pixelStoreUnpackFlipY.set(!1),m.pixelStoreUnpack.set(1),m.pixelStoreUnpackPremultiplyAlpha.set(!1),T.texImage3D(T.TEXTURE_3D,0,this.format,y,g,_,0,tI(this.format),rI(this.format),o.data)}bind(m,o){const{context:u}=this,{gl:f}=u;f.bindTexture(f.TEXTURE_3D,this.texture),m!==this.minFilter&&(f.texParameteri(f.TEXTURE_3D,f.TEXTURE_MAG_FILTER,m),f.texParameteri(f.TEXTURE_3D,f.TEXTURE_MIN_FILTER,m),this.minFilter=m),o!==this.wrapS&&(f.texParameteri(f.TEXTURE_3D,f.TEXTURE_WRAP_S,o),f.texParameteri(f.TEXTURE_3D,f.TEXTURE_WRAP_T,o),this.wrapS=o)}destroy(){const{gl:m}=this.context;m.deleteTexture(this.texture),this.texture=null}},s.dp=aI,s.dq=[1,1,1],s.dr=Oy,s.ds=Iy,s.dt=Vd,s.du=Nf,s.dv=Zh,s.dw=K1,s.dx=W1,s.dy=class{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[],this._globalClipBounds={min:new dt(1/0,1/0),max:new dt(-1/0,-1/0)}}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(m,o=!1){const u=y8(new dt(0,0),new dt(Wt,Wt),m),f=[];if(o&&!E4(u,this._globalClipBounds))return f;for(const y of this._activeRegions){if(y.hiddenByOverlap||!E4(u,y))continue;const g=Ame(y.min,y.max,m);f.push({min:g.min,max:g.max,sourceId:this._sourceIds[y.priority],footprint:y.footprint,footprintTileId:y.tileId,order:y.order,clipMask:y.clipMask,clipScope:y.clipScope})}return f}setSources(m){this._setSources(m.map(o=>({getSourceId:()=>o.cache.id,getFootprints:()=>{const u=[];for(const f of o.cache.getVisibleCoordinates()){const y=o.cache.getTile(f).buckets[o.layer];y&&y.updateFootprints(f.toUnwrapped(),u)}return u},getOrder:()=>o.order,getClipMask:()=>o.clipMask,getClipScope:()=>o.clipScope})))}_addSource(m){const o=m.getFootprints();if(o.length===0)return;const u=m.getOrder(),f=m.getClipMask(),y=m.getClipScope();for(const g of o){if(!g.footprint)continue;const _=y8(g.footprint.min,g.footprint.max,g.id);this._activeRegions.push({min:_.min,max:_.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:g.id,footprint:g.footprint,order:u,clipMask:f,clipScope:y})}this._sourceIds.push(m.getSourceId())}_computeReplacement(){this._activeRegions.sort((o,u)=>o.priority-u.priority||kC(o.min,u.min)||kC(o.max,u.max)||o.order-u.order||o.clipMask-u.clipMask||function(f,y){const g=(_,T)=>_+T;return f.length-y.length||f.reduce(g,"").localeCompare(y.reduce(g,""))}(o.clipScope,u.clipScope));let m=this._activeRegions.length!==this._prevRegions.length;if(!m){let o=0;for(;!m&&o!==this._activeRegions.length;){const u=this._activeRegions[o],f=this._prevRegions[o];m=u.priority!==f.priority||!x8(u,f)||u.order!==f.order||u.clipMask!==f.clipMask||!Yr(u.clipScope,f.clipScope),++o}}if(m){++this._updateTime;for(const u of this._activeRegions)u.order!==TC&&(this._globalClipBounds.min.x=Math.min(this._globalClipBounds.min.x,u.min.x),this._globalClipBounds.min.y=Math.min(this._globalClipBounds.min.y,u.min.y),this._globalClipBounds.max.x=Math.max(this._globalClipBounds.max.x,u.max.x),this._globalClipBounds.max.y=Math.max(this._globalClipBounds.max.y,u.max.y));const o=u=>{const f=this._activeRegions;if(u>=f.length)return u;const y=f[u].priority;for(;u<f.length&&f[u].priority===y;)++u;return u};if(this._sourceIds.length>1){let u=0,f=o(u);for(;u!==f;){let y=u;const g=u;for(;y!==f;){const _=this._activeRegions[y];_.hiddenByOverlap=!1;for(let T=0;T<g;T++){const E=this._activeRegions[T];if(!E.hiddenByOverlap&&_.order===TC&&E4(_,E)&&(_.hiddenByOverlap=b8(_.footprint,_.tileId,E.footprint,E.tileId),_.hiddenByOverlap))break}++y}u=f,f=o(u)}}}}_setSources(m){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let o=m.length-1;o>=0;o--)this._addSource(m[o]);this._computeReplacement()}},s.dz=class{constructor(m){this._createGrid(m),this._createPoles(m)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const m of this._poleSegments)m.destroy();for(const m of this._gridSegments)m.withSkirts.destroy(),m.withoutSkirts.destroy()}_fillGridMeshWithLods(m,o){const u=new Bu,f=new va,y=[],g=m+1+2,_=o[0]+1,T=o[0]+1+(1+o.length),E=(O,C,M)=>{let D=O===g-1?O-2:O===0?O:O-1;return D+=M?24575:0,[D,C]};for(let O=0;O<g;++O)u.emplaceBack(...E(O,0,!0));for(let O=0;O<_;++O)for(let C=0;C<g;++C)u.emplaceBack(...E(C,O,(C===0||C===g-1)&&!0));for(let O=0;O<o.length;++O){const C=o[O];for(let M=0;M<g;++M)u.emplaceBack(...E(M,C,!0))}for(let O=0;O<o.length;++O){const C=f.length,M=o[O]+1+2,D=new va;for(let H=0;H<M-1;H++){const X=H===M-2,J=X?g*(T-o.length+O-H):g;for(let ne=0;ne<g-1;ne++){const re=H*g+ne;H===0||X||ne===0||ne===g-2?(D.emplaceBack(re+1,re,re+J),D.emplaceBack(re+J,re+J+1,re+1)):(f.emplaceBack(re+1,re,re+J),f.emplaceBack(re+J,re+J+1,re+1))}}const I=Ti.simpleSegment(0,C,u.length,f.length-C);for(let H=0;H<D.uint16.length;H+=3)f.emplaceBack(D.uint16[H],D.uint16[H+1],D.uint16[H+2]);const R=Ti.simpleSegment(0,C,u.length,f.length-C);y.push({withoutSkirts:I,withSkirts:R})}return{vertices:u,indices:f,segments:y}}_createGrid(m){const o=this._fillGridMeshWithLods(Af,jy);this._gridSegments=o.segments,this._gridBuffer=m.createVertexBuffer(o.vertices,Er.members),this._gridIndexBuffer=m.createIndexBuffer(o.indices,!0)}_createPoles(m){const o=new va;for(let _=0;_<=Af;_++)o.emplaceBack(0,_+1,_+2);this._poleIndexBuffer=m.createIndexBuffer(o,!0);const u=new Do,f=new Do,y=new Do,g=new Do;this._poleSegments=[];for(let _=0,T=0;_<Cf;_++){const E=360/(1<<_);u.emplaceBack(0,-oo,0,.5,0),f.emplaceBack(0,-oo,0,.5,1),y.emplaceBack(0,-oo,0,.5,.5),g.emplaceBack(0,-oo,0,.5,.5);for(let O=0;O<=Af;O++){let C=O/Af,M=0;const D=Mr(0,E,C),[I,R,H]=Tf(ru,Gu,D,oo);u.emplaceBack(I,R,H,C,M),f.emplaceBack(I,R,H,C,1-M);const X=Ye(D);C=.5+.5*Math.sin(X),M=.5+.5*Math.cos(X),y.emplaceBack(I,R,H,C,M),g.emplaceBack(I,R,H,C,1-M)}this._poleSegments.push(Ti.simpleSegment(T,0,66,64)),T+=66}this._poleNorthVertexBuffer=m.createVertexBuffer(u,gr,!1),this._poleSouthVertexBuffer=m.createVertexBuffer(f,gr,!1),this._texturedPoleNorthVertexBuffer=m.createVertexBuffer(y,gr,!1),this._texturedPoleSouthVertexBuffer=m.createVertexBuffer(g,gr,!1)}getGridBuffers(m,o){return[this._gridBuffer,this._gridIndexBuffer,o?this._gridSegments[m].withSkirts:this._gridSegments[m].withoutSkirts]}getPoleBuffers(m,o){return[o?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,o?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[m]]}},s.e=pe,s.e0=sU,s.e1=$8,s.e2=e0,s.e3="hd_road_elevation",s.e4=class{static parseFrom(m,o){const u=Yh.parse(m);if(!u)return[];let{vertices:f,features:y}=u;const g=1/b(o);y.sort((O,C)=>O.id-C.id),f.sort((O,C)=>O.id-C.id||O.idx-C.idx),f=f.filter((O,C,M)=>C===M.findIndex(D=>D.id===O.id&&D.idx===O.idx));const _=new Array;let T=0;const E=f.length;for(const O of y){if(O.constantHeight){_.push(new A4(O.id,O.bounds,O.constantHeight));continue}for(;T!==E&&f[T].id<O.id;)T++;if(T===E||f[T].id!==O.id)continue;const C=new Array,M=new Array,D=T;for(;T!==E&&f[T].id===O.id;){const I=f[T];if(C.push({position:I.position,height:I.height,extent:I.extent}),T!==D&&f[T-1].idx===I.idx-1){const R=T-D;M.push({a:R-1,b:R})}T++}_.push(new A4(O.id,O.bounds,void 0,C,M,g))}return _}},s.e5=xo,s.e6=t0,s.e7=xV,s.e8=ky,s.e9=function(m,o,u,f,y,g,_,T=1,E){m.createArrays(),m.tilePixelRatio=Wt/(512*m.overscaling),m.compareText={},m.iconsNeedLinear=!1;const O=m.layers[0].layout,C=m.layers[0]._unevaluatedLayout._values,M={};M.scaleFactor=T,M.textSizeScaleRange=O.get("text-size-scale-range"),M.iconSizeScaleRange=O.get("icon-size-scale-range");const[D,I]=M.textSizeScaleRange,[R,H]=M.iconSizeScaleRange;M.textScaleFactor=rr(M.scaleFactor,D,I),M.iconScaleFactor=rr(M.scaleFactor,R,H);const X=C["text-size"],J=C["icon-size"];if(m.textSizeData.kind==="composite"){const{minZoom:me,maxZoom:Me}=m.textSizeData;M.compositeTextSizes=[X.possiblyEvaluate(new hi(me),g),X.possiblyEvaluate(new hi(Me),g)]}if(m.iconSizeData.kind==="composite"){const{minZoom:me,maxZoom:Me}=m.iconSizeData;M.compositeIconSizes=[J.possiblyEvaluate(new hi(me),g),J.possiblyEvaluate(new hi(Me),g)]}M.layoutTextSize=X.possiblyEvaluate(new hi(_+1),g),M.layoutIconSize=J.possiblyEvaluate(new hi(_+1),g),M.textMaxSize=X.possiblyEvaluate(new hi(18),g);const ne=O.get("symbol-placement"),re=O.get("text-rotation-alignment")==="map"&&ne!=="point",te=O.get("text-size");let oe=!1;const ue=[];for(const me of m.features){const Me=O.get("text-font").evaluate(me,{},g).join(","),Se=te.evaluate(me,{},g)*M.textScaleFactor,Ae=M.layoutTextSize.evaluate(me,{},g)*M.textScaleFactor,Ve=M.layoutIconSize.evaluate(me,{},g)*M.iconScaleFactor,Ie={horizontal:{},vertical:void 0},Ge=me.text;let Ze,We=[0,0];if(Ge){const Rt=Ge.toString(),Pr=O.get("text-letter-spacing").evaluate(me,{},g)*Ma,ir=O.get("text-line-height").evaluate(me,{},g)*Ma,pr=s4(Rt)?Pr:0,Lr=O.get("text-anchor").evaluate(me,{},g),on=O.get("text-variable-anchor");if(!on){const Rn=O.get("text-radial-offset").evaluate(me,{},g);We=Rn?NV(Lr,[Rn*Ma,q4]):O.get("text-offset").evaluate(me,{},g).map(mi=>mi*Ma)}let $r=re?"center":O.get("text-justify").evaluate(me,{},g);const fn=ne==="point",sn=fn?O.get("text-max-width").evaluate(me,{},g)*Ma:1/0,pn=Rn=>{m.allowVerticalPlacement&&A1(Rt)&&(Ie.vertical=U4(Ge,o,u,y,Me,sn,ir,Lr,Rn,pr,We,hl.vertical,!0,Ae,Se,E))};if(!re&&on){const Rn=$r==="auto"?on.map(Fr=>W4(Fr)):[$r];let mi=!1;for(let Fr=0;Fr<Rn.length;Fr++){const Sn=Rn[Fr];if(!Ie.horizontal[Sn])if(mi)Ie.horizontal[Sn]=Ie.horizontal[0];else{const Ni=U4(Ge,o,u,y,Me,sn,ir,"center",Sn,pr,We,hl.horizontal,!1,Ae,Se,E);Ni&&(Ie.horizontal[Sn]=Ni,mi=Ni.positionedLines.length===1)}}pn("left")}else{if($r==="auto"&&($r=W4(Lr)),fn||O.get("text-writing-mode").indexOf("horizontal")>=0||!A1(Rt)){const Rn=U4(Ge,o,u,y,Me,sn,ir,Lr,$r,pr,We,hl.horizontal,!1,Ae,Se,E);Rn&&(Ie.horizontal[$r]=Rn)}pn(fn?"left":$r)}}let Qe,Je,ot,nt,ct,Ot=!1;if(me.icon&&me.icon.hasPrimary()){const Rt=CV(me.icon,m.iconSizeData,C["icon-size"],g,m.zoom,me,E,M.iconScaleFactor);Qe=Rt.iconPrimary,Je=Rt.iconSecondary;const Pr=Qe.toString(),ir=f.get(Pr);ir&&(ot=O.get("icon-offset").evaluate(me,{},g),nt=O.get("icon-anchor").evaluate(me,{},g),ct=O.get("icon-text-fit").evaluate(me,{},g),Ze=dfe(y.get(Pr),Je?y.get(Je.toString()):void 0,ot,nt),Ot=ir.sdf,m.sdfIcons===void 0?m.sdfIcons=ir.sdf:m.sdfIcons!==ir.sdf&&_i("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(ir.pixelRatio!==m.pixelRatio||O.get("icon-rotate").constantOr(1)!==0)&&(m.iconsNeedLinear=!0))}oe=oe||!(!me.icon||!me.icon.hasSecondary());const Mt=K4(Ie.horizontal)||Ie.vertical;m.iconsInText||(m.iconsInText=!!Mt&&Mt.iconsInText);const cr=Ae*M.textScaleFactor/Ma,{defaultShapedIcon:Lt,verticallyShapedIcon:Gt}=vfe(m,Ze,O,me,g,Ie,cr,ot,ct);Ze=Lt,ue.push({feature:me,shapedTextOrientations:Ie,shapedText:Mt,shapedIcon:Ze,iconPrimary:Qe,iconSecondary:Je,iconOffset:ot,iconAnchor:nt,verticallyShapedIcon:Gt,layoutTextSize:Ae,layoutIconSize:Ve,textOffset:We,isSDFIcon:Ot,iconTextFit:ct})}return{featureData:ue,sizes:M,hasAnySecondaryIcon:oe,textAlongLine:re,symbolPlacement:ne}},s.ea=yV,s.eb=function(m,o,u,f,y,g,_,T,E,O){const{featureData:C,hasAnySecondaryIcon:M,sizes:D,textAlongLine:I,symbolPlacement:R}=o;for(const H of C){const{shapedIcon:X,verticallyShapedIcon:J,feature:ne,shapedTextOrientations:re,shapedText:te,layoutTextSize:oe,textOffset:ue,isSDFIcon:me,iconPrimary:Me,iconSecondary:Se,iconTextFit:Ae,iconOffset:Ve}=H;AV(X,O.iconPositions,Me,Se),AV(J,O.iconPositions,Me,Se),yfe(re,O.iconPositions),(te||X)&&bfe(m,ne,re,X,J,E,D,oe,0,ue,me,f,y,_,T,M,Ae,Ve,I,R)}u&&m.generateCollisionDebugBuffers(g,m.collisionBoxArray,D.textScaleFactor)},s.ec=Ef,s.ed=lA,s.ee=jr,s.ef=i8,s.eg=rV,s.eh=p,s.ei=function(m){let o=0;if(new Uint32Array(m,0,1)[0]!==X7){const u=new Uint32Array(m,0,7),[,,f,y,g,_]=u;o=u.byteLength+y+g+_+g,(f!==m.byteLength||o>=m.byteLength)&&_i("Invalid b3dm header information.")}return tU(m,o)},s.ej=function(m,o){const u=nU(m);for(const f of u){for(const y of f.meshes)Kpe(y);f.lights&&(f.lightMeshIndex=f.meshes.length,f.meshes.push(Zpe(f.lights,o)))}return u},s.ek=eA,s.el=g7,s.em=Fl,s.en=function(m){hn(),nn!=null&&nn.then(o=>{o.keys().then(u=>{for(let f=0;f<u.length-m;f++)o.delete(u[f])})})},s.f=function(m){return m.indexOf("mapbox:")===0},s.g=function(m,o){return Oo(Ui(m,{method:"GET"}),o)},s.h=be,s.i=function(m){return pe.API_STYLE_REGEX.test(m)&&!De(m)},s.j=function(m){return decodeURIComponent(atob(m).split("").map(o=>"%"+("00"+o.charCodeAt(0).toString(16)).slice(-2)).join(""))},s.k=function(m){return btoa(encodeURIComponent(m).replace(/%([0-9A-F]{2})/g,(o,u)=>String.fromCharCode(+("0x"+u))))},s.l=Ui,s.m=Wn,s.n=function(m,o){return Oo(Ui(m,{type:"json"}),o)},s.o=Md,s.p=function(m,o){return Oo(Ui(m,{method:"POST"}),o)},s.q=vt,s.r=Ea,s.s=function(m){try{const o=self[m];return o.setItem("_mapbox_test_",1),o.removeItem("_mapbox_test_"),!0}catch{return!1}},s.t=wt,s.u=function(){return function m(o){return o?(o^Math.random()*(16>>o/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,m)}()},s.v=function(m){return!!m&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(m)},s.w=_i,s.x=function(){return hI||(hI=new s0),hI},s.y=gI,s.z=Wm}),l(["./shared"],function(s){function p(bt){const pe=bt?bt.url.toString():void 0;return pe?performance.getEntriesByName(pe):[]}function x(bt){if(typeof bt=="number"||typeof bt=="boolean"||typeof bt=="string"||bt==null)return JSON.stringify(bt);if(Array.isArray(bt)){let be="[";for(const De of bt)be+=`${x(De)},`;return`${be}]`}let pe="{";for(const be of Object.keys(bt).sort())pe+=`${be}:${x(bt[be])},`;return`${pe}}`}function w(bt){let pe="";for(const be of s.bm)(bt.type!=="model"||be!=="minzoom"&&be!=="maxzoom")&&(pe+=`/${x(bt[be])}`);return pe}class j{constructor(pe){this.keyCache={},this._layers={},this._layerConfigs={},pe&&this.replace(pe)}replace(pe,be){this._layerConfigs={},this._layers={},this.update(pe,[],be)}update(pe,be,De){this._options=De;for(const Ue of pe)this._layerConfigs[Ue.id]=Ue,(this._layers[Ue.id]=s.cv(Ue,this.scope,null,this._options)).compileFilter(De),this.keyCache[Ue.id]&&delete this.keyCache[Ue.id];for(const Ue of be)delete this.keyCache[Ue],delete this._layerConfigs[Ue],delete this._layers[Ue];this.familiesBySource={};const qe=function(Ue,Xe){const ht={};for(let xt=0;xt<Ue.length;xt++){const wt=Ue[xt];let vt=Xe&&Xe[wt.id];!vt&&(vt=w(wt),wt.type==="line"&&wt.paint)&&function nr(or){return typeof or=="string"&&or==="line-progress"||(Array.isArray(or)?or.some(nr):!(!or||typeof or!="object")&&Object.values(or).some(nr))}(wt.paint["line-width"])&&(vt+=`/${x(wt.paint["line-width"])}`),Xe&&(Xe[wt.id]=vt);let $t=ht[vt];$t||($t=ht[vt]=[]),$t.push(wt)}const et=[];for(const xt in ht)et.push(ht[xt]);return et}(Object.values(this._layerConfigs),this.keyCache);for(const Ue of qe){const Xe=Ue.map($t=>this._layers[$t.id]),ht=Xe[0];if(ht.visibility==="none")continue;const et=ht.source||"";let xt=this.familiesBySource[et];xt||(xt=this.familiesBySource[et]={});const wt=ht.sourceLayer||"_geojsonTileLayer";let vt=xt[wt];vt||(vt=xt[wt]=[]),vt.push(Xe)}}}const S=1*s.d_;class P{constructor(pe){const be={},De=[];for(const ht in pe){const et=pe[ht],xt=be[ht]={};for(const wt in et.glyphs){const vt=et.glyphs[+wt];if(!vt||vt.bitmap.width===0||vt.bitmap.height===0)continue;const $t=vt.metrics.localGlyph?S:1,nr={x:0,y:0,w:vt.bitmap.width+2*$t,h:vt.bitmap.height+2*$t};De.push(nr),xt[wt]=nr}}const{w:qe,h:Ue}=s.H(De),Xe=new s.dZ({width:qe||1,height:Ue||1});for(const ht in pe){const et=pe[ht];for(const xt in et.glyphs){const wt=et.glyphs[+xt];if(!wt||wt.bitmap.width===0||wt.bitmap.height===0)continue;const vt=be[ht][xt],$t=wt.metrics.localGlyph?S:1;s.dZ.copy(wt.bitmap,Xe,{x:0,y:0},{x:vt.x+$t,y:vt.y+$t},wt.bitmap)}}this.image=Xe,this.positions=be}}s.dY(P,"GlyphAtlas");class F{constructor(pe){this.tileID=new s.aH(pe.tileID.overscaledZ,pe.tileID.wrap,pe.tileID.canonical.z,pe.tileID.canonical.x,pe.tileID.canonical.y),this.tileZoom=pe.tileZoom,this.uid=pe.uid,this.zoom=pe.zoom,this.lut=pe.lut,this.canonical=pe.tileID.canonical,this.pixelRatio=pe.pixelRatio,this.tileSize=pe.tileSize,this.source=pe.source,this.scope=pe.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=pe.showCollisionBoxes,this.collectResourceTiming=!!pe.request&&pe.request.collectResourceTiming,this.promoteId=pe.promoteId,this.isSymbolTile=pe.isSymbolTile,this.tileTransform=s.aR(pe.tileID.canonical,pe.projection),this.projection=pe.projection,this.worldview=pe.worldview,this.localizableLayerIds=pe.localizableLayerIds,this.brightness=pe.brightness,this.extraShadowCaster=!!pe.extraShadowCaster,this.tessellationStep=pe.tessellationStep,this.scaleFactor=pe.scaleFactor}parse(pe,be,De,qe,Ue){this.status="parsing",this.data=pe,this.collisionBoxArray=new s.aX;const Xe=new s.d$(Object.keys(pe.layers).sort()),ht=new s.e0(this.tileID,this.promoteId);ht.bucketLayerIDs=[];const et={},xt=new s.e1(256,256),wt={featureIndex:ht,iconDependencies:new Map,patternDependencies:new Map,glyphDependencies:{},lineAtlas:xt,availableImages:De,brightness:this.brightness,scaleFactor:this.scaleFactor,elevationFeatures:void 0},vt=be.familiesBySource[this.source];for(const hn in vt){const Ln=pe.layers[hn];if(!Ln)continue;let Wn=!1,Kn=!1,Qi=!1;for(const Ca of vt[hn])Ca[0].type==="symbol"?Wn=!0:Kn=!0,Ca[0].is3D()&&Ca[0].type!=="model"&&(Qi=!0);if(this.extraShadowCaster&&!Qi||this.isSymbolTile===!0&&!Wn||this.isSymbolTile===!1&&!Kn)continue;Ln.version===1&&s.w(`Vector tile source "${this.source}" layer "${hn}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Us=Xe.encode(hn),ya=[];let Io=!1;for(let Ca=0,Ps=0;Ca<Ln.length;Ca++){const Js=Ln.feature(Ca),Pd=ht.getId(Js,hn);if(this.localizableLayerIds&&this.localizableLayerIds.has(hn)){const Oo=Js.properties?Js.properties.worldview:null;if(this.worldview&&typeof Oo=="string")if(Oo==="all")Js.properties.$localized=!0;else{if(!Oo.split(",").includes(this.worldview))continue;Js.properties.$localized=!0,Js.properties.worldview=this.worldview}}!Io&&Js.properties&&Js.properties.hasOwnProperty(s.e2)&&(Io=!0),ya.push({feature:Js,id:Pd,index:Ps,sourceLayerIndex:Us}),Ps++}Io&&!wt.elevationFeatures&&pe.layers.hasOwnProperty(s.e3)&&(wt.elevationFeatures=s.e4.parseFrom(pe.layers[s.e3],this.canonical));for(const Ca of vt[hn]){const Ps=Ca[0];(!this.extraShadowCaster||Ps.is3D()&&Ps.type!=="model")&&(this.isSymbolTile!==void 0&&Ps.type==="symbol"!==this.isSymbolTile||Ps.minzoom&&this.zoom<Math.floor(Ps.minzoom)||Ps.maxzoom&&this.zoom>=Ps.maxzoom||Ps.visibility!=="none"&&(L(Ca,this.zoom,wt.brightness,De),(et[Ps.id]=Ps.createBucket({index:ht.bucketLayerIDs.length,layers:Ca,zoom:this.zoom,lut:this.lut,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Us,sourceID:this.source,projection:this.projection.spec,tessellationStep:this.tessellationStep})).populate(ya,wt,this.tileID.canonical,this.tileTransform),ht.bucketLayerIDs.push(Ca.map(Js=>s.C(Js.id,Js.scope)))))}}let $t,nr,or,Ur,Jr,Qr;xt.trim();const nn={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},di=()=>{if($t)return this.status="done",Ue($t);if(this.extraShadowCaster)this.status="done",Ue(null,{buckets:Object.values(et).filter(hn=>!hn.isEmpty()),featureIndex:ht,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:wt.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(nr&&or&&Ur){const hn=new P(nr),Ln=new Map;for(const[Qi,Us]of or.entries()){const{imagePosition:ya}=s.e7(Qi,Us,s.e8);Ln.set(Qi,ya)}const Wn={};for(const Qi in et){const Us=et[Qi];Us instanceof s.aY&&(L(Us.layers,this.zoom,wt.brightness,De),Wn[Qi]=s.e9(Us,nr,hn.positions,or,Ln,this.tileID.canonical,this.tileZoom,this.scaleFactor,this.pixelRatio))}const Kn={iconsPending:!0,patternsPending:!0};this.rasterizeIfNeeded(qe,or,Jr,()=>{Kn.iconsPending=!1,Ci(Wn,hn,Kn)}),this.rasterizeIfNeeded(qe,Ur,Qr,()=>{Kn.patternsPending=!1,Ci(Wn,hn,Kn)})}},Ci=(hn,Ln,Wn,Kn)=>{if(Wn.iconsPending||Wn.patternsPending)return;const Qi=new s.ea(or,Ur,this.lut);for(const Us in et){const ya=et[Us];if(Us in hn)s.eb(ya,hn[Us],this.showCollisionBoxes,De,this.tileID.canonical,this.tileZoom,this.projection,this.brightness,or,Qi);else if(ya.hasPattern&&(ya instanceof s.b2||ya instanceof s.b3||ya instanceof s.d8)){L(ya.layers,this.zoom,wt.brightness,De);const Io=Object.fromEntries(Qi.patternPositions);ya.addFeatures(wt,this.tileID.canonical,Io,De,this.tileTransform,this.brightness)}}this.status="done",Ue(null,{buckets:Object.values(et).filter(Us=>!Us.isEmpty()),featureIndex:ht,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Ln.image,lineAtlas:xt,imageAtlas:Qi,brightness:wt.brightness})};if(!this.extraShadowCaster){const hn=s.e5(wt.glyphDependencies,Kn=>Object.keys(Kn).map(Number));Object.keys(hn).length?qe.send("getGlyphs",{uid:this.uid,stacks:hn,scope:this.scope},(Kn,Qi)=>{$t||($t=Kn,nr=Qi,di())},void 0,!1,nn):nr={};const Ln=Array.from(wt.iconDependencies.keys()).map(Kn=>s.I.parse(Kn));Ln.length?qe.send("getImages",{images:Ln,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},(Kn,Qi)=>{$t||($t=Kn,or=new Map,Jr=this.updateImageMapAndGetImageTaskQueue(or,Qi,wt.iconDependencies),di())},void 0,!1,nn):(or=new Map,Jr=new Map);const Wn=Array.from(wt.patternDependencies.keys()).map(Kn=>s.I.parse(Kn));Wn.length?qe.send("getImages",{images:Wn,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},(Kn,Qi)=>{$t||($t=Kn,Ur=new Map,Qr=this.updateImageMapAndGetImageTaskQueue(Ur,Qi,wt.patternDependencies),di())},void 0,!1,nn):(Ur=new Map,Qr=new Map)}if(wt.elevationFeatures&&wt.elevationFeatures.length>0){const hn=[];for(const Wn of Object.values(et))if(Wn instanceof s.b3){const Kn=Wn.getUnevaluatedPortalGraph();Kn&&hn.push(Kn)}const Ln=s.e6.evaluate(hn);for(const Wn of Object.values(et))Wn instanceof s.b3&&Wn.setEvaluatedPortalGraph(Ln)}di()}rasterizeIfNeeded(pe,be,De,qe){Array.from(be.values()).some(Ue=>Ue.usvg)?this.rasterize(pe,be,De,qe):qe()}updateImageMapAndGetImageTaskQueue(pe,be,De){const qe=new Map;for(const Ue of be.keys()){const Xe=De.get(Ue)||[];for(const ht of Xe){const et=ht.toString(),xt=be.get(ht.id.toString());xt.usvg?qe.has(et)||(qe.set(et,ht),pe.set(et,Object.assign({},xt))):pe.set(et,xt)}}return qe}rasterize(pe,be,De,qe){this.rasterizeTask=pe.send("rasterizeImages",{scope:this.scope,tasks:De},(Ue,Xe)=>{if(!Ue)for(const[ht,et]of Xe.entries()){const xt=Object.assign(be.get(ht),{data:et});be.set(ht,xt)}qe()})}cancelRasterize(){this.rasterizeTask&&this.rasterizeTask.cancel()}}function L(bt,pe,be,De){const qe=new s.aa(pe,{brightness:be});for(const Ue of bt)Ue.recalculate(qe,De)}class B extends s.E{constructor(pe,be,De,qe,Ue,Xe){super(),this.actor=pe,this.layerIndex=be,this.availableImages=De,this.loadVectorData=Ue||s.aE,this.loading={},this.loaded={},this.deduped=new s.aD(pe.scheduler),this.isSpriteLoaded=qe,this.scheduler=pe.scheduler,this.brightness=Xe}loadTile(pe,be){const De=pe.uid,qe=pe&&pe.request,Ue=qe&&qe.collectResourceTiming,Xe=this.loading[De]=new F(pe);Xe.abort=this.loadVectorData(pe,(ht,et)=>{const xt=!this.loading[De];if(delete this.loading[De],Xe.cancelRasterize(),xt||ht||!et)return Xe.status="done",xt||(this.loaded[De]=Xe),be(ht);const wt=et.rawData,vt={};et.expires&&(vt.expires=et.expires),et.cacheControl&&(vt.cacheControl=et.cacheControl),Xe.vectorTile=et.vectorTile||new s.ec.VectorTile(new s.bi(wt));const $t=()=>{Xe.parse(Xe.vectorTile,this.layerIndex,this.availableImages,this.actor,(nr,or)=>{if(nr||!or)return be(nr);const Ur={};if(Ue){const Jr=p(qe);Jr.length>0&&(Ur.resourceTiming=JSON.parse(JSON.stringify(Jr)))}be(null,s.l({rawTileData:wt.slice(0)},or,vt,Ur))})};this.isSpriteLoaded?$t():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add($t,{type:"parseTile",isSymbolTile:pe.isSymbolTile,zoom:pe.tileZoom}):$t()}),this.loaded=this.loaded||{},this.loaded[De]=Xe})}reloadTile(pe,be){const De=this.loaded,qe=pe.uid;if(De&&De[qe]){const Ue=De[qe];Ue.scaleFactor=pe.scaleFactor,Ue.showCollisionBoxes=pe.showCollisionBoxes,Ue.projection=pe.projection,Ue.brightness=pe.brightness,Ue.tileTransform=s.aR(pe.tileID.canonical,pe.projection),Ue.extraShadowCaster=pe.extraShadowCaster,Ue.lut=pe.lut;const Xe=(ht,et)=>{const xt=Ue.reloadCallback;xt&&(delete Ue.reloadCallback,Ue.parse(Ue.vectorTile,this.layerIndex,this.availableImages,this.actor,xt)),be(ht,et)};Ue.status==="parsing"?Ue.reloadCallback=Xe:Ue.status==="done"&&(Ue.vectorTile?Ue.parse(Ue.vectorTile,this.layerIndex,this.availableImages,this.actor,Xe):Xe())}else be(null,void 0)}abortTile(pe,be){const De=pe.uid,qe=this.loading[De];qe&&(qe.abort&&qe.abort(),delete this.loading[De]),be()}removeTile(pe,be){const De=this.loaded,qe=pe.uid;De&&De[qe]&&delete De[qe],be()}}class V{loadTile(pe,be){const{uid:De,encoding:qe,rawImageData:Ue,padding:Xe}=pe,ht=ImageBitmap&&Ue instanceof ImageBitmap?this.getImageData(Ue,Xe):Ue;be(null,new s.ed(De,ht,qe,Xe<1))}reloadTile(pe,be){be(null,null)}abortTile(pe,be){be()}removeTile(pe,be){be()}getImageData(pe,be){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(pe.width,pe.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=pe.width,this.offscreenCanvas.height=pe.height,this.offscreenCanvasContext.drawImage(pe,0,0,pe.width,pe.height);const De=this.offscreenCanvasContext.getImageData(-be,-be,pe.width+2*be,pe.height+2*be);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),De}}s.bh.setPbf(s.bi);class ${constructor(pe){this._mrt=new s.bh(pe.partial?30:1/0),this._isHeaderLoaded=!1,this.uid=pe.uid,this.tileID=pe.tileID,this.source=pe.source}parse(pe,be){const De=this._mrt;this.status="parsing",this._entireBuffer=pe;try{De.parseHeader(pe),this._isHeaderLoaded=!0;const qe=[];for(const Ue in De.layers){const Xe=De.getLayer(Ue),ht=Xe.getDataRange(Xe.getBandList()),et=De.createDecodingTask(ht),xt=pe.slice(ht.firstByte,ht.lastByte+1),wt=s.bh.performDecoding(xt,et).then(vt=>et.complete(null,vt)).catch(vt=>et.complete(vt,null));qe.push(wt)}Promise.allSettled(qe).then(()=>be(null,De))}catch(qe){be(qe)}}}class G{constructor(pe){this.actor=pe,this.loading={},this.loaded={}}loadTile(pe,be){const De=pe.uid,qe=pe.request,Ue=this.loading[De]=new $(pe),{cancel:Xe}=s.bj(qe,(ht,et,xt,wt)=>{const vt=!this.loading[De];if(delete this.loading[De],vt||ht||!et)return Ue.status="done",vt||(this.loaded[De]=Ue),be(ht);Ue.parse(et,($t,nr)=>{if($t||!nr)return be($t);be(null,nr,xt,wt)}),this.loaded[De]=Ue});Ue.abort=Xe}reloadTile(pe,be){be(null,void 0)}abortTile(pe,be){const De=pe.uid,qe=this.loading[De];qe&&(qe.abort&&qe.abort(),delete this.loading[De]),be()}removeTile(pe,be){const De=pe.uid;this.loaded[De]&&delete this.loaded[De],be()}decodeRasterArray({task:pe,buffer:be},De){s.bh.performDecoding(be,pe).then(qe=>De(null,qe)).catch(qe=>De(qe))}}const W=s.ec.VectorTileFeature.prototype.toGeoJSON;class Z{constructor(pe){this._feature=pe,this.extent=s.ai,this.type=pe.type,this.properties=pe.tags,"id"in pe&&!isNaN(pe.id)&&(this.id=parseInt(pe.id,10))}loadGeometry(){if(this._feature.type===1){const pe=[];for(const be of this._feature.geometry)pe.push([new s.P(be[0],be[1])]);return pe}{const pe=[];for(const be of this._feature.geometry){const De=[];for(const qe of be)De.push(new s.P(qe[0],qe[1]));pe.push(De)}return pe}}toGeoJSON(pe,be,De){return W.call(this,pe,be,De)}}class se{constructor(pe){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=s.ai,this.length=pe.length,this._features=pe}feature(pe){return new Z(this._features[pe])}}const ae=64/4096,ce=128;class Pe{constructor(){this.features=new Map}clear(){this.features.clear()}load(pe=[],be){for(const De of pe){const qe=De.id;if(qe==null)continue;let Ue=this.features.get(qe);Ue&&this.updateCache(Ue,be),De.geometry?(Ue=xe(De),this.updateCache(Ue,be),this.features.set(qe,Ue)):this.features.delete(qe),this.updateCache(Ue,be)}}updateCache(pe,be){for(const{canonical:De,uid:qe}of Object.values(be)){const{z:Ue,x:Xe,y:ht}=De;we(pe,Math.pow(2,Ue),Xe,ht)&&delete be[qe]}}getTile(pe,be,De){const qe=Math.pow(2,pe),Ue=[];for(const Xe of this.features.values())we(Xe,qe,be,De)&&Ue.push(ve(Xe,qe,be,De));return{features:Ue}}getFeatures(){return[...this.features.values()]}}function we({minX:bt,minY:pe,maxX:be,maxY:De},qe,Ue,Xe){return bt<(Ue+1+ae)/qe&&pe<(Xe+1+ae)/qe&&be>(Ue-ae)/qe&&De>(Xe-ae)/qe}function xe(bt){const{id:pe,geometry:be,properties:De}=bt;if(!be)return;if(be.type==="GeometryCollection")throw new Error("GeometryCollection not supported in dynamic mode.");const{type:qe,coordinates:Ue}=be,Xe={id:pe,type:1,geometry:[],tags:De,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},ht=Xe.geometry;if(qe==="Point")Ne(Ue,ht,Xe);else if(qe==="MultiPoint")for(const et of Ue)Ne(et,ht,Xe);else if(qe==="LineString")Xe.type=2,ze(Ue,ht,Xe);else if(qe==="MultiLineString")Xe.type=2,ye(Ue,ht,Xe);else if(qe==="Polygon")Xe.type=3,ye(Ue,ht,Xe,!0);else{if(qe!=="MultiPolygon")throw new Error("Input data is not a valid GeoJSON object.");Xe.type=3;for(const et of Ue)ye(et,ht,Xe,!0)}return Xe}function Ne([bt,pe],be,De){const qe=s.av(bt);let Ue=s.aC(pe);Ue=Ue<0?0:Ue>1?1:Ue,be.push(qe,Ue),De.minX=Math.min(De.minX,qe),De.minY=Math.min(De.minY,Ue),De.maxX=Math.max(De.maxX,qe),De.maxY=Math.max(De.maxY,Ue)}function ze(bt,pe,be,De=!1,qe=!1){const Ue=[];for(const Xe of bt)Ne(Xe,Ue,be);pe.push(Ue),De&&function(Xe,ht){let et=0;for(let xt=0,wt=Xe.length,vt=wt-2;xt<wt;vt=xt,xt+=2)et+=(Xe[xt]-Xe[vt])*(Xe[xt+1]+Xe[vt+1]);if(et>0===ht)for(let xt=0,wt=Xe.length;xt<wt/2;xt+=2){const vt=Xe[xt],$t=Xe[xt+1];Xe[xt]=Xe[wt-2-xt],Xe[xt+1]=Xe[wt-1-xt],Xe[wt-2-xt]=vt,Xe[wt-1-xt]=$t}}(Ue,qe)}function ye(bt,pe,be,De=!1){for(let qe=0;qe<bt.length;qe++)ze(bt[qe],pe,be,De,qe===0)}function ve(bt,pe,be,De){const{id:qe,type:Ue,geometry:Xe,tags:ht}=bt,et=[];if(Ue===1)(function(xt,wt,vt,$t,nr){for(let or=0;or<xt.length;or+=2){const Ur=Math.round(s.ai*(xt[or+0]*wt-vt)),Jr=Math.round(s.ai*(xt[or+1]*wt-$t));nr.push([Ur,Jr])}})(Xe,pe,be,De,et);else for(const xt of Xe)_e(xt,pe,be,De,et);return{id:qe,type:Ue,geometry:et,tags:ht}}function _e(bt,pe,be,De,qe){const Ue=-ce,Xe=s.ai+ce;let ht;for(let et=0;et<bt.length-2;et+=2){let xt=Math.round(s.ai*(bt[et+0]*pe-be)),wt=Math.round(s.ai*(bt[et+1]*pe-De)),vt=Math.round(s.ai*(bt[et+2]*pe-be)),$t=Math.round(s.ai*(bt[et+3]*pe-De));const nr=vt-xt,or=$t-wt;xt<Ue&&vt<Ue||(xt<Ue?(wt+=Math.round(or*((Ue-xt)/nr)),xt=Ue):vt<Ue&&($t=wt+Math.round(or*((Ue-xt)/nr)),vt=Ue),wt<Ue&&$t<Ue||(wt<Ue?(xt+=Math.round(nr*((Ue-wt)/or)),wt=Ue):$t<Ue&&(vt=xt+Math.round(nr*((Ue-wt)/or)),$t=Ue),xt>=Xe&&vt>=Xe||(xt>=Xe?(wt+=Math.round(or*((Xe-xt)/nr)),xt=Xe):vt>=Xe&&($t=wt+Math.round(or*((Xe-xt)/nr)),vt=Xe),wt>=Xe&&$t>=Xe||(wt>=Xe?(xt+=Math.round(nr*((Xe-wt)/or)),wt=Xe):$t>=Xe&&(vt=xt+Math.round(nr*((Xe-wt)/or)),$t=Xe),ht&&xt===ht[ht.length-1][0]&&wt===ht[ht.length-1][1]||(ht=[[xt,wt]],qe.push(ht)),ht.push([vt,$t])))))}}var Ee,je,Ce,tt={exports:{}},it=function(){if(Ce)return tt.exports;Ce=1;var bt=s.eg(),pe=function(){if(je)return Ee;je=1;var wt=s.ee(),vt=s.ef().VectorTileFeature;function $t(or,Ur){this.options=Ur||{},this.features=or,this.length=or.length}function nr(or,Ur){this.id=typeof or.id=="number"?or.id:void 0,this.type=or.type,this.rawGeometry=or.type===1?[or.geometry]:or.geometry,this.properties=or.tags,this.extent=Ur||4096}return Ee=$t,$t.prototype.feature=function(or){return new nr(this.features[or],this.options.extent)},nr.prototype.loadGeometry=function(){var or=this.rawGeometry;this.geometry=[];for(var Ur=0;Ur<or.length;Ur++){for(var Jr=or[Ur],Qr=[],nn=0;nn<Jr.length;nn++)Qr.push(new wt(Jr[nn][0],Jr[nn][1]));this.geometry.push(Qr)}return this.geometry},nr.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var or=this.geometry,Ur=1/0,Jr=-1/0,Qr=1/0,nn=-1/0,di=0;di<or.length;di++)for(var Ci=or[di],hn=0;hn<Ci.length;hn++){var Ln=Ci[hn];Ur=Math.min(Ur,Ln.x),Jr=Math.max(Jr,Ln.x),Qr=Math.min(Qr,Ln.y),nn=Math.max(nn,Ln.y)}return[Ur,Qr,Jr,nn]},nr.prototype.toGeoJSON=vt.prototype.toGeoJSON,Ee}();function be(wt){var vt=new bt;return function($t,nr){for(var or in $t.layers)nr.writeMessage(3,De,$t.layers[or])}(wt,vt),vt.finish()}function De(wt,vt){var $t;vt.writeVarintField(15,wt.version||1),vt.writeStringField(1,wt.name||""),vt.writeVarintField(5,wt.extent||4096);var nr={keys:[],values:[],keycache:{},valuecache:{}};for($t=0;$t<wt.length;$t++)nr.feature=wt.feature($t),vt.writeMessage(2,qe,nr);var or=nr.keys;for($t=0;$t<or.length;$t++)vt.writeStringField(3,or[$t]);var Ur=nr.values;for($t=0;$t<Ur.length;$t++)vt.writeMessage(4,xt,Ur[$t])}function qe(wt,vt){var $t=wt.feature;$t.id!==void 0&&vt.writeVarintField(1,$t.id),vt.writeMessage(2,Ue,wt),vt.writeVarintField(3,$t.type),vt.writeMessage(4,et,$t)}function Ue(wt,vt){var $t=wt.feature,nr=wt.keys,or=wt.values,Ur=wt.keycache,Jr=wt.valuecache;for(var Qr in $t.properties){var nn=$t.properties[Qr],di=Ur[Qr];if(nn!==null){di===void 0&&(nr.push(Qr),Ur[Qr]=di=nr.length-1),vt.writeVarint(di);var Ci=typeof nn;Ci!=="string"&&Ci!=="boolean"&&Ci!=="number"&&(nn=JSON.stringify(nn));var hn=Ci+":"+nn,Ln=Jr[hn];Ln===void 0&&(or.push(nn),Jr[hn]=Ln=or.length-1),vt.writeVarint(Ln)}}}function Xe(wt,vt){return(vt<<3)+(7&wt)}function ht(wt){return wt<<1^wt>>31}function et(wt,vt){for(var $t=wt.loadGeometry(),nr=wt.type,or=0,Ur=0,Jr=$t.length,Qr=0;Qr<Jr;Qr++){var nn=$t[Qr],di=1;nr===1&&(di=nn.length),vt.writeVarint(Xe(1,di));for(var Ci=nr===3?nn.length-1:nn.length,hn=0;hn<Ci;hn++){hn===1&&nr!==1&&vt.writeVarint(Xe(2,Ci-1));var Ln=nn[hn].x-or,Wn=nn[hn].y-Ur;vt.writeVarint(ht(Ln)),vt.writeVarint(ht(Wn)),or+=Ln,Ur+=Wn}nr===3&&vt.writeVarint(Xe(7,1))}}function xt(wt,vt){var $t=typeof wt;$t==="string"?vt.writeStringField(1,wt):$t==="boolean"?vt.writeBooleanField(7,wt):$t==="number"&&(wt%1!=0?vt.writeDoubleField(3,wt):wt<0?vt.writeSVarintField(6,wt):vt.writeVarintField(5,wt))}return tt.exports=be,tt.exports.fromVectorTileJs=be,tt.exports.fromGeojsonVt=function(wt,vt){vt=vt||{};var $t={};for(var nr in wt)$t[nr]=new pe(wt[nr].features,vt),$t[nr].name=nr,$t[nr].version=vt.version,$t[nr].extent=vt.extent;return be({layers:$t})},tt.exports.GeoJSONWrapper=pe,tt.exports}(),mt=s.eh(it);const gt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:bt=>bt},qt=Math.fround||(yr=new Float32Array(1),bt=>(yr[0]=+bt,yr[0]));var yr;const tr=3,Ft=5,er=6;class Dt{constructor(pe){this.options=Object.assign(Object.create(gt),pe),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(pe){const{log:be,minZoom:De,maxZoom:qe}=this.options;be&&console.time("total time");const Ue=`prepare ${pe.length} points`;be&&console.time(Ue),this.points=pe;const Xe=[];for(let et=0;et<pe.length;et++){const xt=pe[et];if(!xt.geometry)continue;const[wt,vt]=xt.geometry.coordinates,$t=qt(St(wt)),nr=qt(jr(vt));Xe.push($t,nr,1/0,et,-1,1),this.options.reduce&&Xe.push(0)}let ht=this.trees[qe+1]=this._createTree(Xe);be&&console.timeEnd(Ue);for(let et=qe;et>=De;et--){const xt=+Date.now();ht=this.trees[et]=this._createTree(this._cluster(ht,et)),be&&console.log("z%d: %d clusters in %dms",et,ht.numItems,+Date.now()-xt)}return be&&console.timeEnd("total time"),this}getClusters(pe,be){let De=((pe[0]+180)%360+360)%360-180;const qe=Math.max(-90,Math.min(90,pe[1]));let Ue=pe[2]===180?180:((pe[2]+180)%360+360)%360-180;const Xe=Math.max(-90,Math.min(90,pe[3]));if(pe[2]-pe[0]>=360)De=-180,Ue=180;else if(De>Ue){const vt=this.getClusters([De,qe,180,Xe],be),$t=this.getClusters([-180,qe,Ue,Xe],be);return vt.concat($t)}const ht=this.trees[this._limitZoom(be)],et=ht.range(St(De),jr(Xe),St(Ue),jr(qe)),xt=ht.data,wt=[];for(const vt of et){const $t=this.stride*vt;wt.push(xt[$t+Ft]>1?ge(xt,$t,this.clusterProps):this.points[xt[$t+tr]])}return wt}getChildren(pe){const be=this._getOriginId(pe),De=this._getOriginZoom(pe),qe="No cluster with the specified id.",Ue=this.trees[De];if(!Ue)throw new Error(qe);const Xe=Ue.data;if(be*this.stride>=Xe.length)throw new Error(qe);const ht=this.options.radius/(this.options.extent*Math.pow(2,De-1)),et=Ue.within(Xe[be*this.stride],Xe[be*this.stride+1],ht),xt=[];for(const wt of et){const vt=wt*this.stride;Xe[vt+4]===pe&&xt.push(Xe[vt+Ft]>1?ge(Xe,vt,this.clusterProps):this.points[Xe[vt+tr]])}if(xt.length===0)throw new Error(qe);return xt}getLeaves(pe,be,De){const qe=[];return this._appendLeaves(qe,pe,be=be||10,De=De||0,0),qe}getTile(pe,be,De){const qe=this.trees[this._limitZoom(pe)],Ue=Math.pow(2,pe),{extent:Xe,radius:ht}=this.options,et=ht/Xe,xt=(De-et)/Ue,wt=(De+1+et)/Ue,vt={features:[]};return this._addTileFeatures(qe.range((be-et)/Ue,xt,(be+1+et)/Ue,wt),qe.data,be,De,Ue,vt),be===0&&this._addTileFeatures(qe.range(1-et/Ue,xt,1,wt),qe.data,Ue,De,Ue,vt),be===Ue-1&&this._addTileFeatures(qe.range(0,xt,et/Ue,wt),qe.data,-1,De,Ue,vt),vt.features.length?vt:null}getClusterExpansionZoom(pe){let be=this._getOriginZoom(pe)-1;for(;be<=this.options.maxZoom;){const De=this.getChildren(pe);if(be++,De.length!==1)break;pe=De[0].properties.cluster_id}return be}_appendLeaves(pe,be,De,qe,Ue){const Xe=this.getChildren(be);for(const ht of Xe){const et=ht.properties;if(et&&et.cluster?Ue+et.point_count<=qe?Ue+=et.point_count:Ue=this._appendLeaves(pe,et.cluster_id,De,qe,Ue):Ue<qe?Ue++:pe.push(ht),pe.length===De)break}return Ue}_createTree(pe){const be=new s.bE(pe.length/this.stride|0,this.options.nodeSize,Float32Array);for(let De=0;De<pe.length;De+=this.stride)be.add(pe[De],pe[De+1]);return be.finish(),be.data=pe,be}_addTileFeatures(pe,be,De,qe,Ue,Xe){for(const ht of pe){const et=ht*this.stride,xt=be[et+Ft]>1;let wt,vt,$t;if(xt)wt=sr(be,et,this.clusterProps),vt=be[et],$t=be[et+1];else{const Ur=this.points[be[et+tr]];wt=Ur.properties;const[Jr,Qr]=Ur.geometry.coordinates;vt=St(Jr),$t=jr(Qr)}const nr={type:1,geometry:[[Math.round(this.options.extent*(vt*Ue-De)),Math.round(this.options.extent*($t*Ue-qe))]],tags:wt};let or;or=xt||this.options.generateId?be[et+tr]:this.points[be[et+tr]].id,or!==void 0&&(nr.id=or),Xe.features.push(nr)}}_limitZoom(pe){return Math.max(this.options.minZoom,Math.min(Math.floor(+pe),this.options.maxZoom+1))}_cluster(pe,be){const{radius:De,extent:qe,reduce:Ue,minPoints:Xe}=this.options,ht=De/(qe*Math.pow(2,be)),et=pe.data,xt=[],wt=this.stride;for(let vt=0;vt<et.length;vt+=wt){if(et[vt+2]<=be)continue;et[vt+2]=be;const $t=et[vt],nr=et[vt+1],or=pe.within(et[vt],et[vt+1],ht),Ur=et[vt+Ft];let Jr=Ur;for(const Qr of or){const nn=Qr*wt;et[nn+2]>be&&(Jr+=et[nn+Ft])}if(Jr>Ur&&Jr>=Xe){let Qr,nn=$t*Ur,di=nr*Ur,Ci=-1;const hn=(vt/wt<<5)+(be+1)+this.points.length;for(const Ln of or){const Wn=Ln*wt;if(et[Wn+2]<=be)continue;et[Wn+2]=be;const Kn=et[Wn+Ft];nn+=et[Wn]*Kn,di+=et[Wn+1]*Kn,et[Wn+4]=hn,Ue&&(Qr||(Qr=this._map(et,vt,!0),Ci=this.clusterProps.length,this.clusterProps.push(Qr)),Ue(Qr,this._map(et,Wn)))}et[vt+4]=hn,xt.push(nn/Jr,di/Jr,1/0,hn,-1,Jr),Ue&&xt.push(Ci)}else{for(let Qr=0;Qr<wt;Qr++)xt.push(et[vt+Qr]);if(Jr>1)for(const Qr of or){const nn=Qr*wt;if(!(et[nn+2]<=be)){et[nn+2]=be;for(let di=0;di<wt;di++)xt.push(et[nn+di])}}}}return xt}_getOriginId(pe){return pe-this.points.length>>5}_getOriginZoom(pe){return(pe-this.points.length)%32}_map(pe,be,De){if(pe[be+Ft]>1){const Xe=this.clusterProps[pe[be+er]];return De?Object.assign({},Xe):Xe}const qe=this.points[pe[be+tr]].properties,Ue=this.options.map(qe);return De&&Ue===qe?Object.assign({},Ue):Ue}}function ge(bt,pe,be){return{type:"Feature",id:bt[pe+tr],properties:sr(bt,pe,be),geometry:{type:"Point",coordinates:[(De=bt[pe],360*(De-.5)),dt(bt[pe+1])]}};var De}function sr(bt,pe,be){const De=bt[pe+Ft],qe=De>=1e4?`${Math.round(De/1e3)}k`:De>=1e3?Math.round(De/100)/10+"k":De,Ue=bt[pe+er],Xe=Ue===-1?{}:Object.assign({},be[Ue]);return Object.assign(Xe,{cluster:!0,cluster_id:bt[pe+tr],point_count:De,point_count_abbreviated:qe})}function St(bt){return bt/360+.5}function jr(bt){const pe=Math.sin(bt*Math.PI/180),be=.5-.25*Math.log((1+pe)/(1-pe))/Math.PI;return be<0?0:be>1?1:be}function dt(bt){const pe=(180-360*bt)*Math.PI/180;return 360*Math.atan(Math.exp(pe))/Math.PI-90}function Yr(bt,pe,be,De){let qe=De;const Ue=pe+(be-pe>>1);let Xe,ht=be-pe;const et=bt[pe],xt=bt[pe+1],wt=bt[be],vt=bt[be+1];for(let $t=pe+3;$t<be;$t+=3){const nr=Vr(bt[$t],bt[$t+1],et,xt,wt,vt);if(nr>qe)Xe=$t,qe=nr;else if(nr===qe){const or=Math.abs($t-Ue);or<ht&&(Xe=$t,ht=or)}}qe>De&&(Xe-pe>3&&Yr(bt,pe,Xe,De),bt[Xe+2]=qe,be-Xe>3&&Yr(bt,Xe,be,De))}function Vr(bt,pe,be,De,qe,Ue){let Xe=qe-be,ht=Ue-De;if(Xe!==0||ht!==0){const et=((bt-be)*Xe+(pe-De)*ht)/(Xe*Xe+ht*ht);et>1?(be=qe,De=Ue):et>0&&(be+=Xe*et,De+=ht*et)}return Xe=bt-be,ht=pe-De,Xe*Xe+ht*ht}function Yn(bt,pe,be,De){const qe={id:bt??null,type:pe,geometry:be,tags:De,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(pe==="Point"||pe==="MultiPoint"||pe==="LineString")Ye(qe,be);else if(pe==="Polygon")Ye(qe,be[0]);else if(pe==="MultiLineString")for(const Ue of be)Ye(qe,Ue);else if(pe==="MultiPolygon")for(const Ue of be)Ye(qe,Ue[0]);return qe}function Ye(bt,pe){for(let be=0;be<pe.length;be+=3)bt.minX=Math.min(bt.minX,pe[be]),bt.minY=Math.min(bt.minY,pe[be+1]),bt.maxX=Math.max(bt.maxX,pe[be]),bt.maxY=Math.max(bt.maxY,pe[be+1])}function Nt(bt,pe,be,De){if(!pe.geometry)return;const qe=pe.geometry.coordinates;if(qe&&qe.length===0)return;const Ue=pe.geometry.type,Xe=Math.pow(be.tolerance/((1<<be.maxZoom)*be.extent),2);let ht=[],et=pe.id;if(be.promoteId?et=pe.properties[be.promoteId]:be.generateId&&(et=De||0),Ue==="Point")zt(qe,ht);else if(Ue==="MultiPoint")for(const xt of qe)zt(xt,ht);else if(Ue==="LineString")Nr(qe,ht,Xe,!1);else if(Ue==="MultiLineString"){if(be.lineMetrics){for(const xt of qe)ht=[],Nr(xt,ht,Xe,!1),bt.push(Yn(et,"LineString",ht,pe.properties));return}br(qe,ht,Xe,!1)}else if(Ue==="Polygon")br(qe,ht,Xe,!0);else{if(Ue!=="MultiPolygon"){if(Ue==="GeometryCollection"){for(const xt of pe.geometry.geometries)Nt(bt,{id:et,geometry:xt,properties:pe.properties},be,De);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const xt of qe){const wt=[];br(xt,wt,Xe,!0),ht.push(wt)}}bt.push(Yn(et,Ue,ht,pe.properties))}function zt(bt,pe){pe.push(hr(bt[0]),rr(bt[1]),0)}function Nr(bt,pe,be,De){let qe,Ue,Xe=0;for(let et=0;et<bt.length;et++){const xt=hr(bt[et][0]),wt=rr(bt[et][1]);pe.push(xt,wt,0),et>0&&(Xe+=De?(qe*wt-xt*Ue)/2:Math.sqrt(Math.pow(xt-qe,2)+Math.pow(wt-Ue,2))),qe=xt,Ue=wt}const ht=pe.length-3;pe[2]=1,Yr(pe,0,ht,be),pe[ht+2]=1,pe.size=Math.abs(Xe),pe.start=0,pe.end=pe.size}function br(bt,pe,be,De){for(let qe=0;qe<bt.length;qe++){const Ue=[];Nr(bt[qe],Ue,be,De),pe.push(Ue)}}function hr(bt){return bt/360+.5}function rr(bt){const pe=Math.sin(bt*Math.PI/180),be=.5-.25*Math.log((1+pe)/(1-pe))/Math.PI;return be<0?0:be>1?1:be}function an(bt,pe,be,De,qe,Ue,Xe,ht){if(De/=pe,Ue>=(be/=pe)&&Xe<De)return bt;if(Xe<be||Ue>=De)return null;const et=[];for(const xt of bt){const wt=xt.geometry;let vt=xt.type;const $t=qe===0?xt.minX:xt.minY,nr=qe===0?xt.maxX:xt.maxY;if($t>=be&&nr<De){et.push(xt);continue}if(nr<be||$t>=De)continue;let or=[];if(vt==="Point"||vt==="MultiPoint")ai(wt,or,be,De,qe);else if(vt==="LineString")ri(wt,or,be,De,qe,!1,ht.lineMetrics);else if(vt==="MultiLineString")oa(wt,or,be,De,qe,!1);else if(vt==="Polygon")oa(wt,or,be,De,qe,!0);else if(vt==="MultiPolygon")for(const Ur of wt){const Jr=[];oa(Ur,Jr,be,De,qe,!0),Jr.length&&or.push(Jr)}if(or.length){if(ht.lineMetrics&&vt==="LineString"){for(const Ur of or)et.push(Yn(xt.id,vt,Ur,xt.tags));continue}vt!=="LineString"&&vt!=="MultiLineString"||(or.length===1?(vt="LineString",or=or[0]):vt="MultiLineString"),vt!=="Point"&&vt!=="MultiPoint"||(vt=or.length===3?"Point":"MultiPoint"),et.push(Yn(xt.id,vt,or,xt.tags))}}return et.length?et:null}function ai(bt,pe,be,De,qe){for(let Ue=0;Ue<bt.length;Ue+=3){const Xe=bt[Ue+qe];Xe>=be&&Xe<=De&&Xs(pe,bt[Ue],bt[Ue+1],bt[Ue+2])}}function ri(bt,pe,be,De,qe,Ue,Xe){let ht=Ui(bt);const et=qe===0?rl:Il;let xt,wt,vt=bt.start;for(let Jr=0;Jr<bt.length-3;Jr+=3){const Qr=bt[Jr],nn=bt[Jr+1],di=bt[Jr+2],Ci=bt[Jr+3],hn=bt[Jr+4],Ln=qe===0?Qr:nn,Wn=qe===0?Ci:hn;let Kn=!1;Xe&&(xt=Math.sqrt(Math.pow(Qr-Ci,2)+Math.pow(nn-hn,2))),Ln<be?Wn>be&&(wt=et(ht,Qr,nn,Ci,hn,be),Xe&&(ht.start=vt+xt*wt)):Ln>De?Wn<De&&(wt=et(ht,Qr,nn,Ci,hn,De),Xe&&(ht.start=vt+xt*wt)):Xs(ht,Qr,nn,di),Wn<be&&Ln>=be&&(wt=et(ht,Qr,nn,Ci,hn,be),Kn=!0),Wn>De&&Ln<=De&&(wt=et(ht,Qr,nn,Ci,hn,De),Kn=!0),!Ue&&Kn&&(Xe&&(ht.end=vt+xt*wt),pe.push(ht),ht=Ui(bt)),Xe&&(vt+=xt)}let $t=bt.length-3;const nr=bt[$t],or=bt[$t+1],Ur=qe===0?nr:or;Ur>=be&&Ur<=De&&Xs(ht,nr,or,bt[$t+2]),$t=ht.length-3,Ue&&$t>=3&&(ht[$t]!==ht[0]||ht[$t+1]!==ht[1])&&Xs(ht,ht[0],ht[1],ht[2]),ht.length&&pe.push(ht)}function Ui(bt){const pe=[];return pe.size=bt.size,pe.start=bt.start,pe.end=bt.end,pe}function oa(bt,pe,be,De,qe,Ue){for(const Xe of bt)ri(Xe,pe,be,De,qe,Ue,!1)}function Xs(bt,pe,be,De){bt.push(pe,be,De)}function rl(bt,pe,be,De,qe,Ue){const Xe=(Ue-pe)/(De-pe);return Xs(bt,Ue,be+(qe-be)*Xe,1),Xe}function Il(bt,pe,be,De,qe,Ue){const Xe=(Ue-be)/(qe-be);return Xs(bt,pe+(De-pe)*Xe,Ue,1),Xe}function xo(bt,pe){const be=[];for(let De=0;De<bt.length;De++){const qe=bt[De],Ue=qe.type;let Xe;if(Ue==="Point"||Ue==="MultiPoint"||Ue==="LineString")Xe=nl(qe.geometry,pe);else if(Ue==="MultiLineString"||Ue==="Polygon"){Xe=[];for(const ht of qe.geometry)Xe.push(nl(ht,pe))}else if(Ue==="MultiPolygon"){Xe=[];for(const ht of qe.geometry){const et=[];for(const xt of ht)et.push(nl(xt,pe));Xe.push(et)}}be.push(Yn(qe.id,Ue,Xe,qe.tags))}return be}function nl(bt,pe){const be=[];be.size=bt.size,bt.start!==void 0&&(be.start=bt.start,be.end=bt.end);for(let De=0;De<bt.length;De+=3)be.push(bt[De]+pe,bt[De+1],bt[De+2]);return be}function Vs(bt,pe){if(bt.transformed)return bt;const be=1<<bt.z,De=bt.x,qe=bt.y;for(const Ue of bt.features){const Xe=Ue.geometry,ht=Ue.type;if(Ue.geometry=[],ht===1)for(let et=0;et<Xe.length;et+=2)Ue.geometry.push(Ua(Xe[et],Xe[et+1],pe,be,De,qe));else for(let et=0;et<Xe.length;et++){const xt=[];for(let wt=0;wt<Xe[et].length;wt+=2)xt.push(Ua(Xe[et][wt],Xe[et][wt+1],pe,be,De,qe));Ue.geometry.push(xt)}}return bt.transformed=!0,bt}function Ua(bt,pe,be,De,qe,Ue){return[Math.round(be*(bt*De-qe)),Math.round(be*(pe*De-Ue))]}function _i(bt,pe,be,De,qe){const Ue=pe===qe.maxZoom?0:qe.tolerance/((1<<pe)*qe.extent),Xe={features:[],numPoints:0,numSimplified:0,numFeatures:bt.length,source:null,x:be,y:De,z:pe,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const ht of bt)Ir(Xe,ht,Ue,qe);return Xe}function Ir(bt,pe,be,De){const qe=pe.geometry,Ue=pe.type,Xe=[];if(bt.minX=Math.min(bt.minX,pe.minX),bt.minY=Math.min(bt.minY,pe.minY),bt.maxX=Math.max(bt.maxX,pe.maxX),bt.maxY=Math.max(bt.maxY,pe.maxY),Ue==="Point"||Ue==="MultiPoint")for(let ht=0;ht<qe.length;ht+=3)Xe.push(qe[ht],qe[ht+1]),bt.numPoints++,bt.numSimplified++;else if(Ue==="LineString")wi(Xe,qe,bt,be,!1,!1);else if(Ue==="MultiLineString"||Ue==="Polygon")for(let ht=0;ht<qe.length;ht++)wi(Xe,qe[ht],bt,be,Ue==="Polygon",ht===0);else if(Ue==="MultiPolygon")for(let ht=0;ht<qe.length;ht++){const et=qe[ht];for(let xt=0;xt<et.length;xt++)wi(Xe,et[xt],bt,be,!0,xt===0)}if(Xe.length){let ht=pe.tags||null;if(Ue==="LineString"&&De.lineMetrics){ht={};for(const xt in pe.tags)ht[xt]=pe.tags[xt];ht.mapbox_clip_start=qe.start/qe.size,ht.mapbox_clip_end=qe.end/qe.size}const et={geometry:Xe,type:Ue==="Polygon"||Ue==="MultiPolygon"?3:Ue==="LineString"||Ue==="MultiLineString"?2:1,tags:ht};pe.id!==null&&(et.id=pe.id),bt.features.push(et)}}function wi(bt,pe,be,De,qe,Ue){const Xe=De*De;if(De>0&&pe.size<(qe?Xe:De))return void(be.numPoints+=pe.length/3);const ht=[];for(let et=0;et<pe.length;et+=3)(De===0||pe[et+2]>Xe)&&(be.numSimplified++,ht.push(pe[et],pe[et+1])),be.numPoints++;qe&&function(et,xt){let wt=0;for(let vt=0,$t=et.length,nr=$t-2;vt<$t;nr=vt,vt+=2)wt+=(et[vt]-et[nr])*(et[vt+1]+et[nr+1]);if(wt>0===xt)for(let vt=0,$t=et.length;vt<$t/2;vt+=2){const nr=et[vt],or=et[vt+1];et[vt]=et[$t-2-vt],et[vt+1]=et[$t-1-vt],et[$t-2-vt]=nr,et[$t-1-vt]=or}}(ht,Ue),bt.push(ht)}const gi={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Ji{constructor(pe,be){const De=(be=this.options=function(Ue,Xe){for(const ht in Xe)Ue[ht]=Xe[ht];return Ue}(Object.create(gi),be)).debug;if(De&&console.time("preprocess data"),be.maxZoom<0||be.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(be.promoteId&&be.generateId)throw new Error("promoteId and generateId cannot be used together.");let qe=function(Ue,Xe){const ht=[];if(Ue.type==="FeatureCollection")for(let et=0;et<Ue.features.length;et++)Nt(ht,Ue.features[et],Xe,et);else Nt(ht,Ue.type==="Feature"?Ue:{geometry:Ue},Xe);return ht}(pe,be);this.tiles={},this.tileCoords=[],De&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",be.indexMaxZoom,be.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),qe=function(Ue,Xe){const ht=Xe.buffer/Xe.extent;let et=Ue;const xt=an(Ue,1,-1-ht,ht,0,-1,2,Xe),wt=an(Ue,1,1-ht,2+ht,0,-1,2,Xe);return(xt||wt)&&(et=an(Ue,1,-ht,1+ht,0,-1,2,Xe)||[],xt&&(et=xo(xt,1).concat(et)),wt&&(et=et.concat(xo(wt,-1)))),et}(qe,be),qe.length&&this.splitTile(qe,0,0,0),De&&(qe.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(pe,be,De,qe,Ue,Xe,ht){const et=[pe,be,De,qe],xt=this.options,wt=xt.debug;for(;et.length;){qe=et.pop(),De=et.pop(),be=et.pop(),pe=et.pop();const vt=1<<be,$t=la(be,De,qe);let nr=this.tiles[$t];if(!nr&&(wt>1&&console.time("creation"),nr=this.tiles[$t]=_i(pe,be,De,qe,xt),this.tileCoords.push({z:be,x:De,y:qe}),wt)){wt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",be,De,qe,nr.numFeatures,nr.numPoints,nr.numSimplified),console.timeEnd("creation"));const Kn=`z${be}`;this.stats[Kn]=(this.stats[Kn]||0)+1,this.total++}if(nr.source=pe,Ue==null){if(be===xt.indexMaxZoom||nr.numPoints<=xt.indexMaxPoints)continue}else{if(be===xt.maxZoom||be===Ue)continue;if(Ue!=null){const Kn=Ue-be;if(De!==Xe>>Kn||qe!==ht>>Kn)continue}}if(nr.source=null,pe.length===0)continue;wt>1&&console.time("clipping");const or=.5*xt.buffer/xt.extent,Ur=.5-or,Jr=.5+or,Qr=1+or;let nn=null,di=null,Ci=null,hn=null,Ln=an(pe,vt,De-or,De+Jr,0,nr.minX,nr.maxX,xt),Wn=an(pe,vt,De+Ur,De+Qr,0,nr.minX,nr.maxX,xt);pe=null,Ln&&(nn=an(Ln,vt,qe-or,qe+Jr,1,nr.minY,nr.maxY,xt),di=an(Ln,vt,qe+Ur,qe+Qr,1,nr.minY,nr.maxY,xt),Ln=null),Wn&&(Ci=an(Wn,vt,qe-or,qe+Jr,1,nr.minY,nr.maxY,xt),hn=an(Wn,vt,qe+Ur,qe+Qr,1,nr.minY,nr.maxY,xt),Wn=null),wt>1&&console.timeEnd("clipping"),et.push(nn||[],be+1,2*De,2*qe),et.push(di||[],be+1,2*De,2*qe+1),et.push(Ci||[],be+1,2*De+1,2*qe),et.push(hn||[],be+1,2*De+1,2*qe+1)}}getTile(pe,be,De){pe=+pe,be=+be,De=+De;const qe=this.options,{extent:Ue,debug:Xe}=qe;if(pe<0||pe>24)return null;const ht=1<<pe,et=la(pe,be=be+ht&ht-1,De);if(this.tiles[et])return Vs(this.tiles[et],Ue);Xe>1&&console.log("drilling down to z%d-%d-%d",pe,be,De);let xt,wt=pe,vt=be,$t=De;for(;!xt&&wt>0;)wt--,vt>>=1,$t>>=1,xt=this.tiles[la(wt,vt,$t)];return xt&&xt.source?(Xe>1&&(console.log("found parent tile z%d-%d-%d",wt,vt,$t),console.time("drilling down")),this.splitTile(xt.source,wt,vt,$t,pe,be,De),Xe>1&&console.timeEnd("drilling down"),this.tiles[et]?Vs(this.tiles[et],Ue):null):null}}function la(bt,pe,be){return 32*((1<<bt)*be+pe)+bt}function Ol(bt,pe){const be=bt.tileID.canonical;if(!this._geoJSONIndex)return void pe(null,null);const De=this._geoJSONIndex.getTile(be.z,be.x,be.y);if(!De)return void pe(null,null);const qe=new se(De.features);let Ue=mt(qe);Ue.byteOffset===0&&Ue.byteLength===Ue.buffer.byteLength||(Ue=new Uint8Array(Ue)),pe(null,{vectorTile:qe,rawData:Ue.buffer})}class Kc extends B{constructor(pe,be,De,qe,Ue,Xe){super(pe,be,De,qe,Ol,Xe),Ue&&(this.loadGeoJSON=Ue),this._dynamicIndex=new Pe}loadData(pe,be){const De=pe&&pe.request,qe=De&&De.collectResourceTiming;this.loadGeoJSON(pe,(Ue,Xe)=>{if(Ue||!Xe)return be(Ue);if(typeof Xe!="object")return be(new Error(`Input data given to '${pe.source}' is not a valid GeoJSON object.`));{try{if(pe.filter){const et=s.X(pe.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(et.result==="error")throw new Error(et.value.map(xt=>`${xt.key}: ${xt.message}`).join(", "));Xe.features=Xe.features.filter(xt=>et.value.evaluate({zoom:0},xt))}pe.dynamic?(Xe.type==="Feature"&&(Xe={type:"FeatureCollection",features:[Xe]}),pe.append||(this._dynamicIndex.clear(),this.loaded={}),this._dynamicIndex.load(Xe.features,this.loaded),pe.cluster&&(Xe.features=this._dynamicIndex.getFeatures())):this.loaded={},this._geoJSONIndex=pe.cluster?new Dt(function({superclusterOptions:et,clusterProperties:xt}){if(!xt||!et)return et;const wt={},vt={},$t={accumulated:null,zoom:0},nr={properties:null},or=Object.keys(xt);for(const Ur of or){const[Jr,Qr]=xt[Ur],nn=s.X(Qr),di=s.X(typeof Jr=="string"?[Jr,["accumulated"],["get",Ur]]:Jr);wt[Ur]=nn.value,vt[Ur]=di.value}return et.map=Ur=>{nr.properties=Ur;const Jr={};for(const Qr of or)Jr[Qr]=wt[Qr].evaluate($t,nr);return Jr},et.reduce=(Ur,Jr)=>{nr.properties=Jr;for(const Qr of or)$t.accumulated=Ur[Qr],Ur[Qr]=vt[Qr].evaluate($t,nr)},et}(pe)).load(Xe.features):pe.dynamic?this._dynamicIndex:function(et,xt){return new Ji(et,xt)}(Xe,pe.geojsonVtOptions)}catch(et){return be(et)}const ht={};if(qe){const et=p(De);et&&(ht.resourceTiming={},ht.resourceTiming[pe.source]=JSON.parse(JSON.stringify(et)))}be(null,ht)}})}reloadTile(pe,be){const De=this.loaded;return De&&De[pe.uid]?pe.partial?be(null,void 0):super.reloadTile(pe,be):this.loadTile(pe,be)}loadGeoJSON(pe,be){if(pe.request)s.n(pe.request,be);else{if(typeof pe.data!="string")return be(new Error(`Input data given to '${pe.source}' is not a valid GeoJSON object.`));try{return be(null,JSON.parse(pe.data))}catch{return be(new Error(`Input data given to '${pe.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(pe,be){try{be(null,this._geoJSONIndex.getClusterExpansionZoom(pe.clusterId))}catch(De){be(De)}}getClusterChildren(pe,be){try{be(null,this._geoJSONIndex.getChildren(pe.clusterId))}catch(De){be(De)}}getClusterLeaves(pe,be){try{be(null,this._geoJSONIndex.getLeaves(pe.clusterId,pe.limit,pe.offset))}catch(De){be(De)}}}class Ih{constructor(pe,be){this.tileID=new s.aH(pe.tileID.overscaledZ,pe.tileID.wrap,pe.tileID.canonical.z,pe.tileID.canonical.x,pe.tileID.canonical.y),this.tileZoom=pe.tileZoom,this.uid=pe.uid,this.zoom=pe.zoom,this.canonical=pe.tileID.canonical,this.pixelRatio=pe.pixelRatio,this.tileSize=pe.tileSize,this.source=pe.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=pe.projection,this.brightness=be}parse(pe,be,De,qe){this.status="parsing";const Ue=new s.aH(De.tileID.overscaledZ,De.tileID.wrap,De.tileID.canonical.z,De.tileID.canonical.x,De.tileID.canonical.y),Xe=[],ht=be.familiesBySource[De.source],et=new s.e0(Ue,De.promoteId);return et.bucketLayerIDs=[],et.is3DTile=!0,s.ei(pe).then(xt=>{if(!xt)return qe(new Error("Could not parse tile"));const wt=s.ej(xt,1/s.cd(De.tileID.canonical)),vt=xt.json.extensionsUsed&&xt.json.extensionsUsed.includes("MAPBOX_mesh_features")||xt.json.asset.extras&&xt.json.asset.extras.MAPBOX_mesh_features,$t=xt.json.extensionsUsed&&xt.json.extensionsUsed.includes("EXT_meshopt_compression"),nr=new s.aa(this.zoom,{brightness:this.brightness});for(const or in ht)for(const Ur of ht[or]){const Jr=Ur[0];et.bucketLayerIDs.push(Ur.map(nn=>s.C(nn.id,nn.scope))),Jr.recalculate(nr,[]);const Qr=new s.ek(Ur,wt,Ue,vt,$t,this.brightness,et);vt||(Qr.needsUpload=!0),Xe.push(Qr),Qr.evaluate(Jr)}this.status="done",qe(null,{buckets:Xe,featureIndex:et,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:null})}).catch(xt=>qe(new Error(xt.message)))}}class Hm{constructor(pe,be,De,qe,Ue,Xe){this.actor=pe,this.layerIndex=be,this.availableImages=De,this.brightness=Xe,this.loading={},this.loaded={}}loadTile(pe,be){const De=pe.uid,qe=this.loading[De]=new Ih(pe,this.brightness);s.bj(pe.request,(Ue,Xe)=>{const ht=!this.loading[De];return delete this.loading[De],ht||Ue?(qe.status="done",ht||(this.loaded[De]=qe),be(Ue)):Xe&&Xe.byteLength!==0?void qe.parse(Xe,this.layerIndex,pe,(et,xt)=>{qe.status="done",this.loaded=this.loaded||{},this.loaded[De]=qe,et||!xt?be(et):be(null,xt)}):(qe.status="done",this.loaded[De]=qe,be())})}reloadTile(pe,be){const De=this.loaded,qe=pe.uid;if(De&&De[qe]){const Ue=De[qe];Ue.projection=pe.projection,Ue.brightness=pe.brightness;const Xe=(ht,et)=>{Ue.reloadCallback&&(delete Ue.reloadCallback,this.loadTile(pe,be)),be(ht,et)};Ue.status==="parsing"?Ue.reloadCallback=Xe:Ue.status==="done"&&this.loadTile(pe,be)}}abortTile(pe,be){const De=pe.uid;this.loading[De]&&delete this.loading[De],be()}removeTile(pe,be){const De=this.loaded,qe=pe.uid;De&&De[qe]&&delete De[qe],be()}}class Oh{constructor(pe){this.self=pe,this.actor=new s.el(pe,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.imageRasterizer=new s.y,this.projections={},this.defaultProjection=s.bP({name:"mercator"}),this.workerSourceTypes={vector:B,geojson:Kc,"raster-dem":V,"raster-array":G,"batched-model":Hm},this.workerSources={},this.self.registerWorkerSource=(be,De)=>{if(this.workerSourceTypes[be])throw new Error(`Worker source with name "${be}" already registered.`);this.workerSourceTypes[be]=De},this.self.registerRTLTextPlugin=be=>{if(s.em.isParsed())throw new Error("RTL text plugin already registered.");s.em.applyArabicShaping=be.applyArabicShaping,s.em.processBidirectionalText=be.processBidirectionalText,s.em.processStyledBidirectionalText=be.processStyledBidirectionalText}}clearCaches(pe,be,De){delete this.layerIndexes[pe],delete this.availableImages[pe],delete this.workerSources[pe],De()}checkIfReady(pe,be,De){De()}setReferrer(pe,be){this.referrer=be}spriteLoaded(pe,{scope:be,isLoaded:De}){if(this.isSpriteLoaded[pe]||(this.isSpriteLoaded[pe]={}),this.isSpriteLoaded[pe][be]=De,this.workerSources[pe]&&this.workerSources[pe][be])for(const qe in this.workerSources[pe][be]){const Ue=this.workerSources[pe][be][qe];for(const Xe in Ue){const ht=Ue[Xe];ht instanceof B&&(ht.isSpriteLoaded=De,ht.fire(new s.A("isSpriteLoaded")))}}}setImages(pe,{scope:be,images:De},qe){if(this.availableImages[pe]||(this.availableImages[pe]={}),this.availableImages[pe][be]=De,this.workerSources[pe]&&this.workerSources[pe][be]){for(const Ue in this.workerSources[pe][be]){const Xe=this.workerSources[pe][be][Ue];for(const ht in Xe)Xe[ht].availableImages=De}qe()}else qe()}setProjection(pe,be){this.projections[pe]=s.bP(be)}setBrightness(pe,be,De){this.brightness=be,De()}setLayers(pe,be,De){this.getLayerIndex(pe,be.scope).replace(be.layers,be.options),De()}updateLayers(pe,be,De){this.getLayerIndex(pe,be.scope).update(be.layers,be.removedIds,be.options),De()}loadTile(pe,be,De){be.projection=this.projections[pe]||this.defaultProjection,this.getWorkerSource(pe,be.type,be.source,be.scope).loadTile(be,De)}decodeRasterArray(pe,be,De){this.getWorkerSource(pe,be.type,be.source,be.scope).decodeRasterArray(be,De)}reloadTile(pe,be,De){be.projection=this.projections[pe]||this.defaultProjection,this.getWorkerSource(pe,be.type,be.source,be.scope).reloadTile(be,De)}abortTile(pe,be,De){this.getWorkerSource(pe,be.type,be.source,be.scope).abortTile(be,De)}removeTile(pe,be,De){this.getWorkerSource(pe,be.type,be.source,be.scope).removeTile(be,De)}removeSource(pe,be,De){if(!(this.workerSources[pe]&&this.workerSources[pe][be.scope]&&this.workerSources[pe][be.scope][be.type]&&this.workerSources[pe][be.scope][be.type][be.source]))return;const qe=this.workerSources[pe][be.scope][be.type][be.source];delete this.workerSources[pe][be.scope][be.type][be.source],qe.removeSource!==void 0?qe.removeSource(be,De):De()}loadWorkerSource(pe,be,De){try{this.self.importScripts(be.url),De()}catch(qe){De(qe.toString())}}syncRTLPluginState(pe,be,De){try{s.em.setState(be);const qe=s.em.getPluginURL();if(s.em.isLoaded()&&!s.em.isParsed()&&qe!=null){this.self.importScripts(qe);const Ue=s.em.isParsed();De(Ue?void 0:new Error(`RTL Text Plugin failed to import scripts from ${qe}`),Ue)}}catch(qe){De(qe.toString())}}setDracoUrl(pe,be){this.dracoUrl=be}getAvailableImages(pe,be){this.availableImages[pe]||(this.availableImages[pe]={});let De=this.availableImages[pe][be];return De||(De=[]),De}getLayerIndex(pe,be){this.layerIndexes[pe]||(this.layerIndexes[pe]={});let De=this.layerIndexes[pe][be];return De||(De=this.layerIndexes[pe][be]=new j,De.scope=be),De}getWorkerSource(pe,be,De,qe){const Ue=this.workerSources;return Ue[pe]||(Ue[pe]={}),Ue[pe][qe]||(Ue[pe][qe]={}),Ue[pe][qe][be]||(Ue[pe][qe][be]={}),this.isSpriteLoaded[pe]||(this.isSpriteLoaded[pe]={}),Ue[pe][qe][be][De]||(Ue[pe][qe][be][De]=new this.workerSourceTypes[be]({send:(Xe,ht,et,xt,wt,vt)=>{this.actor.send(Xe,ht,et,pe,wt,vt)},scheduler:this.actor.scheduler},this.getLayerIndex(pe,qe),this.getAvailableImages(pe,qe),this.isSpriteLoaded[pe][qe],void 0,this.brightness)),Ue[pe][qe][be][De]}rasterizeImages(pe,be,De){const qe=new Map;for(const[Ue,{image:Xe,imageVariant:ht}]of be.tasks.entries()){const et=this.imageRasterizer.rasterize(ht,Xe,be.scope,pe);qe.set(Ue,et)}De(void 0,qe)}removeRasterizedImages(pe,be,De){this.imageRasterizer.removeImagesFromCacheByIds(be.imageIds,be.scope,pe),De()}enforceCacheSizeLimit(pe,be){s.en(be)}getWorkerPerformanceMetrics(pe,be,De){De(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new Oh(self)),Oh}),l(["./shared"],function(s){var p="3.11.1";const x={create:"create",load:"load",fullLoad:"fullLoad"},w={mark(b){performance.mark(b)},measure(b,c,h){performance.measure(b,c,h)}};function j(b){const c=b.name.split("?")[0];return s.a(c)&&c.includes("mapbox-gl.js")?"javascript":s.a(c)&&c.includes("mapbox-gl.css")?"css":s.b(c)?"fontRange":s.c(c)?"sprite":s.i(c)?"style":s.d(c)?"tilejson":"other"}var S,P={},F=function(){if(S)return P;function b(v){return!c(v)}function c(v){return typeof window>"u"||typeof document>"u"?"not a browser":function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var A,k,z=new Blob([""],{type:"text/javascript"}),q=URL.createObjectURL(z);try{k=new Worker(q),A=!0}catch{A=!1}return k&&k.terminate(),URL.revokeObjectURL(q),A}()?function(){var A=document.createElement("canvas");A.width=A.height=1;var k=A.getContext("2d");if(!k)return!1;var z=k.getImageData(0,0,1,1);return z&&z.width===A.width}()?(h[N=v&&v.failIfMajorPerformanceCaveat]===void 0&&(h[N]=function(A){var k,z=function(q){var K=document.createElement("canvas"),Y=Object.create(b.webGLContextAttributes);return Y.failIfMajorPerformanceCaveat=q,K.getContext("webgl2",Y)}(A);if(!z)return!1;try{k=z.createShader(z.VERTEX_SHADER)}catch{return!1}return!(!k||z.isContextLost())&&(z.shaderSource(k,"void main() {}"),z.compileShader(k),z.getShaderParameter(k,z.COMPILE_STATUS)===!0)}(N)),h[N]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL2 support"):"insufficient Canvas/getImageData support":"insufficient worker support";var N}S=1,P.supported=b,P.notSupportedReason=c;var h={};return b.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0},P}();function L(b,c,h){const v=document.createElement(b);return c!=null&&(v.className=c),h&&h.appendChild(v),v}function B(b,c,h){const v=document.createElementNS("http://www.w3.org/2000/svg",b);for(const N of Object.keys(c))v.setAttributeNS(null,N,String(c[N]));return h&&h.appendChild(v),v}const V=typeof document<"u"?document.documentElement&&document.documentElement.style:null,$=V&&V.userSelect!==void 0?"userSelect":"WebkitUserSelect";let G;function W(){V&&$&&(G=V[$],V[$]="none")}function Z(){V&&$&&(V[$]=G)}function se(b){b.preventDefault(),b.stopPropagation(),window.removeEventListener("click",se,!0)}function ae(){window.addEventListener("click",se,!0),window.setTimeout(()=>{window.removeEventListener("click",se,!0)},0)}function ce(b,c){const h=b.getBoundingClientRect();return xe(b,h,c)}function Pe(b,c){const h=b.getBoundingClientRect(),v=[];for(let N=0;N<c.length;N++)v.push(xe(b,h,c[N]));return v}function we(b){return/firefox/i.test(navigator.userAgent)&&/macintosh/i.test(navigator.userAgent)&&b.button===2&&b.ctrlKey?0:b.button}function xe(b,c,h){const v=b.offsetWidth===c.width?1:b.offsetWidth/c.width;return new s.P((h.clientX-c.left)*v,(h.clientY-c.top)*v)}const Ne="01",ze="NO_ACCESS_TOKEN";class ye{constructor(c,h,v){this._transformRequestFn=c,this._customAccessToken=h,this._silenceAuthErrors=!!v,this._createSkuToken()}_createSkuToken(){const c=function(){let h="";for(let v=0;v<10;v++)h+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",Ne,h].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=c.token,this._skuTokenExpiresAt=c.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(c,h){return this._transformRequestFn&&this._transformRequestFn(c,h)||{url:c}}normalizeStyleURL(c,h){if(!s.f(c))return c;const v=_e(c);return v.params.push(`sdk=js-${p}`),v.path=`/styles/v1${v.path}`,this._makeAPIURL(v,this._customAccessToken||h)}normalizeGlyphsURL(c,h){if(!s.f(c))return c;const v=_e(c);return v.path=`/fonts/v1${v.path}`,this._makeAPIURL(v,this._customAccessToken||h)}normalizeModelURL(c,h){if(!s.f(c))return c;const v=_e(c);return v.path=`/models/v1${v.path}`,this._makeAPIURL(v,this._customAccessToken||h)}normalizeSourceURL(c,h,v,N){if(!s.f(c))return c;const A=_e(c);return A.path=`/v4/${A.authority}.json`,A.params.push("secure"),v&&A.params.push(`language=${v}`),N&&A.params.push(`worldview=${N}`),this._makeAPIURL(A,this._customAccessToken||h)}normalizeIconsetURL(c,h){const v=_e(c);return s.f(c)?(v.path=`/styles/v1${v.path}/iconset.pbf`,this._makeAPIURL(v,this._customAccessToken||h)):Ee(v)}normalizeSpriteURL(c,h,v,N){const A=_e(c);return s.f(c)?(A.path=`/styles/v1${A.path}/sprite${h}${v}`,this._makeAPIURL(A,this._customAccessToken||N)):(A.path+=`${h}${v}`,Ee(A))}normalizeTileURL(c,h,v){if(this._isSkuTokenExpired()&&this._createSkuToken(),c&&!s.f(c))return c;const N=_e(c);N.path=N.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${h||v&&N.authority!=="raster"&&v===512?"@2x":""}${s.m.supported?".webp":"$1"}`),N.authority==="raster"?N.path=`/${s.e.RASTER_URL_PREFIX}${N.path}`:N.authority==="rasterarrays"?N.path=`/${s.e.RASTERARRAYS_URL_PREFIX}${N.path}`:N.authority==="3dtiles"?N.path=`/${s.e.TILES3D_URL_PREFIX}${N.path}`:(N.path=N.path.replace(/^.+\/v4\//,"/"),N.path=`/${s.e.TILE_URL_VERSION}${N.path}`);const A=this._customAccessToken||function(k){for(const z of k){const q=z.match(/^access_token=(.*)$/);if(q)return q[1]}return null}(N.params)||s.e.ACCESS_TOKEN;return s.e.REQUIRE_ACCESS_TOKEN&&A&&this._skuToken&&N.params.push(`sku=${this._skuToken}`),this._makeAPIURL(N,A)}canonicalizeTileURL(c,h){const v=_e(c);if(!v.path.match(/^(\/v4\/|\/(raster|rasterarrays)\/v1\/)/)||!v.path.match(/\.[\w]+$/))return c;let N="mapbox://";v.path.match(/^\/raster\/v1\//)?N+=`raster/${v.path.replace(`/${s.e.RASTER_URL_PREFIX}/`,"")}`:v.path.match(/^\/rasterarrays\/v1\//)?N+=`rasterarrays/${v.path.replace(`/${s.e.RASTERARRAYS_URL_PREFIX}/`,"")}`:N+=`tiles/${v.path.replace(`/${s.e.TILE_URL_VERSION}/`,"")}`;let A=v.params;return h&&(A=A.filter(k=>!k.match(/^access_token=/))),A.length&&(N+=`?${A.join("&")}`),N}canonicalizeTileset(c,h){const v=!!h&&s.f(h),N=[];for(const A of c.tiles||[])s.h(A)?N.push(this.canonicalizeTileURL(A,v)):N.push(A);return N}_makeAPIURL(c,h){const v="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",N=_e(s.e.API_URL);if(c.protocol=N.protocol,c.authority=N.authority,c.protocol==="http"){const A=c.params.indexOf("secure");A>=0&&c.params.splice(A,1)}if(N.path!=="/"&&(c.path=`${N.path}${c.path}`),!s.e.REQUIRE_ACCESS_TOKEN)return Ee(c);if(h=h||s.e.ACCESS_TOKEN,!this._silenceAuthErrors){if(!h)throw new Error(`An API access token is required to use Mapbox GL. ${v}`);if(h[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${v}`)}return c.params=c.params.filter(A=>A.indexOf("access_token")===-1),c.params.push(`access_token=${h||""}`),Ee(c)}}const ve=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function _e(b){const c=b.match(ve);if(!c)throw new Error("Unable to parse URL object");return{protocol:c[1],authority:c[2],path:c[3]||"/",params:c[4]?c[4].split("&"):[]}}function Ee(b){const c=b.params.length?`?${b.params.join("&")}`:"";return`${b.protocol}://${b.authority}${b.path}${c}`}const je="mapbox.eventData";function Ce(b){if(!b)return null;const c=b.split(".");if(!c||c.length!==3)return null;try{return JSON.parse(s.j(c[1]))}catch{return null}}class tt{constructor(c){this.type=c,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(c){const h=Ce(s.e.ACCESS_TOKEN);let v="";return v=h&&h.u?s.k(h.u):s.e.ACCESS_TOKEN||"",c?`${je}.${c}:${v}`:`${je}:${v}`}fetchEventData(){const c=s.s("localStorage"),h=this.getStorageKey(),v=this.getStorageKey("uuid");if(c)try{const N=localStorage.getItem(h);N&&(this.eventData=JSON.parse(N));const A=localStorage.getItem(v);A&&(this.anonId=A)}catch{s.w("Unable to read from LocalStorage")}}saveEventData(){const c=s.s("localStorage"),h=this.getStorageKey(),v=this.getStorageKey("uuid"),N=this.anonId;if(c&&N)try{localStorage.setItem(v,N),Object.keys(this.eventData).length>=1&&localStorage.setItem(h,JSON.stringify(this.eventData))}catch{s.w("Unable to write to LocalStorage")}}processRequests(c){}postEvent(c,h,v,N){if(!s.e.EVENTS_URL)return;const A=_e(s.e.EVENTS_URL);A.params.push(`access_token=${N||s.e.ACCESS_TOKEN||""}`);const k={event:this.type,created:new Date(c).toISOString()},z=h?s.l(k,h):k,q={url:Ee(A),headers:{"Content-Type":"text/plain"},body:JSON.stringify([z])};this.pendingRequest=s.p(q,K=>{this.pendingRequest=null,v(K),this.saveEventData(),this.processRequests(N)})}queueRequest(c,h){this.queue.push(c),this.processRequests(h)}}const it=new class extends tt{constructor(b){super("appUserTurnstile"),this._customAccessToken=b}postTurnstileEvent(b,c){s.e.EVENTS_URL&&s.e.ACCESS_TOKEN&&Array.isArray(b)&&b.some(h=>s.f(h)||s.h(h))&&this.queueRequest(Date.now(),c)}processRequests(b){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const c=Ce(s.e.ACCESS_TOKEN),h=c?c.u:s.e.ACCESS_TOKEN;let v=h!==this.eventData.tokenU;s.v(this.anonId)||(this.anonId=s.u(),v=!0);const N=this.queue.shift();if(this.eventData.lastSuccess){const A=new Date(this.eventData.lastSuccess),k=new Date(N),z=(N-this.eventData.lastSuccess)/864e5;v=v||z>=1||z<-1||A.getDate()!==k.getDate()}else v=!0;v?this.postEvent(N,{sdkIdentifier:"mapbox-gl-js",sdkVersion:p,skuId:Ne,"enabled.telemetry":!1,userId:this.anonId},A=>{A||(this.eventData.lastSuccess=N,this.eventData.tokenU=h)},b):this.processRequests()}},mt=it.postTurnstileEvent.bind(it),gt=new class extends tt{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(b,c,h,v){this.skuToken=c,this.errorCb=v,s.e.EVENTS_URL&&(h||s.e.ACCESS_TOKEN?this.queueRequest({id:b,timestamp:Date.now()},h):this.errorCb(new Error(ze)))}processRequests(b){if(this.pendingRequest||this.queue.length===0)return;const{id:c,timestamp:h}=this.queue.shift();c&&this.success[c]||(this.anonId||this.fetchEventData(),s.v(this.anonId)||(this.anonId=s.u()),this.postEvent(h,{sdkIdentifier:"mapbox-gl-js",sdkVersion:p,skuId:Ne,skuToken:this.skuToken,userId:this.anonId},v=>{v?this.errorCb(v):c&&(this.success[c]=!0)},b))}remove(){this.errorCb=null}},qt=gt.postMapLoadEvent.bind(gt),yr=new class extends tt{constructor(){super("style.load"),this.eventIdPerMapInstanceMap=new Map,this.mapInstanceIdMap=new WeakMap}getMapInstanceId(b){let c=this.mapInstanceIdMap.get(b);return c||(c=s.u(),this.mapInstanceIdMap.set(b,c)),c}getEventId(b){const c=this.eventIdPerMapInstanceMap.get(b)||0;return this.eventIdPerMapInstanceMap.set(b,c+1),c}postStyleLoadEvent(b,c){const{map:h,style:v,importedStyles:N}=c;if(!s.e.EVENTS_URL||!b&&!s.e.ACCESS_TOKEN)return;const A=this.getMapInstanceId(h),k={mapInstanceId:A,eventId:this.getEventId(A),style:v};N.length&&(k.importedStyles=N),this.queueRequest({timestamp:Date.now(),payload:k},b)}processRequests(b){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:c,payload:h}=this.queue.shift();this.postEvent(c,h,()=>{},b)}},tr=yr.postStyleLoadEvent.bind(yr),Ft=new class extends tt{constructor(){super("gljs.performance")}postPerformanceEvent(b,c){s.e.EVENTS_URL&&(b||s.e.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:c},b)}processRequests(b){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:c,performanceData:h}=this.queue.shift(),v=function(N){const A=performance.getEntriesByType("resource"),k=performance.getEntriesByType("mark"),z=function(ie){const de={};if(ie){for(const le in ie)if(le!=="other")for(const he of ie[le]){const fe=`${le}ResolveRangeMin`,Te=`${le}ResolveRangeMax`,Re=`${le}RequestCount`,Oe=`${le}RequestCachedCount`;de[fe]=Math.min(de[fe]||1/0,he.startTime),de[Te]=Math.max(de[Te]||-1/0,he.responseEnd);const $e=Le=>{de[Le]===void 0&&(de[Le]=0),++de[Le]};he.transferSize!==void 0&&he.transferSize===0&&$e(Oe),$e(Re)}}return de}(function(ie,de){const le={};if(ie)for(const he of ie){const fe=de(he);le[fe]===void 0&&(le[fe]=[]),le[fe].push(he)}return le}(A,j)),q=window.devicePixelRatio,K=navigator.connection||navigator.mozConnection||navigator.webkitConnection,Y=K?K.effectiveType:void 0,ee={counters:[],metadata:[],attributes:[]},Q=(ie,de,le)=>{le!=null&&ie.push({name:de,value:le.toString()})};for(const ie in z)Q(ee.counters,ie,z[ie]);if(N.interactionRange[0]!==1/0&&N.interactionRange[1]!==-1/0&&(Q(ee.counters,"interactionRangeMin",N.interactionRange[0]),Q(ee.counters,"interactionRangeMax",N.interactionRange[1])),k)for(const ie of Object.keys(x)){const de=x[ie],le=k.find(he=>he.name===de);le&&Q(ee.counters,de,le.startTime)}return Q(ee.counters,"visibilityHidden",N.visibilityHidden),Q(ee.attributes,"style",function(ie){if(ie)for(const de of ie){const le=de.name.split("?")[0];if(s.i(le)){const he=le.split("/").slice(-2);if(he.length===2)return`mapbox://styles/${he[0]}/${he[1]}`}}}(A)),Q(ee.attributes,"terrainEnabled",N.terrainEnabled?"true":"false"),Q(ee.attributes,"fogEnabled",N.fogEnabled?"true":"false"),Q(ee.attributes,"projection",N.projection),Q(ee.attributes,"zoom",N.zoom),Q(ee.metadata,"devicePixelRatio",q),Q(ee.metadata,"connectionEffectiveType",Y),Q(ee.metadata,"navigatorUserAgent",navigator.userAgent),Q(ee.metadata,"screenWidth",window.screen.width),Q(ee.metadata,"screenHeight",window.screen.height),Q(ee.metadata,"windowWidth",window.innerWidth),Q(ee.metadata,"windowHeight",window.innerHeight),Q(ee.metadata,"mapWidth",N.width/q),Q(ee.metadata,"mapHeight",N.height/q),Q(ee.metadata,"webglRenderer",N.renderer),Q(ee.metadata,"webglVendor",N.vendor),Q(ee.metadata,"sdkVersion",p),Q(ee.metadata,"sdkIdentifier","mapbox-gl-js"),ee}(h);for(const N of v.metadata);for(const N of v.counters);for(const N of v.attributes);this.postEvent(c,v,()=>{},b)}},er=Ft.postPerformanceEvent.bind(Ft),Dt=new class extends tt{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(b,c,h,v){if(!s.e.API_URL||!s.e.SESSION_PATH)return;const N=_e(s.e.API_URL+s.e.SESSION_PATH);N.params.push(`sku=${c||""}`),N.params.push(`access_token=${v||s.e.ACCESS_TOKEN||""}`);const A={url:Ee(N),headers:{"Content-Type":"text/plain"}};this.pendingRequest=s.g(A,k=>{this.pendingRequest=null,h(k),this.saveEventData(),this.processRequests(v)})}getSessionAPI(b,c,h,v){this.skuToken=c,this.errorCb=v,s.e.SESSION_PATH&&s.e.API_URL&&(h||s.e.ACCESS_TOKEN?this.queueRequest({id:b,timestamp:Date.now()},h):this.errorCb(new Error(ze)))}processRequests(b){if(this.pendingRequest||this.queue.length===0)return;const{id:c,timestamp:h}=this.queue.shift();c&&this.success[c]||this.getSession(h,this.skuToken,v=>{v?this.errorCb(v):c&&(this.success[c]=!0)},b)}remove(){this.errorCb=null}},ge=Dt.getSessionAPI.bind(Dt),sr=new Set;function St(b,c){c?sr.add(b):sr.delete(b)}class jr{constructor(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps=new Set,this._updatedImages={}}isDirty(){return this._changed}setDirty(){this._changed=!0}getUpdatedSourceCaches(){return this._updatedSourceCaches}updateSourceCache(c,h){this._updatedSourceCaches[c]=h,this.setDirty()}discardSourceCacheUpdate(c){delete this._updatedSourceCaches[c]}updateLayer(c){const h=c.scope;this._updatedLayers[h]=this._updatedLayers[h]||new Set,this._updatedLayers[h].add(c.id),this.setDirty()}removeLayer(c){const h=c.scope;this._removedLayers[h]=this._removedLayers[h]||{},this._updatedLayers[h]=this._updatedLayers[h]||new Set,this._removedLayers[h][c.id]=c,this._updatedLayers[h].delete(c.id),this._updatedPaintProps.delete(c.fqid),this.setDirty()}getRemovedLayer(c){return this._removedLayers[c.scope]?this._removedLayers[c.scope][c.id]:null}discardLayerRemoval(c){this._removedLayers[c.scope]&&delete this._removedLayers[c.scope][c.id]}getLayerUpdatesByScope(){const c={};for(const h in this._updatedLayers)c[h]=c[h]||{},c[h].updatedIds=Array.from(this._updatedLayers[h].values());for(const h in this._removedLayers)c[h]=c[h]||{},c[h].removedIds=Object.keys(this._removedLayers[h]);return c}getUpdatedPaintProperties(){return this._updatedPaintProps}updatePaintProperties(c){this._updatedPaintProps.add(c.fqid),this.setDirty()}getUpdatedImages(c){return this._updatedImages[c]?Array.from(this._updatedImages[c].values()):[]}updateImage(c,h){this._updatedImages[h]=this._updatedImages[h]||new Set,this._updatedImages[h].add(s.I.toString(c)),this.setDirty()}resetUpdatedImages(c){this._updatedImages[c]&&this._updatedImages[c].clear()}reset(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps.clear(),this._updatedImages={}}}function dt(b){const{userImage:c}=b;return!!(c&&c.render&&c.render())&&(b.data.replace(new Uint8Array(c.data.buffer)),!0)}class Yr extends s.E{constructor(c){super(),this.imageProviders=new Map,this.images=new Map,this.updatedImages=new Map,this.callbackDispatchedThisFrame=new Map,this.loaded=new Map,this.requestors=[],this.patterns=new Map,this.patternsInFlight=new Set,this.atlasImage=new Map,this.atlasTexture=new Map,this.dirty=!0,this.spriteFormat=c,c!=="raster"&&s.t()&&(this.imageRasterizerDispatcher=new s.D(s.x(),this,"Image Rasterizer Worker",1))}addScope(c){this.loaded.set(c,!1),this.imageProviders.set(c,new Map),this.images.set(c,new Map),this.updatedImages.set(c,new Set),this.callbackDispatchedThisFrame.set(c,new Set),this.patterns.set(c,new Map),this.atlasImage.set(c,new s.r({width:1,height:1}))}removeScope(c){this.loaded.delete(c),this.imageProviders.delete(c),this.images.delete(c),this.updatedImages.delete(c),this.callbackDispatchedThisFrame.delete(c),this.patterns.delete(c),this.atlasImage.delete(c);const h=this.atlasTexture.get(c);h&&(h.destroy(),this.atlasTexture.delete(c))}addImageProvider(c,h){this.imageProviders.has(h)||this.imageProviders.set(h,new Map),this.imageProviders.get(h).set(c.id,c)}removeImageProvider(c,h){this.imageProviders.has(h)&&this.imageProviders.get(h).delete(c)}getPendingImageProviders(){const c=[];for(const h of this.imageProviders.values())for(const v of h.values())v.hasPendingRequests()&&c.push(v);return c}get imageRasterizer(){return this._imageRasterizer||(this._imageRasterizer=new s.y),this._imageRasterizer}isLoaded(){for(const c of this.loaded.keys())if(!this.loaded.get(c))return!1;return!0}setLoaded(c,h){if(this.loaded.get(h)!==c&&(this.loaded.set(h,c),c)){for(const{ids:v,callback:N}of this.requestors)this._notify(v,h,N);this.requestors=[]}}hasImage(c,h){return!!this.getImage(c,h)}getImage(c,h){return this.images.get(h).get(c.toString())}addImage(c,h,v){this._validate(c,v)&&this.images.get(h).set(c.toString(),v)}_validate(c,h){let v=!0;return this._validateStretch(h.stretchX,h.data&&h.data.width)||(this.fire(new s.z(new Error(`Image "${c.name}" has invalid "stretchX" value`))),v=!1),this._validateStretch(h.stretchY,h.data&&h.data.height)||(this.fire(new s.z(new Error(`Image "${c.name}" has invalid "stretchY" value`))),v=!1),this._validateContent(h.content,h)||(this.fire(new s.z(new Error(`Image "${c.name}" has invalid "content" value`))),v=!1),v}_validateStretch(c,h){if(!c)return!0;let v=0;for(const N of c){if(N[0]<v||N[1]<N[0]||h<N[1])return!1;v=N[1]}return!0}_validateContent(c,h){return c?c.length!==4||!h.usvg&&(c[0]<0||h.data.width<c[0]||c[1]<0||h.data.height<c[1]||c[2]<0||h.data.width<c[2]||c[3]<0||h.data.height<c[3])?!1:!(c[2]<c[0]||c[3]<c[1]):!0}updateImage(c,h,v){const N=this.images.get(h).get(c.toString());v.version=N.version+1,this.images.get(h).set(c.toString(),v),this.updatedImages.get(h).add(c),this.removeFromImageRasterizerCache(c,h)}clearUpdatedImages(c){this.updatedImages.get(c).clear()}removeFromImageRasterizerCache(c,h){if(this.spriteFormat!=="raster")if(s.t()){const v={imageIds:[c],scope:h};this.imageRasterizerDispatcher.getActor().send("removeRasterizedImages",v)}else this.imageRasterizer.removeImagesFromCacheByIds([c],h)}removeImage(c,h){const v=this.images.get(h),N=v.get(c.toString());v.delete(c.toString()),this.patterns.get(h).delete(c.toString()),this.removeFromImageRasterizerCache(c,h),N.userImage&&N.userImage.onRemove&&N.userImage.onRemove()}listImages(c){return Array.from(this.images.get(c).keys()).map(h=>s.I.from(h))}getImages(c,h,v){const N=[],A=[],k=this.imageProviders.get(h);for(const Y of c){if(!Y.iconsetId){N.push(Y);continue}const ee=k.get(Y.iconsetId);ee&&(this.getImage(Y,h)?A.push(Y):ee.addPendingRequest(Y))}if(N.length===0)return void this._notify(A,h,v);let z=!0;const q=!!this.loaded.get(h),K=this.images.get(h);if(!q)for(const Y of N)K.has(Y.toString())||(z=!1);q||z?this._notify(N,h,v):this.requestors.push({ids:N,scope:h,callback:v})}rasterizeImages({scope:c,tasks:h},v){const N=new Map;for(const[A,k]of h.entries()){const z=this.getImage(k.id,c);z&&N.set(A,{image:z,imageVariant:k})}this._rasterizeImages(c,N,v)}_rasterizeImages(c,h,v){if(s.t())this.imageRasterizerDispatcher.getActor().send("rasterizeImages",{tasks:h,scope:c},v);else{const N=new Map;for(const[A,{image:k,imageVariant:z}]of h.entries())N.set(A,this.imageRasterizer.rasterize(z,k,c,0));v(void 0,N)}}getUpdatedImages(c){return this.updatedImages.get(c)||new Set}_notify(c,h,v){const N=this.images.get(h),A=new Map;for(const k of c){const z=N.get(k.toString());if(!z){if(k.iconsetId)continue;s.w(`Image "${k.name}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`),this.fire(new s.A("styleimagemissing",{id:k.name}));continue}const q={data:z.usvg?null:z.data.clone(),pixelRatio:z.pixelRatio,sdf:z.sdf,usvg:z.usvg,version:z.version,stretchX:z.stretchX,stretchY:z.stretchY,content:z.content,hasRenderCallback:!!(z.userImage&&z.userImage.render)};z.usvg&&Object.assign(q,{width:z.icon.usvg_tree.width,height:z.icon.usvg_tree.height}),A.set(s.I.toString(k),q)}v(null,A)}getPixelSize(c){const{width:h,height:v}=this.atlasImage.get(c);return{width:h,height:v}}getPattern(c,h,v){const N=c.toString(),A=this.patterns.get(h),k=A.get(N),z=this.getImage(c,h);if(!z)return null;if(k){if(k.position.version===z.version)return k.position;k.position.version=z.version}else{if(z.usvg&&!z.data){const q=this.getPatternInFlightId(N,h);if(this.patternsInFlight.has(q))return null;this.patternsInFlight.add(q);const K=new s.B(c).scaleSelf(s.q.devicePixelRatio),Y=new Map([[K.toString(),{image:z,imageVariant:K}]]);return this._rasterizeImages(h,Y,(ee,Q)=>this.storePatternImage(K,h,z,v,Q)),null}this.storePattern(c,h,z)}return this._updatePatternAtlas(h,v),A.get(N).position}getPatternInFlightId(c,h){return s.C(c,h)}hasPatternsInFlight(){return this.patternsInFlight.size!==0}storePatternImage(c,h,v,N,A){const k=c.toString(),z=A?A.get(k):void 0;z&&(v.data=z,this.storePattern(c.id,h,v),this._updatePatternAtlas(h,N),this.patternsInFlight.delete(this.getPatternInFlightId(c.id.toString(),h)))}storePattern(c,h,v){const N={w:v.data.width+2*s.F,h:v.data.height+2*s.F,x:0,y:0},A=new s.G(N,v,s.F);this.patterns.get(h).set(c.toString(),{bin:N,position:A})}bind(c,h){const v=c.gl;let N=this.atlasTexture.get(h);N?this.dirty&&(N.update(this.atlasImage.get(h)),this.dirty=!1):(N=new s.T(c,this.atlasImage.get(h),v.RGBA8),this.atlasTexture.set(h,N)),N.bind(v.LINEAR,v.CLAMP_TO_EDGE)}_updatePatternAtlas(c,h){const v=this.patterns.get(c),N=Array.from(v.values()).map(({bin:K})=>K),{w:A,h:k}=s.H(N),z=this.atlasImage.get(c);z.resize({width:A||1,height:k||1});const q=this.images.get(c);for(const[K,{bin:Y,position:ee}]of v.entries()){let Q=ee.padding;const ie=Y.x+Q,de=Y.y+Q,le=q.get(K).data,he=le.width,fe=le.height;Q=Q>1?Q-1:Q,s.r.copy(le,z,{x:0,y:0},{x:ie,y:de},{width:he,height:fe},h),s.r.copy(le,z,{x:0,y:fe-Q},{x:ie,y:de-Q},{width:he,height:Q},h),s.r.copy(le,z,{x:0,y:0},{x:ie,y:de+fe},{width:he,height:Q},h),s.r.copy(le,z,{x:he-Q,y:0},{x:ie-Q,y:de},{width:Q,height:fe},h),s.r.copy(le,z,{x:0,y:0},{x:ie+he,y:de},{width:Q,height:fe},h),s.r.copy(le,z,{x:he-Q,y:fe-Q},{x:ie-Q,y:de-Q},{width:Q,height:Q},h),s.r.copy(le,z,{x:0,y:fe-Q},{x:ie+he,y:de-Q},{width:Q,height:Q},h),s.r.copy(le,z,{x:0,y:0},{x:ie+he,y:de+fe},{width:Q,height:Q},h),s.r.copy(le,z,{x:he-Q,y:0},{x:ie-Q,y:de+fe},{width:Q,height:Q},h)}this.dirty=!0}beginFrame(){for(const c of this.images.keys())this.callbackDispatchedThisFrame.set(c,new Set)}dispatchRenderCallbacks(c,h){const v=this.images.get(h);for(const N of c){if(this.callbackDispatchedThisFrame.get(h).has(N.toString()))continue;this.callbackDispatchedThisFrame.get(h).add(N.toString());const A=v.get(N.toString());dt(A)&&this.updateImage(N,h,A)}}}function Vr(b){const c=b.key,h=b.value,v=b.valueSpec||{},N=b.objectElementValidators||{},A=b.style,k=b.styleSpec;let z=[];const q=s.K(h);if(q!=="object")return[new s.V(c,h,`object expected, ${q} found`)];for(const K in h){const Y=K.split(".")[0];let ee;N[Y]?ee=N[Y]:v[Y]?ee=Ir:N["*"]?ee=N["*"]:v["*"]&&(ee=Ir),ee?z=z.concat(ee({key:(c&&`${c}.`)+K,value:h[K],valueSpec:v[Y]||v["*"],style:A,styleSpec:k,object:h,objectKey:K},h)):z.push(new s.J(c,h[K],`unknown property "${K}"`))}for(const K in v)N[K]||v[K].required&&v[K].default===void 0&&h[K]===void 0&&z.push(new s.V(c,h,`missing required property "${K}"`));return z}function Yn(b){const c=b.value,h=b.valueSpec,v=b.style,N=b.styleSpec,A=b.key,k=b.arrayElementValidator||Ir;if(s.K(c)!=="array")return[new s.V(A,c,`array expected, ${s.K(c)} found`)];if(h.length&&c.length!==h.length)return[new s.V(A,c,`array length ${h.length} expected, length ${c.length} found`)];if(h["min-length"]&&c.length<h["min-length"])return[new s.V(A,c,`array length at least ${h["min-length"]} expected, length ${c.length} found`)];let z={type:h.value,values:h.values,minimum:h.minimum,maximum:h.maximum,function:void 0};N.$version<7&&(z.function=h.function),s.K(h.value)==="object"&&(z=h.value);let q=[];for(let K=0;K<c.length;K++)q=q.concat(k({array:c,arrayIndex:K,value:c[K],valueSpec:z,style:v,styleSpec:N,key:`${A}[${K}]`},!0));return q}function Ye(b){const c=b.key,h=b.value,v=b.valueSpec;let N=s.K(h);if(N==="number"&&h!=h&&(N="NaN"),N!=="number")return[new s.V(c,h,`number expected, ${N} found`)];if("minimum"in v){let A=v.minimum;if(s.K(v.minimum)==="array"&&(A=v.minimum[b.arrayIndex]),h<A)return[new s.V(c,h,`${h} is less than the minimum value ${A}`)]}if("maximum"in v){let A=v.maximum;if(s.K(v.maximum)==="array"&&(A=v.maximum[b.arrayIndex]),h>A)return[new s.V(c,h,`${h} is greater than the maximum value ${A}`)]}return[]}function Nt(b){const c=b.valueSpec,h=s.M(b.value.type);let v,N,A,k={};const z=h!=="categorical"&&b.value.property===void 0,q=!z,K=s.K(b.value.stops)==="array"&&s.K(b.value.stops[0])==="array"&&s.K(b.value.stops[0][0])==="object",Y=Vr({key:b.key,value:b.value,valueSpec:b.styleSpec.function,style:b.style,styleSpec:b.styleSpec,objectElementValidators:{stops:function(ie){if(h==="identity")return[new s.V(ie.key,ie.value,'identity function may not have a "stops" property')];let de=[];const le=ie.value;return de=de.concat(Yn({key:ie.key,value:le,valueSpec:ie.valueSpec,style:ie.style,styleSpec:ie.styleSpec,arrayElementValidator:ee})),s.K(le)==="array"&&le.length===0&&de.push(new s.V(ie.key,le,"array must have at least one stop")),de},default:function(ie){return Ir({key:ie.key,value:ie.value,valueSpec:c,style:ie.style,styleSpec:ie.styleSpec})}}});return h==="identity"&&z&&Y.push(new s.V(b.key,b.value,'missing required property "property"')),h==="identity"||b.value.stops||Y.push(new s.V(b.key,b.value,'missing required property "stops"')),h==="exponential"&&b.valueSpec.expression&&!s.N(b.valueSpec)&&Y.push(new s.V(b.key,b.value,"exponential functions not supported")),b.styleSpec.$version>=8&&(q&&!s.O(b.valueSpec)?Y.push(new s.V(b.key,b.value,"property functions not supported")):z&&!s.Q(b.valueSpec)&&Y.push(new s.V(b.key,b.value,"zoom functions not supported"))),h!=="categorical"&&!K||b.value.property!==void 0||Y.push(new s.V(b.key,b.value,'"property" property is required')),Y;function ee(ie){let de=[];const le=ie.value,he=ie.key;if(s.K(le)!=="array")return[new s.V(he,le,`array expected, ${s.K(le)} found`)];if(le.length!==2)return[new s.V(he,le,`array length 2 expected, length ${le.length} found`)];if(K){if(s.K(le[0])!=="object")return[new s.V(he,le,`object expected, ${s.K(le[0])} found`)];if(le[0].zoom===void 0)return[new s.V(he,le,"object stop key must have zoom")];if(le[0].value===void 0)return[new s.V(he,le,"object stop key must have value")];const fe=s.M(le[0].zoom);if(typeof fe!="number")return[new s.V(he,le[0].zoom,"stop zoom values must be numbers")];if(A&&A>fe)return[new s.V(he,le[0].zoom,"stop zoom values must appear in ascending order")];fe!==A&&(A=fe,N=void 0,k={}),de=de.concat(Vr({key:`${he}[0]`,value:le[0],valueSpec:{zoom:{}},style:ie.style,styleSpec:ie.styleSpec,objectElementValidators:{zoom:Ye,value:Q}}))}else de=de.concat(Q({key:`${he}[0]`,value:le[0],valueSpec:{},style:ie.style,styleSpec:ie.styleSpec},le));return s.S(s.U(le[1]))?de.concat([new s.V(`${he}[1]`,le[1],"expressions are not allowed in function stops.")]):de.concat(Ir({key:`${he}[1]`,value:le[1],valueSpec:c,style:ie.style,styleSpec:ie.styleSpec}))}function Q(ie,de){const le=s.K(ie.value),he=s.M(ie.value),fe=ie.value!==null?ie.value:de;if(v){if(le!==v)return[new s.V(ie.key,fe,`${le} stop domain type must match previous stop domain type ${v}`)]}else v=le;if(le!=="number"&&le!=="string"&&le!=="boolean"&&typeof he!="number"&&typeof he!="string"&&typeof he!="boolean")return[new s.V(ie.key,fe,"stop domain value must be a number, string, or boolean")];if(le!=="number"&&h!=="categorical"){let Te=`number expected, ${le} found`;return s.O(c)&&h===void 0&&(Te+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new s.V(ie.key,fe,Te)]}return h!=="categorical"||le!=="number"||typeof he=="number"&&isFinite(he)&&Math.floor(he)===he?h!=="categorical"&&le==="number"&&typeof he=="number"&&typeof N=="number"&&N!==void 0&&he<N?[new s.V(ie.key,fe,"stop domain values must appear in ascending order")]:(N=he,h==="categorical"&&he in k?[new s.V(ie.key,fe,"stop domain values must be unique")]:(k[he]=!0,[])):[new s.V(ie.key,fe,`integer expected, found ${String(he)}`)]}}function zt(b){const c=(b.expressionContext==="property"?s.W:s.X)(s.U(b.value),b.valueSpec);if(c.result==="error")return c.value.map(v=>new s.V(`${b.key}${v.key}`,b.value,v.message));const h=c.value.expression||c.value._styleExpression.expression;if(b.expressionContext==="property"&&b.propertyKey==="text-font"&&!h.outputDefined())return[new s.V(b.key,b.value,`Invalid data expression for "${b.propertyKey}". Output values must be contained as literals within the expression.`)];if(b.expressionContext==="property"&&b.propertyType==="layout"&&!s.Y(h))return[new s.V(b.key,b.value,'"feature-state" data expressions are not supported with layout properties.')];if(b.expressionContext==="filter")return Nr(h,b);if(b.expressionContext&&b.expressionContext.indexOf("cluster")===0){if(!s.Z(h,["zoom","feature-state"]))return[new s.V(b.key,b.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(b.expressionContext==="cluster-initial"&&!s._(h))return[new s.V(b.key,b.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Nr(b,c){const h=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(c.valueSpec&&c.valueSpec.expression)for(const N of c.valueSpec.expression.parameters)h.delete(N);if(h.size===0)return[];const v=[];return b instanceof s.$&&h.has(b.name)?[new s.V(c.key,c.value,`["${b.name}"] expression is not supported in a filter for a ${c.object.type} layer with id: ${c.object.id}`)]:(b.eachChild(N=>{v.push(...Nr(N,c))}),v)}function br(b){const c=b.key,h=b.value,v=b.valueSpec,N=[];return Array.isArray(v.values)?v.values.indexOf(s.M(h))===-1&&N.push(new s.V(c,h,`expected one of [${v.values.join(", ")}], ${JSON.stringify(h)} found`)):Object.keys(v.values).indexOf(s.M(h))===-1&&N.push(new s.V(c,h,`expected one of [${Object.keys(v.values).join(", ")}], ${JSON.stringify(h)} found`)),N}function hr(b){return s.a1(s.U(b.value))?zt(s.L({},b,{expressionContext:"filter",valueSpec:b.styleSpec[`filter_${b.layerType||"fill"}`]})):rr(b)}function rr(b){const c=b.value,h=b.key;if(s.K(c)!=="array")return[new s.V(h,c,`array expected, ${s.K(c)} found`)];const v=b.styleSpec;let N,A=[];if(c.length<1)return[new s.V(h,c,"filter array must have at least 1 element")];switch(A=A.concat(br({key:`${h}[0]`,value:c[0],valueSpec:v.filter_operator,style:b.style,styleSpec:b.styleSpec})),s.M(c[0])){case"<":case"<=":case">":case">=":c.length>=2&&s.M(c[1])==="$type"&&A.push(new s.V(h,c,`"$type" cannot be use with operator "${c[0]}"`));case"==":case"!=":c.length!==3&&A.push(new s.V(h,c,`filter array for operator "${c[0]}" must have 3 elements`));case"in":case"!in":c.length>=2&&(N=s.K(c[1]),N!=="string"&&A.push(new s.V(`${h}[1]`,c[1],`string expected, ${N} found`)));for(let k=2;k<c.length;k++)N=s.K(c[k]),s.M(c[1])==="$type"?A=A.concat(br({key:`${h}[${k}]`,value:c[k],valueSpec:v.geometry_type,style:b.style,styleSpec:b.styleSpec})):N!=="string"&&N!=="number"&&N!=="boolean"&&A.push(new s.V(`${h}[${k}]`,c[k],`string, number, or boolean expected, ${N} found`));break;case"any":case"all":case"none":for(let k=1;k<c.length;k++)A=A.concat(rr({key:`${h}[${k}]`,value:c[k],style:b.style,styleSpec:b.styleSpec}));break;case"has":case"!has":N=s.K(c[1]),c.length!==2?A.push(new s.V(h,c,`filter array for "${c[0]}" operator must have 2 elements`)):N!=="string"&&A.push(new s.V(`${h}[1]`,c[1],`string expected, ${N} found`))}return A}function an(b,c){const h=b.key,v=b.style,N=b.layer,A=b.styleSpec,k=b.value,z=b.objectKey,q=A[`${c}_${b.layerType}`];if(!q)return[];const K=z.match(/^(.*)-use-theme$/);if(c==="paint"&&K&&q[K[1]])return s.S(k)?[].concat(Ir({key:b.key,value:k,valueSpec:{type:"string",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},style:v,styleSpec:A,expressionContext:"property",propertyType:c,propertyKey:z})):Ir({key:h,value:k,valueSpec:{type:"string"},style:v,styleSpec:A});const Y=z.match(/^(.*)-transition$/);if(c==="paint"&&Y&&q[Y[1]]&&q[Y[1]].transition)return Ir({key:h,value:k,valueSpec:A.transition,style:v,styleSpec:A});const ee=b.valueSpec||q[z];if(!ee)return[new s.J(h,k,`unknown property "${z}"`)];let Q;if(s.K(k)==="string"&&s.O(ee)&&!ee.tokens&&(Q=/^{([^}]+)}$/.exec(k))){const de=`\`{ "type": "identity", "property": ${Q?JSON.stringify(Q[1]):'"_"'} }\``;return[new s.V(h,k,`"${z}" does not support interpolation syntax
Use an identity property function instead: ${de}.`)]}const ie=[];if(b.layerType==="symbol")z!=="text-field"||!v||v.glyphs||v.imports||ie.push(new s.V(h,k,'use of "text-field" requires a style "glyphs" property')),z==="text-font"&&s.a2(s.U(k))&&s.M(k.type)==="identity"&&ie.push(new s.V(h,k,'"text-font" does not support identity functions'));else if(b.layerType==="model"&&c==="paint"&&N&&N.layout&&N.layout.hasOwnProperty("model-id")&&s.O(ee)&&(s.a3(ee)||s.Q(ee))){const de=s.W(s.U(k),ee),le=de.value.expression||de.value._styleExpression.expression;le&&!s.Z(le,["measure-light"])&&(z==="model-emissive-strength"&&s._(le)&&s.Y(le)||ie.push(new s.V(h,k,`${z} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`)))}return ie.concat(Ir({key:b.key,value:k,valueSpec:ee,style:v,styleSpec:A,expressionContext:"property",propertyType:c,propertyKey:z}))}function ai(b){return an(b,"paint")}function ri(b){return an(b,"layout")}function Ui(b){let c=[];const h=b.value,v=b.key,N=b.style,A=b.styleSpec;h.type||h.ref||c.push(new s.V(v,h,'either "type" or "ref" is required'));let k=s.M(h.type);const z=s.M(h.ref);if(h.id){const q=s.M(h.id);for(let K=0;K<b.arrayIndex;K++){const Y=N.layers[K];s.M(Y.id)===q&&c.push(new s.V(v,h.id,`duplicate layer id "${h.id}", previously used at line ${Y.id.__line__}`))}}if("ref"in h){let q;["type","source","source-layer","filter","layout"].forEach(K=>{K in h&&c.push(new s.V(v,h[K],`"${K}" is prohibited for ref layers`))}),N.layers.forEach(K=>{s.M(K.id)===z&&(q=K)}),q?q.ref?c.push(new s.V(v,h.ref,"ref cannot reference another ref layer")):k=s.M(q.type):typeof z=="string"&&c.push(new s.V(v,h.ref,`ref layer "${z}" not found`))}else if(k!=="background"&&k!=="sky"&&k!=="slot")if(h.source){const q=N.sources&&N.sources[h.source],K=q&&s.M(q.type);q?K==="vector"&&k==="raster"?c.push(new s.V(v,h.source,`layer "${h.id}" requires a raster source`)):K==="raster"&&k!=="raster"?c.push(new s.V(v,h.source,`layer "${h.id}" requires a vector source`)):K!=="vector"||h["source-layer"]?K==="raster-dem"&&k!=="hillshade"?c.push(new s.V(v,h.source,"raster-dem source can only be used with layer type 'hillshade'.")):K!=="raster-array"||["raster","raster-particle"].includes(k)?k!=="line"||!h.paint||!h.paint["line-gradient"]&&!h.paint["line-trim-offset"]||K==="geojson"&&q.lineMetrics?k==="raster-particle"&&K!=="raster-array"&&c.push(new s.V(v,h.source,`layer "${h.id}" requires a 'raster-array' source.`)):c.push(new s.V(v,h,`layer "${h.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):c.push(new s.V(v,h.source,"raster-array source can only be used with layer type 'raster'.")):c.push(new s.V(v,h,`layer "${h.id}" must specify a "source-layer"`)):c.push(new s.V(v,h.source,`source "${h.source}" not found`))}else c.push(new s.V(v,h,'missing required property "source"'));return c=c.concat(Vr({key:v,value:h,valueSpec:A.layer,style:b.style,styleSpec:b.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Ir({key:`${v}.type`,value:h.type,valueSpec:A.layer.type,style:b.style,styleSpec:b.styleSpec,object:h,objectKey:"type"}),filter:q=>hr(s.L({layerType:k},q)),layout:q=>Vr({layer:h,key:q.key,value:q.value,valueSpec:{},style:q.style,styleSpec:q.styleSpec,objectElementValidators:{"*":K=>ri(s.L({layerType:k},K))}}),paint:q=>Vr({layer:h,key:q.key,value:q.value,valueSpec:{},style:q.style,styleSpec:q.styleSpec,objectElementValidators:{"*":K=>ai(s.L({layerType:k,layer:h},K))}})}})),c}function oa(b){const c=b.value,h=b.key,v=s.K(c);return v!=="string"?[new s.V(h,c,`string expected, ${v} found`)]:[]}const Xs={promoteId:function b({key:c,value:h}){if(s.K(h)==="string")return oa({key:c,value:h});if(Array.isArray(h)){const v=[],N=s.U(h),A=s.X(N);return A.result==="error"&&A.value.forEach(k=>{v.push(new s.V(`${c}${k.key}`,null,`${k.message}`))}),s.Z(A.value.expression,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])||v.push(new s.V(`${c}`,null,"promoteId expression should be only feature dependent")),v}{const v=[];for(const N in h)v.push(...b({key:`${c}.${N}`,value:h[N]}));return v}}};function rl(b){const c=b.value,h=b.key,v=b.styleSpec,N=b.style;if(!c.type)return[new s.V(h,c,'"type" is required')];const A=s.M(c.type);let k=[];switch(["vector","raster","raster-dem","raster-array"].includes(A)&&(c.url||c.tiles||k.push(new s.J(h,c,'Either "url" or "tiles" is required.'))),A){case"vector":case"raster":case"raster-dem":case"raster-array":return k=k.concat(Vr({key:h,value:c,valueSpec:v[`source_${A.replace("-","_")}`],style:b.style,styleSpec:v,objectElementValidators:Xs})),k;case"geojson":if(k=Vr({key:h,value:c,valueSpec:v.source_geojson,style:N,styleSpec:v,objectElementValidators:Xs}),c.cluster)for(const z in c.clusterProperties){const[q,K]=c.clusterProperties[z],Y=typeof q=="string"?[q,["accumulated"],["get",z]]:q;k.push(...zt({key:`${h}.${z}.map`,value:K,expressionContext:"cluster-map"})),k.push(...zt({key:`${h}.${z}.reduce`,value:Y,expressionContext:"cluster-reduce"}))}return k;case"video":return Vr({key:h,value:c,valueSpec:v.source_video,style:N,styleSpec:v});case"image":return Vr({key:h,value:c,valueSpec:v.source_image,style:N,styleSpec:v});case"canvas":return[new s.V(h,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return br({key:`${h}.type`,value:c.type,valueSpec:{values:Il(v)},style:N,styleSpec:v})}}function Il(b){return b.source.reduce((c,h)=>{const v=b[h];return v.type.type==="enum"&&(c=c.concat(Object.keys(v.type.values))),c},[])}function xo(b){const c=b.value,h=b.styleSpec,v=h.light,N=b.style;let A=[];const k=s.K(c);if(c===void 0)return A;if(k!=="object")return A=A.concat([new s.V("light",c,`object expected, ${k} found`)]),A;for(const z in c){const q=z.match(/^(.*)-transition$/),K=z.match(/^(.*)-use-theme$/);A=A.concat(K&&v[K[1]]?Ir({key:z,value:c[z],valueSpec:{type:"string"},style:N,styleSpec:h}):q&&v[q[1]]&&v[q[1]].transition?Ir({key:z,value:c[z],valueSpec:h.transition,style:N,styleSpec:h}):v[z]?Ir({key:z,value:c[z],valueSpec:v[z],style:N,styleSpec:h}):[new s.V(z,c[z],`unknown property "${z}"`)])}return A}function nl(b){const c=b.value;let h=[];if(!c)return h;const v=s.K(c);if(v!=="object")return h=h.concat([new s.V("light-3d",c,`object expected, ${v} found`)]),h;const N=b.styleSpec,A=N["light-3d"],k=b.key,z=b.style,q=b.style.lights;for(const ee of["type","id"])if(!(ee in c))return h=h.concat([new s.V("light-3d",c,`missing property ${ee} on light`)]),h;if(c.type&&q)for(let ee=0;ee<b.arrayIndex;ee++){const Q=s.M(c.type),ie=q[ee];s.M(ie.type)===Q&&h.push(new s.V(k,c.id,`duplicate light type "${c.type}", previously defined at line ${ie.id.__line__}`))}const K=`properties_light_${c.type}`;if(!(K in N))return h=h.concat([new s.V("light-3d",c,`Invalid light type ${c.type}`)]),h;const Y=N[K];for(const ee in c)if(ee==="properties"){const Q=c[ee],ie=s.K(Q);if(ie!=="object")return h=h.concat([new s.V("properties",Q,`object expected, ${ie} found`)]),h;for(const de in Q)h=h.concat(Y[de]?Ir({key:de,value:Q[de],valueSpec:Y[de],style:z,styleSpec:N}):[new s.J(b.key,Q[de],`unknown property "${de}"`)])}else{const Q=ee.match(/^(.*)-transition$/),ie=ee.match(/^(.*)-use-theme$/);h=h.concat(ie&&A[ie[1]]?Ir({key:ee,value:c[ee],valueSpec:{type:"string"},style:z,styleSpec:N}):Q&&A[Q[1]]&&A[Q[1]].transition?Ir({key:ee,value:c[ee],valueSpec:N.transition,style:z,styleSpec:N}):A[ee]?Ir({key:ee,value:c[ee],valueSpec:A[ee],style:z,styleSpec:N}):[new s.J(ee,c[ee],`unknown property "${ee}"`)])}return h}function Vs(b){const c=b.value,h=b.key,v=b.style,N=b.styleSpec,A=N.terrain;let k=[];const z=s.K(c);if(c===void 0||z==="null")return k;if(z!=="object")return k=k.concat([new s.V("terrain",c,`object expected, ${z} found`)]),k;for(const q in c){const K=q.match(/^(.*)-transition$/),Y=q.match(/^(.*)-use-theme$/);k=k.concat(Y&&A[Y[1]]?Ir({key:q,value:c[q],valueSpec:{type:"string"},style:v,styleSpec:N}):K&&A[K[1]]&&A[K[1]].transition?Ir({key:q,value:c[q],valueSpec:N.transition,style:v,styleSpec:N}):A[q]?Ir({key:q,value:c[q],valueSpec:A[q],style:v,styleSpec:N}):[new s.J(q,c[q],`unknown property "${q}"`)])}if(c.source){const q=v.sources&&v.sources[c.source],K=q&&s.M(q.type);q?K!=="raster-dem"&&k.push(new s.V(h,c.source,`terrain cannot be used with a source of type ${String(K)}, it only be used with a "raster-dem" source type`)):k.push(new s.V(h,c.source,`source "${c.source}" not found`))}else k.push(new s.V(h,c,'terrain is missing required property "source"'));return k}function Ua(b){const c=b.value,h=b.style,v=b.styleSpec,N=v.fog;let A=[];const k=s.K(c);if(c===void 0)return A;if(k!=="object")return A=A.concat([new s.V("fog",c,`object expected, ${k} found`)]),A;for(const z in c){const q=z.match(/^(.*)-transition$/),K=z.match(/^(.*)-use-theme$/);A=A.concat(K&&N[K[1]]?Ir({key:z,value:c[z],valueSpec:{type:"string"},style:h,styleSpec:v}):q&&N[q[1]]&&N[q[1]].transition?Ir({key:z,value:c[z],valueSpec:v.transition,style:h,styleSpec:v}):N[z]?Ir({key:z,value:c[z],valueSpec:N[z],style:h,styleSpec:v}):[new s.J(z,c[z],`unknown property "${z}"`)])}return A}const _i={"*":()=>[],array:Yn,boolean:function(b){const c=b.value,h=b.key,v=s.K(c);return v!=="boolean"?[new s.V(h,c,`boolean expected, ${v} found`)]:[]},number:Ye,color:function(b){const c=b.key,h=b.value,v=s.K(h);return v!=="string"?[new s.V(c,h,`color expected, ${v} found`)]:s.a0.parseCSSColor(h)===null?[new s.V(c,h,`color expected, "${h}" found`)]:[]},enum:br,filter:hr,function:Nt,layer:Ui,object:Vr,source:rl,model:s.a4,light:xo,"light-3d":nl,terrain:Vs,fog:Ua,string:oa,formatted:function(b){return oa(b).length===0?[]:zt(b)},resolvedImage:function(b){return oa(b).length===0?[]:zt(b)},projection:function(b){const c=b.value,h=b.styleSpec,v=h.projection,N=b.style;let A=[];const k=s.K(c);if(k==="object")for(const z in c)A=A.concat(Ir({key:z,value:c[z],valueSpec:v[z],style:N,styleSpec:h}));else k!=="string"&&(A=A.concat([new s.V("projection",c,`object or string expected, ${k} found`)]));return A},import:function(b){const{value:c,styleSpec:h}=b,{data:v,...N}=c;Object.defineProperty(N,"__line__",{value:c.__line__,enumerable:!1});let A=Vr(s.L({},b,{value:N,valueSpec:h.import}));return s.M(N.id)===""&&A.push(new s.V(`${b.key}.id`,N,"import id can't be an empty string")),v&&(A=A.concat(gi(v,h,{key:`${b.key}.data`}))),A},iconset:function(b){const c=b.value,h=b.key,v=b.styleSpec,N=b.style;if(!c.type)return[new s.V(h,c,'"type" is required')];const A=s.M(c.type);let k=[];if(k=k.concat(Vr({key:h,value:c,valueSpec:v[`iconset_${A}`],style:N,styleSpec:v})),A==="source"&&c.source){const z=N.sources&&N.sources[c.source],q=z&&s.M(z.type);z?q!=="raster-array"&&k.push(new s.V(h,c.source,`iconset cannot be used with a source of type ${String(q)}, it only be used with a "raster-array" source type`)):k.push(new s.V(h,c.source,`source "${c.source}" not found`))}return k}};function Ir(b,c=!1){const h=b.value,v=b.valueSpec,N=b.styleSpec;if(v.expression&&s.a2(s.M(h)))return Nt(b);if(v.expression&&s.S(s.U(h)))return zt(b);if(v.type&&_i[v.type]){const A=_i[v.type](b);return c===!0&&A.length>0&&s.K(b.value)==="array"?zt(b):A}return Vr(s.L({},b,{valueSpec:v.type?N[v.type]:v}))}function wi(b){const c=b.value,h=b.key,v=oa(b);return v.length||(c.indexOf("{fontstack}")===-1&&v.push(new s.V(h,c,'"glyphs" url must include a "{fontstack}" token')),c.indexOf("{range}")===-1&&v.push(new s.V(h,c,'"glyphs" url must include a "{range}" token'))),v}function gi(b,c=s.a5,h={}){return Ir({key:h.key||"",value:b,valueSpec:c.$root,styleSpec:c,style:b,objectElementValidators:{glyphs:wi,"*":()=>[]}})}function Ji(b,c=s.a5){return Xe(gi(b,c))}const la=b=>Xe(rl(b)),Ol=b=>Xe(xo(b)),Kc=b=>Xe(nl(b)),Ih=b=>Xe(Vs(b)),Hm=b=>Xe(Ua(b)),Oh=b=>Xe(function(c){const h=c.value,v=c.style,N=c.styleSpec,A=N.snow;let k=[];const z=s.K(h);if(h===void 0)return k;if(z!=="object")return k=k.concat([new s.V("snow",h,`object expected, ${z} found`)]),k;for(const q in h){const K=q.match(/^(.*)-transition$/);k=k.concat(K&&A[K[1]]&&A[K[1]].transition?Ir({key:q,value:h[q],valueSpec:N.transition,style:v,styleSpec:N}):A[q]?Ir({key:q,value:h[q],valueSpec:A[q],style:v,styleSpec:N}):[new s.J(q,h[q],`unknown property "${q}"`)])}return k}(b)),bt=b=>Xe(function(c){const h=c.value,v=c.style,N=c.styleSpec,A=N.rain;let k=[];const z=s.K(h);if(h===void 0)return k;if(z!=="object")return k=k.concat([new s.V("rain",h,`object expected, ${z} found`)]),k;for(const q in h){const K=q.match(/^(.*)-transition$/);k=k.concat(K&&A[K[1]]&&A[K[1]].transition?Ir({key:q,value:h[q],valueSpec:N.transition,style:v,styleSpec:N}):A[q]?Ir({key:q,value:h[q],valueSpec:A[q],style:v,styleSpec:N}):[new s.J(q,h[q],`unknown property "${q}"`)])}return k}(b)),pe=b=>Xe(Ui(b)),be=b=>Xe(hr(b)),De=b=>Xe(ai(b)),qe=b=>Xe(ri(b)),Ue=b=>Xe(s.a4(b));function Xe(b){return b.slice().sort((c,h)=>c.line&&h.line?c.line-h.line:0)}function ht(b,c){let h=!1;if(c&&c.length)for(const v of c)v instanceof s.J?s.w(v.message):(b.fire(new s.z(new Error(v.message))),h=!0);return h}let et;class xt extends s.E{constructor(c,h="flat"){super(),this._transitionable=new s.a6(et||(et=new s.a7({anchor:new s.a8(s.a5.light.anchor),position:new s.a9(s.a5.light.position),color:new s.a8(s.a5.light.color),intensity:new s.a8(s.a5.light.intensity)}))),this.setLight(c,h),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(c,h,v={}){this._validate(Ol,c,v)||(this._transitionable.setTransitionOrValue(c),this.id=h)}updateTransitions(c){this._transitioning=this._transitionable.transitioned(c,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(c){this.properties=this._transitioning.possiblyEvaluate(c)}_validate(c,h,v){return(!v||v.validate!==!1)&&ht(this,c.call(Ji,s.l({value:h,style:{glyphs:!0,sprite:!0},styleSpec:s.a5})))}}let wt=class extends s.E{constructor(b,c,h,v){super(),this.scope=h,this._transitionable=new s.a6(new s.a7({source:new s.a8(s.a5.terrain.source),exaggeration:new s.a8(s.a5.terrain.exaggeration)}),h,v),this._transitionable.setTransitionOrValue(b,v),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=c}get(){return this._transitionable.serialize()}set(b,c){this._transitionable.setTransitionOrValue(b,c)}updateTransitions(b){this._transitioning=this._transitionable.transitioned(b,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(b){this.properties=this._transitioning.possiblyEvaluate(b)}getExaggeration(b){return this._transitioning.possiblyEvaluate(new s.aa(b)).get("exaggeration")}getAttenuationRange(){if(!this.isZoomDependent())return null;const b=this._transitionable._values.exaggeration;if(!b)return null;const c=b.value.expression;if(!c)return null;let h=-1,v=-1,N=1;for(const A of c.zoomStops)N=c.evaluate(new s.aa(A)),N>.01?(h=A,v=-1):v=A;return N<.01&&h>0&&v>h?[h,v]:null}isZoomDependent(){const b=this._transitionable._values.exaggeration;return b!=null&&b.value!=null&&b.value.expression!=null&&b.value.expression instanceof s.ab}};const vt=45,$t=65,nr=.05;function or(b,c,h,v){const N=s.ae(vt,$t,h),[A,k]=Ur(b,v);let z=1-Math.min(1,Math.exp((c-A)/(k-A)*-6));return z*=z*z,z=Math.min(1,1.00747*z),z*N*b.alpha}function Ur(b,c){const h=.5/Math.tan(.5*c);return[b.range[0]+h,b.range[1]+h]}function Jr(b,c,h,v,N){const A=s.ad.vec3.transformMat4([],[c,h,v],N.mercatorFogMatrix);return or(b,s.ad.vec3.length(A),N.pitch,N._fov)}function Qr(b,c,h,v,N,A,k){const z=[[h,v,0],[N,v,0],[N,A,0],[h,A,0]];let q=Number.MAX_VALUE,K=-Number.MAX_VALUE;for(const Y of z){const ee=s.ad.vec3.transformMat4([],Y,c),Q=s.ad.vec3.length(ee);q=Math.min(q,Q),K=Math.max(K,Q)}return[or(b,q,k.pitch,k._fov),or(b,K,k.pitch,k._fov)]}class nn extends s.E{constructor(c,h,v,N){super();const A=new s.a7({range:new s.a8(s.a5.fog.range),color:new s.a8(s.a5.fog.color),"color-use-theme":new s.a8({type:"string","property-type":"data-constant",default:"default"}),"high-color":new s.a8(s.a5.fog["high-color"]),"high-color-use-theme":new s.a8({type:"string","property-type":"data-constant",default:"default"}),"space-color":new s.a8(s.a5.fog["space-color"]),"space-color-use-theme":new s.a8({type:"string","property-type":"data-constant",default:"default"}),"horizon-blend":new s.a8(s.a5.fog["horizon-blend"]),"star-intensity":new s.a8(s.a5.fog["star-intensity"]),"vertical-range":new s.a8(s.a5.fog["vertical-range"])});this._transitionable=new s.a6(A,v,new Map(N)),this.set(c,N),this._transitioning=this._transitionable.untransitioned(),this._transform=h,this.properties=new s.af(A),this.scope=v}get state(){const c=this._transform,h=c.projection.name==="globe",v=s.ag(c.zoom),N=this.properties.get("range"),A=[.5,3];return{range:h?[s.ah(A[0],N[0],v),s.ah(A[1],N[1],v)]:N,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(c,h,v={}){if(this._validate(Hm,c,v))return;const N=s.l({},c);for(const A of Object.keys(s.a5.fog))N[A]===void 0&&(N[A]=s.a5.fog[A].default);this._options=N,this._transitionable.setTransitionOrValue(this._options,h)}getOpacity(c){if(!this._transform.projection.supportsFog)return 0;const h=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:s.ae(vt,$t,c))*h.a}getOpacityAtLatLng(c,h){return this._transform.projection.supportsFog?function(v,N,A){const k=s.ac.fromLngLat(N),z=A.elevation?A.elevation.getAtPointOrZero(k):0;return Jr(v,k.x,k.y,z,A)}(this.state,c,h):0}getOpacityForTile(c){if(!this._transform.projection.supportsFog)return[1,1];const h=this._transform.calculateFogTileMatrix(c.toUnwrapped());return Qr(this.state,h,0,0,s.ai,s.ai,this._transform)}getOpacityForBounds(c,h,v,N,A){return this._transform.projection.supportsFog?Qr(this.state,c,h,v,N,A,this._transform):[1,1]}getFovAdjustedRange(c){return this._transform.projection.supportsFog?Ur(this.state,c):[0,1]}isVisibleOnFrustum(c){if(!this._transform.projection.supportsFog)return!1;const h=[4,5,6,7];for(const v of h){const N=c.points[v];let A;if(N[2]>=0)A=N;else{const k=c.points[v-4];A=s.aj(k,N,k[2]/(k[2]-N[2]))}if(Jr(this.state,A[0],A[1],0,this._transform)>=nr)return!0}return!1}updateConfig(c){this._transitionable.setTransitionOrValue(this._options,new Map(c))}updateTransitions(c){this._transitioning=this._transitionable.transitioned(c,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(c){this.properties=this._transitioning.possiblyEvaluate(c)}_validate(c,h,v){return(!v||v.validate!==!1)&&ht(this,c.call(Ji,s.l({value:h,style:{glyphs:!0,sprite:!0},styleSpec:s.a5})))}}let di,Ci,hn,Ln,Wn=class extends s.E{constructor(b,c,h,v){super();const N=di||(di=new s.a7({density:new s.a8(s.a5.snow.density),intensity:new s.a8(s.a5.snow.intensity),color:new s.a8(s.a5.snow.color),opacity:new s.a8(s.a5.snow.opacity),vignette:new s.a8(s.a5.snow.vignette),"vignette-color":new s.a8(s.a5.snow["vignette-color"]),"center-thinning":new s.a8(s.a5.snow["center-thinning"]),direction:new s.a8(s.a5.snow.direction),"flake-size":new s.a8(s.a5.snow["flake-size"])}));this._transitionable=new s.a6(N,h,new Map(v)),this.set(b,v),this._transitioning=this._transitionable.untransitioned(),this.properties=new s.af(N),this.scope=h}get state(){const b=this.properties.get("opacity"),c=this.properties.get("color"),h=this.properties.get("direction"),v=s.ak(h[0]),N=-Math.max(s.ak(h[1]),.01),A=[Math.cos(v)*Math.cos(N),Math.sin(v)*Math.cos(N),Math.sin(N)],k=this.properties.get("vignette"),z=this.properties.get("vignette-color");return z.a=k,{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new s.al(c.r,c.g,c.b,c.a*b),direction:A,centerThinning:this.properties.get("center-thinning"),flakeSize:this.properties.get("flake-size"),vignetteColor:z}}get(){return this._transitionable.serialize()}set(b,c,h={}){if(this._validate(Oh,b,h))return;const v=s.l({},b);for(const N of Object.keys(s.a5.snow))v[N]===void 0&&(v[N]=s.a5.snow[N].default);this._options=v,this._transitionable.setTransitionOrValue(this._options,c)}updateConfig(b){this._transitionable.setTransitionOrValue(this._options,new Map(b))}updateTransitions(b){this._transitioning=this._transitionable.transitioned(b,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(b){this.properties=this._transitioning.possiblyEvaluate(b)}_validate(b,c,h){return(!h||h.validate!==!1)&&ht(this,b.call(Ji,s.l({value:c,style:{glyphs:!0,sprite:!0},styleSpec:s.a5})))}},Kn=class extends s.E{constructor(b,c,h,v){super();const N=Ci||(Ci=new s.a7({density:new s.a8(s.a5.rain.density),intensity:new s.a8(s.a5.rain.intensity),color:new s.a8(s.a5.rain.color),opacity:new s.a8(s.a5.rain.opacity),vignette:new s.a8(s.a5.rain.vignette),"vignette-color":new s.a8(s.a5.rain["vignette-color"]),"center-thinning":new s.a8(s.a5.rain["center-thinning"]),direction:new s.a8(s.a5.rain.direction),"droplet-size":new s.a8(s.a5.rain["droplet-size"]),"distortion-strength":new s.a8(s.a5.rain["distortion-strength"])}));this._transitionable=new s.a6(N,h,new Map(v)),this.set(b,v),this._transitioning=this._transitionable.untransitioned(),this.properties=new s.af(N),this.scope=h}get state(){const b=this.properties.get("opacity"),c=this.properties.get("color"),h=this.properties.get("direction"),v=s.ak(h[0]),N=-Math.max(s.ak(h[1]),.01),A=[Math.cos(v)*Math.cos(N),Math.sin(v)*Math.cos(N),Math.sin(N)],k=this.properties.get("vignette-color");return k.a=this.properties.get("vignette"),{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new s.al(c.r,c.g,c.b,c.a*b),direction:A,centerThinning:this.properties.get("center-thinning"),dropletSize:this.properties.get("droplet-size"),distortionStrength:this.properties.get("distortion-strength"),vignetteColor:k}}get(){return this._transitionable.serialize()}set(b,c,h={}){if(this._validate(bt,b,h))return;const v=s.l({},b);for(const N of Object.keys(s.a5.rain))v[N]===void 0&&(v[N]=s.a5.rain[N].default);this._options=v,this._transitionable.setTransitionOrValue(this._options,c)}updateConfig(b){this._transitionable.setTransitionOrValue(this._options,new Map(b))}updateTransitions(b){this._transitioning=this._transitionable.transitioned(b,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(b){this.properties=this._transitioning.possiblyEvaluate(b)}_validate(b,c,h){return(!h||h.validate!==!1)&&ht(this,b.call(Ji,s.l({value:c,style:{glyphs:!0,sprite:!0},styleSpec:s.a5})))}};class Qi extends s.E{constructor(c,h,v,N){super(),this.scope=v,this._options=c,this.properties=new s.af(h),this._transitionable=new s.a6(h,v,new Map(N)),this._transitionable.setTransitionOrValue(c.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(c){this._transitionable.setTransitionOrValue(this._options.properties,new Map(c))}updateTransitions(c){this._transitioning=this._transitionable.transitioned(c,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(c){this.properties=this._transitioning.possiblyEvaluate(c)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(c,h){this._options=c,this._transitionable.setTransitionOrValue(c.properties,h)}shadowsEnabled(){return!!this.properties&&this.properties.get("cast-shadows")===!0}}class Us{constructor(c,h,v,N){this.screenBounds=c,this.cameraPoint=h,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=v,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,N)}static createFromScreenPoints(c,h){let v,N;if(c instanceof s.P||typeof c[0]=="number"){const A=s.P.convert(c);v=[A],N=h.isPointAboveHorizon(A)}else{const A=s.P.convert(c[0]),k=s.P.convert(c[1]);v=[A,k],N=s.an(A,k).every(z=>h.isPointAboveHorizon(z))}return new Us(v,h.getCameraPoint(),N,h)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(c){return s.an(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],c)}bufferedCameraGeometry(c){const h=this.screenBounds[0],v=this.screenBounds.length===1?this.screenBounds[0].add(new s.P(1,1)):this.screenBounds[1],N=s.an(h,v,0,!1);return this.cameraPoint.y>v.y&&(this.cameraPoint.x>h.x&&this.cameraPoint.x<v.x?N.splice(3,0,this.cameraPoint):this.cameraPoint.x>=v.x?N[2]=this.cameraPoint:this.cameraPoint.x<=h.x&&(N[3]=this.cameraPoint)),s.ao(N,c)}bufferedCameraGeometryGlobe(c){const h=this.screenBounds[0],v=this.screenBounds.length===1?this.screenBounds[0].add(new s.P(1,1)):this.screenBounds[1],N=s.an(h,v,c),A=this.cameraPoint.clone();switch(3*((A.y>h.y)+(A.y>v.y))+((A.x>h.x)+(A.x>v.x))){case 0:N[0]=A,N[4]=A.clone();break;case 1:N.splice(1,0,A);break;case 2:N[1]=A;break;case 3:N.splice(4,0,A);break;case 5:N.splice(2,0,A);break;case 6:N[3]=A;break;case 7:N.splice(3,0,A);break;case 8:N[2]=A}return N}containsTile(c,h,v,N=0){const A=c.queryPadding/h._pixelsPerMercatorPixel+1,k=v?this._bufferedCameraMercator(A,h):this._bufferedScreenMercator(A,h);let z=c.tileID.wrap+(k.unwrapped?N:0);const q=k.polygon.map(he=>s.ap(c.tileTransform,he,z));if(!s.aq(q,0,0,s.ai,s.ai))return;z=c.tileID.wrap+(this.screenGeometryMercator.unwrapped?N:0);const K=this.screenGeometryMercator.polygon.map(he=>s.ar(c.tileTransform,he,z)),Y=K.map(he=>new s.P(he[0],he[1])),ee=h.getFreeCameraOptions().position||new s.ac(0,0,0),Q=s.ar(c.tileTransform,ee,z),ie=K.map(he=>{const fe=s.ad.vec3.sub(he,he,Q);return s.ad.vec3.normalize(fe,fe),new s.as(Q,fe)}),de=s.at(c,1,h.zoom)*h._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:Y,tilespaceRays:ie,bufferedTilespaceGeometry:q,bufferedTilespaceBounds:(le=s.au(q),le.min.x=s.ay(le.min.x,0,s.ai),le.min.y=s.ay(le.min.y,0,s.ai),le.max.x=s.ay(le.max.x,0,s.ai),le.max.y=s.ay(le.max.y,0,s.ai),le),tile:c,tileID:c.tileID,pixelToTileUnitsFactor:de};var le}_bufferedScreenMercator(c,h){const v=Ca(c);if(this._screenRaycastCache[v])return this._screenRaycastCache[v];{let N;return N=h.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(c),h):{polygon:this.bufferedScreenGeometry(c).map(A=>h.pointCoordinate3D(A)),unwrapped:!0},this._screenRaycastCache[v]=N,N}}_bufferedCameraMercator(c,h){const v=Ca(c);if(this._cameraRaycastCache[v])return this._cameraRaycastCache[v];{let N;return N=h.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(c),h):{polygon:this.bufferedCameraGeometry(c).map(A=>h.pointCoordinate3D(A)),unwrapped:!0},this._cameraRaycastCache[v]=N,N}}_projectAndResample(c,h){const v=function(A,k){const z=s.ad.mat4.multiply([],k.pixelMatrix,k.globeMatrix),q=[0,-s.az,0,1],K=[0,s.az,0,1],Y=[0,0,0,1];s.ad.vec4.transformMat4(q,q,z),s.ad.vec4.transformMat4(K,K,z),s.ad.vec4.transformMat4(Y,Y,z);const ee=new s.P(q[0]/q[3],q[1]/q[3]),Q=new s.P(K[0]/K[3],K[1]/K[3]),ie=s.aw(A,ee)&&q[3]<Y[3],de=s.aw(A,Q)&&K[3]<Y[3];if(!ie&&!de)return null;const le=function(Fe,Be,He){for(let Ke=1;Ke<Fe.length;Ke++){const ft=Io(Be.pointCoordinate3D(Fe[Ke-1]).x),at=Io(Be.pointCoordinate3D(Fe[Ke]).x);if(He<0){if(ft<at)return{idx:Ke,t:-ft/(at-1-ft)}}else if(at<ft)return{idx:Ke,t:(1-ft)/(at+1-ft)}}return null}(A,k,ie?-1:1);if(!le)return null;const{idx:he,t:fe}=le;let Te=he>1?ya(A.slice(0,he),k):[],Re=he<A.length?ya(A.slice(he),k):[];Te=Te.map(Fe=>new s.P(Io(Fe.x),Fe.y)),Re=Re.map(Fe=>new s.P(Io(Fe.x),Fe.y));const Oe=[...Te];Oe.length===0&&Oe.push(Re[Re.length-1]);const $e=s.ah(Oe[Oe.length-1].y,(Re.length===0?Te[0]:Re[0]).y,fe);let Le;return Le=ie?[new s.P(0,$e),new s.P(0,0),new s.P(1,0),new s.P(1,$e)]:[new s.P(1,$e),new s.P(1,1),new s.P(0,1),new s.P(0,$e)],Oe.push(...Le),Re.length===0?Oe.push(Te[0]):Oe.push(...Re),{polygon:Oe.map(Fe=>new s.ac(Fe.x,Fe.y)),unwrapped:!1}}(c,h);if(v)return v;const N=function(A,k){let z=!1,q=-1/0,K=0;for(let ee=0;ee<A.length-1;ee++)A[ee].x>q&&(q=A[ee].x,K=ee);for(let ee=0;ee<A.length-1;ee++){const Q=(K+ee)%(A.length-1),ie=A[Q],de=A[Q+1];Math.abs(ie.x-de.x)>.5&&(ie.x<de.x?(ie.x+=1,Q===0&&(A[A.length-1].x+=1)):(de.x+=1,Q+1===A.length-1&&(A[0].x+=1)),z=!0)}const Y=s.av(k.center.lng);return z&&Y<Math.abs(Y-1)&&A.forEach(ee=>{ee.x-=1}),{polygon:A,unwrapped:z}}(ya(c,h).map(A=>new s.P(Io(A.x),A.y)),h);return{polygon:N.polygon.map(A=>new s.ac(A.x,A.y)),unwrapped:N.unwrapped}}}function ya(b,c){return s.ax(b,h=>{const v=c.pointCoordinate3D(h);h.x=v.x,h.y=v.y},1/256)}function Io(b){return b<0?1+b%1:b%1}function Ca(b){return 100*b|0}function Ps(b,c,h,v,N){const A=function(z,q){if(z)return N(z);if(q){if(b.url&&q.tiles&&b.tiles&&delete b.tiles,q.variants){if(!Array.isArray(q.variants))return N(new Error("variants must be an array"));for(const Y of q.variants){if(Y==null||typeof Y!="object"||Y.constructor!==Object)return N(new Error("variant must be an object"));if(!Array.isArray(Y.capabilities))return N(new Error("capabilities must be an array"));if(Y.capabilities.length===1&&Y.capabilities[0]==="meshopt"){q=s.l(q,Y);break}}}const K=s.aA(s.l({},q,b),["tilejson","tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding","vector_layers","raster_layers","worldview_options","worldview_default","worldview"]);K.tiles=c.canonicalizeTileset(K,b.url),N(null,K)}},k=function(z,q,K){if(!z)return null;if(!q&&!K)return z;K=K||z.worldview_default;const Y=Object.values(z.language||{});if(Y.length===0)return null;const ee=Object.values(z.worldview||{});if(ee.length===0)return null;const Q=Y.every(de=>de===q),ie=ee.every(de=>de===K);return Q&&ie?z:q in(z.language_options||{})||K in(z.worldview_options||{})?null:z.language_options&&z.worldview_options?z:null}(b.data,h,v);return k?s.q.frame(()=>A(null,k)):b.url?s.n(c.transformRequest(c.normalizeSourceURL(b.url,null,h,v),s.R.Source),A):s.q.frame(()=>{const{data:z,...q}=b;A(null,q)})}class Js{constructor(c,h,v){this.bounds=s.aB.convert(this.validateBounds(c)),this.minzoom=h||0,this.maxzoom=v||24}validateBounds(c){return Array.isArray(c)&&c.length===4?[Math.max(-180,c[0]),Math.max(-90,c[1]),Math.min(180,c[2]),Math.min(90,c[3])]:[-180,-90,180,90]}contains(c){const h=Math.pow(2,c.z),v=Math.floor(s.av(this.bounds.getWest())*h),N=Math.floor(s.aC(this.bounds.getNorth())*h),A=Math.ceil(s.av(this.bounds.getEast())*h),k=Math.ceil(s.aC(this.bounds.getSouth())*h);return c.x>=v&&c.x<A&&c.y>=N&&c.y<k}}class Pd extends s.E{constructor(c,h,v,N){if(super(),this.id=c,this.dispatcher=v,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,s.l(this,s.aA(h,["url","scheme","tileSize","promoteId"])),this._options=s.l({type:"vector"},h),this._collectResourceTiming=!!h.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(N),this._tileWorkers={},this._deduped=new s.aD}load(c){this._loaded=!1,this.fire(new s.A("dataloading",{dataType:"source"}));const h=Array.isArray(this.map._language)?this.map._language.join():this.map._language,v=this.map.getWorldview();this._tileJSONRequest=Ps(this._options,this.map._requestManager,h,v,(N,A)=>{if(this._tileJSONRequest=null,this._loaded=!0,N)h&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${h}`),v&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${v}`),this.fire(new s.z(N));else if(A){if(s.l(this,A),this.hasWorldviews=!!A.worldview_options,A.worldview_default&&(this.worldviewDefault=A.worldview_default),A.vector_layers){this.vectorLayers=A.vector_layers,this.vectorLayerIds=[],this.localizableLayerIds=new Set;for(const k of A.vector_layers)this.vectorLayerIds.push(k.id),A.worldview&&A.worldview[k.source]&&this.localizableLayerIds.add(k.id)}A.bounds&&(this.tileBounds=new Js(A.bounds,this.minzoom,this.maxzoom)),mt(A.tiles,this.map._requestManager._customAccessToken),this.fire(new s.A("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.A("data",{dataType:"source",sourceDataType:"content"}))}c&&c(N)})}loaded(){return this._loaded}hasTile(c){return!this.tileBounds||this.tileBounds.contains(c.canonical)}onAdd(c){this.map=c,this.load()}reload(){this.cancelTileJSONRequest();const c=s.C(this.id,this.scope);this.load(()=>this.map.style.clearSource(c))}setTiles(c){return this._options.tiles=c,this.reload(),this}setUrl(c){return this.url=c,this._options.url=c,this.reload(),this}onRemove(c){this.cancelTileJSONRequest()}serialize(){return s.l({},this._options)}loadTile(c,h){const v=c.tileID.canonical.url(this.tiles,this.scheme),N=this.map._requestManager.normalizeTileURL(v),A=this.map._requestManager.transformRequest(N,s.R.Tile),k=this.map.style?this.map.style.getLut(this.scope):null,z=k?{image:k.image.clone()}:null,q={request:A,data:void 0,uid:c.uid,tileID:c.tileID,tileZoom:c.tileZoom,zoom:c.tileID.overscaledZ,maxZoom:this.maxzoom,lut:z,tileSize:this.tileSize*c.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:s.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:c.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:c.isExtraShadowCaster,tessellationStep:this.map._tessellationStep,scaleFactor:this.map.getScaleFactor()};if(this.hasWorldviews&&s.f(v)&&(q.worldview=this.map.getWorldview()||this.worldviewDefault,q.localizableLayerIds=this.localizableLayerIds),q.request.collectResourceTiming=this._collectResourceTiming,c.actor&&c.state!=="expired")c.state==="loading"?c.reloadCallback=h:c.request=c.actor.send("reloadTile",q,K.bind(this));else if(c.actor=this._tileWorkers[N]=this._tileWorkers[N]||this.dispatcher.getActor(),this.dispatcher.ready)c.request=c.actor.send("loadTile",q,K.bind(this),void 0,!0);else{const Y=s.aE.call({deduped:this._deduped},q,(ee,Q)=>{ee||!Q?K.call(this,ee):(q.data={cacheControl:Q.cacheControl,expires:Q.expires,rawData:Q.rawData.slice(0)},c.actor&&c.actor.send("loadTile",q,K.bind(this),void 0,!0))},!0);c.request={cancel:Y}}function K(Y,ee){return delete c.request,c.aborted?h(null):Y&&Y.status!==404?h(Y):(ee&&ee.resourceTiming&&(c.resourceTiming=ee.resourceTiming),this.map._refreshExpiredTiles&&ee&&c.setExpiryData(ee),c.loadVectorData(ee,this.map.painter),s.aF(this.dispatcher),h(null),void(c.reloadCallback&&(this.loadTile(c,c.reloadCallback),c.reloadCallback=null)))}}abortTile(c){c.request&&(c.request.cancel(),delete c.request),c.actor&&c.actor.send("abortTile",{uid:c.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(c,h){c.actor&&c.actor.send("removeTile",{uid:c.uid,type:this.type,source:this.id,scope:this.scope}),c.destroy()}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Oo extends s.E{constructor(c,h,v,N){super(),this.id=c,this.dispatcher=v,this.setEventedParent(N),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=s.l({type:"raster"},h),s.l(this,s.aA(h,["url","scheme","tileSize"]))}load(c){this._loaded=!1,this.fire(new s.A("dataloading",{dataType:"source"})),this._tileJSONRequest=Ps(this._options,this.map._requestManager,null,null,(h,v)=>{this._tileJSONRequest=null,this._loaded=!0,h?this.fire(new s.z(h)):v&&(s.l(this,v),v.raster_layers&&(this.rasterLayers=v.raster_layers,this.rasterLayerIds=this.rasterLayers.map(N=>N.id)),v.bounds&&(this.tileBounds=new Js(v.bounds,this.minzoom,this.maxzoom)),mt(v.tiles),this.fire(new s.A("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.A("data",{dataType:"source",sourceDataType:"content"}))),c&&c(h)})}loaded(){return this._loaded}onAdd(c){this.map=c,this.load()}reload(){this.cancelTileJSONRequest();const c=s.C(this.id,this.scope);this.load(()=>this.map.style.clearSource(c))}setTiles(c){return this._options.tiles=c,this.reload(),this}setUrl(c){return this.url=c,this._options.url=c,this.reload(),this}onRemove(c){this.cancelTileJSONRequest()}serialize(){return s.l({},this._options)}hasTile(c){return!this.tileBounds||this.tileBounds.contains(c.canonical)}loadTile(c,h){const v=s.q.devicePixelRatio>=2,N=this.map._requestManager.normalizeTileURL(c.tileID.canonical.url(this.tiles,this.scheme),v,this.tileSize);c.request=s.o(this.map._requestManager.transformRequest(N,s.R.Tile),(A,k,z,q)=>(delete c.request,c.aborted?(c.state="unloaded",h(null)):A?(c.state="errored",h(A)):k?(this.map._refreshExpiredTiles&&c.setExpiryData({cacheControl:z,expires:q}),c.setTexture(k,this.map.painter),c.state="loaded",s.aF(this.dispatcher),void h(null)):h(null)))}abortTile(c,h){c.request&&(c.request.cancel(),delete c.request),h&&h()}unloadTile(c,h){c.texture&&c.texture instanceof s.T?(c.destroy(!0),c.texture&&c.texture instanceof s.T&&this.map.painter.saveTileTexture(c.texture)):c.destroy(),h&&h()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Rl extends Oo{constructor(c,h,v,N){super(c,h,v,N),this.type="raster-array",this.maxzoom=22,this.partial=!0,this._options=s.l({type:"raster-array"},h)}triggerRepaint(c){const h=this.map.painter._terrain,v=this.map.style.getSourceCache(this.id);h&&h.enabled&&v&&h._clearRenderCacheForTile(v.id,c.tileID),this.map.triggerRepaint()}loadTile(c,h){const v=this.map._requestManager.normalizeTileURL(c.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),N=this.map._requestManager.transformRequest(v,s.R.Tile),A={request:N,uid:c.uid,tileID:c.tileID,type:this.type,source:this.id,scope:this.scope,partial:this.partial};c.source=this.id,c.scope=this.scope,c.requestParams=N,c.actor||(c.actor=this.dispatcher.getActor());const k=(z,q,K,Y)=>{if(delete c.request,c.aborted)return c.state="unloaded",h(null);if(z)return z.name==="AbortError"?void 0:(c.state="errored",h(z));if(this.map._refreshExpiredTiles&&q&&c.setExpiryData({cacheControl:K,expires:Y}),this.partial)c.state="empty";else{if(!q)return h(null);c.state="loaded",c._isHeaderLoaded=!0,c._mrt=q}h(null)};c.request=this.partial?c.fetchHeader(void 0,k.bind(this)):c.actor.send("loadTile",A,k.bind(this),void 0,!0)}abortTile(c){c.request&&(c.request.cancel(),delete c.request),c.actor&&c.actor.send("abortTile",{uid:c.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(c,h){const v=c.texture;v&&v instanceof s.T?(c.destroy(!0),this.map.painter.saveTileTexture(v)):(c.destroy(),c.flushQueues(),c._isHeaderLoaded=!1,delete c._mrt,delete c.textureDescriptor),c.fbo&&(c.fbo.destroy(),delete c.fbo),delete c.request,delete c.requestParams,delete c.neighboringTiles,c.state="unloaded"}prepareTile(c,h,v){c._isHeaderLoaded&&(c.state!=="empty"&&(c.state="reloading"),c.fetchBand(h,v,(N,A)=>{if(N)return c.state="errored",this.fire(new s.z(N)),void this.triggerRepaint(c);A&&(c._isHeaderLoaded=!0,c.setTexture(A,this.map.painter),c.state="loaded",this.triggerRepaint(c))}))}getInitialBand(c){if(!this.rasterLayers)return 0;const h=this.rasterLayers.find(({id:A})=>A===c),v=h&&h.fields,N=v&&v.bands&&v.bands;return N?N[0]:0}getTextureDescriptor(c,h,v){if(!c)return;const N=h.sourceLayer||this.rasterLayerIds&&this.rasterLayerIds[0];if(!N)return;let A=null;h instanceof s.aI?A=h.paint.get("raster-array-band"):h instanceof s.aJ&&(A=h.paint.get("raster-particle-array-band"));const k=A||this.getInitialBand(N);if(k!=null)if(c.textureDescriptor){if(!c.updateNeeded(N,k)||v)return Object.assign({},c.textureDescriptor,{texture:c.texture})}else this.prepareTile(c,N,k)}getImages(c,h){const v=new Map;for(const N of c)for(const A of h){const[k,z]=A.split("/"),q=N.getLayer(k);if(!q||!q.hasBand(z)||!q.hasDataForBand(z))continue;const{bytes:K,tileSize:Y,buffer:ee}=q.getBandView(z),Q=Y+2*ee,ie={data:new s.r({width:Q,height:Q},K),pixelRatio:2,sdf:!1,usvg:!1,version:0};v.set(A,ie)}return v}}const xg={vector:Pd,raster:Oo,"raster-dem":class extends Oo{constructor(b,c,h,v){super(b,c,h,v),this.type="raster-dem",this.maxzoom=22,this._options=s.l({type:"raster-dem"},c),this.encoding=c.encoding||"mapbox"}loadTile(b,c){const h=this.map._requestManager.normalizeTileURL(b.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function v(N,A){N&&(b.state="errored",c(N)),A&&(b.dem=A,b.dem.onDeserialize(),b.needsHillshadePrepare=!0,b.needsDEMTextureUpload=!0,b.state="loaded",c(null))}b.request=s.o(this.map._requestManager.transformRequest(h,s.R.Tile),(function(N,A,k,z){if(delete b.request,b.aborted)b.state="unloaded",c(null);else if(N)b.state="errored",c(N);else if(A){this.map._refreshExpiredTiles&&b.setExpiryData({cacheControl:k,expires:z});const q=ImageBitmap&&A instanceof ImageBitmap&&s.t(),K=1-(A.width-s.aG(A.width))/2;K<1||b.neighboringTiles||(b.neighboringTiles=this._getNeighboringTiles(b.tileID));const Y=q?A:s.q.getImageData(A,K),ee={uid:b.uid,tileID:b.tileID,source:this.id,type:this.type,scope:this.scope,rawImageData:Y,encoding:this.encoding,padding:K};b.actor&&b.state!=="expired"||(b.actor=this.dispatcher.getActor(),b.actor.send("loadTile",ee,v.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(b){const c=b.canonical,h=Math.pow(2,c.z),v=(c.x-1+h)%h,N=c.x===0?b.wrap-1:b.wrap,A=(c.x+1+h)%h,k=c.x+1===h?b.wrap+1:b.wrap,z={};return z[new s.aH(b.overscaledZ,N,c.z,v,c.y).key]={backfilled:!1},z[new s.aH(b.overscaledZ,k,c.z,A,c.y).key]={backfilled:!1},c.y>0&&(z[new s.aH(b.overscaledZ,N,c.z,v,c.y-1).key]={backfilled:!1},z[new s.aH(b.overscaledZ,b.wrap,c.z,c.x,c.y-1).key]={backfilled:!1},z[new s.aH(b.overscaledZ,k,c.z,A,c.y-1).key]={backfilled:!1}),c.y+1<h&&(z[new s.aH(b.overscaledZ,N,c.z,v,c.y+1).key]={backfilled:!1},z[new s.aH(b.overscaledZ,b.wrap,c.z,c.x,c.y+1).key]={backfilled:!1},z[new s.aH(b.overscaledZ,k,c.z,A,c.y+1).key]={backfilled:!1}),z}},"raster-array":Rl,geojson:class extends s.E{constructor(b,c,h,v){super(),this.id=b,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=h.getActor(),this.setEventedParent(v),this._data=c.data,this._options=s.l({},c),this._collectResourceTiming=c.collectResourceTiming,c.maxzoom!==void 0&&(this.maxzoom=c.maxzoom),c.minzoom!==void 0&&(this.minzoom=c.minzoom),c.type&&(this.type=c.type),c.attribution&&(this.attribution=c.attribution),this.promoteId=c.promoteId;const N=s.ai/this.tileSize;this.workerOptions=s.l({source:this.id,scope:this.scope,cluster:c.cluster||!1,geojsonVtOptions:{buffer:(c.buffer!==void 0?c.buffer:128)*N,tolerance:(c.tolerance!==void 0?c.tolerance:.375)*N,extent:s.ai,maxZoom:this.maxzoom,lineMetrics:c.lineMetrics||!1,generateId:c.generateId||!1},superclusterOptions:{maxZoom:c.clusterMaxZoom!==void 0?c.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,c.clusterMinPoints||2),extent:s.ai,radius:(c.clusterRadius!==void 0?c.clusterRadius:50)*N,log:!1,generateId:c.generateId||!1},clusterProperties:c.clusterProperties,filter:c.filter,dynamic:c.dynamic},c.workerOptions)}onAdd(b){this.map=b,this.setData(this._data)}setData(b){return this._data=b,this._updateWorkerData(),this}updateData(b){if(!this._options.dynamic)return this.fire(new s.z(new Error("Can't call updateData on a GeoJSON source with dynamic set to false.")));if(typeof b!="string"&&(b.type==="Feature"&&(b={type:"FeatureCollection",features:[b]}),b.type!=="FeatureCollection"))return this.fire(new s.z(new Error("Data to update should be a feature or a feature collection.")));if(this._coalesce&&typeof b!="string"&&typeof this._data!="string"&&this._data.type==="FeatureCollection"){const c=new Map;for(const h of this._data.features)c.set(h.id,h);for(const h of b.features)c.set(h.id,h);this._data.features=[...c.values()]}else this._data=b;return this._updateWorkerData(!0),this}getClusterExpansionZoom(b,c){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:b,source:this.id,scope:this.scope},c),this}getClusterChildren(b,c){return this.actor.send("geojson.getClusterChildren",{clusterId:b,source:this.id,scope:this.scope},c),this}getClusterLeaves(b,c,h,v){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:b,limit:c,offset:h},v),this}_updateWorkerData(b=!1){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new s.A("dataloading",{dataType:"source"})),this._loaded=!1;const c=s.l({append:b},this.workerOptions);c.scope=this.scope;const h=this._data;typeof h=="string"?(c.request=this.map._requestManager.transformRequest(s.q.resolveURL(h),s.R.Source),c.request.collectResourceTiming=this._collectResourceTiming):c.data=JSON.stringify(h),this._pendingLoad=this.actor.send(`${this.type}.loadData`,c,(v,N)=>{if(this._loaded=!0,this._pendingLoad=null,v)this.fire(new s.z(v));else{const A={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&N&&N.resourceTiming&&N.resourceTiming[this.id]&&(A.resourceTiming=N.resourceTiming[this.id]),b&&(this._partialReload=!0),this.fire(new s.A("data",A)),this._partialReload=!1,this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(b),this._coalesce=!1)})}loaded(){return this._loaded}reload(){const b=s.C(this.id,this.scope);this.map.style.clearSource(b),this._updateWorkerData()}loadTile(b,c){const h=b.actor?"reloadTile":"loadTile";b.actor=this.actor;const v=this.map.style?this.map.style.getLut(this.scope):null,N=v?{image:v.image.clone()}:null,A=this._partialReload,k={type:this.type,uid:b.uid,tileID:b.tileID,tileZoom:b.tileZoom,zoom:b.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,lut:N,scope:this.scope,pixelRatio:s.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0,scaleFactor:this.map.getScaleFactor(),partial:A};b.request=this.actor.send(h,k,(z,q)=>A&&!q?(b.state="loaded",c(null)):(delete b.request,b.destroy(),b.aborted?c(null):z?c(z):(b.loadVectorData(q,this.map.painter,h==="reloadTile"),c(null))),void 0,h==="loadTile")}abortTile(b){b.request&&(b.request.cancel(),delete b.request),b.aborted=!0}unloadTile(b,c){this.actor.send("removeTile",{uid:b.uid,type:this.type,source:this.id,scope:this.scope}),b.destroy()}onRemove(b){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return s.l({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends s.aK{constructor(b,c,h,v){super(b,c,h,v),this.roundZoom=!0,this.type="video",this.options=c}load(){this._loaded=!1;const b=this.options;this.urls=[];for(const c of b.urls)this.urls.push(this.map._requestManager.transformRequest(c,s.R.Source).url);s.aL(this.urls,(c,h)=>{this._loaded=!0,c?this.fire(new s.z(c)):h&&(this.video=h,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(b){if(this.video){const c=this.video.seekable;b<c.start(0)||b>c.end(0)?this.fire(new s.z(new s.V(`sources.${this.id}`,null,`Playback for this video can be set only between the ${c.start(0)} and ${c.end(0)}-second mark.`))):this.video.currentTime=b}}getVideo(){return this.video}onAdd(b){this.map||(this.map=b,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const b=this.map.painter.context,c=b.gl;this.texture?this.video.paused||(this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE),c.texSubImage2D(c.TEXTURE_2D,0,0,0,c.RGBA,c.UNSIGNED_BYTE,this.video)):(this.texture=new s.T(b,this.video,c.RGBA8),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(b)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:s.aK,model:class extends s.E{constructor(b,c,h,v){super(),this.id=b,this.type="model",this.models=[],this._loaded=!1,this._options=c}load(){const b=[];for(const c in this._options.models){const h=this._options.models[c],v=s.aN(this.map._requestManager.transformRequest(h.uri,s.R.Model).url).then(N=>{if(!N)return;const A=s.aO(N),k=new s.aP(c,h.position,h.orientation,A);k.computeBoundsAndApplyParent(),this.models.push(k)}).catch(N=>{this.fire(new s.z(new Error(`Could not load model ${c} from ${h.uri}: ${N.message}`)))});b.push(v)}return Promise.allSettled(b).then(()=>{this._loaded=!0,this.fire(new s.A("data",{dataType:"source",sourceDataType:"metadata"}))}).catch(c=>{this.fire(new s.z(new Error(`Could not load models: ${c.message}`)))})}onAdd(b){this.map=b,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(b,c){}serialize(){return{type:"model"}}},"batched-model":class extends s.E{constructor(b,c,h,v){super(),this.type="batched-model",this.id=b,this.tileSize=512,this._options=c,this.tiles=this._options.tiles,this.maxzoom=c.maxzoom||19,this.minzoom=c.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=h,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(v)}onAdd(b){this.map=b,this.load()}reload(){this.cancelTileJSONRequest();const b=s.C(this.id,this.scope);this.load(()=>this.map.style.clearSource(b))}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}load(b){this._loaded=!1,this.fire(new s.A("dataloading",{dataType:"source"}));const c=Array.isArray(this.map._language)?this.map._language.join():this.map._language,h=this.map.getWorldview();this._tileJSONRequest=Ps(this._options,this.map._requestManager,c,h,(v,N)=>{this._tileJSONRequest=null,this._loaded=!0,v?(c&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${c}`),h&&h.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${h}`),this.fire(new s.z(v))):N&&(s.l(this,N),N.bounds&&(this.tileBounds=new Js(N.bounds,this.minzoom,this.maxzoom)),mt(N.tiles,this.map._requestManager._customAccessToken),this.fire(new s.A("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.A("data",{dataType:"source",sourceDataType:"content"}))),b&&b(v)})}hasTransition(){return!1}hasTile(b){return!this.tileBounds||this.tileBounds.contains(b.canonical)}loaded(){return this._loaded}loadTile(b,c){const h=this.map._requestManager.normalizeTileURL(b.tileID.canonical.url(this.tiles,this.scheme)),v={request:this.map._requestManager.transformRequest(h,s.R.Tile),data:void 0,uid:b.uid,tileID:b.tileID,tileZoom:b.tileZoom,zoom:b.tileID.overscaledZ,tileSize:this.tileSize*b.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:b.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,pixelRatio:s.q.devicePixelRatio,promoteId:this.promoteId};if(b.actor&&b.state!=="expired")if(b.state==="loading")b.reloadCallback=c;else{if(b.buckets){const A=Object.values(b.buckets);for(const k of A)k.dirty=!0;return void(b.state="loaded")}b.request=b.actor.send("reloadTile",v,N.bind(this))}else b.actor=this.dispatcher.getActor(),b.request=b.actor.send("loadTile",v,N.bind(this),void 0,!0);function N(A,k){return b.aborted?c(null):A&&A.status!==404?c(A):(this.map._refreshExpiredTiles&&k&&b.setExpiryData(k),b.loadModelData(k,this.map.painter),b.state="loaded",void c(null))}}serialize(){return s.l({},this._options)}},canvas:class extends s.aK{constructor(b,c,h,v){super(b,c,h,v),c.coordinates?Array.isArray(c.coordinates)&&c.coordinates.length===4&&!c.coordinates.some(N=>!Array.isArray(N)||N.length!==2||N.some(A=>typeof A!="number"))||this.fire(new s.z(new s.V(`sources.${b}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new s.z(new s.V(`sources.${b}`,null,'missing required property "coordinates"'))),c.animate&&typeof c.animate!="boolean"&&this.fire(new s.z(new s.V(`sources.${b}`,null,'optional "animate" property must be a boolean value'))),c.canvas?typeof c.canvas=="string"||c.canvas instanceof HTMLCanvasElement||this.fire(new s.z(new s.V(`sources.${b}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new s.z(new s.V(`sources.${b}`,null,'missing required property "canvas"'))),this.options=c,this.animate=c.animate===void 0||c.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new s.z(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(b){this.map=b,this.load(),this.canvas&&this.animate&&this.play()}onRemove(b){this.pause()}prepare(){let b=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,b=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,b=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const c=this.map.painter.context;this.texture?!b&&!this._playing||this.texture instanceof s.aM||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new s.T(c,this.canvas,c.gl.RGBA8,{premultiply:!0}),this._prepareData(c)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const b of[this.canvas.width,this.canvas.height])if(isNaN(b)||b<=0)return!0;return!1}},custom:class extends s.E{constructor(b,c,h,v){super(),this.id=b,this.type="custom",this._dataType="raster",this._dispatcher=h,this._implementation=c,this.setEventedParent(v),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new s.z(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new s.z(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Js(this._implementation.bounds,this.minzoom,this.maxzoom)),c.update=this._update.bind(this),c.clearTiles=this._clearTiles.bind(this),c.coveringTiles=this._coveringTiles.bind(this),s.l(this,s.aA(c,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return s.aA(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new s.A("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.A("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(b){this.map=b,this._loaded=!1,this.fire(new s.A("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(b),this.load()}onRemove(b){this._implementation.onRemove&&this._implementation.onRemove(b)}hasTile(b){if(this._implementation.hasTile){const{x:c,y:h,z:v}=b.canonical;return this._implementation.hasTile({x:c,y:h,z:v})}return!this.tileBounds||this.tileBounds.contains(b.canonical)}loadTile(b,c){const{x:h,y:v,z:N}=b.tileID.canonical,A=new AbortController;b.request=Promise.resolve(this._implementation.loadTile({x:h,y:v,z:N},{signal:A.signal})).then((function(k){return delete b.request,b.aborted?(b.state="unloaded",c(null)):k===void 0?(b.state="errored",c(null)):k===null?(this.loadTileData(b,{width:this.tileSize,height:this.tileSize,data:null}),b.state="loaded",c(null)):function(z){return z instanceof ImageData||z instanceof HTMLCanvasElement||z instanceof ImageBitmap||z instanceof HTMLImageElement}(k)?(this.loadTileData(b,k),b.state="loaded",void c(null)):(b.state="errored",c(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(k=>{k.name!=="AbortError"&&(b.state="errored",c(k))}),b.request.cancel=()=>A.abort()}loadTileData(b,c){b.setTexture(c,this.map.painter)}unloadTile(b,c){if(b.texture&&b.texture instanceof s.T?(b.destroy(!0),b.texture&&b.texture instanceof s.T&&this.map.painter.saveTileTexture(b.texture)):b.destroy(),this._implementation.unloadTile){const{x:h,y:v,z:N}=b.tileID.canonical;this._implementation.unloadTile({x:h,y:v,z:N})}c&&c()}abortTile(b,c){b.request&&b.request.cancel&&(b.request.cancel(),delete b.request),c&&c()}hasTransition(){return!1}_coveringTiles(){return this.map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(b=>({x:b.canonical.x,y:b.canonical.y,z:b.canonical.z}))}_clearTiles(){const b=s.C(this.id,this.scope);this.map.style.clearSource(b)}_update(){this.fire(new s.A("data",{dataType:"source",sourceDataType:"content"}))}}},qm=function(b,c,h,v){const N=new xg[c.type](b,c,h,v);if(N.id!==b)throw new Error(`Expected Source id to be ${b} instead of ${N.id}`);return s.aQ(["load","abort","unload","serialize","prepare"],N),N};function Rh(b,c,h=""){return`${h}:${c.id||""}:${c.layer.id}:${function(v){if("layerId"in v)return`layer:${v.layerId}`;{const{featuresetId:N,importId:A}=v;return`featureset:${N}${A?`:import:${A}`:""}`}}(b.target)}`}function Ed(b,c,h,v=""){if(b.uniqueFeatureID){const N=Rh(b,c,v);if(h.has(N))return!0;h.add(N)}return!1}function Md(b,c,h,v,N=!1){const A=c.sourceCache.transform,k=c.sourceCache.tilesIn(b,c.has3DLayers,N);k.sort(yg);const z=[];for(const q of k){const K=q.tile.queryRenderedFeatures(c,q,h,v,A,N);Object.keys(K).length&&z.push({wrappedTileID:q.tile.tileID.wrapped().key,queryResults:K})}return z.length===0?{}:function(q){const K={},Y={};for(const ee of q){const Q=ee.queryResults,ie=ee.wrappedTileID,de=Y[ie]=Y[ie]||{};for(const le in Q){const he=Q[le],fe=de[le]=de[le]||{},Te=K[le]=K[le]||[];for(const Re of he)fe[Re.featureIndex]||(fe[Re.featureIndex]=!0,Te.push(Re))}}return K}(z)}function Px(b,c,h,v,N){const A={},k=v.queryRenderedSymbols(b),z=[];for(const q of Object.keys(k).map(Number))z.push(N[q]);z.sort(yg);for(const q of z){const K=q.featureIndex.lookupSymbolFeatures(k[q.bucketInstanceId],q.bucketIndex,q.sourceLayerIndex,c,h);for(const Y in K){const ee=A[Y]=A[Y]||[],Q=K[Y];Q.sort((ie,de)=>{const le=q.featureSortOrder;if(le){const he=le.indexOf(ie.featureIndex);return le.indexOf(de.featureIndex)-he}return de.featureIndex-ie.featureIndex});for(const ie of Q)ee.push(ie)}}return A}function Ex(b,c){const h=b.getRenderableIds().map(A=>b.getTileByID(A)),v=[],N={};for(let A=0;A<h.length;A++){const k=h[A],z=k.tileID.canonical.key;N[z]||(N[z]=!0,k.querySourceFeatures(v,c))}return v}function yg(b,c){const h=b.tileID,v=c.tileID;return h.overscaledZ-v.overscaledZ||h.canonical.y-v.canonical.y||h.wrap-v.wrap||h.canonical.x-v.canonical.x}function Zc(b,c){const h={};if(!c)return h;for(const v of b){const N=v.layerIds.map(A=>c.getLayer(A)).filter(Boolean);if(N.length!==0){v.layers=N,v.stateDependentLayerIds&&(v.stateDependentLayers=v.stateDependentLayerIds.map(A=>N.filter(k=>k.id===A)[0]));for(const A of N)h[A.fqid]=v}}return h}const yo=32,il=33,oc=new Uint16Array(8184);for(let b=0;b<2046;b++){let c=b+2,h=0,v=0,N=0,A=0,k=0,z=0;for(1&c?N=A=k=yo:h=v=z=yo;(c>>=1)>1;){const K=h+N>>1,Y=v+A>>1;1&c?(N=h,A=v,h=k,v=z):(h=N,v=A,N=k,A=z),k=K,z=Y}const q=4*b;oc[q+0]=h,oc[q+1]=v,oc[q+2]=N,oc[q+3]=A}const sl=new Uint16Array(2178),Ro=new Uint8Array(1089),Wm=new Uint16Array(1089);function q_(b){return b===0?-.03125:b===32?.03125:0}const Mx={type:2,extent:s.ai,loadGeometry:()=>[[new s.P(0,0),new s.P(s.ai+1,0),new s.P(s.ai+1,s.ai+1),new s.P(0,s.ai+1),new s.P(0,0)]]};class lc{constructor(c,h,v,N,A){this.tileID=c,this.uid=s.aW(),this.uses=0,this.tileSize=h,this.tileZoom=v,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=A,N&&N.style&&(this._lastUpdatedBrightness=N.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",N&&N.transform&&(this.projection=N.transform.projection)}registerFadeDuration(c){const h=c+this.timeAdded;h<s.q.now()||this.fadeEndTime&&h<this.fadeEndTime||(this.fadeEndTime=h)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=s.aR(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(c,h,v){if(this.unloadVectorData(),this.state="loaded",c){c.featureIndex&&(this.latestFeatureIndex=c.featureIndex,c.rawTileData?(this.latestRawTileData=c.rawTileData,this.latestFeatureIndex.rawTileData=c.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=c.collisionBoxArray,this.buckets=Zc(c.buckets,h.style),this.hasSymbolBuckets=!1;for(const N in this.buckets){const A=this.buckets[N];if(A instanceof s.aY){if(this.hasSymbolBuckets=!0,!v)break;A.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const N in this.buckets){const A=this.buckets[N];if(A instanceof s.aY&&A.hasRTLText){this.hasRTLText=!0,s.aZ();break}}this.queryPadding=0;for(const N in this.buckets){const A=this.buckets[N],k=h.style.getOwnLayer(N);if(!k)continue;const z=k.queryRadius(A);this.queryPadding=Math.max(this.queryPadding,z)}c.imageAtlas&&(this.imageAtlas=c.imageAtlas),c.glyphAtlasImage&&(this.glyphAtlasImage=c.glyphAtlasImage),c.lineAtlas&&(this.lineAtlas=c.lineAtlas),this._lastUpdatedBrightness=c.brightness}else this.collisionBoxArray=new s.aX}unloadVectorData(){if(this.hasData()){for(const c in this.buckets)this.buckets[c].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}loadModelData(c,h,v){c&&(c.resourceTiming&&(this.resourceTiming=c.resourceTiming),this.buckets=Object.assign({},this.buckets,Zc(c.buckets,h.style)),c.featureIndex&&(this.latestFeatureIndex=c.featureIndex))}getBucket(c){return this.buckets[c.fqid]}upload(c){for(const N in this.buckets){const A=this.buckets[N];A.uploadPending()&&A.upload(c)}const h=c.gl,v=this.imageAtlas;v&&!v.uploaded&&(this.imageAtlasTexture=new s.T(c,v.image,h.RGBA8,{useMipmap:!!v.patternPositions.size}),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new s.T(c,this.glyphAtlasImage,h.R8),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new s.T(c,this.lineAtlas.image,h.R8),this.lineAtlas.uploaded=!0)}prepare(c,h,v){if(this.imageAtlas&&this.imageAtlasTexture&&this.imageAtlas.patchUpdatedImages(c,this.imageAtlasTexture,v),!h||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const N=h.style.getBrightness();(this._lastUpdatedBrightness||N)&&(this._lastUpdatedBrightness&&N&&Math.abs(this._lastUpdatedBrightness-N)<.001||(this.updateBuckets(h,this._lastUpdatedBrightness!==N),this._lastUpdatedBrightness=N))}queryRenderedFeatures(c,h,v,N,A,k){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData&&!this.latestFeatureIndex.is3DTile)return{};const z=function(q,K){const Y=s.ad.mat4.fromScaling([],[.5*q.width,.5*-q.height,1]);return s.ad.mat4.translate(Y,Y,[1,-1,0]),s.ad.mat4.multiply(Y,Y,q.calculateProjMatrix(K.toUnwrapped())),Float32Array.from(Y)}(A,this.tileID);return this.latestFeatureIndex.query(c,{tilespaceGeometry:h,pixelPosMatrix:z,transform:N,availableImages:v,tileTransform:this.tileTransform})}querySourceFeatures(c,h){const v=this.latestFeatureIndex;if(!v||!v.rawTileData)return;const N=v.loadVTLayers(),A=h?h.sourceLayer:"",k=N._geojsonTileLayer||N[A];if(!k)return;const z=s.a_(h&&h.filter),{z:q,x:K,y:Y}=this.tileID.canonical,ee={z:q,x:K,y:Y};for(let Q=0;Q<k.length;Q++){const ie=k.feature(Q);if(z.needGeometry){const he=s.a$(ie,!0);if(!z.filter(new s.aa(this.tileID.overscaledZ),he,this.tileID.canonical))continue}else if(!z.filter(new s.aa(this.tileID.overscaledZ),ie))continue;const de=v.getId(ie,A),le=new s.b0(ie,q,K,Y,de);le.tile=ee,c.push(le)}}loaded(){return this.state==="loaded"||this.state==="errored"}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!this.imageAtlas.patternPositions.size}setExpiryData(c){const h=this.expirationTime;if(c.cacheControl){const v=s.b1(c.cacheControl);v["max-age"]&&(this.expirationTime=Date.now()+1e3*v["max-age"])}else c.expires&&(this.expirationTime=new Date(c.expires).getTime());if(this.expirationTime){const v=Date.now();let N=!1;if(this.expirationTime>v)N=!1;else if(h)if(this.expirationTime<h)N=!0;else{const A=this.expirationTime-h;A?this.expirationTime=v+Math.max(A,3e4):N=!0}else N=!0;N?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}refreshFeatureState(c){this.latestFeatureIndex&&(this.latestFeatureIndex.rawTileData||this.latestFeatureIndex.is3DTile)&&c&&this.updateBuckets(c)}updateBuckets(c,h){if(!this.latestFeatureIndex||!c.style)return;const v=this.latestFeatureIndex.loadVTLayers(),N=c.style.listImages(),A=c.style.getBrightness();for(const k in this.buckets){if(!c.style.hasLayer(k))continue;const z=this.buckets[k],q=z.layers[0],K=q.sourceLayer||"_geojsonTileLayer",Y=v[K],ee=c.style.getLayerSourceCache(q);let Q={};ee&&(Q=ee._state.getState(K,void 0));const ie=this.imageAtlas?Object.fromEntries(this.imageAtlas.patternPositions):{},de=Object.keys(Q).length>0&&!h;de&&!z.stateDependentLayers.length&&!h||z.update(Q,Y,N,ie,de?z.stateDependentLayers:z.layers,h,A),(z instanceof s.b2||z instanceof s.b3)&&c._terrain&&c._terrain.enabled&&ee&&z.uploadPending()&&c._terrain._clearRenderCacheForTile(ee.id,this.tileID);const le=c&&c.style&&c.style.getOwnLayer(k);le&&(this.queryPadding=Math.max(this.queryPadding,le.queryRadius(z)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<s.q.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(c){this.symbolFadeHoldUntil=s.q.now()+c}setTexture(c,h){const v=h.context,N=v.gl;this.texture=this.texture||h.getTileTexture(c.width),this.texture&&this.texture instanceof s.T?this.texture.update(c):(this.texture=new s.T(v,c,N.RGBA8,{useMipmap:!0}),this.texture.bind(N.LINEAR,N.CLAMP_TO_EDGE))}setDependencies(c,h){const v={};for(const N of h)v[N]=!0;this.dependencies[c]=v}hasDependency(c,h){for(const v of c){const N=this.dependencies[v];if(N){for(const A of h)if(N[A])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(c,h){if(!h||h.name==="mercator"||this._tileDebugBuffer)return;const v=s.b4(Mx,this.tileID.canonical,this.tileTransform)[0],N=new s.b5,A=new s.b6;for(let k=0;k<v.length;k++){const{x:z,y:q}=v[k];N.emplaceBack(z,q),A.emplaceBack(k)}A.emplaceBack(0),this._tileDebugIndexBuffer=c.createIndexBuffer(A),this._tileDebugBuffer=c.createVertexBuffer(N,s.b7.members),this._tileDebugSegments=s.b8.simpleSegment(0,0,N.length,A.length)}_makeTileBoundsBuffers(c,h){if(this._tileBoundsBuffer||!h||h.name==="mercator")return;const v=s.b4(Mx,this.tileID.canonical,this.tileTransform)[0];let N,A;if(this.isRaster){const k=function(z,q){const K=s.aR(z,q),Y=Math.pow(2,z.z);for(let he=0;he<il;he++)for(let fe=0;fe<il;fe++){const Te=s.aS((z.x+(fe+q_(fe))/yo)/Y),Re=s.aT((z.y+(he+q_(he))/yo)/Y),Oe=q.project(Te,Re),$e=he*il+fe;sl[2*$e+0]=Math.round((Oe.x*K.scale-K.x)*s.ai),sl[2*$e+1]=Math.round((Oe.y*K.scale-K.y)*s.ai)}Ro.fill(0),Wm.fill(0);for(let he=2045;he>=0;he--){const fe=4*he,Te=oc[fe+0],Re=oc[fe+1],Oe=oc[fe+2],$e=oc[fe+3],Le=Te+Oe>>1,Fe=Re+$e>>1,Be=Le+Fe-Re,He=Fe+Te-Le,Ke=Re*il+Te,ft=$e*il+Oe,at=Fe*il+Le,kt=Math.hypot((sl[2*Ke+0]+sl[2*ft+0])/2-sl[2*at+0],(sl[2*Ke+1]+sl[2*ft+1])/2-sl[2*at+1])>=16;Ro[at]=Ro[at]||(kt?1:0),he<1022&&(Ro[at]=Ro[at]||Ro[(Re+He>>1)*il+(Te+Be>>1)]||Ro[($e+He>>1)*il+(Oe+Be>>1)])}const ee=new s.aU,Q=new s.aV;let ie=0;function de(he,fe){const Te=fe*il+he;return Wm[Te]===0&&(ee.emplaceBack(sl[2*Te+0],sl[2*Te+1],he*s.ai/yo,fe*s.ai/yo),Wm[Te]=++ie),Wm[Te]-1}function le(he,fe,Te,Re,Oe,$e){const Le=he+Te>>1,Fe=fe+Re>>1;if(Math.abs(he-Oe)+Math.abs(fe-$e)>1&&Ro[Fe*il+Le])le(Oe,$e,he,fe,Le,Fe),le(Te,Re,Oe,$e,Le,Fe);else{const Be=de(he,fe),He=de(Te,Re),Ke=de(Oe,$e);Q.emplaceBack(Be,He,Ke)}}return le(0,0,yo,yo,yo,0),le(yo,yo,0,0,0,yo),{vertices:ee,indices:Q}}(this.tileID.canonical,h);N=k.vertices,A=k.indices}else{N=new s.aU,A=new s.aV;for(const{x:z,y:q}of v)N.emplaceBack(z,q,0,0);const k=s.b9(N.int16,void 0,4);for(let z=0;z<k.length;z+=3)A.emplaceBack(k[z],k[z+1],k[z+2])}this._tileBoundsBuffer=c.createVertexBuffer(N,s.ba.members),this._tileBoundsIndexBuffer=c.createIndexBuffer(A),this._tileBoundsSegments=s.b8.simpleSegment(0,0,N.length,A.length)}_makeGlobeTileDebugBuffers(c,h){const v=h.projection;if(!v||v.name!=="globe"||h.freezeTileCoverage)return;const N=this.tileID.canonical,A=s.bb(N,h),k=s.bc(A),z=s.ag(h.zoom);let q;z>0&&(q=s.ad.mat4.invert(new Float64Array(16),h.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(c,N,h,k,q,z),this._makeGlobeTileDebugTextBuffer(c,N,h,k,q,z)}_globePoint(c,h,v,N,A,k,z){let q=s.bd(c,h,v);if(k){const K=1<<v.z,Y=s.av(N.center.lng),ee=s.aC(N.center.lat),Q=(v.x+.5)/K-Y;let ie=0;Q>.5?ie=-1:Q<-.5&&(ie=1);let de=(c/s.ai+v.x)/K+ie,le=(h/s.ai+v.y)/K;de=(de-Y)*N._pixelsPerMercatorPixel+Y,le=(le-ee)*N._pixelsPerMercatorPixel+ee;const he=[de*N.worldSize,le*N.worldSize,0];s.ad.vec3.transformMat4(he,he,k),q=s.be(q,he,z)}return s.ad.vec3.transformMat4(q,q,A)}_makeGlobeTileDebugBorderBuffer(c,h,v,N,A,k){const z=new s.b5,q=new s.b6,K=new s.bf,Y=(Q,ie,de,le,he)=>{const fe=(de-Q)/(he-1),Te=(le-ie)/(he-1),Re=z.length;for(let Oe=0;Oe<he;Oe++){const $e=Q+Oe*fe,Le=ie+Oe*Te;z.emplaceBack($e,Le);const Fe=this._globePoint($e,Le,h,v,N,A,k);K.emplaceBack(Fe[0],Fe[1],Fe[2]),q.emplaceBack(Re+Oe)}},ee=s.ai;Y(0,0,ee,0,16),Y(ee,0,ee,ee,16),Y(ee,ee,0,ee,16),Y(0,ee,0,0,16),this._tileDebugIndexBuffer=c.createIndexBuffer(q),this._tileDebugBuffer=c.createVertexBuffer(z,s.b7.members),this._globeTileDebugBorderBuffer=c.createVertexBuffer(K,s.bg.members),this._tileDebugSegments=s.b8.simpleSegment(0,0,z.length,q.length)}_makeGlobeTileDebugTextBuffer(c,h,v,N,A,k){const z=s.ai/4,q=new s.b5,K=new s.aV,Y=new s.bf,ee=25;K.reserve(32),q.reserve(ee),Y.reserve(ee);const Q=(ie,de)=>ee*ie+de;for(let ie=0;ie<ee;ie++){const de=ie*z;for(let le=0;le<ee;le++){const he=le*z;q.emplaceBack(he,de);const fe=this._globePoint(he,de,h,v,N,A,k);Y.emplaceBack(fe[0],fe[1],fe[2])}}for(let ie=0;ie<4;ie++)for(let de=0;de<4;de++){const le=Q(ie,de),he=Q(ie,de+1),fe=Q(ie+1,de),Te=Q(ie+1,de+1);K.emplaceBack(le,he,fe),K.emplaceBack(fe,he,Te)}this._tileDebugTextIndexBuffer=c.createIndexBuffer(K),this._tileDebugTextBuffer=c.createVertexBuffer(q,s.b7.members),this._globeTileDebugTextBuffer=c.createVertexBuffer(Y,s.bg.members),this._tileDebugTextSegments=s.b8.simpleSegment(0,0,ee,32)}destroy(c=!1){for(const h in this.buckets)this.buckets[h].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&(this.imageAtlasTexture.destroy(),delete this.imageAtlasTexture),this.glyphAtlasTexture&&(this.glyphAtlasTexture.destroy(),delete this.glyphAtlasTexture),this.lineAtlasTexture&&(this.lineAtlasTexture.destroy(),delete this.lineAtlasTexture),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),!c&&this.texture&&this.texture instanceof s.T&&(this.texture.destroy(),delete this.texture),this.hillshadeFBO&&(this.hillshadeFBO.destroy(),delete this.hillshadeFBO),this.dem&&delete this.dem,this.neighboringTiles&&delete this.neighboringTiles,this.demTexture&&(this.demTexture.destroy(),delete this.demTexture),this.rasterParticleState&&(this.rasterParticleState.destroy(),delete this.rasterParticleState),this.latestFeatureIndex=null,this.state="unloaded"}}s.bh.setPbf(s.bi);class vo extends lc{constructor(c,h,v,N,A){super(c,h,v,N,A),this._workQueue=[],this._fetchQueue=[],this._isHeaderLoaded=!1}getLayers(){return this._mrt?Object.values(this._mrt.layers):[]}getLayer(c){return this._mrt&&this._mrt.getLayer(c)}setTexture(c,h){const v=h.context,N=v.gl;this.texture=this.texture||h.getTileTexture(c.width),this.texture&&this.texture instanceof s.T?this.texture.update(c,{premultiply:!1}):this.texture=new s.T(v,c,N.RGBA8,{premultiply:!1})}flushQueues(){for(;this._workQueue.length;)this._workQueue.pop()();for(;this._fetchQueue.length;)this._fetchQueue.pop()()}fetchHeader(c=16384,h){const v=this._mrt=new s.bh(30),N=Object.assign({},this.requestParams,{headers:{Range:"bytes=0-"+(c-1)}});return this.entireBuffer=null,this.request=s.bj(N,(A,k,z,q)=>{if(A)h(A);else try{const K=v.getHeaderLength(k);if(K>c)return void(this.request=this.fetchHeader(K,h));v.parseHeader(k),this._isHeaderLoaded=!0;let Y=0;for(const ee of Object.values(v.layers))Y=Math.max(Y,ee.dataIndex[ee.dataIndex.length-1].lastByte);k.byteLength>=Y&&(this.entireBuffer=k),h(null,this.entireBuffer||k,z,q)}catch(K){h(K)}}),this.request}fetchBand(c,h,v){const N=this._mrt;if(!this._isHeaderLoaded||!N)return void v(new Error("Tile header is not ready"));const A=this.actor;if(!A)return void v(new Error("Can't fetch tile band without an actor"));let k;const z=(ee,Q)=>{k.complete(ee,Q),ee?v(ee):(this.updateTextureDescriptor(c,h),v(null,this.textureDescriptor&&this.textureDescriptor.img))},q=(ee,Q)=>{if(ee)return v(ee);const ie=A.send("decodeRasterArray",{type:"raster-array",source:this.source,scope:this.scope,tileID:this.tileID,uid:this.uid,buffer:Q,task:k},z,void 0,!0);this._workQueue.push(()=>{ie&&ie.cancel(),k.cancel()})},K=N.getLayer(c);if(!K)return void v(new Error(`Unknown sourceLayer "${c}"`));if(K.hasDataForBand(h))return this.updateTextureDescriptor(c,h),void v(null,this.textureDescriptor?this.textureDescriptor.img:null);const Y=K.getDataRange([h]);if(k=N.createDecodingTask(Y),!k||k.tasks.length)if(this.flushQueues(),this.entireBuffer)q(null,this.entireBuffer.slice(Y.firstByte,Y.lastByte+1));else{const ee=Object.assign({},this.requestParams,{headers:{Range:`bytes=${Y.firstByte}-${Y.lastByte}`}}),Q=s.bj(ee,q);this._fetchQueue.push(()=>{Q.cancel(),k.cancel()})}else v(null)}updateNeeded(c,h){return(!this.textureDescriptor||this.textureDescriptor.band!==h||this.textureDescriptor.layer!==c)&&this.state!=="errored"}updateTextureDescriptor(c,h){if(!this._mrt)return;const v=this._mrt.getLayer(c);if(!v||!v.hasBand(h)||!v.hasDataForBand(h))return;const{bytes:N,tileSize:A,buffer:k,offset:z,scale:q}=v.getBandView(h),K=A+2*k,Y=new s.r({width:K,height:K},N),ee=this.texture;ee&&ee instanceof s.T&&ee.update(Y,{premultiply:!1}),this.textureDescriptor={layer:c,band:h,img:Y,buffer:k,offset:z,tileSize:A,format:v.pixelFormat,mix:[q,256*q,65536*q,16777216*q]}}}class AS{constructor(c,h){this.max=c,this.onRemove=h,this.reset()}reset(){for(const c in this.data)for(const h of this.data[c])h.timeout&&clearTimeout(h.timeout),this.onRemove(h.value);return this.data={},this.order=[],this}add(c,h,v){const N=c.wrapped().key;this.data[N]===void 0&&(this.data[N]=[]);const A={value:h,timeout:void 0};if(v!==void 0&&(A.timeout=setTimeout(()=>{this.remove(c,A)},v)),this.data[N].push(A),this.order.push(N),this.order.length>this.max){const k=this._getAndRemoveByKey(this.order[0]);k&&this.onRemove(k)}return this}has(c){return c.wrapped().key in this.data}getAndRemove(c){return this.has(c)?this._getAndRemoveByKey(c.wrapped().key):null}_getAndRemoveByKey(c){const h=this.data[c].shift();return h.timeout&&clearTimeout(h.timeout),this.data[c].length===0&&delete this.data[c],this.order.splice(this.order.indexOf(c),1),h.value}getByKey(c){const h=this.data[c];return h?h[0].value:null}get(c){return this.has(c)?this.data[c.wrapped().key][0].value:null}remove(c,h){if(!this.has(c))return this;const v=c.wrapped().key,N=h===void 0?0:this.data[v].indexOf(h),A=this.data[v][N];return this.data[v].splice(N,1),A.timeout&&clearTimeout(A.timeout),this.data[v].length===0&&delete this.data[v],this.onRemove(A.value),this.order.splice(this.order.indexOf(v),1),this}setMaxSize(c){for(this.max=c;this.order.length>this.max;){const h=this._getAndRemoveByKey(this.order[0]);h&&this.onRemove(h)}return this}filter(c){const h=[];for(const v in this.data)for(const N of this.data[v])c(N.value)||h.push(N);for(const v of h)this.remove(v.value.tileID,v)}}class W_{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(c,h,v){const N=String(h);if(this.stateChanges[c]=this.stateChanges[c]||{},this.stateChanges[c][N]=this.stateChanges[c][N]||{},s.l(this.stateChanges[c][N],v),this.deletedStates[c]===null){this.deletedStates[c]={};for(const A in this.state[c])A!==N&&(this.deletedStates[c][A]=null)}else if(this.deletedStates[c]&&this.deletedStates[c][N]===null){this.deletedStates[c][N]={};for(const A in this.state[c][N])v[A]||(this.deletedStates[c][N][A]=null)}else for(const A in v)this.deletedStates[c]&&this.deletedStates[c][N]&&this.deletedStates[c][N][A]===null&&delete this.deletedStates[c][N][A]}removeFeatureState(c,h,v){if(this.deletedStates[c]===null)return;const N=String(h);if(this.deletedStates[c]=this.deletedStates[c]||{},v&&h!==void 0)this.deletedStates[c][N]!==null&&(this.deletedStates[c][N]=this.deletedStates[c][N]||{},this.deletedStates[c][N][v]=null);else if(h!==void 0)if(this.stateChanges[c]&&this.stateChanges[c][N])for(v in this.deletedStates[c][N]={},this.stateChanges[c][N])this.deletedStates[c][N][v]=null;else this.deletedStates[c][N]=null;else this.deletedStates[c]=null}getState(c,h){const v=this.state[c]||{},N=this.stateChanges[c]||{},A=this.deletedStates[c];if(A===null)return{};if(h!==void 0){const z=String(h),q=s.l({},v[z],N[z]);if(A){const K=A[h];if(K===null)return{};for(const Y in K)delete q[Y]}return q}const k=s.l({},v,N);if(A)for(const z in A)delete k[z];return k}initializeTileState(c,h){c.refreshFeatureState(h)}coalesceChanges(c,h){const v={};for(const N in this.stateChanges){this.state[N]=this.state[N]||{};const A={};for(const k in this.stateChanges[N])this.state[N][k]||(this.state[N][k]={}),s.l(this.state[N][k],this.stateChanges[N][k]),A[k]=this.state[N][k];v[N]=A}for(const N in this.deletedStates){this.state[N]=this.state[N]||{};const A={};if(this.deletedStates[N]===null)for(const k in this.state[N])A[k]={},this.state[N][k]={};else for(const k in this.deletedStates[N]){if(this.deletedStates[N][k]===null)this.state[N][k]={};else if(this.state[N][k])for(const z of Object.keys(this.deletedStates[N][k]))delete this.state[N][k][z];A[k]=this.state[N][k]}v[N]=v[N]||{},s.l(v[N],A)}if(this.stateChanges={},this.deletedStates={},Object.keys(v).length!==0)for(const N in c)c[N].refreshFeatureState(h)}}class Dl extends s.E{constructor(c,h,v){super(),this.id=c,this._onlySymbols=v,h.on("data",N=>{N.dataType==="source"&&N.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&N.dataType==="source"&&N.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),h.on("error",()=>{this._sourceErrored=!0}),this._source=h,this._tiles={},this._cache=new AS(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=h.minTileCacheSize,this._maxTileCacheSize=h.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this.tileCoverLift=0,this._coveredTiles={},this._shadowCasterTiles={},this._state=new W_,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="raster-array"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(c){this.map=c,this._minTileCacheSize=this._minTileCacheSize===void 0&&c?c._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&c?c._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const c in this._tiles)if(!this._tiles[c].loaded())return!1;return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const c=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,c&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(c,h){return c.isSymbolTile=this._onlySymbols,c.isExtraShadowCaster=this._shadowCasterTiles[c.tileID.key],this._source.loadTile(c,h)}_unloadTile(c){if(this._source.unloadTile)return this._source.unloadTile(c)}_abortTile(c){if(this._source.abortTile)return this._source.abortTile(c)}serialize(){return this._source.serialize()}prepare(c){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const h in this._tiles){const v=this._tiles[h];v.upload(c),v.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return Object.values(this._tiles).map(c=>c.tileID).sort(Xn).map(c=>c.key)}getRenderableIds(c,h){const v=[];for(const N in this._tiles)this._isIdRenderable(+N,c,h)&&v.push(this._tiles[N]);return c?v.sort((N,A)=>{const k=N.tileID,z=A.tileID,q=new s.P(k.canonical.x,k.canonical.y)._rotate(this.transform.angle),K=new s.P(z.canonical.x,z.canonical.y)._rotate(this.transform.angle);return k.overscaledZ-z.overscaledZ||K.y-q.y||K.x-q.x}).map(N=>N.tileID.key):v.map(N=>N.tileID).sort(Xn).map(N=>N.key)}hasRenderableParent(c){const h=this.findLoadedParent(c,0);return!!h&&this._isIdRenderable(h.tileID.key)}_isIdRenderable(c,h,v){return this._tiles[c]&&this._tiles[c].hasData()&&!this._coveredTiles[c]&&(h||!this._tiles[c].holdingForFade())&&(v||!this._shadowCasterTiles[c])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const c in this._tiles)this._tiles[c].state!=="errored"&&this._reloadTile(+c,"reloading")}}_reloadTile(c,h){const v=this._tiles[c];v&&(v.state!=="loading"&&(v.state=h),this._loadTile(v,this._tileLoaded.bind(this,v,c,h)))}_tileLoaded(c,h,v,N){if(N)if(c.state="errored",N.status!==404)this._source.fire(new s.z(N,{tile:c}));else{if(this._source.fire(new s.A("data",{dataType:"source",sourceDataType:"error",sourceId:this._source.id,tile:c})),!(c.tileID.key in this._loadedParentTiles))return;if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const A=this.map.painter.terrain;this.update(this.transform,A.getScaledDemTileSize(),!0),A.resetTileLookupCache(this.id)}else this.update(this.transform)}else c.timeAdded=s.q.now(),v==="expired"&&(c.refreshedUponExpiration=!0),this._setTileReloadTimer(h,c),this._source.type==="raster-dem"&&c.dem&&this._backfillDEM(c),this._state.initializeTileState(c,this.map?this.map.painter:null),this._source.fire(new s.A("data",{dataType:"source",tile:c,coord:c.tileID,sourceCacheId:this.id}))}_backfillDEM(c){const h=this.getRenderableIds();for(let N=0;N<h.length;N++){const A=h[N];if(c.neighboringTiles&&c.neighboringTiles[A]){const k=this.getTileByID(A);v(c,k),v(k,c)}}function v(N,A){if(!N.dem||N.dem.borderReady)return;N.needsHillshadePrepare=!0,N.needsDEMTextureUpload=!0;let k=A.tileID.canonical.x-N.tileID.canonical.x;const z=A.tileID.canonical.y-N.tileID.canonical.y,q=Math.pow(2,N.tileID.canonical.z),K=A.tileID.key;k===0&&z===0||Math.abs(z)>1||(Math.abs(k)>1&&(Math.abs(k+q)===1?k+=q:Math.abs(k-q)===1&&(k-=q)),A.dem&&N.dem&&(N.dem.backfillBorder(A.dem,k,z),N.neighboringTiles&&N.neighboringTiles[K]&&(N.neighboringTiles[K].backfilled=!0)))}}getTile(c){return this.getTileByID(c.key)}getTileByID(c){return this._tiles[c]}_retainLoadedChildren(c,h,v,N){for(const A in this._tiles){let k=this._tiles[A];if(N[A]||!k.hasData()||k.tileID.overscaledZ<=h||k.tileID.overscaledZ>v)continue;let z=k.tileID;for(;k&&k.tileID.overscaledZ>h+1;){const K=k.tileID.scaledTo(k.tileID.overscaledZ-1);k=this._tiles[K.key],k&&k.hasData()&&(z=K)}let q=z;for(;q.overscaledZ>h;)if(q=q.scaledTo(q.overscaledZ-1),c[q.key]){N[z.key]=z;break}}}findLoadedParent(c,h){if(c.key in this._loadedParentTiles){const v=this._loadedParentTiles[c.key];return v&&v.tileID.overscaledZ>=h?v:null}for(let v=c.overscaledZ-1;v>=h;v--){const N=c.scaledTo(v),A=this._getLoadedTile(N);if(A)return A}}_getLoadedTile(c){const h=this._tiles[c.key];return h&&h.hasData()?h:this._cache.getByKey(this._source.reparseOverscaled?c.wrapped().key:c.canonical.key)}updateCacheSize(c,h){h=h||this._source.tileSize;const v=Math.ceil(c.width/h)+1,N=Math.ceil(c.height/h)+1,A=Math.floor(v*N*5),k=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,A):A,z=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,k):k;this._cache.setMaxSize(z)}handleWrapJump(c){const h=Math.round((c-(this._prevLng===void 0?c:this._prevLng))/360);if(this._prevLng=c,h){const v={};for(const N in this._tiles){const A=this._tiles[N];A.tileID=A.tileID.unwrapTo(A.tileID.wrap+h),v[A.tileID.key]=A}this._tiles=v;for(const N in this._timers)clearTimeout(this._timers[N]),delete this._timers[N];for(const N in this._tiles)this._setTileReloadTimer(+N,this._tiles[N])}}update(c,h,v,N){if(this.transform=c,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!v)return;this.updateCacheSize(c,h),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={};const A=this._source.type==="batched-model";let k,z=this._source.maxzoom;const q=this.map&&this.map.painter?this.map.painter._terrain:null;if(q&&q.sourceCache===this&&q.attenuationRange()){const ee=q.attenuationRange()[0],Q=Math.floor(ee)-Math.log2(q.getDemUpscale());z>Q&&(z=Q)}if(this.used||this.usedForTerrain){if(this._source.tileID)k=c.getVisibleUnwrappedCoordinates(this._source.tileID).map(ee=>new s.aH(ee.canonical.z,ee.wrap,ee.canonical.z,ee.canonical.x,ee.canonical.y));else if(this.tileCoverLift!==0){const ee=c.clone();ee.tileCoverLift=this.tileCoverLift,k=ee.coveringTiles({tileSize:h||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:z,roundZoom:this._source.roundZoom&&!v,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:A}),this._source.minzoom<=1&&c.projection.name==="globe"&&(k.push(new s.aH(1,0,1,0,0)),k.push(new s.aH(1,0,1,1,0)),k.push(new s.aH(1,0,1,0,1)),k.push(new s.aH(1,0,1,1,1)))}else if(k=c.coveringTiles({tileSize:h||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:z,roundZoom:this._source.roundZoom&&!v,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:A}),this._source.hasTile){const ee=this._source.hasTile.bind(this._source);k=k.filter(Q=>ee(Q))}}else k=[];if(k.length>0&&this.castsShadows&&N&&this.transform.projection.name!=="globe"&&!this.usedForTerrain&&!K_(this._source.type)){const ee=c.coveringZoomLevel({tileSize:h||this._source.tileSize,roundZoom:this._source.roundZoom&&!v}),Q=Math.min(ee,this._source.maxzoom);if(A){const ie=c.extendTileCover(k,Q);for(const de of ie)k.push(de)}else{const ie=c.extendTileCover(k,Q,N);for(const de of ie)this._shadowCasterTiles[de.key]=!0,k.push(de)}}const K=this._updateRetainedTiles(k);if(K_(this._source.type)&&k.length!==0){const ee={},Q={},ie=Object.keys(K);for(const le of ie){const he=K[le],fe=this._tiles[le];if(!fe||fe.fadeEndTime&&fe.fadeEndTime<=s.q.now())continue;const Te=this.findLoadedParent(he,Math.max(he.overscaledZ-Dl.maxOverzooming,this._source.minzoom));Te&&(this._addTile(Te.tileID),ee[Te.tileID.key]=Te.tileID),Q[le]=he}const de=k[k.length-1].overscaledZ;for(const le in this._tiles){const he=this._tiles[le];if(K[le]||!he.hasData())continue;let fe=he.tileID;for(;fe.overscaledZ>de;){fe=fe.scaledTo(fe.overscaledZ-1);const Te=this._tiles[fe.key];if(Te&&Te.hasData()&&Q[fe.key]){K[le]=he.tileID;break}}}for(const le in ee)K[le]||(this._coveredTiles[le]=!0,K[le]=ee[le])}for(const ee in K)this._tiles[ee].clearFadeHold();const Y=s.bk(this._tiles,K);for(const ee of Y){const Q=this._tiles[ee];Q.hasSymbolBuckets&&!Q.holdingForFade()?Q.setHoldDuration(this.map._fadeDuration):Q.hasSymbolBuckets&&!Q.symbolFadeFinished()||this._removeTile(+ee)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const c in this._tiles)this._tiles[c].holdingForFade()&&this._removeTile(+c)}_updateRetainedTiles(c){const h={};if(c.length===0)return h;const v={},N=c.reduce((K,Y)=>Math.min(K,Y.overscaledZ),1/0),A=c[0].overscaledZ,k=Math.max(A-Dl.maxOverzooming,this._source.minzoom),z=Math.max(A+Dl.maxUnderzooming,this._source.minzoom),q={};for(const K of c){const Y=this._addTile(K);h[K.key]=K,Y.hasData()||N<this._source.maxzoom&&(q[K.key]=K)}this._retainLoadedChildren(q,N,z,h);for(const K of c){let Y=this._tiles[K.key];if(Y.hasData())continue;if(K.canonical.z>=this._source.maxzoom){const Q=K.children(this._source.maxzoom)[0],ie=this.getTile(Q);if(ie&&ie.hasData()){h[Q.key]=Q;continue}}else{const Q=K.children(this._source.maxzoom);if(h[Q[0].key]&&h[Q[1].key]&&h[Q[2].key]&&h[Q[3].key])continue}let ee=Y.wasRequested();for(let Q=K.overscaledZ-1;Q>=k;--Q){const ie=K.scaledTo(Q);if(v[ie.key]||(v[ie.key]=!0,Y=this.getTile(ie),!Y&&ee&&(Y=this._addTile(ie)),Y&&(h[ie.key]=ie,ee=Y.wasRequested(),Y.hasData())))break}}return h}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const c in this._tiles){const h=[];let v,N=this._tiles[c].tileID;for(;N.overscaledZ>0;){if(N.key in this._loadedParentTiles){v=this._loadedParentTiles[N.key];break}h.push(N.key);const A=N.scaledTo(N.overscaledZ-1);if(v=this._getLoadedTile(A),v)break;N=A}for(const A of h)this._loadedParentTiles[A]=v}}_addTile(c){let h=this._tiles[c.key];if(h)return h.isExtraShadowCaster!==!0||this._shadowCasterTiles[c.key]||this._reloadTile(c.key,"reloading"),h;h=this._cache.getAndRemove(c),h&&(this._setTileReloadTimer(c.key,h),h.tileID=c,this._state.initializeTileState(h,this.map?this.map.painter:null),this._cacheTimers[c.key]&&(clearTimeout(this._cacheTimers[c.key]),delete this._cacheTimers[c.key],this._setTileReloadTimer(c.key,h)));const v=!!h;if(!v){const N=this.map?this.map.painter:null,A=this._source.tileSize*c.overscaleFactor();h=this._source.type==="raster-array"?new vo(c,A,this.transform.tileZoom,N,this._isRaster):new lc(c,A,this.transform.tileZoom,N,this._isRaster),this._loadTile(h,this._tileLoaded.bind(this,h,c.key,h.state))}return h?(h.uses++,this._tiles[c.key]=h,v||this._source.fire(new s.A("dataloading",{tile:h,coord:h.tileID,dataType:"source"})),h):null}_setTileReloadTimer(c,h){c in this._timers&&(clearTimeout(this._timers[c]),delete this._timers[c]);const v=h.getExpiryTimeout();v&&(this._timers[c]=setTimeout(()=>{this._reloadTile(c,"expired"),delete this._timers[c]},v))}_removeTile(c){const h=this._tiles[c];h&&(h.uses--,delete this._tiles[c],this._timers[c]&&(clearTimeout(this._timers[c]),delete this._timers[c]),h.uses>0||(h.hasData()&&h.state!=="reloading"||h.state==="empty"?this._cache.add(h.tileID,h,h.getExpiryTimeout()):(h.aborted=!0,this._abortTile(h),this._unloadTile(h))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const c in this._tiles)this._removeTile(+c);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(c,h,v){const N=[],A=this.transform;if(!A)return N;const k=A.projection.name==="globe",z=s.av(A.center.lng);for(const q in this._tiles){const K=this._tiles[q];if(v&&K.clearQueryDebugViz(),K.holdingForFade())continue;let Y;if(k){const ee=K.tileID.canonical;if(ee.z===0){const Q=[Math.abs(s.ay(z,...Mr(ee,-1))-z),Math.abs(s.ay(z,...Mr(ee,1))-z)];Y=[0,2*Q.indexOf(Math.min(...Q))-1]}else{const Q=[Math.abs(s.ay(z,...Mr(ee,-1))-z),Math.abs(s.ay(z,...Mr(ee,0))-z),Math.abs(s.ay(z,...Mr(ee,1))-z)];Y=[Q.indexOf(Math.min(...Q))-1]}}else Y=[0];for(const ee of Y){const Q=c.containsTile(K,A,h,ee);Q&&N.push(Q)}}return N}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(c){return this._getRenderableCoordinates(c)}_getRenderableCoordinates(c,h){const v=this.getRenderableIds(c,h).map(A=>this._tiles[A].tileID),N=this.transform.projection.name==="globe";for(const A of v)A.projMatrix=this.transform.calculateProjMatrix(A.toUnwrapped()),A.expandedProjMatrix=N?this.transform.calculateProjMatrix(A.toUnwrapped(),!1,!0):A.projMatrix;return v}sortCoordinatesByDistance(c){const h=c.slice(),v=this.transform._camera.position,N=this.transform._camera.forward(),A={};for(const k of h){const z=1/(1<<k.canonical.z);A[k.key]=((k.canonical.x+.5)*z+k.wrap-v[0])*N[0]+((k.canonical.y+.5)*z-v[1])*N[1]-v[2]*N[2]}return h.sort((k,z)=>A[k.key]-A[z.key]),h}hasTransition(){if(this._source.hasTransition())return!0;if(K_(this._source.type))for(const c in this._tiles){const h=this._tiles[c];if(h.fadeEndTime!==void 0&&h.fadeEndTime>=s.q.now())return!0}return!1}setFeatureState(c,h,v){this._state.updateState(c=c||"_geojsonTileLayer",h,v)}removeFeatureState(c,h,v){this._state.removeFeatureState(c=c||"_geojsonTileLayer",h,v)}getFeatureState(c,h){return this._state.getState(c=c||"_geojsonTileLayer",h)}setDependencies(c,h,v){const N=this._tiles[c];N&&N.setDependencies(h,v)}reloadTilesForDependencies(c,h){for(const v in this._tiles)this._tiles[v].hasDependency(c,h)&&this._reloadTile(+v,"reloading");this._cache.filter(v=>!v.hasDependency(c,h))}_preloadTiles(c,h){if(!this._sourceLoaded){const q=()=>{this._sourceLoaded&&(this._source.off("data",q),this._preloadTiles(c,h))};return void this._source.on("data",q)}const v=new Map,N=Array.isArray(c)?c:[c],A=this.map.painter.terrain,k=this.usedForTerrain&&A?A.getScaledDemTileSize():this._source.tileSize;for(const q of N){const K=q.coveringTiles({tileSize:k,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const Y of K)v.set(Y.key,Y);this.usedForTerrain&&q.updateElevation(!1)}const z=Array.from(v.values());s.bl(z,(q,K)=>{const Y=new lc(q,this._source.tileSize*q.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(Y,ee=>{this._source.type==="raster-dem"&&Y.dem&&this._backfillDEM(Y),K(ee,Y)})},h)}}function Xn(b,c){const h=Math.abs(2*b.wrap)-+(b.wrap<0),v=Math.abs(2*c.wrap)-+(c.wrap<0);return b.overscaledZ-c.overscaledZ||v-h||c.canonical.y-b.canonical.y||c.canonical.x-b.canonical.x}function K_(b){return b==="raster"||b==="image"||b==="video"||b==="custom"}function Mr(b,c){const h=1<<b.z;return[b.x/h+c,(b.x+1)/h+c]}Dl.maxOverzooming=10,Dl.maxUnderzooming=3;class TS{constructor(c){this.style=c,this.layersGotHidden=!1,this.layers=[]}processLayersChanged(){this.layers=[];const c=!1,h=!1;for(const v in this.style._mergedLayers){const N=this.style._mergedLayers[v];if(N.type==="fill-extrusion")this.layers.push({layer:N,visible:c,visibilityChanged:h});else if(N.type==="model"){const A=this.style.getLayerSource(N);A&&A.type==="batched-model"&&this.layers.push({layer:N,visible:c,visibilityChanged:h})}}}onNewFrame(c){this.layersGotHidden=!1;for(const h of this.layers){const v=h.layer;let N=!1;v.type==="fill-extrusion"?N=!v.isHidden(c)&&v.paint.get("fill-extrusion-opacity")>0:v.type==="model"&&(N=!v.isHidden(c)&&v.paint.get("model-opacity").constantOr(1)>0),this.layersGotHidden=this.layersGotHidden||!N&&h.visible,h.visible=N}}updateZOffset(c,h){this.currentBuildingBuckets=[];for(const N of this.layers){const A=N.layer,k=this.style.getLayerSourceCache(A);let z=1;A.type==="fill-extrusion"&&(z=N.visible?A.paint.get("fill-extrusion-vertical-scale"):0);let q=k?k.getTile(h):null;if(!q&&k&&h.canonical.z>k.getSource().minzoom){let K=h.scaledTo(Math.min(k.getSource().maxzoom,h.overscaledZ-1));for(;K.overscaledZ>=k.getSource().minzoom&&(q=k.getTile(K),!q&&K.overscaledZ!==0);)K=K.scaledTo(K.overscaledZ-1)}this.currentBuildingBuckets.push({bucket:q?q.getBucket(A):null,tileID:q?q.tileID:h,verticalScale:z})}c.hasAnyZOffset=!1;let v=!1;for(let N=0;N<c.symbolInstances.length;N++){const A=c.symbolInstances.get(N),k=A.zOffset,z=this._getHeightAtTileOffset(h,A.tileAnchorX,A.tileAnchorY);A.zOffset=z!==Number.NEGATIVE_INFINITY?z:k,v||k===A.zOffset||(v=!0),c.hasAnyZOffset||A.zOffset===0||(c.hasAnyZOffset=!0)}v&&(c.zOffsetBuffersNeedUpload=!0,c.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(c,h,v,N){let A=h,k=v;if(c.canonical.z!==N.canonical.z){const z=N.canonical,q=1/(1<<c.canonical.z-z.z);A=(h+c.canonical.x*s.ai)*q-z.x*s.ai|0,k=(v+c.canonical.y*s.ai)*q-z.y*s.ai|0}return{tileX:A,tileY:k}}_getHeightAtTileOffset(c,h,v){let N,A;for(let k=0;k<this.layers.length;++k){if(this.layers[k].layer.type!=="fill-extrusion")continue;const{bucket:z,tileID:q,verticalScale:K}=this.currentBuildingBuckets[k];if(!z)continue;const{tileX:Y,tileY:ee}=this._mapCoordToOverlappingTile(c,h,v,q),Q=z.getHeightAtTileCoord(Y,ee);Q&&Q.height!==void 0&&(Q.hidden?N=Q.height:A=Math.max(Q.height*K,A||0))}if(A!==void 0)return A;for(let k=0;k<this.layers.length;++k){const z=this.layers[k];if(z.layer.type!=="model"||!z.visible)continue;const{bucket:q,tileID:K}=this.currentBuildingBuckets[k];if(!q)continue;const{tileX:Y,tileY:ee}=this._mapCoordToOverlappingTile(c,h,v,K),Q=q.getHeightAtTileCoord(Y,ee);if(Q&&!Q.hidden)return Q.height===void 0&&N!==void 0?Math.min(Q.maxHeight,N)*Q.verticalScale:Q.height?Q.height*Q.verticalScale:Number.NEGATIVE_INFINITY}return this.layersGotHidden?0:Number.NEGATIVE_INFINITY}}function kS(b,c){const h={};for(const v in b)v!=="ref"&&(h[v]=b[v]);return s.bm.forEach(v=>{v in c&&(h[v]=c[v])}),h}function vg(b){b=b.slice();const c=Object.create(null);for(let h=0;h<b.length;h++)c[b[h].id]=b[h];for(let h=0;h<b.length;h++)"ref"in b[h]&&(b[h]=kS(b[h],c[b[h].ref]));return b}const kn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setSnow:"setSnow",setRain:"setRain",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",updateImport:"updateImport",addIconset:"addIconset",removeIconset:"removeIconset"};function zl(b,c,h){h.push({command:kn.addSource,args:[b,c[b]]})}function Ix(b,c,h){c.push({command:kn.removeSource,args:[b]}),h[b]=!0}function Km(b,c,h,v){Ix(b,h,v),zl(b,c,h)}function vr(b,c,h){let v;for(v in b[h])if(b[h].hasOwnProperty(v)&&v!=="data"&&!s.bn(b[h][v],c[h][v]))return!1;for(v in c[h])if(c[h].hasOwnProperty(v)&&v!=="data"&&!s.bn(b[h][v],c[h][v]))return!1;return!0}function Zn(b,c,h,v,N,A){let k;for(k in c=c||{},b=b||{})b.hasOwnProperty(k)&&(s.bn(b[k],c[k])||h.push({command:A,args:[v,k,c[k],N]}));for(k in c)c.hasOwnProperty(k)&&!b.hasOwnProperty(k)&&(s.bn(b[k],c[k])||h.push({command:A,args:[v,k,c[k],N]}))}function In(b){return b.id}function Ga(b,c){return b[c.id]=c,b}class Zm{constructor(c,h){this.reset(c,h)}reset(c,h){this.points=c||[],this._distances=[0];for(let v=1;v<this.points.length;v++)this._distances[v]=this._distances[v-1]+this.points[v].dist(this.points[v-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(h||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(c){if(this.points.length===1)return this.points[0];c=s.ay(c,0,1);let h=1,v=this._distances[h];const N=c*this.paddedLength+this.padding;for(;v<N&&h<this._distances.length;)v=this._distances[++h];const A=h-1,k=this._distances[A],z=v-k,q=z>0?(N-k)/z:0;return this.points[A].mult(1-q).add(this.points[h].mult(q))}}class Fn{constructor(c,h,v){const N=this.boxCells=[],A=this.circleCells=[];this.xCellCount=Math.ceil(c/v),this.yCellCount=Math.ceil(h/v);for(let k=0;k<this.xCellCount*this.yCellCount;k++)N.push([]),A.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=c,this.height=h,this.xScale=this.xCellCount/c,this.yScale=this.yCellCount/h,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(c,h,v,N,A){this._forEachCell(h,v,N,A,this._insertBoxCell,this.boxUid++),this.boxKeys.push(c),this.bboxes.push(h),this.bboxes.push(v),this.bboxes.push(N),this.bboxes.push(A)}insertCircle(c,h,v,N){this._forEachCell(h-N,v-N,h+N,v+N,this._insertCircleCell,this.circleUid++),this.circleKeys.push(c),this.circles.push(h),this.circles.push(v),this.circles.push(N)}_insertBoxCell(c,h,v,N,A,k){this.boxCells[A].push(k)}_insertCircleCell(c,h,v,N,A,k){this.circleCells[A].push(k)}_query(c,h,v,N,A,k){if(v<0||c>this.width||N<0||h>this.height)return!A&&[];const z=[];if(c<=0&&h<=0&&this.width<=v&&this.height<=N){if(A)return!0;for(let q=0;q<this.boxKeys.length;q++)z.push({key:this.boxKeys[q],x1:this.bboxes[4*q],y1:this.bboxes[4*q+1],x2:this.bboxes[4*q+2],y2:this.bboxes[4*q+3]});for(let q=0;q<this.circleKeys.length;q++){const K=this.circles[3*q],Y=this.circles[3*q+1],ee=this.circles[3*q+2];z.push({key:this.circleKeys[q],x1:K-ee,y1:Y-ee,x2:K+ee,y2:Y+ee})}return k?z.filter(k):z}return this._forEachCell(c,h,v,N,this._queryCell,z,{hitTest:A,seenUids:{box:{},circle:{}}},k),A?z.length>0:z}_queryCircle(c,h,v,N,A){const k=c-v,z=c+v,q=h-v,K=h+v;if(z<0||k>this.width||K<0||q>this.height)return!N&&[];const Y=[];return this._forEachCell(k,q,z,K,this._queryCellCircle,Y,{hitTest:N,circle:{x:c,y:h,radius:v},seenUids:{box:{},circle:{}}},A),N?Y.length>0:Y}query(c,h,v,N,A){return this._query(c,h,v,N,!1,A)}hitTest(c,h,v,N,A){return this._query(c,h,v,N,!0,A)}hitTestCircle(c,h,v,N){return this._queryCircle(c,h,v,!0,N)}_queryCell(c,h,v,N,A,k,z,q){const K=z.seenUids,Y=this.boxCells[A];if(Y!==null){const Q=this.bboxes;for(const ie of Y)if(!K.box[ie]){K.box[ie]=!0;const de=4*ie;if(c<=Q[de+2]&&h<=Q[de+3]&&v>=Q[de+0]&&N>=Q[de+1]&&(!q||q(this.boxKeys[ie]))){if(z.hitTest)return k.push(!0),!0;k.push({key:this.boxKeys[ie],x1:Q[de],y1:Q[de+1],x2:Q[de+2],y2:Q[de+3]})}}}const ee=this.circleCells[A];if(ee!==null){const Q=this.circles;for(const ie of ee)if(!K.circle[ie]){K.circle[ie]=!0;const de=3*ie;if(this._circleAndRectCollide(Q[de],Q[de+1],Q[de+2],c,h,v,N)&&(!q||q(this.circleKeys[ie]))){if(z.hitTest)return k.push(!0),!0;{const le=Q[de],he=Q[de+1],fe=Q[de+2];k.push({key:this.circleKeys[ie],x1:le-fe,y1:he-fe,x2:le+fe,y2:he+fe})}}}}}_queryCellCircle(c,h,v,N,A,k,z,q){const K=z.circle,Y=z.seenUids,ee=this.boxCells[A];if(ee!==null){const ie=this.bboxes;for(const de of ee)if(!Y.box[de]){Y.box[de]=!0;const le=4*de;if(this._circleAndRectCollide(K.x,K.y,K.radius,ie[le+0],ie[le+1],ie[le+2],ie[le+3])&&(!q||q(this.boxKeys[de])))return k.push(!0),!0}}const Q=this.circleCells[A];if(Q!==null){const ie=this.circles;for(const de of Q)if(!Y.circle[de]){Y.circle[de]=!0;const le=3*de;if(this._circlesCollide(ie[le],ie[le+1],ie[le+2],K.x,K.y,K.radius)&&(!q||q(this.circleKeys[de])))return k.push(!0),!0}}}_forEachCell(c,h,v,N,A,k,z,q){const K=this._convertToXCellCoord(c),Y=this._convertToYCellCoord(h),ee=this._convertToXCellCoord(v),Q=this._convertToYCellCoord(N);for(let ie=K;ie<=ee;ie++)for(let de=Y;de<=Q;de++)if(A.call(this,c,h,v,N,this.xCellCount*de+ie,k,z,q))return}_convertToXCellCoord(c){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(c*this.xScale)))}_convertToYCellCoord(c){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(c*this.yScale)))}_circlesCollide(c,h,v,N,A,k){const z=N-c,q=A-h,K=v+k;return K*K>z*z+q*q}_circleAndRectCollide(c,h,v,N,A,k,z){const q=(k-N)/2,K=Math.abs(c-(N+q));if(K>q+v)return!1;const Y=(z-A)/2,ee=Math.abs(h-(A+Y));if(ee>Y+v)return!1;if(K<=q||ee<=Y)return!0;const Q=K-q,ie=ee-Y;return Q*Q+ie*ie<=v*v}}const ku={unknown:0,flipRequired:1,flipNotRequired:2},bg=Math.tan(85*Math.PI/180);function Pu(b,c,h,v,N,A,k){const z=s.ad.mat4.create();if(h)if(A.name==="globe"){const q=s.bo(N,c);s.ad.mat4.multiply(z,z,q)}else{const q=s.ad.mat2.invert([],k);z[0]=q[0],z[1]=q[1],z[4]=q[2],z[5]=q[3],v||s.ad.mat4.rotateZ(z,z,N.angle)}else s.ad.mat4.multiply(z,N.labelPlaneMatrix,b);return z}function Aa(b,c,h,v,N,A,k){const z=Pu(b,c,h,v,N,A,k);return A.name==="globe"&&h||(z[2]=z[6]=z[10]=z[14]=0),z}function us(b,c,h,v,N,A,k){if(h){if(A.name==="globe"){const z=Pu(b,c,h,v,N,A,k);return s.ad.mat4.invert(z,z),s.ad.mat4.multiply(z,b,z),z}{const z=s.ad.mat4.clone(b),q=s.ad.mat4.identity([]);return q[0]=k[0],q[1]=k[1],q[4]=k[2],q[5]=k[3],s.ad.mat4.multiply(z,z,q),v||s.ad.mat4.rotateZ(z,z,-N.angle),z}}return N.glCoordMatrix}function cc(b,c,h,v){const N=[b,c,h,1];h?s.ad.vec4.transformMat4(N,N,v):Es(N,N,v);const A=N[3];return N[0]/=A,N[1]/=A,N[2]/=A,N}function Ym(b,c){return Math.min(.5+b/c*.5,1.5)}function Z_(b,c){const h=b[0]/b[3],v=b[1]/b[3];return h>=-c[0]&&h<=c[0]&&v>=-c[1]&&v<=c[1]}function Xm(b,c,h,v,N,A,k,z,q,K){const Y=h.transform,ee=v?b.textSizeData:b.iconSizeData,Q=s.bp(ee,h.transform.zoom),ie=Y.projection.name==="globe",de=[256/h.width*2+1,256/h.height*2+1],le=v?b.text.dynamicLayoutVertexArray:b.icon.dynamicLayoutVertexArray;le.clear();let he=null;ie&&(he=v?b.text.globeExtVertexArray:b.icon.globeExtVertexArray);const fe=b.lineVertexArray,Te=v?b.text.placedSymbolArray:b.icon.placedSymbolArray,Re=h.transform.width/h.transform.height;let Oe,$e=!1;for(let Le=0;Le<Te.length;Le++){const Fe=Te.get(Le),{numGlyphs:Be,writingMode:He}=Fe;if(He!==s.bq.vertical||$e||Oe===s.bq.horizontal||($e=!0),Oe=He,(Fe.hidden||He===s.bq.vertical)&&!$e){uc(Be,le);continue}$e=!1;const Ke=new s.P(Fe.tileAnchorX,Fe.tileAnchorY);let{x:ft,y:at,z:kt}=Y.projection.projectTilePoint(Ke.x,Ke.y,K.canonical);if(q){const[Zt,Qt,gr]=q(Ke);ft+=Zt,at+=Qt,kt+=gr}const Pt=[ft,at,kt,1];if(s.ad.vec4.transformMat4(Pt,Pt,c),!Z_(Pt,de)){uc(Be,le);continue}const Bt=Pt[3],st=Ym(h.transform.getCameraToCenterDistance(Y.projection),Bt),At=s.br(ee,Q,Fe),rt=k?At/st:At*st,Ct=cc(ft,at,kt,N);if(Ct[3]<=0){uc(Be,le);continue}let _t={};const Et=s.ak(b.layers[0].layout.get("text-max-angle")),pt=Math.cos(Et),It=k?null:q,Kt=Ha(Fe,rt,!1,z,c,N,A,b.glyphOffsetArray,fe,le,he,Ct,Ke,_t,Re,It,Y.projection,K,k,pt);$e=Kt.useVertical,It&&Kt.needsFlipping&&(_t={}),(Kt.notEnoughRoom||$e||Kt.needsFlipping&&Ha(Fe,rt,!0,z,c,N,A,b.glyphOffsetArray,fe,le,he,Ct,Ke,_t,Re,It,Y.projection,K,k,pt).notEnoughRoom)&&uc(Be,le)}v?(b.text.dynamicLayoutVertexBuffer.updateData(le),he&&b.text.globeExtVertexBuffer&&b.text.globeExtVertexBuffer.updateData(he)):(b.icon.dynamicLayoutVertexBuffer.updateData(le),he&&b.icon.globeExtVertexBuffer&&b.icon.globeExtVertexBuffer.updateData(he))}function Ox(b,c,h,v,N,A,k,z,q,K,Y,ee,Q,ie,de,le,he){const{lineStartIndex:fe,glyphStartIndex:Te,segment:Re}=z,Oe=Te+z.numGlyphs,$e=fe+z.lineLength,Le=c.getoffsetX(Te),Fe=c.getoffsetX(Oe-1),Be=wg(b*Le,h,v,N,A,k,Re,fe,$e,q,K,Y,ee,Q,!0,ie,de,le,he);if(!Be)return null;const He=wg(b*Fe,h,v,N,A,k,Re,fe,$e,q,K,Y,ee,Q,!0,ie,de,le,he);return He?{first:Be,last:He}:null}function _g(b,c,h,v){return b===s.bq.horizontal&&Math.abs(v)>Math.abs(h)?{useVertical:!0}:b===s.bq.vertical?v>0?{needsFlipping:!0}:null:c!==ku.unknown&&function(N,A){return N===0||Math.abs(A/N)>bg}(h,v)?c===ku.flipRequired?{needsFlipping:!0}:null:h<0?{needsFlipping:!0}:null}function Ha(b,c,h,v,N,A,k,z,q,K,Y,ee,Q,ie,de,le,he,fe,Te,Re){const Oe=c/24,$e=b.lineOffsetX*Oe,Le=b.lineOffsetY*Oe,{lineStartIndex:Fe,glyphStartIndex:Be,numGlyphs:He,segment:Ke,writingMode:ft,flipState:at}=b,kt=Fe+b.lineLength,Pt=Bt=>{if(Y){const[Ct,_t,Et]=Bt.up,pt=K.length;s.bs(Y,pt+0,Ct,_t,Et),s.bs(Y,pt+1,Ct,_t,Et),s.bs(Y,pt+2,Ct,_t,Et),s.bs(Y,pt+3,Ct,_t,Et)}const[st,At,rt]=Bt.point;s.bt(K,st,At,rt,Bt.angle)};if(He>1){const Bt=Ox(Oe,z,$e,Le,h,ee,Q,b,q,A,ie,le,!1,he,fe,Te,Re);if(!Bt)return{notEnoughRoom:!0};if(v&&!h){let[st,At,rt]=Bt.first.point,[Ct,_t,Et]=Bt.last.point;[st,At]=cc(st,At,rt,k),[Ct,_t]=cc(Ct,_t,Et,k);const pt=_g(ft,at,(Ct-st)*de,_t-At);if(b.flipState=pt&&pt.needsFlipping?ku.flipRequired:ku.flipNotRequired,pt)return pt}Pt(Bt.first);for(let st=Be+1;st<Be+He-1;st++){const At=wg(Oe*z.getoffsetX(st),$e,Le,h,ee,Q,Ke,Fe,kt,q,A,ie,le,!1,!1,he,fe,Te,Re);if(!At)return K.length-=4*(st-Be),{notEnoughRoom:!0};Pt(At)}Pt(Bt.last)}else{if(v&&!h){const st=cc(Q.x,Q.y,0,N),At=Fe+Ke+1,rt=new s.P(q.getx(At),q.gety(At)),Ct=cc(rt.x,rt.y,0,N),_t=Ct[3]>0?Ct:qa(Q,rt,st,1,N,void 0,he,fe.canonical),Et=_g(ft,at,(_t[0]-st[0])*de,_t[1]-st[1]);if(b.flipState=Et&&Et.needsFlipping?ku.flipRequired:ku.flipNotRequired,Et)return Et}const Bt=wg(Oe*z.getoffsetX(Be),$e,Le,h,ee,Q,Ke,Fe,kt,q,A,ie,le,!1,!1,he,fe,Te,Re);if(!Bt)return{notEnoughRoom:!0};Pt(Bt)}return{}}function Yc(b,c,h,v,N){const{x:A,y:k,z}=v.projectTilePoint(b.x,b.y,c);if(!N)return cc(A,k,z,h);const[q,K,Y]=N(b);return cc(A+q,k+K,z+Y,h)}function qa(b,c,h,v,N,A,k,z){const q=Yc(b.sub(c)._unit()._add(b),z,N,k,A);return s.ad.vec3.sub(q,h,q),s.ad.vec3.normalize(q,q),s.ad.vec3.scaleAndAdd(q,h,q,v)}function wg(b,c,h,v,N,A,k,z,q,K,Y,ee,Q,ie,de,le,he,fe,Te){const Re=v?b-c:b+c;let Oe=Re>0?1:-1,$e=0;v&&(Oe*=-1,$e=Math.PI),Oe<0&&($e+=Math.PI);let Le=z+k+(Oe>0?0:1)|0,Fe=N,Be=N,He=0,Ke=0;const ft=Math.abs(Re),at=[],kt=[];let Pt=A,Bt=Pt,st=s.ad.vec3.zero([]);const At=()=>qa(Bt,Pt,Be,ft-He+1,Y,Q,le,he.canonical);for(;He+Ke<=ft;){if(Le+=Oe,Le<z||Le>=q)return null;if(Be=Fe,Bt=Pt,at.push(Be),ie&&kt.push(Bt),Pt=new s.P(K.getx(Le),K.gety(Le)),Fe=ee[Le],!Fe){const gr=Yc(Pt,he.canonical,Y,le,Q);Fe=gr[3]>0?ee[Le]=gr:At()}He+=Ke;const Zt=s.ad.vec3.sub([],Fe,Be),Qt=s.ad.vec3.distance(Be,Fe);if(h&&Qt>0&&Ke>0&&s.ad.vec3.dot(st,Zt)/(Ke*Qt)<Te)return null;Ke=Qt,st=Zt}de&&Q&&(ee[Le]&&(Fe=At(),Ke=s.ad.vec3.distance(Be,Fe),st=s.ad.vec3.sub([],Fe,Be)),ee[Le]=Fe);const rt=(ft-He)/Ke,Ct=Pt.sub(Bt)._mult(rt)._add(Bt),_t=s.ad.vec3.scaleAndAdd([],Be,st,rt);let Et=[0,0,1],pt=st[0],It=st[1];if(fe&&(Et=le.upVector(he.canonical,Ct.x,Ct.y),Et[0]!==0||Et[1]!==0||Et[2]!==1)){const Zt=[Et[2],0,-Et[0]],Qt=s.ad.vec3.cross([],Et,Zt);s.ad.vec3.normalize(Zt,Zt),s.ad.vec3.normalize(Qt,Qt),pt=s.ad.vec3.dot(st,Zt),It=s.ad.vec3.dot(st,Qt)}if(h){const Zt=s.ad.vec3.cross([],Et,st);s.ad.vec3.normalize(Zt,Zt),s.ad.vec3.scaleAndAdd(_t,_t,Zt,h*Oe)}const Kt=$e+Math.atan2(It,pt);return at.push(_t),ie&&kt.push(Ct),{point:_t,angle:Kt,path:at,tilePath:kt,up:Et}}function uc(b,c){const h=c.length,v=h+4*b;c.resize(v),c.float32.fill(-1/0,4*h,4*v)}function Es(b,c,h){const v=c[0],N=c[1];return b[0]=h[0]*v+h[4]*N+h[12],b[1]=h[1]*v+h[5]*N+h[13],b[3]=h[3]*v+h[7]*N+h[15],b}const ca=100;class Eu{constructor(c,h,v=new Fn(c.width+200,c.height+200,25),N=new Fn(c.width+200,c.height+200,25)){this.transform=c,this.grid=v,this.ignoredGrid=N,this.pitchfactor=Math.cos(c._pitch)*c.cameraToCenterDistance,this.screenRightBoundary=c.width+ca,this.screenBottomBoundary=c.height+ca,this.gridRightBoundary=c.width+200,this.gridBottomBoundary=c.height+200,this.fogState=h}placeCollisionBox(c,h,v,N,A,k,z,q){let K=v.projectedAnchorX,Y=v.projectedAnchorY,ee=v.projectedAnchorZ;const Q=v.elevation,ie=v.tileID,de=c.getProjection();if(Q&&ie){const[Le,Fe,Be]=de.upVector(ie.canonical,v.tileAnchorX,v.tileAnchorY),He=de.upVectorScale(ie.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;K+=Le*Q*He,Y+=Fe*Q*He,ee+=Be*Q*He}const le=this.projectAndGetPerspectiveRatio(z,K,Y,ee,v.tileID,de.name==="globe"||!!Q||this.transform.pitch>0,de),he=k*le.perspectiveRatio,fe=(v.x1*h+N.x-v.padding)*he+le.point.x,Te=(v.y1*h+N.y-v.padding)*he+le.point.y,Re=(v.x2*h+N.x+v.padding)*he+le.point.x,Oe=(v.y2*h+N.y+v.padding)*he+le.point.y,$e=le.perspectiveRatio<=.55||le.occluded;return!this.isInsideGrid(fe,Te,Re,Oe)||!A&&this.grid.hitTest(fe,Te,Re,Oe,q)||$e?{box:[],offscreen:!1,occluded:le.occluded}:{box:[fe,Te,Re,Oe],offscreen:this.isOffscreen(fe,Te,Re,Oe),occluded:!1}}placeCollisionCircles(c,h,v,N,A,k,z,q,K,Y,ee,Q,ie,de,le){const he=[],fe=this.transform.elevation,Te=c.getProjection(),Re=fe?fe.getAtTileOffsetFunc(le,this.transform.center.lat,this.transform.worldSize,Te):null,Oe=new s.P(v.tileAnchorX,v.tileAnchorY);let{x:$e,y:Le,z:Fe}=Te.projectTilePoint(Oe.x,Oe.y,le.canonical);if(Re){const[Et,pt,It]=Re(Oe);$e+=Et,Le+=pt,Fe+=It}const Be=Te.name==="globe",He=this.projectAndGetPerspectiveRatio(z,$e,Le,Fe,le,Be||!!fe||this.transform.pitch>0,Te),{perspectiveRatio:Ke}=He,ft=(ee?k/Ke:k*Ke)/s.bw,at=cc($e,Le,Fe,q),kt=v.lineOffsetX*ft,Pt=v.lineOffsetY*ft,Bt=s.ak(c.layers[0].layout.get("text-max-angle")),st=Math.cos(Bt),At=He.signedDistanceFromCamera>0?Ox(ft,A,kt,Pt,!1,at,Oe,v,N,q,{},fe&&!ee?Re:null,ee&&!!fe,Te,le,ee,st):null;let rt=!1,Ct=!1,_t=!0;if(At&&!He.occluded){const Et=.5*ie*Ke+de,pt=new s.P(-100,-100),It=new s.P(this.screenRightBoundary,this.screenBottomBoundary),Kt=new Zm,{first:Zt,last:Qt}=At,gr=Zt.path.length;let qr=[];for(let zr=gr-1;zr>=1;zr--)qr.push(Zt.path[zr]);for(let zr=1;zr<Qt.path.length;zr++)qr.push(Qt.path[zr]);const Er=2.5*Et;K&&(qr=qr.map(([zr,bn,Vn],fi)=>(Re&&!Be&&(Vn=Re(fi<gr-1?Zt.tilePath[gr-1-fi]:Qt.tilePath[fi-gr+2])[2]),cc(zr,bn,Vn,K))),qr.some(zr=>zr[3]<=0)&&(qr=[]));let Br=[];if(qr.length>0){let zr=1/0,bn=-1/0,Vn=1/0,fi=-1/0;for(const un of qr)zr=Math.min(zr,un[0]),Vn=Math.min(Vn,un[1]),bn=Math.max(bn,un[0]),fi=Math.max(fi,un[1]);bn>=pt.x&&zr<=It.x&&fi>=pt.y&&Vn<=It.y&&(Br=[qr.map(un=>new s.P(un[0],un[1]))],(zr<pt.x||bn>It.x||Vn<pt.y||fi>It.y)&&(Br=s.bu(Br,pt.x,pt.y,It.x,It.y)))}for(const zr of Br){Kt.reset(zr,.25*Et);let bn=0;bn=Kt.length<=.5*Et?1:Math.ceil(Kt.paddedLength/Er)+1;for(let Vn=0;Vn<bn;Vn++){const fi=Vn/Math.max(bn-1,1),un=Kt.lerp(fi),ki=un.x+ca,Zr=un.y+ca;he.push(ki,Zr,Et,0);const xr=ki-Et,Nn=Zr-Et,Jn=ki+Et,On=Zr+Et;if(_t=_t&&this.isOffscreen(xr,Nn,Jn,On),Ct=Ct||this.isInsideGrid(xr,Nn,Jn,On),!h&&this.grid.hitTestCircle(ki,Zr,Et,Q)&&(rt=!0,!Y))return{circles:[],offscreen:!1,collisionDetected:rt,occluded:!1}}}}return{circles:!Y&&rt||!Ct?[]:he,offscreen:_t,collisionDetected:rt,occluded:He.occluded}}queryRenderedSymbols(c){if(c.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const h=[];let v=1/0,N=1/0,A=-1/0,k=-1/0;for(const Y of c){const ee=new s.P(Y.x+ca,Y.y+ca);v=Math.min(v,ee.x),N=Math.min(N,ee.y),A=Math.max(A,ee.x),k=Math.max(k,ee.y),h.push(ee)}const z=this.grid.query(v,N,A,k).concat(this.ignoredGrid.query(v,N,A,k)),q={},K={};for(const Y of z){const ee=Y.key;if(q[ee.bucketInstanceId]===void 0&&(q[ee.bucketInstanceId]={}),q[ee.bucketInstanceId][ee.featureIndex])continue;const Q=[new s.P(Y.x1,Y.y1),new s.P(Y.x2,Y.y1),new s.P(Y.x2,Y.y2),new s.P(Y.x1,Y.y2)];s.bv(h,Q)&&(q[ee.bucketInstanceId][ee.featureIndex]=!0,K[ee.bucketInstanceId]===void 0&&(K[ee.bucketInstanceId]=[]),K[ee.bucketInstanceId].push(ee.featureIndex))}return K}insertCollisionBox(c,h,v,N,A){(h?this.ignoredGrid:this.grid).insert({bucketInstanceId:v,featureIndex:N,collisionGroupID:A},c[0],c[1],c[2],c[3])}insertCollisionCircles(c,h,v,N,A){const k=h?this.ignoredGrid:this.grid,z={bucketInstanceId:v,featureIndex:N,collisionGroupID:A};for(let q=0;q<c.length;q+=4)k.insertCircle(z,c[q],c[q+1],c[q+2])}projectAndGetPerspectiveRatio(c,h,v,N,A,k,z){const q=[h,v,N,1];let K=!1;N||this.transform.pitch>0?(s.ad.vec4.transformMat4(q,q,c),this.fogState&&A&&z.name!=="globe"&&(K=function(Q,ie,de,le,he,fe){const Te=fe.calculateFogTileMatrix(he),Re=[ie,de,le];return s.ad.vec3.transformMat4(Re,Re,Te),or(Q,s.ad.vec3.length(Re),fe.pitch,fe._fov)}(this.fogState,h,v,N,A.toUnwrapped(),this.transform)>.9)):Es(q,q,c);const Y=q[3];return{point:new s.P((q[0]/Y+1)/2*this.transform.width+ca,(-q[1]/Y+1)/2*this.transform.height+ca),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(z)/Y*.5,1.5),signedDistanceFromCamera:Y,occluded:k&&q[2]>Y||K}}isOffscreen(c,h,v,N){return v<ca||c>=this.screenRightBoundary||N<ca||h>this.screenBottomBoundary}isInsideGrid(c,h,v,N){return v>=0&&c<this.gridRightBoundary&&N>=0&&h<this.gridBottomBoundary}getViewportMatrix(){const c=s.ad.mat4.identity([]);return s.ad.mat4.translate(c,c,[-100,-100,0]),c}}function ps(b,c,h){const v=c.createTileMatrix(b,b.worldSize,h.toUnwrapped());return s.ad.mat4.multiply(new Float32Array(16),b.projMatrix,v)}function Y_(b,c,h){if(c.projection.name===h.projection.name)return b.projMatrix;const v=h.clone();return v.setProjection(c.projection),ps(v,c.getProjection(),b)}function al(b,c,h){return c.name===h.projection.name?b.projMatrix:ps(h,c,b)}class Jm{constructor(c,h,v,N){this.opacity=c?Math.max(0,Math.min(1,c.opacity+(c.placed?h:-h))):N&&v?1:0,this.placed=v}isHidden(){return this.opacity===0&&!this.placed}}class Id{constructor(c,h,v,N,A,k=!1){this.text=new Jm(c?c.text:null,h,v,A),this.icon=new Jm(c?c.icon:null,h,N,A),this.clipped=k}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Mu{constructor(c,h,v,N=!1){this.text=c,this.icon=h,this.skipFade=v,this.clipped=N}}class R3{constructor(){this.invProjMatrix=s.ad.mat4.create(),this.viewportMatrix=s.ad.mat4.create(),this.circles=[]}}class Iu{constructor(c,h,v,N,A){this.bucketInstanceId=c,this.featureIndex=h,this.sourceLayerIndex=v,this.bucketIndex=N,this.tileID=A}}class D3{constructor(c){this.crossSourceCollisions=c,this.maxGroupID=0,this.collisionGroups={}}get(c){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[c]){const h=++this.maxGroupID;this.collisionGroups[c]={ID:h,predicate:v=>v.collisionGroupID===h}}return this.collisionGroups[c]}}function Rx(b,c,h,v,N){const{horizontalAlign:A,verticalAlign:k}=s.bD(b),z=-(A-.5)*c,q=-(k-.5)*h,K=s.bC(b,v);return new s.P(z+K[0]*N,q+K[1]*N)}function ao(b,c,h,v,N){const A=new s.P(b,c);return h&&A._rotate(v?N:-N),A}class z3{constructor(c,h,v,N,A,k){this.transform=c.clone(),this.projection=c.projection.name,this.collisionIndex=new Eu(this.transform,A),this.buildingIndex=k,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=h,this.retainedQueryData={},this.collisionGroups=new D3(v),this.collisionCircleArrays={},this.prevPlacement=N,N&&(N.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(c,h,v,N,A=1){const k=v.getBucket(h),z=v.latestFeatureIndex;if(!k||!z||h.fqid!==k.layerIds[0])return;const q=k.layers[0].layout,K=k.layers[0].paint,Y=v.collisionBoxArray,ee=Math.pow(2,this.transform.zoom-v.tileID.overscaledZ),Q=v.tileSize/s.ai,ie=v.tileID.toUnwrapped();this.transform.setProjection(k.projection);const de=(le=v.tileID,he=k.getProjection(),fe=this.transform,he.name===this.projection?fe.calculateProjMatrix(le.toUnwrapped()):ps(fe,he,le));var le,he,fe;const Te=q.get("text-pitch-alignment")==="map",Re=q.get("text-rotation-alignment")==="map";h.compileFilter(h.options);const Oe=h.dynamicFilter(),$e=h.dynamicFilterNeedsFeature(),Le=this.transform.calculatePixelsToTileUnitsMatrix(v),Fe=Aa(de,v.tileID.canonical,Te,Re,this.transform,k.getProjection(),Le);let Be=null;if(Te){const At=us(de,v.tileID.canonical,Te,Re,this.transform,k.getProjection(),Le);Be=s.ad.mat4.multiply([],this.transform.labelPlaneMatrix,At)}let He=null;Oe&&v.latestFeatureIndex&&(He={unwrappedTileID:ie,dynamicFilter:Oe,dynamicFilterNeedsFeature:$e}),this.retainedQueryData[k.bucketInstanceId]=new Iu(k.bucketInstanceId,z,k.sourceLayerIndex,k.index,v.tileID);const[Ke,ft]=k.layers[0].layout.get("text-size-scale-range"),at=s.ay(A,Ke,ft),[kt,Pt]=q.get("icon-size-scale-range"),Bt=s.ay(A,kt,Pt),st={bucket:k,layout:q,paint:K,posMatrix:de,textLabelPlaneMatrix:Fe,labelToScreenMatrix:Be,clippingData:He,scale:ee,textPixelRatio:Q,holdingForFade:v.holdingForFade(),collisionBoxArray:Y,partiallyEvaluatedTextSize:s.bp(k.textSizeData,this.transform.zoom,at),partiallyEvaluatedIconSize:s.bp(k.iconSizeData,this.transform.zoom,Bt),collisionGroup:this.collisionGroups.get(k.sourceID),latestFeatureIndex:v.latestFeatureIndex};if(N)for(const At of k.sortKeyRanges){const{sortKey:rt,symbolInstanceStart:Ct,symbolInstanceEnd:_t}=At;c.push({sortKey:rt,symbolInstanceStart:Ct,symbolInstanceEnd:_t,parameters:st})}else c.push({symbolInstanceStart:0,symbolInstanceEnd:k.symbolInstances.length,parameters:st})}attemptAnchorPlacement(c,h,v,N,A,k,z,q,K,Y,ee,Q,ie,de,le,he,fe,Te){const{textOffset0:Re,textOffset1:Oe,crossTileID:$e}=Q,Le=[Re,Oe],Fe=Rx(c,v,N,Le,A),Be=this.collisionIndex.placeCollisionBox(de,A,h,ao(Fe.x,Fe.y,k,z,this.transform.angle),ee,q,K,Y.predicate);if(he){const He=de.getSymbolInstanceIconSize(Te,this.transform.zoom,Q.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(de,He,he,ao(Fe.x,Fe.y,k,z,this.transform.angle),ee,q,K,Y.predicate).box.length===0)return}if(Be.box.length>0){let He;return this.prevPlacement&&this.prevPlacement.variableOffsets[$e]&&this.prevPlacement.placements[$e]&&this.prevPlacement.placements[$e].text&&(He=this.prevPlacement.variableOffsets[$e].anchor),this.variableOffsets[$e]={textOffset:Le,width:v,height:N,anchor:c,textScale:A,prevAnchor:He},this.markUsedJustification(de,c,Q,le),de.allowVerticalPlacement&&(this.markUsedOrientation(de,le,Q),this.placedOrientations[$e]=le),{shift:Fe,placedGlyphBoxes:Be}}}placeLayerBucketPart(c,h,v,N,A=1){const{bucket:k,layout:z,paint:q,posMatrix:K,textLabelPlaneMatrix:Y,labelToScreenMatrix:ee,clippingData:Q,textPixelRatio:ie,holdingForFade:de,collisionBoxArray:le,partiallyEvaluatedTextSize:he,partiallyEvaluatedIconSize:fe,collisionGroup:Te,latestFeatureIndex:Re}=c.parameters,Oe=z.get("text-optional"),$e=z.get("icon-optional"),Le=z.get("text-allow-overlap"),Fe=z.get("icon-allow-overlap"),Be=z.get("text-rotation-alignment")==="map",He=z.get("text-pitch-alignment")==="map",Ke=q.get("symbol-z-offset"),ft=z.get("symbol-elevation-reference")==="sea",[at,kt]=z.get("text-size-scale-range"),[Pt,Bt]=z.get("icon-size-scale-range"),st=s.ay(A,at,kt),At=s.ay(A,Pt,Bt);this.transform.setProjection(k.projection);let rt=Le&&(Fe||!k.hasIconData()||$e),Ct=Fe&&(Le||!k.hasTextData()||Oe);const _t=!Ke.isConstant();!k.collisionArrays&&le&&k.deserializeCollisionBoxes(le),v&&N&&k.updateCollisionDebugBuffers(this.transform.zoom,le,st,At);const Et=(pt,It,Kt)=>{const{crossTileID:Zt,numVerticalGlyphVertices:Qt}=pt;let gr=null;if(Q&&Q.dynamicFilterNeedsFeature||_t){const Pn=this.retainedQueryData[k.bucketInstanceId];gr=Re.loadFeature({featureIndex:pt.featureIndex,bucketIndex:Pn.bucketIndex,sourceLayerIndex:Pn.sourceLayerIndex,layoutVertexArrayOffset:0})}if(Q&&!(0,Q.dynamicFilter)({zoom:this.transform.zoom,pitch:this.transform.pitch},gr,this.retainedQueryData[k.bucketInstanceId].tileID.canonical,new s.P(pt.tileAnchorX,pt.tileAnchorY),this.transform.calculateDistanceTileData(Q.unwrappedTileID)))return this.placements[Zt]=new Mu(!1,!1,!1,!0),void h.add(Zt);const qr=Ke.evaluate(gr,{});if(h.has(Zt))return;if(de)return void(this.placements[Zt]=new Mu(!1,!1,!1));let Er=!1,Br=!1,zr=!0,bn=!1,Vn=!1,fi=null,un={box:null,offscreen:null,occluded:null},ki={box:null,offscreen:null,occluded:null},Zr=null,xr=null,Nn=null,Jn=0,On=0,es=0;Kt.textFeatureIndex?Jn=Kt.textFeatureIndex:pt.useRuntimeCollisionCircles&&(Jn=pt.featureIndex),Kt.verticalTextFeatureIndex&&(On=Kt.verticalTextFeatureIndex);const js=Pn=>{Pn.tileID=this.retainedQueryData[k.bucketInstanceId].tileID;const Pi=this.transform.elevation;Pn.elevation=ft?qr:qr+(Pi?Pi.getAtTileOffset(Pn.tileID,Pn.tileAnchorX,Pn.tileAnchorY):0),Pn.elevation+=pt.zOffset},Gs=Kt.textBox;if(Gs){js(Gs);const Pn=Un=>{let oi=s.bq.horizontal;if(k.allowVerticalPlacement&&!Un&&this.prevPlacement){const _a=this.prevPlacement.placedOrientations[Zt];_a&&(this.placedOrientations[Zt]=_a,oi=_a,this.markUsedOrientation(k,oi,pt))}return oi},Pi=(Un,oi)=>{if(k.allowVerticalPlacement&&Qt>0&&Kt.verticalTextBox){for(const _a of k.writingModes)if(_a===s.bq.vertical?(un=oi(),ki=un):un=Un(),un&&un.box&&un.box.length)break}else un=Un()};if(z.get("text-variable-anchor")){let Un=z.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[Zt]){const ji=this.prevPlacement.variableOffsets[Zt];Un.indexOf(ji.anchor)>0&&(Un=Un.filter(Hs=>Hs!==ji.anchor),Un.unshift(ji.anchor))}const oi=(ji,Hs,tu)=>{const Fo=k.getSymbolInstanceTextSize(he,pt,this.transform.zoom,It),Vl=(ji.x2-ji.x1)*Fo+2*ji.padding,_o=(ji.y2-ji.y1)*Fo+2*ji.padding,Ul=pt.hasIconTextFit&&!Fe?Hs:null;Ul&&js(Ul);let Bo={box:[],offscreen:!1,occluded:!1};const Uu=Le?2*Un.length:Un.length;for(let ru=0;ru<Uu;++ru){const Gu=this.attemptAnchorPlacement(Un[ru%Un.length],ji,Vl,_o,Fo,Be,He,ie,K,Te,ru>=Un.length,pt,It,k,tu,Ul,he,fe);if(Gu&&(Bo=Gu.placedGlyphBoxes,Bo&&Bo.box&&Bo.box.length)){Er=!0,fi=Gu.shift;break}}return Bo};Pi(()=>oi(Gs,Kt.iconBox,s.bq.horizontal),()=>{const ji=Kt.verticalTextBox;return ji&&js(ji),k.allowVerticalPlacement&&!(un&&un.box&&un.box.length)&&Qt>0&&ji?oi(ji,Kt.verticalIconBox,s.bq.vertical):{box:null,offscreen:null,occluded:null}}),un&&(Er=un.box,zr=un.offscreen,bn=un.occluded);const _a=Pn(!(!un||!un.box));if(!Er&&this.prevPlacement){const ji=this.prevPlacement.variableOffsets[Zt];ji&&(this.variableOffsets[Zt]=ji,this.markUsedJustification(k,ji.anchor,pt,_a))}}else{const Un=(oi,_a)=>{const ji=k.getSymbolInstanceTextSize(he,pt,this.transform.zoom,It,A),Hs=this.collisionIndex.placeCollisionBox(k,ji,oi,new s.P(0,0),Le,ie,K,Te.predicate);return Hs&&Hs.box&&Hs.box.length&&(this.markUsedOrientation(k,_a,pt),this.placedOrientations[Zt]=_a),Hs};Pi(()=>Un(Gs,s.bq.horizontal),()=>{const oi=Kt.verticalTextBox;return k.allowVerticalPlacement&&Qt>0&&oi?(js(oi),Un(oi,s.bq.vertical)):{box:null,offscreen:null,occluded:null}}),Pn(!!(un&&un.box&&un.box.length))}}if(Zr=un,Er=Zr&&Zr.box&&Zr.box.length>0,zr=Zr&&Zr.offscreen,bn=Zr&&Zr.occluded,pt.useRuntimeCollisionCircles){const Pn=k.text.placedSymbolArray.get(pt.centerJustifiedTextSymbolIndex>=0?pt.centerJustifiedTextSymbolIndex:pt.verticalPlacedTextSymbolIndex),Pi=s.br(k.textSizeData,he,Pn),Un=z.get("text-padding");xr=this.collisionIndex.placeCollisionCircles(k,Le,Pn,k.lineVertexArray,k.glyphOffsetArray,Pi,K,Y,ee,v,He,Te.predicate,pt.collisionCircleDiameter*Pi/s.bw,Un,this.retainedQueryData[k.bucketInstanceId].tileID),Er=Le||xr.circles.length>0&&!xr.collisionDetected,zr=zr&&xr.offscreen,bn=xr.occluded}if(Kt.iconFeatureIndex&&(es=Kt.iconFeatureIndex),Kt.iconBox){const Pn=Pi=>{js(Pi);const Un=pt.hasIconTextFit&&fi?ao(fi.x,fi.y,Be,He,this.transform.angle):new s.P(0,0),oi=k.getSymbolInstanceIconSize(fe,this.transform.zoom,pt.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(k,oi,Pi,Un,Fe,ie,K,Te.predicate)};ki&&ki.box&&ki.box.length&&Kt.verticalIconBox?(Nn=Pn(Kt.verticalIconBox),Br=Nn.box.length>0):(Nn=Pn(Kt.iconBox),Br=Nn.box.length>0),zr=zr&&Nn.offscreen,Vn=Nn.occluded}const Qs=Oe||pt.numHorizontalGlyphVertices===0&&Qt===0,dl=$e||pt.numIconVertices===0;if(Qs||dl?dl?Qs||(Br=Br&&Er):Er=Br&&Er:Br=Er=Br&&Er,Er&&Zr&&Zr.box&&this.collisionIndex.insertCollisionBox(Zr.box,z.get("text-ignore-placement"),k.bucketInstanceId,ki&&ki.box&&On?On:Jn,Te.ID),Br&&Nn&&this.collisionIndex.insertCollisionBox(Nn.box,z.get("icon-ignore-placement"),k.bucketInstanceId,es,Te.ID),xr&&(Er&&this.collisionIndex.insertCollisionCircles(xr.circles,z.get("text-ignore-placement"),k.bucketInstanceId,Jn,Te.ID),v)){const Pn=k.bucketInstanceId;let Pi=this.collisionCircleArrays[Pn];Pi===void 0&&(Pi=this.collisionCircleArrays[Pn]=new R3);for(let Un=0;Un<xr.circles.length;Un+=4)Pi.circles.push(xr.circles[Un+0]),Pi.circles.push(xr.circles[Un+1]),Pi.circles.push(xr.circles[Un+2]),Pi.circles.push(xr.collisionDetected?1:0)}const Wa=k.projection.name!=="globe";rt=rt&&(Wa||!bn),Ct=Ct&&(Wa||!Vn),this.placements[Zt]=new Mu(Er||rt,Br||Ct,zr||k.justReloaded),h.add(Zt)};if(k.elevationType==="offset"&&this.buildingIndex&&this.buildingIndex.updateZOffset(k,this.retainedQueryData[k.bucketInstanceId].tileID),k.elevationType==="road"&&k.updateRoadElevation(),k.updateZOffset(),k.sortFeaturesByY){const pt=k.getSortedSymbolIndexes(this.transform.angle);for(let It=pt.length-1;It>=0;--It){const Kt=pt[It];Et(k.symbolInstances.get(Kt),Kt,k.collisionArrays[Kt])}k.hasAnyZOffset&&s.w(`${k.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(k.hasAnyZOffset){const pt=k.getSortedIndexesByZOffset();for(let It=0;It<pt.length;++It){const Kt=pt[It];Et(k.symbolInstances.get(Kt),Kt,k.collisionArrays[Kt])}}else for(let pt=c.symbolInstanceStart;pt<c.symbolInstanceEnd;pt++)Et(k.symbolInstances.get(pt),pt,k.collisionArrays[pt]);if(v&&k.bucketInstanceId in this.collisionCircleArrays){const pt=this.collisionCircleArrays[k.bucketInstanceId];s.ad.mat4.invert(pt.invProjMatrix,K),pt.viewportMatrix=this.collisionIndex.getViewportMatrix()}k.justReloaded=!1}markUsedJustification(c,h,v,N){const{leftJustifiedTextSymbolIndex:A,centerJustifiedTextSymbolIndex:k,rightJustifiedTextSymbolIndex:z,verticalPlacedTextSymbolIndex:q,crossTileID:K}=v,Y=s.bB(h),ee=N===s.bq.vertical?q:Y==="left"?A:Y==="center"?k:Y==="right"?z:-1;A>=0&&(c.text.placedSymbolArray.get(A).crossTileID=ee>=0&&A!==ee?0:K),k>=0&&(c.text.placedSymbolArray.get(k).crossTileID=ee>=0&&k!==ee?0:K),z>=0&&(c.text.placedSymbolArray.get(z).crossTileID=ee>=0&&z!==ee?0:K),q>=0&&(c.text.placedSymbolArray.get(q).crossTileID=ee>=0&&q!==ee?0:K)}markUsedOrientation(c,h,v){const N=h===s.bq.horizontal||h===s.bq.horizontalOnly?h:0,A=h===s.bq.vertical?h:0,{leftJustifiedTextSymbolIndex:k,centerJustifiedTextSymbolIndex:z,rightJustifiedTextSymbolIndex:q,verticalPlacedTextSymbolIndex:K}=v,Y=c.text.placedSymbolArray;k>=0&&(Y.get(k).placedOrientation=N),z>=0&&(Y.get(z).placedOrientation=N),q>=0&&(Y.get(q).placedOrientation=N),K>=0&&(Y.get(K).placedOrientation=A)}commit(c){this.commitTime=c,this.zoomAtLastRecencyCheck=this.transform.zoom;const h=this.prevPlacement;let v=!1;this.prevZoomAdjustment=h?h.zoomAdjustment(this.transform.zoom):0;const N=h?h.symbolFadeChange(c):1,A=h?h.opacities:{},k=h?h.variableOffsets:{},z=h?h.placedOrientations:{};for(const q in this.placements){const K=this.placements[q],Y=A[q];Y?(this.opacities[q]=new Id(Y,N,K.text,K.icon,null,K.clipped),v=v||K.text!==Y.text.placed||K.icon!==Y.icon.placed):(this.opacities[q]=new Id(null,N,K.text,K.icon,K.skipFade,K.clipped),v=v||K.text||K.icon)}for(const q in A){const K=A[q];if(!this.opacities[q]){const Y=new Id(K,N,!1,!1);Y.isHidden()||(this.opacities[q]=Y,v=v||K.text.placed||K.icon.placed)}}for(const q in k)this.variableOffsets[q]||!this.opacities[q]||this.opacities[q].isHidden()||(this.variableOffsets[q]=k[q]);for(const q in z)this.placedOrientations[q]||!this.opacities[q]||this.opacities[q].isHidden()||(this.placedOrientations[q]=z[q]);v?this.lastPlacementChangeTime=c:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=h?h.lastPlacementChangeTime:c)}updateLayerOpacities(c,h,v,N){const A=new Set;for(const k of h){const z=k.getBucket(c);z&&k.latestFeatureIndex&&c.fqid===z.layerIds[0]&&(this.updateBucketOpacities(z,A,k,k.collisionBoxArray,v,N,k.tileID,c.scope),z.elevationType==="offset"&&this.buildingIndex&&this.buildingIndex.updateZOffset(z,k.tileID),z.elevationType==="road"&&z.updateRoadElevation(),z.updateZOffset())}}updateBucketOpacities(c,h,v,N,A,k,z,q){c.hasTextData()&&c.text.opacityVertexArray.clear(),c.hasIconData()&&c.icon.opacityVertexArray.clear(),c.hasIconCollisionBoxData()&&c.iconCollisionBox.collisionVertexArray.clear(),c.hasTextCollisionBoxData()&&c.textCollisionBox.collisionVertexArray.clear();const K=c.layers[0].layout,Y=c.layers[0].paint,ee=!!c.layers[0].dynamicFilter(),Q=new Id(null,0,!1,!1,!0),ie=K.get("text-allow-overlap"),de=K.get("icon-allow-overlap"),le=K.get("text-variable-anchor"),he=K.get("text-rotation-alignment")==="map",fe=K.get("text-pitch-alignment")==="map",Te=Y.get("symbol-z-offset"),Re=K.get("symbol-elevation-reference")==="sea",Oe=!Te.isConstant(),$e=new Id(null,0,ie&&(de||!c.hasIconData()||K.get("icon-optional")),de&&(ie||!c.hasTextData()||K.get("text-optional")),!0);!c.collisionArrays&&N&&(c.hasIconCollisionBoxData()||c.hasTextCollisionBoxData())&&c.deserializeCollisionBoxes(N);const Le=(Be,He,Ke)=>{for(let ft=0;ft<He/4;ft++)Be.opacityVertexArray.emplaceBack(Ke)};let Fe=0;k&&c.updateReplacement(z,k);for(let Be=0;Be<c.symbolInstances.length;Be++){const He=c.symbolInstances.get(Be),{numHorizontalGlyphVertices:Ke,numVerticalGlyphVertices:ft,crossTileID:at,numIconVertices:kt,tileAnchorX:Pt,tileAnchorY:Bt}=He;let st=null;const At=this.retainedQueryData[c.bucketInstanceId];Oe&&He&&At&&(st=v.latestFeatureIndex.loadFeature({featureIndex:He.featureIndex,bucketIndex:At.bucketIndex,sourceLayerIndex:At.sourceLayerIndex,layoutVertexArrayOffset:0}));const rt=Te.evaluate(st,{}),Ct=h.has(at);let _t=this.opacities[at];Ct?_t=Q:_t||(_t=$e,this.opacities[at]=_t),h.add(at);const Et=Ke>0||ft>0,pt=kt>0,It=this.placedOrientations[at],Kt=It===s.bq.vertical,Zt=It===s.bq.horizontal||It===s.bq.horizontalOnly;!Et&&!pt||_t.isHidden()||Fe++;let Qt=!1;if((Et||pt)&&k)for(const gr of c.activeReplacements){if(s.bx(gr,A,s.by.Symbol,q)||gr.min.x>Pt||Pt>gr.max.x||gr.min.y>Bt||Bt>gr.max.y)continue;const qr=s.bz(Pt,Bt,z.canonical,gr.footprintTileId.canonical);if(Qt=s.bA(qr,gr.footprint),Qt)break}if(Et){const gr=Qt?Lh:zh(_t.text);Le(c.text,Ke,Kt?Lh:gr),Le(c.text,ft,Zt?Lh:gr);const qr=_t.text.isHidden(),{leftJustifiedTextSymbolIndex:Er,centerJustifiedTextSymbolIndex:Br,rightJustifiedTextSymbolIndex:zr,verticalPlacedTextSymbolIndex:bn}=He,Vn=c.text.placedSymbolArray,fi=qr||Kt?1:0;Er>=0&&(Vn.get(Er).hidden=fi),Br>=0&&(Vn.get(Br).hidden=fi),zr>=0&&(Vn.get(zr).hidden=fi),bn>=0&&(Vn.get(bn).hidden=qr||Zt?1:0);const un=this.variableOffsets[at];un&&this.markUsedJustification(c,un.anchor,He,It);const ki=this.placedOrientations[at];ki&&(this.markUsedJustification(c,"left",He,ki),this.markUsedOrientation(c,ki,He))}if(pt){const gr=Qt?Lh:zh(_t.icon),{placedIconSymbolIndex:qr,verticalPlacedIconSymbolIndex:Er}=He,Br=c.icon.placedSymbolArray,zr=_t.icon.isHidden()?1:0;qr>=0&&(Le(c.icon,kt,Kt?Lh:gr),Br.get(qr).hidden=zr),Er>=0&&(Le(c.icon,He.numVerticalIconVertices,Zt?Lh:gr),Br.get(Er).hidden=zr)}if(c.hasIconCollisionBoxData()||c.hasTextCollisionBoxData()){const gr=c.collisionArrays[Be];if(gr){let qr=new s.P(0,0),Er=!0;if(gr.textBox||gr.verticalTextBox){if(le){const zr=this.variableOffsets[at];zr?(qr=Rx(zr.anchor,zr.width,zr.height,zr.textOffset,zr.textScale),he&&qr._rotate(fe?this.transform.angle:-this.transform.angle)):Er=!1}ee&&(Er=!_t.clipped),gr.textBox&&Dh(c.textCollisionBox.collisionVertexArray,_t.text.placed,!Er||Kt,rt,Re,qr.x,qr.y),gr.verticalTextBox&&Dh(c.textCollisionBox.collisionVertexArray,_t.text.placed,!Er||Zt,rt,Re,qr.x,qr.y)}const Br=Er&&!!(!Zt&&gr.verticalIconBox);gr.iconBox&&Dh(c.iconCollisionBox.collisionVertexArray,_t.icon.placed,Br,rt,Re,He.hasIconTextFit?qr.x:0,He.hasIconTextFit?qr.y:0),gr.verticalIconBox&&Dh(c.iconCollisionBox.collisionVertexArray,_t.icon.placed,!Br,rt,Re,He.hasIconTextFit?qr.x:0,He.hasIconTextFit?qr.y:0)}}}if(c.fullyClipped=Fe===0,c.sortFeatures(this.transform.angle),this.retainedQueryData[c.bucketInstanceId]&&(this.retainedQueryData[c.bucketInstanceId].featureSortOrder=c.featureSortOrder),c.hasTextData()&&c.text.opacityVertexBuffer&&c.text.opacityVertexBuffer.updateData(c.text.opacityVertexArray),c.hasIconData()&&c.icon.opacityVertexBuffer&&c.icon.opacityVertexBuffer.updateData(c.icon.opacityVertexArray),c.hasIconCollisionBoxData()&&c.iconCollisionBox.collisionVertexBuffer&&c.iconCollisionBox.collisionVertexBuffer.updateData(c.iconCollisionBox.collisionVertexArray),c.hasTextCollisionBoxData()&&c.textCollisionBox.collisionVertexBuffer&&c.textCollisionBox.collisionVertexBuffer.updateData(c.textCollisionBox.collisionVertexArray),c.bucketInstanceId in this.collisionCircleArrays){const Be=this.collisionCircleArrays[c.bucketInstanceId];c.placementInvProjMatrix=Be.invProjMatrix,c.placementViewportMatrix=Be.viewportMatrix,c.collisionCircleArray=Be.circles,delete this.collisionCircleArrays[c.bucketInstanceId]}}symbolFadeChange(c){return this.fadeDuration===0?1:(c-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(c){return Math.max(0,(this.transform.zoom-c)/1.5)}hasTransitions(c){return this.stale||c-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(c,h){const v=this.zoomAtLastRecencyCheck===h?1-this.zoomAdjustment(h):1;return this.zoomAtLastRecencyCheck=h,this.commitTime+this.fadeDuration*v>c}setStale(){this.stale=!0}}function Dh(b,c,h,v,N,A,k){b.emplaceBack(c?1:0,h?1:0,A||0,k||0,v,N?1:0),b.emplaceBack(c?1:0,h?1:0,A||0,k||0,v,N?1:0),b.emplaceBack(c?1:0,h?1:0,A||0,k||0,v,N?1:0),b.emplaceBack(c?1:0,h?1:0,A||0,k||0,v,N?1:0)}const PS=Math.pow(2,25),jg=Math.pow(2,24),L3=Math.pow(2,17),F3=Math.pow(2,16),Ng=Math.pow(2,9),Sg=Math.pow(2,8),B3=Math.pow(2,1);function zh(b){if(b.opacity===0&&!b.placed)return 0;if(b.opacity===1&&b.placed)return 4294967295;const c=b.placed?1:0,h=Math.floor(127*b.opacity);return h*PS+c*jg+h*L3+c*F3+h*Ng+c*Sg+h*B3+c}const Lh=0;class Dx{constructor(c){this._sortAcrossTiles=c.layout.get("symbol-z-order")!=="viewport-y"&&c.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(c,h,v,N,A,k){const z=this._bucketParts;for(;this._currentTileIndex<c.length;)if(h.getBucketParts(z,N,c[this._currentTileIndex],this._sortAcrossTiles,k),this._currentTileIndex++,A())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,z.sort((q,K)=>q.sortKey-K.sortKey));this._currentPartIndex<z.length;){const q=z[this._currentPartIndex];if(h.placeLayerBucketPart(q,this._seenCrossTileIDs,v,q.symbolInstanceStart===0,k),this._currentPartIndex++,A())return!0}return!1}}class Od{constructor(c,h,v,N,A,k,z,q,K){this.placement=new z3(c,A,k,z,q,K),this._currentPlacementIndex=h.length-1,this._forceFullPlacement=v,this._showCollisionBoxes=N,this._done=!1}isDone(){return this._done}continuePlacement(c,h,v,N,A){const k=s.q.now(),z=()=>{const q=s.q.now()-k;return!this._forceFullPlacement&&q>2};for(;this._currentPlacementIndex>=0;){const q=h[c[this._currentPlacementIndex]],K=this.placement.collisionIndex.transform.zoom;if(q.type==="symbol"&&(!q.minzoom||q.minzoom<=K)&&(!q.maxzoom||q.maxzoom>K)){const Y=q,ee=Y.layout.get("symbol-z-elevate"),Q=Y.layout.get("symbol-sort-key").constantOr(1)!==void 0,ie=Y.layout.get("symbol-z-order"),de=ie==="viewport-y"||ie==="auto"&&!(ie!=="viewport-y"&&Q),le=Y.layout.get("text-allow-overlap")||Y.layout.get("icon-allow-overlap")||Y.layout.get("text-ignore-placement")||Y.layout.get("icon-ignore-placement"),he=de&&le,fe=this._inProgressLayer=this._inProgressLayer||new Dx(Y),Te=s.C(q.source,q.scope);if(fe.continuePlacement(ee||he?N[Te]:v[Te],this.placement,this._showCollisionBoxes,q,z,A))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(c){return this.placement.commit(c),this.placement}}const X_=512/s.ai/2;class $3{constructor(c,h,v){this.tileID=c,this.bucketInstanceId=v,this.index=new s.bE(h.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const N=c.canonical.x*s.ai,A=c.canonical.y*s.ai;for(let k=0;k<h.length;k++){const{key:z,crossTileID:q,tileAnchorX:K,tileAnchorY:Y}=h.get(k),ee=Math.floor((N+K)*X_),Q=Math.floor((A+Y)*X_);this.index.add(ee,Q),this.keys.push(z),this.crossTileIDs.push(q)}this.index.finish()}findMatches(c,h,v){const N=this.tileID.canonical.z<h.canonical.z?1:Math.pow(2,this.tileID.canonical.z-h.canonical.z),A=X_/Math.pow(2,h.canonical.z-this.tileID.canonical.z),k=h.canonical.x*s.ai,z=h.canonical.y*s.ai;for(let q=0;q<c.length;q++){const K=c.get(q);if(K.crossTileID)continue;const{key:Y,tileAnchorX:ee,tileAnchorY:Q}=K,ie=Math.floor((k+ee)*A),de=Math.floor((z+Q)*A),le=this.index.range(ie-N,de-N,ie+N,de+N);for(const he of le){const fe=this.crossTileIDs[he];if(this.keys[he]===Y&&!v.has(fe)){v.add(fe),K.crossTileID=fe;break}}}}}class V3{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class ES{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(c){const h=Math.round((c-this.lng)/360);if(h!==0)for(const v in this.indexes){const N=this.indexes[v],A={};for(const k in N){const z=N[k];z.tileID=z.tileID.unwrapTo(z.tileID.wrap+h),A[z.tileID.key]=z}this.indexes[v]=A}this.lng=c}addBucket(c,h,v){if(this.indexes[c.overscaledZ]&&this.indexes[c.overscaledZ][c.key]){if(this.indexes[c.overscaledZ][c.key].bucketInstanceId===h.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(c.overscaledZ,this.indexes[c.overscaledZ][c.key])}for(let A=0;A<h.symbolInstances.length;A++)h.symbolInstances.get(A).crossTileID=0;this.usedCrossTileIDs[c.overscaledZ]||(this.usedCrossTileIDs[c.overscaledZ]=new Set);const N=this.usedCrossTileIDs[c.overscaledZ];for(const A in this.indexes){const k=this.indexes[A];if(Number(A)>c.overscaledZ)for(const z in k){const q=k[z];q.tileID.isChildOf(c)&&q.findMatches(h.symbolInstances,c,N)}else{const z=k[c.scaledTo(Number(A)).key];z&&z.findMatches(h.symbolInstances,c,N)}}for(let A=0;A<h.symbolInstances.length;A++){const k=h.symbolInstances.get(A);k.crossTileID||(k.crossTileID=v.generate(),N.add(k.crossTileID))}return this.indexes[c.overscaledZ]===void 0&&(this.indexes[c.overscaledZ]={}),this.indexes[c.overscaledZ][c.key]=new $3(c,h.symbolInstances,h.bucketInstanceId),!0}removeBucketCrossTileIDs(c,h){for(const v of h.crossTileIDs)this.usedCrossTileIDs[c].delete(v)}removeStaleBuckets(c){let h=!1;for(const v in this.indexes){const N=this.indexes[v];for(const A in N)c[N[A].bucketInstanceId]||(this.removeBucketCrossTileIDs(v,N[A]),delete N[A],h=!0)}return h}}class U3{constructor(){this.layerIndexes={},this.crossTileIDs=new V3,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(c,h,v,N){let A=this.layerIndexes[c.fqid];A===void 0&&(A=this.layerIndexes[c.fqid]=new ES);let k=!1;const z={};N.name!=="globe"&&A.handleWrapJump(v);for(const q of h){const K=q.getBucket(c);K&&c.fqid===K.layerIds[0]&&(K.bucketInstanceId||(K.bucketInstanceId=++this.maxBucketInstanceId),A.addBucket(q.tileID,K,this.crossTileIDs)&&(k=!0),z[K.bucketInstanceId]=!0)}return A.removeStaleBuckets(z)&&(k=!0),k}pruneUnusedLayers(c){const h={};c.forEach(v=>{h[v]=!0});for(const v in this.layerIndexes)h[v]||delete this.layerIndexes[v]}}const Rd=771;class mn{constructor(c,h,v,N){this.blendFunction=c,this.blendColor=h,this.mask=v,this.blendEquation=N}}mn.Replace=[1,0,1,0],mn.disabled=new mn(mn.Replace,s.al.transparent,[!1,!1,!1,!1]),mn.unblended=new mn(mn.Replace,s.al.transparent,[!0,!0,!0,!0]),mn.alphaBlended=new mn([1,Rd,1,Rd],s.al.transparent,[!0,!0,!0,!0]),mn.alphaBlendedNonPremultiplied=new mn([770,Rd,770,Rd],s.al.transparent,[!0,!0,!0,!0]),mn.multiply=new mn([774,0,774,0],s.al.transparent,[!0,!0,!0,!0]);class Cr{constructor(c,h,v){this.func=c,this.mask=h,this.range=v}}Cr.ReadOnly=!1,Cr.ReadWrite=!0,Cr.disabled=new Cr(519,Cr.ReadOnly,[0,1]);const zx=7680;class Kr{constructor(c,h,v,N,A,k){this.test=c,this.ref=h,this.mask=v,this.fail=N,this.depthFail=A,this.pass=k}}Kr.disabled=new Kr({func:519,mask:0},0,0,zx,zx,zx);const Ou=1029,Qm=2305;class Gr{constructor(c,h,v){this.enable=c,this.mode=h,this.frontFace=v}}function J_(b,c){const h=s.bG(b,3);s.ad.mat4.fromQuat(b,c),s.bI(b,3,h)}function Fh(b,c){const h=s.ad.quat.identity([]);return s.ad.quat.rotateZ(h,h,-c),s.ad.quat.rotateX(h,h,-b),h}function ef(b,c){const h=[b[0],b[1],0],v=[c[0],c[1],0];if(s.ad.vec3.length(h)>=1e-15){const k=s.ad.vec3.normalize([],h);s.ad.vec3.scale(v,k,s.ad.vec3.dot(v,k)),c[0]=v[0],c[1]=v[1]}const N=s.ad.vec3.cross([],c,b);if(s.ad.vec3.len(N)<1e-15)return null;const A=Math.atan2(-N[1],N[0]);return Fh(Math.atan2(Math.sqrt(b[0]*b[0]+b[1]*b[1]),-b[2]),A)}Gr.disabled=new Gr(!1,Ou,Qm),Gr.backCCW=new Gr(!0,Ou,Qm),Gr.backCW=new Gr(!0,Ou,2304),Gr.frontCW=new Gr(!0,1028,2304),Gr.frontCCW=new Gr(!0,1028,Qm);class Q_{constructor(c,h){this.position=c,this.orientation=h}get position(){return this._position}set position(c){if(c){const h=c instanceof s.ac?c:new s.ac(c[0],c[1],c[2]);this._renderWorldCopies&&(h.x=s.bF(h.x,0,1)),this._position=h}else this._position=null}lookAtPoint(c,h){if(this.orientation=null,!this.position)return;const v=this.position,N=this._elevation?this._elevation.getAtPointOrZero(s.ac.fromLngLat(c)):0,A=s.ac.fromLngLat(c,N),k=[A.x-v.x,A.y-v.y,A.z-v.z];h||(h=[0,0,1]),h[2]=Math.abs(h[2]),this.orientation=ef(k,h)}setPitchBearing(c,h){this.orientation=Fh(s.ak(c),s.ak(-h))}}class tf{constructor(c,h){this._transform=s.ad.mat4.identity([]),this.orientation=h,this.position=c}get mercatorPosition(){const c=this.position;return new s.ac(c[0],c[1],c[2])}get position(){const c=s.bG(this._transform,3);return[c[0],c[1],c[2]]}set position(c){var h;c&&s.bI(this._transform,3,[(h=c)[0],h[1],h[2],1])}get orientation(){return this._orientation}set orientation(c){this._orientation=c||s.ad.quat.identity([]),c&&J_(this._transform,this._orientation)}getPitchBearing(){const c=this.forward(),h=this.right();return{bearing:Math.atan2(-h[1],h[0]),pitch:Math.atan2(Math.sqrt(c[0]*c[0]+c[1]*c[1]),-c[2])}}setPitchBearing(c,h){this._orientation=Fh(c,h),J_(this._transform,this._orientation)}forward(){const c=s.bG(this._transform,2);return[-c[0],-c[1],-c[2]]}up(){const c=s.bG(this._transform,1);return[-c[0],-c[1],-c[2]]}right(){const c=s.bG(this._transform,0);return[c[0],c[1],c[2]]}getCameraToWorld(c,h){const v=new Float64Array(16);return s.ad.mat4.invert(v,this.getWorldToCamera(c,h)),v}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(c,h,v){const N=this.position;s.ad.vec3.scale(N,N,-c);const A=new Float64Array(16);return s.ad.mat4.fromScaling(A,[v,v,v]),s.ad.mat4.translate(A,A,N),A[10]*=h,A}getWorldToCamera(c,h){const v=new Float64Array(16),N=new Float64Array(4),A=this.position;return s.ad.quat.conjugate(N,this._orientation),s.ad.vec3.scale(A,A,-c),s.ad.mat4.fromQuat(v,N),s.ad.mat4.translate(v,v,A),v[1]*=-1,v[5]*=-1,v[9]*=-1,v[13]*=-1,v[8]*=h,v[9]*=h,v[10]*=h,v[11]*=h,v}getCameraToClipPerspective(c,h,v,N){const A=new Float64Array(16);return s.ad.mat4.perspective(A,c,h,v,N),A}getCameraToClipOrthographic(c,h,v,N,A,k){const z=new Float64Array(16);return s.ad.mat4.ortho(z,c,h,v,N,A,k),z}getDistanceToElevation(c,h=!1){const v=c===0?0:s.bH(c,h?s.aT(this.position[1]):this.position[1]),N=this.forward();return(v-this.position[2])/N[2]}clone(){return new tf([...this.position],[...this.orientation])}}const ss={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,LUT:10,ShadowMap0:11};class Cg{constructor(c=0,h=0,v=0,N=0){if(isNaN(c)||c<0||isNaN(h)||h<0||isNaN(v)||v<0||isNaN(N)||N<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=c,this.bottom=h,this.left=v,this.right=N}interpolate(c,h,v){return h.top!=null&&c.top!=null&&(this.top=s.ah(c.top,h.top,v)),h.bottom!=null&&c.bottom!=null&&(this.bottom=s.ah(c.bottom,h.bottom,v)),h.left!=null&&c.left!=null&&(this.left=s.ah(c.left,h.left,v)),h.right!=null&&c.right!=null&&(this.right=s.ah(c.right,h.right,v)),this}getCenter(c,h){const v=s.ay((this.left+c-this.right)/2,0,c),N=s.ay((this.top+h-this.bottom)/2,0,h);return new s.P(v,N)}equals(c){return this.top===c.top&&this.bottom===c.bottom&&this.left===c.left&&this.right===c.right}clone(){return new Cg(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const Wt=15;class Lx{constructor(c,h,v,N,A,k,z){this.tileSize=512,this._renderWorldCopies=A===void 0||A,this._minZoom=c||0,this._maxZoom=h||22,this._minPitch=v??0,this._maxPitch=N??60,this.setProjection(k),this.setMaxBounds(z),this.width=0,this.height=0,this._center=new s.bO(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Cg,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._expandedProjMatrixCache={},this._distanceTileDataCache={},this._camera=new tf,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._tileCoverLift=0,this.freezeTileCoverage=!1,this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1,this._allowWorldUnderZoom=!1}clone(){const c=new Lx(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection(),this.maxBounds);return c._elevation=this._elevation,c._centerAltitude=this._centerAltitude,c._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,c.tileSize=this.tileSize,c.mercatorFromTransition=this.mercatorFromTransition,c.width=this.width,c.height=this.height,c.cameraElevationReference=this.cameraElevationReference,c._center=this._center,c._setZoom(this.zoom),c._seaLevelZoom=this._seaLevelZoom,c.angle=this.angle,c._fov=this._fov,c._pitch=this._pitch,c._nearZ=this._nearZ,c._farZ=this._farZ,c._averageElevation=this._averageElevation,c._orthographicProjectionAtLowPitch=this._orthographicProjectionAtLowPitch,c._unmodified=this._unmodified,c._edgeInsets=this._edgeInsets.clone(),c._camera=this._camera.clone(),c._calcMatrices(),c.freezeTileCoverage=this.freezeTileCoverage,c.frustumCorners=this.frustumCorners,c._allowWorldUnderZoom=this._allowWorldUnderZoom,c}get isOrthographic(){return this.projection.name!=="globe"&&this._orthographicProjectionAtLowPitch&&this.pitch<Wt}get elevation(){return this._elevation}set elevation(c){this._elevation!==c&&(this._elevation=c,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return this.projection.name!=="globe"&&!this.isOrthographic}updateElevation(c,h=!1){const v=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||v)&&this._updateCameraOnTerrain(),(c||v)&&this._constrainCamera(h),this._calcMatrices()}getProjection(){return s.aA(this.projection,["name","center","parallels"])}setProjection(c){this.projectionOptions=c||{name:"mercator"};const h=this.projection?this.getProjection():void 0;this.projection=s.bP(this.projectionOptions);const v=this.getProjection(),N=!s.bn(h,v);return N&&this._calcMatrices(),this.mercatorFromTransition=!1,N}setOrthographicProjectionAtLowPitch(c){return this._orthographicProjectionAtLowPitch!==c&&(this._orthographicProjectionAtLowPitch=c,this._calcMatrices(),!0)}setMercatorFromTransition(){const c=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=s.bP({name:"mercator"});const h=c!==this.projection.name;return h&&this._calcMatrices(),h}get minZoom(){return this._minZoom}set minZoom(c){this._minZoom!==c&&(this._minZoom=c,this.zoom=Math.max(this.zoom,c))}get maxZoom(){return this._maxZoom}set maxZoom(c){this._maxZoom!==c&&(this._maxZoom=c,this.zoom=Math.min(this.zoom,c))}get minPitch(){return this._minPitch}set minPitch(c){this._minPitch!==c&&(this._minPitch=c,this.pitch=Math.max(this.pitch,c))}get maxPitch(){return this._maxPitch}set maxPitch(c){this._maxPitch!==c&&(this._maxPitch=c,this.pitch=Math.min(this.pitch,c))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(c){c===void 0?c=!0:c===null&&(c=!1),this._renderWorldCopies=c}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const c=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(c))}get cameraWorldSize(){const c=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(c))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return s.bH(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new s.P(this.width,this.height)}get bearing(){return s.bF(this.rotation,-180,180)}set bearing(c){this.rotation=c}get rotation(){return-this.angle/Math.PI*180}set rotation(c){const h=-c*Math.PI/180;this.angle!==h&&(this._unmodified=!1,this.angle=h,this._calcMatrices(),this.rotationMatrix=s.ad.mat2.create(),s.ad.mat2.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(c){const h=s.ay(c,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==h&&(this._unmodified=!1,this._pitch=h,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}set fov(c){c=Math.max(.01,Math.min(60,c)),this._fov!==c&&(this._unmodified=!1,this._fov=s.ak(c),this._calcMatrices())}get fovX(){return this._fov}get fovY(){const c=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/c)}get averageElevation(){return this._averageElevation}set averageElevation(c){this._averageElevation=c,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(c){const h=Math.min(Math.max(c,this.minZoom),this.maxZoom);this._zoom!==h&&(this._unmodified=!1,this._setZoom(h),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(c){this._zoom=c,this.scale=this.zoomScale(c),this.tileZoom=Math.floor(c),this.zoomFraction=c-this.tileZoom}get tileCoverLift(){return this._tileCoverLift}set tileCoverLift(c){this._tileCoverLift!==c&&(this._tileCoverLift=c)}_updateCameraOnTerrain(){const c=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,h=this.elevation&&c===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||c===Number.NEGATIVE_INFINITY&&(!h||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const v=this._elevation;h||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&v.exaggeration()&&this._centerAltitudeValidForExaggeration!==v.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*v.exaggeration(),this._centerAltitudeValidForExaggeration=v.exaggeration()):(this._centerAltitude=c||0,this._centerAltitudeValidForExaggeration=v.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const c=this._elevation,h=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],v=this.horizonLineFromTop();let N=0,A=0;for(let k=0;k<h.length;k++){const z=new s.P(h[k][0]*this.width,v+h[k][1]*(this.height-v)),q=c.pointCoordinate(z);if(!q)continue;const K=1/Math.hypot(q[0]-this._camera.position[0],q[1]-this._camera.position[1]);N+=q[3]*K,A+=K}return A===0?NaN:N/A}get center(){return this._center}set center(c){c.lat===this._center.lat&&c.lng===this._center.lng||(this._unmodified=!1,this._center=c,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const c=this._seaLevelZoom,h=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),v=this.pixelsPerMeter/this.worldSize*h,N=this._mercatorZfromZoom(c),A=this._mercatorZfromZoom(this._maxZoom),k=Math.max(N-v,A);this._setZoom(this._zoomFromMercatorZ(k))}get padding(){return this._edgeInsets.toJSON()}set padding(c){this._edgeInsets.equals(c)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,c,1),this._calcMatrices())}computeZoomRelativeTo(c){const h=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,c.toAltitude()));let v;v=c.z<this._camera.position[2]?[h.x,h.y,h.z]:[c.x,c.y,c.z];const N=s.ad.vec3.length(s.ad.vec3.sub([],this._camera.position,v));return s.ay(this._zoomFromMercatorZ(N),this._minZoom,this._maxZoom)}setFreeCameraOptions(c){if(!this.height||!c.position&&!c.orientation)return;this._updateCameraState();let h=!1;if(c.orientation&&!s.ad.quat.exactEquals(c.orientation,this._camera.orientation)&&(h=this._setCameraOrientation(c.orientation)),c.position){const v=[c.position.x,c.position.y,c.position.z];s.ad.vec3.exactEquals(v,this._camera.position)||(this._setCameraPosition(v),h=!0)}h&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const c=this._camera.position,h=new Q_;return h.position=new s.ac(c[0],c[1],c[2]),h.orientation=this._camera.orientation,h._elevation=this.elevation,h._renderWorldCopies=this.renderWorldCopies,h}_setCameraOrientation(c){if(!s.ad.quat.length(c))return!1;s.ad.quat.normalize(c,c);const h=s.ad.vec3.transformQuat([],[0,0,-1],c),v=s.ad.vec3.transformQuat([],[0,-1,0],c);if(v[2]<0)return!1;const N=ef(h,v);return!!N&&(this._camera.orientation=N,!0)}_setCameraPosition(c){const h=this.zoomScale(this.minZoom)*this.tileSize,v=this.zoomScale(this.maxZoom)*this.tileSize,N=this.cameraToCenterDistance;c[2]=s.ay(c[2],N/v,N/h),this._camera.position=c}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(c){return this._edgeInsets.equals(c)}interpolatePadding(c,h,v){this._unmodified=!1,this._edgeInsets.interpolate(c,h,v),this._constrain(),this._calcMatrices()}coveringZoomLevel(c){const h=(c.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/c.tileSize));return Math.max(0,h)}getVisibleUnwrappedCoordinates(c){const h=[new s.bQ(0,c)];if(this.renderWorldCopies){const v=this.pointCoordinate(new s.P(0,0)),N=this.pointCoordinate(new s.P(this.width,0)),A=this.pointCoordinate(new s.P(this.width,this.height)),k=this.pointCoordinate(new s.P(0,this.height)),z=Math.floor(Math.min(v.x,N.x,A.x,k.x)),q=Math.floor(Math.max(v.x,N.x,A.x,k.x)),K=1;for(let Y=z-K;Y<=q+K;Y++)Y!==0&&h.push(new s.bQ(Y,c))}return h}isLODDisabled(c){return(!c||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCover(c,h,v){let N=[];const A=v!==void 0,k=!A;if(k&&this.zoom<h||A&&v[0]===0&&v[1]===0)return N;const z=new Set,q=(Y,ee,Q,ie,de)=>{const le=s.c5(ee,Y,Q,ie,de);z.has(le)||(N.push(new s.aH(Y,ee,Q,ie,de)),z.add(le))};for(let Y=0;Y<c.length;Y++){const ee=c[Y];if(k&&ee.canonical.z!==h)continue;const Q=ee.canonical,ie=ee.overscaledZ,de=ee.wrap,le=1<<Q.z,he=Q.x+1<le,fe=Q.x>0,Te=Q.y+1<le,Re=Q.y>0,Oe=ee.wrap-(fe?0:1),$e=ee.wrap+(he?0:1),Le=fe?Q.x-1:le-1,Fe=he?Q.x+1:0;if(A)v[0]<0?(q(ie,$e,Q.z,Fe,Q.y),v[1]<0&&Te&&(q(ie,de,Q.z,Q.x,Q.y+1),q(ie,$e,Q.z,Fe,Q.y+1)),v[1]>0&&Re&&(q(ie,de,Q.z,Q.x,Q.y-1),q(ie,$e,Q.z,Fe,Q.y-1))):v[0]>0?(q(ie,Oe,Q.z,Le,Q.y),v[1]<0&&Te&&(q(ie,de,Q.z,Q.x,Q.y+1),q(ie,Oe,Q.z,Le,Q.y+1)),v[1]>0&&Re&&(q(ie,de,Q.z,Q.x,Q.y-1),q(ie,Oe,Q.z,Le,Q.y-1))):v[1]<0&&Te?q(ie,de,Q.z,Q.x,Q.y+1):Re&&q(ie,de,Q.z,Q.x,Q.y-1);else{const Be=ee.visibleQuadrants;1&Be&&(q(ie,Oe,Q.z,Le,Q.y),Re&&(q(ie,de,Q.z,Q.x,Q.y-1),q(ie,Oe,Q.z,Le,Q.y-1))),2&Be&&(q(ie,$e,Q.z,Fe,Q.y),Re&&(q(ie,de,Q.z,Q.x,Q.y-1),q(ie,$e,Q.z,Fe,Q.y-1))),4&Be&&(q(ie,Oe,Q.z,Le,Q.y),Te&&(q(ie,de,Q.z,Q.x,Q.y+1),q(ie,Oe,Q.z,Le,Q.y+1))),8&Be&&(q(ie,$e,Q.z,Fe,Q.y),Te&&(q(ie,de,Q.z,Q.x,Q.y+1),q(ie,$e,Q.z,Fe,Q.y+1)))}}const K=[];for(const Y of N)N.some(ee=>Y.isChildOf(ee))||K.push(Y);if(N=K.filter(Y=>!c.some(ee=>!!(Y.overscaledZ<h&&ee.isChildOf(Y))||Y.equals(ee)||Y.isChildOf(ee))),k){const Y=1<<h,ee=this.projection.name==="globe"?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),Q=[Y*ee.x,Y*ee.y],ie=4,de=ie*ie;N=N.filter(le=>{const he=le.canonical.x+.5-Q[0],fe=le.canonical.y+.5-Q[1];return he*he+fe*fe<de})}return N}coveringTiles(c){let h=this.coveringZoomLevel(c);const v=h,N=this.elevation&&this.elevation.exaggeration(),A=N&&!c.isTerrainDEM,k=this.projection.name==="mercator";if(c.minzoom!==void 0&&h<c.minzoom)return[];c.maxzoom!==void 0&&h>c.maxzoom&&(h=c.maxzoom);const z=this.locationCoordinate(this.center),q=this.center.lat,K=1<<h,Y=[K*z.x,K*z.y,0],ee=this.projection.name==="globe",Q=!ee,ie=s.bR.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,h,Q),de=ee?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),le=K*s.bH(1,this.center.lat),he=this._camera.position[2]/s.bH(1,this.center.lat),fe=[K*de.x,K*de.y,he*(Q?1:le)],Te=ee||N,Re=this.cameraToCenterDistance/c.tileSize*(c.roundZoom?1:.502),Oe=this.isLODDisabled(!0)?h:0;let $e;if(this._elevation&&c.isTerrainDEM)$e=1e4*this._elevation.exaggeration();else if(this._elevation){const rt=this._elevation.getMinMaxForVisibleTiles();$e=rt?rt.max:this._centerAltitude}else $e=this._centerAltitude;const Le=c.isTerrainDEM?-$e:this._elevation?this._elevation.getMinElevationBelowMSL():0,Fe=this.projection.isReprojectedInTileSpace?s.bS(this):1,Be=rt=>{const _t=new s.ac(rt.x+25e-6,rt.y,rt.z),Et=new s.ac(rt.x,rt.y+25e-6,rt.z),pt=rt.toLngLat(),It=_t.toLngLat(),Kt=Et.toLngLat(),Zt=this.locationCoordinate(pt),Qt=this.locationCoordinate(It),gr=this.locationCoordinate(Kt),qr=Math.hypot(Qt.x-Zt.x,Qt.y-Zt.y),Er=Math.hypot(gr.x-Zt.x,gr.y-Zt.y);return Math.sqrt(qr*Er)*Fe/25e-6},He=rt=>{const Ct=$e,_t=Le;return{aabb:s.bV(this,K,0,0,0,rt,_t,Ct,this.projection),zoom:0,x:0,y:0,minZ:_t,maxZ:Ct,wrap:rt,fullyVisible:!1}},Ke=[];let ft=[];const at=h,kt=c.reparseOverscaled?v:h,Pt=(he-this._centerAltitude)*le,Bt=rt=>{if(!this._elevation||!rt.tileID||!k)return;const Ct=this._elevation.getMinMaxForTile(rt.tileID),_t=rt.aabb;Ct?(_t.min[2]=Ct.min,_t.max[2]=Ct.max,_t.center[2]=(_t.min[2]+_t.max[2])/2):(rt.shouldSplit=At(rt),rt.shouldSplit||(_t.min[2]=_t.max[2]=_t.center[2]=this._centerAltitude))},st=(rt,Ct)=>{if(.707*Ct<rt)return 1;const _t=Ct/rt;return _t/(1.4144271570014144+(Math.pow(1.1,_t-1.4144271570014144+1)-1)/(1.1-1)-1)},At=rt=>{if(rt.zoom<Oe)return!0;if(rt.zoom===at)return!1;if(rt.shouldSplit!=null)return rt.shouldSplit;const Ct=rt.aabb.distanceX(fe),_t=rt.aabb.distanceY(fe);let Et=Pt,pt=1;if(ee){Et=rt.aabb.distanceZ(fe);const Er=Math.pow(2,rt.zoom),Br=s.aT((rt.y+1)/Er),zr=s.aT(rt.y/Er),bn=Math.min(Math.max(q,Br),zr),Vn=s.ca(bn)/s.ca(q);if(pt=bn===q?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,Vn/this._mercatorScaleRatio),this.zoom<=s.c6&&rt.zoom===at-1&&Vn>=.9)return!0}else if(A&&(Et=rt.aabb.distanceZ(fe)*le),this.projection.isReprojectedInTileSpace&&v<=5){const Er=Math.pow(2,rt.zoom),Br=Be(new s.ac((rt.x+.5)/Er,(rt.y+.5)/Er));pt=Br>.85?1:Br}if(!k){const Er=Math.sqrt(Ct*Ct+_t*_t+Et*Et);let Br=(1<<at-rt.zoom)*Re*pt;return Br*=st(Math.max(Et,Pt),Er),Er<Br}let It=Number.MAX_VALUE,Kt=0;const Zt=rt.aabb.getCorners(),Qt=[];for(const Er of Zt){s.ad.vec3.sub(Qt,Er,fe),ee||(A?Qt[2]*=le:Qt[2]=Pt);const Br=s.ad.vec3.dot(Qt,this._camera.forward());Br<It&&(It=Br,Kt=Math.abs(Qt[2]))}let gr=(1<<at-rt.zoom)*Re*pt;if(gr*=st(Math.max(Kt,Pt),It),It<gr)return!0;const qr=rt.aabb.closestPoint(Y);return qr[0]===Y[0]&&qr[1]===Y[1]};if(this.renderWorldCopies)for(let rt=1;rt<=3;rt++)Ke.push(He(-rt)),Ke.push(He(rt));for(Ke.push(He(0));Ke.length>0;){const rt=Ke.pop(),Ct=rt.x,_t=rt.y;let Et=rt.fullyVisible;const pt=()=>this.projection.name==="globe"&&(rt.y===0||rt.y===(1<<rt.zoom)-1);if(!Et){let It=Te?rt.aabb.intersects(ie):rt.aabb.intersectsFlat(ie);if(It===0&&pt()){const Kt=new s.bT(rt.zoom,Ct,_t);It=s.bU(this,K,Kt,!0).intersects(ie)}if(It===0)continue;Et=It===2}if(rt.zoom!==at&&At(rt))for(let It=0;It<4;It++){const Kt=(Ct<<1)+It%2,Zt=(_t<<1)+(It>>1),Qt={aabb:k?rt.aabb.quadrant(It):s.bV(this,K,rt.zoom+1,Kt,Zt,rt.wrap,rt.minZ,rt.maxZ,this.projection),zoom:rt.zoom+1,x:Kt,y:Zt,wrap:rt.wrap,fullyVisible:Et,tileID:void 0,shouldSplit:void 0,minZ:rt.minZ,maxZ:rt.maxZ};A&&!ee&&(Qt.tileID=new s.aH(rt.zoom+1===at?kt:rt.zoom+1,rt.wrap,rt.zoom+1,Kt,Zt),Bt(Qt)),Ke.push(Qt)}else{const It=rt.zoom===at?kt:rt.zoom;if(c.minzoom&&c.minzoom>It)continue;let Kt=0;if(!Et){let qr=Te?rt.aabb.intersectsPrecise(ie):rt.aabb.intersectsPreciseFlat(ie);if(qr===0&&pt()){const Er=new s.bT(rt.zoom,Ct,_t);qr=s.bU(this,K,Er,!0).intersectsPrecise(ie)}if(qr===0)continue;if(c.calculateQuadrantVisibility)if(ie.containsPoint(rt.aabb.center))Kt=15;else for(let Er=0;Er<4;Er++)rt.aabb.quadrant(Er).intersects(ie)!==0&&(Kt|=1<<Er)}const Zt=Y[0]-(.5+Ct+(rt.wrap<<rt.zoom))*(1<<h-rt.zoom),Qt=Y[1]-.5-_t,gr=rt.tileID?rt.tileID:new s.aH(It,rt.wrap,rt.zoom,Ct,_t);c.calculateQuadrantVisibility&&(gr.visibleQuadrants=Kt),ft.push({tileID:gr,distanceSq:Zt*Zt+Qt*Qt})}}if(this.fogCullDistSq){const rt=this.fogCullDistSq,Ct=this.horizonLineFromTop();ft=ft.filter(_t=>{const Et=[0,0,0,1],pt=[s.ai,s.ai,0,1],It=this.calculateFogTileMatrix(_t.tileID.toUnwrapped());s.ad.vec4.transformMat4(Et,Et,It),s.ad.vec4.transformMat4(pt,pt,It);const Kt=s.ad.vec4.min([],Et,pt),Zt=s.ad.vec4.max([],Et,pt),Qt=s.bW(Kt,Zt);if(Qt===0)return!0;let gr=!1;const qr=this._elevation;if(qr&&Qt>rt&&Ct!==0){const Er=this.calculateProjMatrix(_t.tileID.toUnwrapped());let Br;c.isTerrainDEM||(Br=qr.getMinMaxForTile(_t.tileID)),Br||(Br={min:Le,max:$e});const zr=s.c7(this.rotation),bn=[zr[0]*s.ai,zr[1]*s.ai,Br.max];s.ad.vec3.transformMat4(bn,bn,Er),gr=(1-bn[1])*this.height*.5<Ct}return Qt<rt||gr})}return ft.sort((rt,Ct)=>rt.distanceSq-Ct.distanceSq).map(rt=>rt.tileID)}resize(c,h){this.width=c,this.height=h,this.pixelsToGLUnits=[2/c,-2/h],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(c){return Math.pow(2,c)}scaleZoom(c){return Math.log(c)/Math.LN2}project(c){const h=s.ay(c.lat,-s.bX,s.bX),v=this.projection.project(c.lng,h);return new s.P(v.x*this.worldSize,v.y*this.worldSize)}unproject(c){return this.projection.unproject(c.x/this.worldSize,c.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/s.bH(1,this.center.lat)/this.worldSize}setLocationAtPoint(c,h){let v,N;const A=this.centerPoint;if(this.projection.name==="globe"){const z=this.worldSize;v=(h.x-A.x)/z,N=(h.y-A.y)/z}else{const z=this.pointCoordinate(h),q=this.pointCoordinate(A);v=z.x-q.x,N=z.y-q.y}const k=this.locationCoordinate(c);this.setLocation(new s.ac(k.x-v,k.y-N))}setLocation(c){this.center=this.coordinateLocation(c),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(c,h){return this.projection.locationPoint(this,c,h)}locationPoint3D(c,h){return this.projection.locationPoint(this,c,h,!0)}pointLocation(c){return this.coordinateLocation(this.pointCoordinate(c))}pointLocation3D(c,h){return this.coordinateLocation(this.pointCoordinate3D(c,h))}locationCoordinate(c,h){const v=h?s.bH(h,c.lat):void 0,N=this.projection.project(c.lng,c.lat);return new s.ac(N.x,N.y,v)}coordinateLocation(c){return this.projection.unproject(c.x,c.y)}pointRayIntersection(c,h){const v=h??this._centerAltitude,N=[c.x,c.y,0,1],A=[c.x,c.y,1,1];s.ad.vec4.transformMat4(N,N,this.pixelMatrixInverse),s.ad.vec4.transformMat4(A,A,this.pixelMatrixInverse);const k=A[3];s.ad.vec4.scale(N,N,1/N[3]),s.ad.vec4.scale(A,A,1/k);const z=N[2],q=A[2];return{p0:N,p1:A,t:z===q?0:(v-z)/(q-z)}}screenPointToMercatorRay(c){const h=[c.x,c.y,0,1],v=[c.x,c.y,1,1];return s.ad.vec4.transformMat4(h,h,this.pixelMatrixInverse),s.ad.vec4.transformMat4(v,v,this.pixelMatrixInverse),s.ad.vec4.scale(h,h,1/h[3]),s.ad.vec4.scale(v,v,1/v[3]),h[2]=s.bH(h[2],this._center.lat)*this.worldSize,v[2]=s.bH(v[2],this._center.lat)*this.worldSize,s.ad.vec4.scale(h,h,1/this.worldSize),s.ad.vec4.scale(v,v,1/this.worldSize),new s.as([h[0],h[1],h[2]],s.ad.vec3.normalize([],s.ad.vec3.sub([],v,h)))}rayIntersectionCoordinate(c){const{p0:h,p1:v,t:N}=c,A=s.bH(h[2],this._center.lat),k=s.bH(v[2],this._center.lat);return new s.ac(s.ah(h[0],v[0],N)/this.worldSize,s.ah(h[1],v[1],N)/this.worldSize,s.ah(A,k,N))}pointCoordinate(c,h=this._centerAltitude){return this.projection.pointCoordinate(this,c.x,c.y,h)}pointCoordinate3D(c,h){if(!this.elevation)return this.pointCoordinate(c,h);let v=this.projection.pointCoordinate3D(this,c.x,c.y);if(v)return new s.ac(v[0],v[1],v[2]);let N=0,A=this.horizonLineFromTop();if(c.y>A)return this.pointCoordinate(c,h);const k=.02*A,z=c.clone();for(let q=0;q<10&&A-N>k;q++){z.y=s.ah(N,A,.66);const K=this.projection.pointCoordinate3D(this,z.x,z.y);K?(A=z.y,v=K):N=z.y}return v?new s.ac(v[0],v[1],v[2]):this.pointCoordinate(c)}isPointAboveHorizon(c){return this.projection.isPointAboveHorizon(this,c)}isPointOnSurface(c){if(c.y<0||c.y>this.height||c.x<0||c.x>this.width)return!1;if(this.elevation||this.zoom>=s.bY)return!this.isPointAboveHorizon(c);const h=this.pointCoordinate(c);return h.y>=0&&h.y<=1}_coordinatePoint(c,h){const v=h&&this.elevation?this.elevation.getAtPointOrZero(c,this._centerAltitude):this._centerAltitude,N=[c.x*this.worldSize,c.y*this.worldSize,v+c.toAltitude(),1];return s.ad.vec4.transformMat4(N,N,this.pixelMatrix),N[3]>0?new s.P(N[0]/N[3],N[1]/N[3]):new s.P(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:c,left:h}=this._edgeInsets,v=this.height-this._edgeInsets.bottom,N=this.width-this._edgeInsets.right,A=this.pointLocation3D(new s.P(h,c)),k=this.pointLocation3D(new s.P(N,c)),z=this.pointLocation3D(new s.P(N,v)),q=this.pointLocation3D(new s.P(h,v));let K=Math.min(A.lng,k.lng,z.lng,q.lng),Y=Math.max(A.lng,k.lng,z.lng,q.lng),ee=Math.min(A.lat,k.lat,z.lat,q.lat),Q=Math.max(A.lat,k.lat,z.lat,q.lat);const ie=Math.pow(2,-this.zoom)/16*270,de=this.projection.name==="globe"?1:4,le=(he,fe,Te,Re,Oe)=>{const $e=(he+Te)/2,Le=(fe+Re)/2,Fe=new s.P($e,Le),{lng:Be,lat:He}=this.pointLocation3D(Fe),Ke=Math.max(0,K-Be,ee-He,Be-Y,He-Q);K=Math.min(K,Be),Y=Math.max(Y,Be),ee=Math.min(ee,He),Q=Math.max(Q,He),(Oe<de||Ke>ie)&&(le(he,fe,$e,Le,Oe+1),le($e,Le,Te,Re,Oe+1))};if(le(h,c,N,c,1),le(N,c,N,v,1),le(N,v,h,v,1),le(h,v,h,c,1),this.projection.name==="globe"){const[he,fe]=s.bZ(this);he?(Q=90,Y=180,K=-180):fe&&(ee=-90,Y=180,K=-180)}return new s.aB(new s.bO(K,ee),new s.bO(Y,Q))}_getBoundsRectangular(c,h){const{top:v,left:N}=this._edgeInsets,A=this.height-this._edgeInsets.bottom,k=this.width-this._edgeInsets.right,z=new s.P(N,v),q=new s.P(k,v),K=new s.P(k,A),Y=new s.P(N,A);let ee=this.pointCoordinate(z,c),Q=this.pointCoordinate(q,c);const ie=this.pointCoordinate(K,h),de=this.pointCoordinate(Y,h),le=(he,fe)=>(fe.y-he.y)/(fe.x-he.x);return ee.y>1&&Q.y>=0?ee=new s.ac((1-de.y)/le(de,ee)+de.x,1):ee.y<0&&Q.y<=1&&(ee=new s.ac(-de.y/le(de,ee)+de.x,0)),Q.y>1&&ee.y>=0?Q=new s.ac((1-ie.y)/le(ie,Q)+ie.x,1):Q.y<0&&ee.y<=1&&(Q=new s.ac(-ie.y/le(ie,Q)+ie.x,0)),new s.aB().extend(this.coordinateLocation(ee)).extend(this.coordinateLocation(Q)).extend(this.coordinateLocation(de)).extend(this.coordinateLocation(ie))}_getBoundsRectangularTerrain(){const c=this.elevation;if(!c.visibleDemTiles.length||c.isUsingMockSource())return this._getBoundsRectangular(0,0);const h=c.visibleDemTiles.reduce((v,N)=>{if(N.dem){const A=N.dem.tree;v.min=Math.min(v.min,A.minimums[0]),v.max=Math.max(v.max,A.maximums[0])}return v},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(h.min*c.exaggeration(),h.max*c.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(c=!0){const h=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,v=this.height/2-h*(1-this._horizonShift);return c?Math.max(0,v):v}getMaxBounds(){return this.maxBounds}setMaxBounds(c){this.maxBounds=c,this.minLat=-s.bX,this.maxLat=s.bX,this.minLng=-180,this.maxLng=180,c&&(this.minLat=c.getSouth(),this.maxLat=c.getNorth(),this.minLng=c.getWest(),this.maxLng=c.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=s.av(this.minLng)*this.tileSize,this.worldMaxX=s.av(this.maxLng)*this.tileSize,this.worldMinY=s.aC(this.maxLat)*this.tileSize,this.worldMaxY=s.aC(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(c,h){return this.projection.createTileMatrix(this,h,c)}calculateDistanceTileData(c){const h=c.key,v=this._distanceTileDataCache;if(v[h])return v[h];const N=c.canonical,A=1/this.height,k=this.cameraWorldSize,z=k/this.zoomScale(N.z),q=(N.x+Math.pow(2,N.z)*c.wrap)*z,K=N.y*z,Y=this.point;Y.x*=k/this.worldSize,Y.y*=k/this.worldSize;const ee=this.angle,Q=Math.sin(-ee),ie=-Math.cos(-ee);return v[h]={bearing:[Q,ie],center:[(Y.x-q)*A,(Y.y-K)*A],scale:z/s.ai*A},v[h]}calculateFogTileMatrix(c){const h=c.key,v=this._fogTileMatrixCache;if(v[h])return v[h];const N=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,c);return s.ad.mat4.multiply(N,this.worldToFogMatrix,N),v[h]=new Float32Array(N),v[h]}calculateProjMatrix(c,h=!1,v=!1){const N=c.key;let A;if(A=v?this._expandedProjMatrixCache:h?this._alignedProjMatrixCache:this._projMatrixCache,A[N])return A[N];const k=this.calculatePosMatrix(c,this.worldSize);let z;return z=this.projection.isReprojectedInTileSpace?this.mercatorMatrix:v?this.expandedFarZProjMatrix:h?this.alignedProjMatrix:this.projMatrix,s.ad.mat4.multiply(k,z,k),A[N]=new Float32Array(k),A[N]}calculatePixelsToTileUnitsMatrix(c){const h=c.tileID.key,v=this._pixelsToTileUnitsCache;if(v[h])return v[h];const N=s.b_(c,this);return v[h]=N,v[h]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const c=1/this.worldSize,h=s.ad.mat4.fromScaling([],[c,c,c]);return s.ad.mat4.multiply(h,h,this.globeMatrix),h}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const c=this._elevation;this._updateCameraState();const h=s.bH(1,this._center.lat)*this.worldSize,v=this._computeCameraPosition(h),N=this._camera.forward(),A=s.bH(1,this._center.lat);v[2]/=A,N[2]/=A,s.ad.vec3.normalize(N,N);const k=c.raycast(v,N,c.exaggeration());if(k){const z=s.ad.vec3.scaleAndAdd([],v,N,k),q=new s.ac(z[0],z[1],s.bH(z[2],s.aT(z[1]))),K=(q.z+s.ad.vec3.length([q.x-v[0],q.y-v[1],q.z-v[2]*A]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(K),this._centerAltitude=q.toAltitude(),this._center=this.coordinateLocation(q),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(c=!1){if(!this._elevation)return;const h=this._elevation,v=s.bH(1,this._center.lat)*this.worldSize,N=this._computeCameraPosition(v),A=h.getAtPointOrZero(new s.ac(...N)),k=this.pixelsPerMeter/this.worldSize*A,z=this._minimumHeightOverTerrain(),q=N[2]-k;if(q<=z)if(q<0||c){const K=this.locationCoordinate(this._center,this._centerAltitude),Y=[N[0],N[1],K.z-N[2]],ee=s.ad.vec3.length(Y);Y[2]-=(z-q)/this._pixelsPerMercatorPixel;const Q=s.ad.vec3.length(Y);if(Q===0)return;s.ad.vec3.scale(Y,Y,ee/Q*this._pixelsPerMercatorPixel),this._camera.position=[N[0],N[1],K.z*this._pixelsPerMercatorPixel-Y[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const c=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||c){const Q=this.center;return Q.lat=s.ay(Q.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!c)&&(Q.lng=s.ay(Q.lng,this.minLng,this.maxLng)),this.center=Q,void(this._constraining=!1)}const h=this._unmodified,{x:v,y:N}=this.point;let A=0,k=v,z=N;const q=this.width/2,K=this.height/2,Y=this.worldMinY*this.scale,ee=this.worldMaxY*this.scale;if(N-K<Y&&(z=Y+K),N+K>ee&&(z=ee-K),ee-Y<this.height&&(A=Math.max(A,this.height/(ee-Y)),z=(ee+Y)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const Q=this.worldMinX*this.scale,ie=this.worldMaxX*this.scale,de=this.worldSize/2-(Q+ie)/2;k=(v+de+this.worldSize)%this.worldSize-de,k-q<Q&&(k=Q+q),k+q>ie&&(k=ie-q),ie-Q<this.width&&(A=Math.max(A,this.width/(ie-Q)),k=(ie+Q)/2)}k===v&&z===N||this._allowWorldUnderZoom||(this.center=this.unproject(new s.P(k,z))),A&&!this._allowWorldUnderZoom&&(this.zoom+=this.scaleZoom(A)),this._constrainCamera(),this._unmodified=h,this._constraining=!1}_minZoomForBounds(){let c=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(c=Math.max(c,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),c}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const c=this.centerOffset,h=this.projection.name==="globe",v=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=s.bH(1,this.center.lat)/s.bH(1,s.c8));const N=s.b$(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,N),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const A=this.projection.zAxisUnit==="meters"?v:1,k=this._camera.getWorldToCamera(this.worldSize,A);let z;const q=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(q[8]=2*-c.x/this.width,q[9]=2*c.y/this.height,this.isOrthographic){let He=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),Ke=He*this.aspect,ft=-Ke,at=-He;Ke-=c.x,ft-=c.x,He+=c.y,at+=c.y,z=this._camera.getCameraToClipOrthographic(ft,Ke,at,He,this._nearZ,this._farZ),((kt,Pt,Bt,st)=>{for(let At=0;At<16;At++)kt[At]=s.ah(Pt[At],Bt[At],st)})(z,z,q,s.c9(this.pitch>=Wt?1:this.pitch/Wt))}else z=q;const K=s.ad.mat4.mul([],q,k);let Y=s.ad.mat4.mul([],z,k);if(this.projection.isReprojectedInTileSpace){const He=this.locationCoordinate(this.center),Ke=s.ad.mat4.identity([]);s.ad.mat4.translate(Ke,Ke,[He.x*this.worldSize,He.y*this.worldSize,0]),s.ad.mat4.multiply(Ke,Ke,s.c0(this)),s.ad.mat4.translate(Ke,Ke,[-He.x*this.worldSize,-He.y*this.worldSize,0]),s.ad.mat4.multiply(Y,Y,Ke),s.ad.mat4.multiply(K,K,Ke),this.inverseAdjustmentMatrix=s.c1(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];if(this.mercatorMatrix=s.ad.mat4.scale([],Y,[this.worldSize,this.worldSize,this.worldSize/A,1]),this.projMatrix=Y,this.invProjMatrix=s.ad.mat4.invert(new Float64Array(16),this.projMatrix),h){const He=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,1/0);He[8]=2*-c.x/this.width,He[9]=2*c.y/this.height,this.expandedFarZProjMatrix=s.ad.mat4.mul([],He,k)}else this.expandedFarZProjMatrix=this.projMatrix;const ee=s.ad.mat4.invert([],z);this.frustumCorners=s.c2.fromInvProjectionMatrix(ee,this.horizonLineFromTop(),this.height),this.cameraFrustum=s.bR.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!h);const Q=new Float32Array(16);s.ad.mat4.identity(Q),s.ad.mat4.scale(Q,Q,[1,-1,1]),s.ad.mat4.rotateX(Q,Q,this._pitch),s.ad.mat4.rotateZ(Q,Q,this.angle);const ie=s.ad.mat4.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=s.ad.mat4.clone(ie);const de=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;ie[8]=2*-c.x/this.width,ie[9]=2*(c.y+de)/this.height,this.skyboxMatrix=s.ad.mat4.multiply(Q,ie,Q);const le=this.point,he=le.x,fe=le.y,Te=this.width%2/2,Re=this.height%2/2,Oe=Math.cos(this.angle),$e=Math.sin(this.angle),Le=he-Math.round(he)+Oe*Te+$e*Re,Fe=fe-Math.round(fe)+Oe*Re+$e*Te,Be=new Float64Array(Y);if(s.ad.mat4.translate(Be,Be,[Le>.5?Le-1:Le,Fe>.5?Fe-1:Fe,0]),this.alignedProjMatrix=Be,Y=s.ad.mat4.create(),s.ad.mat4.scale(Y,Y,[this.width/2,-this.height/2,1]),s.ad.mat4.translate(Y,Y,[1,-1,0]),this.labelPlaneMatrix=Y,Y=s.ad.mat4.create(),s.ad.mat4.scale(Y,Y,[1,-1,1]),s.ad.mat4.translate(Y,Y,[-1,-1,0]),s.ad.mat4.scale(Y,Y,[2/this.width,2/this.height,1]),this.glCoordMatrix=Y,this.pixelMatrix=s.ad.mat4.multiply(new Float64Array(16),this.labelPlaneMatrix,K),this._calcFogMatrices(),this._distanceTileDataCache={},Y=s.ad.mat4.invert(new Float64Array(16),this.pixelMatrix),!Y)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=Y,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=s.c3(this);const He=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=s.ad.vec3.transformMat4(He,He,k),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=Y;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={},this._expandedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const c=this.cameraWorldSizeForFog,h=this.cameraPixelsPerMeter,v=this._camera.position,N=1/this.height/this._pixelsPerMercatorPixel,A=[c,c,h];s.ad.vec3.scale(A,A,N),s.ad.vec3.scale(v,v,-1),s.ad.vec3.multiply(v,v,A);const k=s.ad.mat4.create();s.ad.mat4.translate(k,k,v),s.ad.mat4.scale(k,k,A),this.mercatorFogMatrix=k,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(c,h,N)}_computeCameraPosition(c){const h=(c=c||this.pixelsPerMeter)/this.pixelsPerMeter,v=this._camera.forward(),N=this.point,A=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*h-c/this.worldSize*this._centerAltitude;return[N.x/this.worldSize-v[0]*A,N.y/this.worldSize-v[1]*A,c/this.worldSize*this._centerAltitude-v[2]*A]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(c){const h=this._maxCameraBoundsDistance()*Math.cos(this._pitch),v=this._camera.position[2],N=c[2];let A=1;this.projection.wrap&&(this.center=this.center.wrap()),N>0&&(A=Math.min((h-v)/N,1)),this._camera.position=s.ad.vec3.scaleAndAdd([],this._camera.position,c,A),this._updateStateFromCamera()}_updateStateFromCamera(){const c=this._camera.position,h=this._camera.forward(),{pitch:v,bearing:N}=this._camera.getPitchBearing(),A=s.bH(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,k=this._mercatorZfromZoom(this._maxZoom)*Math.cos(s.ak(this._maxPitch)),z=Math.max((c[2]-A)/Math.cos(v),k),q=this._zoomFromMercatorZ(z);s.ad.vec3.scaleAndAdd(c,c,h,z),this._pitch=s.ay(v,s.ak(this.minPitch),s.ak(this.maxPitch)),this.angle=s.bF(N,-Math.PI,Math.PI),this._setZoom(s.ay(q,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new s.ac(c[0],c[1],c[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(c){return Math.pow(2,c)*this.tileSize}_mercatorZfromZoom(c){return this.cameraToCenterDistance/this._worldSizeFromZoom(c)}_minimumHeightOverTerrain(){const c=Math.min(this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom,this._maxZoom)+4;return this._mercatorZfromZoom(c)}_zoomFromMercatorZ(c){return this.scaleZoom(this.cameraToCenterDistance/(c*this.tileSize))}zoomFromMercatorZAdjusted(c){let h=0,v=s.bY,N=0,A=1/0;for(;v-h>1e-6&&v>h;){const k=h+.5*(v-h),z=this.tileSize*Math.pow(2,k),q=this.getCameraToCenterDistance(this.projection,k,z),K=this.scaleZoom(q/(c*this.tileSize)),Y=Math.abs(k-K);Y<A&&(A=Y,N=k),k<K?h=k:v=k}return N}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(s.w("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(c,h){const v=Math.min(c.x,h.x),N=Math.max(c.x,h.x),A=Math.min(c.y,h.y),k=Math.max(c.y,h.y);if(A<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const z=[new s.P(v,A),new s.P(N,k),new s.P(v,k),new s.P(N,A)],q=this.renderWorldCopies?-3:0,K=this.renderWorldCopies?4:1;for(const Y of z){const ee=this.pointRayIntersection(Y);if(ee.t<0)return!0;const Q=this.rayIntersectionCoordinate(ee);if(Q.x<q||Q.y<0||Q.x>K||Q.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+s.c4(this.fovAboveCenter)>88||this.anyCornerOffEdge(new s.P(0,0),new s.P(this.width,this.height))}zoomDeltaToMovement(c,h){const v=s.ad.vec3.length(s.ad.vec3.sub([],this._camera.position,c)),N=this._zoomFromMercatorZ(v)+h;return v-this._mercatorZfromZoom(N)}getCameraPoint(){if(this.projection.name==="globe"){const c=function([h,v,N],A){const k=[h,v,N,1];s.ad.vec4.transformMat4(k,k,A);const z=k[3]=Math.max(k[3],1e-6);return k[0]/=z,k[1]/=z,k[2]/=z,k}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new s.P(c[0],c[1])}{const c=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new s.P(0,c))}}getCameraToCenterDistance(c,h=this.zoom,v=this.worldSize){const N=s.b$(c,h,this.width,this.height,1024),A=c.pixelSpaceConversion(this.center.lat,v,N);let k=.5/Math.tan(.5*this._fov)*this.height*A;return this.isOrthographic&&(k=s.ah(1,k,s.c9(this.pitch>=Wt?1:this.pitch/Wt))),k}getWorldToCameraMatrix(){const c=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&s.ad.mat4.multiply(c,c,this.globeMatrix),c}getFrustum(c){return s.bR.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,c,this.projection.zAxisUnit==="meters")}}const Ru=(b,c)=>{if(c>0&&b.terrain&&s.w("Cutoff is currently disabled on terrain"),c<=0||b.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,1]}};const h=b.transform,v=Math.max(Math.abs(h._zoom-(b.minCutoffZoom-1)),1),N=h.isLODDisabled(!1)?s.ae(60,45,h.pitch):s.ae(30,15,h.pitch),A=h._farZ-h._nearZ,k=c*h.height,z=((1-(q=N))*h.cameraToCenterDistance+q*(h._farZ+k))*v;var q;return{shouldRenderCutoff:N<1,uniformValues:{u_cutoff_params:[h._nearZ,h._farZ,(z-h._nearZ)/A,(z-k-h._nearZ)/A]}}},Ta={cascadeCount:2,normalOffset:3,shadowMapResolution:2048};class MS{constructor(c,h){this.aabb=c,this.lastCascade=h}}class Fx{add(c,h){const v=this.receivers[c.key];v!==void 0?(v.aabb.min[0]=Math.min(v.aabb.min[0],h.min[0]),v.aabb.min[1]=Math.min(v.aabb.min[1],h.min[1]),v.aabb.min[2]=Math.min(v.aabb.min[2],h.min[2]),v.aabb.max[0]=Math.max(v.aabb.max[0],h.max[0]),v.aabb.max[1]=Math.max(v.aabb.max[1],h.max[1]),v.aabb.max[2]=Math.max(v.aabb.max[2],h.max[2])):this.receivers[c.key]=new MS(h,null)}clear(){this.receivers={}}get(c){return this.receivers[c.key]}computeRequiredCascades(c,h,v){const N=s.ce.fromPoints(c.points);let A=0;for(const k in this.receivers){const z=this.receivers[k];if(!z||!N.intersectsAabb(z.aabb))continue;z.aabb.min=N.closestPoint(z.aabb.min),z.aabb.max=N.closestPoint(z.aabb.max);const q=z.aabb.getCorners();for(let K=0;K<v.length;K++){let Y=!0;for(const ee of q){const Q=[ee[0]*h,ee[1]*h,ee[2]];if(s.ad.vec3.transformMat4(Q,Q,v[K].matrix),Q[0]<-1||Q[0]>1||Q[1]<-1||Q[1]>1){Y=!1;break}}if(z.lastCascade=K,A=Math.max(A,K),Y)break}}return A+1}}class Du{constructor(c){this.painter=c,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new Fx,this._depthMode=new Cr(c.context.gl.LEQUAL,Cr.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this._forceDisable=!1,this.useNormalOffset=!1,c.tp.registerParameter(this,["Shadows"],"_forceDisable",{label:"forceDisable"},()=>{this.painter.style.map.triggerRepaint()}),c.tp.registerParameter(Ta,["Shadows"],"cascadeCount",{min:1,max:2,step:1}),c.tp.registerParameter(Ta,["Shadows"],"normalOffset",{min:0,max:10,step:.05}),c.tp.registerParameter(Ta,["Shadows"],"shadowMapResolution",{min:32,max:2048,step:32}),c.tp.registerBinding(this,["Shadows"],"_numCascadesToRender",{readonly:!0,label:"numCascadesToRender"})}destroy(){for(const c of this._cascades)c.texture.destroy(),c.framebuffer.destroy();this._cascades=[]}updateShadowParameters(c,h){const v=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!h||!h.properties)return;const N=h.properties.get("shadow-intensity");if(!h.shadowsEnabled()||N<=0||(this._shadowLayerCount=v.style.order.reduce((de,le)=>{const he=v.style._mergedLayers[le];return de+(he.hasShadowPass()&&!he.isHidden(c.zoom)?1:0)},0),this._enabled=this._shadowLayerCount>0,!this.enabled))return;const A=v.context,k=Ta.shadowMapResolution,z=Ta.shadowMapResolution;if(this._cascades.length===0||Ta.shadowMapResolution!==this._cascades[0].texture.size[0]){this._cascades=[];for(let de=0;de<Ta.cascadeCount;++de){const le=v._shadowMapDebug,he=A.gl,fe=A.createFramebuffer(k,z,le,"texture"),Te=new s.T(A,{width:k,height:z,data:null},he.DEPTH_COMPONENT16);if(fe.depthAttachment.set(Te.texture),le){const Re=new s.T(A,{width:k,height:z,data:null},he.RGBA8);fe.colorAttachment.set(Re.texture)}this._cascades.push({framebuffer:fe,texture:Te,matrix:[],far:0,boundingSphereRadius:0,frustum:new s.bR,scale:0})}}this.shadowDirection=Dd(h);let q=0;if(c.elevation){const de=c.elevation,le=[1e4,-1e4];de.visibleDemTiles.filter(he=>he.dem).forEach(he=>{const fe=he.dem.tree;le[0]=Math.min(le[0],fe.minimums[0]),le[1]=Math.max(le[1],fe.maximums[0])}),le[0]!==1e4&&(q=(le[1]-le[0])*de.exaggeration())}const K=1.5*c.cameraToCenterDistance,Y=3*K,ee=new Float64Array(16);for(let de=0;de<this._cascades.length;++de){const le=this._cascades[de];let he=c.height/50,fe=1;Ta.cascadeCount===1?fe=Y:de===0?fe=K:(he=K,fe=Y);const[Te,Re]=sf(c,this.shadowDirection,he,fe,Ta.shadowMapResolution,q);le.scale=c.scale,le.matrix=Te,le.boundingSphereRadius=Re,s.ad.mat4.invert(ee,le.matrix),le.frustum=s.bR.fromInvProjectionMatrix(ee,1,0,!0),le.far=fe}const Q=this._cascades.length-1;this._uniformValues.u_fade_range=[.75*this._cascades[Q].far,this._cascades[Q].far],this._uniformValues.u_shadow_intensity=N,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=1/Ta.shadowMapResolution,this._uniformValues.u_shadow_map_resolution=Ta.shadowMapResolution,this._uniformValues.u_shadowmap_0=ss.ShadowMap0,this._uniformValues.u_shadowmap_1=ss.ShadowMap0+1,this._groundShadowTiles=v.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const ie=v.transform.elevation;for(const de of this._groundShadowTiles){let le={min:0,max:0};if(ie){const he=ie.getMinMaxForTile(de);he&&(le=he)}this.addShadowReceiver(de.toUnwrapped(),le.min,le.max)}}get enabled(){return this._enabled&&!this._forceDisable}set enabled(c){this._enabled=c}drawShadowPass(c,h){if(!this.enabled)return;const v=this.painter,N=v.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(v.transform.getFrustum(0),v.transform.worldSize,this._cascades),N.viewport.set([0,0,Ta.shadowMapResolution,Ta.shadowMapResolution]);for(let A=0;A<this._numCascadesToRender;++A){v.currentShadowCascade=A,N.bindFramebuffer.set(this._cascades[A].framebuffer.framebuffer),N.clear({color:s.al.white,depth:1});for(const k of c.order){const z=c._mergedLayers[k];if(!z.hasShadowPass()||z.isHidden(v.transform.zoom))continue;const q=c.getLayerSourceCache(z),K=q?h[q.id]:void 0;(z.type==="model"||K&&K.length)&&v.renderLayer(v,q,z,K)}}v.currentShadowCascade=0}drawGroundShadows(){if(!this.enabled)return;const c=this.painter,h=c.style,v=c.context,N=h.directionalLight,A=h.ambientLight;if(!N||!A)return;const k=[],z=Ru(c,c.longestCutoffRange);z.shouldRenderCutoff&&k.push("RENDER_CUTOFF"),k.push("RENDER_SHADOWS","DEPTH_TEXTURE"),this.useNormalOffset&&k.push("NORMAL_OFFSET");const q=nf(h,N,A),K=new Cr(v.gl.LEQUAL,Cr.ReadOnly,c.depthRangeFor3D);for(const Y of this._groundShadowTiles){const ee=Y.toUnwrapped(),Q=c.isTileAffectedByFog(Y),ie=c.getOrCreateProgram("groundShadow",{defines:k,overrideFog:Q});this.setupShadows(ee,ie),c.uploadCommonUniforms(v,ie,ee,null,z);const de={u_matrix:c.transform.calculateProjMatrix(ee),u_ground_shadow_factor:q};ie.draw(c,v.gl.TRIANGLES,K,Kr.disabled,mn.multiply,Gr.disabled,de,"ground_shadow",c.tileExtentBuffer,c.quadTriangleIndexBuffer,c.tileExtentSegments,null,c.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?mn.unblended:mn.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(c){const h=this.painter.transform,v=h.calculatePosMatrix(c,h.worldSize);return s.ad.mat4.multiply(v,this._cascades[this.painter.currentShadowCascade].matrix,v),Float32Array.from(v)}calculateShadowPassMatrixFromMatrix(c){return s.ad.mat4.multiply(c,this._cascades[this.painter.currentShadowCascade].matrix,c),Float32Array.from(c)}setupShadows(c,h,v,N=0){if(!this.enabled)return;const A=this.painter.transform,k=this.painter.context,z=k.gl,q=this._uniformValues,K=new Float64Array(16),Y=A.calculatePosMatrix(c,A.worldSize);for(let ee=0;ee<this._cascades.length;ee++)s.ad.mat4.multiply(K,this._cascades[ee].matrix,Y),q[ee===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(K),k.activeTexture.set(z.TEXTURE0+ss.ShadowMap0+ee),this._cascades[ee].texture.bind(z.NEAREST,z.CLAMP_TO_EDGE);if(this.useNormalOffset=!!v,this.useNormalOffset){const ee=s.cd(c.canonical),Q=2/A.tileSize*s.ai/Ta.shadowMapResolution,ie=Q*this._cascades[0].boundingSphereRadius,de=Q*this._cascades[this._cascades.length-1].boundingSphereRadius,le=(v==="vector-tile"?1:3)/Math.pow(2,N-c.canonical.z-(1-A.zoom+Math.floor(A.zoom)));q.u_shadow_normal_offset=[ee,ie*le,de*le],q.u_shadow_bias=[6e-5,.0012,.012]}else q.u_shadow_bias=[36e-5,.0012,.012];h.setShadowUniformValues(k,q)}setupShadowsFromMatrix(c,h,v=!1){if(!this.enabled)return;const N=this.painter.context,A=N.gl,k=this._uniformValues,z=new Float64Array(16);for(let q=0;q<Ta.cascadeCount;q++)s.ad.mat4.multiply(z,this._cascades[q].matrix,c),k[q===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(z),N.activeTexture.set(A.TEXTURE0+ss.ShadowMap0+q),this._cascades[q].texture.bind(A.NEAREST,A.CLAMP_TO_EDGE);if(this.useNormalOffset=v,v){const q=Ta.normalOffset;k.u_shadow_normal_offset=[1,q,q],k.u_shadow_bias=[6e-5,.0012,.012]}else k.u_shadow_bias=[36e-5,.0012,.012];h.setShadowUniformValues(N,k)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(c,h,v,N){if(N[2]>=0)return{};const A=function(q,K,Y){const ee=Y/(1<<q.canonical.z);return new s.ce([q.canonical.x*ee+q.wrap*Y,q.canonical.y*ee+q.wrap*Y,0],[(q.canonical.x+1)*ee+q.wrap*Y,(q.canonical.y+1)*ee+q.wrap*Y,K])}(c,h,v).getCorners(),k=h/-N[2];N[0]<0?(s.ad.vec3.add(A[0],A[0],[N[0]*k,0,0]),s.ad.vec3.add(A[3],A[3],[N[0]*k,0,0])):N[0]>0&&(s.ad.vec3.add(A[1],A[1],[N[0]*k,0,0]),s.ad.vec3.add(A[2],A[2],[N[0]*k,0,0])),N[1]<0?(s.ad.vec3.add(A[0],A[0],[0,N[1]*k,0]),s.ad.vec3.add(A[1],A[1],[0,N[1]*k,0])):N[1]>0&&(s.ad.vec3.add(A[2],A[2],[0,N[1]*k,0]),s.ad.vec3.add(A[3],A[3],[0,N[1]*k,0]));const z={};return z.vertices=A,z.planes=[rf(A[1],A[0],A[4]),rf(A[2],A[1],A[5]),rf(A[3],A[2],A[6]),rf(A[0],A[3],A[7])],z}addShadowReceiver(c,h,v){this._receivers.add(c,s.ce.fromTileIdAndHeight(c,h,v))}getMaxCascadeForTile(c){const h=this._receivers.get(c);return h&&h.lastCascade?h.lastCascade:0}}function rf(b,c,h){const v=s.ad.vec3.sub([],h,c),N=s.ad.vec3.sub([],b,c),A=s.ad.vec3.cross([],v,N),k=s.ad.vec3.length(A);return k===0?[0,0,1,0]:(s.ad.vec3.scale(A,A,1/k),[A[0],A[1],A[2],-s.ad.vec3.dot(A,c)])}function Dd(b){const c=b.properties.get("direction"),h=s.cc(c.x,c.y,c.z);h[2]=s.ay(h[2],0,75);const v=s.cf([h[0],h[1],h[2]]);return s.ad.vec3.fromValues(v.x,v.y,v.z)}function nf(b,c,h){const v=c.properties.get("color-use-theme")==="none",N=c.properties.get("color"),A=c.properties.get("intensity"),k=c.properties.get("direction"),z=[k.x,k.y,k.z],q=h.properties.get("color-use-theme")==="none",K=h.properties.get("color"),Y=h.properties.get("intensity"),ee=Math.max(s.ad.vec3.dot([0,0,1],z),0),Q=[0,0,0];s.ad.vec3.scale(Q,K.toRenderColor(q?null:b.getLut(c.scope)).toArray01Linear().slice(0,3),Y);const ie=[0,0,0];return s.ad.vec3.scale(ie,N.toRenderColor(v?null:b.getLut(h.scope)).toArray01Linear().slice(0,3),ee*A),s.cg([Q[0]>0?Q[0]/(Q[0]+ie[0]):0,Q[1]>0?Q[1]/(Q[1]+ie[1]):0,Q[2]>0?Q[2]/(Q[2]+ie[2]):0])}function sf(b,c,h,v,N,A){const k=b.zoom,z=b.scale,q=b.worldSize,K=1/q,Y=b.aspect,ee=Math.sqrt(1+Y*Y)*Math.tan(.5*b.fovX),Q=ee*ee,ie=v-h,de=v+h;let le,he;Q>ie/de?(le=v,he=v*ee):(le=.5*de*(1+Q),he=.5*Math.sqrt(ie*ie+2*(v*v+h*h)*Q+de*de*Q*Q));const fe=b.projection.pixelsPerMeter(b.center.lat,q),Te=b._camera.getCameraToWorldMercator(),Re=[0,0,-le*K];s.ad.vec3.transformMat4(Re,Re,Te);let Oe=he*K;const $e=b._edgeInsets;if(!($e.left===0&&$e.top===0&&$e.right===0&&$e.bottom===0||$e.left===$e.right&&$e.top===$e.bottom)){const Et=b._camera.getWorldToCamera(b.worldSize,b.projection.zAxisUnit==="meters"?fe:1),pt=b._camera.getCameraToClipPerspective(b._fov,b.width/b.height,h,v);pt[8]=2*-b.centerOffset.x/b.width,pt[9]=2*b.centerOffset.y/b.height;const It=new Float64Array(16);s.ad.mat4.mul(It,pt,Et);const Kt=new Float64Array(16);s.ad.mat4.invert(Kt,It);const Zt=s.bR.fromInvProjectionMatrix(Kt,q,k,!0);for(const Qt of Zt.points){const gr=((Le=Qt)[0]/=z,Le[1]/=z,Le[2]=s.bH(Le[2],b._center.lat),Le);Oe=Math.max(Oe,s.ad.vec3.len(s.ad.vec3.subtract([],Re,gr)))}}var Le;Oe*=N/(N-1);const Fe=Math.acos(c[2]),Be=Math.atan2(-c[0],-c[1]),He=new tf;He.position=Re,He.setPitchBearing(Fe,Be);const Ke=He.getWorldToCamera(q,fe),ft=Oe*q,at=Math.min(b._mercatorZfromZoom(17)*q*-2,-2*ft),kt=He.getCameraToClipOrthographic(-ft,ft,-ft,ft,at,(ft+A*fe)/c[2]),Pt=new Float64Array(16);s.ad.mat4.multiply(Pt,kt,Ke);const Bt=s.ad.vec3.fromValues(Math.floor(1e6*Re[0])/1e6*q,Math.floor(1e6*Re[1])/1e6*q,0),st=.5*N,At=[0,0,0];s.ad.vec3.transformMat4(At,Bt,Pt),s.ad.vec3.scale(At,At,st);const rt=[Math.floor(At[0]),Math.floor(At[1]),Math.floor(At[2])],Ct=[0,0,0];s.ad.vec3.sub(Ct,At,rt),s.ad.vec3.scale(Ct,Ct,-1/st);const _t=new Float64Array(16);return s.ad.mat4.identity(_t),s.ad.mat4.translate(_t,_t,Ct),s.ad.mat4.multiply(Pt,_t,Pt),[Pt,ft]}class G3 extends s.E{constructor(c){super(),this.requestManager=c,this.models={"":{}},this.modelUris={"":{}},this.numModelsLoading={}}loadModel(c,h){return s.aN(this.requestManager.transformRequest(h,s.R.Model).url).then(v=>{if(!v)return;const N=s.aO(v),A=new s.aP(c,void 0,void 0,N);return A.computeBoundsAndApplyParent(),A}).catch(v=>{if(v&&v.status===404)return null;this.fire(new s.z(new Error(`Could not load model ${c} from ${h}: ${v.message}`)))})}load(c,h,v={keepNumReferences:!1}){this.models[h]||(this.models[h]={});const N=Object.keys(c);this.numModelsLoading[h]=(this.numModelsLoading[h]||0)+N.length;const A=[];for(const k of N)A.push(this.loadModel(k,c[k]));Promise.allSettled(A).then(k=>{for(let z=0;z<k.length;z++){const{status:q,value:K}=k[z];if(q==="fulfilled"&&K){const Y=this.models[h][N[z]];this.models[h][N[z]]={model:K,numReferences:v.keepNumReferences&&Y?Y.numReferences:1}}}this.numModelsLoading[h]-=N.length,this.fire(new s.A("data",{dataType:"style"}))}).catch(k=>{this.fire(new s.z(new Error(`Could not load models: ${k.message}`)))})}isLoaded(){for(const c in this.numModelsLoading)if(this.numModelsLoading[c]>0)return!1;return!0}hasModel(c,h){return!!this.getModel(c,h)}getModel(c,h){return this.models[h]||(this.models[h]={}),this.models[h][c]?this.models[h][c].model:void 0}addModel(c,h,v){this.models[v]||(this.models[v]={}),this.modelUris[v]||(this.modelUris[v]={}),this.hasModel(c,v)&&this.models[v][c].numReferences++,this.modelUris[v][c]=this.requestManager.normalizeModelURL(h),this.load({[c]:this.modelUris[v][c]},v)}addModels(c,h){this.models[h]||(this.models[h]={}),this.modelUris[h]||(this.modelUris[h]={});const v=this.modelUris[h];for(const N in c)this.models[h][N]={},v[N]=this.requestManager.normalizeModelURL(c[N]);this.load(v,h,{keepNumReferences:!0})}reloadModels(c){this.load(this.modelUris[c],c)}addModelsFromBucket(c,h){this.models[h]||(this.models[h]={}),this.modelUris[h]||(this.modelUris[h]={});const v={};for(const N of c)this.hasModel(N,h)?this.models[h][N].numReferences++:(this.modelUris[h][N]=this.requestManager.normalizeModelURL(N),v[N]=this.modelUris[h][N]);this.load(v,h)}removeModel(c,h){if(this.models[h]&&this.models[h][c]&&(this.models[h][c].numReferences--,this.models[h][c].numReferences===0)){const v=this.models[h][c].model;delete this.models[h][c],delete this.modelUris[h][c],v.destroy()}}listModels(c){return this.models[c]||(this.models[c]={}),Object.keys(this.models[c])}upload(c,h){this.models[h]||(this.models[h]={});for(const v in this.models[h])this.models[h][v].model&&this.models[h][v].model.upload(c.context)}}const H3=new s.a7({data:new s.a8(s.a5.colorTheme.data)}),e1={"mbx-indoor-active-floorplans":{default:["literal",[]]},"mbx-indoor-underground":{default:["literal",!1]},"mbx-indoor-loaded-levels":{default:["literal",[]]},"mbx-indoor-level-height":{default:["literal",{}]},"mbx-indoor-level-base":{default:["literal",{}]},"mbx-indoor-level-selected":{default:["literal",{}]},"mbx-indoor-level-overlapped":{default:["literal",{}]}};function IS(b){return b=b||{},Object.assign(b,e1)}class OS extends s.E{constructor(c){super(),this.mergeFloors=!0,this._scope=void 0,this._queryFeatureSetId=void 0,this._buildingEntryFeatureSetId=void 0,this._selectedFloorplan=void 0,this._indoorData=void 0,this._selectedLevel=void 0,this._floorplanStates={},s.aQ(["_onLoad","_onMove","_checkFloorplanVisible"],this),this._map=c,this._checkFloorplanVisible(!0),this._map.on("load",this._onLoad),this._map.on("move",this._onMove)}destroy(){this._map.indoor.off("load",this._onLoad),this._map.indoor.off("move",this._onMove),this._map=void 0}_onLoad(){this._map.style.forEachFragmentStyle(c=>{c.stylesheet.indoor&&(this._queryFeatureSetId?this.fire(new s.z(new Error("Multiple indoor map styles detected, simultaneous usage is not allowed currently."))):(this._queryFeatureSetId=c.stylesheet.indoor.floorplanFeaturesetId,this._buildingEntryFeatureSetId=c.stylesheet.indoor.buildingFeaturesetId,this._scope=c.scope))}),this._queryFeatureSetId&&this._buildingEntryFeatureSetId&&this._map.addInteraction("mbx-indoor-buildingclick",{type:"click",target:{featuresetId:this._buildingEntryFeatureSetId,importId:this._scope},handler:c=>(c.feature&&c.feature.properties.floorplan&&this.selectFloorplan(c.feature.properties.floorplan),!0)}),this._checkFloorplanVisible(!0)}_onMove(){this._checkFloorplanVisible(!1)}_checkFloorplanVisible(c){if(!this._queryFeatureSetId||!this._map.isStyleLoaded()||this._map.transform.zoom<13)return;this._indoorData&&!function(k,z){const[q,K]=k,{center:Y,radius:ee}=z,[Q,ie]=Y,de=Math.abs(q-Q);return Math.sqrt((de>180?360-de:de)**2+(K-ie)**2)<=ee}([this._map.getCenter().lng,this._map.getCenter().lat],this._indoorData.circumCircle)&&(this._indoorData=void 0,this._selectedFloorplan=void 0,this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!1),this._map.setConfigProperty(this._scope,"mbx-indoor-active-floorplans",["literal",[]]),this.fire(new s.A("floorplangone")));const h={target:{featuresetId:this._queryFeatureSetId,importId:this._scope}},v=new s.P(this._map.transform.width/2,this._map.transform.height/2),N=[new s.P(0,0),new s.P(this._map.transform.width,this._map.transform.height)],A=this._map.queryRenderedFeatures(c?N:v,h);A.length>0&&(this._selectedFloorplan&&A[0].properties.id===this._selectedFloorplan.properties.id||(this._selectedFloorplan=A[0],this._floorplanSelected(!1)))}_floorplanSelected(c){this._indoorData=JSON.parse(this._selectedFloorplan.properties["indoor-data"]),this._indoorData.id=this._selectedFloorplan.properties.id,this._indoorData.circumCircle=function(A){const[[k,z],[q,K]]=A,Y=(q-k+360)%360,ee=Y>180?360-Y:Y;return{center:[(k+ee/2+360)%360,(z+K)/2],radius:Math.sqrt(ee**2+(K-z)**2)/2}}(this._indoorData.extent),this._floorplanStates[this._indoorData.id]||(this._floorplanStates[this._indoorData.id]={});const h=this._floorplanStates[this._indoorData.id].selectedBuilding,v=this._floorplanStates[this._indoorData.id].selectedLevel;let N;if(this._map.setConfigProperty(this._scope,"mbx-indoor-active-floorplans",this._indoorData.floorplanIDs),this._selectedLevel)for(const A of this._indoorData.levels)A.id===this._selectedLevel.id&&(N=A.id);if(this.fire(new s.A("floorplanselected",{buildings:this._indoorData.buildings,levels:this._indoorData.levels,selectedLevelId:N})),h){const A=this._indoorData.buildings.find(k=>k.id===h);this._buildingSelected(A,!1)}else this._indoorData.buildings.length>0&&this._buildingSelected(this._indoorData.buildings[0],!1);if(v){const A=this._indoorData.levels.find(k=>k.id===v);this._updateLevels(A,c)}else c&&this._indoorData["default-levels"].length>0&&this.selectLevel(this._indoorData["default-levels"][0])}_buildingSelected(c,h){h&&c&&c.extent&&this._map.fitBounds(c.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}),this._floorplanStates[this._indoorData.id].selectedBuilding=c?c.id:void 0;const v=this._indoorData.levels.filter(N=>c.levels.includes(N.id));this.fire(new s.A("buildingselected",{buildingId:c.id,levels:v}))}_levelSelected(c){if(c==="overview")this._updateLevels(void 0,!0);else{const h=this._indoorData.levels.find(v=>v.id===c);this._updateLevels(h,!0)}this.fire(new s.A("levelselected",{levelId:c==="overview"?void 0:c}))}_updateLevels(c,h){if(!c)return this._map.setConfigProperty(this._scope,"mbx-indoor-loaded-levels",["literal",[]]),this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!1),this._floorplanStates[this._indoorData.id].selectedLevel=void 0,void(h&&this._indoorData.extent&&this._map.fitBounds(this._indoorData.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}));function v(K){const Y=K.indexOf("/floor/");if(Y===-1)return K;const ee=Y+7,Q=K.indexOf("/",ee);return Q===-1?K.slice(ee):K.slice(ee,Q)}this._selectedLevel=c,this._floorplanStates[this._indoorData.id].selectedLevel=c?c.id:void 0;const N=[],A={},k={},z={},q={};for(const K of this._indoorData.levels)if(N.push(K.id),A[K.id]=K.height,k[K.id]=K.base,c){if(this.mergeFloors){const Y=v(c.id),ee=v(K.id);z[K.id]=ee===Y?"true":"false"}else z[K.id]=K.id===c.id?"true":"false";q[K.id]=K.base<c.base?"true":"false"}else q[K.id]=!0;if(this._map.setConfigProperty(this._scope,"mbx-indoor-loaded-levels",["literal",N]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-height",["literal",A]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-base",["literal",k]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-selected",["literal",z]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-overlapped",["literal",q]),c&&(this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!!c.isUnderground),h&&c.extent)){const K=this._map.cameraForBounds(c.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}),Y=this._map.getZoom(),ee=K.zoom?Math.abs(Y-K.zoom):0;this._map.fitBounds(c.extent,ee>=1?{pitch:this._map.getPitch(),bearing:this._map.getBearing()}:{pitch:this._map.getPitch(),bearing:this._map.getBearing(),zoom:Y})}}selectFloorplan(c){const h={target:{featuresetId:this._queryFeatureSetId,importId:this._scope}},v=[new s.P(0,0),new s.P(this._map.transform.width,this._map.transform.height)],N=this._map.queryRenderedFeatures(v,h);if(N.length>0){for(const A of N)if(JSON.parse(A.properties["indoor-data"]).floorplanIDs.includes(c)){this._selectedFloorplan=A,this._floorplanSelected(!0);break}}}selectBuilding(c){const h=this._indoorData.buildings.find(v=>v.id===c);this._buildingSelected(h,!0)}selectLevel(c){this._levelSelected(c)}}function RS(b){if(!b.metadata||!b.metadata.content_area)return;const c=s.q.devicePixelRatio,{left:h,top:v,width:N,height:A}=b.metadata.content_area,k=h*c,z=v*c;return[k,z,k+N*c,z+A*c]}function Bx(b){if(b)return b.map(([c,h])=>[c*s.q.devicePixelRatio,h*s.q.devicePixelRatio])}class q3{constructor(c,h,v){this.id=c,this.scope=h,this.sourceCache=v,this.pendingRequests=new Set,this.missingRequests=new Set}addPendingRequest(c){this.missingRequests.has(c.name)||this.pendingRequests.has(c.name)||this.pendingRequests.add(c.name)}hasPendingRequests(){return this.pendingRequests.size>0}resolvePendingRequests(){const c=new Map;if(!this.sourceCache.loaded())return c;const h=this.sourceCache.getVisibleCoordinates();if(h.length===0)return c;const v=this.sourceCache.getSource();if(!(v instanceof Rl))return c;const N=h.map(k=>this.sourceCache.getTile(k)),A=v.getImages(N,Array.from(this.pendingRequests));for(const[k,z]of A)c.set(s.I.from({name:k,iconsetId:this.id}),z),this.pendingRequests.delete(k);for(const k of this.pendingRequests)this.missingRequests.add(k);return this.pendingRequests.clear(),c}}const Bh=(b,c)=>ht(b,c&&c.filter(h=>h.identifier!=="source.canvas")),W3=s.aA(kn,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setSnow","setRain","setProjection","setCamera","addImport","removeImport","updateImport","addIconset","removeIconset"]),K3=s.aA(kn,["setCenter","setZoom","setBearing","setPitch"]),$x=new Set(["background","sky","slot","custom"]),DS={version:8,layers:[],sources:{}},Ag={duration:300,delay:0};class dc extends s.E{constructor(c,h={}){super(),this.map=c,this.scope=h.scope||"",this.globalId=null,this.fragments=[],this.importDepth=h.importDepth||0,this.importsCache=h.importsCache||new Map,this.resolvedImports=h.resolvedImports||new Set,this.transition=s.l({},Ag),this._buildingIndex=new TS(this),this.crossTileSymbolIndex=new U3,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._clipLayerPresent=!1,this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=h.styleChanges||new jr,this.dispatcher=h.dispatcher?h.dispatcher:new s.D(s.cj(),this),h.imageManager?this.imageManager=h.imageManager:(this.imageManager=new Yr(this.map._spriteFormat),this.imageManager.setEventedParent(this)),this.imageManager.addScope(this.scope),this.glyphManager=h.glyphManager?h.glyphManager:new s.ck(c._requestManager,h.localFontFamily?s.cl.all:h.localIdeographFontFamily?s.cl.ideographs:s.cl.none,h.localFontFamily||h.localIdeographFontFamily),h.modelManager?this.modelManager=h.modelManager:(this.modelManager=new G3(c._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._order=[],this._markersNeedUpdate=!1,this.options=h.configOptions?h.configOptions:new Map,this._configDependentLayers=h.configDependentLayers?h.configDependentLayers:new Set,this._config=h.config,this._styleColorTheme={lut:null,lutLoading:!1,lutLoadingCorrelationID:0,colorTheme:null,colorThemeOverride:h.colorThemeOverride},this._styleColorThemeForScope={},this._initialConfig=h.initialConfig,this.dispatcher.broadcast("setReferrer",s.cm());const v=this;this._rtlTextPluginCallback=dc.registerForPluginStateChange(N=>{v.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:N.pluginStatus,pluginURL:N.pluginURL},(A,k)=>{if(s.cn(A),k&&k.every(z=>z))for(const z in v._sourceCaches){const q=v._sourceCaches[z],K=q.getSource().type;K!=="vector"&&K!=="geojson"||q.reload()}})}),this.on("data",N=>{if(N.dataType!=="source"||N.sourceDataType!=="metadata")return;const A=this.getOwnSource(N.sourceId);if(A&&A.vectorLayerIds)for(const k in this._layers){const z=this._layers[k];z.source===A.id&&this._validateLayer(z)}})}load(c){return c?(typeof c=="string"?this.loadURL(c):this.loadJSON(c),this):this}_getGlobalId(c){if(!c)return null;if(typeof c=="string"){if(s.f(c))return c;const h=s.co(c);if(!h.startsWith("http"))try{return new URL(h,location.href).toString()}catch{return h}return h}return`json://${s.cp(JSON.stringify(c))}`}_diffStyle(c,h,v){this.globalId=this._getGlobalId(c);const N=(A,k)=>{try{k(null,this.setState(A,v))}catch(z){k(z,!1)}};if(typeof c=="string"){const A=this.map._requestManager.normalizeStyleURL(c),k=this.map._requestManager.transformRequest(A,s.R.Style);s.n(k,(z,q)=>{z?this.fire(new s.z(z)):q&&N(q,h)})}else typeof c=="object"&&N(c,h)}loadURL(c,h={}){this.fire(new s.A("dataloading",{dataType:"style"}));const v=typeof h.validate=="boolean"?h.validate:!s.f(c);this.globalId=this._getGlobalId(c),c=this.map._requestManager.normalizeStyleURL(c,h.accessToken),this.resolvedImports.add(c);const N=this.importsCache.get(c);if(N)return this._load(N,v);const A=this.map._requestManager.transformRequest(c,s.R.Style);this._request=s.n(A,(k,z)=>{if(this._request=null,k)this.fire(new s.z(k));else if(z)return this.importsCache.set(c,z),this._load(z,v)})}loadJSON(c,h={}){this.fire(new s.A("dataloading",{dataType:"style"})),this.globalId=this._getGlobalId(c),this._request=s.q.frame(()=>{this._request=null,this._load(c,h.validate!==!1)})}loadEmpty(){this.fire(new s.A("dataloading",{dataType:"style"})),this._load(DS,!1)}_loadImports(c,h,v){if(this.importDepth>=4)return s.w("Style doesn't support nesting deeper than 5"),Promise.resolve();const N=[];for(const A of c){const k=this._createFragmentStyle(A),z=new Promise(Y=>{k.once("style.import.load",Y),k.once("error",Y)}).then(()=>this.mergeAll());if(N.push(z),this.resolvedImports.has(A.url)){k.loadEmpty();continue}const q=A.data||this.importsCache.get(A.url);q?(k.loadJSON(q,{validate:h}),this._isInternalStyle(q)&&(k.globalId=null)):A.url?k.loadURL(A.url,{validate:h}):k.loadEmpty();const K={style:k,id:A.id,config:A.config};if(v){const Y=this.fragments.findIndex(({id:ee})=>ee===v);this.fragments=this.fragments.slice(0,Y).concat(K).concat(this.fragments.slice(Y))}else this.fragments.push(K)}return Promise.allSettled(N)}getImportGlobalIds(c=this,h=new Set){for(const v of c.fragments)v.style.globalId&&h.add(v.style.globalId),this.getImportGlobalIds(v.style,h);return[...h.values()]}_createFragmentStyle(c){const h=this.scope?s.C(c.id,this.scope):c.id;let v;const N=this._initialConfig&&this._initialConfig[h];(c.config||N)&&(v=s.l({},c.config,N));const A=new dc(this.map,{scope:h,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,config:v,configOptions:this.options,colorThemeOverride:c["color-theme"],configDependentLayers:this._configDependentLayers});return A.setEventedParent(this.map,{style:A}),A}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.updateConfigDependencies(),this.map._triggerCameraUpdate(this.camera),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),this._shouldPrecompile=this.map._precompilePrograms&&this.isRootStyle()}_isInternalStyle(c){return this.isRootStyle()&&(c.fragment||!!c.schema&&c.fragment!==!1)}_load(c,h){const v=c.indoor?IS(c.schema):c.schema;if(this._isInternalStyle(c)){const k=s.l({},DS,{imports:[{id:"basemap",data:c,url:""}]});return void this._load(k,h)}if(this.updateConfig(this._config,v),h&&Bh(this,Ji(c)))return;this._loaded=!0,this.stylesheet=s.cq(c);const N=()=>{for(const K in c.sources)this.addSource(K,c.sources[K],{validate:!1,isInitialLoad:!0});if(c.iconsets)for(const K in c.iconsets)this.addIconset(K,c.iconsets[K]);c.sprite?this._loadIconset(c.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),this.setGlyphsUrl(c.glyphs);const k=vg(this.stylesheet.layers);if(this._order=k.map(K=>K.id),this.stylesheet.light&&s.w("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(this.stylesheet.lights.length===1&&this.stylesheet.lights[0].type==="flat"){const K=this.stylesheet.lights[0];this.light=new xt(K.properties,K.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new xt(this.stylesheet.light)),this._layers={};for(const K of k){const Y=s.cv(K,this.scope,this._styleColorTheme.lut,this.options);Y.configDependencies.size!==0&&this._configDependentLayers.add(Y.fqid),Y.setEventedParent(this,{layer:{id:Y.id}}),this._layers[Y.id]=Y;const ee=this.getOwnLayerSourceCache(Y),Q=!!this.directionalLight&&this.directionalLight.shadowsEnabled();ee&&Y.canCastShadows()&&Q&&(ee.castsShadows=!0)}this.stylesheet.featuresets&&this.setFeaturesetSelectors(this.stylesheet.featuresets),this.stylesheet.models&&this.modelManager.addModels(this.stylesheet.models,this.scope);const z=this.stylesheet.terrain;z&&(this.checkCanvasFingerprintNoise(),this.disableElevatedTerrain||this.terrainSetForDrapingOnly()||this._createTerrain(z,1)),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.snow&&this._createSnow(this.stylesheet.snow),this.stylesheet.rain&&this._createRain(this.stylesheet.rain),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.fire(new s.A("data",{dataType:"style"}));const q=this.isRootStyle();c.imports?this._loadImports(c.imports,h).then(()=>{this._reloadImports(),this.fire(new s.A(q?"style.load":"style.import.load"))}):(this._reloadImports(),this.fire(new s.A(q?"style.load":"style.import.load")))};this._styleColorTheme.colorTheme=this.stylesheet["color-theme"];const A=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(A){const k=this._evaluateColorThemeData(A);this._loadColorTheme(k).then(()=>{N()}).catch(z=>{s.w(`Couldn't load color theme from the stylesheet: ${z}`),N()})}else this._styleColorTheme.lut=null,N()}isRootStyle(){return this.importDepth===0}mergeAll(){let c,h,v,N,A,k,z,q,K,Y;const ee={};this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(Q=>{if(Q.stylesheet){if(Q.light!=null&&(c=Q.light),Q.stylesheet.lights)for(const ie of Q.stylesheet.lights)ie.type==="ambient"&&Q.ambientLight!=null&&(h=Q.ambientLight),ie.type==="directional"&&Q.directionalLight!=null&&(v=Q.directionalLight);N=this._prioritizeTerrain(N,Q.terrain,Q.stylesheet.terrain),Q.stylesheet.fog&&Q.fog!=null&&(A=Q.fog),Q.stylesheet.snow&&Q.snow!=null&&(k=Q.snow),Q.stylesheet.rain&&Q.rain!=null&&(z=Q.rain),Q.stylesheet.camera!=null&&(Y=Q.stylesheet.camera),Q.stylesheet.projection!=null&&(q=Q.stylesheet.projection),Q.stylesheet.transition!=null&&(K=Q.stylesheet.transition),ee[Q.scope]=Q._styleColorTheme}}),this.light=c,this.ambientLight=h,this.directionalLight=v,this.fog=A,this.snow=k,this.rain=z,this._styleColorThemeForScope=ee,N===null?delete this.terrain:this.terrain=N,this.camera=Y||{"camera-projection":"perspective"},this.projection=q||{name:"mercator"},this.transition=s.l({},Ag,K),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(c){const h=v=>{for(const N of v.fragments)h(N.style);c(v)};h(this)}_prioritizeTerrain(c,h,v){const N=c&&c.drapeRenderMode===0;return v===null?h&&h.drapeRenderMode===0?h:N?c:null:h!=null&&(!c||N||h&&h.drapeRenderMode===1)?h:c}mergeTerrain(){let c;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(h=>{c=this._prioritizeTerrain(c,h.terrain,h.stylesheet.terrain)}),c===null?delete this.terrain:this.terrain=c}mergeProjection(){let c;this.forEachFragmentStyle(h=>{h.stylesheet.projection!=null&&(c=h.stylesheet.projection)}),this.projection=c||{name:"mercator"}}mergeSources(){const c={},h={},v={};this.forEachFragmentStyle(N=>{for(const A in N._sourceCaches){const k=s.C(A,N.scope);c[k]=N._sourceCaches[A]}for(const A in N._otherSourceCaches){const k=s.C(A,N.scope);h[k]=N._otherSourceCaches[A]}for(const A in N._symbolSourceCaches){const k=s.C(A,N.scope);v[k]=N._symbolSourceCaches[A]}}),this._mergedSourceCaches=c,this._mergedOtherSourceCaches=h,this._mergedSymbolSourceCaches=v}mergeLayers(){const c={},h=[],v={};this._mergedSlots=[],this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this.forEachFragmentStyle(A=>{for(const k of A._order){const z=A._layers[k];if(z.type==="slot"){const q=s.cr(k);if(c[q])continue;c[q]=[]}z.slot&&c[z.slot]?c[z.slot].push(z):h.push(z)}}),this._mergedOrder=[];const N=(A=[])=>{for(const k of A)if(k.type==="slot"){const z=s.cr(k.id);c[z]&&N(c[z]),this._mergedSlots.push(z)}else{const z=s.C(k.id,k.scope);this._mergedOrder.push(z),v[z]=k,k.is3D(!!this.terrain)&&(this._has3DLayers=!0),k.type==="circle"&&(this._hasCircleLayers=!0),k.type==="symbol"&&(this._hasSymbolLayers=!0),k.type==="clip"&&(this._clipLayerPresent=!0)}};N(h),this._mergedOrder.sort((A,k)=>{const z=v[A],q=v[k];return z.hasInitialOcclusionOpacityProperties?q.is3D(!!this.terrain)?1:0:z.is3D(!!this.terrain)&&q.hasInitialOcclusionOpacityProperties?-1:0}),this._mergedLayers=v,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}getCamera(){return this.stylesheet.camera}setCamera(c){return this.stylesheet.camera=s.l({},this.stylesheet.camera,c),this.camera=this.stylesheet.camera,this}_evaluateColorThemeData(c){return c.data?function(h,v,N){const A=s.l({},v);for(const z of Object.keys(s.a5.colorTheme))A[z]===void 0&&(A[z]=s.a5.colorTheme[z].default);const k=new s.a6(H3,h,new Map(N));return k.setTransitionOrValue(A,N),k.untransitioned().possiblyEvaluate(new s.aa(0))}(this.scope,c,this.options).get("data"):null}_loadColorTheme(c){this._styleColorTheme.lutLoading=!0,this._styleColorTheme.lutLoadingCorrelationID+=1;const h=this._styleColorTheme.lutLoadingCorrelationID;return new Promise((v,N)=>{const A="data:image/png;base64,";if(!c||c.length===0)return this._styleColorTheme.lut=null,this._styleColorTheme.lutLoading=!1,void v();let k=c;k.startsWith(A)||(k=A+k);const z=s.I.from("mapbox-reserved-lut"),q=new Image;q.src=k,q.onerror=()=>{this._styleColorTheme.lutLoading=!1,N(new Error("Failed to load image data"))},q.onload=()=>{if(this._styleColorTheme.lutLoadingCorrelationID!==h)return void v();this._styleColorTheme.lutLoading=!1;const{width:K,height:Y,data:ee}=s.q.getImageData(q);if(Y>32)return void N(new Error("The height of the image must be less than or equal to 32 pixels."));if(K!==Y*Y)return void N(new Error("The width of the image must be equal to the height squared."));this.getImage(z,this.scope)&&this.removeImage(z,this.scope),this.addImage(z,this.scope,{data:new s.r({width:K,height:Y},ee),pixelRatio:1,sdf:!1,usvg:!1,version:0});const Q=this.imageManager.getImage(z,this.scope);Q?(this._styleColorTheme.lut={image:Q.data,data:c},v()):N(new Error("Missing LUT image."))}})}getLut(c){const h=this._styleColorThemeForScope[c];return h?h.lut:null}setProjection(c){c?this.stylesheet.projection=c:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?(this.getTerrain()||this.stylesheet.terrain)&&!this.disableElevatedTerrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null,0))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(c){this._spriteRequest=function(h,v,N){let A,k,z;const q=s.q.devicePixelRatio>1?"@2x":"";let K=s.n(v.transformRequest(v.normalizeSpriteURL(h,q,".json"),s.R.SpriteJSON),(Q,ie)=>{K=null,z||(z=Q,A=ie,ee())}),Y=s.o(v.transformRequest(v.normalizeSpriteURL(h,q,".png"),s.R.SpriteImage),(Q,ie)=>{Y=null,z||(z=Q,k=ie,ee())});function ee(){if(z)N(z);else if(A&&k){const Q=s.q.getImageData(k),ie={};for(const de in A){const{width:le,height:he,x:fe,y:Te,sdf:Re,pixelRatio:Oe,stretchX:$e,stretchY:Le,content:Fe}=A[de],Be=new s.r({width:le,height:he});s.r.copy(Q,Be,{x:fe,y:Te},{x:0,y:0},{width:le,height:he},null),ie[de]={data:Be,pixelRatio:Oe,sdf:Re,stretchX:$e,stretchY:Le,content:Fe,usvg:!1}}N(null,ie)}}return{cancel(){K&&(K.cancel(),K=null),Y&&(Y.cancel(),Y=null)}}}(c,this.map._requestManager,(h,v)=>{if(this._spriteRequest=null,h)this.fire(new s.z(h));else if(v){const N=new Map;for(const A in v)N.set(s.I.from(A),v[A]);this.addImages(N,this.scope)}this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new s.A("data",{dataType:"style"}))})}addIconset(c,h){if(h.type==="sprite")return void this._loadSprite(h.url);const v=this.getOwnSourceCache(h.source);if(!v)return void this.fire(new s.z(new Error(`Source "${h.source}" as specified by iconset "${c}" does not exist and cannot be used as an iconset source`)));const N=v.getSource();if(N.type!=="raster-array")return void this.fire(new s.z(new Error(`Source "${h.source}" as specified by iconset "${c}" is not a "raster-array" source and cannot be used as an iconset source`)));N.partial=!1;const A=new q3(c,this.scope,v);this.imageManager.addImageProvider(A,this.scope)}removeIconset(c){this.imageManager.removeImageProvider(c,this.scope)}_loadIconset(c){if(!s.f(c)&&this.map._spriteFormat!=="icon_set"||this.map._spriteFormat==="raster")return void this._loadSprite(c);const h=this.map._spriteFormat==="auto";var v,N;this._spriteRequest=(N=(A,k)=>{if(this._spriteRequest=null,A)h?this._loadSprite(c):this.fire(new s.z(A));else if(k){const z=new Map;for(const q in k)z.set(s.I.from(q),k[q]);this.addImages(z,this.scope)}this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new s.A("data",{dataType:"style"}))},s.bj((v=this.map._requestManager).transformRequest(v.normalizeIconsetURL(c),s.R.Iconset),(A,k)=>{if(A)return void N(A);const z={},q=s.ch(new s.bi(k));for(const K of q.icons){const Y={version:1,pixelRatio:s.q.devicePixelRatio,content:RS(K),stretchX:K.metadata?Bx(K.metadata.stretch_x_areas):void 0,stretchY:K.metadata?Bx(K.metadata.stretch_y_areas):void 0,sdf:!1,usvg:!0,icon:K};z[K.name]=Y}N(null,z)}))}_validateLayer(c){const h=this.getOwnSource(c.source);if(!h)return;const v=c.sourceLayer;v&&(h.type==="geojson"||h.vectorLayerIds&&h.vectorLayerIds.indexOf(v)===-1)&&this.fire(new s.z(new Error(`Source layer "${v}" does not exist on source "${h.id}" as specified by style layer "${c.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._changes.getUpdatedSourceCaches()).length)return!1;for(const c in this._sourceCaches)if(!this._sourceCaches[c].loaded())return!1;if(!this.imageManager.isLoaded()||this.imageManager.hasPatternsInFlight()||!this.modelManager.isLoaded()||this._styleColorTheme.lutLoading)return!1;for(const{style:c}of this.fragments)if(!c.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map((c,h)=>{const v=this.fragments[h];return v&&v.style&&(c.data=v.style.serialize()),c})}_serializeSources(){const c={};for(const h in this._sourceCaches){const v=this._sourceCaches[h].getSource();c[v.id]||(c[v.id]=v.serialize())}return c}_serializeLayers(c){const h=[];for(const v of c){const N=this._layers[v];N&&N.type!=="custom"&&h.push(N.serialize())}return h}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasSnowTransition(){return!!this.snow&&this.snow.hasTransition()}hasRainTransition(){return!!this.rain&&this.rain.hasTransition()}hasTransitions(){if(this.hasLightTransitions()||this.hasFogTransition()||this.hasSnowTransition()||this.hasRainTransition())return!0;for(const c in this._sourceCaches)if(this._sourceCaches[c].hasTransition())return!0;for(const c in this._layers)if(this._layers[c].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}_getOrder(c){return c?this.order:this._mergedOrder}isLayerDraped(c){return!!this.terrain&&c.isDraped(this.getLayerSourceCache(c))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(c){const h=this.getOwnLayer(c);if(h)return h;this.fire(new s.z(new Error(`The layer '${c}' does not exist in the map's style.`)))}_checkSource(c){const h=this.getOwnSource(c);if(h)return h;this.fire(new s.z(new Error(`The source '${c}' does not exist in the map's style.`)))}precompilePrograms(c,h){const v=this.map.painter;if(v)for(let N=c.minzoom||0;N<(c.maxzoom||25.5);N++){const A=c.getProgramIds();if(A)for(const k of A){const z=c.getDefaultProgramParams(k,h.zoom,this._styleColorTheme.lut);z&&(v.style=this,this.fog&&(v._fogVisible=!0,z.overrideFog=!0,v.getOrCreateProgram(k,z)),v._fogVisible=!1,z.overrideFog=!1,v.getOrCreateProgram(k,z),(this.stylesheet.terrain||this.stylesheet.projection&&this.stylesheet.projection.name==="globe")&&(z.overrideRtt=!0,v.getOrCreateProgram(k,z)))}}}update(c){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(c),this.directionalLight&&this.directionalLight.recalculate(c);const h=this.calculateLightsBrightness();c.brightness=h||0,h!==this._brightness&&(this._brightness=h,this.dispatcher.broadcast("setBrightness",h));const v=this._changes.isDirty();let N=!1;if(this._changes.isDirty()){const z=this._changes.getLayerUpdatesByScope();for(const q in z){const{updatedIds:K,removedIds:Y}=z[q];(K||Y)&&(this._updateWorkerLayers(q,K,Y),N=!0)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(c),this.light&&this.light.updateTransitions(c),this.ambientLight&&this.ambientLight.updateTransitions(c),this.directionalLight&&this.directionalLight.updateTransitions(c),this.fog&&this.fog.updateTransitions(c),this.snow&&this.snow.updateTransitions(c),this.rain&&this.rain.updateTransitions(c),this._changes.reset()}const A={};for(const z in this._mergedSourceCaches){const q=this._mergedSourceCaches[z];A[z]=q.used,q.used=!1,q.tileCoverLift=0}for(const z of this._mergedOrder){const q=this._mergedLayers[z];if(q.recalculate(c,this._availableImages),!q.isHidden(c.zoom)){const K=this.getLayerSourceCache(q);K&&(K.used=!0,K.tileCoverLift=Math.max(K.tileCoverLift,q.tileCoverLift()))}!this._precompileDone&&this._shouldPrecompile&&("requestIdleCallback"in window?requestIdleCallback(()=>{this.precompilePrograms(q,c)}):this.precompilePrograms(q,c))}this._shouldPrecompile&&(this._precompileDone=!0),this.terrain&&N&&this.mergeLayers();const k=this.imageManager.getPendingImageProviders();for(const z of k)z.sourceCache.used=!0;for(const z in A){const q=this._mergedSourceCaches[z];A[z]!==q.used&&q.getSource().fire(new s.A("data",{sourceDataType:"visibility",dataType:"source",sourceId:q.getSource().id}))}this.light&&this.light.recalculate(c),this.terrain&&this.terrain.recalculate(c),this.fog&&this.fog.recalculate(c),this.snow&&this.snow.recalculate(c),this.rain&&this.rain.recalculate(c),this.z=c.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),this.imageManager.clearUpdatedImages(this.scope),v&&this.fire(new s.A("data",{dataType:"style"}))}updateImageProviders(){const c=this.imageManager.getPendingImageProviders();for(const h of c){const v=h.resolvePendingRequests();this.addImages(v,h.scope)}}_updateTilesForChangedImages(){const c={};for(const h in this._mergedSourceCaches){const v=this._mergedSourceCaches[h].getSource().scope;c[v]=c[v]||this._changes.getUpdatedImages(v),c[v].length!==0&&this._mergedSourceCaches[h].reloadTilesForDependencies(["icons","patterns"],c[v])}for(const h in c)this._changes.resetUpdatedImages(h)}_updateWorkerLayers(c,h,v){const N=this.getFragmentStyle(c);N&&this.dispatcher.broadcast("updateLayers",{layers:h?N._serializeLayers(h):[],scope:c,removedIds:v||[],options:N.options})}setState(c,h){if(this._checkLoaded(),Bh(this,Ji(c)))return!1;(c=s.cq(c)).layers=vg(c.layers);const v=function(k,z){if(!k)return[{command:kn.setStyle,args:[z]}];let q=[];try{if(!s.bn(k.version,z.version))return[{command:kn.setStyle,args:[z]}];if(s.bn(k.center,z.center)||q.push({command:kn.setCenter,args:[z.center]}),s.bn(k.zoom,z.zoom)||q.push({command:kn.setZoom,args:[z.zoom]}),s.bn(k.bearing,z.bearing)||q.push({command:kn.setBearing,args:[z.bearing]}),s.bn(k.pitch,z.pitch)||q.push({command:kn.setPitch,args:[z.pitch]}),s.bn(k.sprite,z.sprite)||q.push({command:kn.setSprite,args:[z.sprite]}),s.bn(k.glyphs,z.glyphs)||q.push({command:kn.setGlyphs,args:[z.glyphs]}),s.bn(k.imports,z.imports)||function(ie=[],de=[],le){de=de||[];const he=(ie=ie||[]).map(In),fe=de.map(In),Te=ie.reduce(Ga,{}),Re=de.reduce(Ga,{}),Oe=he.slice();let $e,Le,Fe,Be;for($e=0,Le=0;$e<he.length;$e++)Fe=he[$e],Re.hasOwnProperty(Fe)?Le++:(le.push({command:kn.removeImport,args:[Fe]}),Oe.splice(Oe.indexOf(Fe,Le),1));for($e=0,Le=0;$e<fe.length;$e++)Fe=fe[fe.length-1-$e],Oe[Oe.length-1-$e]!==Fe&&(Te.hasOwnProperty(Fe)?(le.push({command:kn.removeImport,args:[Fe]}),Oe.splice(Oe.lastIndexOf(Fe,Oe.length-Le),1)):Le++,Be=Oe[Oe.length-$e],le.push({command:kn.addImport,args:[Re[Fe],Be]}),Oe.splice(Oe.length-$e,0,Fe));for(const He of de){const Ke=Te[He.id];Ke&&!s.bn(Ke,He)&&le.push({command:kn.updateImport,args:[He.id,He]})}}(k.imports,z.imports,q),s.bn(k.transition,z.transition)||q.push({command:kn.setTransition,args:[z.transition]}),s.bn(k.light,z.light)||q.push({command:kn.setLight,args:[z.light]}),s.bn(k.fog,z.fog)||q.push({command:kn.setFog,args:[z.fog]}),s.bn(k.snow,z.snow)||q.push({command:kn.setSnow,args:[z.snow]}),s.bn(k.rain,z.rain)||q.push({command:kn.setRain,args:[z.rain]}),s.bn(k.projection,z.projection)||q.push({command:kn.setProjection,args:[z.projection]}),s.bn(k.lights,z.lights)||q.push({command:kn.setLights,args:[z.lights]}),s.bn(k.camera,z.camera)||q.push({command:kn.setCamera,args:[z.camera]}),s.bn(k.iconsets,z.iconsets)||function(ie,de,le){let he;for(he in de=de||{},ie=ie||{})ie.hasOwnProperty(he)&&(de.hasOwnProperty(he)||le.push({command:kn.removeIconset,args:[he]}));for(he in de){if(!de.hasOwnProperty(he))continue;const fe=de[he];ie.hasOwnProperty(he)?s.bn(ie[he],fe)||(le.push({command:kn.removeIconset,args:[he]}),le.push({command:kn.addIconset,args:[he,fe]})):le.push({command:kn.addIconset,args:[he,fe]})}}(k.iconsets,z.iconsets,q),!s.bn(k["color-theme"],z["color-theme"]))return[{command:kn.setStyle,args:[z]}];const K={},Y=[];(function(ie,de,le,he){let fe;for(fe in de=de||{},ie=ie||{})ie.hasOwnProperty(fe)&&(de.hasOwnProperty(fe)||Ix(fe,le,he));for(fe in de){if(!de.hasOwnProperty(fe))continue;const Te=de[fe];ie.hasOwnProperty(fe)?s.bn(ie[fe],Te)||(ie[fe].type==="geojson"&&Te.type==="geojson"&&vr(ie,de,fe)?le.push({command:kn.setGeoJSONSourceData,args:[fe,Te.data]}):Km(fe,de,le,he)):zl(fe,de,le)}})(k.sources,z.sources,Y,K);const ee=[];k.layers&&k.layers.forEach(ie=>{ie.source&&K[ie.source]?q.push({command:kn.removeLayer,args:[ie.id]}):ee.push(ie)});let Q=k.terrain;Q&&K[Q.source]&&(q.push({command:kn.setTerrain,args:[void 0]}),Q=void 0),q=q.concat(Y),s.bn(Q,z.terrain)||q.push({command:kn.setTerrain,args:[z.terrain]}),function(ie,de,le){de=de||[];const he=(ie=ie||[]).map(In),fe=de.map(In),Te=ie.reduce(Ga,{}),Re=de.reduce(Ga,{}),Oe=he.slice(),$e=Object.create(null);let Le,Fe,Be,He,Ke,ft,at;for(Le=0,Fe=0;Le<he.length;Le++)Be=he[Le],Re.hasOwnProperty(Be)?Fe++:(le.push({command:kn.removeLayer,args:[Be]}),Oe.splice(Oe.indexOf(Be,Fe),1));for(Le=0,Fe=0;Le<fe.length;Le++)Be=fe[fe.length-1-Le],Oe[Oe.length-1-Le]!==Be&&(Te.hasOwnProperty(Be)?(le.push({command:kn.removeLayer,args:[Be]}),Oe.splice(Oe.lastIndexOf(Be,Oe.length-Fe),1)):Fe++,ft=Oe[Oe.length-Le],le.push({command:kn.addLayer,args:[Re[Be],ft]}),Oe.splice(Oe.length-Le,0,Be),$e[Be]=!0);for(Le=0;Le<fe.length;Le++)if(Be=fe[Le],He=Te[Be],Ke=Re[Be],!$e[Be]&&!s.bn(He,Ke))if(s.bn(He.source,Ke.source)&&s.bn(He["source-layer"],Ke["source-layer"])&&s.bn(He.type,Ke.type)){for(at in Zn(He.layout,Ke.layout,le,Be,null,kn.setLayoutProperty),Zn(He.paint,Ke.paint,le,Be,null,kn.setPaintProperty),s.bn(He.slot,Ke.slot)||le.push({command:kn.setSlot,args:[Be,Ke.slot]}),s.bn(He.filter,Ke.filter)||le.push({command:kn.setFilter,args:[Be,Ke.filter]}),s.bn(He.minzoom,Ke.minzoom)&&s.bn(He.maxzoom,Ke.maxzoom)||le.push({command:kn.setLayerZoomRange,args:[Be,Ke.minzoom,Ke.maxzoom]}),He)He.hasOwnProperty(at)&&at!=="layout"&&at!=="paint"&&at!=="filter"&&at!=="metadata"&&at!=="minzoom"&&at!=="maxzoom"&&at!=="slot"&&(at.indexOf("paint.")===0?Zn(He[at],Ke[at],le,Be,at.slice(6),kn.setPaintProperty):s.bn(He[at],Ke[at])||le.push({command:kn.setLayerProperty,args:[Be,at,Ke[at]]}));for(at in Ke)Ke.hasOwnProperty(at)&&!He.hasOwnProperty(at)&&at!=="layout"&&at!=="paint"&&at!=="filter"&&at!=="metadata"&&at!=="minzoom"&&at!=="maxzoom"&&at!=="slot"&&(at.indexOf("paint.")===0?Zn(He[at],Ke[at],le,Be,at.slice(6),kn.setPaintProperty):s.bn(He[at],Ke[at])||le.push({command:kn.setLayerProperty,args:[Be,at,Ke[at]]}))}else le.push({command:kn.removeLayer,args:[Be]}),ft=Oe[Oe.lastIndexOf(Be)+1],le.push({command:kn.addLayer,args:[Ke,ft]})}(ee,z.layers,q)}catch(K){console.warn("Unable to compute style diff:",K),q=[{command:kn.setStyle,args:[z]}]}return q}(this.serialize(),c).filter(k=>!(k.command in K3));if(v.length===0)return!1;const N=v.filter(k=>!(k.command in W3));if(N.length>0)throw new Error(`Unimplemented: ${N.map(k=>k.command).join(", ")}.`);const A=[];return v.forEach(k=>{A.push(this[k.command].apply(this,k.args))}),h&&Promise.all(A).then(h),this.stylesheet=c,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}_updateWorkerImages(c){const h=this.getFragmentStyle(c);h&&(h._availableImages=h.imageManager.listImages(c),h.dispatcher.broadcast("setImages",{scope:c,images:h._availableImages}))}addImages(c,h){for(const[v,N]of c.entries()){if(this.getImage(v,h))return this.fire(new s.z(new Error(`An image with the name "${v.name}" already exists.`)));this.imageManager.addImage(v,h,N),this._changes.updateImage(v,h)}return this._updateWorkerImages(h),this.fire(new s.A("data",{dataType:"style"})),this}addImage(c,h,v){return this.getImage(c,h)?this.fire(new s.z(new Error(`An image with the name "${c.name}" already exists.`))):(this.imageManager.addImage(c,h,v),this._changes.updateImage(c,h),this._updateWorkerImages(h),this.fire(new s.A("data",{dataType:"style"})),this)}updateImage(c,h,v,N=!1){this.imageManager.updateImage(c,h,v),N&&(this._changes.updateImage(c,h),this._updateWorkerImages(h),this.fire(new s.A("data",{dataType:"style"})))}getImage(c,h){return this.imageManager.getImage(c,h)}removeImage(c,h){return this.getImage(c,h)?(this.imageManager.removeImage(c,h),this._changes.updateImage(c,h),this._updateWorkerImages(h),this.fire(new s.A("data",{dataType:"style"})),this):this.fire(new s.z(new Error("No image with this name exists.")))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModel(c,h,v={}){return this._checkLoaded(),this._validate(Ue,`models.${c}`,h,null,v)||(this.modelManager.addModel(c,h,this.scope),this._changes.setDirty()),this}hasModel(c){return this.modelManager.hasModel(c,this.scope)}removeModel(c){return this.hasModel(c)?(this.modelManager.removeModel(c,this.scope),this):this.fire(new s.z(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(c,h,v={}){if(this._checkLoaded(),this.getOwnSource(c)!==void 0)throw new Error(`There is already a source with ID "${c}".`);if(!h.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(h).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(h.type)>=0&&this._validate(la,`sources.${c}`,h,null,v))return;this.map&&this.map._collectResourceTiming&&(h.collectResourceTiming=!0);const N=qm(c,h,this.dispatcher,this);N.scope=this.scope,N.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(N.id),source:N.serialize(),sourceId:N.id}));const A=k=>{const z=(k?"symbol:":"other:")+N.id,q=s.C(z,this.scope),K=this._sourceCaches[z]=new Dl(q,N,k);(k?this._symbolSourceCaches:this._otherSourceCaches)[N.id]=K,K.onAdd(this.map)};A(!1),h.type!=="vector"&&h.type!=="geojson"||A(!0),N.onAdd&&N.onAdd(this.map),v.isInitialLoad||(this.mergeSources(),this._changes.setDirty())}removeSource(c){this._checkLoaded();const h=this.getOwnSource(c);if(!h)throw new Error("There is no source with this ID");for(const N in this._layers)if(this._layers[N].source===c)return this.fire(new s.z(new Error(`Source "${c}" cannot be removed while layer "${N}" is using it.`)));if(this.terrain&&this.terrain.scope===this.scope&&this.terrain.get().source===c)return this.fire(new s.z(new Error(`Source "${c}" cannot be removed while terrain is using it.`)));if(this.stylesheet.iconsets){const N=Object.entries(this.stylesheet.iconsets).find(([A,k])=>k.type==="source"&&k.source===c);if(N)return this.fire(new s.z(new Error(`Source "${c}" cannot be removed while iconset "${N[0]}" is using it.`)))}const v=this.getOwnSourceCaches(c);for(const N of v){const A=s.cr(N.id);delete this._sourceCaches[A],this._changes.discardSourceCacheUpdate(N.id),N.fire(new s.A("data",{sourceDataType:"metadata",dataType:"source",sourceId:N.getSource().id})),N.setEventedParent(null),N.clearTiles()}return delete this._otherSourceCaches[c],delete this._symbolSourceCaches[c],this.mergeSources(),h.setEventedParent(null),h.onRemove&&h.onRemove(this.map),this._changes.setDirty(),this}setGeoJSONSourceData(c,h){this._checkLoaded(),this.getOwnSource(c).setData(h),this._changes.setDirty()}getOwnSource(c){const h=this.getOwnSourceCache(c);return h&&h.getSource()}getOwnSources(){const c=[];for(const h in this._otherSourceCaches){const v=this.getOwnSourceCache(h);v&&c.push(v.getSource())}return c}areTilesLoaded(){const c=this._mergedSourceCaches;for(const h in c){const v=c[h]._tiles;for(const N in v){const A=v[N];if(A.state!=="loaded"&&A.state!=="errored")return!1}}return!0}setLights(c){if(this._checkLoaded(),!c)return delete this.ambientLight,void delete this.directionalLight;const h=this._getTransitionParameters();for(const N of c){if(this._validate(Kc,"lights",N))return;switch(N.type){case"ambient":if(this.ambientLight){const A=this.ambientLight;A.set(N),A.updateTransitions(h)}else this.ambientLight=new Qi(N,hn||(hn=new s.a7({color:new s.a8(s.a5.properties_light_ambient.color),"color-use-theme":new s.a8({type:"string",default:"default","property-type":"data-constant"}),intensity:new s.a8(s.a5.properties_light_ambient.intensity)})),this.scope,this.options);break;case"directional":if(this.directionalLight){const A=this.directionalLight;A.set(N),A.updateTransitions(h)}else this.directionalLight=new Qi(N,Ln||(Ln=new s.a7({direction:new s.am(s.a5.properties_light_directional.direction),color:new s.a8(s.a5.properties_light_directional.color),"color-use-theme":new s.a8({type:"string",default:"default","property-type":"data-constant"}),intensity:new s.a8(s.a5.properties_light_directional.intensity),"cast-shadows":new s.a8(s.a5.properties_light_directional["cast-shadows"]),"shadow-quality":new s.a8(s.a5.properties_light_directional["shadow-quality"]),"shadow-intensity":new s.a8(s.a5.properties_light_directional["shadow-intensity"])})),this.scope,this.options)}}const v=new s.aa(this.z||0,h);this.ambientLight&&this.ambientLight.recalculate(v),this.directionalLight&&this.directionalLight.recalculate(v),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const c=this.directionalLight,h=this.ambientLight;if(!c||!h)return;const v=Q=>.2126*(Q[0]<=.03928?Q[0]/12.92:Math.pow((Q[0]+.055)/1.055,2.4))+.7152*(Q[1]<=.03928?Q[1]/12.92:Math.pow((Q[1]+.055)/1.055,2.4))+.0722*(Q[2]<=.03928?Q[2]/12.92:Math.pow((Q[2]+.055)/1.055,2.4)),N=c.properties.get("color").toRenderColor(null).toArray01(),A=c.properties.get("intensity"),k=c.properties.get("direction"),z=1-s.cc(k.x,k.y,k.z)[2]/90,q=v(N)*A*z,K=h.properties.get("color").toRenderColor(null).toArray01(),Y=h.properties.get("intensity"),ee=v(K)*Y;return Number(((q+ee)/2).toFixed(6))}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const c=[];return this.directionalLight&&c.push(this.directionalLight.get()),this.ambientLight&&c.push(this.ambientLight.get()),c}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(c){if(!c)return this;if(s.cs(c)){const h=s.ct(c),v=this.fragments.find(({id:A})=>A===h);if(!v)throw new Error(`Style import '${c}' not found`);const N=s.cr(c);return v.style.getFragmentStyle(N)}{const h=this.fragments.find(({id:v})=>v===c);return h?h.style:void 0}}setFeaturesetSelectors(c){if(!c)return;const h={},v=(N,A="")=>`${N}::${A}`;this._featuresetSelectors={};for(const N in c){const A=this._featuresetSelectors[N]=[];for(const k of c[N].selectors){if(k.featureNamespace){const q=this.getOwnLayer(k.layer);if(!q){s.w(`Layer is undefined for selector: ${k.layer}`);continue}const K=v(q.source,q.sourceLayer);if(K in h&&h[K]!==k.featureNamespace){s.w(`"featureNamespace ${k.featureNamespace} of featureset ${N}'s selector is not associated to the same source, skip this selector`);continue}h[K]=k.featureNamespace}let z;if(k.properties)for(const q in k.properties){const K=s.X(k.properties[q]);K.result==="success"&&(z=z||{},z[q]=K.value)}A.push({layerId:k.layer,namespace:k.featureNamespace,properties:z,uniqueFeatureID:k._uniqueFeatureID})}}}getFeaturesetDescriptors(c){const h=this.getFragmentStyle(c);if(!h||!h.stylesheet.featuresets)return[];const v=[];for(const N in h.stylesheet.featuresets)v.push({featuresetId:N,importId:h.scope?h.scope:void 0});return v}getFeaturesetLayers(c,h){const v=this.getFragmentStyle(h),N=v.stylesheet.featuresets;if(!N||!N[c])return this.fire(new s.z(new Error(`The featureset '${c}' does not exist in the map's style and cannot be queried.`))),[];const A=[];for(const k of N[c].selectors){const z=v.getOwnLayer(k.layer);z&&A.push(z)}return A}getConfigProperty(c,h){const v=this.getFragmentStyle(c);if(!v)return null;const N=s.C(h,v.scope),A=v.options.get(N),k=A?A.value||A.default:null;return k?k.serialize():null}setConfigProperty(c,h,v){const N=this.getFragmentStyle(c);if(!N)return;const A=N.stylesheet.indoor?IS(N.stylesheet.schema):N.stylesheet.schema;if(!A||!A[h])return;const k=s.X(v);if(k.result!=="success")return void Bh(this,k.value);const z=k.value.expression,q=s.C(h,N.scope),K=N.options.get(q);if(!K)return;let Y;const{minValue:ee,maxValue:Q,stepValue:ie,type:de,values:le}=A[h],he=s.X(A[h].default);he.result==="success"&&(Y=he.value.expression),Y?(this.options.set(q,Object.assign({},K,{value:z,default:Y,minValue:ee,maxValue:Q,stepValue:ie,type:de,values:le})),this.updateConfigDependencies(h)):this.fire(new s.z(new Error(`No schema defined for the config option "${h}" in the "${c}" fragment.`)))}getConfig(c){const h=this.getFragmentStyle(c);if(!h)return null;const v=h.stylesheet.schema;if(!v)return null;const N={};for(const A in v){const k=s.C(A,h.scope),z=h.options.get(k),q=z?z.value||z.default:null;N[A]=q?q.serialize():null}return N}setConfig(c,h){const v=this.getFragmentStyle(c);v&&(v.updateConfig(h,v.stylesheet.schema),this.updateConfigDependencies())}getSchema(c){const h=this.getFragmentStyle(c);return h?h.stylesheet.schema:null}setSchema(c,h){const v=this.getFragmentStyle(c);v&&(v.stylesheet.schema=h,v.updateConfig(v._config,h),this.updateConfigDependencies())}updateConfig(c,h){if(this._config=c,c||h)if(h)for(const v in h){let N,A;const k=s.X(h[v].default);if(k.result==="success"&&(N=k.value.expression),c&&c[v]!==void 0){const Q=s.X(c[v]);Q.result==="success"&&(A=Q.value.expression)}const{minValue:z,maxValue:q,stepValue:K,type:Y,values:ee}=h[v];if(N){const Q=s.C(v,this.scope);this.options.set(Q,{default:N,value:A,minValue:z,maxValue:q,stepValue:K,type:Y,values:ee})}else this.fire(new s.z(new Error(`No schema defined for config option "${v}".`)))}else this.fire(new s.z(new Error("Attempting to set config for a style without schema.")))}updateConfigDependencies(c){for(const h of this._configDependentLayers){const v=this.getLayer(h);if(v){if(c&&!v.configDependencies.has(c))continue;v.possiblyEvaluateVisibility(),this._updateLayer(v)}}this.ambientLight&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.updateConfig(this.options),this.fog&&this.fog.updateConfig(this.options),this.snow&&this.snow.updateConfig(this.options),this.rain&&this.rain.updateConfig(this.options),this.forEachFragmentStyle(h=>{const v=h._styleColorTheme.colorThemeOverride?h._styleColorTheme.colorThemeOverride:h._styleColorTheme.colorTheme;if(v){const N=h._evaluateColorThemeData(v);(!h._styleColorTheme.lut&&N!==""||h._styleColorTheme.lut&&N!==h._styleColorTheme.lut.data)&&h.setColorTheme(v)}}),this._changes.setDirty()}addLayer(c,h,v={}){this._checkLoaded();const N=c.id;if(this._layers[N])return void this.fire(new s.z(new Error(`Layer with id "${N}" already exists on this map`)));let A;if(c.type==="custom"){if(Bh(this,s.cu(c)))return;A=s.cv(c,this.scope,this._styleColorTheme.lut,this.options)}else{if(typeof c.source=="object"&&(this.addSource(N,c.source),c=s.cq(c),c=s.l(c,{source:N})),this._validate(pe,`layers.${N}`,c,{arrayIndex:-1},v))return;A=s.cv(c,this.scope,this._styleColorTheme.lut,this.options),this._validateLayer(A),A.setEventedParent(this,{layer:{id:N}})}A.configDependencies.size!==0&&this._configDependentLayers.add(A.fqid);let k=this._order.length;if(h){const Y=this._order.indexOf(h);if(Y===-1)return void this.fire(new s.z(new Error(`Layer with id "${h}" does not exist on this map.`)));A.slot===this._layers[h].slot?k=Y:s.w(`Layer with id "${h}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(k,0,N),this._layerOrderChanged=!0,this._layers[N]=A;const z=this.getOwnLayerSourceCache(A),q=!!this.directionalLight&&this.directionalLight.shadowsEnabled();z&&A.canCastShadows()&&q&&(z.castsShadows=!0);const K=this._changes.getRemovedLayer(A);if(K&&A.source&&z&&A.type!=="custom"){this._changes.discardLayerRemoval(A);const Y=s.C(A.source,A.scope);K.type!==A.type?this._changes.updateSourceCache(Y,"clear"):(this._changes.updateSourceCache(Y,"reload"),z.pause())}this._updateLayer(A),A.onAdd&&A.onAdd(this.map),A.scope=this.scope,this.mergeLayers()}moveLayer(c,h){this._checkLoaded();const v=this._checkLayer(c);if(!v||c===h)return;const N=this._order.indexOf(c);this._order.splice(N,1);let A=this._order.length;if(h){const k=this._order.indexOf(h);if(k===-1)return void this.fire(new s.z(new Error(`Layer with id "${h}" does not exist on this map.`)));v.slot===this._layers[h].slot?A=k:s.w(`Layer with id "${h}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(A,0,c),this._changes.setDirty(),this._layerOrderChanged=!0,this.mergeLayers()}removeLayer(c){this._checkLoaded();const h=this._checkLayer(c);if(!h)return;h.setEventedParent(null);const v=this._order.indexOf(c);this._order.splice(v,1),delete this._layers[c],this._changes.setDirty(),this._layerOrderChanged=!0,this._configDependentLayers.delete(h.fqid),this._changes.removeLayer(h);const N=this.getOwnLayerSourceCache(h);if(N&&N.castsShadows){let A=!1;for(const k in this._layers)if(this._layers[k].source===h.source&&this._layers[k].canCastShadows()){A=!0;break}N.castsShadows=A}h.onRemove&&h.onRemove(this.map),this.mergeLayers()}getOwnLayer(c){return this._layers[c]}hasLayer(c){return c in this._mergedLayers}hasLayerType(c){for(const h in this._layers)if(this._layers[h].type===c)return!0;return!1}setLayerZoomRange(c,h,v){this._checkLoaded();const N=this._checkLayer(c);N&&(N.minzoom===h&&N.maxzoom===v||(h!=null&&(N.minzoom=h),v!=null&&(N.maxzoom=v),this._updateLayer(N)))}getSlots(){return this._checkLoaded(),this._mergedSlots}setSlot(c,h){this._checkLoaded();const v=this._checkLayer(c);v&&v.slot!==h&&(v.slot=h,this._updateLayer(v))}setFilter(c,h,v={}){this._checkLoaded();const N=this._checkLayer(c);if(N&&!s.bn(N.filter,h))return h==null?(N.filter=void 0,void this._updateLayer(N)):void(this._validate(be,`layers.${N.id}.filter`,h,{layerType:N.type},v)||(N.filter=s.cq(h),this._updateLayer(N)))}getFilter(c){const h=this._checkLayer(c);if(h)return s.cq(h.filter)}setLayoutProperty(c,h,v,N={}){this._checkLoaded();const A=this._checkLayer(c);if(A&&!s.bn(A.getLayoutProperty(h),v)){if(v!=null&&(!N||N.validate!==!1)&&Bh(A,qe.call(Ji,{key:`layers.${c}.layout.${h}`,layerType:A.type,objectKey:h,value:v,styleSpec:s.a5,style:{glyphs:!0,sprite:!0}})))return;A.setLayoutProperty(h,v),A.configDependencies.size!==0&&this._configDependentLayers.add(A.fqid),this._updateLayer(A)}}getLayoutProperty(c,h){const v=this._checkLayer(c);if(v)return v.getLayoutProperty(h)}setPaintProperty(c,h,v,N={}){this._checkLoaded();const A=this._checkLayer(c);if(!A||s.bn(A.getPaintProperty(h),v)||v!=null&&(!N||N.validate!==!1)&&Bh(A,De.call(Ji,{key:`layers.${c}.paint.${h}`,layerType:A.type,objectKey:h,value:v,styleSpec:s.a5})))return;const k=A.setPaintProperty(h,v);A.configDependencies.size!==0&&this._configDependentLayers.add(A.fqid),k&&this._updateLayer(A),this._changes.updatePaintProperties(A)}getPaintProperty(c,h){const v=this._checkLayer(c);if(v)return v.getPaintProperty(h)}setFeatureState(c,h){if(this._checkLoaded(),"target"in c){if("featuresetId"in c.target){const{featuresetId:q,importId:K}=c.target,Y=this.getFragmentStyle(K),ee=Y.getFeaturesetLayers(q);for(const{source:Q,sourceLayer:ie}of ee)Y.setFeatureState({id:c.id,source:Q,sourceLayer:ie},h)}else if("layerId"in c.target){const{layerId:q}=c.target,K=this.getLayer(q);this.setFeatureState({id:c.id,source:K.source,sourceLayer:K.sourceLayer},h)}return}const v=c.source,N=c.sourceLayer,A=this._checkSource(v);if(!A)return;const k=A.type;if(k==="geojson"&&N)return void this.fire(new s.z(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(k==="vector"&&!N)return void this.fire(new s.z(new Error("The sourceLayer parameter must be provided for vector source types.")));c.id===void 0&&this.fire(new s.z(new Error("The feature id parameter must be provided.")));const z=this.getOwnSourceCaches(v);for(const q of z)q.setFeatureState(N,c.id,h)}removeFeatureState(c,h){if(this._checkLoaded(),"target"in c){if("featuresetId"in c.target){const{featuresetId:q,importId:K}=c.target,Y=this.getFragmentStyle(K),ee=Y.getFeaturesetLayers(q);for(const{source:Q,sourceLayer:ie}of ee)Y.removeFeatureState({id:c.id,source:Q,sourceLayer:ie},h)}else if("layerId"in c.target){const{layerId:q}=c.target,K=this.getLayer(q);this.removeFeatureState({id:c.id,source:K.source,sourceLayer:K.sourceLayer},h)}return}const v=c.source,N=this._checkSource(v);if(!N)return;const A=N.type,k=A==="vector"?c.sourceLayer:void 0;if(A==="vector"&&!k)return void this.fire(new s.z(new Error("The sourceLayer parameter must be provided for vector source types.")));if(h&&typeof c.id!="string"&&typeof c.id!="number")return void this.fire(new s.z(new Error("A feature id is required to remove its specific state property.")));const z=this.getOwnSourceCaches(v);for(const q of z)q.removeFeatureState(k,c.id,h)}getFeatureState(c){if(this._checkLoaded(),"target"in c){let A;if("featuresetId"in c.target){const{featuresetId:k,importId:z}=c.target,q=this.getFragmentStyle(z),K=q.getFeaturesetLayers(k);for(const{source:Y,sourceLayer:ee}of K){const Q=q.getFeatureState({id:c.id,source:Y,sourceLayer:ee});if(Q&&!A)A=Q;else if(!s.bn(A,Q))return void this.fire(new s.z(new Error("The same feature id exists in multiple sources in the featureset, but their feature states are not consistent through the sources.")))}}else if("layerId"in c.target){const{layerId:k}=c.target,z=this.getLayer(k);A=this.getFeatureState({id:c.id,source:z.source,sourceLayer:z.sourceLayer})}return A}const h=c.source,v=c.sourceLayer,N=this._checkSource(h);if(N){if(N.type!=="vector"||v)return c.id===void 0&&this.fire(new s.z(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(h)[0].getFeatureState(v,c.id);this.fire(new s.z(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(c){return this.stylesheet.transition=s.l({},this.stylesheet.transition,c),this.transition=this.stylesheet.transition,this}getTransition(){return s.l({},this.stylesheet.transition)}serialize(){this._checkLoaded();const c=this.getTerrain(),h=c&&this.terrain&&this.terrain.scope===this.scope?c:this.stylesheet.terrain;return s.cw({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,fragment:this.stylesheet.fragment,iconsets:this.stylesheet.iconsets,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:h,fog:this.stylesheet.fog,snow:this.stylesheet.snow,rain:this.stylesheet.rain,center:this.stylesheet.center,"color-theme":this.stylesheet["color-theme"],zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},v=>v!==void 0)}_updateFilteredLayers(c){for(const h of Object.values(this._mergedLayers))c(h)&&this._updateLayer(h)}_updateLayer(c){this._changes.updateLayer(c);const h=this.getLayerSourceCache(c),v=s.C(c.source,c.scope),N=this._changes.getUpdatedSourceCaches();c.source&&!N[v]&&h&&h.getSource().type!=="raster"&&(this._changes.updateSourceCache(v,"reload"),h.pause()),c.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(c){const h=z=>this._mergedLayers[z].is3D(!!this.terrain),v=this.order,N={},A=[];for(let z=v.length-1;z>=0;z--){const q=v[z];if(h(q)){N[q]=z;for(const K of c){const Y=K[q];if(Y)for(const ee of Y)A.push(ee)}}}A.sort((z,q)=>q.intersectionZ-z.intersectionZ);const k=[];for(let z=v.length-1;z>=0;z--){const q=v[z];if(h(q))for(let K=A.length-1;K>=0;K--){const Y=A[K].feature;if(Y.layer&&N[Y.layer.id]<z)break;k.push(Y),A.pop()}else for(const K of c){const Y=K[q];if(Y)for(const ee of Y)k.push(ee.feature)}}return k}queryRenderedFeatures(c,h,v){let N;h&&!Array.isArray(h)&&h.filter&&(this._validate(be,"queryRenderedFeatures.filter",h.filter,null,h),N=s.a_(h.filter));const A={},k=Y=>{if($x.has(Y.type))return;const ee=this.getOwnLayerSourceCache(Y),Q=A[ee.id]=A[ee.id]||{sourceCache:ee,layers:{},has3DLayers:!1};Y.is3D(!!this.terrain)&&(Q.has3DLayers=!0),Q.layers[Y.fqid]=Q.layers[Y.fqid]||{styleLayer:Y,targets:[]},Q.layers[Y.fqid].targets.push({filter:N})};if(h&&h.layers){if(!Array.isArray(h.layers))return this.fire(new s.z(new Error("parameters.layers must be an Array."))),[];for(const Y of h.layers){const ee=this._layers[Y];if(!ee)return this.fire(new s.z(new Error(`The layer '${Y}' does not exist in the map's style and cannot be queried for features.`))),[];k(ee)}}else for(const Y in this._layers)k(this._layers[Y]);const z=this._queryRenderedFeatures(c,A,v),q=this._flattenAndSortRenderedFeatures(z),K=[];for(const Y of q)s.ct(Y.layer.id)===this.scope&&K.push(Y);return K}queryRenderedFeatureset(c,h,v){let N;h&&!Array.isArray(h)&&h.filter&&(this._validate(be,"queryRenderedFeatures.filter",h.filter,null,h),N=s.a_(h.filter));const A="mock",k=[];if(h&&h.target)k.push(Object.assign({},h,{targetId:A,filter:N}));else{const Y=this.getFeaturesetDescriptors();for(const ee of Y)k.push({targetId:A,filter:N,target:ee});for(const{style:ee}of this.fragments){const Q=ee.getFeaturesetDescriptors();for(const ie of Q)k.push({targetId:A,filter:N,target:ie})}}const z=this.queryRenderedTargets(c,k,v),q=[],K=new Set;for(const Y of z)for(const ee of Y.variants[A])Ed(ee,Y,K)||q.push(new s.cx(Y,ee));return q}queryRenderedTargets(c,h,v){const N={},A=(z,q,K,Y)=>{const ee=N[q.id]=N[q.id]||{sourceCache:q,layers:{},has3DLayers:!1};if(ee.layers[z.fqid]=ee.layers[z.fqid]||{styleLayer:z,targets:[]},z.is3D(!!this.terrain)&&(ee.has3DLayers=!0),!Y)return K.uniqueFeatureID=!1,void ee.layers[z.fqid].targets.push(K);ee.layers[z.fqid].targets.push(Object.assign({},K,{namespace:Y.namespace,properties:Y.properties,uniqueFeatureID:Y.uniqueFeatureID}))};for(const z of h)if("featuresetId"in z.target){const{featuresetId:q,importId:K}=z.target,Y=this.getFragmentStyle(K);if(!Y||!Y._featuresetSelectors)continue;const ee=Y._featuresetSelectors[q];if(!ee){this.fire(new s.z(new Error(`The featureset '${q}' does not exist in the map's style and cannot be queried for features.`)));continue}for(const Q of ee){const ie=Y.getOwnLayer(Q.layerId);ie&&!$x.has(ie.type)&&A(ie,Y.getOwnLayerSourceCache(ie),z,Q)}}else if("layerId"in z.target){const{layerId:q}=z.target,K=this.getLayer(q);if(!K||$x.has(K.type))continue;A(K,this.getLayerSourceCache(K),z)}const k=this._queryRenderedFeatures(c,N,v);return this._flattenAndSortRenderedFeatures(k)}_queryRenderedFeatures(c,h,v){const N=[],A=!!this.map._showQueryGeometry,k=Us.createFromScreenPoints(c,v);for(const z in h){const q=Md(k,h[z],this._availableImages,v,A);Object.keys(q).length&&N.push(q)}if(this.placement)for(const z in h){if(!h[z].sourceCache._onlySymbols)continue;const q=Px(k.screenGeometry,h[z],this._availableImages,this.placement.collisionIndex,this.placement.retainedQueryData);Object.keys(q).length&&N.push(q)}return N}querySourceFeatures(c,h){const v=h&&h.filter;v&&this._validate(be,"querySourceFeatures.filter",v,null,h);let N=[];const A=this.getOwnSourceCaches(c);for(const k of A)N=N.concat(Ex(k,h));return N}addSourceType(c,h,v){return dc.getSourceType(c)?v(new Error(`A source type called "${c}" already exists.`)):(dc.setSourceType(c,h),h.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:c,url:h.workerSourceURL},v):v(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(c,h,v={}){this._checkLoaded();const N=this.light.getLight();let A=!1;for(const z in c)if(!s.bn(c[z],N[z])){A=!0;break}if(!A)return;const k=this._getTransitionParameters();this.light.setLight(c,h,v),this.light.updateTransitions(k)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}checkCanvasFingerprintNoise(){this.disableElevatedTerrain===void 0&&(this.disableElevatedTerrain=s.q.hasCanvasFingerprintNoise(),this.disableElevatedTerrain&&s.w("Terrain and hillshade are disabled because of Canvas2D limitations when fingerprinting protection is enabled (e.g. in private browsing mode)."))}setTerrain(c,h=1){if(this._checkLoaded(),!c)return this.terrainSetForDrapingOnly()||(delete this.terrain,this.map.transform.projection.requiresDraping&&this.setTerrainForDraping()),h===0&&delete this.terrain,c===null?this.stylesheet.terrain=null:delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);this.checkCanvasFingerprintNoise();let v=c;const N=c.source==null;if(h===1){if(this.disableElevatedTerrain)return;if(typeof v.source=="object"){const z="terrain-dem-src";this.addSource(z,v.source),v=s.cq(v),v=s.l(v,{source:z})}const A=s.l({},v),k={};if(this.terrain&&N){A.source=this.terrain.get().source;const z=this.terrain?this.getFragmentStyle(this.terrain.scope):null;z&&(k.style=z.serialize())}if(this._validate(Ih,"terrain",A,k))return}if(!this.terrain||this.terrain.scope!==this.scope&&!N||this.terrain&&h!==this.terrain.drapeRenderMode){if(!v)return;this._createTerrain(v,h),this.fire(new s.A("data",{dataType:"style"}))}else{const A=this.terrain,k=A.get();for(const z of Object.keys(s.a5.terrain))!v.hasOwnProperty(z)&&s.a5.terrain[z].default&&(v[z]=s.a5.terrain[z].default);for(const z in c)if(!s.bn(c[z],k[z])){A.set(c,this.options),this.stylesheet.terrain=c;const q=this._getTransitionParameters({duration:0});A.updateTransitions(q),this.fire(new s.A("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(c){const h=this.fog=new nn(c,this.map.transform,this.scope,this.options);this.stylesheet.fog=h.get();const v=this._getTransitionParameters({duration:0});h.updateTransitions(v)}_createSnow(c){const h=this.snow=new Wn(c,this.map.transform,this.scope,this.options);this.stylesheet.snow=h.get();const v=this._getTransitionParameters({duration:0});h.updateTransitions(v)}_createRain(c){const h=this.rain=new Kn(c,this.map.transform,this.scope,this.options);this.stylesheet.rain=h.get();const v=this._getTransitionParameters({duration:0});h.updateTransitions(v)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const c of this.map._markers)c._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(c){if(this._checkLoaded(),!c)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const h=this.fog;if(!s.bn(h.get(),c)){h.set(c,this.options),this.stylesheet.fog=h.get();const v=this._getTransitionParameters({duration:0});h.updateTransitions(v)}}else this._createFog(c);this._markersNeedUpdate=!0}getSnow(){return this.snow?this.snow.get():null}setSnow(c){if(this._checkLoaded(),!c)return delete this.snow,void delete this.stylesheet.snow;if(this.snow){const h=this.snow;if(!s.bn(h.get(),c)){h.set(c,this.options),this.stylesheet.snow=h.get();const v=this._getTransitionParameters({duration:0});h.updateTransitions(v)}}else this._createSnow(c);this._markersNeedUpdate=!0}getRain(){return this.rain?this.rain.get():null}setRain(c){if(this._checkLoaded(),!c)return delete this.rain,void delete this.stylesheet.rain;if(this.rain){const h=this.rain;if(!s.bn(h.get(),c)){h.set(c,this.options),this.stylesheet.rain=h.get();const v=this._getTransitionParameters({duration:0});h.updateTransitions(v)}}else this._createRain(c);this._markersNeedUpdate=!0}_reloadColorTheme(){const c=()=>{for(const N in this._layers)this._layers[N].lut=this._styleColorTheme.lut;for(const N in this._sourceCaches)this._sourceCaches[N].clearTiles()},h=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(!h)return this._styleColorTheme.lut=null,void c();const v=this._evaluateColorThemeData(h);this._loadColorTheme(v).then(()=>{this.fire(new s.A("colorthemeset")),c()}).catch(N=>{s.w(`Couldn't set color theme: ${N}`)})}setColorTheme(c){this._checkLoaded(),this._styleColorTheme.colorThemeOverride&&s.w("Note: setColorTheme is called on a style with a color-theme override, the passed color-theme won't be visible."),this._styleColorTheme.colorTheme=c,this._reloadColorTheme()}setImportColorTheme(c,h){const v=this.getFragmentStyle(c);v&&(v._styleColorTheme.colorThemeOverride=h,v._reloadColorTheme())}_getTransitionParameters(c){return{now:s.q.now(),transition:s.l(this.transition,c)}}updateDrapeFirstLayers(){if(!this.terrain)return;const c=[],h=[];for(const v of this._mergedOrder)this.isLayerDraped(this._mergedLayers[v])?c.push(v):h.push(v);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...c),this._drapedFirstOrder.push(...h)}_createTerrain(c,h){const v=this.terrain=new wt(c,h,this.scope,this.options);h===1&&(this.stylesheet.terrain=c),this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const N=this._getTransitionParameters({duration:0});v.updateTransitions(N)}_force3DLayerUpdate(){for(const c in this._layers){const h=this._layers[c];h.type==="fill-extrusion"&&this._updateLayer(h)}}_forceSymbolLayerUpdate(){for(const c in this._layers){const h=this._layers[c];h.type==="symbol"&&this._updateLayer(h)}}_validate(c,h,v,N,A={}){if(A&&A.validate===!1)return!1;const k=s.l({},this.serialize());return Bh(this,c.call(Ji,s.l({key:h,style:k,value:v,styleSpec:s.a5},N)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),s.cy.off("pluginStateChange",this._rtlTextPluginCallback);for(const c in this._mergedLayers)this._mergedLayers[c].setEventedParent(null);for(const c in this._mergedSourceCaches)this._mergedSourceCaches[c].clearTiles(),this._mergedSourceCaches[c].setEventedParent(null);this.imageManager.removeScope(this.scope),this.setEventedParent(null),delete this.fog,delete this.snow,delete this.rain,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.modelManager.setEventedParent(null),this.dispatcher.remove())}clearSource(c){const h=this.getSourceCaches(c);for(const v of h)v.clearTiles()}clearSources(){for(const c in this._mergedSourceCaches)this._mergedSourceCaches[c].clearTiles()}reloadSource(c){const h=this.getSourceCaches(c);for(const v of h)v.resume(),v.reload()}reloadSources(){for(const c of this.getSources())c.reload&&c.reload()}reloadModels(){this.modelManager.reloadModels(""),this.forEachFragmentStyle(c=>{c.modelManager.reloadModels(c.scope)})}updateSources(c){let h;this.directionalLight&&(h=Dd(this.directionalLight));for(const v in this._mergedSourceCaches)this._mergedSourceCaches[v].update(c,void 0,void 0,h)}_generateCollisionBoxes(){for(const c in this._sourceCaches){const h=this._sourceCaches[c];h.resume(),h.reload()}}_updatePlacement(c,h,v,N,A,k,z=!1){let q=!1,K=!1;const Y={},ee={};for(const Q of this._mergedOrder){const ie=this._mergedLayers[Q];if(ie.type!=="symbol")continue;const de=s.C(ie.source,ie.scope);let le=Y[de];if(!le){const fe=this.getLayerSourceCache(ie);if(!fe)continue;const Te=fe.getRenderableIds(!0).map(Re=>fe.getTileByID(Re));ee[de]=Te.slice(),le=Y[de]=Te.sort((Re,Oe)=>Oe.tileID.overscaledZ-Re.tileID.overscaledZ||(Re.tileID.isLessThan(Oe.tileID)?-1:1))}const he=this.crossTileSymbolIndex.addLayer(ie,le,h.center.lng,h.projection);q=q||he}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),z=z||this._layerOrderChanged||N===0,this._layerOrderChanged&&this.fire(new s.A("neworder")),(z||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(s.q.now(),h.zoom))&&(this.pauseablePlacement=new Od(h,this._mergedOrder,z,v,N,A,this.placement,this.fog&&h.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,Y,ee,this.map.painter.scaleFactor),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(s.q.now()),K=!0),q&&this.pauseablePlacement.placement.setStale()),K||q){this._buildingIndex.onNewFrame(h.zoom);for(let Q=0;Q<this._mergedOrder.length;Q++){const ie=this._mergedLayers[this._mergedOrder[Q]];if(ie.type!=="symbol")continue;const de=this.isLayerClipped(ie);this.placement.updateLayerOpacities(ie,Y[s.C(ie.source,ie.scope)],Q,de?k:null)}}return{needsRerender:!this.pauseablePlacement.isDone()||this.placement.hasTransitions(s.q.now())}}_releaseSymbolFadeTiles(){for(const c in this._sourceCaches)this._sourceCaches[c].releaseSymbolFadeTiles()}addImport(c,h){this._checkLoaded();const v=this.stylesheet.imports=this.stylesheet.imports||[];if(v.findIndex(({id:A})=>A===c.id)!==-1)return void this.fire(new s.z(new Error(`Import with id '${c.id}' already exists in the map's style.`)));if(!h)return v.push(c),this._loadImports([c],!0);const N=v.findIndex(({id:A})=>A===h);return N===-1&&this.fire(new s.z(new Error(`Import with id "${h}" does not exist on this map.`))),this.stylesheet.imports=v.slice(0,N).concat(c).concat(v.slice(N)),this._loadImports([c],!0,h)}updateImport(c,h){this._checkLoaded();const v=this.stylesheet.imports||[],N=this.getImportIndex(c);return N===-1?this:typeof h=="string"?(this.setImportUrl(c,h),this):(h.url&&h.url!==v[N].url&&this.setImportUrl(c,h.url),s.bn(h.config,v[N].config)||this.setImportConfig(c,h.config,h.data.schema),s.bn(h.data,v[N].data)||this.setImportData(c,h.data),this)}moveImport(c,h){this._checkLoaded();let v=this.stylesheet.imports||[];const N=this.getImportIndex(c);if(N===-1)return this;const A=this.getImportIndex(h);if(A===-1)return this;const k=v[N],z=this.fragments[N];return v=v.filter(({id:q})=>q!==c),this.fragments=this.fragments.filter(({id:q})=>q!==c),this.stylesheet.imports=v.slice(0,A).concat(k).concat(v.slice(A)),this.fragments=this.fragments.slice(0,A).concat(z).concat(this.fragments.slice(A)),this.mergeLayers(),this}setImportUrl(c,h){this._checkLoaded();const v=this.stylesheet.imports||[],N=this.getImportIndex(c);if(N===-1)return this;v[N].url=h;const A=this.fragments[N];return A.style=this._createFragmentStyle(v[N]),A.style.on("style.import.load",()=>this.mergeAll()),A.style.loadURL(h),this}setImportData(c,h){this._checkLoaded();const v=this.getImportIndex(c),N=this.stylesheet.imports||[];return v===-1?this:h?(this.fragments[v].style.setState(h),this._reloadImports(),this):(delete N[v].data,this.setImportUrl(c,N[v].url))}setImportConfig(c,h,v){this._checkLoaded();const N=this.getImportIndex(c),A=this.stylesheet.imports||[];if(N===-1)return this;h?A[N].config=h:delete A[N].config;const k=this.fragments[N];v&&k.style.stylesheet&&(k.style.stylesheet.schema=v);const z=k.style.stylesheet&&k.style.stylesheet.schema;return k.config=h,k.style.updateConfig(h,z),this.updateConfigDependencies(),this}removeImport(c){this._checkLoaded();const h=this.stylesheet.imports||[],v=this.getImportIndex(c);v!==-1&&(h.splice(v,1),this.fragments[v].style._remove(),this.fragments.splice(v,1),this._reloadImports())}getImportIndex(c){const h=(this.stylesheet.imports||[]).findIndex(v=>v.id===c);return h===-1&&this.fire(new s.z(new Error(`Import '${c}' does not exist in the map's style and cannot be updated.`))),h}getLayer(c){return this._mergedLayers[c]}getSources(){const c=[];for(const h in this._mergedOtherSourceCaches){const v=this._mergedOtherSourceCaches[h];v&&c.push(v.getSource())}return c}getSource(c,h){const v=this.getSourceCache(c,h);return v&&v.getSource()}getLayerSource(c){const h=this.getLayerSourceCache(c);return h&&h.getSource()}getSourceCache(c,h){const v=s.C(c,h);return this._mergedOtherSourceCaches[v]}getLayerSourceCache(c){const h=s.C(c.source,c.scope);return c.type==="symbol"?this._mergedSymbolSourceCaches[h]:this._mergedOtherSourceCaches[h]}getSourceCaches(c){if(c==null)return Object.values(this._mergedSourceCaches);const h=[];return this._mergedOtherSourceCaches[c]&&h.push(this._mergedOtherSourceCaches[c]),this._mergedSymbolSourceCaches[c]&&h.push(this._mergedSymbolSourceCaches[c]),h}updateSourceCaches(){const c=this._changes.getUpdatedSourceCaches();for(const h in c){const v=c[h];v==="reload"?this.reloadSource(h):v==="clear"&&this.clearSource(h)}}updateLayers(c){const h=this._changes.getUpdatedPaintProperties();for(const v of h){const N=this.getLayer(v);N&&N.updateTransitions(c)}}getGlyphsUrl(){return this.stylesheet.glyphs}setGlyphsUrl(c){this.stylesheet.glyphs=c,this.glyphManager.setURL(c,this.scope)}getImages(c,h,v){this.imageManager.getImages(h.images,h.scope,v),this._updateTilesForChangedImages();const N=k=>{if(k){const z=h.images.map(q=>s.I.toString(q));k.setDependencies(h.tileID.key,h.type,z)}},A=s.C(h.source,h.scope);N(this._mergedOtherSourceCaches[A]),N(this._mergedSymbolSourceCaches[A])}rasterizeImages(c,h,v){this.imageManager.rasterizeImages(h,v)}getGlyphs(c,h,v){this.glyphManager.getGlyphs(h.stacks,h.scope,v)}getResource(c,h,v){return s.cz(h,v)}getOwnSourceCache(c){return this._otherSourceCaches[c]}getOwnLayerSourceCache(c){return c.type==="symbol"?this._symbolSourceCaches[c.source]:this._otherSourceCaches[c.source]}getOwnSourceCaches(c){const h=[];return this._otherSourceCaches[c]&&h.push(this._otherSourceCaches[c]),this._symbolSourceCaches[c]&&h.push(this._symbolSourceCaches[c]),h}_isSourceCacheLoaded(c){const h=this.getOwnSourceCaches(c);return h.length===0?(this.fire(new s.z(new Error(`There is no source with ID '${c}'`))),!1):h.every(v=>v.loaded())}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}isLayerClipped(c,h){if(!this._clipLayerPresent&&c.type!=="fill-extrusion")return!1;const v=c.type==="fill-extrusion"&&c.sourceLayer==="building";if(c.is3D(!!this.terrain)){if(v||h&&h.type==="batched-model"||c.type==="model")return!0}else if(c.type==="symbol")return!0;return!1}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.fragments.forEach(c=>{c.style._remove()}),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}dc.getSourceType=function(b){return xg[b]},dc.setSourceType=function(b,c){xg[b]=c},dc.registerForPluginStateChange=s.ci;var t1=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#ifdef RENDER_CUTOFF
float cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}
#endif`,Vx=`
out vec4 glFragColor;highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#ifdef INDICATOR_CUTOUT
uniform vec3 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;
#endif
vec4 applyCutout(vec4 color,float height) {
#ifdef INDICATOR_CUTOUT
float verticalFadeRange=u_indicator_cutout_centers.z*0.25;float holeMinOpacity=mix(1.0,u_indicator_cutout_params.x,smoothstep(u_indicator_cutout_centers.z,u_indicator_cutout_centers.z+verticalFadeRange,height));float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);
#else
return color;
#endif
}
#ifdef DEBUG_WIREFRAME
#define HANDLE_WIREFRAME_DEBUG \\
glFragColor=vec4(0.7,0.0,0.0,0.7); \\
gl_FragDepth=gl_FragCoord.z-0.0001;
#else
#define HANDLE_WIREFRAME_DEBUG
#endif
#ifdef RENDER_CUTOFF
uniform highp vec4 u_cutoff_params;in float v_cutoff_opacity;
#endif
vec4 textureLodCustom(sampler2D image,highp vec2 pos,highp vec2 lod_coord) {highp vec2 size=vec2(textureSize(image,0));highp vec2 dx=dFdx(lod_coord.xy*size);highp vec2 dy=dFdy(lod_coord.xy*size);highp float delta_max_sqr=max(dot(dx,dx),dot(dy,dy));highp float lod=0.5*log2(delta_max_sqr);return textureLod(image,pos,lod);}vec4 applyLUT(highp sampler3D lut,vec4 col) {vec3 size=vec3(textureSize(lut,0));vec3 uvw=(col.rbg*float(size-1.0)+0.5)/size;return vec4(texture(lut,uvw).rgb,col.a);}vec3 applyLUT(highp sampler3D lut,vec3 col) {return applyLUT(lut,vec4(col,1.0)).rgb;}`,Tg=`
#define EXTENT 8192.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const vec2 units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (units_to_pixels*pos+offset)/pattern_size;}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {return get_pattern_pos(pixel_coord_upper,pixel_coord_lower,pattern_size,vec2(tile_units_to_pixels),pos);}float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(PI/4.0+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}
#ifdef RENDER_CUTOFF
uniform vec4 u_cutoff_params;out float v_cutoff_opacity;
#endif
const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}`,Ux="in highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;out highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",zd=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(dd,0)).r;float bl=texture(u_dem,pos+vec2(0,dd)).r;float br=texture(u_dem,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem_prev,pos).r;float tr=texture(u_dem_prev,pos+vec2(dd,0)).r;float bl=texture(u_dem_prev,pos+vec2(0,dd)).r;float br=texture(u_dem_prev,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
vec4 fourSample(vec2 pos,vec2 off) {float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }
#endif
#ifdef DEPTH_OCCLUSION
uniform highp sampler2D u_depth;uniform highp vec2 u_depth_size_inv;uniform highp vec2 u_depth_range_unpack;uniform highp float u_occluder_half_size;uniform highp float u_occlusion_depth_offset;
#ifdef DEPTH_D24
float unpack_depth(float depth) {return depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}vec4 unpack_depth4(vec4 depth) {return depth*u_depth_range_unpack.x+vec4(u_depth_range_unpack.y);}
#else
highp float unpack_depth_rgba(vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;
#ifdef DEPTH_D24
float depth=unpack_depth(texture(u_depth,(coord.xy+1.0)*0.5).r);
#else
float depth=unpack_depth_rgba(texture(u_depth,(coord.xy+1.0)*0.5));
#endif
return coord.z+u_occlusion_depth_offset > depth;}highp vec4 getCornerDepths(vec2 coord) {highp vec3 df=vec3(u_occluder_half_size*u_depth_size_inv,0.0);highp vec2 uv=0.5*coord.xy+0.5;
#ifdef DEPTH_D24
highp vec4 depth=vec4(
texture(u_depth,uv-df.xz).r,texture(u_depth,uv+df.xz).r,texture(u_depth,uv-df.zy).r,texture(u_depth,uv+df.zy).r
);depth=unpack_depth4(depth);
#else
highp vec4 depth=vec4(
unpack_depth_rgba(texture(u_depth,uv-df.xz)),unpack_depth_rgba(texture(u_depth,uv+df.xz)),unpack_depth_rgba(texture(u_depth,uv-df.zy)),unpack_depth_rgba(texture(u_depth,uv+df.zy))
);
#endif
return depth;}highp float occlusionFadeMultiSample(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec2 uv=0.5*coord.xy+0.5;int NX=3;int NY=4;highp vec2 df=u_occluder_half_size*u_depth_size_inv;highp vec2 oneStep=2.0*u_occluder_half_size*u_depth_size_inv/vec2(NX-1,NY-1);highp float res=0.0;for (int y=0; y < NY;++y) {for (int x=0; x < NX;++x) {
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)));
#endif
res+=1.0-clamp(300.0*(coord.z+u_occlusion_depth_offset-depth),0.0,1.0);}}res=clamp(2.0*res/float(NX*NY)-0.5,0.0,1.0);return res;}highp float occlusionFade(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec4 depth=getCornerDepths(coord.xy);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z+u_occlusion_depth_offset)-depth),0.0,1.0));}
#else
bool isOccluded(vec4 frag) { return false; }highp float occlusionFade(vec4 frag) { return 1.0; }highp float occlusionFadeMultiSample(vec4 frag) { return 1.0; }
#endif//DEPTH_OCCLUSION`,Gx=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;out vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,r1=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;in vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos,float opacity_limit) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,min(opacity,opacity_limit));}vec3 fog_apply(vec3 color,vec3 pos) {return fog_apply(color,pos,1.0);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {return color;}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,$h=`#ifdef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;const vec4 NODATA=vec4(1);ivec4 _raTexLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}vec2 _raTexLinearMix(highp vec2 fxy,highp vec4 colorMix,highp float colorOffset,highp vec4 t00,highp vec4 t10,highp vec4 t01,highp vec4 t11) {vec2 c00=t00==NODATA ? vec2(0) : vec2(colorOffset+dot(t00,colorMix),1);vec2 c10=t10==NODATA ? vec2(0) : vec2(colorOffset+dot(t10,colorMix),1);vec2 c01=t01==NODATA ? vec2(0) : vec2(colorOffset+dot(t01,colorMix),1);vec2 c11=t11==NODATA ? vec2(0) : vec2(colorOffset+dot(t11,colorMix),1);return mix(mix(c01,c11,fxy.x),mix(c00,c10,fxy.x),fxy.y);}vec2 raTexture2D_image0_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image0,c.yz,0),texelFetch(u_image0,c.xz,0),texelFetch(u_image0,c.yw,0),texelFetch(u_image0,c.xw,0)
);}vec2 raTexture2D_image1_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image1,c.yz,0),texelFetch(u_image1,c.xz,0),texelFetch(u_image1,c.yw,0),texelFetch(u_image1,c.xw,0)
);}vec2 raTexture2D_image0_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image0,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}vec2 raTexture2D_image1_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image1,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}
#endif`,af=`#ifdef RASTER_ARRAY
uniform sampler2D u_velocity;uniform mediump vec2 u_velocity_res;uniform mediump float u_max_speed;const vec4 NO_DATA=vec4(1);const vec2 INVALID_VELOCITY=vec2(-1);uniform highp vec2 u_uv_offset;uniform highp float u_data_offset;uniform highp vec2 u_data_scale;ivec4 rasterArrayLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}highp vec2 lookup_velocity(highp vec2 uv) {uv=u_uv_offset.x+u_uv_offset.y*uv;highp vec2 fxy;ivec4 c=rasterArrayLinearCoord(uv,u_velocity_res,fxy);highp vec4 tl=texelFetch(u_velocity,c.yz,0);highp vec4 tr=texelFetch(u_velocity,c.xz,0);highp vec4 bl=texelFetch(u_velocity,c.yw,0);highp vec4 br=texelFetch(u_velocity,c.xw,0);if (tl==NO_DATA) {return INVALID_VELOCITY;}if (tr==NO_DATA) {return INVALID_VELOCITY;}if (bl==NO_DATA) {return INVALID_VELOCITY;}if (br==NO_DATA) {return INVALID_VELOCITY;}highp vec4 t=mix(mix(bl,br,fxy.x),mix(tl,tr,fxy.x),fxy.y);highp vec2 velocity=u_data_offset+vec2(dot(t.rg,u_data_scale),dot(t.ba,u_data_scale));velocity.y=-velocity.y;velocity/=max(u_max_speed,length(velocity));return velocity;}
#endif
uniform highp float u_particle_pos_scale;uniform highp vec2 u_particle_pos_offset;highp vec4 pack_pos_to_rgba(highp vec2 p) {highp vec2 v=(p+u_particle_pos_offset)/u_particle_pos_scale;highp vec4 r=vec4(v.x,fract(v.x*255.0),v.y,fract(v.y*255.0));return vec4(r.x-r.y/255.0,r.y,r.z-r.w/255.0,r.w);}highp vec2 unpack_pos_from_rgba(highp vec4 v) {v=floor(v*255.0+0.5)/255.0;highp vec2 p=vec2(v.x+(v.y/255.0),v.z+(v.w/255.0));return u_particle_pos_scale*p-u_particle_pos_offset;}`,kg=`#ifdef RENDER_SHADOWS
uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {vec3 transformed_normal=vec3(-normal.xy,normal.z);float NDotL=dot(normalize(transformed_normal),u_shadow_direction);float dotScale=min(1.0-NDotL,1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}
#endif//RENDER_SHADOWS`,Pg=`#ifdef RENDER_SHADOWS
#ifdef DEPTH_TEXTURE
uniform highp sampler2D u_shadowmap_0;uniform highp sampler2D u_shadowmap_1;
#else
uniform sampler2D u_shadowmap_0;uniform sampler2D u_shadowmap_1;
#endif
uniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;highp float shadow_sample_1(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_1,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_1,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}highp float shadow_sample_0(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_0,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_0,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}float shadow_occlusion_1(highp vec4 pos,highp float bias) {highp vec2 uv=pos.xy;return shadow_sample_1(uv,pos.z-bias);}float shadow_occlusion_0(highp vec4 pos,highp float bias) {highp float compare0=pos.z-bias;
#ifdef TEXTURE_GATHER
highp vec2 uv=pos.xy;highp vec4 samples=textureGather(u_shadowmap_0,uv,0);lowp vec4 stepSamples=step(samples,vec4(compare0));
#else
highp vec2 uv00=pos.xy-vec2(0.5*u_shadow_texel_size);highp vec2 uv10=uv00+vec2(u_shadow_texel_size,0.0);highp vec2 uv01=uv00+vec2(0.0,u_shadow_texel_size);highp vec2 uv11=uv01+vec2(u_shadow_texel_size,0.0);lowp vec4 stepSamples=vec4(
shadow_sample_0(uv01,compare0),shadow_sample_0(uv11,compare0),shadow_sample_0(uv10,compare0),shadow_sample_0(uv00,compare0)
);
#endif
vec2 f=fract(pos.xy*u_shadow_map_resolution-vec2(0.5));lowp vec2 lerpx=mix(stepSamples.wx,stepSamples.zy,f.xx);return clamp(mix(lerpx.x,lerpx.y,f.y),0.0,1.0);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {
#ifdef SHADOWS_SINGLE_CASCADE
light_view_pos0.xyz/=light_view_pos0.w;vec2 abs_bounds=abs(light_view_pos0.xy);if (abs_bounds.x >=1.0 || abs_bounds.y >=1.0) {return 0.0;}light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);
#else
light_view_pos0.xyz/=light_view_pos0.w;light_view_pos1.xyz/=light_view_pos1.w;vec4 uv=vec4(light_view_pos0.xy,light_view_pos1.xy);vec4 abs_bounds=abs(uv);if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}light_view_pos1.xyz=light_view_pos1.xyz*0.5+0.5;float occlusion1=shadow_occlusion_1(light_view_pos1,bias);return clamp(mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth)),0.0,1.0);
#endif
}highp float calculate_shadow_bias(float NDotL) {
#ifdef NORMAL_OFFSET
return 0.5*u_shadow_bias.x;
#else
return 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));
#endif
}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_opacity(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,float shadow_opacity) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias)*shadow_opacity;return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}highp vec2 compute_receiver_plane_depth_bias(highp vec3 pos_dx,highp vec3 pos_dy)
{highp vec2 biasUV=vec2(
pos_dy.y*pos_dx.z-pos_dx.y*pos_dy.z,pos_dx.x*pos_dy.z-pos_dy.x*pos_dx.z);biasUV*=1.0/((pos_dx.x*pos_dy.y)-(pos_dx.y*pos_dy.x));return biasUV;}float shadowed_light_factor_plane_bias(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {highp vec3 light_view_pos0_xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;highp vec3 light_view_pos0_ddx=dFdx(light_view_pos0_xyz);highp vec3 light_view_pos0_ddy=dFdy(light_view_pos0_xyz);highp vec2 plane_depth_bias=compute_receiver_plane_depth_bias(light_view_pos0_ddx,light_view_pos0_ddy);highp float bias=dot(vec2(u_shadow_texel_size,u_shadow_texel_size),plane_depth_bias)+0.0001;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}
#endif`;const zu=[];Xc(t1,zu),Xc(Tg,zu),Xc(Vx,zu);const Vh={"_prelude_fog.vertex.glsl":Gx,"_prelude_terrain.vertex.glsl":zd,"_prelude_shadow.vertex.glsl":kg,"_prelude_fog.fragment.glsl":r1,"_prelude_shadow.fragment.glsl":Pg,"_prelude_lighting.glsl":`
#ifdef LIGHTING_3D_MODE
uniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 linearProduct(vec3 srgbIn,vec3 k) {return srgbIn*pow(k,vec3(1./2.2));}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}
#endif//LIGHTING_3D_MODE`,"_prelude_raster_array.glsl":$h,"_prelude_raster_particle.glsl":af},of={};jn("",zd),jn(r1,Gx),jn(Pg,kg),jn($h,""),jn(af,"");const n1=jn(Vx,Tg),Hx=t1;var Eg={background:jn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
in vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_lighting.glsl"
in vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform mediump vec4 u_color;out vec4 v_color;uniform float u_emissive_strength;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:jn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;in highp vec2 v_pos;void main() {highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=textureLodCustom(u_image,pos,v_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec2 u_pattern_units_to_pixels;in vec2 a_pos;out highp vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_pattern_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:jn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float blur_positive=blur < 0.0 ? 0.0 : 1.0;lowp float antialiasblur=v_data.z;float extrude_length=length(extrude)+antialiasblur*(1.0-blur_positive);float antialiased_blur=-max(abs(blur),antialiasblur);float antialiase_blur_opacity=smoothstep(0.0,antialiasblur,extrude_length-1.0);float opacity_t=blur_positive==1.0 ? 
smoothstep(0.0,-antialiased_blur,1.0-extrude_length) : 
smoothstep(antialiased_blur,0.0,extrude_length-1.0)-antialiase_blur_opacity;float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
glFragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
#ifdef ELEVATED_ROADS
in float a_circle_z_offset;
#endif
out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
#ifdef ELEVATED_ROADS
world_center.z+=a_circle_z_offset+ELEVATION_BIAS;
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:jn("void main() {glFragColor=vec4(1.0);}","in vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:jn(`#include "_prelude_fog.fragment.glsl"
uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);glFragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {glFragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:jn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));glFragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(0.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,"in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:jn("in float v_placed;in float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);glFragColor =mix(red,blue,step(0.5,v_placed))*0.5;glFragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`#include "_prelude_terrain.vertex.glsl"
in vec3 a_pos;in vec2 a_anchor_pos;in vec2 a_extrude;in vec2 a_placed;in vec2 a_shift;in vec2 a_elevation_from_sea;in float a_size_scale;in vec2 a_padding;in float a_auto_z_offset;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;out float v_placed;out float v_notUsed;void main() {float feature_elevation=a_elevation_from_sea.x+a_auto_z_offset;float terrain_elevation=(a_elevation_from_sea.y==1.0 ? 0.0 : elevation(a_anchor_pos));vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*(feature_elevation+terrain_elevation),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:jn("in float v_radius;in vec2 v_extrude;in float v_perspective_ratio;in float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);glFragColor=color*alpha*opacity_t;}",`in vec2 a_pos_2f;in float a_radius;in vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;out float v_radius;out vec2 v_extrude;out float v_perspective_ratio;out float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:jn("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);glFragColor=mix(u_color,overlay_color,overlay_color.a);}",`#include "_prelude_terrain.vertex.glsl"
in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;
#endif
out vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),elevatedStructuresDepth:jn(`void main() {
#ifndef DEPTH_TEXTURE
glFragColor=vec4(0.);
#endif
}`,"in vec2 a_pos;in float a_height;uniform mat4 u_matrix;uniform float u_depth_bias;void main() {gl_Position=u_matrix*vec4(a_pos,a_height,1);gl_Position.z=gl_Position.z+u_depth_bias;}"),elevatedStructuresDepthReconstruct:jn(`#ifdef DEPTH_RECONSTRUCTION
in float v_height;
#endif
void main() {
#ifdef DEPTH_RECONSTRUCTION
if (v_height >=0.0)
discard;
#endif
glFragColor=vec4(1.0,0.0,0.0,1.0);}`,`in vec2 a_pos;in float a_height;uniform mat4 u_matrix;uniform vec3 u_camera_pos;uniform highp float u_depth_bias;uniform lowp float u_height_scale;uniform lowp float u_reset_depth;
#ifdef DEPTH_RECONSTRUCTION
out float v_height;
#endif
void main() {vec3 vpos=vec3(a_pos,a_height*u_height_scale);
#ifdef DEPTH_RECONSTRUCTION
if (u_camera_pos.z > vpos.z) {vpos-=(u_camera_pos-vpos)*(vpos.z/(u_camera_pos.z-vpos.z));}v_height=a_height;
#endif
gl_Position=u_matrix*vec4(vpos,1);gl_Position.z=u_reset_depth==1.0 ? gl_Position.w : gl_Position.z+u_depth_bias;}`),elevatedStructures:jn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
in vec3 v_normal;in float v_height;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth;
#endif
void main() {vec3 color=vec3(241.0/255.0,236.0/255.0,225.0/255.0);
#ifdef LIGHTING_3D_MODE
vec3 normal=normalize(v_normal);
#ifdef RENDER_SHADOWS
float shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,v_depth);color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#else
color=apply_lighting(color,normal);
#endif
if (v_height < 0.0) {float penetration=max(v_height+7.5,0.0);float occlusion=1.0-1.0/PI*acos(1.0-penetration/4.0);color=color*(1.0-pow(occlusion,2.0)*0.3);}
#endif
#ifdef FOG
color=fog_apply(color,v_fog_pos);
#endif
vec4 out_color=vec4(color,1.0);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_height);
#endif
glFragColor=out_color;HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;in float a_height;in vec3 a_pos_normal_3;uniform mat4 u_matrix;out vec3 v_normal;out float v_height;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth;
#endif
void main() {v_normal=a_pos_normal_3/16384.0;v_height=a_height;vec3 pos=vec3(a_pos,a_height);gl_Position=u_matrix*vec4(pos,1);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(v_normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fill:jn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=opacity;
#ifdef INDICATOR_CUTOUT
if (v_z_offset >=0.0) {out_color=applyCutout(out_color,v_z_offset);}
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=z_offset;
#endif
}`),fillOutline:jn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
uniform mat4 u_matrix;uniform vec2 u_world;out highp vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:jn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
in highp vec2 v_pos;in highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;out highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:jn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:jn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec4 v_color;in vec4 v_flat;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;
#endif
uniform lowp float u_opacity;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec2 v_ao;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
in vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
in highp vec3 v_normal;
#endif
uniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
in float v_flood_radius;in float v_has_floodlight;
#endif
in float v_height;
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float emissive_strength
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
vec3 normal=normalize(v_normal);
#endif
float z;vec4 color=v_color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);
#ifdef LIGHTING_3D_MODE
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#else
color=mix(v_color,v_roof_color,z);
#endif
#endif
float h=max(0.0,v_height);float ao_shade=1.0;
#ifdef FAUX_AO
float intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
color.rgb*=mix(ao_shade,1.0,v_has_floodlight);
#else
color.rgb*=ao_shade;
#endif
#else
color.rgb*=ao_shade;
#endif
#endif
#ifdef LIGHTING_3D_MODE
float flood_radiance=0.0;
#ifdef FLOOD_LIGHT
flood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;
#endif
#ifdef RENDER_SHADOWS
#ifdef FLOOD_LIGHT
float ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);
#else
float shadowed_lighting_factor;
#ifdef RENDER_CUTOFF
shadowed_lighting_factor=shadowed_light_factor_normal_opacity(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,v_cutoff_opacity);if (v_cutoff_opacity==0.0) {discard;}
#else
shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);
#endif
color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#endif
#else
color.rgb=apply_lighting(color.rgb,normal);
#ifdef FLOOD_LIGHT
color.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);
#endif
#endif
color.rgb=mix(color.rgb,v_flat.rgb,emissive_strength);color*=u_opacity;
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,h);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;uniform float u_width_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
uniform highp float u_vertical_scale;out vec4 v_color;out vec4 v_flat;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
out vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
out highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec2 v_ao;
#endif
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
out float v_flood_radius;out float v_has_floodlight;
#endif
out float v_height;vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define highp float flood_light_wall_radius
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize highp float flood_light_wall_radius
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp float emissive_strength
base*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
v_normal=normal;
#endif
base=max(0.0,base);float attr_height=height;height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele=0.0;vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float cutoff=1.0;vec3 scaled_pos=pos;
#ifdef RENDER_CUTOFF
vec3 centroid_random=vec3(centroid_pos.xy,centroid_pos.x+centroid_pos.y+1.0);vec3 ground_pos=centroid_pos.x==0.0 ? pos.xyz : (centroid_random/8.0);vec4 ground=u_matrix*vec4(ground_pos.xy,ele,1.0);cutoff=cutoff_opacity(u_cutoff_params,ground.z);if (centroid_pos.y !=0.0 && centroid_pos.x !=0.0) {vec3 g=floor(ground_pos);vec3 mod_=centroid_random-g*8.0;float seed=min(1.0,0.1*(min(3.5,max(mod_.x+mod_.y,0.2*attr_height))*0.35+mod_.z));if (cutoff < 0.8-seed) {cutoff=0.0;}}float cutoff_scale=cutoff;v_cutoff_opacity=cutoff;scaled_pos.z=mix(c_ele,h,cutoff_scale);
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (cutoff==0.0 && centroid_pos.x !=0.0) || (color.a==0.0));
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);scaled_pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;scaled_pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
gl_Position=mix(u_matrix*vec4(scaled_pos,1),AWAY,hidden);h=h-ele;v_height=h;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifndef LIGHTING_3D_MODE
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#endif
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
float is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;
#endif
v_color=vec4(color.rgb,1.0);float ndotl=calculate_NdotL(normal);v_flat.rgb=sRGBToLinear(color.rgb);v_flat.rgb=v_flat.rgb*(ndotl+(1.0-min(ndotl*57.29,1.0))*emissive_strength);v_flat=vec4(linearTosRGB(v_flat.rgb),1.0);
#else
v_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionDepth:jn(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_width_scale;uniform float u_vertical_scale;
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp vec4 color
out highp float v_depth;void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp vec4 color
base*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;float ele=elevation(pos_nx.xy);float c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);float h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}`),fillExtrusionPattern:jn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
in vec3 v_normal;
#endif
in highp vec2 v_pos;in vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,height);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_width_scale;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
out highp vec2 v_pos;out vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
out vec3 v_normal;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
#pragma mapbox: define highp float line_width
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
#pragma mapbox: initialize highp float line_width
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);p.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;p.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_normal=normal;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),groundShadow:jn(`#include "_prelude_shadow.fragment.glsl"
precision highp float;uniform vec3 u_ground_shadow_factor;in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#ifdef FOG
in float v_fog_opacity;
#endif
void main() {float light=shadowed_light_factor_plane_bias(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);
#ifdef RENDER_CUTOFF
shadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w));
#endif
#ifdef FOG
shadow=mix(shadow,vec3(1.0),v_fog_opacity);
#endif
#ifdef INDICATOR_CUTOUT
shadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0),0.0).r);
#endif
glFragColor=vec4(shadow,1.0);}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;in vec2 a_pos;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;
#ifdef FOG
out float v_fog_opacity;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);
#ifdef FOG
v_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);
#endif
}`),fillExtrusionGroundEffect:jn(`uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;
#ifdef SDF_SUBPASS
in highp vec2 v_pos;in highp vec4 v_line_segment;in highp float v_flood_light_radius_tile;in highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}
#ifdef FOG
in highp float v_fog;
#endif
#endif
void main() {
#ifdef CLEAR_SUBPASS
vec4 color=vec4(1.0);
#ifdef CLEAR_FROM_TEXTURE
color=texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size));
#endif
glFragColor=color;
#else
#ifdef SDF_SUBPASS
highp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;
#ifdef FOG
fog=v_fog;
#endif
#ifdef RENDER_CUTOFF
fog*=v_cutoff_opacity;
#endif
glFragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));
#else
vec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);
#ifdef OVERDRAW_INSPECTOR
color=vec4(1.0);
#endif
glFragColor=color;
#endif
HANDLE_WIREFRAME_DEBUG;
#endif
}`,`#include "_prelude_fog.vertex.glsl"
in highp vec4 a_pos_end;in highp float a_angular_offset_factor;in highp float a_hidden_by_landmark;
#ifdef SDF_SUBPASS
out highp vec2 v_pos;out highp vec4 v_line_segment;out highp float v_flood_light_radius_tile;out highp vec2 v_ao;
#ifdef FOG
out highp float v_fog;
#endif
#endif
uniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp float u_dynamic_offset;uniform highp vec2 u_ao;
#pragma mapbox: define highp float flood_light_ground_radius
const float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {
#pragma mapbox: initialize highp float flood_light_ground_radius
vec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;fl_ground_radius=abs(flood_light_ground_radius);float direction=flood_light_ground_radius < 0.0 ?-1.0 : 1.0;float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=direction*angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(u_dynamic_offset,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=direction*perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;
#ifdef SDF_SUBPASS
v_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);
#ifdef FOG
v_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);
#endif
#endif
float hidden_by_landmark=0.0;
#ifdef HAS_CENTROID
hidden_by_landmark=a_hidden_by_landmark;
#endif
float isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),hillshadePrepare:jn(`precision highp float;uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;float getElevation(vec2 coord) {return texture(u_image,coord).r/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));glFragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:jn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);glFragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
glFragColor=apply_lighting_with_emission_ground(glFragColor,u_emissive_strength);
#endif
#ifdef FOG
glFragColor=fog_dither(fog_apply_premultiplied(glFragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:jn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform lowp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_floor_width_scale;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec3 v_uv;
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;in vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture(u_dash_image,v_tex).r;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;float scaled_floorwidth=(floorwidth*u_floor_width_scale);alpha*=linearstep(0.5-sdfgamma/scaled_floorwidth,0.5+sdfgamma/scaled_floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trim_alpha=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=v_uv[2];if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);out_color=mix(out_color,u_trim_color,transition_factor);trim_alpha=1.0-transition_factor;}
#endif
if (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}
#ifdef RENDER_LINE_BORDER
float edgeBlur=((border_width*u_width_scale)+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color=mix(border_color*trim_alpha,out_color,smoothAlpha);}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
out_color.rgb*=mix(v_road_z_offset > 0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define EXTRUDE_SCALE 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS) || defined(VARIABLE_LINE_WIDTH)
in vec3 a_z_offset_width;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
in highp vec3 a_packed;
#endif
#ifdef RENDER_LINE_DASH
in float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;uniform float u_width_scale;uniform highp float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec3 v_uv;
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;out vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth;
#ifdef VARIABLE_LINE_WIDTH
float left=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);halfwidth=(u_width_scale*(left==1.0 ? a_z_offset_width.y : a_z_offset_width.z))/2.0;
#else
halfwidth=(u_width_scale*width)/2.0;
#endif
offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset,1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=max(length(projected_extrude_xy/gl_Position.w*u_units_to_pixels),0.001);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
highp float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float line_progress=a_packed[2];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec3(a_uv_x,a_split_index*texel_height-half_texel_height,line_progress);
#else
v_uv=vec3(a_uv_x,0.0,line_progress);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/(floorwidth*u_floor_width_scale),(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),linePattern:jn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform highp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_alpha_discard_threshold;uniform highp vec2 u_texsize;uniform highp float u_tile_units_to_pixels;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in highp float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec3 v_uv;
#endif
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef LINE_JOIN_NONE
in vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
uniform float u_emissive_strength;
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define mediump float pixel_ratio
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize mediump float pixel_ratio
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;highp float pattern_size=display_size.x/u_tile_units_to_pixels;float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);highp float pattern_x=v_linesofar/pattern_size*aspect;highp float x=mod(pattern_x,1.0);highp float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;highp vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));highp vec2 lod_pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(pattern_x,y));vec4 color=textureLodCustom(u_image,pos,lod_pos);
#ifdef RENDER_LINE_TRIM_OFFSET
highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=v_uv[2];if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);color=mix(color,color.a*u_trim_color,transition_factor);}
#endif
#ifdef LINE_JOIN_NONE
highp float pattern_len=pattern_size/aspect;highp float segment_phase=pattern_len-mod(v_linesofar-v_pattern_data.x+pattern_len,pattern_len);highp float visible_start=segment_phase-step(pattern_len*0.5,segment_phase)*pattern_len;highp float visible_end=floor((v_pattern_data.y-segment_phase)/pattern_len)*pattern_len+segment_phase;visible_end+=step(pattern_len*0.5,v_pattern_data.y-visible_end)*pattern_len;if (v_pattern_data.x < visible_start || v_pattern_data.x >=visible_end) {color=vec4(0.0);}
#endif
#ifdef LIGHTING_3D_MODE
color=apply_lighting_with_emission_ground(color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
color.rgb*=mix(v_road_z_offset > 0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=(alpha*opacity);if (u_alpha_discard_threshold !=0.0) {if (color.a < u_alpha_discard_threshold) {discard;}}
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,v_z_offset);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
in vec3 a_z_offset_width;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec3 a_packed;
#endif
in highp float a_linesofar;
#ifdef LINE_JOIN_NONE
in highp vec3 a_pattern_data;out vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;uniform float u_tile_units_to_pixels;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform float u_device_pixel_ratio;uniform float u_width_scale;uniform float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out highp float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
out highp vec3 v_uv;
#endif
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
#pragma mapbox: define mediump float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define mediump float floorwidth
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define mediump float pixel_ratio
void main() {
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
#pragma mapbox: initialize mediump float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize mediump float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize mediump float pixel_ratio
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=(u_width_scale*width)/2.0;offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);vec2 dist=outset*a_extrude*scale;float u=0.5*a_direction;float t=1.0-abs(u);vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset,1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude_xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
highp float a_uv_x=a_packed[0];highp float line_progress=a_packed[2];v_uv=vec3(a_uv_x,0.0,line_progress);
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=(floorwidth*u_floor_width_scale);
#ifdef LINE_JOIN_NONE
v_width=(floorwidth*u_floor_width_scale)+ANTIALIASING;mediump float pixels_to_tile_units=1.0/u_tile_units_to_pixels;mediump float pixel_ratio_inverse=1.0/pixel_ratio;mediump float aspect=v_width/((pattern.w-pattern.y)*pixel_ratio_inverse);highp float subt_multiple=(pattern.z-pattern.x)*pixel_ratio_inverse*pixels_to_tile_units*aspect*32.0;highp float subt=floor(a_pattern_data.z/subt_multiple)*subt_multiple;float offset_sign=(fract(a_pattern_data.x)-0.5)*4.0;float line_progress_offset=offset_sign*v_width*0.5*pixels_to_tile_units;v_linesofar=(a_pattern_data.z-subt)+a_linesofar+line_progress_offset;v_pattern_data=vec2(a_pattern_data.x+line_progress_offset,a_pattern_data.y);
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),raster:jn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_raster_array.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;uniform highp float u_zoom_transition;in vec2 v_pos0;in vec2 v_pos1;in float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
in float v_split_fade;
#endif
uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;uniform float u_emissive_strength;
#ifndef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;
#endif
#ifdef RASTER_COLOR
uniform sampler2D u_color_ramp;uniform highp vec4 u_colorization_mix;uniform highp float u_colorization_offset;uniform vec2 u_texture_res;
#endif
void main() {vec4 color0,color1,color;vec2 value;
#ifdef RASTER_COLOR
#ifdef RASTER_ARRAY
#ifdef RASTER_ARRAY_LINEAR
value=mix(
raTexture2D_image0_linear(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_linear(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#else
value=mix(
raTexture2D_image0_nearest(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_nearest(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#endif
if (value.y > 0.0) value.x/=value.y;
#else
color=mix(texture(u_image0,v_pos0),texture(u_image1,v_pos1),u_fade_t);value=vec2(u_colorization_offset+dot(color.rgb,u_colorization_mix.rgb),color.a);
#endif
color=texture(u_color_ramp,vec2(value.x,0.5));if (color.a > 0.0) color.rgb/=color.a;color.a*=value.y;
#else
color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);
#endif
color.a*=u_opacity;
#ifdef GLOBE_POLES
color.a*=1.0-smoothstep(0.0,0.05,u_zoom_transition);
#endif
vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),u_emissive_strength).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef PROJECTION_GLOBE_VIEW
glFragColor*=mix(1.0,1.0-smoothstep(0.0,0.05,u_zoom_transition),smoothstep(0.8,0.9,v_split_fade));
#endif
#ifdef RENDER_CUTOFF
glFragColor=glFragColor*cutoff_opacity(u_cutoff_params,v_depth);
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;uniform vec2 u_texture_offset;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;in vec2 a_texture_pos;
#endif
out vec2 v_pos0;out vec2 v_pos1;out float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
out float v_split_fade;
#endif
void main() {vec2 uv;
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;gl_Position=u_matrix*u_globe_matrix*vec4(globe_pos   ,1.0);uv=a_uv;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);
#endif
#else
float w=1.0+dot(a_texture_pos,u_perspective_transform);uv=a_texture_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);    
v_split_fade=0.0;if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;float opposite_merc_center=mod(u_merc_center.x+0.5,1.0);float dist_from_poles=(abs(mercatorY-0.5)*2.0);float range=0.1;v_split_fade=abs(opposite_merc_center-mercatorX);v_split_fade=clamp(1.0-v_split_fade,0.0,1.0);v_split_fade=max(smoothstep(1.0-range,1.0,dist_from_poles),max(smoothstep(1.0-range,1.0,v_split_fade),smoothstep(1.0-range,1.0,1.0-v_split_fade)));}float tiles=u_grid_matrix[0][2];if (tiles > 0.0) {float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvY=mercatorY*tiles-idy;float uvX=mercatorX*tiles-idx;uv=vec2(uvX,uvY);}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;v_pos0=u_texture_offset.x+u_texture_offset.y*v_pos0;v_pos1=u_texture_offset.x+u_texture_offset.y*v_pos1;
#ifdef RENDER_CUTOFF
v_depth=gl_Position.z;
#endif
}`),rasterParticle:jn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;in vec2 v_pos0;in vec2 v_pos1;uniform sampler2D u_image0;uniform sampler2D u_image1;void main() {vec4 color0,color1,color;color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 out_color=color.rgb;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),0.0).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {float w=1.0;vec2 uv;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvX=mercatorX*tiles-idx;float uvY=mercatorY*tiles-idy;uv=vec2(uvX,uvY);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
uv=a_texture_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),rasterParticleDraw:jn("uniform sampler2D u_color_ramp;in float v_particle_speed;void main() {glFragColor=texture(u_color_ramp,vec2(v_particle_speed,0.5));}",`#include "_prelude_raster_particle.glsl"
in float a_index;uniform sampler2D u_particle_texture;uniform float u_particle_texture_side_len;uniform vec2 u_tile_offset;out float v_particle_speed;void main() {ivec2 pixel_coord=ivec2(
mod(a_index,u_particle_texture_side_len),a_index/u_particle_texture_side_len);vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);vec2 pos=unpack_pos_from_rgba(pixel)+u_tile_offset;vec2 tex_coord=fract(pos);vec2 velocity=lookup_velocity(tex_coord);if (velocity==INVALID_VELOCITY) {gl_Position=AWAY;v_particle_speed=0.0;} else {gl_Position=vec4(2.0*pos-1.0,0,1);v_particle_speed=length(velocity);}gl_PointSize=1.0;}`),rasterParticleTexture:jn("uniform sampler2D u_texture;uniform float u_opacity;in vec2 v_tex_pos;void main() {vec4 color=texture(u_texture,v_tex_pos);glFragColor=vec4(floor(255.0*color*u_opacity)/255.0);}","in vec2 a_pos;out vec2 v_tex_pos;void main() {vec2 uv=0.5*a_pos+vec2(0.5);v_tex_pos=uv;gl_Position=vec4(a_pos,0.0,1.0);}"),rasterParticleUpdate:jn(`#include "_prelude_raster_particle.glsl"
uniform sampler2D u_particle_texture;uniform mediump float u_particle_texture_side_len;uniform mediump float u_speed_factor;uniform highp float u_reset_rate;uniform highp float u_rand_seed;in highp vec2 v_tex_coord;vec2 linearstep(vec2 edge0,vec2 edge1,vec2 x) {return  clamp((x-edge0)/(edge1-edge0),vec2(0),vec2(1));}const highp vec3 rand_constants=vec3(12.9898,78.233,4375.85453);highp float rand(const highp vec2 co) {highp float t=dot(rand_constants.xy,co);return fract(sin(t)*(rand_constants.z+t));}void main() {ivec2 pixel_coord=ivec2(v_tex_coord*u_particle_texture_side_len);highp vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);highp vec2 pos=unpack_pos_from_rgba(pixel);highp vec2 velocity=lookup_velocity(clamp(pos,0.0,1.0));highp vec2 dp=velocity==INVALID_VELOCITY ? vec2(0) : velocity*u_speed_factor;pos=pos+dp;highp vec2 seed=(pos+v_tex_coord)*u_rand_seed;highp vec2 random_pos=vec2(rand(seed+1.3),rand(seed+2.1));highp vec2 persist_rate=pow(
linearstep(vec2(-u_particle_pos_offset),vec2(0),pos)*linearstep(vec2(1.0+u_particle_pos_offset),vec2(1),pos),vec2(4)
);highp vec2 per_frame_persist=pow(persist_rate,abs(dp)/u_particle_pos_offset);highp float drop_rate=1.0-per_frame_persist.x*per_frame_persist.y;drop_rate=any(greaterThanEqual(abs(pos-0.5),vec2(0.5+u_particle_pos_offset))) ? 1.0 : drop_rate;highp float drop=step(1.0-drop_rate-u_reset_rate,rand(seed));highp vec2 next_pos=mix(pos,random_pos,drop);glFragColor=pack_pos_to_rgba(next_pos);}`,"in vec2 a_pos;out vec2 v_tex_coord;void main() {v_tex_coord=0.5*(a_pos+vec2(1.0));gl_Position=vec4(a_pos,0.0,1.0);}"),symbol:jn(`#include "_prelude_lighting.glsl"
#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;uniform lowp float u_scale_factor;
#ifdef ICON_TRANSITION
uniform float u_icon_transition;
#endif
#ifdef COLOR_ADJUSTMENT
uniform mat4 u_color_adj_mat;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
in vec2 v_tex_a;
#ifdef ICON_TRANSITION
in vec2 v_tex_b;
#endif
in float v_draw_halo;in vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
in float is_sdf;in vec2 v_tex_a_icon;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec4 out_color;float fade_opacity=v_gamma_scale_size_fade_opacity[2];
#ifdef RENDER_TEXT_AND_SYMBOL
if (is_sdf==ICON) {vec2 tex_icon=v_tex_a_icon;lowp float alpha=opacity*fade_opacity;glFragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
return;}
#endif
#ifdef RENDER_SDF
float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_gamma_scale_size_fade_opacity.x;float size=v_gamma_scale_size_fade_opacity.y;float fontScale=u_is_text ? size/24.0 : size;out_color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {out_color=halo_color;gamma=(halo_blur*u_scale_factor*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width*u_scale_factor/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,v_tex_a).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);out_color*=alpha;
#else
#ifdef ICON_TRANSITION
vec4 a=texture(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b);
#else
out_color=texture(u_texture,v_tex_a);
#endif
#ifdef COLOR_ADJUSTMENT
out_color=u_color_adj_mat*out_color;
#endif
#endif
out_color*=opacity*fade_opacity;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_auto_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
#ifdef ICON_TRANSITION
in vec2 a_texb;
#endif
#ifdef OCCLUSION_QUERIES
in float a_occlusion_query_opacity;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_elevation_from_sea;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out vec2 v_tex_a;
#ifdef ICON_TRANSITION
out vec2 v_tex_b;
#endif
out float v_draw_halo;out vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
out float is_sdf;out vec2 v_tex_a_icon;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
#pragma mapbox: define lowp float occlusion_opacity
#pragma mapbox: define lowp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
#pragma mapbox: initialize lowp float occlusion_opacity
#pragma mapbox: initialize lowp float z_offset
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=u_elevation_from_sea ? z_offset : z_offset+elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_auto_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;vec3 world_pos_globe;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos_globe=a_globe_anchor+h;world_pos=mix_globe_mercator(world_pos_globe,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;vec2 a;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);vec4 projected_point_globe=u_matrix*vec4(world_pos_globe,1);a=projected_point_globe.xy/projected_point_globe.w;
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);a=projected_point.xy/projected_point.w;
#endif
vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
#ifdef PROJECTED_POS_ON_VIEWPORT
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xyz+h,1.0);
#else
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz,mercator_pos,u_zoom_transition)+h;projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);    
#endif
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
#ifdef Z_OFFSET
z+=u_pitch_with_map ? a_auto_z_offset+(u_elevation_from_sea ? z_offset : z_offset) : 0.0;
#else
z+=u_pitch_with_map ? (u_elevation_from_sea ? z_offset : z_offset) : 0.0;
#endif
float occlusion_fade=globe_occlusion_fade;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float out_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));
#ifdef DEPTH_OCCLUSION
float depth_occlusion=occlusionFadeMultiSample(projected_point);float depth_occlusion_multplier=mix(occlusion_opacity,1.0,depth_occlusion);out_fade_opacity*=depth_occlusion_multplier;
#endif
#ifdef OCCLUSION_QUERIES
float occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);out_fade_opacity*=occludedFadeMultiplier;
#endif
float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
float gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_gamma_scale_size_fade_opacity=vec3(gamma_scale,size,out_fade_opacity);v_tex_a=a_tex/u_texsize;
#ifdef RENDER_TEXT_AND_SYMBOL
is_sdf=a_size[0]-2.0*a_size_min;v_tex_a_icon=a_tex/u_texsize_icon;
#endif
#ifdef ICON_TRANSITION
v_tex_b=a_texb/u_texsize;
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=e;
#endif
}`),terrainRaster:jn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;in vec2 v_pos0;
#ifdef FOG
in float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#endif
uniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture(u_image0,v_pos0);vec4 color;
#ifdef LIGHTING_3D_MODE
const vec3 normal=vec3(0.0,0.0,1.0);
#ifdef RENDER_SHADOWS
float cutoffOpacity=1.0;
#ifdef RENDER_CUTOFF
cutoffOpacity=cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w);
#endif
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
vec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;
#else
float lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));
#endif
#else
float lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;
#endif
#endif
#else
color=image_color;
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_skirt_height;in vec2 a_pos;out vec2 v_pos0;
#ifdef FOG
out float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth;
#endif
void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);
#endif
}`),terrainDepth:jn("precision highp float;in float v_depth;void main() {glFragColor=pack_depth(v_depth);}",`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;out float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}`),skybox:jn(`#include "_prelude_fog.fragment.glsl"
in lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=texture(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color+=0.1*sun_disk(v_uv,u_sun_direction);glFragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,Ux),skyboxGradient:jn(`#include "_prelude_fog.fragment.glsl"
in highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,Ux),skyboxCapture:jn(`
in highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;precision highp float;
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;glFragColor=vec4(color,1.0);}`,"in highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;out highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:jn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;uniform float u_far_z_cutoff;in vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;highp float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);highp float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
raster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(clamp(raster.rgb,vec3(0),vec3(1))*antialias,antialias);
#else
raster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;
#else
color=apply_lighting_ground(color);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=1.0-step(u_far_z_cutoff,1.0/gl_FragCoord.w);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;
#endif
out vec2 v_pos0;void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:jn(`#include "_prelude_fog.fragment.glsl"
uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;in highp vec3 v_ray_dir;in highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {
#ifdef ALPHA_PASS
glFragColor=vec4(0,0,0,0);return;
#else
#ifdef NATIVE
glFragColor=vec4(1,1,1,1);
#else
glFragColor=vec4(0,0,0,1);
#endif
return;
#endif
}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;
#ifdef ALPHA_PASS
float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);glFragColor=vec4(1.0,1.0,1.0,a);
#else
vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;glFragColor=vec4(c*t,t);
#endif
}`,`in vec3 a_pos;in vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;out highp vec3 v_ray_dir;out highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`),model:jn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;in highp vec4 v_position_height;in lowp vec4 v_color_mix;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
#ifdef OCCLUSION_TEXTURE_TRANSFORM
uniform vec4 u_occlusionTextureTransform;
#endif
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#ifdef HAS_ATTRIBUTE_a_pbr
in lowp vec4 v_roughness_metallic_emissive_alpha;in mediump vec4 v_height_based_emission_params;
#endif
#ifdef HAS_TEXTURE_u_baseColorTexture
uniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;
#endif
#ifdef HAS_TEXTURE_u_metallicRoughnessTexture
uniform sampler2D u_metallicRoughnessTexture;
#endif
#ifdef HAS_TEXTURE_u_occlusionTexture
uniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;
#endif
#ifdef HAS_TEXTURE_u_normalTexture
uniform sampler2D u_normalTexture;
#endif
#ifdef HAS_TEXTURE_u_emissionTexture
uniform sampler2D u_emissionTexture;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
in highp float v_depth;uniform highp sampler2D u_depthTexture;uniform highp vec2 u_inv_depth_size;uniform highp vec2 u_depth_range_unpack;
#ifdef DEPTH_D24
highp float unpack_depth(highp float depth) {return  depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}
#else
highp float unpack_depth_rgba(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded() {highp vec2 coord=gl_FragCoord.xy*u_inv_depth_size;
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depthTexture,coord).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depthTexture,coord));
#endif
return v_depth > depth+0.0005;}
#endif
#define saturate(_x) clamp(_x,0.,1.)
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)
{
#ifdef LIGHTING_3D_MODE
vec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));
#endif
return apply_lighting(albedo,transformed_normal,lighting_factor);
#else
vec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;
#endif
}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;
#ifdef HAS_ATTRIBUTE_a_color_3f
albedo*=vec4(color_3f,1.0);
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#else
#ifdef HAS_ATTRIBUTE_a_color_4f
albedo*=color_4f;
#endif
#endif
#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)
vec4 texColor=texture(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}
#ifdef UNPREMULT_TEXTURE_IN_SHADER
if(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;
#endif
if(u_baseTextureIsAlpha) {if (texColor.r < 0.5) {discard;}} else {texColor.rgb=sRGBToLinear(texColor.rgb);albedo*=texColor;}
#endif
vec4 color=vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);
#ifdef APPLY_LUT_ON_GPU
color=applyLUT(u_lutTexture,color);
#endif
return color;}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {
#ifdef HAS_TEXTURE_u_normalTexture
highp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;
#else
return mat3(1.0);
#endif
}highp vec3 getNormal(){highp vec3 n;
#ifdef HAS_ATTRIBUTE_a_normal_3f
n=normalize(normal_3f);
#else
highp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));n=normalize(cross(fdx,fdy))*-1.0;
#endif
#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
vec3 nMap=texture( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);
#endif
return n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;
#ifdef HAS_ATTRIBUTE_a_pbr
mat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;
#endif
#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) 
vec4 mrSample=texture(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;
#endif
const float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)
{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)
{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)
{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)
{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)
{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)
{
#ifdef LIGHTING_3D_MODE
return mat.diffuseColor;
#else
return mat.diffuseColor/PI;
#endif
}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)
{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)
{vec3 env_light=vec3(0.65,0.65,0.65);
#ifdef LIGHTING_3D_MODE
float ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;
#endif
vec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)
{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=NdotL;
#endif
vec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;
#if !defined(LIGHTING_3D_MODE)
const vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);
#endif
color*=intensityFactor;return color;}void main() {
#ifdef TERRAIN_FRAGMENT_OCCLUSION
if (isOccluded()) {discard;}
#endif
vec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;
#ifdef LIGHTING_3D_MODE
lightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;
#endif
vec4 finalColor;
#ifdef DIFFUSE_SHADED
vec3 N=getNormal();vec3 baseColor=getBaseColor().rgb;vec3 diffuse=getDiffuseShadedColor(baseColor,N,lightDir,lightColor);
#ifdef HAS_TEXTURE_u_occlusionTexture
float ao=(texture(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;
#endif
finalColor=vec4(mix(diffuse,baseColor,u_emissive_strength),1.0)*u_opacity;
#else
Material mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);float ao=1.0;
#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
#ifdef OCCLUSION_TEXTURE_TRANSFORM
vec2 uv=uv_2f.xy*u_occlusionTextureTransform.zw+u_occlusionTextureTransform.xy;
#else
vec2 uv=uv_2f;
#endif
ao=(texture(u_occlusionTexture,uv).x-1.0)*u_aoIntensity+1.0;color*=ao;
#endif
vec4 emissive=u_emissiveFactor;
#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
emissive.rgb*=sRGBToLinear(texture(u_emissionTexture,uv_2f).rgb);
#endif
#ifdef APPLY_LUT_ON_GPU
float emissiveFactorLength=max(length(u_emissiveFactor.rgb),0.001);emissive.rgb=sRGBToLinear(applyLUT(u_lutTexture,linearTosRGB(emissive.rgb/emissiveFactorLength).rbg))*emissiveFactorLength;
#endif
color+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;
#ifdef HAS_ATTRIBUTE_a_pbr
float resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);vec3 color_mix=v_color_mix.rgb;
#ifdef APPLY_LUT_ON_GPU
color_mix=applyLUT(u_lutTexture,color_mix);
#endif
color=mix(color,color_mix,min(1.0,resEmission));
#ifdef HAS_ATTRIBUTE_a_color_4f
float distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);
#endif
#endif
vec3 unlitColor=mat.baseColor.rgb*ao+emissive.rgb;color=mix(color,unlitColor,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);
#endif
#ifdef FOG
finalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));
#endif
#ifdef RENDER_CUTOFF
finalColor*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
finalColor=applyCutout(finalColor,v_position_height.w);
#endif
glFragColor=finalColor;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr
#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength
uniform mat4 u_matrix;uniform mat4 u_node_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_normal_matrix;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
out vec4 v_position_height;out lowp vec4 v_color_mix;
#ifdef TERRAIN_FRAGMENT_OCCLUSION
out highp float v_depth;
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
out lowp vec4 v_roughness_metallic_emissive_alpha;out mediump vec4 v_height_based_emission_params;
#endif
vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute-custom highp vec4 pbr
#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength
highp mat4 normal_matrix;
#ifdef INSTANCED_ARRAYS
normal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
normal_matrix=u_normal_matrix;
#endif
vec3 local_pos;mat3 rs;
#ifdef MODEL_POSITION_ON_GPU
vec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float hidden=float(pos_a.x > EXTENT);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=mix(u_matrix*pos,AWAY,hidden);pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;
#else
local_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);
#endif
v_position_height.w=a_pos_3f.z;
#ifdef HAS_ATTRIBUTE_a_pbr
vec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;
#endif
#ifdef FOG
v_fog_pos=fog_position(local_pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
float x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);
#else
normal_3f=vec3(normal_matrix*vec4(normal_3f,0));
#endif
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#ifdef HAS_ATTRIBUTE_a_color_4f
v_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);
#endif
#endif
#ifdef RENDER_SHADOWS
vec4 shadow_pos=u_node_matrix*vec4(local_pos,1.0);
#ifdef NORMAL_OFFSET
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
vec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#else
vec3 offset=shadow_normal_offset_model(normal_3f);shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#endif
#endif
#endif
v_pos_light_view_0=u_light_matrix_0*shadow_pos;v_pos_light_view_1=u_light_matrix_1*shadow_pos;v_depth_shadows=gl_Position.w;
#endif
}`),modelDepth:jn(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;
#ifdef MODEL_POSITION_ON_GPU
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_instance;
#endif
uniform highp mat4 u_node_matrix;
#endif
void main() {
#ifdef MODEL_POSITION_ON_GPU
highp mat4 instance;
#ifdef INSTANCED_ARRAYS
instance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
instance=u_instance;
#endif
vec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float hidden=float(pos_a.x > EXTENT);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=mix(u_matrix*pos,AWAY,hidden);
#else
gl_Position=u_matrix*vec4(a_pos_3f,1);
#endif
v_depth=gl_Position.z/gl_Position.w;}`),stars:jn(`in highp vec2 v_uv;in mediump float v_intensity;float shapeCircle(in vec2 uv)
{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;glFragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}`,`
in vec3 a_pos_3f;in vec2 a_uv;in float a_size_scale;in float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;out highp vec2 v_uv;out mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}`),snowParticle:jn("in highp vec2 uv;in highp float alphaMultiplier;uniform vec4 u_particleColor;uniform vec2 u_simpleShapeParameters;void main() {float t=clamp((length(uv)-u_simpleShapeParameters.x)/(1.0-u_simpleShapeParameters.x),0.0,1.0);float alpha=1.0-pow(t,pow(10.0,u_simpleShapeParameters.y));alpha*=alphaMultiplier;alpha*=u_particleColor.a;vec3 color=u_particleColor.rgb*alpha;glFragColor=vec4(color,alpha) ;HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_snowParticleData;in highp vec4 a_snowParticleDataHorizontalOscillation;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform vec2 u_screenSize;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity;uniform vec3 u_direction;uniform float u_horizontalOscillationRadius; 
uniform float u_horizontalOscillationRate; 
uniform float u_billboardSize;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;out highp vec2 uv;out highp float alphaMultiplier;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos.xyz*=halfBoxSize;pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_snowParticleData.z;float coneAngleHeadingRad=a_snowParticleData.w*radians(360.0);vec3 localZ=normalize(u_direction);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 direction;direction.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.z=cos(coneAnglePichRad);direction=normalize(direction);vec3 simPosLocal=vec3(0,0,0);float velocityScale=(1.0+3.0*a_snowParticleData.y)*u_velocity;simPosLocal+=direction*velocityScale*u_time;float horizontalOscillationRadius=u_horizontalOscillationRadius*a_snowParticleDataHorizontalOscillation.x;float horizontalOscillationAngle=u_horizontalOscillationRate*u_time*(-1.0+2.0*a_snowParticleDataHorizontalOscillation.y);simPosLocal.xy+=horizontalOscillationRadius*vec2(cos(horizontalOscillationAngle),sin(horizontalOscillationAngle));vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);float clipZ=-u_cam_pos.z+pos.z;vec4 posView=u_modelview*vec4(pos,1.0);float size=u_billboardSize;alphaMultiplier=1.0;vec4 posScreen=u_projection*posView;posScreen/=posScreen.w;posScreen.xy=vec2(0.5)+posScreen.xy*0.5;posScreen.xy*=u_screenSize;vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=u_screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-posScreen.xy)/(0.5*u_screenSize));screenDist+=a_snowParticleData.x*u_thinningParticleOffset;float scaleFactorMode=0.0;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);if (a_snowParticleData.x < u_thinningAffectedRatio) {scaleFactorMode=1.0-thinningFadeRatio;alphaMultiplier=thinningFadeRatio;}}vec4 posScreen1=u_projection*vec4(posView.x-size,posView.yzw);posScreen1/=posScreen1.w;vec4 posScreen2=u_projection*vec4(posView.x+size,posView.yzw);posScreen2/=posScreen2.w;posScreen1.xy=vec2(0.5)+posScreen1.xy*0.5;posScreen1.xy*=u_screenSize;posScreen2.xy=vec2(0.5)+posScreen2.xy*0.5;posScreen2.xy*=u_screenSize;float screenLength=length(posScreen1.xy-posScreen2.xy);float screenEpsilon=3.0;float scaleFactor=1.0;if (screenLength < screenEpsilon) {scaleFactor=screenEpsilon/max(screenLength,0.01);scaleFactor=mix(scaleFactor,1.0,scaleFactorMode);}float screenEpsilon2=15.0;if (screenLength > screenEpsilon2) {scaleFactor=screenEpsilon2/max(screenLength,0.01);}size*=scaleFactor;vec2 right=size*vec2(1,0);vec2 up=size*vec2(0,1);posView.xy+=right*a_uv.x;posView.xy+=up*a_uv.y;uv=a_uv;gl_Position=u_projection*posView;}`),rainParticle:jn("in highp vec2 uv;in highp float particleRandomValue;uniform sampler2D u_texScreen;uniform float u_distortionStrength;uniform vec4 u_color;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;uniform float u_shapeDirectionalPower;uniform float u_mode;void main() {vec2 st=uv*0.5+vec2(0.5);vec2 uvm=uv;uvm.y=-1.0+2.0*pow(st.y,u_shapeDirectionalPower);float shape=clamp(1.0-length(uvm),0.0,1.0);float alpha=abs(shape)*u_color.a;vec2 screenSize=vec2(textureSize(u_texScreen,0));vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-gl_FragCoord.xy)/(0.5*screenSize));screenDist+=(0.5+0.5*particleRandomValue)*u_thinningParticleOffset;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;float thinningAlpha=1.0;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);thinningAlpha*=thinningFadeRatio;}vec2 offsetXY=normalize(uvm)*abs(shape);vec2 stScreen=(gl_FragCoord.xy+offsetXY*u_distortionStrength*thinningAlpha)/screenSize;vec3 colorScreen=texture(u_texScreen,stScreen).rgb;alpha*=thinningAlpha;glFragColor=mix(vec4(colorScreen,1.0),vec4(u_color.rgb*alpha,alpha),u_mode);HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_rainParticleData;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity; 
uniform vec2 u_rainDropletSize;uniform vec3 u_rainDirection;out highp vec2 uv;out highp float particleRandomValue;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos*=halfBoxSize; 
pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_rainParticleData.z;float coneAngleHeadingRad=a_rainParticleData.w*radians(360.0);vec3 localZ=normalize(u_rainDirection);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 directionLocal;directionLocal.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.z=cos(coneAnglePichRad);directionLocal=normalize(directionLocal);vec3 directionWorld=localX*directionLocal.x+localY*directionLocal.y+localZ*directionLocal.z;float velocityScale=(1.0+3.0*a_rainParticleData.y)*u_velocity;vec3 simPosLocal=vec3(0,0,0);simPosLocal+=directionLocal*velocityScale*u_time;vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);vec4 posView=u_modelview*vec4(pos,1.0);vec3 directionView=normalize((u_modelview*vec4(directionWorld,0.0)).xyz);vec3 side=cross(directionView,normalize(posView.xyz));posView.xyz+=side*a_uv.x*u_rainDropletSize.x;posView.xyz+=directionView*a_uv.y*u_rainDropletSize.y;uv=a_uv;particleRandomValue=a_rainParticleData.x;gl_Position=u_projection*posView;}`),vignette:jn("uniform vec3 u_vignetteShape;uniform vec4 u_vignetteColor;in vec2 st;void main() {float screenDist=length(st);float alpha=clamp((screenDist-u_vignetteShape.x)/u_vignetteShape.y,0.0,1.0);alpha=pow(alpha,u_vignetteShape.z)*u_vignetteColor.a;vec3 color=u_vignetteColor.rgb;glFragColor=vec4(color*alpha,alpha) ;}","in vec2 a_pos_2f;out vec2 st;void main() {st=a_pos_2f;gl_Position=vec4(a_pos_2f,0,1);}"),occlusion:jn("uniform vec4 u_color;void main() {glFragColor=u_color;}",`#include "_prelude_terrain.vertex.glsl"
in highp vec2 a_offset_xy;uniform highp vec3 u_anchorPos;uniform mat4 u_matrix;uniform vec2 u_screenSizePx;uniform vec2 u_occluderSizePx;void main() {vec3 world_pos=u_anchorPos;
#ifdef TERRAIN
float e=elevation(world_pos.xy);world_pos.z+=e;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1.0);projected_point.xy+=projected_point.w*a_offset_xy*0.5*u_occluderSizePx/u_screenSizePx;gl_Position=projected_point;}`)};function Xc(b,c){const h=b.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let v of h)if(v=v.trim(),v[0]==="#"&&v.includes("if")&&!v.includes("endif")){v=v.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const N=v.split(" ");for(const A of N)c.includes(A)||c.push(A)}}function jn(b,c){const h=/#include\s+"([^"]+)"/g,v=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g;let N=c.match(/(attribute(\S*)|(^\s*|;)in) (highp |mediump |lowp )?([\w]+) ([\w]+)/gm);N&&(N=N.map(K=>{const Y=K.split(" ");return Y[Y.length-1]}),N=[...new Set(N)]);const A={},k=[],z=[];if(b=b.replace(h,(K,Y)=>(z.push(Y),"")),(c=c.replace(h,(K,Y)=>(k.push(Y),""))).includes("flat out"))return void console.error('The usage of "flat" qualifier is disallowed, see: https://bugs.webkit.org/show_bug.cgi?id=268071');let q=[...zu];Xc(b,q),Xc(c,q);for(const K of[...k,...z])Vh[K]||console.error(`Undefined include: ${K}`),of[K]||(of[K]=[],Xc(Vh[K],of[K])),q=[...q,...of[K]];return{fragmentSource:b=b.replace(v,(K,Y,ee,Q,ie)=>(A[ie]=!0,Y==="define"?`
#ifndef HAS_UNIFORM_u_${ie}
in ${ee} ${Q} ${ie};
#else
uniform ${ee} ${Q} u_${ie};
#endif
`:Y==="initialize"?`
#ifdef HAS_UNIFORM_u_${ie}
    ${ee} ${Q} ${ie} = u_${ie};
#endif
`:Y==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${ie}
    in ${ee} ${Q} ${ie};
#endif
`:Y==="initialize-attribute"?"":void 0)),vertexSource:c=c.replace(v,(K,Y,ee,Q,ie)=>{const de=Q==="float"?"vec2":Q,le=ie.match(/color/)?"color":de;return Y==="define-attribute-vertex-shader-only"?`
#ifdef HAS_ATTRIBUTE_a_${ie}
in ${ee} ${Q} a_${ie};
#endif
`:A[ie]?Y==="define"?`
#ifndef HAS_UNIFORM_u_${ie}
uniform lowp float u_${ie}_t;
in ${ee} ${de} a_${ie};
out ${ee} ${Q} ${ie};
#else
uniform ${ee} ${Q} u_${ie};
#endif
`:Y==="initialize"?le==="vec4"?`
#ifndef HAS_UNIFORM_u_${ie}
    ${ie} = a_${ie};
#else
    ${ee} ${Q} ${ie} = u_${ie};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ie}
    ${ie} = unpack_mix_${le}(a_${ie}, u_${ie}_t);
#else
    ${ee} ${Q} ${ie} = u_${ie};
#endif
`:Y==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${ie}
    in ${ee} ${Q} a_${ie};
    out ${ee} ${Q} ${ie};
#endif
`:Y==="initialize-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${ie}
    ${ie} = a_${ie};
#endif
`:void 0:Y==="define"?`
#ifndef HAS_UNIFORM_u_${ie}
uniform lowp float u_${ie}_t;
in ${ee} ${de} a_${ie};
#else
uniform ${ee} ${Q} u_${ie};
#endif
`:Y==="define-instanced"?le==="mat4"?`
#ifdef INSTANCED_ARRAYS
in vec4 a_${ie}0;
in vec4 a_${ie}1;
in vec4 a_${ie}2;
in vec4 a_${ie}3;
#else
uniform ${ee} ${Q} u_${ie};
#endif
`:`
#ifdef INSTANCED_ARRAYS
in ${ee} ${de} a_${ie};
#else
uniform ${ee} ${Q} u_${ie};
#endif
`:Y==="initialize-attribute-custom"?`
#ifdef HAS_ATTRIBUTE_a_${ie}
    ${ee} ${Q} ${ie} = a_${ie};
#endif
`:le==="vec4"?`
#ifndef HAS_UNIFORM_u_${ie}
    ${ee} ${Q} ${ie} = a_${ie};
#else
    ${ee} ${Q} ${ie} = u_${ie};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ie}
    ${ee} ${Q} ${ie} = unpack_mix_${le}(a_${ie}, u_${ie}_t);
#else
    ${ee} ${Q} ${ie} = u_${ie};
#endif
`}),staticAttributes:N,usedDefines:q,vertexIncludes:k,fragmentIncludes:z}}class zS{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(c,h,v,N,A,k,z,q){this.context=c;let K=this.boundPaintVertexBuffers.length!==N.length;for(let ee=0;!K&&ee<N.length;ee++)this.boundPaintVertexBuffers[ee]!==N[ee]&&(K=!0);let Y=this.boundDynamicVertexBuffers.length!==z.length;for(let ee=0;!Y&&ee<z.length;ee++)this.boundDynamicVertexBuffers[ee]!==z[ee]&&(Y=!0);if(!this.vao||this.boundProgram!==h||this.boundLayoutVertexBuffer!==v||K||Y||this.boundIndexBuffer!==A||this.boundVertexOffset!==k)this.freshBind(h,v,N,A,k,z,q);else{c.bindVertexArrayOES.set(this.vao);for(const ee of z)ee&&(ee.bind(),q&&ee.instanceCount&&ee.setVertexAttribDivisor(c.gl,h,q));A&&A.dynamicDraw&&A.bind()}}freshBind(c,h,v,N,A,k,z){const q=c.numAttributes,K=this.context,Y=K.gl;this.vao&&this.destroy(),this.vao=K.gl.createVertexArray(),K.bindVertexArrayOES.set(this.vao),this.boundProgram=c,this.boundLayoutVertexBuffer=h,this.boundPaintVertexBuffers=v,this.boundIndexBuffer=N,this.boundVertexOffset=A,this.boundDynamicVertexBuffers=k,h.enableAttributes(Y,c),h.bind(),h.setVertexAttribPointers(Y,c,A);for(const ee of v)ee.enableAttributes(Y,c),ee.bind(),ee.setVertexAttribPointers(Y,c,A);for(const ee of k)ee&&(ee.enableAttributes(Y,c),ee.bind(),ee.setVertexAttribPointers(Y,c,A),z&&ee.instanceCount&&ee.setVertexAttribDivisor(Y,c,z));N&&N.bind(),K.currentNumAttributes=q}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function LS(b,c){const h=Math.pow(2,c.canonical.z),v=c.canonical.y;return[new s.ac(0,v/h).toLngLat().lat,new s.ac(0,(v+1)/h).toLngLat().lat]}function lf(b,c,h,v,N,A,k){const z=b.context,q=z.gl,K=h.hillshadeFBO;if(!K)return;b.prepareDrawTile();const Y=b.isTileAffectedByFog(c),ee=b.getOrCreateProgram("hillshade",{overrideFog:Y});z.activeTexture.set(q.TEXTURE0),q.bindTexture(q.TEXTURE_2D,K.colorAttachment.get());const Q=((he,fe,Te,Re)=>{const Oe=Te.paint.get("hillshade-shadow-color"),$e=Te.paint.get("hillshade-shadow-color-use-theme").constantOr("default")==="none",Le=Te.paint.get("hillshade-highlight-color"),Fe=Te.paint.get("hillshade-highlight-color-use-theme").constantOr("default")==="none",Be=Te.paint.get("hillshade-accent-color"),He=Te.paint.get("hillshade-accent-color-use-theme").constantOr("default")==="none",Ke=Te.paint.get("hillshade-emissive-strength");let ft=s.ak(Te.paint.get("hillshade-illumination-direction"));if(Te.paint.get("hillshade-illumination-anchor")==="viewport")ft-=he.transform.angle;else if(he.style&&he.style.enable3dLights()&&he.style.directionalLight){const kt=he.style.directionalLight.properties.get("direction"),Pt=s.cc(kt.x,kt.y,kt.z);ft=s.ak(Pt[1])}const at=!he.options.moving;return{u_matrix:Re||he.transform.calculateProjMatrix(fe.tileID.toUnwrapped(),at),u_image:0,u_latrange:LS(0,fe.tileID),u_light:[Te.paint.get("hillshade-exaggeration"),ft],u_shadow:Oe.toRenderColor($e?null:Te.lut),u_highlight:Le.toRenderColor(Fe?null:Te.lut),u_emissive_strength:Ke,u_accent:Be.toRenderColor(He?null:Te.lut)}})(b,h,v,b.terrain?c.projMatrix:null);b.uploadCommonUniforms(z,ee,c.toUnwrapped());const{tileBoundsBuffer:ie,tileBoundsIndexBuffer:de,tileBoundsSegments:le}=b.getTileBoundsBuffers(h);ee.draw(b,q.TRIANGLES,N,A,k,Gr.disabled,Q,v.id,ie,de,le)}function i1(b,c,h){if(!c.needsDEMTextureUpload)return;const v=b.context,N=v.gl;v.pixelStoreUnpackPremultiplyAlpha.set(!1),c.demTexture=c.demTexture||b.getTileTexture(h.stride);const A=h.getPixels();c.demTexture?c.demTexture.update(A,{premultiply:!1}):c.demTexture=new s.T(v,A,N.R32F,{premultiply:!1}),c.needsDEMTextureUpload=!1}function Z3(b,c,h){const v=b.context,N=v.gl;if(!c.dem)return;const A=c.dem;if(v.activeTexture.set(N.TEXTURE1),i1(b,c,A),!c.demTexture)return;c.demTexture.bind(N.NEAREST,N.CLAMP_TO_EDGE);const k=A.dim;v.activeTexture.set(N.TEXTURE0);let z=c.hillshadeFBO;if(!z){const Q=new s.T(v,{width:k,height:k,data:null},N.RGBA8);Q.bind(N.LINEAR,N.CLAMP_TO_EDGE),z=c.hillshadeFBO=v.createFramebuffer(k,k,!0,"renderbuffer"),z.colorAttachment.set(Q.texture)}v.bindFramebuffer.set(z.framebuffer),v.viewport.set([0,0,k,k]);const{tileBoundsBuffer:q,tileBoundsIndexBuffer:K,tileBoundsSegments:Y}=b.getMercatorTileBoundsBuffers(),ee=[];b.linearFloatFilteringSupported()&&ee.push("TERRAIN_DEM_FLOAT_FORMAT"),b.getOrCreateProgram("hillshadePrepare",{defines:ee}).draw(b,N.TRIANGLES,Cr.disabled,Kr.disabled,mn.unblended,Gr.disabled,((Q,ie)=>{const de=ie.stride,le=s.ad.mat4.create();return s.ad.mat4.ortho(le,0,s.ai,-s.ai,0,0,1),s.ad.mat4.translate(le,le,[0,-s.ai,0]),{u_matrix:le,u_image:1,u_dimension:[de,de],u_zoom:Q.overscaledZ}})(c.tileID,A),h.id,q,K,Y),c.needsHillshadePrepare=!1}class Ai{constructor(c){this.gl=c.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(c){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Y3 extends Ai{getDefault(){return s.al.transparent}set(c){const h=this.current;(c.r!==h.r||c.g!==h.g||c.b!==h.b||c.a!==h.a||this.dirty)&&(this.gl.clearColor(c.r,c.g,c.b,c.a),this.current=c,this.dirty=!1)}}class s1 extends Ai{getDefault(){return 1}set(c){(c!==this.current||this.dirty)&&(this.gl.clearDepth(c),this.current=c,this.dirty=!1)}}class a1 extends Ai{getDefault(){return 0}set(c){(c!==this.current||this.dirty)&&(this.gl.clearStencil(c),this.current=c,this.dirty=!1)}}class o1 extends Ai{getDefault(){return[!0,!0,!0,!0]}set(c){const h=this.current;(c[0]!==h[0]||c[1]!==h[1]||c[2]!==h[2]||c[3]!==h[3]||this.dirty)&&(this.gl.colorMask(c[0],c[1],c[2],c[3]),this.current=c,this.dirty=!1)}}class l1 extends Ai{getDefault(){return!0}set(c){(c!==this.current||this.dirty)&&(this.gl.depthMask(c),this.current=c,this.dirty=!1)}}class FS extends Ai{getDefault(){return 255}set(c){(c!==this.current||this.dirty)&&(this.gl.stencilMask(c),this.current=c,this.dirty=!1)}}class BS extends Ai{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(c){const h=this.current;(c.func!==h.func||c.ref!==h.ref||c.mask!==h.mask||this.dirty)&&(this.gl.stencilFunc(c.func,c.ref,c.mask),this.current=c,this.dirty=!1)}}class X3 extends Ai{getDefault(){const c=this.gl;return[c.KEEP,c.KEEP,c.KEEP]}set(c){const h=this.current;(c[0]!==h[0]||c[1]!==h[1]||c[2]!==h[2]||this.dirty)&&(this.gl.stencilOp(c[0],c[1],c[2]),this.current=c,this.dirty=!1)}}class Mg extends Ai{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const h=this.gl;c?h.enable(h.STENCIL_TEST):h.disable(h.STENCIL_TEST),this.current=c,this.dirty=!1}}class Ig extends Ai{getDefault(){return[0,1]}set(c){const h=this.current;(c[0]!==h[0]||c[1]!==h[1]||this.dirty)&&(this.gl.depthRange(c[0],c[1]),this.current=c,this.dirty=!1)}}class $S extends Ai{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const h=this.gl;c?h.enable(h.DEPTH_TEST):h.disable(h.DEPTH_TEST),this.current=c,this.dirty=!1}}class ol extends Ai{getDefault(){return this.gl.LESS}set(c){(c!==this.current||this.dirty)&&(this.gl.depthFunc(c),this.current=c,this.dirty=!1)}}class c1 extends Ai{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const h=this.gl;c?h.enable(h.BLEND):h.disable(h.BLEND),this.current=c,this.dirty=!1}}class qx extends Ai{getDefault(){const c=this.gl;return[c.ONE,c.ZERO,c.ONE,c.ZERO]}set(c){const h=this.current;(c[0]!==h[0]||c[1]!==h[1]||c[2]!==h[2]||c[3]!==h[3]||this.dirty)&&(this.gl.blendFuncSeparate(c[0],c[1],c[2],c[3]),this.current=c,this.dirty=!1)}}class Wx extends Ai{getDefault(){return s.al.transparent}set(c){const h=this.current;(c.r!==h.r||c.g!==h.g||c.b!==h.b||c.a!==h.a||this.dirty)&&(this.gl.blendColor(c.r,c.g,c.b,c.a),this.current=c,this.dirty=!1)}}class u1 extends Ai{getDefault(){return this.gl.FUNC_ADD}set(c){(c!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(c,c),this.current=c,this.dirty=!1)}}class d1 extends Ai{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const h=this.gl;c?h.enable(h.CULL_FACE):h.disable(h.CULL_FACE),this.current=c,this.dirty=!1}}class h1 extends Ai{getDefault(){return this.gl.BACK}set(c){(c!==this.current||this.dirty)&&(this.gl.cullFace(c),this.current=c,this.dirty=!1)}}class Kx extends Ai{getDefault(){return this.gl.CCW}set(c){(c!==this.current||this.dirty)&&(this.gl.frontFace(c),this.current=c,this.dirty=!1)}}let m1=class extends Ai{getDefault(){return null}set(b){(b!==this.current||this.dirty)&&(this.gl.useProgram(b),this.current=b,this.dirty=!1)}};class f1 extends Ai{getDefault(){return this.gl.TEXTURE0}set(c){(c!==this.current||this.dirty)&&(this.gl.activeTexture(c),this.current=c,this.dirty=!1)}}class Zx extends Ai{getDefault(){const c=this.gl;return[0,0,c.drawingBufferWidth,c.drawingBufferHeight]}set(c){const h=this.current;(c[0]!==h[0]||c[1]!==h[1]||c[2]!==h[2]||c[3]!==h[3]||this.dirty)&&(this.gl.viewport(c[0],c[1],c[2],c[3]),this.current=c,this.dirty=!1)}}class VS extends Ai{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const h=this.gl;h.bindFramebuffer(h.FRAMEBUFFER,c),this.current=c,this.dirty=!1}}class US extends Ai{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const h=this.gl;h.bindRenderbuffer(h.RENDERBUFFER,c),this.current=c,this.dirty=!1}}class cf extends Ai{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const h=this.gl;h.bindTexture(h.TEXTURE_2D,c),this.current=c,this.dirty=!1}}class J3 extends Ai{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const h=this.gl;h.bindBuffer(h.ARRAY_BUFFER,c),this.current=c,this.dirty=!1}}class Q3 extends Ai{getDefault(){return null}set(c){const h=this.gl;h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,c),this.current=c,this.dirty=!1}}class e4 extends Ai{getDefault(){return null}set(c){this.gl&&(c!==this.current||this.dirty)&&(this.gl.bindVertexArray(c),this.current=c,this.dirty=!1)}}class t4 extends Ai{getDefault(){return 4}set(c){if(c===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_ALIGNMENT,c),this.current=c,this.dirty=!1}}class r4 extends Ai{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_PREMULTIPLY_ALPHA_WEBGL,c),this.current=c,this.dirty=!1}}class n4 extends Ai{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_FLIP_Y_WEBGL,c),this.current=c,this.dirty=!1}}class Og extends Ai{constructor(c,h){super(c),this.context=c,this.parent=h}getDefault(){return null}}class p1 extends Og{setDirty(){this.dirty=!0}set(c){if(c===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const h=this.gl;h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,c,0),this.current=c,this.dirty=!1}}class g1 extends Og{attachment(){return this.gl.DEPTH_ATTACHMENT}set(c){if(c===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const h=this.gl;h.framebufferRenderbuffer(h.FRAMEBUFFER,this.attachment(),h.RENDERBUFFER,c),this.current=c,this.dirty=!1}}class uf extends Og{attachment(){return this.gl.DEPTH_ATTACHMENT}set(c){if(c===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const h=this.gl;h.framebufferTexture2D(h.FRAMEBUFFER,this.attachment(),h.TEXTURE_2D,c,0),this.current=c,this.dirty=!1}}class GS extends g1{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}const HS=(b,c,h)=>({u_matrix:b,u_image0:0,u_skirt_height:c,u_ground_shadow_factor:h}),x1=(b,c,h,v,N,A,k,z,q,K,Y,ee,Q,ie,de,le)=>({u_proj_matrix:Float32Array.from(b),u_globe_matrix:c,u_normalize_matrix:Float32Array.from(v),u_merc_matrix:h,u_zoom_transition:N,u_merc_center:A,u_image0:0,u_frustum_tl:k,u_frustum_tr:z,u_frustum_br:q,u_frustum_bl:K,u_globe_pos:Y,u_globe_radius:ee,u_viewport:Q,u_grid_matrix:le?Float32Array.from(le):new Float32Array(9),u_skirt_height:ie,u_far_z_cutoff:de});function Yx(b,c){return b!=null&&c!=null&&!(!b.hasData()||!c.hasData())&&b.demTexture!=null&&c.demTexture!=null&&b.tileID.key!==c.tileID.key}const Ll=new class{constructor(){this.operations={}}newMorphing(b,c,h,v,N){if(b in this.operations){const A=this.operations[b];A.to.tileID.key!==h.tileID.key&&(A.queued=h)}else this.operations[b]={startTime:v,phase:0,duration:N,from:c,to:h,queued:null}}getMorphValuesForProxy(b){if(!(b in this.operations))return null;const c=this.operations[b];return{from:c.from,to:c.to,phase:c.phase}}update(b){for(const c in this.operations){const h=this.operations[c];for(h.phase=(b-h.startTime)/h.duration;h.phase>=1||!this._validOp(h);)if(!this._nextOp(h,b)){delete this.operations[c];break}}}_nextOp(b,c){return!!b.queued&&(b.from=b.to,b.to=b.queued,b.queued=null,b.phase=0,b.startTime=c,!0)}_validOp(b){return b.from.hasData()&&b.to.hasData()}},y1={0:null,1:"TERRAIN_VERTEX_MORPHING"};function Lu(b,c,h){if(c===0)return 0;const v=c<1&&h===514?.25/c:1;return 6*Math.pow(1.5,22-b)*Math.max(c,1)*v}function v1(b,c){const h=1<<b.z;return!c&&(b.x===0||b.x===h-1)||b.y===0||b.y===h-1}const df=b=>({u_matrix:b});function Xx(b,c,h,v,N){if(N>0){const A=s.q.now(),k=(A-b.timeAdded)/N,z=c?(A-c.timeAdded)/N:-1,q=h.getSource(),K=v.coveringZoomLevel({tileSize:q.tileSize,roundZoom:q.roundZoom}),Y=!c||Math.abs(c.tileID.overscaledZ-K)>Math.abs(b.tileID.overscaledZ-K),ee=Y&&b.refreshedUponExpiration?1:s.ay(Y?k:1-z,0,1);return b.refreshedUponExpiration&&k>=1&&(b.refreshedUponExpiration=!1),c?{opacity:1,mix:1-ee}:{opacity:ee,mix:0}}return{opacity:1,mix:0}}class qS extends Dl{constructor(c){const h={type:"raster-dem",maxzoom:c.transform.maxZoom},v=new s.D(s.cj(),null),N=qm("mock-dem",h,v,c.style);super("mock-dem",N,!1),N.setEventedParent(this),this._sourceLoaded=!0}_loadTile(c,h){c.state="loaded",h(null)}}class b1 extends Dl{constructor(c){const h=qm("proxy",{type:"geojson",maxzoom:c.transform.maxZoom},new s.D(s.cj(),null),c.style);super("proxy",h,!1),h.setEventedParent(this),this.map=this.getSource().map=c,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(c,h,v){if(c.freezeTileCoverage)return;this.transform=c;const N=c.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((A,k)=>{if(A[k.key]="",!this._tiles[k.key]){const z=new lc(k,this._source.tileSize*k.overscaleFactor(),c.tileZoom);z.state="loaded",this._tiles[k.key]=z}return A},{});for(const A in this._tiles)A in N||(this.freeFBO(A),this._tiles[A].unloadVectorData(),delete this._tiles[A])}freeFBO(c){const h=this.proxyCachedFBO[c];if(h!==void 0){const v=Object.values(h);this.renderCachePool.push(...v),delete this.proxyCachedFBO[c]}}deallocRenderCache(){this.renderCache.forEach(c=>c.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Jx extends s.aH{constructor(c,h,v){super(c.overscaledZ,c.wrap,c.canonical.z,c.canonical.x,c.canonical.y),this.proxyTileKey=h,this.projMatrix=v}}class WS extends s.cK{constructor(c,h){super(),this._debugParams={sortTilesHiZFirst:!0,disableRenderCache:!1},c.tp.registerParameter(this._debugParams,["Terrain"],"sortTilesHiZFirst",{},()=>{this._style.map.triggerRepaint()}),c.tp.registerParameter(this._debugParams,["Terrain"],"disableRenderCache",{},()=>{this._style.map.triggerRepaint()}),c.tp.registerButton(["Terrain"],"Invalidate Render Cache",()=>{this.invalidateRenderCache=!0,this._style.map.triggerRepaint()}),this.painter=c,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[v,N,A]=function(q){const K=new s.b5,Y=new s.aV,ee=131;K.reserve(17161),Y.reserve(33800);const Q=s.ai/128,ie=s.ai+Q/2,de=ie+Q;for(let he=-Q;he<de;he+=Q)for(let fe=-Q;fe<de;fe+=Q){const Te=fe<0||fe>ie||he<0||he>ie?24575:0,Re=s.ay(Math.round(fe),0,s.ai),Oe=s.ay(Math.round(he),0,s.ai);K.emplaceBack(Re+Te,Oe)}const le=(he,fe)=>{const Te=fe*ee+he;Y.emplaceBack(Te+1,Te,Te+ee),Y.emplaceBack(Te+ee,Te+ee+1,Te+1)};for(let he=1;he<129;he++)for(let fe=1;fe<129;fe++)le(fe,he);return[0,129].forEach(he=>{for(let fe=0;fe<130;fe++)le(fe,he),le(he,fe)}),[K,Y,32768]}(),k=c.context;this.gridBuffer=k.createVertexBuffer(v,s.b7.members),this.gridIndexBuffer=k.createIndexBuffer(N),this.gridSegments=s.b8.simpleSegment(0,0,v.length,N.length),this.gridNoSkirtSegments=s.b8.simpleSegment(0,0,v.length,A),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new b1(h.map),this.orthoMatrix=s.ad.mat4.create(),s.ad.mat4.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,s.ai,0,s.ai,0,1);const z=k.gl;this._overlapStencilMode=new Kr({func:z.GEQUAL,mask:255},0,255,z.KEEP,z.KEEP,z.REPLACE),this._previousZoom=c.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=h,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new qS(h.map),this._pendingGroundEffectLayers=[]}set style(c){c.on("data",this._onStyleDataEvent.bind(this)),this._style=c,this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(c,h,v){if(c&&c.terrain){this._style!==c&&(this.style=c,this._evaluationZoom=void 0);const N=c.terrain.properties,A=c.terrain.drapeRenderMode===0,k=c.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=s.q.now();const z=c.terrain&&c.terrain.scope,q=N.get("source"),K=A?this._mockSourceCache:c.getSourceCache(q,z);if(!K)return void s.w(`Couldn't find terrain source "${q}".`);if(this.sourceCache=K,this._attenuationRange=c.terrain.getAttenuationRange(),this._exaggeration=k?this.calculateExaggeration(h):N.get("exaggeration"),!h.projection.requiresDraping&&k&&this._exaggeration===0)return void this._disable();this.enabled=!0;const Y=()=>{this.sourceCache.used&&s.w(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const ee=this.getScaledDemTileSize();this.sourceCache.update(h,ee,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,Y(),this._initializing=!0),Y(),h.updateElevation(!0,v),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(h),this._emptyDEMTextureDirty=!0,this._previousZoom=h.zoom}else this._disable()}calculateExaggeration(c){if(this._attenuationRange&&c.zoom>=Math.ceil(this._attenuationRange[1]))return this._style.terrain.getExaggeration(c.zoom);const h=this._previousCameraAltitude,v=c.getFreeCameraOptions().position.z/c.pixelsPerMeter*c.worldSize;this._previousCameraAltitude=v;const N=h!=null?v-h:Number.MAX_VALUE;if(Math.abs(N)<2)return this._exaggeration;const A=c.zoom,k=this._style.terrain;if(!this._previousUpdateTimestamp)return k.getExaggeration(A);let z=A-this._previousZoom;const q=this._previousUpdateTimestamp;let K=A;this._evaluationZoom!=null&&(K=this._evaluationZoom,Math.abs(A-K)>.5&&(z=.5*(A-K+z)),z*N<0&&(K+=z)),this._evaluationZoom=K;const Y=k.getExaggeration(K),ee=Y===k.getExaggeration(Math.max(0,K-.1));if(ee&&Math.abs(Y-this._exaggeration)<.01)return Y;let Q=Math.min(.1,.00375*(this._updateTimestamp-q));return(ee||Y<.1||Math.abs(z)<1e-4)&&(Q=Math.min(.2,4*Q)),s.ah(this._exaggeration,Y,Q)}resetTileLookupCache(c){this._findCoveringTileCache[c]={}}attenuationRange(){return this._attenuationRange}getDemUpscale(){return this.proxySourceCache.getSource().tileSize/128}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(c){c.coord&&c.dataType==="source"?this._clearRenderCacheForTile(c.sourceCacheId,c.coord):c.dataType==="style"&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._emptyDEMTextureDirty=!0,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const c in this._style._mergedSourceCaches)this._style._mergedSourceCaches[c].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this.pool.forEach(c=>c.fb.destroy()),this.pool=[],this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this.enabled?this._exaggeration:0}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const c=2*this.proxySourceCache.getSource().tileSize;return[c,c]}set useVertexMorphing(c){this._useVertexMorphing=c}updateTileBinding(c){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const h=this.proxySourceCache,v=this.painter.transform;this._initializing&&(this._initializing=v._centerAltitude===0&&this.getAtPointOrZero(s.ac.fromLngLat(v.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const N=this.proxyCoords=h.getIds().map(q=>{const K=h.getTileByID(q).tileID;return K.projMatrix=v.calculateProjMatrix(K.toUnwrapped()),K});(function(q,K){const Y=K.transform.pointCoordinate(K.transform.getCameraPoint()),ee=new s.P(Y.x,Y.y);q.sort((Q,ie)=>{if(ie.overscaledZ-Q.overscaledZ)return ie.overscaledZ-Q.overscaledZ;const de=new s.P(Q.canonical.x+(1<<Q.canonical.z)*Q.wrap,Q.canonical.y),le=new s.P(ie.canonical.x+(1<<ie.canonical.z)*ie.wrap,ie.canonical.y),he=ee.mult(1<<Q.canonical.z);return he.x-=.5,he.y-=.5,he.distSqr(de)-he.distSqr(le)})})(N,this.painter);const A=this.proxyToSource||{};this.proxyToSource={},N.forEach(q=>{this.proxyToSource[q.key]={}}),this.terrainTileForTile={};const k=this._style._mergedSourceCaches;for(const q in k){const K=k[q];if(!K.used||(K!==this.sourceCache&&this.resetTileLookupCache(K.id),this._setupProxiedCoordsForOrtho(K,c[q],A),K.usedForTerrain))continue;const Y=c[q];K.getSource().reparseOverscaled&&this._assignTerrainTiles(Y)}this.proxiedCoords[h.id]=N.map(q=>new Jx(q,q.key,this.orthoMatrix)),this._assignTerrainTiles(N),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(A),this.renderingToTexture=!1;const z={};this._visibleDemTiles=[];for(const q of this.proxyCoords){const K=this.terrainTileForTile[q.key];if(!K)continue;const Y=K.tileID.key;Y in z||(this._visibleDemTiles.push(K),z[Y]=Y)}}_assignTerrainTiles(c){this._initializing||c.forEach(h=>{if(this.terrainTileForTile[h.key])return;const v=this._findTileCoveringTileID(h,this.sourceCache);v&&(this.terrainTileForTile[h.key]=v)})}_prepareDEMTextures(){const c=this.painter.context,h=c.gl;for(const v in this.terrainTileForTile){const N=this.terrainTileForTile[v],A=N.dem;!A||N.demTexture&&!N.needsDEMTextureUpload||(c.activeTexture.set(h.TEXTURE1),i1(this.painter,N,A))}}_prepareDemTileUniforms(c,h,v,N){if(!h||h.demTexture==null)return!1;const A=c.tileID.canonical,k=Math.pow(2,h.tileID.canonical.z-A.z),z=N||"";return v[`u_dem_tl${z}`]=[A.x*k%1,A.y*k%1],v[`u_dem_scale${z}`]=k,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}_getLoadedAreaMinimum(){if(!this.enabled)return 0;let c=0;const h=this._visibleDemTiles.reduce((v,N)=>{if(!N.dem)return v;const A=N.dem.tree.minimums[0];return A>0&&c++,v+A},0);return c?h/c:0}_updateEmptyDEMTexture(){const c=this.painter.context,h=c.gl;c.activeTexture.set(h.TEXTURE2);const v=this._getLoadedAreaMinimum(),N=new s.cL({width:1,height:1},new Float32Array([v]));this._emptyDEMTextureDirty=!1;let A=this._emptyDEMTexture;return A?A.update(N,{premultiply:!1}):A=this._emptyDEMTexture=new s.T(c,N,h.R32F,{premultiply:!1}),A}setupElevationDraw(c,h,v){const N=this.painter.context,A=N.gl,k={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0};k.u_exaggeration=this.exaggeration();let z=null,q=null,K=1;if(v&&v.morphing&&this._useVertexMorphing){const ie=v.morphing.srcDemTile,de=v.morphing.dstDemTile;K=v.morphing.phase,ie&&de&&(this._prepareDemTileUniforms(c,ie,k,"_prev")&&(q=ie),this._prepareDemTileUniforms(c,de,k)&&(z=de))}const Y=ie=>ie&&ie.demTexture&&this.painter.linearFloatFilteringSupported()?A.LINEAR:A.NEAREST;let ee=null;var Q;if(this.enabled?q&&z?(ee=z.demTexture,N.activeTexture.set(A.TEXTURE4),q.demTexture.bind(Y(q),A.CLAMP_TO_EDGE),k.u_dem_lerp=K):(z=this.terrainTileForTile[c.tileID.key],ee=this._prepareDemTileUniforms(c,z,k)?z.demTexture:this.emptyDEMTexture):ee=this.emptyDEMTexture,N.activeTexture.set(A.TEXTURE2),ee&&(k.u_dem_size=(Q=ee).size[0]===1?1:Q.size[0]-2,ee.bind(Y(z),A.CLAMP_TO_EDGE)),this.painter.setupDepthForOcclusion(v&&v.useDepthForOcclusion,h,k),v&&v.useMeterToDem&&z){const ie=(1<<z.tileID.canonical.z)*s.bH(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;k.u_meter_to_dem=ie}if(v&&v.labelPlaneMatrixInv&&(k.u_label_plane_matrix_inv=v.labelPlaneMatrixInv),h.setTerrainUniformValues(N,k),this.painter.transform.projection.name==="globe"){const ie=this.globeUniformValues(this.painter.transform,c.tileID.canonical,v&&v.useDenormalizedUpVectorScale);h.setGlobeUniformValues(N,ie)}}globeUniformValues(c,h,v){const N=c.projection;return{u_tile_tl_up:N.upVector(h,0,0),u_tile_tr_up:N.upVector(h,s.ai,0),u_tile_br_up:N.upVector(h,s.ai,s.ai),u_tile_bl_up:N.upVector(h,0,s.ai),u_tile_up_scale:v?s.cM(1):N.upVectorScale(h,c.center.lat,c.worldSize).metersToTile}}renderToBackBuffer(c){const h=this.painter,v=this.painter.context;c.length!==0&&(v.bindFramebuffer.set(null),v.viewport.set([0,0,h.width,h.height]),h.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(N,A,k,z,q){if(N.transform.projection.name==="globe")(function(K,Y,ee,Q,ie){const de=K.context,le=de.gl;let he,fe;const Te=K.transform,Re=s.cD(K,de,Te),Oe=(kt,Pt)=>{if(fe===Pt)return;const Bt=[y1[Pt],"PROJECTION_GLOBE_VIEW"];Re&&Bt.push("CUSTOM_ANTIALIASING");const st=K.isTileAffectedByFog(kt);he=K.getOrCreateProgram("globeRaster",{defines:Bt,overrideFog:st}),fe=Pt},$e=K.colorModeForRenderPass(),Le=new Cr(le.LEQUAL,Cr.ReadWrite,K.depthRangeFor3D);Ll.update(ie);const Fe=s.cE(Te),Be=[s.av(Te.center.lng),s.aC(Te.center.lat)],He=K.globeSharedBuffers,Ke=[Te.width*s.q.devicePixelRatio,Te.height*s.q.devicePixelRatio],ft=Float32Array.from(Te.globeMatrix),at={useDenormalizedUpVectorScale:!0};{const kt=K.transform,Pt=Lu(kt.zoom,Y.exaggeration(),Y.sourceCache._source.tileSize);fe=-1;const Bt=le.TRIANGLES;for(const st of Q){const At=ee.getTile(st),rt=Kr.disabled,Ct=Y.prevTerrainTileForTile[st.key],_t=Y.terrainTileForTile[st.key];Yx(Ct,_t)&&Ll.newMorphing(st.key,Ct,_t,ie,250),de.activeTexture.set(le.TEXTURE0),At.texture&&At.texture.bind(le.LINEAR,le.CLAMP_TO_EDGE);const Et=Ll.getMorphValuesForProxy(st.key),pt=Et?1:0;Et&&s.L(at,{morphing:{srcDemTile:Et.from,dstDemTile:Et.to,phase:s.cC(Et.phase)}});const It=s.cF(st.canonical),Kt=s.cG(It.getCenter().lat),Zt=s.cH(st.canonical,It,Kt,kt.worldSize/kt._pixelsPerMercatorPixel),Qt=s.bc(s.cI(st.canonical)),gr=x1(kt.expandedFarZProjMatrix,ft,Fe,Qt,s.ag(kt.zoom),Be,kt.frustumCorners.TL,kt.frustumCorners.TR,kt.frustumCorners.BR,kt.frustumCorners.BL,kt.globeCenterInViewSpace,kt.globeRadius,Ke,Pt,kt._farZ,Zt);if(Oe(st,pt),he&&(Y.setupElevationDraw(At,he,at),K.uploadCommonUniforms(de,he,st.toUnwrapped()),He)){const[qr,Er,Br]=He.getGridBuffers(Kt,Pt!==0);he.draw(K,Bt,Le,rt,$e,Gr.backCCW,gr,"globe_raster",qr,Er,Br)}}}if(He&&(K.renderDefaultNorthPole||K.renderDefaultSouthPole)){const kt=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];Re&&kt.push("CUSTOM_ANTIALIASING"),he=K.getOrCreateProgram("globeRaster",{defines:kt});for(const Pt of Q){const{x:Bt,y:st,z:At}=Pt.canonical,rt=st===0,Ct=st===(1<<At)-1,[_t,Et,pt,It]=He.getPoleBuffers(At,!1);if(It&&(rt||Ct)){const Kt=ee.getTile(Pt);de.activeTexture.set(le.TEXTURE0),Kt.texture&&Kt.texture.bind(le.LINEAR,le.CLAMP_TO_EDGE);let Zt=s.cJ(At,Bt,Te);const Qt=s.bc(s.cI(Pt.canonical)),gr=(qr,Er)=>qr.draw(K,le.TRIANGLES,Le,Kr.disabled,$e,Gr.disabled,x1(Te.expandedFarZProjMatrix,Zt,Zt,Qt,0,Be,Te.frustumCorners.TL,Te.frustumCorners.TR,Te.frustumCorners.BR,Te.frustumCorners.BL,Te.globeCenterInViewSpace,Te.globeRadius,Ke,0,Te._farZ),"globe_pole_raster",Er,pt,It);Y.setupElevationDraw(Kt,he,at),K.uploadCommonUniforms(de,he,Pt.toUnwrapped()),rt&&K.renderDefaultNorthPole&&gr(he,_t),Ct&&K.renderDefaultSouthPole&&(Zt=s.ad.mat4.scale(s.ad.mat4.create(),Zt,[1,-1,1]),gr(he,Et))}}}})(N,A,k,z,q);else{const K=N.context,Y=K.gl;let ee,Q;const ie=N.shadowRenderer,de=Ru(N,N.longestCutoffRange),le=$e=>{if(Q===$e)return;const Le=[];Le.push(y1[$e]),de.shouldRenderCutoff&&Le.push("RENDER_CUTOFF"),ie&&(Le.push("RENDER_SHADOWS","DEPTH_TEXTURE"),ie.useNormalOffset&&Le.push("NORMAL_OFFSET")),ee=N.getOrCreateProgram("terrainRaster",{defines:Le}),Q=$e},he=N.colorModeForRenderPass(),fe=new Cr(Y.LEQUAL,Cr.ReadWrite,N.depthRangeFor3D);Ll.update(q);const Te=N.transform,Re=Lu(Te.zoom,A.exaggeration(),A.sourceCache._source.tileSize);let Oe=[0,0,0];if(ie){const $e=N.style.directionalLight,Le=N.style.ambientLight;$e&&Le&&(Oe=nf(N.style,$e,Le))}{Q=-1;const $e=Y.TRIANGLES,[Le,Fe]=[A.gridIndexBuffer,A.gridSegments];for(const Be of z){const He=k.getTile(Be),Ke=Kr.disabled,ft=A.prevTerrainTileForTile[Be.key],at=A.terrainTileForTile[Be.key];Yx(ft,at)&&Ll.newMorphing(Be.key,ft,at,q,250),K.activeTexture.set(Y.TEXTURE0),He.texture&&He.texture.bind(Y.LINEAR,Y.CLAMP_TO_EDGE);const kt=Ll.getMorphValuesForProxy(Be.key),Pt=kt?1:0;let Bt;kt&&(Bt={morphing:{srcDemTile:kt.from,dstDemTile:kt.to,phase:s.cC(kt.phase)}});const st=HS(Be.projMatrix,v1(Be.canonical,Te.renderWorldCopies)?Re/10:Re,Oe);if(le(Pt),!ee)continue;A.setupElevationDraw(He,ee,Bt);const At=Be.toUnwrapped();ie&&ie.setupShadows(At,ee),N.uploadCommonUniforms(K,ee,At,null,de),ee.draw(N,$e,fe,Ke,he,Gr.backCCW,st,"terrain_raster",A.gridBuffer,Le,Fe)}}}}(h,this,this.proxySourceCache,c,this._updateTimestamp),this.renderingToTexture=!0,h.gpuTimingDeferredRenderEnd(),c.splice(0,c.length))}renderBatch(c){if(this._drapedRenderBatches.length===0)return c+1;this.renderingToTexture=!0;const h=this.painter,v=this.painter.context,N=this.proxySourceCache,A=this.proxiedCoords[N.id],k=this._drapedRenderBatches.shift(),z=h.style.order,q=[];let K=0;for(const Y of A){const ee=N.getTileByID(Y.proxyTileKey),Q=N.proxyCachedFBO[Y.key]?N.proxyCachedFBO[Y.key][c]:void 0,ie=Q!==void 0?N.renderCache[Q]:this.pool[K++],de=Q!==void 0;if(ee.texture=ie.tex,de&&!ie.dirty){q.push(ee.tileID);continue}let le;v.bindFramebuffer.set(ie.fb.framebuffer),this.renderedToTile=!1,ie.dirty&&(v.clear({color:s.al.transparent,stencil:0}),ie.dirty=!1);for(let he=k.start;he<=k.end;++he){const fe=h.style._mergedLayers[z[he]];if(fe.isHidden(h.transform.zoom))continue;const Te=h.style.getLayerSourceCache(fe),Re=Te?this.proxyToSource[Y.key][Te.id]:[Y];if(!Re)continue;const Oe=Re;v.viewport.set([0,0,ie.fb.width,ie.fb.height]),le!==(Te?Te.id:null)&&(this._setupStencil(ie,Re,fe,Te),le=Te?Te.id:null),h.renderLayer(h,Te,fe,Oe)}if(this._drapedRenderBatches.length===0)for(const he of this._pendingGroundEffectLayers){const fe=h.style._mergedLayers[z[he]];if(fe.isHidden(h.transform.zoom))continue;const Te=h.style.getLayerSourceCache(fe),Re=Te?this.proxyToSource[Y.key][Te.id]:[Y];if(!Re)continue;const Oe=Re;v.viewport.set([0,0,ie.fb.width,ie.fb.height]),le!==(Te?Te.id:null)&&(this._setupStencil(ie,Re,fe,Te),le=Te?Te.id:null),h.renderLayer(h,Te,fe,Oe)}this.renderedToTile?(ie.dirty=!0,q.push(ee.tileID)):de||--K,K===5&&(K=0,this.renderToBackBuffer(q))}return this.renderToBackBuffer(q),this.renderingToTexture=!1,v.bindFramebuffer.set(null),v.viewport.set([0,0,h.width,h.height]),k.end+1}postRender(){}isLayerOrderingCorrect(c){const h=c.order.length;let v=-1,N=h;for(let A=0;A<h;++A)this._style.isLayerDraped(c._mergedLayers[c.order[A]])?v=Math.max(v,A):N=Math.min(N,A);return N>v}getMinElevationBelowMSL(){let c=0;return this._visibleDemTiles.filter(h=>h.dem).forEach(h=>{c=Math.min(c,h.dem.tree.minimums[0])}),c===0?c:(c-30)*this._exaggeration}raycast(c,h,v){if(!this._visibleDemTiles)return null;const N=this._visibleDemTiles.filter(A=>A.dem).map(A=>{const k=A.tileID,z=1<<k.overscaledZ,{x:q,y:K}=k.canonical,Y=q/z,ee=(q+1)/z,Q=K/z,ie=(K+1)/z;return{minx:Y,miny:Q,maxx:ee,maxy:ie,t:A.dem.tree.raycastRoot(Y,Q,ee,ie,c,h,v),tile:A}});N.sort((A,k)=>(A.t!==null?A.t:Number.MAX_VALUE)-(k.t!==null?k.t:Number.MAX_VALUE));for(const A of N){if(A.t==null)return null;const k=A.tile.dem.tree.raycast(A.minx,A.miny,A.maxx,A.maxy,c,h,v);if(k!=null)return k}return null}_createFBO(){const c=this.painter.context,h=c.gl,v=this.drapeBufferSize;c.activeTexture.set(h.TEXTURE0);const N=new s.T(c,{width:v[0],height:v[1],data:null},h.RGBA8);N.bind(h.LINEAR,h.CLAMP_TO_EDGE);const A=c.createFramebuffer(v[0],v[1],!0,null);return A.colorAttachment.set(N.texture),A.depthAttachment=new GS(c,A.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=c.createRenderbuffer(c.gl.DEPTH_STENCIL,v[0],v[1]),this._stencilRef=0,A.depthAttachment.set(this._sharedDepthStencil),c.clear({stencil:0})):A.depthAttachment.set(this._sharedDepthStencil),c.extTextureFilterAnisotropic&&h.texParameterf(h.TEXTURE_2D,c.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,c.extTextureFilterAnisotropicMax),{fb:A,tex:N,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._debugParams.disableRenderCache||this._style.hasLightTransitions())return!0;for(const c in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[c].hasTransition())return!0;return this._style.order.some(c=>{const h=this._style._mergedLayers[c],v=h.isHidden(this.painter.transform.zoom);return h.type==="hillshade"||h.type==="custom"?!v&&h.shouldRedrape():!v&&h.hasTransition()})}_clearLineLayersFromRenderCache(){let c=!1;for(const v of this._style.getSources())if(v instanceof Pd){c=!0;break}if(!c)return;const h={};for(let v=0;v<this._style.order.length;++v){const N=this._style._mergedLayers[this._style.order[v]],A=this._style.getLayerSourceCache(N);if(A&&!h[A.id]&&!N.isHidden(this.painter.transform.zoom)&&N.type==="line"&&N.widthExpression()instanceof s.ab){h[A.id]=!0;for(const k of this.proxyCoords){const z=this.proxyToSource[k.key][A.id];if(z)for(const q of z)this._clearRenderCacheForTile(A.id,q)}}}}_clearRasterLayersFromRenderCache(){let c=!1;for(const v in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[v]._source instanceof Oo){c=!0;break}if(!c)return;const h={};for(let v=0;v<this._style.order.length;++v){const N=this._style._mergedLayers[this._style.order[v]],A=this._style.getLayerSourceCache(N);if(!A||h[A.id]||N.isHidden(this.painter.transform.zoom)||N.type!=="raster")continue;const k=N.paint.get("raster-fade-duration");for(const z of this.proxyCoords){const q=this.proxyToSource[z.key][A.id];if(q)for(const K of q){const Y=Xx(A.getTile(K),A.findLoadedParent(K,0),A,this.painter.transform,k);(Y.opacity!==1||Y.mix!==0)&&this._clearRenderCacheForTile(A.id,K)}}}}_setupDrapedRenderBatches(){this._style.updateDrapeFirstLayers();const c=this._style.order,h=c.length;if(h===0)return;const v=[];this._pendingGroundEffectLayers=[];let N,A=0,k=this._style._mergedLayers[c[A]];for(;!this._style.isLayerDraped(k)&&k.isHidden(this.painter.transform.zoom)&&++A<h;)k=this._style._mergedLayers[c[A]];for(;A<h;++A){const z=this._style._mergedLayers[c[A]];z.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(z)?N===void 0&&(N=A):(z.type==="fill-extrusion"&&this._pendingGroundEffectLayers.push(A),N!==void 0&&(v.push({start:N,end:A-1}),N=void 0)))}if(N!==void 0&&v.push({start:N,end:A-1}),v.length!==0){const z=v[v.length-1];this._pendingGroundEffectLayers.every(q=>q>z.end)||s.w("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=v}_setupRenderCache(c){const h=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,h.renderCache.length>h.renderCachePool.length){const k=Object.values(h.proxyCachedFBO);h.proxyCachedFBO={};for(let z=0;z<k.length;++z){const q=Object.values(k[z]);h.renderCachePool.push(...q)}}return}this._clearRasterLayersFromRenderCache();const v=this.proxyCoords,N=this._tilesDirty;for(let k=v.length-1;k>=0;k--){const z=v[k];if(h.getTileByID(z.key),h.proxyCachedFBO[z.key]!==void 0){const q=c[z.key],K=this.proxyToSource[z.key];let Y=0;for(const ee in K){const Q=K[ee],ie=q[ee];if(!ie||ie.length!==Q.length||Q.some((de,le)=>de!==ie[le]||N[ee]&&N[ee].hasOwnProperty(de.key))){Y=-1;break}++Y}for(const ee in h.proxyCachedFBO[z.key])h.renderCache[h.proxyCachedFBO[z.key][ee]].dirty=Y<0||Y!==Object.values(q).length}}const A=[...this._drapedRenderBatches];A.sort((k,z)=>z.end-z.start-(k.end-k.start));for(const k of A)for(const z of v){if(h.proxyCachedFBO[z.key])continue;let q=h.renderCachePool.pop();q===void 0&&h.renderCache.length<50&&(q=h.renderCache.length,h.renderCache.push(this._createFBO())),q!==void 0&&(h.proxyCachedFBO[z.key]={},h.proxyCachedFBO[z.key][k.start]=q,h.renderCache[q].dirty=!0)}this._tilesDirty={}}_setupStencil(c,h,v,N){if(!N||!this._sourceTilesOverlap[N.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const A=this.painter.context,k=A.gl;if(h.length<=1)return void(this._overlapStencilType=!1);let z;if(v.isTileClipped())z=h.length,this._overlapStencilMode.test={func:k.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(h[0].overscaledZ>h[h.length-1].overscaledZ))return void(this._overlapStencilType=!1);z=1,this._overlapStencilMode.test={func:k.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+z>255&&(A.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=z,this._overlapStencilMode.ref=this._stencilRef,v.isTileClipped()&&this._renderTileClippingMasks(h,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(c){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[c.key]),this._overlapStencilMode):Kr.disabled}_renderTileClippingMasks(c,h){const v=this.painter,N=this.painter.context,A=N.gl;v._tileClippingMaskIDs={},N.setColorMode(mn.disabled),N.setDepthMode(Cr.disabled);const k=v.getOrCreateProgram("clippingMask");for(const z of c){const q=v._tileClippingMaskIDs[z.key]=--h;k.draw(v,A.TRIANGLES,Cr.disabled,new Kr({func:A.ALWAYS,mask:0},q,255,A.KEEP,A.KEEP,A.REPLACE),mn.disabled,Gr.disabled,df(z.projMatrix),"$clipping",v.tileExtentBuffer,v.quadTriangleIndexBuffer,v.tileExtentSegments)}}pointCoordinate(c){const h=this.painter.transform;if(c.x<0||c.x>h.width||c.y<0||c.y>h.height)return null;const v=[c.x,c.y,1,1];s.ad.vec4.transformMat4(v,v,h.pixelMatrixInverse),s.ad.vec4.scale(v,v,1/v[3]),v[0]/=h.worldSize,v[1]/=h.worldSize;const N=h._camera.position,A=s.bH(1,h.center.lat),k=[N[0],N[1],N[2]/A,0],z=s.ad.vec3.subtract([],v.slice(0,3),k);s.ad.vec3.normalize(z,z);const q=this.raycast(k,z,this._exaggeration);return q!==null&&q?(s.ad.vec3.scaleAndAdd(k,k,z,q),k[3]=k[2],k[2]*=A,k):null}_setupProxiedCoordsForOrtho(c,h,v){if(c.getSource()instanceof s.aK)return this._setupProxiedCoordsForImageSource(c,h,v);this._findCoveringTileCache[c.id]=this._findCoveringTileCache[c.id]||{};const N=this.proxiedCoords[c.id]=[],A=this.proxyCoords;for(let q=0;q<A.length;q++){const K=A[q],Y=this._findTileCoveringTileID(K,c);if(Y){const ee=this._createProxiedId(K,Y,v[K.key]&&v[K.key][c.id]);N.push(ee),this.proxyToSource[K.key][c.id]=[ee]}}let k=!1;const z=new Set;for(let q=0;q<h.length;q++){const K=c.getTile(h[q]);if(!K||!K.hasData())continue;const Y=this._findTileCoveringTileID(K.tileID,this.proxySourceCache);if(Y&&Y.tileID.canonical.z!==K.tileID.canonical.z){const ee=this.proxyToSource[Y.tileID.key][c.id],Q=this._createProxiedId(Y.tileID,K,v[Y.tileID.key]&&v[Y.tileID.key][c.id]);ee?ee.splice(ee.length-1,0,Q):this.proxyToSource[Y.tileID.key][c.id]=[Q];const ie=this.proxyToSource[Y.tileID.key][c.id];z.has(ie)||z.add(ie),N.push(Q),k=!0}}if(this._sourceTilesOverlap[c.id]=k,k&&this._debugParams.sortTilesHiZFirst)for(const q of z)q.sort((K,Y)=>Y.overscaledZ-K.overscaledZ)}_setupProxiedCoordsForImageSource(c,h,v){if(!c.getSource().loaded())return;const N=this.proxiedCoords[c.id]=[],A=this.proxyCoords,k=c.getSource(),z=k.tileID;if(!z)return;const q=new s.P(z.x,z.y)._div(1<<z.z),K=k.coordinates.map(s.ac.fromLngLat).reduce((ee,Q)=>(ee.min.x=Math.min(ee.min.x,Q.x-q.x),ee.min.y=Math.min(ee.min.y,Q.y-q.y),ee.max.x=Math.max(ee.max.x,Q.x-q.x),ee.max.y=Math.max(ee.max.y,Q.y-q.y),ee),{min:new s.P(Number.MAX_VALUE,Number.MAX_VALUE),max:new s.P(-Number.MAX_VALUE,-Number.MAX_VALUE)}),Y=(ee,Q)=>{const ie=ee.wrap+ee.canonical.x/(1<<ee.canonical.z),de=ee.canonical.y/(1<<ee.canonical.z),le=s.ai/(1<<ee.canonical.z),he=Q.wrap+Q.canonical.x/(1<<Q.canonical.z),fe=Q.canonical.y/(1<<Q.canonical.z);return ie+le<he+K.min.x||ie>he+K.max.x||de+le<fe+K.min.y||de>fe+K.max.y};for(let ee=0;ee<A.length;ee++){const Q=A[ee];for(let ie=0;ie<h.length;ie++){const de=c.getTile(h[ie]);if(!de||!de.hasData()||Y(Q,de.tileID))continue;const le=this._createProxiedId(Q,de,v[Q.key]&&v[Q.key][c.id]),he=this.proxyToSource[Q.key][c.id];he?he.push(le):this.proxyToSource[Q.key][c.id]=[le],N.push(le)}}}_createProxiedId(c,h,v){let N=this.orthoMatrix;if(v){const A=v.find(k=>k.key===h.tileID.key);if(A)return A}if(h.tileID.key!==c.key){const A=c.canonical.z-h.tileID.canonical.z;let k,z,q;N=s.ad.mat4.create();const K=h.tileID.wrap-c.wrap<<c.overscaledZ;A>0?(k=s.ai>>A,z=k*((h.tileID.canonical.x<<A)-c.canonical.x+K),q=k*((h.tileID.canonical.y<<A)-c.canonical.y)):(k=s.ai<<-A,z=s.ai*(h.tileID.canonical.x-(c.canonical.x+K<<-A)),q=s.ai*(h.tileID.canonical.y-(c.canonical.y<<-A))),s.ad.mat4.ortho(N,0,k,0,k,0,1),s.ad.mat4.translate(N,N,[z,q,0])}return new Jx(h.tileID,c.key,N)}_findTileCoveringTileID(c,h){let v=h.getTile(c);if(v&&v.hasData())return v;const N=this._findCoveringTileCache[h.id],A=N[c.key];if(v=A?h.getTileByID(A):null,v&&v.hasData()||A===null)return v;let k=v?v.tileID:c,z=k.overscaledZ;const q=h.getSource().minzoom,K=[];if(!A){const ee=h.getSource().maxzoom;if(c.canonical.z>=ee){const Q=c.canonical.z-ee;h.getSource().reparseOverscaled?(z=Math.max(c.canonical.z+2,h.transform.tileZoom),k=new s.aH(z,c.wrap,ee,c.canonical.x>>Q,c.canonical.y>>Q)):Q!==0&&(z=ee,k=new s.aH(z,c.wrap,ee,c.canonical.x>>Q,c.canonical.y>>Q))}k.key!==c.key&&(K.push(k.key),v=h.getTile(k))}const Y=ee=>{K.forEach(Q=>{N[Q]=ee}),K.length=0};for(z-=1;z>=q&&(!v||!v.hasData());z--){v&&Y(v.tileID.key);const ee=k.calculateScaledKey(z);if(v=h.getTileByID(ee),v&&v.hasData())break;const Q=N[ee];if(Q===null)break;Q===void 0?K.push(ee):v=h.getTileByID(Q)}return Y(v?v.tileID.key:null),v&&v.hasData()?v:null}findDEMTileFor(c){return this.enabled?this._findTileCoveringTileID(c,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(c,h){let v=this._tilesDirty[c];v||(v=this._tilesDirty[c]={}),v[h.key]=!0}}function KS(b,c,h){const v=function(z,q,K){const Y=s.ad.vec3.dot(q,z),ee=s.ad.vec3.dot(K,[.2126,.7152,.0722]),Q=(de,le,he)=>(1-he)*de+he*le,ie=Q(1-.3*Math.min(ee,1),1,Math.min(Y+1,1));return Q(.92,1,Math.asin(s.ay(q[2],-1,1))/Math.PI+.5)*ie}(b,[0,0,1],c),N=[0,0,0];s.ad.vec3.scale(N,h.slice(0,3),v);const A=[0,0,0];s.ad.vec3.scale(A,c.slice(0,3),b[2]);const k=[0,0,0];return s.ad.vec3.add(k,N,A),s.cg(k)}const Rg=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],i4=["stars","rainParticle","snowParticle","fillExtrusion","fillExtrusionGroundEffect","elevatedStructures","model","symbol"];class ZS{static cacheKey(c,h,v,N){let A=`${h}${N?N.cacheKey:""}`;for(const k of v)c.usedDefines.includes(k)&&(A+=`/${k}`);return A}constructor(c,h,v,N,A,k){const z=c.gl;this.program=z.createProgram(),this.configuration=N,this.name=h,this.fixedDefines=[...k];const q=N?N.getBinderAttributes():[],K=(v.staticAttributes||[]).concat(q);let Y=N?N.defines():[];Y=Y.concat(k.map(he=>`#define ${he}`));const ee=`#version 300 es
`;let Q=ee+Y.concat("precision mediump float;",Hx,n1.fragmentSource).join(`
`);for(const he of v.fragmentIncludes)Q+=`
${Vh[he]}`;Q+=`
${v.fragmentSource}`;let ie=ee+Y.concat("precision highp float;",Hx,n1.vertexSource).join(`
`);for(const he of v.vertexIncludes)ie+=`
${Vh[he]}`;this.forceManualRenderingForInstanceIDShaders=c.forceManualRenderingForInstanceIDShaders&&v.vertexSource.indexOf("gl_InstanceID")!==-1,this.forceManualRenderingForInstanceIDShaders&&(ie+=`
uniform int u_instanceID;
`),ie+=`
${v.vertexSource}`,this.forceManualRenderingForInstanceIDShaders&&(ie=ie.replaceAll("gl_InstanceID","u_instanceID"));const de=z.createShader(z.FRAGMENT_SHADER);if(z.isContextLost())return void(this.failedToCreate=!0);z.shaderSource(de,Q),z.compileShader(de),z.attachShader(this.program,de);const le=z.createShader(z.VERTEX_SHADER);if(z.isContextLost())this.failedToCreate=!0;else{z.shaderSource(le,ie),z.compileShader(le),z.attachShader(this.program,le),this.attributes={},this.numAttributes=K.length;for(let he=0;he<this.numAttributes;he++)if(K[he]){const fe=K[he].startsWith("a_")?K[he]:`a_${K[he]}`;z.bindAttribLocation(this.program,he,fe),this.attributes[fe]=he}z.linkProgram(this.program),z.deleteShader(le),z.deleteShader(de),this.fixedUniforms=A(c),this.binderUniforms=N?N.getUniforms(c):[],this.forceManualRenderingForInstanceIDShaders&&(this.instancingUniforms=(he=>({u_instanceID:new s.bN(he)}))(c)),(k.includes("TERRAIN")||h.indexOf("symbol")!==-1||h.indexOf("circle")!==-1)&&(this.terrainUniforms=(he=>({u_dem:new s.bN(he),u_dem_prev:new s.bN(he),u_dem_tl:new s.bK(he),u_dem_scale:new s.bM(he),u_dem_tl_prev:new s.bK(he),u_dem_scale_prev:new s.bM(he),u_dem_size:new s.bM(he),u_dem_lerp:new s.bM(he),u_exaggeration:new s.bM(he),u_depth:new s.bN(he),u_depth_size_inv:new s.bK(he),u_depth_range_unpack:new s.bK(he),u_occluder_half_size:new s.bM(he),u_occlusion_depth_offset:new s.bM(he),u_meter_to_dem:new s.bM(he),u_label_plane_matrix_inv:new s.bJ(he)}))(c)),k.includes("GLOBE")&&(this.globeUniforms=(he=>({u_tile_tl_up:new s.bL(he),u_tile_tr_up:new s.bL(he),u_tile_br_up:new s.bL(he),u_tile_bl_up:new s.bL(he),u_tile_up_scale:new s.bM(he)}))(c)),k.includes("FOG")&&(this.fogUniforms=(he=>({u_fog_matrix:new s.bJ(he),u_fog_range:new s.bK(he),u_fog_color:new s.cb(he),u_fog_horizon_blend:new s.bM(he),u_fog_vertical_limit:new s.bK(he),u_fog_temporal_offset:new s.bM(he),u_frustum_tl:new s.bL(he),u_frustum_tr:new s.bL(he),u_frustum_br:new s.bL(he),u_frustum_bl:new s.bL(he),u_globe_pos:new s.bL(he),u_globe_radius:new s.bM(he),u_globe_transition:new s.bM(he),u_is_globe:new s.bN(he),u_viewport:new s.bK(he)}))(c)),k.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(he=>({u_cutoff_params:new s.cb(he)}))(c)),k.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(he=>({u_lighting_ambient_color:new s.bL(he),u_lighting_directional_dir:new s.bL(he),u_lighting_directional_color:new s.bL(he),u_ground_radiance:new s.bL(he)}))(c)),k.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(he=>({u_light_matrix_0:new s.bJ(he),u_light_matrix_1:new s.bJ(he),u_fade_range:new s.bK(he),u_shadow_normal_offset:new s.bL(he),u_shadow_intensity:new s.bM(he),u_shadow_texel_size:new s.bM(he),u_shadow_map_resolution:new s.bM(he),u_shadow_direction:new s.bL(he),u_shadow_bias:new s.bL(he),u_shadowmap_0:new s.bN(he),u_shadowmap_1:new s.bN(he)}))(c))}}setTerrainUniformValues(c,h){if(!this.terrainUniforms)return;const v=this.terrainUniforms;if(!this.failedToCreate){c.program.set(this.program);for(const N in h)v[N]&&v[N].set(this.program,N,h[N])}}setGlobeUniformValues(c,h){if(!this.globeUniforms)return;const v=this.globeUniforms;if(!this.failedToCreate){c.program.set(this.program);for(const N in h)v[N]&&v[N].set(this.program,N,h[N])}}setFogUniformValues(c,h){if(!this.fogUniforms)return;const v=this.fogUniforms;if(!this.failedToCreate){c.program.set(this.program);for(const N in h)v[N].set(this.program,N,h[N])}}setCutoffUniformValues(c,h){if(!this.cutoffUniforms)return;const v=this.cutoffUniforms;if(!this.failedToCreate){c.program.set(this.program);for(const N in h)v[N].set(this.program,N,h[N])}}setLightsUniformValues(c,h){if(!this.lightsUniforms)return;const v=this.lightsUniforms;if(!this.failedToCreate){c.program.set(this.program);for(const N in h)v[N].set(this.program,N,h[N])}}setShadowUniformValues(c,h){if(this.failedToCreate||!this.shadowUniforms)return;const v=this.shadowUniforms;c.program.set(this.program);for(const N in h)v[N].set(this.program,N,h[N])}_drawDebugWireframe(c,h,v,N,A,k,z,q,K,Y){const ee=c.options.wireframe;if(ee.terrain===!1&&ee.layers2D===!1&&ee.layers3D===!1)return;const Q=c.context;if(!(!(!ee.terrain||this.name!=="terrainRaster"&&this.name!=="globeRaster")||!(!ee.layers2D||c._terrain&&c._terrain.renderingToTexture||!Rg.includes(this.name))||!(!ee.layers3D||!i4.includes(this.name))))return;const ie=Q.gl,de=c.wireframeDebugCache.getLinesFromTrianglesBuffer(c.frameCounter,A,Q);if(!de)return;const le=[...this.fixedDefines];le.push("DEBUG_WIREFRAME");const he=c.getOrCreateProgram(this.name,{config:this.configuration,defines:le});Q.program.set(he.program);const fe=(Oe,$e,Le)=>{if($e[Oe]&&Le[Oe])for(const Fe in $e[Oe])Le[Oe][Fe]&&Le[Oe][Fe].set(Le.program,Fe,$e[Oe][Fe].current)};K&&K.setUniforms(he.program,Q,he.binderUniforms,z,{zoom:q}),fe("fixedUniforms",this,he),fe("terrainUniforms",this,he),fe("globeUniforms",this,he),fe("fogUniforms",this,he),fe("lightsUniforms",this,he),fe("shadowUniforms",this,he),de.bind(),Q.setColorMode(new mn([ie.ONE,ie.ONE_MINUS_SRC_ALPHA,ie.ZERO,ie.ONE],s.al.transparent,[!0,!0,!0,!1])),Q.setDepthMode(new Cr(h.func===ie.LESS?ie.LEQUAL:h.func,Cr.ReadOnly,h.range)),Q.setStencilMode(Kr.disabled);const Te=3*k.primitiveLength*2,Re=3*k.primitiveOffset*2*2;if(this.forceManualRenderingForInstanceIDShaders){const Oe=Y||1;for(let $e=0;$e<Oe;++$e)he.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",$e),ie.drawElements(ie.LINES,Te,ie.UNSIGNED_SHORT,Re)}else Y&&Y>1?ie.drawElementsInstanced(ie.LINES,Te,ie.UNSIGNED_SHORT,Re,Y):ie.drawElements(ie.LINES,Te,ie.UNSIGNED_SHORT,Re);A.bind(),Q.program.set(this.program),Q.setDepthMode(h),Q.setStencilMode(v),Q.setColorMode(N)}checkUniforms(c,h,v){if(this.fixedDefines.includes(h)){for(const N of Object.keys(v))if(!v[N].initialized)throw new Error(`Program '${this.name}', from draw '${c}': uniform ${N} not set but required by ${h} being defined`)}}draw(c,h,v,N,A,k,z,q,K,Y,ee,Q,ie,de,le,he){const fe=c.context,Te=fe.gl;if(this.failedToCreate)return;fe.program.set(this.program),fe.setDepthMode(v),fe.setStencilMode(N),fe.setColorMode(A),fe.setCullFace(k);for(const $e of Object.keys(this.fixedUniforms))this.fixedUniforms[$e].set(this.program,$e,z[$e]);de&&de.setUniforms(this.program,fe,this.binderUniforms,Q,{zoom:ie});const Re={[Te.POINTS]:1,[Te.LINES]:2,[Te.TRIANGLES]:3,[Te.LINE_STRIP]:1}[h];this.checkUniforms(q,"RENDER_SHADOWS",this.shadowUniforms);const Oe=he&&he>0?1:void 0;for(const $e of ee.get()){const Le=$e.vaos||($e.vaos={});if((Le[q]||(Le[q]=new zS)).bind(fe,this,K,de?de.getPaintVertexBuffers():[],Y,$e.vertexOffset,le||[],Oe),this.forceManualRenderingForInstanceIDShaders){const Fe=he||1;for(let Be=0;Be<Fe;++Be)this.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",Be),Y?Te.drawElements(h,$e.primitiveLength*Re,Te.UNSIGNED_SHORT,$e.primitiveOffset*Re*2):Te.drawArrays(h,$e.vertexOffset,$e.vertexLength)}else he&&he>1?Te.drawElementsInstanced(h,$e.primitiveLength*Re,Te.UNSIGNED_SHORT,$e.primitiveOffset*Re*2,he):Y?Te.drawElements(h,$e.primitiveLength*Re,Te.UNSIGNED_SHORT,$e.primitiveOffset*Re*2):Te.drawArrays(h,$e.vertexOffset,$e.vertexLength);h===Te.TRIANGLES&&Y&&this._drawDebugWireframe(c,v,N,A,Y,$e,Q,ie,de,he)}}}function _1(b,c){const h=Math.pow(2,c.tileID.overscaledZ),v=c.tileSize*Math.pow(2,b.transform.tileZoom)/h,N=v*(c.tileID.canonical.x+c.tileID.wrap*h),A=v*c.tileID.canonical.y;return{u_image:0,u_texsize:c.imageAtlasTexture?c.imageAtlasTexture.size:[0,0],u_tile_units_to_pixels:1/s.at(c,1,b.transform.tileZoom),u_pixel_coord_upper:[N>>16,A>>16],u_pixel_coord_lower:[65535&N,65535&A]}}const Qx={terrain:0,flat:1},w1=s.ad.mat4.create(),ey=(b,c,h,v,N,A,k,z,q,K,Y,ee,Q,ie,de,le,he,fe)=>{const Te=c.style.light,Re=Te.properties.get("position"),Oe=[Re.x,Re.y,Re.z],$e=s.ad.mat3.create();Te.properties.get("anchor")==="viewport"&&(s.ad.mat3.fromRotation($e,-c.transform.angle),s.ad.vec3.transformMat3(Oe,Oe,$e));const Le=Te.properties.get("color"),Fe=c.transform,Be={u_matrix:b,u_lightpos:Oe,u_lightintensity:Te.properties.get("intensity"),u_lightcolor:[Le.r,Le.g,Le.b],u_vertical_gradient:+h,u_opacity:v,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:w1,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_height_type:Qx[K],u_base_type:Qx[Y],u_ao:N,u_edge_radius:A,u_width_scale:k,u_flood_light_color:de,u_vertical_scale:le,u_flood_light_intensity:he,u_ground_shadow_factor:fe};return Fe.projection.name==="globe"&&(Be.u_tile_id=[z.canonical.x,z.canonical.y,1<<z.canonical.z],Be.u_zoom_transition=ee,Be.u_inv_rot_matrix=ie,Be.u_merc_center=Q,Be.u_up_dir=Fe.projection.upVector(new s.bT(0,0,0),Q[0]*s.ai,Q[1]*s.ai),Be.u_height_lift=q),Be},hf=(b,c,h,v,N,A)=>({u_matrix:b,u_edge_radius:c,u_width_scale:h,u_vertical_scale:v,u_height_type:Qx[N],u_base_type:Qx[A]}),j1=(b,c,h,v,N,A,k,z,q,K,Y,ee,Q,ie,de,le,he)=>{const fe=ey(b,c,h,v,N,A,k,z,K,Y,ee,Q,ie,de,le,he,1,[0,0,0]),Te={u_height_factor:-Math.pow(2,z.overscaledZ)/q.tileSize/8};return s.l(fe,_1(c,q),Te)},mf=(b,c)=>({u_matrix:b,u_emissive_strength:c}),N1=(b,c,h,v)=>s.l(mf(b,c),_1(h,v)),ty=(b,c,h)=>({u_matrix:b,u_world:h,u_emissive_strength:c}),ry=(b,c,h,v,N)=>s.l(N1(b,c,h,v),{u_world:N}),Dg=(b,c,h,v,N)=>({u_matrix:b,u_camera_pos:[c[0],c[1],c[2]],u_depth_bias:h,u_height_scale:v,u_reset_depth:N}),YS=(b,c,h,v)=>{const N=s.ai/h.tileSize;return{u_matrix:b,u_camera_to_center_distance:c.getCameraToCenterDistance(v),u_extrude_scale:[c.pixelsToGLUnits[0]/N,c.pixelsToGLUnits[1]/N]}},XS=(b,c,h=1)=>({u_matrix:b,u_color:c.toRenderColor(null),u_overlay:0,u_overlay_scale:h}),ff=s.ad.mat4.create(),ny=(b,c,h,v,N,A,k)=>{const z=b.transform,q=z.projection.name==="globe",K=q?s.cO(z.zoom,c.canonical)*z._pixelsPerMercatorPixel:s.at(h,1,A),Y={u_matrix:c.projMatrix,u_extrude_scale:K,u_intensity:k,u_inv_rot_matrix:ff,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(q){Y.u_inv_rot_matrix=v,Y.u_merc_center=N,Y.u_tile_id=[c.canonical.x,c.canonical.y,1<<c.canonical.z],Y.u_zoom_transition=s.ag(z.zoom);const ee=N[0]*s.ai,Q=N[1]*s.ai;Y.u_up_dir=z.projection.upVector(new s.bT(0,0,0),ee,Q)}return Y};function lr(b,[c,h,v,N],[A,k]){if(A===k)return[0,0,0,0];const z=255*(b-1)/(b*(k-A));return[c*z,h*z,v*z,N*z]}function S1(b,c,[h,v]){return h===v?0:.5/b+(c-h)*(b-1)/(b*(v-h))}const C1=(b,c,h,v,N,A,k,z,q,K,Y,ee,Q,ie,de,le,he,fe,Te,Re,Oe)=>({u_matrix:b,u_normalize_matrix:c,u_globe_matrix:h,u_merc_matrix:v,u_grid_matrix:N,u_tl_parent:A,u_scale_parent:K,u_fade_t:Y.mix,u_opacity:Y.opacity*ee.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:ee.paint.get("raster-brightness-min"),u_brightness_high:ee.paint.get("raster-brightness-max"),u_saturation_factor:s.cP(ee.paint.get("raster-saturation")),u_contrast_factor:s.cQ(ee.paint.get("raster-contrast")),u_spin_weights:Ld(ee.paint.get("raster-hue-rotate")),u_perspective_transform:Q,u_raster_elevation:ie,u_zoom_transition:k,u_merc_center:z,u_cutoff_params:q,u_colorization_mix:lr(s.cR,le,fe),u_colorization_offset:S1(s.cR,he,fe),u_color_ramp:de,u_texture_offset:[Re/(Te+2*Re),Te/(Te+2*Re)],u_texture_res:[Te+2*Re,Te+2*Re],u_emissive_strength:Oe});function Ld(b){b*=Math.PI/180;const c=Math.sin(b),h=Math.cos(b);return[(2*h+1)/3,(-Math.sqrt(3)*c-h+1)/3,(Math.sqrt(3)*c-h+1)/3]}const ll=.05,Tr=(b,c,h,v,N,A,k,z,q,K,Y,ee)=>({u_matrix:b,u_normalize_matrix:c,u_globe_matrix:h,u_merc_matrix:v,u_grid_matrix:N,u_tl_parent:A,u_scale_parent:K,u_fade_t:Y.mix,u_opacity:Y.opacity,u_image0:0,u_image1:1,u_raster_elevation:ee,u_zoom_transition:k,u_merc_center:z,u_cutoff_params:q}),A1=(b,c,h,v,N,A,k,z,q,K)=>({u_particle_texture:b,u_particle_texture_side_len:c,u_tile_offset:h,u_velocity:v,u_color_ramp:A,u_velocity_res:N,u_max_speed:k,u_uv_offset:z,u_data_scale:[255*q[0],255*q[1]],u_data_offset:K,u_particle_pos_scale:1.1,u_particle_pos_offset:[ll,ll]}),s4=(b,c,h,v,N,A,k,z,q,K)=>({u_particle_texture:b,u_particle_texture_side_len:c,u_velocity:h,u_velocity_res:v,u_max_speed:N,u_speed_factor:A,u_reset_rate:k,u_rand_seed:Math.random(),u_uv_offset:z,u_data_scale:[255*q[0],255*q[1]],u_data_offset:K,u_particle_pos_scale:1.1,u_particle_pos_offset:[ll,ll]}),JS=s.ad.mat4.create(),iy=(b,c,h,v,N,A,k,z,q,K,Y,ee,Q,ie,de,le,he,fe,Te,Re,Oe,$e)=>{const Le=N.transform,Fe={u_is_size_zoom_constant:+(b==="constant"||b==="source"),u_is_size_feature_constant:+(b==="constant"||b==="camera"),u_size_t:c?c.uSizeT:0,u_size:c?c.uSize:0,u_camera_to_center_distance:Le.getCameraToCenterDistance(Te),u_rotate_symbol:+h,u_aspect_ratio:Le.width/Le.height,u_fade_change:N.options.fadeDuration?N.symbolFadeChange:1,u_matrix:A,u_label_plane_matrix:k,u_coord_matrix:z,u_is_text:+K,u_elevation_from_sea:q?1:0,u_pitch_with_map:+v,u_texsize:Y,u_texsize_icon:ee,u_texture:0,u_texture_icon:1,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:JS,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:JS,u_up_vector:[0,-1,0],u_color_adj_mat:Re,u_icon_transition:Oe||0,u_gamma_scale:v?N.transform.getCameraToCenterDistance(Te)*Math.cos(N.terrain?0:N.transform._pitch):1,u_device_pixel_ratio:s.q.devicePixelRatio,u_is_halo:+Q,u_scale_factor:$e||1};return Te.name==="globe"&&(Fe.u_tile_id=[ie.canonical.x,ie.canonical.y,1<<ie.canonical.z],Fe.u_zoom_transition=de,Fe.u_inv_rot_matrix=he,Fe.u_merc_center=le,Fe.u_camera_forward=Le._camera.forward(),Fe.u_ecef_origin=s.cS(Le.globeMatrix,ie.toUnwrapped()),Fe.u_tile_matrix=Float32Array.from(Le.globeMatrix),Fe.u_up_vector=fe),Fe},T1=(b,c,h,v)=>({u_matrix:b,u_emissive_strength:c,u_opacity:h,u_color:v}),QS=(b,c,h,v,N,A,k,z,q)=>s.l(function(K,Y,ee,Q,ie,de){const{width:le,height:he}=Q.imageManager.getPixelSize(Y),fe=Math.pow(2,de.tileID.overscaledZ),Te=de.tileSize*Math.pow(2,Q.transform.tileZoom)/fe,Re=Te*(de.tileID.canonical.x+de.tileID.wrap*fe),Oe=Te*de.tileID.canonical.y;return{u_image:0,u_pattern_tl:ee.tl,u_pattern_br:ee.br,u_texsize:[le,he],u_pattern_size:ee.displaySize,u_pattern_units_to_pixels:ie?[Q.transform.width,-1*Q.transform.height]:[1/s.at(de,1,Q.transform.tileZoom),1/s.at(de,1,Q.transform.tileZoom)],u_pixel_coord_upper:[Re>>16,Oe>>16],u_pixel_coord_lower:[65535&Re,65535&Oe]}}(0,A,k,v,z,q),{u_matrix:b,u_emissive_strength:c,u_opacity:h}),sy=new Float32Array(s.ad.mat4.identity([])),k1=(b,c,h,v,N,A,k,z,q,K,Y,ee,Q,ie=[0,0,0],de)=>{const le=N.style.light,he=le.properties.get("position"),fe=[-he.x,-he.y,he.z],Te=s.ad.mat3.create();le.properties.get("anchor")==="viewport"&&(s.ad.mat3.fromRotation(Te,-N.transform.angle),s.ad.vec3.transformMat3(fe,fe,Te));const Re=Y.alphaMode==="MASK",Oe=le.properties.get("color").toRenderColor(null),$e=Q.paint.get("model-ambient-occlusion-intensity"),Le=Q.paint.get("model-color").constantOr(s.al.white).toRenderColor(null),Fe=Q.paint.get("model-color-mix-intensity").constantOr(0);return{u_matrix:b,u_lighting_matrix:c,u_normal_matrix:h,u_node_matrix:v||sy,u_lightpos:fe,u_lightintensity:le.properties.get("intensity"),u_lightcolor:[Oe.r,Oe.g,Oe.b],u_camera_pos:ie,u_opacity:A,u_baseTextureIsAlpha:0,u_alphaMask:+Re,u_alphaCutoff:Y.alphaCutoff,u_baseColorFactor:[k.r,k.g,k.b,k.a],u_emissiveFactor:[z[0],z[1],z[2],1],u_metallicFactor:q,u_roughnessFactor:K,u_baseColorTexture:ss.BaseColor,u_metallicRoughnessTexture:ss.MetallicRoughness,u_normalTexture:ss.Normal,u_occlusionTexture:ss.Occlusion,u_emissionTexture:ss.Emission,u_lutTexture:ss.LUT,u_color_mix:[Le.r,Le.g,Le.b,Fe],u_aoIntensity:$e,u_emissive_strength:ee,u_occlusionTextureTransform:de||[0,0,0,0]}},eC=(b,c=sy,h=sy)=>({u_matrix:b,u_instance:c,u_node_matrix:h}),P1={fillExtrusion:b=>({u_matrix:new s.bJ(b),u_lightpos:new s.bL(b),u_lightintensity:new s.bM(b),u_lightcolor:new s.bL(b),u_vertical_gradient:new s.bM(b),u_opacity:new s.bM(b),u_edge_radius:new s.bM(b),u_width_scale:new s.bM(b),u_ao:new s.bK(b),u_height_type:new s.bN(b),u_base_type:new s.bN(b),u_tile_id:new s.bL(b),u_zoom_transition:new s.bM(b),u_inv_rot_matrix:new s.bJ(b),u_merc_center:new s.bK(b),u_up_dir:new s.bL(b),u_height_lift:new s.bM(b),u_flood_light_color:new s.bL(b),u_vertical_scale:new s.bM(b),u_flood_light_intensity:new s.bM(b),u_ground_shadow_factor:new s.bL(b)}),fillExtrusionDepth:b=>({u_matrix:new s.bJ(b),u_edge_radius:new s.bM(b),u_width_scale:new s.bM(b),u_vertical_scale:new s.bM(b),u_height_type:new s.bN(b),u_base_type:new s.bN(b)}),fillExtrusionPattern:b=>({u_matrix:new s.bJ(b),u_lightpos:new s.bL(b),u_lightintensity:new s.bM(b),u_lightcolor:new s.bL(b),u_vertical_gradient:new s.bM(b),u_height_factor:new s.bM(b),u_edge_radius:new s.bM(b),u_width_scale:new s.bM(b),u_ao:new s.bK(b),u_height_type:new s.bN(b),u_base_type:new s.bN(b),u_tile_id:new s.bL(b),u_zoom_transition:new s.bM(b),u_inv_rot_matrix:new s.bJ(b),u_merc_center:new s.bK(b),u_up_dir:new s.bL(b),u_height_lift:new s.bM(b),u_image:new s.bN(b),u_texsize:new s.bK(b),u_pixel_coord_upper:new s.bK(b),u_pixel_coord_lower:new s.bK(b),u_tile_units_to_pixels:new s.bM(b),u_opacity:new s.bM(b)}),fillExtrusionGroundEffect:b=>({u_matrix:new s.bJ(b),u_opacity:new s.bM(b),u_ao_pass:new s.bM(b),u_meter_to_tile:new s.bM(b),u_ao:new s.bK(b),u_flood_light_intensity:new s.bM(b),u_flood_light_color:new s.bL(b),u_attenuation:new s.bM(b),u_edge_radius:new s.bM(b),u_fb:new s.bN(b),u_fb_size:new s.bM(b),u_dynamic_offset:new s.bM(b)}),fill:b=>({u_matrix:new s.bJ(b),u_emissive_strength:new s.bM(b)}),fillPattern:b=>({u_matrix:new s.bJ(b),u_emissive_strength:new s.bM(b),u_image:new s.bN(b),u_texsize:new s.bK(b),u_pixel_coord_upper:new s.bK(b),u_pixel_coord_lower:new s.bK(b),u_tile_units_to_pixels:new s.bM(b)}),fillOutline:b=>({u_matrix:new s.bJ(b),u_emissive_strength:new s.bM(b),u_world:new s.bK(b)}),fillOutlinePattern:b=>({u_matrix:new s.bJ(b),u_emissive_strength:new s.bM(b),u_world:new s.bK(b),u_image:new s.bN(b),u_texsize:new s.bK(b),u_pixel_coord_upper:new s.bK(b),u_pixel_coord_lower:new s.bK(b),u_tile_units_to_pixels:new s.bM(b)}),elevatedStructures:b=>({u_matrix:new s.bJ(b)}),elevatedStructuresDepthReconstruct:b=>({u_matrix:new s.bJ(b),u_camera_pos:new s.bL(b),u_depth_bias:new s.bM(b),u_height_scale:new s.bM(b),u_reset_depth:new s.bM(b)}),circle:s.cT,collisionBox:b=>({u_matrix:new s.bJ(b),u_camera_to_center_distance:new s.bM(b),u_extrude_scale:new s.bK(b)}),collisionCircle:b=>({u_matrix:new s.bJ(b),u_inv_matrix:new s.bJ(b),u_camera_to_center_distance:new s.bM(b),u_viewport_size:new s.bK(b)}),debug:b=>({u_color:new s.cA(b),u_matrix:new s.bJ(b),u_overlay:new s.bN(b),u_overlay_scale:new s.bM(b)}),clippingMask:b=>({u_matrix:new s.bJ(b)}),heatmap:b=>({u_extrude_scale:new s.bM(b),u_intensity:new s.bM(b),u_matrix:new s.bJ(b),u_inv_rot_matrix:new s.bJ(b),u_merc_center:new s.bK(b),u_tile_id:new s.bL(b),u_zoom_transition:new s.bM(b),u_up_dir:new s.bL(b)}),heatmapTexture:b=>({u_image:new s.bN(b),u_color_ramp:new s.bN(b),u_opacity:new s.bM(b)}),hillshade:b=>({u_matrix:new s.bJ(b),u_image:new s.bN(b),u_latrange:new s.bK(b),u_light:new s.bK(b),u_shadow:new s.cA(b),u_highlight:new s.cA(b),u_emissive_strength:new s.bM(b),u_accent:new s.cA(b)}),hillshadePrepare:b=>({u_matrix:new s.bJ(b),u_image:new s.bN(b),u_dimension:new s.bK(b),u_zoom:new s.bM(b)}),line:s.cU,linePattern:s.cV,raster:b=>({u_matrix:new s.bJ(b),u_normalize_matrix:new s.bJ(b),u_globe_matrix:new s.bJ(b),u_merc_matrix:new s.bJ(b),u_grid_matrix:new s.cB(b),u_tl_parent:new s.bK(b),u_scale_parent:new s.bM(b),u_fade_t:new s.bM(b),u_opacity:new s.bM(b),u_image0:new s.bN(b),u_image1:new s.bN(b),u_brightness_low:new s.bM(b),u_brightness_high:new s.bM(b),u_saturation_factor:new s.bM(b),u_contrast_factor:new s.bM(b),u_spin_weights:new s.bL(b),u_perspective_transform:new s.bK(b),u_raster_elevation:new s.bM(b),u_zoom_transition:new s.bM(b),u_merc_center:new s.bK(b),u_cutoff_params:new s.cb(b),u_colorization_mix:new s.cb(b),u_colorization_offset:new s.bM(b),u_color_ramp:new s.bN(b),u_texture_offset:new s.bK(b),u_texture_res:new s.bK(b),u_emissive_strength:new s.bM(b)}),rasterParticle:b=>({u_matrix:new s.bJ(b),u_normalize_matrix:new s.bJ(b),u_globe_matrix:new s.bJ(b),u_merc_matrix:new s.bJ(b),u_grid_matrix:new s.cB(b),u_tl_parent:new s.bK(b),u_scale_parent:new s.bM(b),u_fade_t:new s.bM(b),u_opacity:new s.bM(b),u_image0:new s.bN(b),u_image1:new s.bN(b),u_raster_elevation:new s.bM(b),u_zoom_transition:new s.bM(b),u_merc_center:new s.bK(b),u_cutoff_params:new s.cb(b)}),rasterParticleTexture:b=>({u_texture:new s.bN(b),u_opacity:new s.bM(b)}),rasterParticleDraw:b=>({u_particle_texture:new s.bN(b),u_particle_texture_side_len:new s.bM(b),u_tile_offset:new s.bK(b),u_velocity:new s.bN(b),u_color_ramp:new s.bN(b),u_velocity_res:new s.bK(b),u_max_speed:new s.bM(b),u_uv_offset:new s.bK(b),u_data_scale:new s.bK(b),u_data_offset:new s.bM(b),u_particle_pos_scale:new s.bM(b),u_particle_pos_offset:new s.bK(b)}),rasterParticleUpdate:b=>({u_particle_texture:new s.bN(b),u_particle_texture_side_len:new s.bM(b),u_velocity:new s.bN(b),u_velocity_res:new s.bK(b),u_max_speed:new s.bM(b),u_speed_factor:new s.bM(b),u_reset_rate:new s.bM(b),u_rand_seed:new s.bM(b),u_uv_offset:new s.bK(b),u_data_scale:new s.bK(b),u_data_offset:new s.bM(b),u_particle_pos_scale:new s.bM(b),u_particle_pos_offset:new s.bK(b)}),symbol:b=>({u_is_size_zoom_constant:new s.bN(b),u_is_size_feature_constant:new s.bN(b),u_size_t:new s.bM(b),u_size:new s.bM(b),u_camera_to_center_distance:new s.bM(b),u_rotate_symbol:new s.bN(b),u_aspect_ratio:new s.bM(b),u_fade_change:new s.bM(b),u_matrix:new s.bJ(b),u_label_plane_matrix:new s.bJ(b),u_coord_matrix:new s.bJ(b),u_is_text:new s.bN(b),u_elevation_from_sea:new s.bN(b),u_pitch_with_map:new s.bN(b),u_texsize:new s.bK(b),u_texsize_icon:new s.bK(b),u_texture:new s.bN(b),u_texture_icon:new s.bN(b),u_gamma_scale:new s.bM(b),u_device_pixel_ratio:new s.bM(b),u_tile_id:new s.bL(b),u_zoom_transition:new s.bM(b),u_inv_rot_matrix:new s.bJ(b),u_merc_center:new s.bK(b),u_camera_forward:new s.bL(b),u_tile_matrix:new s.bJ(b),u_up_vector:new s.bL(b),u_ecef_origin:new s.bL(b),u_is_halo:new s.bN(b),u_icon_transition:new s.bM(b),u_color_adj_mat:new s.bJ(b),u_scale_factor:new s.bM(b)}),background:b=>({u_matrix:new s.bJ(b),u_emissive_strength:new s.bM(b),u_opacity:new s.bM(b),u_color:new s.cA(b)}),backgroundPattern:b=>({u_matrix:new s.bJ(b),u_emissive_strength:new s.bM(b),u_opacity:new s.bM(b),u_image:new s.bN(b),u_pattern_tl:new s.bK(b),u_pattern_br:new s.bK(b),u_texsize:new s.bK(b),u_pattern_size:new s.bK(b),u_pixel_coord_upper:new s.bK(b),u_pixel_coord_lower:new s.bK(b),u_pattern_units_to_pixels:new s.bK(b)}),terrainRaster:b=>({u_matrix:new s.bJ(b),u_image0:new s.bN(b),u_skirt_height:new s.bM(b),u_ground_shadow_factor:new s.bL(b)}),skybox:b=>({u_matrix:new s.bJ(b),u_sun_direction:new s.bL(b),u_cubemap:new s.bN(b),u_opacity:new s.bM(b),u_temporal_offset:new s.bM(b)}),skyboxGradient:b=>({u_matrix:new s.bJ(b),u_color_ramp:new s.bN(b),u_center_direction:new s.bL(b),u_radius:new s.bM(b),u_opacity:new s.bM(b),u_temporal_offset:new s.bM(b)}),skyboxCapture:b=>({u_matrix_3f:new s.cB(b),u_sun_direction:new s.bL(b),u_sun_intensity:new s.bM(b),u_color_tint_r:new s.cb(b),u_color_tint_m:new s.cb(b),u_luminance:new s.bM(b)}),globeRaster:b=>({u_proj_matrix:new s.bJ(b),u_globe_matrix:new s.bJ(b),u_normalize_matrix:new s.bJ(b),u_merc_matrix:new s.bJ(b),u_zoom_transition:new s.bM(b),u_merc_center:new s.bK(b),u_image0:new s.bN(b),u_grid_matrix:new s.cB(b),u_skirt_height:new s.bM(b),u_far_z_cutoff:new s.bM(b),u_frustum_tl:new s.bL(b),u_frustum_tr:new s.bL(b),u_frustum_br:new s.bL(b),u_frustum_bl:new s.bL(b),u_globe_pos:new s.bL(b),u_globe_radius:new s.bM(b),u_viewport:new s.bK(b)}),globeAtmosphere:b=>({u_frustum_tl:new s.bL(b),u_frustum_tr:new s.bL(b),u_frustum_br:new s.bL(b),u_frustum_bl:new s.bL(b),u_horizon:new s.bM(b),u_transition:new s.bM(b),u_fadeout_range:new s.bM(b),u_color:new s.cb(b),u_high_color:new s.cb(b),u_space_color:new s.cb(b),u_temporal_offset:new s.bM(b),u_horizon_angle:new s.bM(b)}),model:b=>({u_matrix:new s.bJ(b),u_lighting_matrix:new s.bJ(b),u_normal_matrix:new s.bJ(b),u_node_matrix:new s.bJ(b),u_lightpos:new s.bL(b),u_lightintensity:new s.bM(b),u_lightcolor:new s.bL(b),u_camera_pos:new s.bL(b),u_opacity:new s.bM(b),u_baseColorFactor:new s.cb(b),u_emissiveFactor:new s.cb(b),u_metallicFactor:new s.bM(b),u_roughnessFactor:new s.bM(b),u_baseTextureIsAlpha:new s.bN(b),u_alphaMask:new s.bN(b),u_alphaCutoff:new s.bM(b),u_baseColorTexture:new s.bN(b),u_metallicRoughnessTexture:new s.bN(b),u_normalTexture:new s.bN(b),u_occlusionTexture:new s.bN(b),u_emissionTexture:new s.bN(b),u_lutTexture:new s.bN(b),u_color_mix:new s.cb(b),u_aoIntensity:new s.bM(b),u_emissive_strength:new s.bM(b),u_occlusionTextureTransform:new s.cb(b)}),modelDepth:b=>({u_matrix:new s.bJ(b),u_instance:new s.bJ(b),u_node_matrix:new s.bJ(b)}),groundShadow:b=>({u_matrix:new s.bJ(b),u_ground_shadow_factor:new s.bL(b)}),stars:b=>({u_matrix:new s.bJ(b),u_up:new s.bL(b),u_right:new s.bL(b),u_intensity_multiplier:new s.bM(b)}),snowParticle:b=>({u_modelview:new s.bJ(b),u_projection:new s.bJ(b),u_time:new s.bM(b),u_cam_pos:new s.bL(b),u_velocityConeAperture:new s.bM(b),u_velocity:new s.bM(b),u_horizontalOscillationRadius:new s.bM(b),u_horizontalOscillationRate:new s.bM(b),u_boxSize:new s.bM(b),u_billboardSize:new s.bM(b),u_simpleShapeParameters:new s.bK(b),u_screenSize:new s.bK(b),u_thinningCenterPos:new s.bK(b),u_thinningShape:new s.bL(b),u_thinningAffectedRatio:new s.bM(b),u_thinningParticleOffset:new s.bM(b),u_particleColor:new s.cb(b),u_direction:new s.bL(b)}),rainParticle:b=>({u_modelview:new s.bJ(b),u_projection:new s.bJ(b),u_time:new s.bM(b),u_cam_pos:new s.bL(b),u_texScreen:new s.bN(b),u_velocityConeAperture:new s.bM(b),u_velocity:new s.bM(b),u_boxSize:new s.bM(b),u_rainDropletSize:new s.bK(b),u_distortionStrength:new s.bM(b),u_rainDirection:new s.bL(b),u_color:new s.cb(b),u_screenSize:new s.bK(b),u_thinningCenterPos:new s.bK(b),u_thinningShape:new s.bL(b),u_thinningAffectedRatio:new s.bM(b),u_thinningParticleOffset:new s.bM(b),u_shapeDirectionalPower:new s.bM(b),u_shapeNormalPower:new s.bM(b),u_mode:new s.bM(b)}),vignette:b=>({u_vignetteShape:new s.bL(b),u_vignetteColor:new s.cb(b)}),occlusion:b=>({u_matrix:new s.bJ(b),u_anchorPos:new s.bL(b),u_screenSizePx:new s.bK(b),u_occluderSizePx:new s.bK(b),u_color:new s.cb(b)})};class Jc{constructor(c,h,v,N){this.id=Jc.uniqueIdxCounter,Jc.uniqueIdxCounter++,this.context=c;const A=c.gl;this.buffer=A.createBuffer(),this.dynamicDraw=!!v,this.context.unbindVAO(),c.bindElementBuffer.set(this.buffer),A.bufferData(A.ELEMENT_ARRAY_BUFFER,h.arrayBuffer,this.dynamicDraw?A.DYNAMIC_DRAW:A.STATIC_DRAW),this.dynamicDraw||N||h.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(c){this.id=Jc.uniqueIdxCounter,Jc.uniqueIdxCounter++;const h=this.context.gl;this.context.unbindVAO(),this.bind(),h.bufferSubData(h.ELEMENT_ARRAY_BUFFER,0,c.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}Jc.uniqueIdxCounter=0;const E1={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class M1{constructor(c,h,v,N,A,k){this.length=h.length,this.attributes=v,this.itemSize=h.bytesPerElement,this.dynamicDraw=N,this.instanceCount=k,this.context=c;const z=c.gl;this.buffer=z.createBuffer(),c.bindVertexBuffer.set(this.buffer),z.bufferData(z.ARRAY_BUFFER,h.arrayBuffer,this.dynamicDraw?z.DYNAMIC_DRAW:z.STATIC_DRAW),this.dynamicDraw||A||h.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(c){const h=this.context.gl;this.bind(),h.bufferSubData(h.ARRAY_BUFFER,0,c.arrayBuffer)}enableAttributes(c,h){for(let v=0;v<this.attributes.length;v++){const N=h.attributes[this.attributes[v].name];N!==void 0&&c.enableVertexAttribArray(N)}}setVertexAttribPointers(c,h,v){for(let N=0;N<this.attributes.length;N++){const A=this.attributes[N],k=h.attributes[A.name];k!==void 0&&c.vertexAttribPointer(k,A.components,c[E1[A.type]],!1,this.itemSize,A.offset+this.itemSize*(v||0))}}setVertexAttribDivisor(c,h,v){for(let N=0;N<this.attributes.length;N++){const A=h.attributes[this.attributes[N].name];A!==void 0&&this.instanceCount&&this.instanceCount>0&&c.vertexAttribDivisor(A,v)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class bo{constructor(c,h,v,N,A){this.context=c,this.width=h,this.height=v;const k=this.framebuffer=c.gl.createFramebuffer();N&&(this.colorAttachment=new p1(c,k)),A&&(this.depthAttachmentType=A,this.depthAttachment=A==="renderbuffer"?new g1(c,k):new uf(c,k))}destroy(){const c=this.context.gl;if(this.colorAttachment){const h=this.colorAttachment.get();h&&c.deleteTexture(h)}if(this.depthAttachment&&this.depthAttachmentType)if(this.depthAttachmentType==="renderbuffer"){const h=this.depthAttachment.get();h&&c.deleteRenderbuffer(h)}else{const h=this.depthAttachment.get();h&&c.deleteTexture(h)}c.deleteFramebuffer(this.framebuffer)}}class Fd{constructor(c,h){this.gl=c,this.clearColor=new Y3(this),this.clearDepth=new s1(this),this.clearStencil=new a1(this),this.colorMask=new o1(this),this.depthMask=new l1(this),this.stencilMask=new FS(this),this.stencilFunc=new BS(this),this.stencilOp=new X3(this),this.stencilTest=new Mg(this),this.depthRange=new Ig(this),this.depthTest=new $S(this),this.depthFunc=new ol(this),this.blend=new c1(this),this.blendFunc=new qx(this),this.blendColor=new Wx(this),this.blendEquation=new u1(this),this.cullFace=new d1(this),this.cullFaceSide=new h1(this),this.frontFace=new Kx(this),this.program=new m1(this),this.activeTexture=new f1(this),this.viewport=new Zx(this),this.bindFramebuffer=new VS(this),this.bindRenderbuffer=new US(this),this.bindTexture=new cf(this),this.bindVertexBuffer=new J3(this),this.bindElementBuffer=new Q3(this),this.bindVertexArrayOES=new e4(this),this.pixelStoreUnpack=new t4(this),this.pixelStoreUnpackPremultiplyAlpha=new r4(this),this.pixelStoreUnpackFlipY=new n4(this),this.options=h?Object.assign({},h):{},this.options.extTextureFilterAnisotropicForceOff||(this.extTextureFilterAnisotropic=c.getExtension("EXT_texture_filter_anisotropic")||c.getExtension("MOZ_EXT_texture_filter_anisotropic")||c.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=c.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),this.extDebugRendererInfo=c.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=c.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=c.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.forceManualRenderingForInstanceIDShaders=h&&!!h.forceManualRenderingForInstanceIDShaders||this.renderer&&this.renderer.indexOf("PowerVR")!==-1,this.options.extTextureFloatLinearForceOff||(this.extTextureFloatLinear=c.getExtension("OES_texture_float_linear")),this.extRenderToTextureHalfFloat=c.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=c.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=c.getParameter(c.MAX_TEXTURE_SIZE),this.maxPointSize=c.getParameter(c.ALIASED_POINT_SIZE_RANGE)[1]}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(c,h,v){return new Jc(this,c,h,v)}createVertexBuffer(c,h,v,N,A){return new M1(this,c,h,v,N,A)}createRenderbuffer(c,h,v){const N=this.gl,A=N.createRenderbuffer();return this.bindRenderbuffer.set(A),N.renderbufferStorage(N.RENDERBUFFER,c,h,v),this.bindRenderbuffer.set(null),A}createFramebuffer(c,h,v,N){return new bo(this,c,h,v,N)}clear({color:c,depth:h,stencil:v,colorMask:N}){const A=this.gl;let k=0;c&&(k|=A.COLOR_BUFFER_BIT,this.clearColor.set(c),this.colorMask.set(N||[!0,!0,!0,!0])),h!==void 0&&(k|=A.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(h),this.depthMask.set(!0)),v!==void 0&&(k|=A.STENCIL_BUFFER_BIT,this.clearStencil.set(v),this.stencilMask.set(255)),A.clear(k)}setCullFace(c){c.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(c.mode),this.frontFace.set(c.frontFace))}setDepthMode(c){c.func!==this.gl.ALWAYS||c.mask?(this.depthTest.set(!0),this.depthFunc.set(c.func),this.depthMask.set(c.mask),this.depthRange.set(c.range)):this.depthTest.set(!1)}setStencilMode(c){c.test.func!==this.gl.ALWAYS||c.mask?(this.stencilTest.set(!0),this.stencilMask.set(c.mask),this.stencilOp.set([c.fail,c.depthFail,c.pass]),this.stencilFunc.set({func:c.test.func,ref:c.ref,mask:c.test.mask})):this.stencilTest.set(!1)}setColorMode(c){s.bn(c.blendFunction,mn.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(c.blendFunction),this.blendColor.set(c.blendColor),c.blendEquation?this.blendEquation.set(c.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(c.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}let zg;function ay(b,c,h,v,N,A,k){const z=b.context,q=z.gl,K=b.transform,Y=b.getOrCreateProgram("collisionBox"),ee=[];let Q=0,ie=0;for(let Oe=0;Oe<v.length;Oe++){const $e=v[Oe],Le=c.getTile($e),Fe=Le.getBucket(h);if(!Fe)continue;const Be=Y_($e,Fe,K);let He=Be;N[0]===0&&N[1]===0||(He=b.translatePosMatrix(Be,Le,N,A));const Ke=k?Fe.textCollisionBox:Fe.iconCollisionBox,ft=Fe.collisionCircleArray;if(ft.length>0){const at=s.ad.mat4.create(),kt=He;s.ad.mat4.mul(at,Fe.placementInvProjMatrix,K.glCoordMatrix),s.ad.mat4.mul(at,at,Fe.placementViewportMatrix),ee.push({circleArray:ft,circleOffset:ie,transform:kt,invTransform:at,projection:Fe.getProjection()}),Q+=ft.length/4,ie=Q}Ke&&(b.terrain&&b.terrain.setupElevationDraw(Le,Y),Y.draw(b,q.LINES,Cr.disabled,Kr.disabled,b.colorModeForRenderPass(),Gr.disabled,YS(He,K,Le,Fe.getProjection()),h.id,Ke.layoutVertexBuffer,Ke.indexBuffer,Ke.segments,null,K.zoom,null,[Ke.collisionVertexBuffer,Ke.collisionVertexBufferExt]))}if(!k||!ee.length)return;const de=b.getOrCreateProgram("collisionCircle"),le=new s.cW;le.resize(4*Q),le._trim();let he=0;for(const Oe of ee)for(let $e=0;$e<Oe.circleArray.length/4;$e++){const Le=4*$e,Fe=Oe.circleArray[Le+0],Be=Oe.circleArray[Le+1],He=Oe.circleArray[Le+2],Ke=Oe.circleArray[Le+3];le.emplace(he++,Fe,Be,He,Ke,0),le.emplace(he++,Fe,Be,He,Ke,1),le.emplace(he++,Fe,Be,He,Ke,2),le.emplace(he++,Fe,Be,He,Ke,3)}(!zg||zg.length<2*Q)&&(zg=function(Oe){const $e=2*Oe,Le=new s.aV;Le.resize($e),Le._trim();for(let Fe=0;Fe<$e;Fe++){const Be=6*Fe;Le.uint16[Be+0]=4*Fe+0,Le.uint16[Be+1]=4*Fe+1,Le.uint16[Be+2]=4*Fe+2,Le.uint16[Be+3]=4*Fe+2,Le.uint16[Be+4]=4*Fe+3,Le.uint16[Be+5]=4*Fe+0}return Le}(Q));const fe=z.createIndexBuffer(zg,!0),Te=z.createVertexBuffer(le,s.cX.members,!0);for(const Oe of ee){const $e={u_matrix:Oe.transform,u_inv_matrix:Oe.invTransform,u_camera_to_center_distance:(Re=K).getCameraToCenterDistance(Oe.projection),u_viewport_size:[Re.width,Re.height]};de.draw(b,q.TRIANGLES,Cr.disabled,Kr.disabled,b.colorModeForRenderPass(),Gr.disabled,$e,h.id,Te,fe,s.b8.simpleSegment(0,2*Oe.circleOffset,Oe.circleArray.length,Oe.circleArray.length/2),null,K.zoom)}var Re;Te.destroy(),fe.destroy()}const pf=s.ad.mat4.create();function oy(b){const c=b._camera.getWorldToCamera(b.worldSize,1),h=s.ad.mat4.multiply([],c,b.globeMatrix);s.ad.mat4.invert(h,h);const v=[0,0,0],N=[0,1,0,0];return s.ad.vec4.transformMat4(N,N,h),v[0]=N[0],v[1]=N[1],v[2]=N[2],s.ad.vec3.normalize(v,v),v}function tC({width:b,height:c,anchor:h,textOffset:v,textScale:N},A){const{horizontalAlign:k,verticalAlign:z}=s.bD(h),q=-(k-.5)*b,K=-(z-.5)*c,Y=s.bC(h,v);return new s.P((q/N+Y[0])*A,(K/N+Y[1])*A)}function Fl(b,c,h,v,N,A,k,z,q,K,Y){const ee=b.text.placedSymbolArray,Q=b.text.dynamicLayoutVertexArray,ie=b.icon.dynamicLayoutVertexArray,de={},le=b.getProjection(),he=al(z,le,A),fe=A.elevation,Te=le.upVectorScale(z.canonical,A.center.lat,A.worldSize).metersToTile;Q.clear();for(let Re=0;Re<ee.length;Re++){const Oe=ee.get(Re),{tileAnchorX:$e,tileAnchorY:Le,numGlyphs:Fe}=Oe,Be=Oe.hidden||!Oe.crossTileID||b.allowVerticalPlacement&&!Oe.placedOrientation?null:v[Oe.crossTileID];if(Be){let He=0,Ke=0,ft=0;if(fe){const _t=fe?fe.getAtTileOffset(z,$e,Le):0,[Et,pt,It]=le.upVector(z.canonical,$e,Le);He=_t*Et*Te,Ke=_t*pt*Te,ft=_t*It*Te}let[at,kt,Pt,Bt]=cc(Oe.projectedAnchorX+He,Oe.projectedAnchorY+Ke,Oe.projectedAnchorZ+ft,h?he:k);const st=Ym(A.getCameraToCenterDistance(le),Bt);let At=N.evaluateSizeForFeature(b.textSizeData,K,Oe)*st/s.bw;h&&(At*=b.tilePixelRatio/q);const rt=tC(Be,At);h?({x:at,y:kt,z:Pt}=le.projectTilePoint($e+rt.x,Le+rt.y,z.canonical),[at,kt,Pt]=cc(at+He,kt+Ke,Pt+ft,k)):(c&&rt._rotate(-A.angle),at+=rt.x,kt+=rt.y,Pt=0);const Ct=b.allowVerticalPlacement&&Oe.placedOrientation===s.bq.vertical?Math.PI/2:0;for(let _t=0;_t<Fe;_t++)s.bt(Q,at,kt,Pt,Ct);Y&&Oe.associatedIconIndex>=0&&(de[Oe.associatedIconIndex]={x:at,y:kt,z:Pt,angle:Ct})}else uc(Fe,Q)}if(Y){ie.clear();const Re=b.icon.placedSymbolArray;for(let Oe=0;Oe<Re.length;Oe++){const $e=Re.get(Oe),{numGlyphs:Le}=$e,Fe=de[Oe];if($e.hidden||!Fe)uc(Le,ie);else{const{x:Be,y:He,z:Ke,angle:ft}=Fe;for(let at=0;at<Le;at++)s.bt(ie,Be,He,Ke,ft)}}b.icon.dynamicLayoutVertexBuffer.updateData(ie)}b.text.dynamicLayoutVertexBuffer.updateData(Q)}function hi(b,c,h,v,N,A,k={}){const z=h.paint.get("icon-translate"),q=h.paint.get("text-translate"),K=h.paint.get("icon-translate-anchor"),Y=h.paint.get("text-translate-anchor"),ee=h.layout.get("icon-rotation-alignment"),Q=h.layout.get("text-rotation-alignment"),ie=h.layout.get("icon-pitch-alignment"),de=h.layout.get("text-pitch-alignment"),le=h.layout.get("icon-keep-upright"),he=h.layout.get("text-keep-upright"),fe=h.paint.get("icon-color-saturation"),Te=h.paint.get("icon-color-contrast"),Re=h.paint.get("icon-color-brightness-min"),Oe=h.paint.get("icon-color-brightness-max"),$e=h.layout.get("symbol-elevation-reference")==="sea",Le=b.context,Fe=Le.gl,Be=b.transform,He=ee==="map",Ke=Q==="map",ft=ie==="map",at=de==="map",kt=h.layout.get("symbol-sort-key").constantOr(1)!==void 0;let Pt=!1;const Bt=b.depthModeForSublayer(0,Cr.ReadOnly),st=[s.av(Be.center.lng),s.aC(Be.center.lat)],At=h.layout.get("text-variable-anchor"),rt=Be.projection.name==="globe",Ct=[],_t=[0,-1,0];for(const Et of v){const pt=c.getTile(Et),It=pt.getBucket(h);if(!It||It.projection.name==="mercator"&&rt||It.fullyClipped)continue;const Kt=It.projection.name==="globe",Zt=Kt?s.ag(Be.zoom):0,Qt=al(Et,It.getProjection(),Be),gr=Be.calculatePixelsToTileUnitsMatrix(pt),qr=At&&It.hasTextData(),Er=It.hasIconTextFit()&&qr&&It.hasIconData(),Br=It.getProjection().createInversionMatrix(Be,Et.canonical),zr=Jn=>{Be.depthOcclusionForSymbolsAndCircles&&(h.hasInitialOcclusionOpacityProperties||b.terrain)&&(Jn.push("DEPTH_D24"),Jn.push("DEPTH_OCCLUSION"))},bn=()=>{const Jn=He&&h.layout.get("symbol-placement")!=="point",On=[];zr(On);const es=Jn||Er,js=h.paint.get("icon-image-cross-fade").constantOr(0);b.terrainRenderModeElevated()&&ft&&On.push("PITCH_WITH_MAP_TERRAIN"),Kt&&(On.push("PROJECTION_GLOBE_VIEW"),es&&On.push("PROJECTED_POS_ON_VIEWPORT")),js>0&&On.push("ICON_TRANSITION"),It.icon.zOffsetVertexBuffer&&On.push("Z_OFFSET"),fe===0&&Te===0&&Re===0&&Oe===1||On.push("COLOR_ADJUSTMENT"),It.sdfIcons&&On.push("RENDER_SDF");const Gs=It.icon.programConfigurations.get(h.id),Qs=b.getOrCreateProgram("symbol",{config:Gs,defines:On}),dl=pt.imageAtlasTexture?pt.imageAtlasTexture.size:[0,0],Wa=It.iconSizeData,Pn=s.bp(Wa,Be.zoom),Pi=ft||Be.pitch!==0,Un=Pu(Qt,pt.tileID.canonical,ft,He,Be,It.getProjection(),gr),oi=us(Qt,pt.tileID.canonical,ft,He,Be,It.getProjection(),gr),_a=b.translatePosMatrix(oi,pt,z,K,!0),ji=b.translatePosMatrix(Qt,pt,z,K),Hs=es?pf:Un,tu=He&&!ft&&!Jn;let Fo=_t;!rt&&!Be.mercatorFromTransition||He||(Fo=oy(Be));const Vl=Kt?Fo:_t,_o=h.getColorAdjustmentMatrix(fe,Te,Re,Oe),Ul=iy(Wa.kind,Pn,tu,ft,b,ji,Hs,_a,$e,!1,dl,[0,0],!0,Et,Zt,st,Br,Vl,It.getProjection(),_o,js),Bo=pt.imageAtlasTexture?pt.imageAtlasTexture:null,Uu=h.layout.get("icon-size").constantOr(0)!==1||It.iconsNeedLinear,ru=It.sdfIcons||b.options.rotating||b.options.zooming||Uu||Pi?Fe.LINEAR:Fe.NEAREST,Gu=It.sdfIcons&&h.paint.get("icon-halo-width").constantOr(1)!==0,iw=b.terrain&&ft&&Jn?s.ad.mat4.invert(s.ad.mat4.create(),Un):pf;if(Jn&&It.icon){const kf=Be.elevation,Sy=kf?kf.getAtTileOffsetFunc(Et,Be.center.lat,Be.worldSize,It.getProjection()):null,sw=Aa(Qt,pt.tileID.canonical,ft,He,Be,It.getProjection(),gr);Xm(It,Qt,b,!1,sw,oi,ft,le,Sy,Et)}return{program:Qs,buffers:It.icon,uniformValues:Ul,atlasTexture:Bo,atlasTextureIcon:null,atlasInterpolation:ru,atlasInterpolationIcon:null,isSDF:It.sdfIcons,hasHalo:Gu,tile:pt,labelPlaneMatrixInv:iw}},Vn=()=>{const Jn=Ke&&h.layout.get("symbol-placement")!=="point",On=[],es=Jn||At||Er;b.terrainRenderModeElevated()&&at&&On.push("PITCH_WITH_MAP_TERRAIN"),Kt&&(On.push("PROJECTION_GLOBE_VIEW"),es&&On.push("PROJECTED_POS_ON_VIEWPORT")),It.text.zOffsetVertexBuffer&&On.push("Z_OFFSET"),It.iconsInText&&On.push("RENDER_TEXT_AND_SYMBOL"),On.push("RENDER_SDF"),zr(On);const js=It.text.programConfigurations.get(h.id),Gs=b.getOrCreateProgram("symbol",{config:js,defines:On});let Qs,dl=[0,0],Wa=null;const Pn=It.textSizeData;It.iconsInText&&(dl=pt.imageAtlasTexture?pt.imageAtlasTexture.size:[0,0],Wa=pt.imageAtlasTexture?pt.imageAtlasTexture:null,Qs=at||Be.pitch!==0||b.options.rotating||b.options.zooming||Pn.kind==="composite"||Pn.kind==="camera"?Fe.LINEAR:Fe.NEAREST);const Pi=pt.glyphAtlasTexture?pt.glyphAtlasTexture.size:[0,0],Un=h.layout.get("text-size-scale-range"),oi=s.ay(b.scaleFactor,Un[0],Un[1]),_a=s.bp(Pn,Be.zoom,oi),ji=Pu(Qt,pt.tileID.canonical,at,Ke,Be,It.getProjection(),gr),Hs=us(Qt,pt.tileID.canonical,at,Ke,Be,It.getProjection(),gr),tu=b.translatePosMatrix(Hs,pt,q,Y,!0),Fo=b.translatePosMatrix(Qt,pt,q,Y),Vl=es?pf:ji,_o=Ke&&!at&&!Jn;let Ul=_t;!rt&&!Be.mercatorFromTransition||Ke||(Ul=oy(Be));const Bo=iy(Pn.kind,_a,_o,at,b,Fo,Vl,tu,$e,!0,Pi,dl,!0,Et,Zt,st,Br,Kt?Ul:_t,It.getProjection(),null,null,oi),Uu=pt.glyphAtlasTexture?pt.glyphAtlasTexture:null,ru=Fe.LINEAR,Gu=h.paint.get("text-halo-width").constantOr(1)!==0,iw=b.terrain&&at&&Jn?s.ad.mat4.invert(s.ad.mat4.create(),ji):pf;if(Jn&&It.text){const kf=Be.elevation,Sy=kf?kf.getAtTileOffsetFunc(Et,Be.center.lat,Be.worldSize,It.getProjection()):null,sw=Aa(Qt,pt.tileID.canonical,at,Ke,Be,It.getProjection(),gr);Xm(It,Qt,b,!0,sw,Hs,at,he,Sy,Et)}return{program:Gs,buffers:It.text,uniformValues:Bo,atlasTexture:Uu,atlasTextureIcon:Wa,atlasInterpolation:ru,atlasInterpolationIcon:Qs,isSDF:!0,hasHalo:Gu,tile:pt,labelPlaneMatrixInv:iw}},fi=It.icon.segments.get().length,un=It.text.segments.get().length,ki=fi&&!k.onlyText?bn():null,Zr=un&&!k.onlyIcons?Vn():null,xr=h.paint.get("icon-opacity").constantOr(1),Nn=h.paint.get("text-opacity").constantOr(1);if(kt&&It.canOverlap){Pt=!0;const Jn=xr&&!k.onlyText?It.icon.segments.get():[],On=Nn&&!k.onlyIcons?It.text.segments.get():[];for(const es of Jn)Ct.push({segments:new s.b8([es]),sortKey:es.sortKey,state:ki});for(const es of On)Ct.push({segments:new s.b8([es]),sortKey:es.sortKey,state:Zr})}else k.onlyText||Ct.push({segments:xr?It.icon.segments:new s.b8([]),sortKey:0,state:ki}),k.onlyIcons||Ct.push({segments:Nn?It.text.segments:new s.b8([]),sortKey:0,state:Zr})}Pt&&Ct.sort((Et,pt)=>Et.sortKey-pt.sortKey);for(const Et of Ct){const pt=Et.state;if(pt)if(b.terrain?b.terrain.setupElevationDraw(pt.tile,pt.program,{useDepthForOcclusion:Be.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:pt.labelPlaneMatrixInv}):b.setupDepthForOcclusion(Be.depthOcclusionForSymbolsAndCircles,pt.program),Le.activeTexture.set(Fe.TEXTURE0),pt.atlasTexture&&pt.atlasTexture.bind(pt.atlasInterpolation,Fe.CLAMP_TO_EDGE,!0),pt.atlasTextureIcon&&(Le.activeTexture.set(Fe.TEXTURE1),pt.atlasTextureIcon&&pt.atlasTextureIcon.bind(pt.atlasInterpolationIcon,Fe.CLAMP_TO_EDGE,!0)),b.uploadCommonLightUniforms(b.context,pt.program),pt.hasHalo){const It=pt.uniformValues;It.u_is_halo=1,gf(pt.buffers,Et.segments,h,b,pt.program,Bt,N,A,It,2),It.u_is_halo=0}else{if(pt.isSDF){const It=pt.uniformValues;pt.hasHalo&&(It.u_is_halo=1,gf(pt.buffers,Et.segments,h,b,pt.program,Bt,N,A,It,1)),It.u_is_halo=0}gf(pt.buffers,Et.segments,h,b,pt.program,Bt,N,A,pt.uniformValues,1)}}}function gf(b,c,h,v,N,A,k,z,q,K){const Y=[b.dynamicLayoutVertexBuffer,b.opacityVertexBuffer,b.iconTransitioningVertexBuffer,b.globeExtVertexBuffer,b.zOffsetVertexBuffer];N.draw(v,v.context.gl.TRIANGLES,A,k,z,Gr.disabled,q,h.id,b.layoutVertexBuffer,b.indexBuffer,c,h.paint,v.transform.zoom,b.programConfigurations.get(h.id),Y,K)}function I1(b,c){const h=1<<b.canonical.z,v=(c.x*h-b.canonical.x-b.wrap*h)*s.ai,N=(c.y*h-b.canonical.y)*s.ai,A=s.d5(c.z,c.y);return s.ad.vec3.fromValues(v,N,A)}function O1(b,c,h,v,N){if(!h.layout||h.layout.get("fill-elevation-reference")==="none")return;const A=b.context.gl,k=new Cr(b.context.gl.LEQUAL,Cr.ReadWrite,b.depthRangeFor3D),z=new Cr(b.context.gl.GREATER,Cr.ReadWrite,b.depthRangeFor3D),q=function(ie){const de=s.c4(ie.pitch);let le=.01;return ie.isOrthographic&&(le=s.ah(1e-4,le,s.c9(de>=Wt?1:de/Wt))),2*le}(b.transform),K=b.transform.getFreeCameraOptions().position,Y="elevatedStructuresDepthReconstruct",ee=b.getOrCreateProgram(Y,{defines:["DEPTH_RECONSTRUCTION"]}),Q=b.getOrCreateProgram(Y);for(const ie of v){const de=c.getTile(ie),le=de.getBucket(h);if(!le)continue;const he=le.elevatedStructures;if(!he)continue;const fe=le.elevationBufferData.heightRange,Te=I1(ie.toUnwrapped(),K),Re=b.translatePosMatrix(ie.projMatrix,de,h.paint.get("fill-translate"),h.paint.get("fill-translate-anchor"));let Oe,$e,Le,Fe;if(N==="initialize"){if(!fe||fe.min>=1||he.depthSegments.segments[0].primitiveLength===0)continue;Oe=Dg(Re,Te,q,1,0),$e=k,Le=he.depthSegments,Fe=ee}else if(N==="reset"){if(!fe||fe.min>=0||he.maskSegments.segments[0].primitiveLength===0)continue;Oe=Dg(Re,Te,0,0,1),$e=z,Le=he.maskSegments,Fe=ee}else if(N==="geometry"){if(he.depthSegments.segments[0].primitiveLength===0)continue;Oe=Dg(Re,Te,q,1,0),$e=k,Le=he.depthSegments,Fe=Q}Fe.draw(b,A.TRIANGLES,$e,Kr.disabled,mn.disabled,Gr.disabled,Oe,h.id,he.vertexBuffer,he.indexBuffer,Le,h.paint,b.transform.zoom)}}function ly(b,c,h){const{painter:v,sourceCache:N,layer:A,coords:k,colorMode:z,elevationType:q,terrainEnabled:K,pass:Y}=b,ee=v.context.gl,Q=A.paint.get("fill-pattern");let ie=q;q!=="road"||c&&!K||(ie="none");const de=ie==="road",le=new Cr(v.context.gl.LEQUAL,Cr.ReadWrite,v.depthRangeFor3D),he=Q&&Q.constantOr(1),fe=(Te,Re)=>{let Oe,$e,Le,Fe,Be;Re?($e=he&&!A.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",Oe=ee.LINES):($e=he?"fillPattern":"fill",Oe=ee.TRIANGLES);for(const He of k){const Ke=N.getTile(He);if(he&&!Ke.patternsLoaded())continue;const ft=Ke.getBucket(A);if(!ft)continue;const at=c?ft.elevationBufferData:ft.bufferData;if(at.isEmpty())continue;v.prepareDrawTile();const kt=at.programConfigurations.get(A.id),Pt=v.isTileAffectedByFog(He),Bt=[],st=[];de&&(Bt.push("ELEVATED_ROADS"),st.push(at.elevatedLayoutVertexBuffer));const At=v.getOrCreateProgram($e,{config:kt,overrideFog:Pt,defines:Bt});he&&(v.context.activeTexture.set(ee.TEXTURE0),Ke.imageAtlasTexture&&Ke.imageAtlasTexture.bind(ee.LINEAR,ee.CLAMP_TO_EDGE),kt.updatePaintBuffers());const rt=Q.constantOr(null);if(rt&&Ke.imageAtlas){const Et=Ke.imageAtlas,pt=s.d0.from(rt).getPrimary().scaleSelf(s.q.devicePixelRatio).toString(),It=Et.patternPositions.get(pt);It&&kt.setConstantPatternPositions(It)}const Ct=v.translatePosMatrix(He.projMatrix,Ke,A.paint.get("fill-translate"),A.paint.get("fill-translate-anchor")),_t=A.paint.get("fill-emissive-strength");if(Re){Fe=at.lineIndexBuffer,Be=at.lineSegments;const Et=v.terrain&&v.terrain.renderingToTexture?v.terrain.drapeBufferSize:[ee.drawingBufferWidth,ee.drawingBufferHeight];Le=$e==="fillOutlinePattern"&&he?ry(Ct,_t,v,Ke,Et):ty(Ct,_t,Et)}else Fe=at.indexBuffer,Be=at.triangleSegments,Le=he?N1(Ct,_t,v,Ke):mf(Ct,_t);v.uploadCommonUniforms(v.context,At,He.toUnwrapped()),At.draw(v,Oe,ie!=="none"?le:Te,h||v.stencilModeForClipping(He),z,Gr.disabled,Le,A.id,at.layoutVertexBuffer,Fe,Be,A.paint,v.transform.zoom,kt,st)}};v.renderPass===Y&&fe(v.depthModeForSublayer(1,v.renderPass==="opaque"?Cr.ReadWrite:Cr.ReadOnly),!1),ie==="none"&&v.renderPass==="translucent"&&A.paint.get("fill-antialias")&&fe(v.depthModeForSublayer(A.getPaintProperty("fill-outline-color")?2:0,Cr.ReadOnly),!0)}function Lg(b,c,h,v,N,A,k,z){h.resetLayerRenderingStats(b);const q=b.context,K=q.gl,Y=b.transform,ee=h.paint.get("fill-extrusion-pattern"),Q=ee.constantOr(1),ie=h.paint.get("fill-extrusion-opacity"),de=b.style.enable3dLights(),le=h.paint.get(de&&!Q?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),he=[h.paint.get("fill-extrusion-ambient-occlusion-intensity"),le],fe=h.layout.get("fill-extrusion-edge-radius"),Te=fe>0&&!h.paint.get("fill-extrusion-rounded-roof"),Re=Te?0:fe,Oe=Y.projection.name==="globe"?s.d6():0,$e=Y.projection.name==="globe",Le=$e?s.ag(Y.zoom):0,Fe=[s.av(Y.center.lng),s.aC(Y.center.lat)],Be=h.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",He=h.paint.get("fill-extrusion-flood-light-color").toRenderColor(Be?null:h.lut).toArray01().slice(0,3),Ke=h.paint.get("fill-extrusion-flood-light-intensity"),ft=h.paint.get("fill-extrusion-vertical-scale"),at=h.paint.get("fill-extrusion-line-width").constantOr(1)!==0,kt=h.paint.get("fill-extrusion-height-alignment"),Pt=h.paint.get("fill-extrusion-base-alignment"),Bt=Ru(b,h.paint.get("fill-extrusion-cutoff-fade-range")),st=[];let At;$e&&st.push("PROJECTION_GLOBE_VIEW"),he[0]>0&&st.push("FAUX_AO"),Te&&st.push("ZERO_ROOF_RADIUS"),z&&st.push("HAS_CENTROID"),Ke>0&&st.push("FLOOD_LIGHT"),Bt.shouldRenderCutoff&&st.push("RENDER_CUTOFF"),at&&st.push("RENDER_WALL_MODE");const rt=b.renderPass==="shadow",Ct=b.shadowRenderer,_t=rt&&!!Ct;b.shadowRenderer&&(b.shadowRenderer.useNormalOffset=!0);let Et=[0,0,0];if(Ct){const Kt=b.style.directionalLight,Zt=b.style.ambientLight;Kt&&Zt&&(Et=nf(b.style,Kt,Zt)),rt||(st.push("RENDER_SHADOWS","DEPTH_TEXTURE"),Ct.useNormalOffset&&st.push("NORMAL_OFFSET")),At=st.concat(["SHADOWS_SINGLE_CASCADE"])}const pt=_t?"fillExtrusionDepth":Q?"fillExtrusionPattern":"fillExtrusion",It=h.getLayerRenderingStats();for(const Kt of v){const Zt=c.getTile(Kt),Qt=Zt.getBucket(h);if(!Qt||Qt.projection.name!==Y.projection.name)continue;let gr=!1;Ct&&(gr=Ct.getMaxCascadeForTile(Kt.toUnwrapped())===0);const qr=b.isTileAffectedByFog(Kt),Er=Qt.programConfigurations.get(h.id),Br=b.getOrCreateProgram(pt,{config:Er,defines:gr?At:st,overrideFog:qr});if(b.terrain&&b.terrain.setupElevationDraw(Zt,Br,{useMeterToDem:!0}),!Qt.centroidVertexBuffer){const Zr=Br.attributes.a_centroid_pos;Zr!==void 0&&K.vertexAttrib2f(Zr,0,0)}!rt&&Ct&&Ct.setupShadows(Zt.tileID.toUnwrapped(),Br,"vector-tile",Zt.tileID.overscaledZ),Q&&(b.context.activeTexture.set(K.TEXTURE0),Zt.imageAtlasTexture&&Zt.imageAtlasTexture.bind(K.LINEAR,K.CLAMP_TO_EDGE),Er.updatePaintBuffers());const zr=ee.constantOr(null);if(zr&&Zt.imageAtlas){const Zr=Zt.imageAtlas,xr=s.d0.from(zr).getPrimary().scaleSelf(s.q.devicePixelRatio),Nn=Zr.patternPositions.get(xr.toString());Nn&&Er.setConstantPatternPositions(Nn)}const bn=h.paint.get("fill-extrusion-vertical-gradient"),Vn=1/Qt.tileToMeter;let fi;if(rt&&Ct){if(bf(Zt.tileID,Qt,b))continue;const Zr=Ct.calculateShadowPassMatrixFromTile(Zt.tileID.toUnwrapped());fi=hf(Zr,Re,Vn,ft,kt,Pt)}else{const Zr=b.translatePosMatrix(Kt.expandedProjMatrix,Zt,h.paint.get("fill-extrusion-translate"),h.paint.get("fill-extrusion-translate-anchor")),xr=Y.projection.createInversionMatrix(Y,Kt.canonical);fi=Q?j1(Zr,b,bn,ie,he,Re,Vn,Kt,Zt,Oe,kt,Pt,Le,Fe,xr,He,ft):ey(Zr,b,bn,ie,he,Re,Vn,Kt,Oe,kt,Pt,Le,Fe,xr,He,ft,Ke,Et)}b.uploadCommonUniforms(q,Br,Kt.toUnwrapped(),null,Bt);let un=Qt.segments;if(Y.projection.name==="mercator"&&!rt&&(un=Qt.getVisibleSegments(Zt.tileID,b.terrain,b.transform.getFrustum(0)),!un.get().length))continue;if(It)if(rt)for(const Zr of un.get())It.numRenderedVerticesInShadowPass+=Zr.primitiveLength;else for(const Zr of un.get())It.numRenderedVerticesInTransparentPass+=Zr.primitiveLength;const ki=[];(b.terrain||z)&&ki.push(Qt.centroidVertexBuffer),$e&&ki.push(Qt.layoutVertexExtBuffer),at&&ki.push(Qt.wallVertexBuffer),Br.draw(b,q.gl.TRIANGLES,N,A,k,Gr.backCCW,fi,h.id,Qt.layoutVertexBuffer,Qt.indexBuffer,un,h.paint,b.transform.zoom,Er,ki)}b.shadowRenderer&&(b.shadowRenderer.useNormalOffset=!1)}function xf(b,c,h,v,N,A,k,z,q,K,Y,ee,Q,ie,de,le,he,fe,Te){const Re=b.context,Oe=Re.gl,$e=b.transform,Le=b.transform.zoom,Fe=[],Be=Ru(b,h.paint.get("fill-extrusion-cutoff-fade-range"));K==="clear"?(Fe.push("CLEAR_SUBPASS"),Te&&(Fe.push("CLEAR_FROM_TEXTURE"),Re.activeTexture.set(Oe.TEXTURE0),Te.bind(Oe.LINEAR,Oe.CLAMP_TO_EDGE))):K==="sdf"&&Fe.push("SDF_SUBPASS"),he&&Fe.push("HAS_CENTROID"),Be.shouldRenderCutoff&&Fe.push("RENDER_CUTOFF");const He=h.layout.get("fill-extrusion-edge-radius"),Ke=(ft,at,kt,Pt,Bt)=>{const st=at.programConfigurations.get(h.id),At=b.isTileAffectedByFog(ft),rt=b.getOrCreateProgram("fillExtrusionGroundEffect",{config:st,defines:Fe,overrideFog:At}),Ct=((Et,pt,It,Kt,Zt,Qt,gr,qr,Er,Br,zr)=>({u_matrix:pt,u_opacity:It,u_ao_pass:Kt?1:0,u_meter_to_tile:Zt,u_ao:Qt,u_flood_light_intensity:gr,u_flood_light_color:qr,u_attenuation:Er,u_edge_radius:Br,u_fb:0,u_fb_size:zr,u_dynamic_offset:1}))(0,Pt,Y,q,Bt,[ee,Q*Bt],ie,de,le,Le>=17?0:He*Bt,Te?Te.size[0]:0),_t=[];he&&_t.push(at.hiddenByLandmarkVertexBuffer),b.uploadCommonUniforms(Re,rt,ft.toUnwrapped(),null,Be),rt.draw(b,Re.gl.TRIANGLES,N,A,k,z,Ct,h.id,at.vertexBuffer,at.indexBuffer,kt,h.paint,Le,st,_t)};for(const ft of v){const at=c.getTile(ft),kt=at.getBucket(h);if(!kt||kt.projection.name!==$e.projection.name||!kt.groundEffect||kt.groundEffect&&!kt.groundEffect.hasData())continue;const Pt=kt.groundEffect,Bt=1/kt.tileToMeter;{const st=b.translatePosMatrix(ft.projMatrix,at,h.paint.get("fill-extrusion-translate"),h.paint.get("fill-extrusion-translate-anchor")),At=Pt.getDefaultSegment();Ke(ft,Pt,At,st,Bt)}if(fe)for(let st=0;st<4;st++){const At=s.d7[st](ft),rt=c.getTile(At);if(!rt)continue;const Ct=rt.getBucket(h);if(!Ct||Ct.projection.name!==$e.projection.name||!Ct.groundEffect||Ct.groundEffect&&!Ct.groundEffect.hasData())continue;const _t=Ct.groundEffect;let Et,pt;st===0?(Et=[-s.ai,0,0],pt=1):st===1?(Et=[s.ai,0,0],pt=0):st===2?(Et=[0,-s.ai,0],pt=3):(Et=[0,s.ai,0],pt=2);const It=_t.regionSegments[pt];if(!It)continue;const Kt=new Float32Array(16);s.ad.mat4.translate(Kt,ft.projMatrix,Et),Ke(ft,_t,It,b.translatePosMatrix(Kt,at,h.paint.get("fill-extrusion-translate"),h.paint.get("fill-extrusion-translate-anchor")),Bt)}}}function yf(b,c,h,v,N,A,k){v.centroidVertexArray.length===0&&v.createCentroidsBuffer();const z=A?A.findDEMTileFor(h):null;if(!(z&&z.dem||k))return;A&&z&&z.dem&&v.selfDEMTileTimestamp!==z.dem._timestamp&&(v.borderDoneWithNeighborZ=[-1,-1,-1,-1],v.selfDEMTileTimestamp=z.dem._timestamp);const q=fe=>new s.P(Math.ceil((fe+s.da)*s.db),0),K=fe=>{const Te=c.getSource().minzoom,Re=$e=>{const Le=c.getTileByID($e);if(Le&&Le.hasData())return Le.getBucket(N)},Oe=[0,-1,1];for(const $e of Oe){if(fe.overscaledZ+$e<Te)continue;const Le=Re(fe.calculateScaledKey(fe.overscaledZ+$e));if(Le)return Le}},Y=[0,0,0],ee=(fe,Te)=>(Y[0]=Math.min(fe.min.y,Te.min.y),Y[1]=Math.max(fe.max.y,Te.max.y),Y[2]=s.ai-Te.min.x>fe.max.x?Te.min.x-s.ai:fe.max.x,Y),Q=(fe,Te)=>(Y[0]=Math.min(fe.min.x,Te.min.x),Y[1]=Math.max(fe.max.x,Te.max.x),Y[2]=s.ai-Te.min.y>fe.max.y?Te.min.y-s.ai:fe.max.y,Y),ie=[(fe,Te)=>ee(fe,Te),(fe,Te)=>ee(Te,fe),(fe,Te)=>Q(fe,Te),(fe,Te)=>Q(Te,fe)],de=(fe,Te,Re,Oe,$e,Le,Fe)=>{if(!A)return 0;const Be=[[Le?Re:fe,Le?fe:Re,0],[Le?Re:Te,Le?Te:Re,0]],He=Fe<0?s.ai+Fe:Fe,Ke=[Le?He:(fe+Te)/2,Le?(fe+Te)/2:He,0];return Re===0&&Fe<0||Re!==0&&Fe>0?A.getForTilePoints($e,[Ke],!0,Oe):Be.push(Ke),A.getForTilePoints(h,Be,!0,z),Math.max(Be[0][2],Be[1][2],Ke[2])/A.exaggeration()};for(let fe=0;fe<4;fe++){const Te=v.borderFeatureIndices[fe];if(Te.length===0)continue;const Re=s.d7[fe](h),Oe=K(Re);if(!(Oe&&Oe instanceof s.d8))continue;const $e=A?A.findDEMTileFor(Re):null;if(!($e&&$e.dem||k)||(A&&$e&&$e.dem&&v.borderDEMTileTimestamp[fe]!==$e.dem._timestamp&&(v.borderDoneWithNeighborZ[fe]=-1,v.borderDEMTileTimestamp[fe]=$e.dem._timestamp),v.borderDoneWithNeighborZ[fe]===Oe.canonical.z))continue;Oe.centroidVertexArray.length===0&&Oe.createCentroidsBuffer();const Le=(fe<2?1:5)-fe,Fe=Oe.borderDoneWithNeighborZ[Le]!==v.canonical.z,Be=Oe.borderFeatureIndices[Le];let He=0;if(v.canonical.z!==Oe.canonical.z){for(const Ke of Te)v.showCentroid(v.featuresOnBorder[Ke]);if(Fe)for(const Ke of Be)Oe.showCentroid(Oe.featuresOnBorder[Ke]);v.borderDoneWithNeighborZ[fe]=Oe.canonical.z,Oe.borderDoneWithNeighborZ[Le]=v.canonical.z}for(const Ke of Te){const ft=v.featuresOnBorder[Ke],at=v.centroidData[ft.centroidDataIndex],kt=ft.borders[fe];let Pt;for(;He<Be.length;){Pt=Oe.featuresOnBorder[Be[He]];const Bt=Pt.borders[Le];if(Bt[1]>kt[0]+3||Bt[0]>kt[0]-3)break;Oe.showCentroid(Pt),He++}if(Pt&&He<Be.length){const Bt=He;let st=0;for(;!(Pt.borders[Le][0]>kt[1]-3)&&(st++,++He!==Be.length);)Pt=Oe.featuresOnBorder[Be[He]];Pt=Oe.featuresOnBorder[Be[Bt]];let At=!1;if(st>=1){const _t=Pt.borders[Le];Math.abs(kt[0]-_t[0])<3&&Math.abs(kt[1]-_t[1])<3&&(st=1,At=!0,He=Bt+1)}else if(st===0){v.showCentroid(ft);continue}const rt=Oe.centroidData[Pt.centroidDataIndex];k&&At&&(((le=at).flags|(he=rt).flags)&s.d9?(le.flags|=s.d9,he.flags|=s.d9):(le.flags&=~s.d9,he.flags&=~s.d9));const Ct=ft.intersectsCount()>1||Pt.intersectsCount()>1;if(st>1)He=Bt,at.centroidXY=rt.centroidXY=new s.P(0,0);else if($e&&$e.dem&&!Ct){const _t=ie[fe](at,rt),Et=fe%2?s.ai-1:0,pt=de(_t[0],Math.min(s.ai-1,_t[1]),Et,$e,Re,fe<2,_t[2]);at.centroidXY=rt.centroidXY=q(pt)}else Ct?at.centroidXY=rt.centroidXY=new s.P(0,0):(at.centroidXY=v.encodeBorderCentroid(ft),rt.centroidXY=Oe.encodeBorderCentroid(Pt));v.writeCentroidToBuffer(at),Oe.writeCentroidToBuffer(rt)}else v.showCentroid(ft)}v.borderDoneWithNeighborZ[fe]=Oe.canonical.z,Oe.borderDoneWithNeighborZ[Le]=v.canonical.z}var le,he;(v.needsCentroidUpdate||!v.centroidVertexBuffer&&v.centroidVertexArray.length!==0)&&v.uploadCentroid(b)}const vf=[1,0,0],Vt=[0,1,0],ar=[0,0,1];function bf(b,c,h){const v=h.transform,N=h.shadowRenderer;if(!N)return!0;const A=b.toUnwrapped(),k=v.tileSize*N._cascades[h.currentShadowCascade].scale;let z=c.maxHeight;if(v.elevation){const le=v.elevation.getMinMaxForTile(b);le&&(z+=le.max)}const q=[...N.shadowDirection];q[2]=-q[2];const K=N.computeSimplifiedTileShadowVolume(A,z,k,q);if(!K)return!1;const Y=[vf,Vt,ar,q,[q[0],0,q[2]],[0,q[1],q[2]]],ee=v.projection.name==="globe",Q=v.scaleZoom(k),ie=s.bR.fromInvProjectionMatrix(v.invProjMatrix,v.worldSize,Q,!ee),de=N.getCurrentCascadeFrustum();return ie.intersectsPrecise(K.vertices,K.planes,Y)===0||de.intersectsPrecise(K.vertices,K.planes,Y)===0}function Ki(b){return[b[0]*s.dc,b[1]*s.dc,b[2]*s.dc,0]}function ut(b,c,h,v,N,A,k,z,q){const K=v.getSource(),Y=h.globeSharedBuffers;if(!Y)return;let ee,Q,ie;if(c&&(ee=v.getTile(c)),K instanceof s.aK?(Q=K.texture,ie=s.cJ(0,0,h.transform)):ee&&c&&(Q=ee.texture,ie=s.cJ(c.canonical.z,c.canonical.x,h.transform)),!Q||!ie)return;b||(ie=s.ad.mat4.scale(s.ad.mat4.create(),ie,[1,-1,1]));const de=h.context,le=de.gl,he=N.paint.get("raster-resampling")==="nearest"?le.NEAREST:le.LINEAR,fe=h.colorModeForDrapableLayerRenderPass(A),Te=k.defines;Te.push("GLOBE_POLES");const Re=new Cr(le.LEQUAL,Cr.ReadWrite,h.depthRangeFor3D),Oe=Float32Array.from(h.transform.expandedFarZProjMatrix),$e=Float32Array.from(s.bc(s.cI(new s.bT(0,0,0))));h.terrain&&h.terrain.prepareDrawTile(),de.activeTexture.set(le.TEXTURE0),Q.bind(he,le.CLAMP_TO_EDGE),de.activeTexture.set(le.TEXTURE1),Q.bind(he,le.CLAMP_TO_EDGE),"useMipmap"in Q&&de.extTextureFilterAnisotropic&&h.transform.pitch>20&&le.texParameterf(le.TEXTURE_2D,de.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,de.extTextureFilterAnisotropicMax);const[Le,Fe,Be,He]=c?Y.getPoleBuffers(c.canonical.z,!1):Y.getPoleBuffers(0,!0),Ke=N.paint.get("raster-elevation");let ft;b?(ft=Le,h.renderDefaultNorthPole=Ke!==0):(ft=Fe,h.renderDefaultSouthPole=Ke!==0);const at=Ki(k.mix),kt=((Bt,st,At,rt,Ct,_t,Et,pt,It,Kt,Zt,Qt,gr)=>C1(Bt,st,At,new Float32Array(16),new Float32Array(9),[0,0],rt,[0,0],[0,0,0,0],1,{opacity:1,mix:0},_t,[0,0],pt,2,Kt,Zt,Qt,1,0,gr))(Oe,$e,ie,s.ag(h.transform.zoom),0,N,0,Ke,0,at,k.offset,k.range,A),Pt=h.getOrCreateProgram("raster",{defines:Te});h.uploadCommonUniforms(de,Pt,null),Pt.draw(h,le.TRIANGLES,Re,q,fe,z,kt,N.id,ft,Be,He)}function rC(b){const c=b._nearZ,h=b.projection.farthestPixelDistance(b),v=h-c,N=.2*b.height,A=c+N;return[c,h,(A-N-c)/v,(A-c)/v]}function cy(b,c,h,v){if(b)return c instanceof Rl&&b instanceof vo?c.getTextureDescriptor(b,h,!0):{texture:b.texture,mix:Ki(v.mix),offset:v.offset,buffer:0,tileSize:1}}var R1=s.dd([{name:"a_index",type:"Int16",components:1}]);class D1{constructor(c,h,v,N){const A={width:v[0],height:v[1],data:null},k=c.gl;this.targetColorTexture=new s.T(c,A,k.RGBA8,{useMipmap:!1}),this.backgroundColorTexture=new s.T(c,A,k.RGBA8,{useMipmap:!1}),this.context=c,this.updateParticleTexture(h,N),this.lastInvalidatedAt=0}updateParticleTexture(c,h){if(this.particleTextureDimension===h.width)return;(this.particleTexture0||this.particleTexture1||this.particleIndexBuffer||this.particleSegment)&&(this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleIndexBuffer.destroy(),this.particleSegment.destroy());const v=this.context.gl,N=h.width*h.height;this.particleTexture0=new s.T(this.context,h,v.RGBA8,{premultiply:!1,useMipmap:!1}),this.particleTexture1=new s.T(this.context,h,v.RGBA8,{premultiply:!1,useMipmap:!1});const A=new s.de;A.reserve(N);for(let k=0;k<N;k++)A.emplaceBack(k);this.particleIndexBuffer=this.context.createVertexBuffer(A,R1.members,!0),this.particleSegment=s.b8.simpleSegment(0,0,this.particleIndexBuffer.length,0),this.particleTextureDimension=h.width}update(c){return!(this.lastInvalidatedAt<c&&(this.lastInvalidatedAt=s.q.now(),1))}destroy(){this.targetColorTexture.destroy(),this.backgroundColorTexture.destroy(),this.particleIndexBuffer.destroy(),this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleSegment.destroy()}}function nC(b,c,h){if(!b)return null;const v=c.getTextureDescriptor(b,h,!0);if(!v)return null;let{texture:N,mix:A,offset:k,tileSize:z,buffer:q,format:K}=v;if(!N||!K)return null;let Y=!1;return K==="uint32"&&(Y=!0,A[3]=0,A=lr(s.df,A,[0,h.paint.get("raster-particle-max-speed")]),k=S1(s.df,k,[0,h.paint.get("raster-particle-max-speed")])),{texture:N,textureOffset:[q/(z+2*q),z/(z+2*q)],tileSize:z,scalarData:Y,scale:A,offset:k,defines:["RASTER_ARRAY",{uint8:"DATA_FORMAT_UINT8",uint16:"DATA_FORMAT_UINT16",uint32:"DATA_FORMAT_UINT32"}[K]]}}function iC(b){const c=b._nearZ,h=b.projection.farthestPixelDistance(b),v=h-c,N=.2*b.height,A=c+N;return[c,h,(A-N-c)/v,(A-c)/v]}const _f=new s.al(1,0,0,1),a4=new s.al(0,1,0,1),o4=new s.al(0,0,1,1),sC=new s.al(1,0,1,1),uy=new s.al(0,1,1,1);function Bd(b,c,h,v,N,A,k){const z=b.context,q=b.transform,K=z.gl,Y=q.projection.name==="globe",ee=Y?["PROJECTION_GLOBE_VIEW"]:[];let Q=s.ad.mat4.clone(h.projMatrix);if(Y&&s.ag(q.zoom)>0){const at=s.bb(h.canonical,q),kt=s.dg(at);Q=s.ad.mat4.multiply(new Float32Array(16),q.globeMatrix,kt),s.ad.mat4.multiply(Q,q.projMatrix,Q)}const ie=s.ad.mat4.create();ie[12]+=2*N/(s.q.devicePixelRatio*q.width),ie[13]+=2*A/(s.q.devicePixelRatio*q.height),s.ad.mat4.multiply(Q,ie,Q);const de=b.getOrCreateProgram("debug",{defines:ee}),le=c.getTileByID(h.key);b.terrain&&b.terrain.setupElevationDraw(le,de);const he=Cr.disabled,fe=Kr.disabled,Te=b.colorModeForRenderPass(),Re="$debug";z.activeTexture.set(K.TEXTURE0),b.emptyTexture.bind(K.LINEAR,K.CLAMP_TO_EDGE),Y?le._makeGlobeTileDebugBuffers(b.context,q):le._makeDebugTileBoundsBuffers(b.context,q.projection);const Oe=le._tileDebugBuffer||b.debugBuffer,$e=le._tileDebugIndexBuffer||b.debugIndexBuffer,Le=le._tileDebugSegments||b.debugSegments;if(de.draw(b,K.LINE_STRIP,he,fe,Te,Gr.disabled,XS(Q,v),Re,Oe,$e,Le,null,null,null,[le._globeTileDebugBorderBuffer]),k){const at=le.latestRawTileData,kt=Math.floor((at&&at.byteLength||0)/1024);let Pt=h.canonical.toString();h.overscaledZ!==h.canonical.z&&(Pt+=` => ${h.overscaledZ}`),Pt+=` ${le.state}`,Pt+=` ${kt}kb`,function(Bt,st){Bt.initDebugOverlayCanvas();const At=Bt.debugOverlayCanvas,rt=Bt.context.gl,Ct=Bt.debugOverlayCanvas.getContext("2d");Ct.clearRect(0,0,At.width,At.height),Ct.shadowColor="white",Ct.shadowBlur=2,Ct.lineWidth=1.5,Ct.strokeStyle="white",Ct.textBaseline="top",Ct.font="bold 36px Open Sans, sans-serif",Ct.fillText(st,5,5),Ct.strokeText(st,5,5),Bt.debugOverlayTexture.update(At),Bt.debugOverlayTexture.bind(rt.LINEAR,rt.CLAMP_TO_EDGE)}(b,Pt)}const Fe=c.getTile(h).tileSize,Be=512/Math.min(Fe,512)*(h.overscaledZ/q.zoom)*.5,He=le._tileDebugTextBuffer||b.debugBuffer,Ke=le._tileDebugTextIndexBuffer||b.quadTriangleIndexBuffer,ft=le._tileDebugTextSegments||b.debugSegments;de.draw(b,K.TRIANGLES,he,fe,mn.alphaBlended,Gr.disabled,XS(Q,s.al.transparent,Be),Re,He,Ke,ft,null,null,null,[le._globeTileDebugTextBuffer])}function z1(b,c,h,v){Uh(b,0,c+h/2,b.transform.width,h,v)}function L1(b,c,h,v){Uh(b,c-h/2,0,h,b.transform.height,v)}function Uh(b,c,h,v,N,A){const k=b.context,z=k.gl;z.enable(z.SCISSOR_TEST),z.scissor(c*s.q.devicePixelRatio,h*s.q.devicePixelRatio,v*s.q.devicePixelRatio,N*s.q.devicePixelRatio),k.clear({color:A}),z.disable(z.SCISSOR_TEST)}const dy=s.dd([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:wf}=dy;function Fu(b,c,h,v){b.emplaceBack(c,h,v)}class aC{constructor(c){this.vertexArray=new s.dh,this.indices=new s.aV,Fu(this.vertexArray,-1,-1,1),Fu(this.vertexArray,1,-1,1),Fu(this.vertexArray,-1,1,1),Fu(this.vertexArray,1,1,1),Fu(this.vertexArray,-1,-1,-1),Fu(this.vertexArray,1,-1,-1),Fu(this.vertexArray,-1,1,-1),Fu(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=c.createVertexBuffer(this.vertexArray,wf),this.indexBuffer=c.createIndexBuffer(this.indices),this.segment=s.b8.simpleSegment(0,0,36,12)}}function ua(b,c,h,v,N,A){const k=b.context.gl,z=c.paint.get("sky-atmosphere-color"),q=c.paint.get("sky-atmosphere-halo-color"),K=c.paint.get("sky-atmosphere-sun-intensity"),Y=((ee,Q,ie,de,le)=>({u_matrix_3f:ee,u_sun_direction:Q,u_sun_intensity:ie,u_color_tint_r:[de.r,de.g,de.b,de.a],u_color_tint_m:[le.r,le.g,le.b,le.a],u_luminance:5e-5}))(s.ad.mat3.fromMat4(s.ad.mat3.create(),v),N,K,z,q);k.framebufferTexture2D(k.FRAMEBUFFER,k.COLOR_ATTACHMENT0,k.TEXTURE_CUBE_MAP_POSITIVE_X+A,c.skyboxTexture,0),h.draw(b,k.TRIANGLES,Cr.disabled,Kr.disabled,mn.unblended,Gr.frontCW,Y,"skyboxCapture",c.skyboxGeometry.vertexBuffer,c.skyboxGeometry.indexBuffer,c.skyboxGeometry.segment)}const l4=s.dd([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class Fg{constructor(c){const h=new s.di;h.emplaceBack(-1,1,1,0,0),h.emplaceBack(1,1,1,1,0),h.emplaceBack(1,-1,1,1,1),h.emplaceBack(-1,-1,1,0,1);const v=new s.aV;v.emplaceBack(0,1,2),v.emplaceBack(2,3,0),this.vertexBuffer=c.createVertexBuffer(h,l4.members),this.indexBuffer=c.createIndexBuffer(v),this.segments=s.b8.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const xi=s.dd([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class Bn{constructor(){this.starsCount=16e3,this.sizeMultiplier=.15,this.sizeRange=100,this.intensityRange=200}}class oC{constructor(c){this.colorModeAlphaBlendedWriteRGB=new mn([1,Rd,1,Rd],s.al.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new mn([1,0,1,0],s.al.transparent,[!1,!1,!1,!0]),this.params=new Bn,this.updateNeeded=!0,c.tp.registerParameter(this.params,["Stars"],"starsCount",{min:100,max:16e3,step:1},()=>{this.updateNeeded=!0}),c.tp.registerParameter(this.params,["Stars"],"sizeMultiplier",{min:.01,max:2,step:.01}),c.tp.registerParameter(this.params,["Stars"],"sizeRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0}),c.tp.registerParameter(this.params,["Stars"],"intensityRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0})}update(c){const h=c.context;if(!this.atmosphereBuffer||this.updateNeeded){this.updateNeeded=!1,this.atmosphereBuffer=new Fg(h);const v=this.params.sizeRange,N=this.params.intensityRange,A=function(Y){const ee=s.dl(30),Q=[];for(let ie=0;ie<Y;++ie){const de=2*Math.PI*ee(),le=Math.acos(1-2*ee())-.5*Math.PI;Q.push(s.ad.vec3.fromValues(Math.cos(le)*Math.cos(de),Math.cos(le)*Math.sin(de),Math.sin(le)))}return Q}(this.params.starsCount),k=s.dl(300),z=new s.dj,q=new s.aV;let K=0;for(let Y=0;Y<A.length;++Y){const ee=s.ad.vec3.scale([],A[Y],200),Q=Math.max(0,1+.01*v*(1*k()-.5)),ie=Math.max(0,1+.01*N*(1*k()-.5));z.emplaceBack(ee[0],ee[1],ee[2],-1,-1,Q,ie),z.emplaceBack(ee[0],ee[1],ee[2],1,-1,Q,ie),z.emplaceBack(ee[0],ee[1],ee[2],1,1,Q,ie),z.emplaceBack(ee[0],ee[1],ee[2],-1,1,Q,ie),q.emplaceBack(K+0,K+1,K+2),q.emplaceBack(K+0,K+2,K+3),K+=4}this.starsVx=h.createVertexBuffer(z,xi.members),this.starsIdx=h.createIndexBuffer(q),this.starsSegments=s.b8.simpleSegment(0,0,z.length,q.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(c,h){const v=c.context,N=v.gl,A=c.transform,k=new Cr(N.LEQUAL,Cr.ReadOnly,[0,1]),z=s.ag(A.zoom),q=c.style.getLut(h.scope),K=h.properties.get("color-use-theme")==="none",Y=h.properties.get("color").toRenderColor(K?null:q).toArray01(),ee=h.properties.get("high-color-use-theme")==="none",Q=h.properties.get("high-color").toRenderColor(ee?null:q).toArray01(),ie=h.properties.get("space-color-use-theme")==="none",de=h.properties.get("space-color").toRenderColor(ie?null:q).toArray01PremultipliedAlpha(),le=5e-4,he=s.dk(h.properties.get("horizon-blend"),0,1,le,.25),fe=s.cD(c,v,A)&&he===le?A.worldSize/(2*Math.PI*1.025)-1:A.globeRadius,Te=c.frameCounter/1e3%1,Re=s.ad.vec3.length(A.globeCenterInViewSpace),Oe=Math.sqrt(Math.pow(Re,2)-Math.pow(fe,2)),$e=Math.acos(Oe/Re),Le=Fe=>{const Be=A.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];Fe&&Be.push("ALPHA_PASS");const He=c.getOrCreateProgram("globeAtmosphere",{defines:Be}),Ke=((at,kt,Pt,Bt,st,At,rt,Ct,_t,Et,pt,It)=>({u_frustum_tl:at,u_frustum_tr:kt,u_frustum_br:Pt,u_frustum_bl:Bt,u_horizon:st,u_transition:At,u_fadeout_range:rt,u_color:Ct,u_high_color:_t,u_space_color:Et,u_temporal_offset:pt,u_horizon_angle:It}))(A.frustumCorners.TL,A.frustumCorners.TR,A.frustumCorners.BR,A.frustumCorners.BL,A.frustumCorners.horizon,z,he,Y,Q,de,Te,$e);c.uploadCommonUniforms(v,He);const ft=this.atmosphereBuffer;ft&&He.draw(c,N.TRIANGLES,k,Kr.disabled,Fe?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,Gr.backCW,Ke,Fe?"atmosphere_glow_alpha":"atmosphere_glow",ft.vertexBuffer,ft.indexBuffer,ft.segments)};Le(!1),Le(!0)}drawStars(c,h){const v=s.ay(h.properties.get("star-intensity"),0,1);if(v===0)return;const N=c.context,A=N.gl,k=c.transform,z=c.getOrCreateProgram("stars"),q=s.ad.quat.identity([]);s.ad.quat.rotateX(q,q,-k._pitch),s.ad.quat.rotateZ(q,q,-k.angle),s.ad.quat.rotateX(q,q,s.ak(k._center.lat)),s.ad.quat.rotateY(q,q,-s.ak(k._center.lng));const K=s.ad.mat4.fromQuat(new Float32Array(16),q),Y=s.ad.mat4.multiply([],k.starsProjMatrix,K),ee=s.ad.mat3.fromMat4([],K),Q=s.ad.mat3.invert([],ee),ie=[0,1,0];s.ad.vec3.transformMat3(ie,ie,Q),s.ad.vec3.scale(ie,ie,this.params.sizeMultiplier);const de=[1,0,0];s.ad.vec3.transformMat3(de,de,Q),s.ad.vec3.scale(de,de,this.params.sizeMultiplier);const le=(he=ie,fe=de,Te=v,{u_matrix:Float32Array.from(Y),u_up:he,u_right:fe,u_intensity_multiplier:Te});var he,fe,Te;c.uploadCommonUniforms(N,z),this.starsVx&&this.starsIdx&&z.draw(c,A.TRIANGLES,Cr.disabled,Kr.disabled,this.colorModeAlphaBlendedWriteRGB,Gr.disabled,le,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}function Bu(b,c){const h=[...b],v=c.cameraWorldSizeForFog/c.worldSize,N=s.ad.mat4.identity([]);return s.ad.mat4.scale(N,N,[v,v,1]),s.ad.mat4.multiply(h,N,h),s.ad.mat4.multiply(h,c.worldToFogMatrix,h),h}function jf(b,c,h,v,N){const A=h.material,k=v.context,{baseColorTexture:z,metallicRoughnessTexture:q}=A.pbrMetallicRoughness,{normalTexture:K,occlusionTexture:Y,emissionTexture:ee}=A;function Q(de,le,he){if(de&&(b.push(le),k.activeTexture.set(k.gl.TEXTURE0+he),de.gfxTexture)){const{minFilter:fe,magFilter:Te,wrapS:Re,wrapT:Oe}=de.sampler;de.gfxTexture.bindExtraParam(fe,Te,Re,Oe)}}Q(z,"HAS_TEXTURE_u_baseColorTexture",ss.BaseColor),Q(q,"HAS_TEXTURE_u_metallicRoughnessTexture",ss.MetallicRoughness),Q(K,"HAS_TEXTURE_u_normalTexture",ss.Normal),Q(Y,"HAS_TEXTURE_u_occlusionTexture",ss.Occlusion),Q(ee,"HAS_TEXTURE_u_emissionTexture",ss.Emission),N&&(N.texture||(N.texture=new s.dn(v.context,N.image,[N.image.height,N.image.height,N.image.height],k.gl.RGBA8)),k.activeTexture.set(k.gl.TEXTURE0+ss.LUT),N.texture&&N.texture.bind(k.gl.LINEAR,k.gl.CLAMP_TO_EDGE),b.push("APPLY_LUT_ON_GPU")),h.texcoordBuffer&&(b.push("HAS_ATTRIBUTE_a_uv_2f"),c.push(h.texcoordBuffer)),h.colorBuffer&&(b.push(h.colorBuffer.itemSize===12?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),c.push(h.colorBuffer)),h.normalBuffer&&(b.push("HAS_ATTRIBUTE_a_normal_3f"),c.push(h.normalBuffer)),h.pbrBuffer&&(b.push("HAS_ATTRIBUTE_a_pbr"),b.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),c.push(h.pbrBuffer)),A.alphaMode!=="OPAQUE"&&A.alphaMode!=="MASK"||b.push("UNPREMULT_TEXTURE_IN_SHADER"),A.defined||b.push("DIFFUSE_SHADED");const ie=v.shadowRenderer;ie&&(b.push("RENDER_SHADOWS","DEPTH_TEXTURE"),ie.useNormalOffset&&b.push("NORMAL_OFFSET"))}function $u(b,c,h,v,N,A){const k=h.paint.get("model-opacity").constantOr(1),z=c.context,q=new Cr(c.context.gl.LEQUAL,Cr.ReadWrite,c.depthRangeFor3D),K=c.transform,Y=b.mesh,ee=Y.material,Q=ee.pbrMetallicRoughness,ie=c.style.fog;let de;de=c.transform.projection.zAxisUnit==="pixels"?[...b.nodeModelMatrix]:s.ad.mat4.multiply([],v.zScaleMatrix,b.nodeModelMatrix),s.ad.mat4.multiply(de,v.negCameraPosMatrix,de);const le=s.ad.mat4.invert([],de);s.ad.mat4.transpose(le,le);const he=h.paint.get("model-color-use-theme").constantOr("default")==="none",fe=h.paint.get("model-emissive-strength").constantOr(0),Te=k1(new Float32Array(b.worldViewProjection),new Float32Array(de),new Float32Array(le),null,c,k,Q.baseColorFactor.toRenderColor(null),ee.emissiveFactor,Q.metallicFactor,Q.roughnessFactor,ee,fe,h),Re={defines:[]},Oe=[],$e=c.shadowRenderer;$e&&($e.useNormalOffset=!1),jf(Re.defines,Oe,Y,c,he?null:h.lut);let Le=null;if(ie){const He=Bu(b.nodeModelMatrix,c.transform);if(Le=new Float32Array(He),K.projection.name!=="globe"){const Ke=Y.aabb.min,ft=Y.aabb.max,[at,kt]=ie.getOpacityForBounds(He,Ke[0],Ke[1],ft[0],ft[1]);Re.overrideFog=at>=nr||kt>=nr}}const Fe=Ru(c,h.paint.get("model-cutoff-fade-range"));Fe.shouldRenderCutoff&&Re.defines.push("RENDER_CUTOFF");const Be=c.getOrCreateProgram("model",Re);c.uploadCommonUniforms(z,Be,null,Le,Fe),c.renderPass!=="shadow"&&$e&&$e.setupShadowsFromMatrix(b.nodeModelMatrix,Be),Be.draw(c,z.gl.TRIANGLES,q,N,A,Y.material.doubleSided?Gr.disabled:Gr.backCCW,Te,h.id,Y.vertexBuffer,Y.indexBuffer,Y.segments,h.paint,c.transform.zoom,void 0,Oe)}function Gh(b,c,h,v,N,A,k){let z;z=b.projection.name==="globe"?s.dp(h,b):[...h],s.ad.mat4.multiply(z,z,c.matrix);const q=s.ad.mat4.multiply([],v,z);if(c.meshes)for(const K of c.meshes){if(K.material.alphaMode!=="BLEND"){k.push({mesh:K,depth:0,modelIndex:N,worldViewProjection:q,nodeModelMatrix:z});continue}const Y=s.ad.vec3.transformMat4([],K.centroid,q);!b.isOrthographic&&Y[2]<=0||A.push({mesh:K,depth:Y[2],modelIndex:N,worldViewProjection:q,nodeModelMatrix:z})}if(c.children)for(const K of c.children)Gh(b,K,h,v,N,A,k)}function Bg(b,c,h,v){const N=h.shadowRenderer;if(!N)return;const A=N.getShadowPassDepthMode(),k=N.getShadowPassColorMode(),z=N.calculateShadowPassMatrixFromMatrix(c),q=eC(z);h.getOrCreateProgram("modelDepth",{defines:h._shadowMapDebug?[]:["DEPTH_TEXTURE"]}).draw(h,h.context.gl.TRIANGLES,A,Kr.disabled,k,Gr.backCCW,q,v.id,b.vertexBuffer,b.indexBuffer,b.segments,v.paint,h.transform.zoom,void 0,void 0)}function F1(b,c,h){const v=c.updateZoomBasedPaintProperties(),N=function(A,k,z){let q,K,Y,ee=A.terrain?A.terrain.exaggeration():0;if(A.terrain&&ee>0){const Q=A.terrain,ie=Q.findDEMTileFor(z);ie&&ie.dem?q=s.dr.create(Q,z,ie):ee=0}if(ee===0&&(k.terrainElevationMin=0,k.terrainElevationMax=0),ee===k.validForExaggeration&&(ee===0||q&&q._demTile&&q._demTile.tileID===k.validForDEMTile.id&&q._dem._timestamp===k.validForDEMTile.timestamp))return!1;for(const Q in k.instancesPerModel){const ie=k.instancesPerModel[Q];for(let de=0;de<ie.instancedDataArray.length;++de){const le=(q?ee*q.getElevationAt(0|ie.instancedDataArray.float32[16*de],0|ie.instancedDataArray.float32[16*de+1],!0,!0):0)+ie.instancesEvaluatedElevation[de];ie.instancedDataArray.float32[16*de+6]=le,K=K?Math.min(k.terrainElevationMin,le):le,Y=Y?Math.max(k.terrainElevationMax,le):le}}return k.terrainElevationMin=K||0,k.terrainElevationMax=Y||0,k.validForExaggeration=ee,k.validForDEMTile=q&&q._demTile?{id:q._demTile.tileID,timestamp:q._dem._timestamp}:{id:void 0,timestamp:0},!0}(b,c,h);(v||N)&&(c.uploaded=!1,c.upload(b.context))}const Bl={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new s.ce([0,0,0],[s.ai,s.ai,0])};function B1(b,c){const h=1<<b.canonical.z,v=c.getFreeCameraOptions().position,N=c.elevation,A=b.canonical.x/h,k=(b.canonical.x+1)/h,z=b.canonical.y/h,q=(b.canonical.y+1)/h;let K=c._centerAltitude;if(N){const ie=N.getMinMaxForTile(b);ie&&ie.max>K&&(K=ie.max)}const Y=s.ay(v.x,A,k)-v.x,ee=s.ay(v.y,z,q)-v.y,Q=s.bH(K,c.center.lat)-v.z;return c._zoomFromMercatorZ(Math.sqrt(Y*Y+ee*ee+Q*Q))}function hc(b,c,h,v,N,A,k){const z=b.context,q=b.renderPass==="shadow",K=b.shadowRenderer,Y=q&&K?K.getShadowPassDepthMode():new Cr(z.gl.LEQUAL,Cr.ReadWrite,b.depthRangeFor3D),ee=b.isTileAffectedByFog(A);if(h.meshes)for(const Q of h.meshes){const ie=["MODEL_POSITION_ON_GPU"],de=[];let le,he,fe;v.instancedDataArray.length>20&&ie.push("INSTANCED_ARRAYS");const Te=Ru(b,c.paint.get("model-cutoff-fade-range"));if(Te.shouldRenderCutoff&&ie.push("RENDER_CUTOFF"),q&&K)le=b.getOrCreateProgram("modelDepth",{defines:ie}),he=eC(k.shadowTileMatrix,k.shadowTileMatrix,Float32Array.from(h.matrix)),fe=K.getShadowPassColorMode();else{jf(ie,de,Q,b,c.paint.get("model-color-use-theme").constantOr("default")==="none"?null:c.lut),le=b.getOrCreateProgram("model",{defines:ie,overrideFog:ee});const Oe=Q.material,$e=Oe.pbrMetallicRoughness,Le=c.paint.get("model-opacity").constantOr(1),Fe=c.paint.get("model-emissive-strength").constantOr(0);he=k1(A.expandedProjMatrix,Float32Array.from(h.matrix),new Float32Array(16),null,b,Le,$e.baseColorFactor.toRenderColor(null),Oe.emissiveFactor,$e.metallicFactor,$e.roughnessFactor,Oe,Fe,c,N),K&&(k.shadowUniformsInitialized?le.setShadowUniformValues(z,K.getShadowUniformValues()):(K.setupShadows(A.toUnwrapped(),le,"model-tile",A.overscaledZ),k.shadowUniformsInitialized=!0)),fe=Te.shouldRenderCutoff||Le<1||Oe.alphaMode!=="OPAQUE"?mn.alphaBlended:mn.unblended}b.uploadCommonUniforms(z,le,A.toUnwrapped(),null,Te);const Re=Q.material.doubleSided?Gr.disabled:Gr.backCCW;if(v.instancedDataArray.length>20)de.push(v.instancedDataBuffer),le.draw(b,z.gl.TRIANGLES,Y,Kr.disabled,fe,Re,he,c.id,Q.vertexBuffer,Q.indexBuffer,Q.segments,c.paint,b.transform.zoom,void 0,de,v.instancedDataArray.length);else{const Oe=q?"u_instance":"u_normal_matrix";for(let $e=0;$e<v.instancedDataArray.length;++$e)he[Oe]=new Float32Array(v.instancedDataArray.arrayBuffer,64*$e,16),le.draw(b,z.gl.TRIANGLES,Y,Kr.disabled,fe,Re,he,c.id,Q.vertexBuffer,Q.indexBuffer,Q.segments,c.paint,b.transform.zoom,void 0,de)}}if(h.children)for(const Q of h.children)hc(b,c,Q,v,N,A,k)}const $d=[1,-1,1];function hy(b,c,h,v){if(!h.modelManager)return!0;const N=h.modelManager;if(!h.shadowRenderer)return!0;const A=h.shadowRenderer,k=c.aabb;let z=!0,q=b.maxHeight;if(q===0){let Y=0;for(const ee in b.instancesPerModel){const Q=N.getModel(ee,v);Q?Y=Math.max(Y,Math.max(Math.max(Q.aabb.max[0],Q.aabb.max[1]),Q.aabb.max[2])):z=!1}q=b.maxScale*Y*1.41+b.maxVerticalOffset,z&&(b.maxHeight=q)}k.max[2]=q,k.min[2]+=b.terrainElevationMin,k.max[2]+=b.terrainElevationMax,s.ad.vec3.transformMat4(k.min,k.min,c.tileMatrix),s.ad.vec3.transformMat4(k.max,k.max,c.tileMatrix);const K=k.intersects(A.getCurrentCascadeFrustum());return h.currentShadowCascade===0&&(b.isInsideFirstShadowMapFrustum=K===2),K===0}function my(b,c){const h=b.uniformValues.u_cutoff_params[0],v=b.uniformValues.u_cutoff_params[1],N=b.uniformValues.u_cutoff_params[2],A=b.uniformValues.u_cutoff_params[3];return v===h||A===N?1:s.ay(((c-h)/(v-h)-N)/(A-N),0,1)}function $1(b,c,h,v){if(c.pitch<20)return 1;const N=c.getWorldToCameraMatrix();s.ad.mat4.multiply(N,N,b);const A=s.ad.vec4.fromValues(h.min[0],h.min[1],h.min[2],1);let k=s.ad.vec4.transformMat4(s.ad.vec4.create(),A,N),z=k,q=k;A[1]=h.max[1],k=s.ad.vec4.transformMat4(s.ad.vec4.create(),A,N),z=k[1]<z[1]?k:z,q=k[1]>q[1]?k:q,A[0]=h.max[0],k=s.ad.vec4.transformMat4(s.ad.vec4.create(),A,N),z=k[1]<z[1]?k:z,q=k[1]>q[1]?k:q,A[1]=h.min[1],k=s.ad.vec4.transformMat4(s.ad.vec4.create(),A,N),z=k[1]<z[1]?k:z,q=k[1]>q[1]?k:q;const K=s.ay(v[0],0,1),Y=100*c.pixelsPerMeter*s.ay(v[1],0,1),ee=s.ay(v[2],0,1),Q=s.ad.vec4.lerp(s.ad.vec4.create(),z,q,K),ie=Math.tan(.5*c.fovX),de=-Q[2]*ie;if(Y===0)return Q[1]<-Math.abs(de)?ee:1;const le=(-Math.abs(de)-Q[1])/Y,he=(Te,Re,Oe)=>(1-Oe)*Te+Oe*Re,fe=s.ay(he(1,ee,le),ee,1);return he(1,fe,s.ay((c.pitch-20)/20,0,1))}class V1{}class Hh{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(c,h,v){{const ee=this._storage.get(h.id);if(ee)return ee.lastUsedFrameIdx=c,ee.buf}const N=v.gl,A=N.getBufferParameter(N.ELEMENT_ARRAY_BUFFER,N.BUFFER_SIZE),k=new ArrayBuffer(A),z=new Int16Array(k);N.getBufferSubData(N.ELEMENT_ARRAY_BUFFER,0,new Int16Array(k));const q=new s.dt;for(let ee=0;ee<A/2;ee+=3){const Q=z[ee],ie=z[ee+1],de=z[ee+2];q.emplaceBack(Q,ie),q.emplaceBack(ie,de),q.emplaceBack(de,Q)}const K=v.bindVertexArrayOES.current,Y=new V1;return Y.buf=new Jc(v,q),Y.lastUsedFrameIdx=c,this._storage.set(h.id,Y),v.bindVertexArrayOES.set(K),Y.buf}update(c){for(const[h,v]of this._storage)c-v.lastUsedFrameIdx>30&&(v.buf.destroy(),this._storage.delete(h))}destroy(){for(const[c,h]of this._storage)h.buf.destroy(),this._storage.delete(c)}}class U1{constructor(c){this.occluderSize=30,this.depthOffset=-1e-4,c.registerParameter(this,["Occlusion"],"occluderSize",{min:1,max:100,step:1}),c.registerParameter(this,["Occlusion"],"depthOffset",{min:-.05,max:0,step:1e-5})}}const Vd=s.dd([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_rainParticleData",components:4}]);class G1{registerParameter(){}registerButton(){}registerBinding(){}refreshUI(){}}class $g{constructor(c,h){this.revealStart=11,this.revealRange=2,c.registerParameter(this,[...h,"Reveal"],"revealStart",{min:0,max:17,step:.05}),c.registerParameter(this,[...h,"Reveal"],"revealRange",{min:.1,max:5.1,step:.05})}}const H1=s.dd([{type:"Float32",name:"a_pos_2f",components:2}]);class q1{destroy(){this.vignetteVx&&this.vignetteVx.destroy(),this.vignetteIdx&&this.vignetteIdx.destroy()}draw(c,h){const v=c.getOrCreateProgram("vignette");if(!this.vignetteVx||!this.vignetteIdx){const k=new s.du,z=new s.aV;k.emplaceBack(-1,-1),k.emplaceBack(1,-1),k.emplaceBack(1,1),k.emplaceBack(-1,1),z.emplaceBack(0,1,2),z.emplaceBack(0,2,3),this.vignetteVx=c.context.createVertexBuffer(k,H1.members),this.vignetteIdx=c.context.createIndexBuffer(z)}const N=s.b8.simpleSegment(0,0,4,6);if(this.vignetteVx&&this.vignetteIdx){c.uploadCommonUniforms(c.context,v);const k={u_vignetteShape:(A={vignetteShape:[h.start,h.range,Math.pow(10,h.fadePower)],vignetteColor:[h.color.r,h.color.g,h.color.b,h.color.a*h.strength]}).vignetteShape,u_vignetteColor:A.vignetteColor};v.draw(c,c.context.gl.TRIANGLES,Cr.disabled,Kr.disabled,mn.alphaBlended,Gr.disabled,k,"vignette",this.vignetteVx,this.vignetteIdx,N)}var A}}class va{constructor(){this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0}update(c,h){const v=c.getFreeCameraOptions().position,N=v.toAltitude(),A=v.toLngLat(),k=s.ak(A.lng),z=s.ak(A.lat),q=c.pixelsPerMeter/h,K=k*s.dv,Y=s.dv*Math.log(Math.tan(Math.PI/4+z/2));if(this._offsetXPrev===void 0)this._offsetXPrev=0,this._offsetYPrev=0,this._elevationPrev=0,this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0;else{const ee=-this._offsetYPrev+Y,Q=-this._elevationPrev+N;this._accumulatedOffsetX+=(-this._offsetXPrev+K)*q,this._accumulatedOffsetY+=ee*q,this._accumulatedElevation+=Q*q,this._offsetXPrev=K,this._offsetYPrev=Y,this._elevationPrev=N}}getPosition(){return[this._accumulatedOffsetX,this._accumulatedOffsetY,this._accumulatedElevation]}}function fy(b,c){return[-(b[0]-Math.floor(b[0]/c)*c),-(b[1]-Math.floor(b[1]/c)*c),-(b[2]-Math.floor(b[2]/c)*c)]}function py(b){const c=s.dl(1323123451230),h=[];for(let v=0;v<b;++v){const N=2*c()-1,A=2*c()-1,k=2*c()-1;h.push(s.ad.vec3.fromValues(N,A,k))}return h}function Do(b,c,h,v,N){const A=s.ay((N-h)/(v-h),0,1);return(1-A)*b+A*c}class gy{constructor(c){this._movement=new va,this._accumulatedTimeFromStart=0,this._prevTime=Date.now()/1e3,this._vignette=new q1,this._ppmScaleFactor=c}destroy(){this.particlesVx&&this.particlesVx.destroy(),this.particlesIdx&&this.particlesIdx.destroy(),this._vignette&&this._vignette.destroy()}updateOnRender(c,h){const v=c.transform;this._movement.update(v,this._ppmScaleFactor);const N=v.starsProjMatrix,A=s.ad.quat.identity([]);s.ad.quat.rotateX(A,A,s.ak(90)-v._pitch),s.ad.quat.rotateZ(A,A,-v.angle);const k=s.ad.mat4.fromQuat(new Float32Array(16),A),z=s.ad.mat4.fromValues(1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1),q=s.ad.mat4.transpose([],z),K=s.ad.mat4.multiply([],q,k),Y=Date.now()/1e3;return this._accumulatedTimeFromStart+=(Y-this._prevTime)*h,this._prevTime=Y,{projectionMatrix:N,modelviewMatrix:K}}}class W1 extends gy{constructor(c){super(4.25),this._params={overrideStyleParameters:!1,intensity:.5,timeFactor:1,velocityConeAperture:0,velocity:300,boxSize:2500,dropletSizeX:1,dropletSizeYScale:10,distortionStrength:70,screenThinning:{intensity:.57,start:.46,range:1.17,fadePower:.17,affectedRatio:1,particleOffset:-.2},color:{r:.66,g:.68,b:.74,a:.7},direction:{x:-50,y:-35},shapeDirPower:2,shapeNormalPower:1},this._revealParams=new $g(c.tp,["Precipitation","Rain"]),this._vignetteParams={strength:1,start:.7,range:1,fadePower:.4,color:{r:.27,g:.27,b:.27,a:1}},this.particlesCount=16e3}update(c){const h=c.context;if(!this.particlesVx){const v=py(this.particlesCount),N=new s.dw,A=new s.aV;let k=0;const z=s.dl(1323123451230);for(let q=0;q<v.length;++q){const K=v[q],Y=[2*z()-1,z(),z(),z()];N.emplaceBack(K[0],K[1],K[2],-1,-1,...Y),N.emplaceBack(K[0],K[1],K[2],1,-1,...Y),N.emplaceBack(K[0],K[1],K[2],1,1,...Y),N.emplaceBack(K[0],K[1],K[2],-1,1,...Y),A.emplaceBack(k+0,k+1,k+2),A.emplaceBack(k+0,k+2,k+3),k+=4}this.particlesVx=h.createVertexBuffer(N,Vd.members),this.particlesIdx=h.createIndexBuffer(A)}}draw(c){if(!this._params.overrideStyleParameters&&!c.style.rain)return;const h=this._params.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},v=c.transform.zoom;if(h.revealStart>v)return;const N=Do(0,1,h.revealStart,h.revealStart+h.revealRange,v);if(!this.particlesVx||!this.particlesIdx)return;const A=structuredClone(this._params);let k=[-A.direction.x,A.direction.y,-100];s.ad.vec3.normalize(k,k);const z=structuredClone(this._vignetteParams);z.strength*=N,A.overrideStyleParameters||(A.intensity=c.style.rain.state.density,A.timeFactor=c.style.rain.state.intensity,A.color=structuredClone(c.style.rain.state.color),k=structuredClone(c.style.rain.state.direction),A.screenThinning.intensity=c.style.rain.state.centerThinning,A.dropletSizeX=c.style.rain.state.dropletSize[0],A.dropletSizeYScale=c.style.rain.state.dropletSize[1]/c.style.rain.state.dropletSize[0],A.distortionStrength=100*c.style.rain.state.distortionStrength,z.strength=1,z.color=structuredClone(c.style.rain.state.vignetteColor));const q=this.updateOnRender(c,A.timeFactor),K=c.context,Y=K.gl,ee=c.transform;this.screenTexture&&this.screenTexture.size[0]===c.width&&this.screenTexture.size[1]===c.height||(this.screenTexture=new s.T(K,{width:c.width,height:c.height,data:null},Y.RGBA8)),A.distortionStrength>0&&(K.activeTexture.set(Y.TEXTURE0),this.screenTexture.bind(Y.LINEAR,Y.CLAMP_TO_EDGE),Y.copyTexSubImage2D(Y.TEXTURE_2D,0,0,0,0,0,c.width,c.height));const Q=c.getOrCreateProgram("rainParticle");c.uploadCommonUniforms(K,Q),K.activeTexture.set(Y.TEXTURE0),this.screenTexture.bind(Y.LINEAR,Y.CLAMP_TO_EDGE);const ie=[A.color.r,A.color.g,A.color.b,A.color.a],de=(le,he)=>{const fe=fy(this._movement.getPosition(),le),Te=A.dropletSizeX,Re=A.dropletSizeX*A.dropletSizeYScale,Oe=c.width/2,$e=c.height/2,Le=Do(0,A.screenThinning.start,0,1,A.screenThinning.intensity),Fe=Do(.001,A.screenThinning.range,0,1,A.screenThinning.intensity),Be=Do(0,A.screenThinning.particleOffset,0,1,A.screenThinning.intensity),He=(Ke={modelview:q.modelviewMatrix,projection:q.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:fe,velocityConeAperture:A.velocityConeAperture,velocity:A.velocity,boxSize:le,rainDropletSize:[Te,Re],distortionStrength:A.distortionStrength,rainDirection:k,color:ie,screenSize:[ee.width,ee.height],thinningCenterPos:[Oe,$e],thinningShape:[Le,Fe,Math.pow(10,A.screenThinning.fadePower)],thinningAffectedRatio:A.screenThinning.affectedRatio,thinningParticleOffset:Be,shapeDirectionalPower:A.shapeDirPower,shapeNormalPower:A.shapeNormalPower,mode:he?0:1},{u_modelview:Float32Array.from(Ke.modelview),u_projection:Float32Array.from(Ke.projection),u_time:Ke.time,u_cam_pos:Ke.camPos,u_texScreen:0,u_velocityConeAperture:Ke.velocityConeAperture,u_velocity:Ke.velocity,u_boxSize:Ke.boxSize,u_rainDropletSize:Ke.rainDropletSize,u_distortionStrength:Ke.distortionStrength,u_rainDirection:Ke.rainDirection,u_color:Ke.color,u_screenSize:Ke.screenSize,u_thinningCenterPos:Ke.thinningCenterPos,u_thinningShape:Ke.thinningShape,u_thinningAffectedRatio:Ke.thinningAffectedRatio,u_thinningParticleOffset:Ke.thinningParticleOffset,u_shapeDirectionalPower:Ke.shapeDirectionalPower,u_shapeNormalPower:Ke.shapeNormalPower,u_mode:Ke.mode});var Ke;const ft=Math.round(A.intensity*this.particlesCount),at=s.b8.simpleSegment(0,0,4*ft,2*ft);Q.draw(c,Y.TRIANGLES,Cr.disabled,Kr.disabled,mn.alphaBlended,Gr.disabled,He,"rain_particles",this.particlesVx,this.particlesIdx,at)};A.distortionStrength>0&&de(A.boxSize,!0),de(A.boxSize,!1),this._vignette.draw(c,z)}}const K1=s.dd([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_snowParticleData",components:4},{type:"Float32",name:"a_snowParticleDataHorizontalOscillation",components:2}]);class Nf extends gy{constructor(c){super(2.25),this._params={overrideStyleParameters:!1,intensity:.85,timeFactor:.75,velocityConeAperture:70,velocity:40,horizontalOscillationRadius:4,horizontalOscillationRate:1.5,boxSize:2e3,billboardSize:2,shapeFadeStart:.27,shapeFadePower:.21,screenThinning:{intensity:.4,start:.15,range:1.4,fadePower:.24,affectedRatio:1,particleOffset:-.2},color:{r:1,g:1,b:1,a:1},direction:{x:-50,y:-35}},this._revealParams=new $g(c.tp,["Precipitation","Snow"]),this._vignetteParams={strength:.3,start:.78,range:.46,fadePower:.2,color:{r:1,g:1,b:1,a:1}},this.particlesCount=16e3}update(c){const h=c.context;if(!this.particlesVx){const v=py(this.particlesCount),N=new s.dx,A=new s.aV;let k=0;const z=s.dl(1323123451230);for(let q=0;q<v.length;++q){const K=v[q],Y=z(),ee=z(),Q=z(),ie=[q/v.length,Y,ee,Q],de=[z(),z()];N.emplaceBack(K[0],K[1],K[2],-1,-1,...ie,...de),N.emplaceBack(K[0],K[1],K[2],1,-1,...ie,...de),N.emplaceBack(K[0],K[1],K[2],1,1,...ie,...de),N.emplaceBack(K[0],K[1],K[2],-1,1,...ie,...de),A.emplaceBack(k+0,k+1,k+2),A.emplaceBack(k+0,k+2,k+3),k+=4}this.particlesVx=h.createVertexBuffer(N,K1.members),this.particlesIdx=h.createIndexBuffer(A)}}draw(c){if(!this._params.overrideStyleParameters&&!c.style.snow)return;const h=structuredClone(this._params);let v=[-h.direction.x,h.direction.y,-100];s.ad.vec3.normalize(v,v);const N=structuredClone(this._vignetteParams),A=h.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},k=c.transform.zoom;if(A.revealStart>k)return;const z=Do(0,1,A.revealStart,A.revealStart+A.revealRange,k);N.strength*=z,h.overrideStyleParameters||(h.intensity=c.style.snow.state.density,h.timeFactor=c.style.snow.state.intensity,h.color=structuredClone(c.style.snow.state.color),v=structuredClone(c.style.snow.state.direction),h.screenThinning.intensity=c.style.snow.state.centerThinning,h.billboardSize=2.79*c.style.snow.state.flakeSize,N.strength=1,N.color=structuredClone(c.style.snow.state.vignetteColor));const q=this.updateOnRender(c,h.timeFactor);if(!this.particlesVx||!this.particlesIdx)return;const K=c.context,Y=K.gl,ee=c.transform,Q=c.getOrCreateProgram("snowParticle");c.uploadCommonUniforms(K,Q),((ie,de,le)=>{const he=fy(this._movement.getPosition(),ie),fe=ee.width/2,Te=ee.height/2,Re=Do(0,le.screenThinning.start,0,1,le.screenThinning.intensity),Oe=Do(.001,le.screenThinning.range,0,1,le.screenThinning.intensity),$e=Do(0,le.screenThinning.particleOffset,0,1,le.screenThinning.intensity),Le=(Fe={modelview:q.modelviewMatrix,projection:q.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:he,velocityConeAperture:le.velocityConeAperture,velocity:le.velocity,horizontalOscillationRadius:le.horizontalOscillationRadius,horizontalOscillationRate:le.horizontalOscillationRate,boxSize:ie,billboardSize:1*le.billboardSize,simpleShapeParameters:[le.shapeFadeStart,le.shapeFadePower],screenSize:[ee.width,ee.height],thinningCenterPos:[fe,Te],thinningShape:[Re,Oe,Math.pow(10,le.screenThinning.fadePower)],thinningAffectedRatio:le.screenThinning.affectedRatio,thinningParticleOffset:$e,color:[le.color.r,le.color.g,le.color.b,le.color.a],direction:v},{u_modelview:Float32Array.from(Fe.modelview),u_projection:Float32Array.from(Fe.projection),u_time:Fe.time,u_cam_pos:Fe.camPos,u_velocityConeAperture:Fe.velocityConeAperture,u_velocity:Fe.velocity,u_horizontalOscillationRadius:Fe.horizontalOscillationRadius,u_horizontalOscillationRate:Fe.horizontalOscillationRate,u_boxSize:Fe.boxSize,u_billboardSize:Fe.billboardSize,u_simpleShapeParameters:Fe.simpleShapeParameters,u_screenSize:Fe.screenSize,u_thinningCenterPos:Fe.thinningCenterPos,u_thinningShape:Fe.thinningShape,u_thinningAffectedRatio:Fe.thinningAffectedRatio,u_thinningParticleOffset:Fe.thinningParticleOffset,u_particleColor:Fe.color,u_direction:Fe.direction});var Fe;const Be=Math.round(le.intensity*this.particlesCount),He=s.b8.simpleSegment(0,0,4*Be,2*Be);this.particlesVx&&this.particlesIdx&&Q.draw(c,Y.TRIANGLES,Cr.disabled,Kr.disabled,mn.alphaBlended,Gr.disabled,Le,"snow_particles",this.particlesVx,this.particlesIdx,He)})(h.boxSize,0,h),this._vignette.draw(c,N)}}const Vg={symbol:function(b,c,h,v,N){if(b.renderPass!=="translucent")return;const A=Kr.disabled,k=b.colorModeForRenderPass(),z=h.layout.get("text-variable-anchor"),q=h.layout.get("text-size-scale-range"),K=s.ay(b.scaleFactor,q[0],q[1]);z&&function(Q,ie,de,le,he,fe,Te,Re){const Oe=ie.transform,$e=he==="map",Le=fe==="map";for(const Fe of Q){const Be=le.getTile(Fe),He=Be.getBucket(de);if(!He||!He.text||!He.text.segments.get().length)continue;const Ke=s.bp(He.textSizeData,Oe.zoom,Re),ft=al(Fe,He.getProjection(),Oe),at=Oe.calculatePixelsToTileUnitsMatrix(Be),kt=Pu(ft,Be.tileID.canonical,Le,$e,Oe,He.getProjection(),at),Pt=He.hasIconTextFit()&&He.hasIconData();if(Ke){const Bt=Math.pow(2,Oe.zoom-Be.tileID.overscaledZ);Fl(He,$e,Le,Te,s.cY,Oe,kt,Fe,Bt,Ke,Pt)}}}(v,b,h,c,h.layout.get("text-rotation-alignment"),h.layout.get("text-pitch-alignment"),N,K);const Y=h.paint.get("icon-opacity").constantOr(1)!==0,ee=h.paint.get("text-opacity").constantOr(1)!==0;h.layout.get("symbol-sort-key").constantOr(1)!==void 0&&(Y||ee)?hi(b,c,h,v,A,k):(Y&&hi(b,c,h,v,A,k,{onlyIcons:!0}),ee&&hi(b,c,h,v,A,k,{onlyText:!0})),c.map.showCollisionBoxes&&(ay(b,c,h,v,h.paint.get("text-translate"),h.paint.get("text-translate-anchor"),!0),ay(b,c,h,v,h.paint.get("icon-translate"),h.paint.get("icon-translate-anchor"),!1))},circle:function(b,c,h,v){if(b.renderPass!=="translucent")return;const N=h.paint.get("circle-opacity"),A=h.paint.get("circle-stroke-width"),k=h.paint.get("circle-stroke-opacity"),z=h.layout.get("circle-sort-key").constantOr(1)!==void 0,q=h.paint.get("circle-emissive-strength");if(N.constantOr(1)===0&&(A.constantOr(1)===0||k.constantOr(1)===0))return;const K=b.context,Y=K.gl,ee=b.transform,Q=b.depthModeForSublayer(0,Cr.ReadOnly),ie=Kr.disabled,de=b.colorModeForDrapableLayerRenderPass(q),le=ee.projection.name==="globe",he=[s.av(ee.center.lng),s.aC(ee.center.lat)],fe=[];for(let Re=0;Re<v.length;Re++){const Oe=v[Re],$e=c.getTile(Oe),Le=$e.getBucket(h);if(!Le||Le.projection.name!==ee.projection.name)continue;const Fe=Le.programConfigurations.get(h.id),Be=s.cZ(h),He=b.isTileAffectedByFog(Oe);le&&Be.push("PROJECTION_GLOBE_VIEW"),Be.push("DEPTH_D24"),b.terrain&&ee.depthOcclusionForSymbolsAndCircles&&Be.push("DEPTH_OCCLUSION");const Ke=b.getOrCreateProgram("circle",{config:Fe,defines:Be,overrideFog:He}),ft=Le.layoutVertexBuffer,at=Le.globeExtVertexBuffer,kt=Le.indexBuffer,Pt=ee.projection.createInversionMatrix(ee,Oe.canonical),Bt={programConfiguration:Fe,program:Ke,layoutVertexBuffer:ft,globeExtVertexBuffer:at,indexBuffer:kt,uniformValues:s.c_(b,Oe,$e,Pt,he,h),tile:$e};if(z){const st=Le.segments.get();for(const At of st)fe.push({segments:new s.b8([At]),sortKey:At.sortKey,state:Bt})}else fe.push({segments:Le.segments,sortKey:0,state:Bt})}z&&fe.sort((Re,Oe)=>Re.sortKey-Oe.sortKey);const Te={useDepthForOcclusion:ee.depthOcclusionForSymbolsAndCircles};for(const Re of fe){const{programConfiguration:Oe,program:$e,layoutVertexBuffer:Le,globeExtVertexBuffer:Fe,indexBuffer:Be,uniformValues:He,tile:Ke}=Re.state,ft=Re.segments;b.terrain&&b.terrain.setupElevationDraw(Ke,$e,Te),b.uploadCommonUniforms(K,$e,Ke.tileID.toUnwrapped()),$e.draw(b,Y.TRIANGLES,Q,ie,de,Gr.disabled,He,h.id,Le,Be,ft,h.paint,ee.zoom,Oe,[Fe])}},heatmap:function(b,c,h,v){if(h.paint.get("heatmap-opacity")!==0)if(b.renderPass==="offscreen"){const N=b.context,A=N.gl,k=Kr.disabled,z=new mn([A.ONE,A.ONE,A.ONE,A.ONE],s.al.transparent,[!0,!0,!0,!0]);(function(ie,de,le,he){const fe=ie.gl,Te=de.width*he,Re=de.height*he;ie.activeTexture.set(fe.TEXTURE1),ie.viewport.set([0,0,Te,Re]);let Oe=le.heatmapFbo;if(!Oe||Oe&&(Oe.width!==Te||Oe.height!==Re)){Oe&&Oe.destroy();const $e=fe.createTexture();fe.bindTexture(fe.TEXTURE_2D,$e),fe.texParameteri(fe.TEXTURE_2D,fe.TEXTURE_WRAP_S,fe.CLAMP_TO_EDGE),fe.texParameteri(fe.TEXTURE_2D,fe.TEXTURE_WRAP_T,fe.CLAMP_TO_EDGE),fe.texParameteri(fe.TEXTURE_2D,fe.TEXTURE_MIN_FILTER,fe.LINEAR),fe.texParameteri(fe.TEXTURE_2D,fe.TEXTURE_MAG_FILTER,fe.LINEAR),Oe=le.heatmapFbo=ie.createFramebuffer(Te,Re,!0,null),function(Le,Fe,Be,He,Ke,ft){const at=Le.gl;at.texImage2D(at.TEXTURE_2D,0,Le.extRenderToTextureHalfFloat?at.RGBA16F:at.RGBA,Ke,ft,0,at.RGBA,Le.extRenderToTextureHalfFloat?at.HALF_FLOAT:at.UNSIGNED_BYTE,null),He.colorAttachment.set(Be)}(ie,0,$e,Oe,Te,Re)}else fe.bindTexture(fe.TEXTURE_2D,Oe.colorAttachment.get()),ie.bindFramebuffer.set(Oe.framebuffer)})(N,b,h,b.transform.projection.name==="globe"?.5:.25),N.clear({color:s.al.transparent});const q=b.transform,K=q.projection.name==="globe",Y=K?["PROJECTION_GLOBE_VIEW"]:[],ee=K?Gr.frontCCW:Gr.disabled,Q=[s.av(q.center.lng),s.aC(q.center.lat)];for(let ie=0;ie<v.length;ie++){const de=v[ie];if(c.hasRenderableParent(de))continue;const le=c.getTile(de),he=le.getBucket(h);if(!he||he.projection.name!==q.projection.name)continue;const fe=b.isTileAffectedByFog(de),Te=he.programConfigurations.get(h.id),Re=b.getOrCreateProgram("heatmap",{config:Te,defines:Y,overrideFog:fe}),{zoom:Oe}=b.transform;b.terrain&&b.terrain.setupElevationDraw(le,Re),b.uploadCommonUniforms(N,Re,de.toUnwrapped());const $e=q.projection.createInversionMatrix(q,de.canonical);Re.draw(b,A.TRIANGLES,Cr.disabled,k,z,ee,ny(b,de,le,$e,Q,Oe,h.paint.get("heatmap-intensity")),h.id,he.layoutVertexBuffer,he.indexBuffer,he.segments,h.paint,b.transform.zoom,Te,K?[he.globeExtVertexBuffer]:null)}N.viewport.set([0,0,b.width,b.height])}else b.renderPass==="translucent"&&(b.context.setColorMode(b.colorModeForRenderPass()),function(N,A){const k=N.context,z=k.gl,q=A.heatmapFbo;if(!q)return;k.activeTexture.set(z.TEXTURE0),z.bindTexture(z.TEXTURE_2D,q.colorAttachment.get()),k.activeTexture.set(z.TEXTURE1);let K=A.colorRampTexture;K||(K=A.colorRampTexture=new s.T(k,A.colorRamp,z.RGBA8)),K.bind(z.LINEAR,z.CLAMP_TO_EDGE),N.getOrCreateProgram("heatmapTexture").draw(N,z.TRIANGLES,Cr.disabled,Kr.disabled,N.colorModeForRenderPass(),Gr.disabled,((Y,ee,Q,ie)=>({u_image:0,u_color_ramp:1,u_opacity:ee.paint.get("heatmap-opacity")}))(0,A),A.id,N.viewportBuffer,N.quadTriangleIndexBuffer,N.viewportSegments,A.paint,N.transform.zoom)}(b,h))},line:function(b,c,h,v){if(b.renderPass!=="translucent")return;const N=h.paint.get("line-opacity"),A=h.paint.get("line-width");if(N.constantOr(1)===0||A.constantOr(1)===0)return;const k=h.paint.get("line-emissive-strength"),z=h.paint.get("line-occlusion-opacity"),q=h.layout.get("line-elevation-reference"),K=h.layout.get("line-width-unit")==="meters",Y=q==="sea",ee=b.context,Q=ee.gl;if(h.hasElevatedBuckets&&b.transform.projection.name==="globe")return;const ie=h.layout.get("line-cross-slope"),de=ie!==void 0,le=ie<1,he=b.colorModeForDrapableLayerRenderPass(k),fe=b.terrain&&b.terrain.renderingToTexture,Te=fe?1:s.q.devicePixelRatio,Re=h.paint.get("line-dasharray"),Oe=Re.constantOr(1),$e=h.layout.get("line-cap"),Le=Re.constantOr(null),Fe=$e.constantOr(null),Be=h.paint.get("line-pattern"),He=Be.constantOr(1),Ke=Be.constantOr(null),ft=h.paint.get("line-opacity").constantOr(1);let at=!He&&ft!==1||b.depthOcclusion&&z>0&&z<1;const kt=h.paint.get("line-gradient"),Pt=He?"linePattern":"line",Bt=s.c$(h);let st;if(fe&&b.terrain&&b.terrain.clipOrMaskOverlapStencilType()&&(at=!1),z!==0&&b.depthOcclusion){const rt=h.paint._values["line-opacity"];rt&&rt.value&&rt.value.kind==="constant"?st=rt.value:s.w(`Occlusion opacity for layer ${h.id} is supported only when line-opacity isn't data-driven.`)}A.value.kind!=="constant"&&A.value.isLineProgressConstant===!1&&Bt.push("VARIABLE_LINE_WIDTH");const At=(rt,Ct,_t,Et,pt,It)=>{for(const Kt of rt){const Zt=c.getTile(Kt);if(He&&!Zt.patternsLoaded())continue;const Qt=Zt.getBucket(h);if(!Qt||Qt.hasZOffset&&!pt||!Qt.hasZOffset&&pt)continue;b.prepareDrawTile();const gr=Qt.programConfigurations.get(h.id),qr=b.isTileAffectedByFog(Kt),Er=b.getOrCreateProgram(Pt,{config:gr,defines:Ct,overrideFog:qr,overrideRtt:!pt&&void 0});if(Ke&&Zt.imageAtlas){const Zr=s.d0.from(Ke).getPrimary().scaleSelf(Te).toString(),xr=Zt.imageAtlas.patternPositions.get(Zr);xr&&gr.setConstantPatternPositions(xr)}if(!He&&Le&&Fe&&Zt.lineAtlas){const Zr=Zt.lineAtlas.getDash(Le,Fe);Zr&&gr.setConstantPatternPositions(Zr)}let[Br,zr]=h.paint.get("line-trim-offset");(Fe==="round"||Fe==="square")&&Br!==zr&&(Br===0&&(Br-=1),zr===1&&(zr+=1));const bn=fe?Kt.projMatrix:null,Vn=K?1/Qt.tileToMeter/s.at(Zt,1,b.transform.zoom):1,fi=K?1/Qt.tileToMeter/s.at(Zt,1,Math.floor(b.transform.zoom)):1,un=He?s.d1(b,Zt,h,bn,Te,Vn,fi,[Br,zr]):s.d2(b,Zt,h,bn,Qt.lineClipsArray.length,Te,Vn,fi,[Br,zr]);if(kt){const Zr=Qt.gradients[h.id];let xr=Zr.texture;if(h.gradientVersion!==Zr.version){let Nn=256;if(h.stepInterpolant){const Jn=c.getSource().maxzoom,On=Kt.canonical.z===Jn?Math.ceil(1<<b.transform.maxZoom-Kt.canonical.z):1;Nn=s.ay(s.d3(Qt.maxLineLength/s.ai*1024*On),256,ee.maxTextureSize)}Zr.gradient=s.d4({expression:h.gradientExpression(),evaluationKey:"lineProgress",resolution:Nn,image:Zr.gradient||void 0,clips:Qt.lineClipsArray}),Zr.texture?Zr.texture.update(Zr.gradient):Zr.texture=new s.T(ee,Zr.gradient,Q.RGBA8),Zr.version=h.gradientVersion,xr=Zr.texture}ee.activeTexture.set(Q.TEXTURE1),xr.bind(h.stepInterpolant?Q.NEAREST:Q.LINEAR,Q.CLAMP_TO_EDGE)}Oe&&(ee.activeTexture.set(Q.TEXTURE0),Zt.lineAtlasTexture&&Zt.lineAtlasTexture.bind(Q.LINEAR,Q.REPEAT),gr.updatePaintBuffers()),He&&(ee.activeTexture.set(Q.TEXTURE0),Zt.imageAtlasTexture&&Zt.imageAtlasTexture.bind(Q.LINEAR,Q.CLAMP_TO_EDGE),gr.updatePaintBuffers()),pt&&!Y&&b.terrain.setupElevationDraw(Zt,Er),b.uploadCommonUniforms(ee,Er,Kt.toUnwrapped());const ki=Zr=>{st!=null&&(st.value=ft*z),Er.draw(b,Q.TRIANGLES,_t,Zr,he,Gr.disabled,un,h.id,Qt.layoutVertexBuffer,Qt.indexBuffer,Qt.segments,h.paint,b.transform.zoom,gr,[Qt.layoutVertexBuffer2,Qt.patternVertexBuffer,Qt.zOffsetVertexBuffer]),st!=null&&(st.value=ft)};if(at&&!pt){const Zr=b.stencilModeForClipping(Kt).ref;Zr===0&&fe&&ee.clear({stencil:0});const xr={func:Q.EQUAL,mask:255};un.u_alpha_discard_threshold=.8,ki(new Kr(xr,Zr,255,Q.KEEP,Q.KEEP,Q.INVERT)),un.u_alpha_discard_threshold=0,ki(new Kr(xr,Zr,255,Q.KEEP,Q.KEEP,Q.KEEP))}else un.u_alpha_discard_threshold=at&&pt&&It?.8:0,ki(pt?Et:b.stencilModeForClipping(Kt))}};if(h.hasNonElevatedBuckets){const rt=!fe&&b.terrain;z!==0&&rt?s.w(`Occlusion opacity for layer ${h.id} is supported on terrain only if the layer has line-z-offset enabled.`):rt?s.w(`Cannot render non-elevated lines in immediate mode when terrain is enabled. Layer: ${h.id}.`):At(v,Bt,b.depthModeForSublayer(0,Cr.ReadOnly),Kr.disabled,!1,!0)}if(h.hasElevatedBuckets){Bt.push("ELEVATED"),de&&Bt.push(le?"CROSS_SLOPE_HORIZONTAL":"CROSS_SLOPE_VERTICAL"),Y&&Bt.push("ELEVATION_REFERENCE_SEA");const rt=at?b.stencilModeFor3D():Kr.disabled,Ct=new Cr(b.depthOcclusion?Q.GREATER:Q.LEQUAL,Cr.ReadOnly,b.depthRangeFor3D);b.forceTerrainMode=!0,At(v,Bt,Ct,rt,!0,!0),at&&At(v,Bt,Ct,rt,!0,!1),b.forceTerrainMode=!1}at&&(b.resetStencilClippingMasks(),fe&&ee.clear({stencil:0})),z===0||b.depthOcclusion||fe||b.layersWithOcclusionOpacity.push(b.currentLayer)},fill:function(b,c,h,v){const N=h.paint.get("fill-color"),A=h.paint.get("fill-opacity");if(A.constantOr(1)===0)return;const k=h.paint.get("fill-emissive-strength"),z=b.colorModeForDrapableLayerRenderPass(k),q=h.paint.get("fill-pattern"),K=b.opaquePassEnabledForLayer()&&!q.constantOr(1)&&N.constantOr(s.al.transparent).a===1&&A.constantOr(0)===1?"opaque":"translucent";let Y="none";h.layout.get("fill-elevation-reference")!=="none"?Y="road":h.paint.get("fill-z-offset").constantOr(1)!==0&&(Y="offset");const ee=!(!b.terrain||!b.terrain.enabled),Q={painter:b,sourceCache:c,layer:h,coords:v,colorMode:z,elevationType:Y,terrainEnabled:ee,pass:K};if(Y!=="offset"){if(ly(Q,!1),Y==="road"){const ie=!ee&&b.renderPass==="translucent";ie&&O1(b,c,h,v,"geometry"),ly(Q,!0,Kr.disabled),ie&&function(de){const{painter:le,sourceCache:he,layer:fe,coords:Te,colorMode:Re}=de,Oe=le.context.gl,$e=new Cr(le.context.gl.LEQUAL,Cr.ReadOnly,le.depthRangeFor3D);for(const Le of Te){const Fe=he.getTile(Le),Be=Fe.getBucket(fe);if(!Be)continue;const He=Be.elevatedStructures;if(!He||!He.renderableSegments||He.renderableSegments.segments[0].primitiveLength===0)continue;le.prepareDrawTile();const Ke=Be.bufferData.programConfigurations.get(fe.id),ft=le.isTileAffectedByFog(Le),at=le.getOrCreateProgram("elevatedStructures",{config:Ke,overrideFog:ft,defines:["NORMAL_OFFSET"]}),kt={u_matrix:le.translatePosMatrix(Le.projMatrix,Fe,fe.paint.get("fill-translate"),fe.paint.get("fill-translate-anchor"))};le.uploadCommonUniforms(le.context,at,Le.toUnwrapped()),at.draw(le,Oe.TRIANGLES,$e,Kr.disabled,Re,Gr.backCCW,kt,fe.id,He.vertexBuffer,He.indexBuffer,He.renderableSegments,fe.paint,le.transform.zoom,Ke,[He.vertexBufferNormal])}}(Q)}}else ly(Q,!1,b.stencilModeFor3D())},"fill-extrusion":function(b,c,h,v){const N=h.paint.get("fill-extrusion-opacity"),A=b.context,k=A.gl,z=b.terrain,q=z&&z.renderingToTexture;if(N===0)return;const K=b.conflationActive&&b.style.isLayerClipped(h,c.getSource()),Y=b.style.order.indexOf(h.fqid);if(K&&function(ee,Q,ie,de,le){for(const he of de){const fe=Q.getTile(he).getBucket(ie);fe&&(fe.updateReplacement(he,ee.replacementSource,le),fe.uploadCentroid(ee.context))}}(b,c,h,v,Y),z||K)for(const ee of v){const Q=c.getTile(ee).getBucket(h);Q&&yf(b.context,c,ee,Q,h,z,K)}if(b.renderPass==="shadow"&&b.shadowRenderer){const ee=b.shadowRenderer;if(z&&N<.65&&h._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof s.ab)return;const Q=ee.getShadowPassDepthMode(),ie=ee.getShadowPassColorMode();Lg(b,c,h,v,Q,Kr.disabled,ie,K)}else if(b.renderPass==="translucent"){const ee=!h.paint.get("fill-extrusion-pattern").constantOr(1),Q=h.paint.get("fill-extrusion-color").constantOr(s.al.white);if(!q&&Q.a!==0){const ie=new Cr(b.context.gl.LEQUAL,Cr.ReadWrite,b.depthRangeFor3D);N===1&&ee?Lg(b,c,h,v,ie,Kr.disabled,mn.unblended,K):(Lg(b,c,h,v,ie,Kr.disabled,mn.disabled,K),Lg(b,c,h,v,ie,b.stencilModeFor3D(),b.colorModeForRenderPass(),K),b.resetStencilClippingMasks())}if(b.style.enable3dLights()&&ee&&(!z&&b.transform.projection.name!=="globe"||q)){const ie=h.paint.get("fill-extrusion-opacity"),de=h.paint.get("fill-extrusion-ambient-occlusion-intensity"),le=h.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),he=h.paint.get("fill-extrusion-flood-light-intensity"),fe=h.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",Te=h.paint.get("fill-extrusion-flood-light-color").toRenderColor(fe?null:h.lut).toArray01().slice(0,3),Re=de>0&&le>0,Oe=he>0,$e=(Fe,Be,He)=>(1-He)*Fe+He*Be,Le=Fe=>{const Be=b.depthModeForSublayer(1,Cr.ReadOnly,k.LEQUAL,!0),He=h.paint.get(Fe?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),Ke=$e(.1,3,He),ft=b._showOverdrawInspector;if(!ft){const at=new Kr({func:k.ALWAYS,mask:255},255,255,k.KEEP,k.KEEP,k.REPLACE),kt=new mn([k.ONE,k.ONE,k.ONE,k.ONE],s.al.transparent,[!1,!1,!1,!0],k.MIN);xf(b,c,h,v,Be,at,kt,Gr.disabled,Fe,"sdf",ie,de,le,he,Te,Ke,K,!1)}{const at=ft?Kr.disabled:new Kr({func:k.EQUAL,mask:255},255,255,k.KEEP,k.DECR,k.DECR),kt=ft?b.colorModeForRenderPass():new mn([k.ONE_MINUS_DST_ALPHA,k.DST_ALPHA,k.ONE,k.ONE],s.al.transparent,[!0,!0,!0,!0]);xf(b,c,h,v,Be,at,kt,Gr.disabled,Fe,"color",ie,de,le,he,Te,Ke,K,!1)}};if(q){const Fe=(Be,He,Ke)=>{const ft=b.depthModeForSublayer(1,Cr.ReadOnly,k.LEQUAL,!1),at=h.paint.get(Be?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),kt=$e(.1,3,at);{const Pt=new mn([k.ONE,k.ONE,k.ONE,k.ONE],s.al.transparent,[!1,!1,!1,!0]);xf(b,c,h,v,ft,Kr.disabled,Pt,Gr.disabled,Be,"clear",ie,de,le,he,Te,kt,K,He)}{const Pt=new Kr({func:k.ALWAYS,mask:255},255,255,k.KEEP,k.KEEP,k.REPLACE),Bt=new mn([k.ONE,k.ONE,k.ONE,k.ONE],s.al.transparent,[!1,!1,!1,!0],k.MIN);xf(b,c,h,v,ft,Pt,Bt,Gr.disabled,Be,"sdf",ie,de,le,he,Te,kt,K,He)}{const Pt=Be?k.ZERO:k.ONE_MINUS_DST_ALPHA,Bt=new Kr({func:k.EQUAL,mask:255},255,255,k.KEEP,k.DECR,k.DECR),st=new mn([Pt,k.DST_ALPHA,k.ONE_MINUS_DST_ALPHA,k.ZERO],s.al.transparent,[!0,!0,!0,!0]);xf(b,c,h,v,ft,Bt,st,Gr.disabled,Be,"color",ie,de,le,he,Te,kt,K,He)}{const Pt=new mn([k.ONE,k.ONE,k.ONE,Be?k.ZERO:k.ONE],s.al.transparent,[!1,!1,!1,!0],Be?k.FUNC_ADD:k.MAX);xf(b,c,h,v,ft,Kr.disabled,Pt,Gr.disabled,Be,"clear",ie,de,le,he,Te,kt,K,He,Ke)}};if(Re||Oe){let Be;if(b.prepareDrawTile(),z){const He=z.drapeBufferSize[0],Ke=z.drapeBufferSize[1];Be=z.framebufferCopyTexture,Be&&(!Be||Be.size[0]===He&&Be.size[1]===Ke)||(Be&&Be.destroy(),Be=z.framebufferCopyTexture=new s.T(A,new s.r({width:He,height:Ke}),k.RGBA8)),Be.bind(k.LINEAR,k.CLAMP_TO_EDGE),k.copyTexSubImage2D(k.TEXTURE_2D,0,0,0,0,0,He,Ke)}Re&&Fe(!0,!1,Be),Oe&&Fe(!1,!0,Be)}}else Re&&Le(!0),Oe&&Le(!1),(Re||Oe)&&b.resetStencilClippingMasks()}}},hillshade:function(b,c,h,v){if(b.renderPass!=="offscreen"&&b.renderPass!=="translucent"||b.style.disableElevatedTerrain)return;const N=b.context,A=b.terrain&&b.terrain.renderingToTexture,[k,z]=b.renderPass!=="translucent"||A?[{},v]:b.stencilConfigForOverlap(v);for(const q of z){const K=c.getTile(q);if(K.needsHillshadePrepare&&b.renderPass==="offscreen")Z3(b,K,h);else if(b.renderPass==="translucent"){const Y=b.depthModeForSublayer(0,Cr.ReadOnly),ee=h.paint.get("hillshade-emissive-strength"),Q=b.colorModeForDrapableLayerRenderPass(ee),ie=A&&b.terrain?b.terrain.stencilModeForRTTOverlap(q):k[q.overscaledZ];lf(b,q,K,h,Y,ie,Q)}}N.viewport.set([0,0,b.width,b.height]),b.resetStencilClippingMasks()},raster:function(b,c,h,v,N,A){if(b.renderPass!=="translucent"||h.paint.get("raster-opacity")===0)return;const k=b.transform.projection.name==="globe",z=h.paint.get("raster-elevation")!==0,q=z&&k;if(b.renderElevatedRasterBackface&&!q)return;const K=b.context,Y=K.gl,ee=c.getSource(),Q=function(Le,Fe,Be,He){const Ke=Fe.paint.get("raster-color"),ft=Le.type==="raster-array",at=[],kt=Fe.paint.get("raster-resampling"),Pt=Fe.paint.get("raster-color-mix");let Bt=Fe.paint.get("raster-color-range");const st=[Pt[0],Pt[1],Pt[2],0],At=Pt[3];let rt=kt==="nearest"?He.NEAREST:He.LINEAR;if(ft&&(at.push("RASTER_ARRAY"),Ke||at.push("RASTER_COLOR"),kt==="linear"&&at.push("RASTER_ARRAY_LINEAR"),rt=He.NEAREST,!Bt&&Le.rasterLayers)){const Ct=Le.rasterLayers.find(({id:_t})=>_t===Fe.sourceLayer);Ct&&Ct.fields&&Ct.fields.range&&(Bt=Ct.fields.range)}if(Bt=Bt||[0,1],Ke){at.push("RASTER_COLOR"),Be.activeTexture.set(He.TEXTURE2),Fe.updateColorRamp(Bt);let Ct=Fe.colorRampTexture;Ct||(Ct=Fe.colorRampTexture=new s.T(Be,Fe.colorRamp,He.RGBA8)),Ct.bind(He.LINEAR,He.CLAMP_TO_EDGE)}return{mix:st,range:Bt,offset:At,defines:at,resampling:rt}}(ee,h,K,Y);if(ee instanceof s.aK&&!v.length&&!k)return;const ie=h.paint.get("raster-emissive-strength"),de=b.colorModeForDrapableLayerRenderPass(ie),le=b.terrain&&b.terrain.renderingToTexture,he=!b.options.moving,fe=h.paint.get("raster-resampling")==="nearest"?Y.NEAREST:Y.LINEAR;if(ee instanceof s.aK&&!v.length&&(ee.onNorthPole||ee.onSouthPole)){const Le=z?b.stencilModeFor3D():Kr.disabled;return void ut(!!ee.onNorthPole,null,b,c,h,ie,Q,Gr.disabled,Le)}if(!v.length)return;const[Te,Re]=ee instanceof s.aK||le?[{},v]:b.stencilConfigForOverlap(v),Oe=Re[Re.length-1].overscaledZ;q&&Q.defines.push("PROJECTION_GLOBE_VIEW"),z&&Q.defines.push("RENDER_CUTOFF");const $e=(Le,Fe,Be)=>{for(const He of Le){const Ke=He.toUnwrapped(),ft=c.getTile(He);if(le&&(!ft||!ft.hasData()))continue;K.activeTexture.set(Y.TEXTURE0);const at=cy(ft,ee,h,Q);if(!at||!at.texture)continue;const{texture:kt,mix:Pt,offset:Bt,tileSize:st,buffer:At}=at;let rt,Ct;le?(rt=Cr.disabled,Ct=He.projMatrix):z?(rt=new Cr(Y.LEQUAL,Cr.ReadWrite,b.depthRangeFor3D),Ct=k?Float32Array.from(b.transform.expandedFarZProjMatrix):b.transform.calculateProjMatrix(Ke,he)):(rt=b.depthModeForSublayer(He.overscaledZ-Oe,h.paint.get("raster-opacity")===1?Cr.ReadWrite:Cr.ReadOnly,Y.LESS),Ct=b.transform.calculateProjMatrix(Ke,he));const _t=b.terrain&&le?b.terrain.stencilModeForRTTOverlap(He):Te[He.overscaledZ],Et=A?0:h.paint.get("raster-fade-duration");ft.registerFadeDuration(Et);const pt=c.findLoadedParent(He,0),It=Xx(ft,pt,c,b.transform,Et);let Kt,Zt;b.terrain&&b.terrain.prepareDrawTile(),K.activeTexture.set(Y.TEXTURE0),kt.bind(fe,Y.CLAMP_TO_EDGE),K.activeTexture.set(Y.TEXTURE1),pt?(pt.texture&&pt.texture.bind(fe,Y.CLAMP_TO_EDGE),Kt=Math.pow(2,pt.tileID.overscaledZ-ft.tileID.overscaledZ),Zt=[ft.tileID.canonical.x*Kt%1,ft.tileID.canonical.y*Kt%1]):kt.bind(fe,Y.CLAMP_TO_EDGE),"useMipmap"in kt&&K.extTextureFilterAnisotropic&&b.transform.pitch>20&&Y.texParameterf(Y.TEXTURE_2D,K.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,K.extTextureFilterAnisotropicMax);const Qt=b.transform;let gr;const qr=z?rC(Qt):[0,0,0,0];let Er,Br,zr,bn,Vn,fi=0;if(q&&ee instanceof s.aK&&ee.coordinates.length>3)Er=Float32Array.from(s.bc(s.cI(new s.bT(0,0,0)))),Br=Float32Array.from(Qt.globeMatrix),zr=Float32Array.from(s.cE(Qt)),bn=[s.av(Qt.center.lng),s.aC(Qt.center.lat)],gr=ee.elevatedGlobePerspectiveTransform,Vn=ee.elevatedGlobeGridMatrix||new Float32Array(9);else if(q){const xr=s.cF(He.canonical);fi=s.cG(xr.getCenter().lat),Er=Float32Array.from(s.bc(s.cI(He.canonical))),Br=Float32Array.from(Qt.globeMatrix),zr=Float32Array.from(s.cE(Qt)),bn=[s.av(Qt.center.lng),s.aC(Qt.center.lat)],gr=[0,0],Vn=Float32Array.from(s.cH(He.canonical,xr,fi,Qt.worldSize/Qt._pixelsPerMercatorPixel))}else gr=ee instanceof s.aK?ee.perspectiveTransform:[0,0],Er=new Float32Array(16),Br=new Float32Array(9),zr=new Float32Array(16),bn=[0,0],Vn=new Float32Array(9);const un=C1(Ct,Er,Br,zr,Vn,Zt||[0,0],s.ag(b.transform.zoom),bn,qr,Kt||1,It,h,gr,z?h.paint.get("raster-elevation"):0,2,Pt,Bt,Q.range,st,At,ie),ki=b.isTileAffectedByFog(He),Zr=b.getOrCreateProgram("raster",{defines:Q.defines,overrideFog:ki});if(b.uploadCommonUniforms(K,Zr,Ke),ee instanceof s.aK){const xr=ee.elevatedGlobeVertexBuffer,Nn=ee.elevatedGlobeIndexBuffer;if(le||!k)ee.boundsBuffer&&ee.boundsSegments&&Zr.draw(b,Y.TRIANGLES,rt,Kr.disabled,de,Gr.disabled,un,h.id,ee.boundsBuffer,b.quadTriangleIndexBuffer,ee.boundsSegments);else if(xr&&Nn){const Jn=Qt.zoom<=s.c6?ee.elevatedGlobeSegments:ee.getSegmentsForLongitude(Qt.center.lng);Jn&&Zr.draw(b,Y.TRIANGLES,rt,Kr.disabled,de,Fe,un,h.id,xr,Nn,Jn)}}else if(q){rt=new Cr(Y.LEQUAL,Cr.ReadOnly,b.depthRangeFor3D);const xr=b.globeSharedBuffers;if(xr){const[Nn,Jn,On]=xr.getGridBuffers(fi,!1);Zr.draw(b,Y.TRIANGLES,rt,Be||_t,b.colorModeForRenderPass(),Fe,un,h.id,Nn,Jn,On)}}else{const{tileBoundsBuffer:xr,tileBoundsIndexBuffer:Nn,tileBoundsSegments:Jn}=b.getTileBoundsBuffers(ft);Zr.draw(b,Y.TRIANGLES,rt,_t,de,Gr.disabled,un,h.id,xr,Nn,Jn)}}if(!(ee instanceof s.aK)&&q)for(const He of Le){const Ke=He.canonical.y===(1<<He.canonical.z)-1;He.canonical.y===0&&ut(!0,He,b,c,h,ie,Q,Fe,Be||Kr.disabled),Ke&&ut(!1,He,b,c,h,ie,Q,Fe===Gr.frontCW?Gr.backCW:Gr.frontCW,Be||Kr.disabled)}};q?$e(Re,b.renderElevatedRasterBackface?Gr.backCW:Gr.frontCW,b.stencilModeFor3D()):$e(Re,Gr.disabled,void 0),b.resetStencilClippingMasks()},"raster-particle":function(b,c,h,v,N,A){b.renderPass==="offscreen"&&function(k,z,q,K){if(!K.length)return;const Y=k.context,ee=Y.gl,Q=z.getSource();if(!(Q instanceof Rl))return;const ie=Math.ceil(Math.sqrt(q.paint.get("raster-particle-count")));let de=q.particlePositionRGBAImage;if(!de||de.width!==ie){const Re=function(Oe){const $e=Oe*Oe,Le=new Uint8Array(4*$e),Fe=function(He){return He|=0,He=Math.imul(2747636419^He,2654435769),He=Math.imul(He^He>>>16,2654435769),((He=Math.imul(He^He>>>16,2654435769))>>>0)/4294967296},Be=1/1.1;for(let He=0;He<$e;He++){const Ke=Be*(Fe(2*He+0)+ll),ft=Be*(Fe(2*He+1)+ll),at=255*Ke%1,kt=255*ft%1,Pt=at,Bt=ft-kt/255,st=kt;Le[4*He+0]=255*(Ke-at/255),Le[4*He+1]=255*Pt,Le[4*He+2]=255*Bt,Le[4*He+3]=255*st}return Le}(ie);de=q.particlePositionRGBAImage=new s.r({width:ie,height:ie},Re)}let le=q.particleFramebuffer;le?le.width!==ie&&(le.destroy(),le=q.particleFramebuffer=Y.createFramebuffer(ie,ie,!0,null)):le=q.particleFramebuffer=Y.createFramebuffer(ie,ie,!0,null);const he=[];for(const Re of K){const Oe=z.getTile(Re);if(!(Oe instanceof vo))continue;const $e=nC(Oe,Q,q);if(!$e)continue;const Le=[Oe.tileSize,Oe.tileSize];let Fe=q.tileFramebuffer;Fe||(Fe=q.tileFramebuffer=Y.createFramebuffer(Le[0],Le[1],!0,null));let Be=Oe.rasterParticleState;Be||(Be=Oe.rasterParticleState=new D1(Y,Re,Le,de));const He=Be.update(q.lastInvalidatedAt);Be.particleTextureDimension!==ie&&Be.updateParticleTexture(Re,de);const Ke=Be.targetColorTexture;Be.targetColorTexture=Be.backgroundColorTexture,Be.backgroundColorTexture=Ke;const ft=Be.particleTexture0;Be.particleTexture0=Be.particleTexture1,Be.particleTexture1=ft,he.push([Re,$e,Be,He])}if(he.length===0)return;const fe=s.q.now(),Te=q.previousDrawTimestamp?.001*(fe-q.previousDrawTimestamp):.0167;if(q.previousDrawTimestamp=fe,q.hasColorMap()){Y.activeTexture.set(ee.TEXTURE0+2);let Re=q.colorRampTexture;Re||(Re=q.colorRampTexture=new s.T(Y,q.colorRamp,ee.RGBA8)),Re.bind(ee.LINEAR,ee.CLAMP_TO_EDGE)}Y.bindFramebuffer.set(q.tileFramebuffer.framebuffer),function(Re,Oe,$e){const Le=Re.context,Fe=Le.gl,Be=Oe.tileFramebuffer;Le.activeTexture.set(Fe.TEXTURE0);const He={u_texture:0,u_opacity:1.05*(ft=Oe.paint.get("raster-particle-fade-opacity-factor"))/(ft+.05)},Ke=Re.getOrCreateProgram("rasterParticleTexture",{defines:[],overrideFog:!1});var ft;for(const at of $e){const[,,kt,Pt]=at;Be.colorAttachment.set(kt.targetColorTexture.texture),Le.viewport.set([0,0,Be.width,Be.height]),Le.clear({color:s.al.transparent}),Pt&&(kt.backgroundColorTexture.bind(Fe.NEAREST,Fe.CLAMP_TO_EDGE),Ke.draw(Re,Fe.TRIANGLES,Cr.disabled,Kr.disabled,mn.alphaBlended,Gr.disabled,He,Oe.id,Re.viewportBuffer,Re.quadTriangleIndexBuffer,Re.viewportSegments))}}(k,q,he),function(Re,Oe,$e,Le){const Fe=Re.context,Be=Fe.gl,He=$e.tileFramebuffer,Ke=Re.transform.projection.name==="globe",ft=$e.paint.get("raster-particle-max-speed");for(const at of Le){const[kt,Pt,Bt]=at;Fe.activeTexture.set(Be.TEXTURE0+0),Pt.texture.bind(Be.LINEAR,Be.CLAMP_TO_EDGE),He.colorAttachment.set(Bt.targetColorTexture.texture);const st=Re.getOrCreateProgram("rasterParticleDraw",{defines:Pt.defines,overrideFog:!1});Fe.activeTexture.set(Be.TEXTURE0+1);const At=Pt.scalarData?[]:[0,1,2,3].map(_t=>s.d7[_t](kt));At.push(kt);const rt=kt.canonical.x,Ct=kt.canonical.y;for(const _t of At){const Et=Oe.getTile(Ke?_t.wrapped():_t);if(!Et)continue;const pt=Et.rasterParticleState;if(!pt)continue;const It=_t.canonical.x+(1<<_t.canonical.z)*(_t.wrap-kt.wrap),Kt=_t.canonical.y;pt.particleTexture0.bind(Be.NEAREST,Be.CLAMP_TO_EDGE);const Zt=A1(1,pt.particleTexture0.size[0],[It-rt,Kt-Ct],0,Pt.texture.size,2,ft,Pt.textureOffset,Pt.scale,Pt.offset);st.draw(Re,Be.POINTS,Cr.disabled,Kr.disabled,mn.alphaBlended,Gr.disabled,Zt,$e.id,pt.particleIndexBuffer,void 0,pt.particleSegment)}}}(k,z,q,he),Y.bindFramebuffer.set(q.particleFramebuffer.framebuffer),function(Re,Oe,$e,Le){const Fe=Re.context,Be=Fe.gl,He=Oe.paint.get("raster-particle-max-speed"),Ke=Le*Oe.paint.get("raster-particle-speed-factor")*.15,ft=function(kt){return Math.pow(kt,6)}(.01+1*Oe.paint.get("raster-particle-reset-rate-factor")),at=Oe.particleFramebuffer;Fe.viewport.set([0,0,at.width,at.height]);for(const kt of $e){const[,Pt,Bt]=kt;Fe.activeTexture.set(Be.TEXTURE0+0),Pt.texture.bind(Be.LINEAR,Be.CLAMP_TO_EDGE),Fe.activeTexture.set(Be.TEXTURE0+1);const st=Bt.particleTexture0;st.bind(Be.NEAREST,Be.CLAMP_TO_EDGE);const At=s4(1,st.size[0],0,Pt.texture.size,He,Ke,ft,Pt.textureOffset,Pt.scale,Pt.offset);at.colorAttachment.set(Bt.particleTexture1.texture),Fe.clear({color:s.al.transparent}),Re.getOrCreateProgram("rasterParticleUpdate",{defines:Pt.defines}).draw(Re,Be.TRIANGLES,Cr.disabled,Kr.disabled,mn.unblended,Gr.disabled,At,Oe.id,Re.viewportBuffer,Re.quadTriangleIndexBuffer,Re.viewportSegments)}}(k,q,he,Te)}(b,c,h,v),b.renderPass==="translucent"&&(function(k,z,q,K,Y){const ee=k.context,Q=ee.gl,ie=z.getSource().tileSize,de=5*(1-s.ae(s.bY,s.bY+1,k.transform.zoom))*ie+q.paint.get("raster-particle-elevation"),le=!k.options.moving,he=k.transform.projection.name==="globe";if(!K.length)return;const[fe,Te]=k.stencilConfigForOverlap(K),Re=[];he&&Re.push("PROJECTION_GLOBE_VIEW");const Oe=k.stencilModeFor3D();for(const $e of Te){const Le=$e.toUnwrapped(),Fe=z.getTile($e);if(!Fe.rasterParticleState)continue;const Be=Fe.rasterParticleState,He=100;Fe.registerFadeDuration(He);const Ke=z.findLoadedParent($e,0),ft=Xx(Fe,Ke,z,k.transform,He);let at,kt;k.terrain&&k.terrain.prepareDrawTile(),ee.activeTexture.set(Q.TEXTURE0),Be.targetColorTexture.bind(Q.LINEAR,Q.CLAMP_TO_EDGE),ee.activeTexture.set(Q.TEXTURE1),Ke&&Ke.rasterParticleState?(Ke.rasterParticleState.targetColorTexture.bind(Q.LINEAR,Q.CLAMP_TO_EDGE),at=Math.pow(2,Ke.tileID.overscaledZ-Fe.tileID.overscaledZ),kt=[Fe.tileID.canonical.x*at%1,Fe.tileID.canonical.y*at%1]):Be.targetColorTexture.bind(Q.LINEAR,Q.CLAMP_TO_EDGE);const Pt=he?Float32Array.from(k.transform.expandedFarZProjMatrix):k.transform.calculateProjMatrix(Le,le),Bt=k.transform,st=iC(Bt),At=s.cF($e.canonical),rt=s.cG(At.getCenter().lat);let Ct,_t,Et,pt,It;he?(Ct=Float32Array.from(s.bc(s.cI($e.canonical))),_t=Float32Array.from(Bt.globeMatrix),Et=Float32Array.from(s.cE(Bt)),pt=[s.av(Bt.center.lng),s.aC(Bt.center.lat)],It=Float32Array.from(s.cH($e.canonical,At,rt,Bt.worldSize/Bt._pixelsPerMercatorPixel))):(Ct=new Float32Array(16),_t=new Float32Array(9),Et=new Float32Array(16),pt=[0,0],It=new Float32Array(9));const Kt=Tr(Pt,Ct,_t,Et,It,kt||[0,0],s.ag(k.transform.zoom),pt,st,at||1,ft,de),Zt=k.isTileAffectedByFog($e),Qt=k.getOrCreateProgram("rasterParticle",{defines:Re,overrideFog:Zt});if(k.uploadCommonUniforms(ee,Qt,Le),he){const gr=new Cr(Q.LEQUAL,Cr.ReadOnly,k.depthRangeFor3D),qr=0,Er=k.globeSharedBuffers;if(Er){const[Br,zr,bn]=Er.getGridBuffers(rt,qr!==0);Qt.draw(k,Q.TRIANGLES,gr,Oe,mn.alphaBlended,k.renderElevatedRasterBackface?Gr.frontCCW:Gr.backCCW,Kt,q.id,Br,zr,bn)}}else{const gr=k.depthModeForSublayer(0,Cr.ReadOnly),qr=fe[$e.overscaledZ],{tileBoundsBuffer:Er,tileBoundsIndexBuffer:Br,tileBoundsSegments:zr}=k.getTileBoundsBuffers(Fe);Qt.draw(k,Q.TRIANGLES,gr,qr,mn.alphaBlended,Gr.disabled,Kt,q.id,Er,Br,zr)}}k.resetStencilClippingMasks()}(b,c,h,v),b.style.map.triggerRepaint())},background:function(b,c,h,v){const N=h.paint.get("background-color"),A=h.paint.get("background-color-use-theme").constantOr("default")==="none",k=h.paint.get("background-opacity"),z=h.paint.get("background-emissive-strength"),q=h.paint.get("background-pitch-alignment")==="viewport";if(k===0)return;const K=b.context,Y=K.gl,ee=b.transform,Q=ee.tileSize,ie=h.paint.get("background-pattern");let de;if(ie!==void 0&&(ie===null||(de=b.imageManager.getPattern(s.I.from(ie.toString()),h.scope,b.style.getLut(h.scope)),!de)))return;const le=!ie&&N.a===1&&k===1&&b.opaquePassEnabledForLayer()?"opaque":"translucent";if(b.renderPass!==le)return;const he=Kr.disabled,fe=b.depthModeForSublayer(0,le==="opaque"?Cr.ReadWrite:Cr.ReadOnly),Te=b.colorModeForDrapableLayerRenderPass(z),Re=ie?"backgroundPattern":"background";let Oe,$e=v;if($e||(Oe=b.getBackgroundTiles(),$e=Object.values(Oe).map(Le=>Le.tileID)),ie&&(K.activeTexture.set(Y.TEXTURE0),b.imageManager.bind(b.context,h.scope)),q){const Le=b.getOrCreateProgram(Re,{overrideFog:!1,overrideRtt:!0}),Fe=new Float32Array(s.ad.mat4.identity([])),Be=new s.aH(0,0,0,0,0),He=ie?QS(Fe,z,k,b,0,h.scope,de,q,{tileID:Be,tileSize:Q}):T1(Fe,z,k,N.toRenderColor(A?null:h.lut));Le.draw(b,Y.TRIANGLES,fe,he,Te,Gr.disabled,He,h.id,b.viewportBuffer,b.quadTriangleIndexBuffer,b.viewportSegments)}else for(const Le of $e){const Fe=b.isTileAffectedByFog(Le),Be=b.getOrCreateProgram(Re,{overrideFog:Fe}),He=Le.toUnwrapped(),Ke=v?Le.projMatrix:b.transform.calculateProjMatrix(He);b.prepareDrawTile();const ft=c?c.getTile(Le):Oe?Oe[Le.key]:new lc(Le,Q,ee.zoom,b),at=ie?QS(Ke,z,k,b,0,h.scope,de,q,{tileID:Le,tileSize:Q}):T1(Ke,z,k,N.toRenderColor(A?null:h.lut));b.uploadCommonUniforms(K,Be,He);const{tileBoundsBuffer:kt,tileBoundsIndexBuffer:Pt,tileBoundsSegments:Bt}=b.getTileBoundsBuffers(ft);Be.draw(b,Y.TRIANGLES,fe,he,Te,Gr.disabled,at,h.id,kt,Pt,Bt)}},sky:function(b,c,h){const v=b._atmosphere?s.ag(b.transform.zoom):1,N=h.paint.get("sky-opacity")*v;if(N===0)return;const A=b.context,k=h.paint.get("sky-type"),z=new Cr(A.gl.LEQUAL,Cr.ReadOnly,[0,1]),q=b.frameCounter/1e3%1;k==="atmosphere"?b.renderPass==="offscreen"?h.needsSkyboxCapture(b)&&(function(K,Y,ee,Q){const ie=K.context,de=ie.gl;let le=Y.skyboxFbo;if(!le){le=Y.skyboxFbo=ie.createFramebuffer(32,32,!0,null),Y.skyboxGeometry=new aC(ie),Y.skyboxTexture=ie.gl.createTexture(),de.bindTexture(de.TEXTURE_CUBE_MAP,Y.skyboxTexture),de.texParameteri(de.TEXTURE_CUBE_MAP,de.TEXTURE_WRAP_S,de.CLAMP_TO_EDGE),de.texParameteri(de.TEXTURE_CUBE_MAP,de.TEXTURE_WRAP_T,de.CLAMP_TO_EDGE),de.texParameteri(de.TEXTURE_CUBE_MAP,de.TEXTURE_MIN_FILTER,de.LINEAR),de.texParameteri(de.TEXTURE_CUBE_MAP,de.TEXTURE_MAG_FILTER,de.LINEAR);for(let Re=0;Re<6;++Re)de.texImage2D(de.TEXTURE_CUBE_MAP_POSITIVE_X+Re,0,de.RGBA,32,32,0,de.RGBA,de.UNSIGNED_BYTE,null)}ie.bindFramebuffer.set(le.framebuffer),ie.viewport.set([0,0,32,32]);const he=Y.getCenter(K,!0),fe=K.getOrCreateProgram("skyboxCapture"),Te=new Float64Array(16);s.ad.mat4.identity(Te),s.ad.mat4.rotateY(Te,Te,.5*-Math.PI),ua(K,Y,fe,Te,he,0),s.ad.mat4.identity(Te),s.ad.mat4.rotateY(Te,Te,.5*Math.PI),ua(K,Y,fe,Te,he,1),s.ad.mat4.identity(Te),s.ad.mat4.rotateX(Te,Te,.5*-Math.PI),ua(K,Y,fe,Te,he,2),s.ad.mat4.identity(Te),s.ad.mat4.rotateX(Te,Te,.5*Math.PI),ua(K,Y,fe,Te,he,3),s.ad.mat4.identity(Te),ua(K,Y,fe,Te,he,4),s.ad.mat4.identity(Te),s.ad.mat4.rotateY(Te,Te,Math.PI),ua(K,Y,fe,Te,he,5),ie.viewport.set([0,0,K.width,K.height])}(b,h),h.markSkyboxValid(b)):b.renderPass==="sky"&&function(K,Y,ee,Q,ie){const de=K.context,le=de.gl,he=K.transform,fe=K.getOrCreateProgram("skybox");de.activeTexture.set(le.TEXTURE0),le.bindTexture(le.TEXTURE_CUBE_MAP,Y.skyboxTexture);const Te=((Re,Oe,$e,Le,Fe)=>({u_matrix:Re,u_sun_direction:Oe,u_cubemap:0,u_opacity:Le,u_temporal_offset:Fe}))(he.skyboxMatrix,Y.getCenter(K,!1),0,Q,ie);K.uploadCommonUniforms(de,fe),fe.draw(K,le.TRIANGLES,ee,Kr.disabled,K.colorModeForRenderPass(),Gr.backCW,Te,"skybox",Y.skyboxGeometry.vertexBuffer,Y.skyboxGeometry.indexBuffer,Y.skyboxGeometry.segment)}(b,h,z,N,q):k==="gradient"&&b.renderPass==="sky"&&function(K,Y,ee,Q,ie){const de=K.context,le=de.gl,he=K.transform,fe=K.getOrCreateProgram("skyboxGradient");Y.skyboxGeometry||(Y.skyboxGeometry=new aC(de)),de.activeTexture.set(le.TEXTURE0);let Te=Y.colorRampTexture;Te||(Te=Y.colorRampTexture=new s.T(de,Y.colorRamp,le.RGBA8)),Te.bind(le.LINEAR,le.CLAMP_TO_EDGE);const Re=((Oe,$e,Le,Fe,Be)=>({u_matrix:Oe,u_color_ramp:0,u_center_direction:$e,u_radius:s.ak(Le),u_opacity:Fe,u_temporal_offset:Be}))(he.skyboxMatrix,Y.getCenter(K,!1),Y.paint.get("sky-gradient-radius"),Q,ie);K.uploadCommonUniforms(de,fe),fe.draw(K,le.TRIANGLES,ee,Kr.disabled,K.colorModeForRenderPass(),Gr.backCW,Re,"skyboxGradient",Y.skyboxGeometry.vertexBuffer,Y.skyboxGeometry.indexBuffer,Y.skyboxGeometry.segment)}(b,h,z,N,q)},debug:function(b,c,h,v,N,A){for(let k=0;k<h.length;k++)if(N){const K=new s.al(v.r*.8,v.g*.8,v.b*.8,1);Bd(b,c,h[k],v,-1,-1,A),Bd(b,c,h[k],v,-1,1,A),Bd(b,c,h[k],v,1,1,A),Bd(b,c,h[k],v,1,-1,A),Bd(b,c,h[k],K,0,0,A)}else Bd(b,c,h[k],v,0,0,A)},custom:function(b,c,h,v){const N=b.context,A=h.implementation;if(!b.transform.projection.unsupportedLayers||!b.transform.projection.unsupportedLayers.includes("custom")||b.terrain&&(b.terrain.renderingToTexture||b.renderPass==="offscreen")&&h.isDraped(c)){if(b.renderPass==="offscreen"){const k=A.prerender;if(k){if(b.setCustomLayerDefaults(),N.setColorMode(b.colorModeForRenderPass()),b.transform.projection.name==="globe"){const z=b.transform.pointMerc;k.call(A,N.gl,b.transform.customLayerMatrix(),b.transform.getProjection(),b.transform.globeToMercatorMatrix(),s.ag(b.transform.zoom),[z.x,z.y],b.transform.pixelsPerMeterRatio)}else k.call(A,N.gl,b.transform.customLayerMatrix());N.setDirty(),b.setBaseState()}}else if(b.renderPass==="translucent"){if(b.terrain&&b.terrain.renderingToTexture){const z=A.renderToTile;if(z){const q=v[0].canonical,K=new s.ac(q.x+v[0].wrap*(1<<q.z),q.y,q.z);N.setDepthMode(Cr.disabled),N.setStencilMode(Kr.disabled),N.setColorMode(b.colorModeForRenderPass()),b.setCustomLayerDefaults(),z.call(A,N.gl,K),N.setDirty(),b.setBaseState()}return}b.setCustomLayerDefaults(),N.setColorMode(b.colorModeForRenderPass()),N.setStencilMode(Kr.disabled);const k=A.renderingMode==="3d"?new Cr(b.context.gl.LEQUAL,Cr.ReadWrite,b.depthRangeFor3D):b.depthModeForSublayer(0,Cr.ReadOnly);if(N.setDepthMode(k),b.transform.projection.name==="globe"){const z=b.transform.pointMerc;A.render(N.gl,b.transform.customLayerMatrix(),b.transform.getProjection(),b.transform.globeToMercatorMatrix(),s.ag(b.transform.zoom),[z.x,z.y],b.transform.pixelsPerMeterRatio)}else A.render(N.gl,b.transform.customLayerMatrix());N.setDirty(),b.setBaseState(),N.bindFramebuffer.set(null)}}else s.w("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(b,c,h,v){if(b.renderPass==="opaque")return;const N=h.paint.get("model-opacity").constantOr(1);if(N===0)return;const A=h.paint.get("model-cast-shadows");if(b.renderPass==="shadow"&&(!A||b.terrain&&N<.65&&h._transitionablePaint._values["model-opacity"].value.expression instanceof s.ab))return;const k=b.shadowRenderer,z=h.paint.get("model-receive-shadows");k&&(k.useNormalOffset=!0,z||(k.enabled=!1));const q=()=>{k&&(k.useNormalOffset=!0,z||(k.enabled=!0))},K=c.getSource();if(b.renderPass==="light-beam"&&K.type!=="batched-model")return;if(K.type==="vector"||K.type==="geojson")return function(fe,Te,Re,Oe,$e){const Le=fe.transform;if(Le.projection.name!=="mercator")return void s.w(`Drawing 3D models for ${Le.projection.name} projection is not yet implemented`);const Fe=Le.getFreeCameraOptions().position;if(!fe.modelManager)return;const Be=fe.modelManager;Re.modelManager=Be;const He=fe.shadowRenderer;if(!Re._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const Ke=Re._unevaluatedLayout._values["model-id"],ft=Object.assign({},Re.layout.get("model-id").parameters),at=fe.style.order.indexOf(Re.fqid);for(const kt of Oe){const Pt=Te.getTile(kt).getBucket(Re);if(!Pt||Pt.projection.name!==Le.projection.name)continue;const Bt=Pt.getModelUris();Bt&&!Pt.modelsRequested&&(Be.addModelsFromBucket(Bt,$e),Pt.modelsRequested=!0);const st=B1(kt,Le);ft.zoom=st;const At=Ke.possiblyEvaluate(ft);if(F1(fe,Pt,kt),Bl.shadowUniformsInitialized=!1,Bl.useSingleShadowCascade=!!He&&He.getMaxCascadeForTile(kt.toUnwrapped())===0,fe.renderPass==="shadow"&&He){if(fe.currentShadowCascade===1&&Pt.isInsideFirstShadowMapFrustum)continue;const _t=Le.calculatePosMatrix(kt.toUnwrapped(),Le.worldSize);if(Bl.tileMatrix.set(_t),Bl.shadowTileMatrix=Float32Array.from(He.calculateShadowPassMatrixFromMatrix(_t)),Bl.aabb.min.fill(0),Bl.aabb.max[0]=Bl.aabb.max[1]=s.ai,Bl.aabb.max[2]=0,hy(Pt,Bl,fe,Re.scope))continue}const rt=1<<kt.canonical.z,Ct=[((Fe.x-kt.wrap)*rt-kt.canonical.x)*s.ai,(Fe.y*rt-kt.canonical.y)*s.ai,Fe.z*rt*s.ai];fe.conflationActive&&Object.keys(Pt.instancesPerModel).length>0&&fe.style.isLayerClipped(Re,Te.getSource())&&Pt.updateReplacement(kt,fe.replacementSource,at,$e)&&(Pt.uploaded=!1,Pt.upload(fe.context));for(let _t in Pt.instancesPerModel){const Et=Pt.instancesPerModel[_t];Et.features.length>0&&(_t=At.evaluate(Et.features[0].feature,{}));const pt=Be.getModel(_t,$e);if(pt&&pt.uploaded)for(const It of pt.nodes)hc(fe,Re,It,Et,Ct,kt,Bl)}}}(b,c,h,v,K.type==="vector"?h.scope:""),void q();if(!K.loaded())return;if(K.type==="batched-model")return function(fe,Te,Re,Oe){Re.resetLayerRenderingStats(fe);const $e=fe.context,Le=fe.transform,Fe=fe.style.fog,Be=fe.shadowRenderer;if(Le.projection.name!=="mercator")return void s.w(`Drawing 3D landmark models for ${Le.projection.name} projection is not yet implemented`);const He=fe.transform.getFreeCameraOptions().position,Ke=s.ad.vec3.scale([],[He.x,He.y,He.z],fe.transform.worldSize),ft=s.ad.vec3.negate([],Ke),at=s.ad.mat4.identity([]),kt=s.dm(Le.center.lat,Le.zoom),Pt=s.ad.mat4.fromScaling([],[1,1,1/kt]);s.ad.mat4.translate(at,at,ft);const Bt=Re.paint.get("model-opacity").constantOr(1),st=new Cr($e.gl.LEQUAL,Cr.ReadWrite,fe.depthRangeFor3D),At=new Cr($e.gl.LEQUAL,Cr.ReadOnly,fe.depthRangeFor3D),rt=new s.ce([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),Ct=fe.renderPass==="shadow",_t=Ct&&Be?Be.getCurrentCascadeFrustum():Le.getFrustum(Le.scaleZoom(Le.worldSize)),Et=Re.paint.get("model-front-cutoff"),pt=Et[2]<1,It=Ru(fe,Re.paint.get("model-cutoff-fade-range")),Kt=Re.getLayerRenderingStats();(function(Zt,Qt,gr,qr){const Er=Zt.terrain?Zt.terrain.exaggeration():0,Br=Zt.transform.zoom;for(const zr of qr){const bn=Qt.getTile(zr).getBucket(gr);bn&&(bn.setFilter(gr.filter),Zt.conflationActive&&bn.updateReplacement(zr,Zt.replacementSource),bn.evaluateScale(Zt,gr),Zt.terrain&&Er>0&&bn.elevationUpdate(Zt.terrain,Er,zr,gr.source),bn.needsReEvaluation(Zt,Br,gr)&&bn.evaluate(gr))}})(fe,Te,Re,Oe),function(){let Zt,Qt,gr;pt?(Zt=Oe.length-1,Qt=-1,gr=-1):(Zt=0,Qt=Oe.length,gr=1);const qr=new Float64Array(16),Er=s.ad.vec3.create(),Br=new s.P(0,0);for(let zr=Zt;zr!==Qt;zr+=gr){const bn=Oe[zr],Vn=Te.getTile(bn).getBucket(Re);if(!Vn||!Vn.uploaded)continue;let fi=!1;Be&&(fi=Be.getMaxCascadeForTile(bn.toUnwrapped())===0);const un=Le.calculatePosMatrix(bn.toUnwrapped(),Le.worldSize),ki=Vn.modelTraits;!Ct&&pt&&(s.ad.mat4.invert(qr,un),s.ad.vec3.transformMat4(Er,Ke,qr),Br.x=Er[0],Br.y=Er[1]);const Zr=[];Vn.setFilter(Re.filter);for(const xr of Vn.getNodesInfo()){if(xr.hiddenByReplacement||!xr.node.meshes)continue;const Nn=xr.node;let Jn=0;fe.terrain&&Nn.elevation&&(Jn=Nn.elevation*fe.terrain.exaggeration());const On=(()=>{const oi=xr.aabb;return rt.min=[...oi.min],rt.max=[...oi.max],rt.min[2]+=Jn,rt.max[2]+=Jn,s.ad.vec3.transformMat4(rt.min,rt.min,un),s.ad.vec3.transformMat4(rt.max,rt.max,un),rt})(),es=xr.evaluatedScale;if(es[0]<=1&&es[1]<=1&&es[2]<=1&&On.intersects(_t)===0)continue;if(!Ct&&pt){const oi=.16666666666666666;xr.cameraCollisionOpacity=Ke[0]>On.min[0]&&Ke[0]<On.max[0]&&Ke[1]>On.min[1]&&Ke[1]<On.max[1]&&Ke[2]*kt<On.max[2]&&Nn.footprint&&s.bA(Br,Nn.footprint)?Math.max(xr.cameraCollisionOpacity-oi,0):Math.min(1,xr.cameraCollisionOpacity+oi)}const js=[...un],Gs=Nn.anchor?Nn.anchor[0]:0,Qs=Nn.anchor?Nn.anchor[1]:0;s.ad.mat4.translate(js,js,[Gs*(es[0]-1),Qs*(es[1]-1),Jn]),s.ad.vec3.exactEquals(es,s.dq)||s.ad.mat4.scale(js,js,es);const dl=s.ad.mat4.multiply([],js,Nn.matrix),Wa=s.ad.mat4.multiply([],Le.expandedFarZProjMatrix,dl),Pn=s.ad.mat4.multiply([],Le.expandedFarZProjMatrix,js),Pi=s.ad.vec4.transformMat4([],[Gs,Qs,Jn,1],Wa)[2];Nn.hidden=!1;let Un=Bt;Ct||(pt&&(Un*=xr.cameraCollisionOpacity,Un*=$1(js,Le,xr.aabb,Et)),Un*=my(It,Pi)),Un!==0?Zr.push({nodeInfo:xr,depth:Pi,opacity:Un,wvpForNode:Wa,wvpForTile:Pn,nodeModelMatrix:dl,tileModelMatrix:js}):Nn.hidden=!0}Ct||Zr.sort((xr,Nn)=>!pt||xr.opacity===1&&Nn.opacity===1?xr.depth<Nn.depth?-1:1:xr.opacity===1?-1:Nn.opacity===1?1:xr.depth>Nn.depth?-1:1);for(const xr of Zr){const Nn=xr.nodeInfo,Jn=Nn.node;let On=s.ad.mat4.multiply([],Pt,xr.tileModelMatrix);s.ad.mat4.multiply(On,at,On);const es=s.ad.mat4.invert([],On);s.ad.mat4.transpose(es,es),s.ad.mat4.scale(es,es,$d),On=s.ad.mat4.multiply(On,On,Jn.matrix);const js=fe.renderPass==="light-beam",Gs=Re.paint.get("model-color-use-theme").constantOr("default")==="none",Qs=ki&s.ds.HasMapboxMeshFeatures,dl=Qs?0:Nn.evaluatedRMEA[0][2];for(let Wa=0;Wa<Jn.meshes.length;++Wa){const Pn=Jn.meshes[Wa],Pi=Wa===Jn.lightMeshIndex;let Un=xr.wvpForNode;if(Pi){if(!js&&!fe.terrain&&fe.shadowRenderer){fe.currentLayer<fe.firstLightBeamLayer&&(fe.firstLightBeamLayer=fe.currentLayer);continue}Un=xr.wvpForTile}else if(js)continue;const oi={defines:[]},_a=[];if(!Ct&&Be&&(Be.useNormalOffset=!!Pn.normalBuffer),jf(oi.defines,_a,Pn,fe,Gs?null:Re.lut),Qs||oi.defines.push("DIFFUSE_SHADED"),fi&&oi.defines.push("SHADOWS_SINGLE_CASCADE"),Kt&&(Ct?Kt.numRenderedVerticesInShadowPass+=Pn.vertexArray.length:Kt.numRenderedVerticesInTransparentPass+=Pn.vertexArray.length),Ct){Bg(Pn,xr.nodeModelMatrix,fe,Re);continue}let ji=null;if(Fe){const Ul=Bu(xr.nodeModelMatrix,fe.transform);if(ji=new Float32Array(Ul),Le.projection.name!=="globe"){const Bo=Pn.aabb.min,Uu=Pn.aabb.max,[ru,Gu]=Fe.getOpacityForBounds(Ul,Bo[0],Bo[1],Uu[0],Uu[1]);oi.overrideFog=ru>=nr||Gu>=nr}}const Hs=Pn.material;let tu;Hs.occlusionTexture&&Hs.occlusionTexture.offsetScale&&(tu=Hs.occlusionTexture.offsetScale,oi.defines.push("OCCLUSION_TEXTURE_TRANSFORM"));const Fo=fe.getOrCreateProgram("model",oi);!Ct&&Be&&Be.setupShadowsFromMatrix(xr.tileModelMatrix,Fo,Be.useNormalOffset),fe.uploadCommonUniforms($e,Fo,null,ji);const Vl=Hs.pbrMetallicRoughness;Vl.metallicFactor=.9,Vl.roughnessFactor=.5;const _o=k1(new Float32Array(Un),new Float32Array(On),new Float32Array(es),new Float32Array(Jn.matrix),fe,xr.opacity,Vl.baseColorFactor.toRenderColor(null),Hs.emissiveFactor,Vl.metallicFactor,Vl.roughnessFactor,Hs,dl,Re,[0,0,0],tu);!Pi&&(Nn.hasTranslucentParts||xr.opacity<1)&&Fo.draw(fe,$e.gl.TRIANGLES,st,Kr.disabled,mn.disabled,Gr.backCCW,_o,Re.id,Pn.vertexBuffer,Pn.indexBuffer,Pn.segments,Re.paint,fe.transform.zoom,void 0,_a),Fo.draw(fe,$e.gl.TRIANGLES,Pi?At:st,Kr.disabled,Pi||xr.opacity<1||Nn.hasTranslucentParts?mn.alphaBlended:mn.unblended,Gr.backCCW,_o,Re.id,Pn.vertexBuffer,Pn.indexBuffer,Pn.segments,Re.paint,fe.transform.zoom,void 0,_a)}}}}()}(b,c,h,v),void q();if(K.type!=="model")return;const Y=K.getModels(),ee=[],Q=b.transform.getFreeCameraOptions().position,ie=s.ad.vec3.scale([],[Q.x,Q.y,Q.z],b.transform.worldSize);s.ad.vec3.negate(ie,ie);const de=[],le=[];let he=0;for(const fe of Y){const Te=h.paint.get("model-rotation").constantOr(null),Re=h.paint.get("model-scale").constantOr(null),Oe=h.paint.get("model-translation").constantOr(null);fe.computeModelMatrix(b,Te,Re,Oe,!0,!0,!1);const $e=s.ad.mat4.identity([]),Le=s.dm(fe.position.lat,b.transform.zoom),Fe=s.ad.mat4.fromScaling([],[1,1,1/Le]);s.ad.mat4.translate($e,$e,ie),ee.push({zScaleMatrix:Fe,negCameraPosMatrix:$e});for(const Be of fe.nodes)Gh(b.transform,Be,fe.matrix,b.transform.expandedFarZProjMatrix,he,de,le);he++}if(de.sort((fe,Te)=>Te.depth-fe.depth),b.renderPass!=="shadow"){if(N===1)for(const fe of le)$u(fe,b,h,ee[fe.modelIndex],Kr.disabled,b.colorModeForRenderPass());else{for(const fe of le)$u(fe,b,h,ee[fe.modelIndex],Kr.disabled,mn.disabled);for(const fe of le)$u(fe,b,h,ee[fe.modelIndex],b.stencilModeFor3D(),b.colorModeForRenderPass());b.resetStencilClippingMasks()}for(const fe of de)$u(fe,b,h,ee[fe.modelIndex],Kr.disabled,b.colorModeForRenderPass());q()}else{for(const fe of le)Bg(fe.mesh,fe.nodeModelMatrix,b,h);for(const fe of de)Bg(fe.mesh,fe.nodeModelMatrix,b,h);q()}}},xy={line:function(b,c,h){if(b.hasElevatedBuckets=!1,b.hasNonElevatedBuckets=!1,b._unevaluatedLayout.getValue("line-elevation-reference")!==void 0||b._unevaluatedLayout.getValue("line-z-offset")!==void 0){if(c){const v=c.getVisibleCoordinates();for(const N of v){const A=c.getTile(N).getBucket(b);if(A&&(A.hasZOffset?b.hasElevatedBuckets=!0:b.hasNonElevatedBuckets=!0,b.hasElevatedBuckets&&b.hasNonElevatedBuckets))break}}}else b.hasNonElevatedBuckets=!0},model:function(b,c,h){const v=c.getSource();if(!v.loaded())return;if(v.type==="vector"||v.type==="geojson")return void(h.modelManager&&h.modelManager.upload(h,v.type==="vector"?b.scope:""));if(v.type==="batched-model"||v.type!=="model")return;const N=v.getModels();for(const A of N)A.upload(h.context)},raster:function(b,c,h){const v=c.getSource();if(!(v instanceof Rl&&v.loaded()))return;const N=b.sourceLayer||v.rasterLayerIds&&v.rasterLayerIds[0];if(!N)return;const A=b.paint.get("raster-array-band")||v.getInitialBand(N);if(A==null)return;const k=c.getIds().map(z=>c.getTileByID(z));for(const z of k)z.updateNeeded(N,A)&&v.prepareTile(z,N,A)},"raster-particle":function(b,c,h){const v=c.getSource();if(!(v instanceof Rl&&v.loaded()))return;const N=b.sourceLayer||v.rasterLayerIds&&v.rasterLayerIds[0];if(!N)return;const A=b.paint.get("raster-particle-array-band")||v.getInitialBand(N);if(A==null)return;const k=c.getIds().map(z=>c.getTileByID(z));for(const z of k)z.updateNeeded(N,A)&&v.prepareTile(z,N,A)}},yy={fill:O1};class vy{constructor(c,h,v,N,A){this.context=new Fd(c,h),this.transform=v,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.tp=A,this._timeStamp=s.q.now(),this._averageFPS=0,this._fpsHistory=[],this._dt=0,this._debugParams={forceEnablePrecipitation:!1,showTerrainProxyTiles:!1,fpsWindow:30,continousRedraw:!1,enabledLayers:{}};const k=["fill","line","symbol","circle","heatmap","fill-extrusion","raster","raster-particle","hillshade","model","background","sky"];for(const q of k)this._debugParams.enabledLayers[q]=!0;A.registerParameter(this._debugParams,["Terrain"],"showTerrainProxyTiles",{},()=>{this.style.map.triggerRepaint()}),A.registerParameter(this._debugParams,["Precipitation"],"forceEnablePrecipitation"),A.registerParameter(this._debugParams,["FPS"],"fpsWindow",{min:1,max:100,step:1}),A.registerBinding(this._debugParams,["FPS"],"continousRedraw",{readonly:!0,label:"continuous redraw"}),A.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"value"}),A.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"graph",view:"graph",min:0,max:200});for(const q of k)A.registerParameter(this._debugParams.enabledLayers,["Debug","Layers"],q);this.occlusionParams=new U1(A),this.setup(),this.numSublayers=Dl.maxUnderzooming+Dl.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new s.dy,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new Du(this),this._wireframeDebugCache=new Hh,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0,this.layersWithOcclusionOpacity=[];const z=new s.r({width:1,height:1},Uint8Array.of(0,0,0,0));this.emptyDepthTexture=new s.T(this.context,z,c.RGBA8),this._clippingActiveLastFrame=!1,this.scaleFactor=N}updateTerrain(c,h){const v=!!c&&!!c.terrain&&this.transform.projection.supportsTerrain;if(!(v||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new WS(this,c));const N=this._terrain;this.transform.elevation=v?N:null,N.update(c,this.transform,h),this.transform.elevation&&!N.enabled&&(this.transform.elevation=null)}_updateFog(c){const h=c.fog;if(!h||this.transform.projection.name==="globe"||h.getOpacity(this.transform.pitch)<1||h.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[v,N]=h.getFovAdjustedRange(this.transform._fov);if(v>N)return void(this.transform.fogCullDistSq=null);const A=v+.78*(N-v);this.transform.fogCullDistSq=A*A}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled||this._forceTerrainMode?this._terrain:null}get forceTerrainMode(){return this._forceTerrainMode}set forceTerrainMode(c){c&&!this._terrain&&(this._terrain=new WS(this,this.style)),this._forceTerrainMode=c}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(c,h){if(this.width=c*s.q.devicePixelRatio,this.height=h*s.q.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const v of this.style.order)this.style._mergedLayers[v].resize()}setup(){const c=this.context,h=new s.b5;h.emplaceBack(0,0),h.emplaceBack(s.ai,0),h.emplaceBack(0,s.ai),h.emplaceBack(s.ai,s.ai),this.tileExtentBuffer=c.createVertexBuffer(h,s.b7.members),this.tileExtentSegments=s.b8.simpleSegment(0,0,4,2);const v=new s.b5;v.emplaceBack(0,0),v.emplaceBack(s.ai,0),v.emplaceBack(0,s.ai),v.emplaceBack(s.ai,s.ai),this.debugBuffer=c.createVertexBuffer(v,s.b7.members),this.debugSegments=s.b8.simpleSegment(0,0,4,5);const N=new s.b5;N.emplaceBack(-1,-1),N.emplaceBack(1,-1),N.emplaceBack(-1,1),N.emplaceBack(1,1),this.viewportBuffer=c.createVertexBuffer(N,s.b7.members),this.viewportSegments=s.b8.simpleSegment(0,0,4,2);const A=new s.aU;A.emplaceBack(0,0,0,0),A.emplaceBack(s.ai,0,s.ai,0),A.emplaceBack(0,s.ai,0,s.ai),A.emplaceBack(s.ai,s.ai,s.ai,s.ai),this.mercatorBoundsBuffer=c.createVertexBuffer(A,s.ba.members),this.mercatorBoundsSegments=s.b8.simpleSegment(0,0,4,2);const k=new s.aV;k.emplaceBack(0,1,2),k.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=c.createIndexBuffer(k);const z=new s.b6;for(const K of[0,1,3,2,0])z.emplaceBack(K);this.debugIndexBuffer=c.createIndexBuffer(z),this.emptyTexture=new s.T(c,new s.r({width:1,height:1},Uint8Array.of(0,0,0,0)),c.gl.RGBA8),this.identityMat=s.ad.mat4.create();const q=this.context.gl;this.stencilClearMode=new Kr({func:q.ALWAYS,mask:0},0,255,q.ZERO,q.ZERO,q.ZERO),this.loadTimeStamps.push(performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(c){return c._makeTileBoundsBuffers(this.context,this.transform.projection),c._tileBoundsBuffer?{tileBoundsBuffer:c._tileBoundsBuffer,tileBoundsIndexBuffer:c._tileBoundsIndexBuffer,tileBoundsSegments:c._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const c=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,c.TRIANGLES,Cr.disabled,this.stencilClearMode,mn.disabled,Gr.disabled,df(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(c,h,v){if(!h||this.currentStencilSource===h.id||!c.isTileClipped()||!v||v.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let z=!1;for(const q of v)if(this._tileClippingMaskIDs[q.key]===void 0){z=!0;break}if(!z)return}this.currentStencilSource=h.id;const N=this.context,A=N.gl;this.nextStencilID+v.length>256&&this.clearStencil(),N.setColorMode(mn.disabled),N.setDepthMode(Cr.disabled);const k=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const z of v){const q=h.getTile(z),K=this._tileClippingMaskIDs[z.key]=this.nextStencilID++,{tileBoundsBuffer:Y,tileBoundsIndexBuffer:ee,tileBoundsSegments:Q}=this.getTileBoundsBuffers(q);k.draw(this,A.TRIANGLES,Cr.disabled,new Kr({func:A.ALWAYS,mask:0},K,255,A.KEEP,A.KEEP,A.REPLACE),mn.disabled,Gr.disabled,df(z.projMatrix),"$clipping",Y,ee,Q)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const c=this.nextStencilID++,h=this.context.gl;return new Kr({func:h.NOTEQUAL,mask:255},c,255,h.KEEP,h.KEEP,h.REPLACE)}stencilModeForClipping(c){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(c);const h=this.context.gl;return new Kr({func:h.EQUAL,mask:255},this._tileClippingMaskIDs[c.key],0,h.KEEP,h.KEEP,h.REPLACE)}stencilConfigForOverlap(c){const h=this.context.gl,v=c.sort((k,z)=>z.overscaledZ-k.overscaledZ),N=v[v.length-1].overscaledZ,A=v[0].overscaledZ-N+1;if(A>1){this.currentStencilSource=void 0,this.nextStencilID+A>256&&this.clearStencil();const k={};for(let z=0;z<A;z++)k[z+N]=new Kr({func:h.GEQUAL,mask:255},z+this.nextStencilID,255,h.KEEP,h.KEEP,h.REPLACE);return this.nextStencilID+=A,[k,v]}return[{[N]:Kr.disabled},v]}colorModeForRenderPass(){const c=this.context.gl;return this._showOverdrawInspector?new mn([c.CONSTANT_COLOR,c.ONE,c.CONSTANT_COLOR,c.ONE],new s.al(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?mn.unblended:mn.alphaBlended}colorModeForDrapableLayerRenderPass(c){const h=this.context.gl;return this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture&&this.renderPass==="translucent"?new mn([h.ONE,h.ONE_MINUS_SRC_ALPHA,h.CONSTANT_ALPHA,h.ONE_MINUS_SRC_ALPHA],new s.al(0,0,0,c===void 0?0:c),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(c,h,v,N=!1){if(this.depthOcclusion)return new Cr(this.context.gl.GREATER,Cr.ReadOnly,this.depthRangeFor3D);if(!this.opaquePassEnabledForLayer()&&!N)return Cr.disabled;const A=1-((1+this.currentLayer)*this.numSublayers+c)*this.depthEpsilon;return new Cr(v||this.context.gl.LEQUAL,h,[A,A])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}blitDepth(){const c=this.context.gl,h=Math.ceil(this.width),v=Math.ceil(this.height),N=this.context.bindFramebuffer.get(),A=c.getParameter(c.TEXTURE_BINDING_2D);this.depthFBO&&this.depthFBO.width===h&&this.depthFBO.height===v||(this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),h!==0&&v!==0&&(this.depthFBO=new bo(this.context,h,v,!1,"texture"),this.depthTexture=new s.T(this.context,{width:h,height:v,data:null},c.DEPTH24_STENCIL8),this.depthFBO.depthAttachment.set(this.depthTexture.texture))),this.context.bindFramebuffer.set(N),c.bindTexture(c.TEXTURE_2D,A),this.depthFBO&&(c.bindFramebuffer(c.READ_FRAMEBUFFER,null),c.bindFramebuffer(c.DRAW_FRAMEBUFFER,this.depthFBO.framebuffer),c.blitFramebuffer(0,0,h,v,0,0,h,v,c.DEPTH_BUFFER_BIT,c.NEAREST),c.bindFramebuffer(c.FRAMEBUFFER,this.context.bindFramebuffer.current))}updateAverageFPS(){this._fpsHistory.push(this._dt===0?0:1e3/this._dt),this._fpsHistory.length>this._debugParams.fpsWindow&&this._fpsHistory.splice(0,this._fpsHistory.length-this._debugParams.fpsWindow),this._averageFPS=Math.round(this._fpsHistory.reduce((c,h)=>c+h/this._fpsHistory.length,0))}render(c,h){const v=s.q.now();this._dt=v-this._timeStamp,this._timeStamp=v,this._wireframeDebugCache.update(this.frameCounter),this._debugParams.continousRedraw=c.map.repaint,this.style=c,this.options=h;const N=this.style._mergedLayers,A=!(!this.terrain||!this.terrain.enabled),k=()=>this.style._getOrder(A).filter(st=>{const At=N[st];return!(At.type in this._debugParams.enabledLayers)||this._debugParams.enabledLayers[At.type]});let z=k(),q=!1,K=!1;for(const st of z){const At=N[st];At.type==="circle"&&(q=!0),At.type==="symbol"&&(At.hasInitialOcclusionOpacityProperties?K=!0:q=!0)}let Y=z.map(st=>N[st]);const ee=this.style._mergedSourceCaches;this.imageManager=c.imageManager,this.modelManager=c.modelManager,this.symbolFadeChange=c.placement.symbolFadeChange(s.q.now()),this.imageManager.beginFrame();let Q=0,ie=!1;for(const st in ee){const At=ee[st];At.used&&(At.prepare(this.context),At.getSource().usedInConflation&&++Q)}let de=!1;for(const st of Y)st.isHidden(this.transform.zoom)||(st.type==="clip"&&(de=!0),this.prepareLayer(st));const le={},he={},fe={},Te={},Re={};for(const st in ee){const At=ee[st];le[st]=At.getVisibleCoordinates(),he[st]=le[st].slice().reverse(),fe[st]=At.getVisibleCoordinates(!0).reverse(),Te[st]=At.getShadowCasterCoordinates(),Re[st]=At.sortCoordinatesByDistance(le[st])}const Oe=st=>{const At=this.style.getLayerSourceCache(st);return At&&At.used?At.getSource():null};if(Q||de||this._clippingActiveLastFrame){const st=[],At=[];let rt=0;for(const Ct of Y)this.isSourceForClippingOrConflation(Ct,Oe(Ct))&&(st.push(Ct),At.push(rt)),rt++;if(st&&(de||st.length>1)||this._clippingActiveLastFrame){de=!1;const Ct=[];for(let _t=0;_t<st.length;_t++){const Et=st[_t],pt=At[_t],It=this.style.getLayerSourceCache(Et);if(!It||!It.used||!It.getSource().usedInConflation&&Et.type!=="clip")continue;let Kt=s.dA,Zt=s.by.None;const Qt=[];let gr=!0;if(Et.type==="clip"){Kt=pt;for(const qr of Et.layout.get("clip-layer-types"))Zt|=qr==="model"?s.by.Model:qr==="symbol"?s.by.Symbol:s.by.FillExtrusion;for(const qr of Et.layout.get("clip-layer-scope"))Qt.push(qr);Et.isHidden(this.transform.zoom)?gr=!1:de=!0}gr&&Ct.push({layer:Et.fqid,cache:It,order:Kt,clipMask:Zt,clipScope:Qt})}this.replacementSource.setSources(Ct),ie=!0}}this._clippingActiveLastFrame=de,ie||this.replacementSource.clear(),this.conflationActive=ie,this.minCutoffZoom=0,this.longestCutoffRange=0,this.opaquePassCutoff=1/0,this._lastOcclusionLayer=-1,this.layersWithOcclusionOpacity=[];for(let st=0;st<Y.length;st++){const At=Y[st],rt=At.cutoffRange();if(this.longestCutoffRange=Math.max(rt,this.longestCutoffRange),rt>0){const Ct=Oe(At);Ct&&(this.minCutoffZoom=Math.max(Ct.minzoom,this.minCutoffZoom)),At.minzoom&&(this.minCutoffZoom=Math.max(At.minzoom,this.minCutoffZoom))}At.is3D(A)&&(this.opaquePassCutoff===1/0&&(this.opaquePassCutoff=st),this._lastOcclusionLayer=st)}const $e=this.style&&this.style.fog;$e?(this._fogVisible=$e.getOpacity(this.transform.pitch)!==0,this._fogVisible&&this.transform.projection.name!=="globe"&&(this._fogVisible=$e.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(fe),this.opaquePassCutoff=0,z=k(),Y=z.map(st=>N[st]));const Le=this._shadowRenderer;if(Le){Le.updateShadowParameters(this.transform,this.style.directionalLight);for(const st in ee)for(const At of le[st]){let rt={min:0,max:0};this.terrain&&(rt=this.terrain.getMinMaxForTile(At)||rt),Le.addShadowReceiver(At.toUnwrapped(),rt.min,rt.max)}}this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new s.dz(this.context)),this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new oC(this)),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0);const Fe=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.snow),Be=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.rain);if(Fe&&!this._snow&&(this._snow=new Nf(this)),!Fe&&this._snow&&(this._snow.destroy(),delete this._snow),Be&&!this._rain&&(this._rain=new W1(this)),!Be&&this._rain&&(this._rain.destroy(),delete this._rain),this._snow&&this._snow.update(this),this._rain&&this._rain.update(this),!sr.has(this.context.gl))return;this.renderPass="offscreen";for(const st of Y){const At=c.getLayerSourceCache(st);if(!st.hasOffscreenPass()||st.isHidden(this.transform.zoom))continue;const rt=At?he[At.id]:void 0;(st.type==="custom"||st.type==="raster"||st.type==="raster-particle"||st.isSky()||rt&&rt.length)&&this.renderLayer(this,At,st,rt)}this.depthRangeFor3D=[0,1-(Y.length+2)*this.numSublayers*this.depthEpsilon],this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,Te)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const He=this.transform.projection.name==="globe"||this.transform.isHorizonVisible(),Ke=(()=>{if(h.showOverdrawInspector)return s.al.black;const st=this.style.fog;if(st&&this.transform.projection.supportsFog){const At=this.style.getLut(st.scope);if(!He){const rt=st.properties.get("color-use-theme")==="none",Ct=st.properties.get("color").toRenderColor(rt?null:At).toArray01();return new s.al(...Ct)}if(He){const rt=st.properties.get("space-color-use-theme")==="none",Ct=st.properties.get("space-color").toRenderColor(rt?null:At).toArray01();return new s.al(...Ct)}}return s.al.transparent})();if(this.context.clear({color:Ke,depth:1}),this.clearStencil(),this._showOverdrawInspector=h.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&He&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=z.length-1;this.currentLayer>=0;this.currentLayer--){const st=Y[this.currentLayer],At=c.getLayerSourceCache(st);if(st.isSky())continue;const rt=At?(st.is3D(A)?Re:he)[At.id]:void 0;this._renderTileClippingMasks(st,At,rt),this.renderLayer(this,At,st,rt)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&He&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||s.ag(this.transform.zoom)>0)&&(this.transform.projection.name==="globe"||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<z.length;this.currentLayer++){const st=Y[this.currentLayer],At=c.getLayerSourceCache(st);st.isSky()&&this.renderLayer(this,At,st,At?he[At.id]:void 0)}function ft(st,At){let rt;return At&&(rt=(st.type==="symbol"?fe:st.is3D(A)?Re:he)[At.id]),rt}if(this.renderPass="translucent",this.transform.projection.name==="globe"){for(this.renderElevatedRasterBackface=!0,this.currentLayer=0;this.currentLayer<z.length;){const st=Y[this.currentLayer];if(st.type==="raster"||st.type==="raster-particle"){const At=c.getLayerSourceCache(st);this.renderLayer(this,At,st,ft(st,At))}++this.currentLayer}this.renderElevatedRasterBackface=!1}this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let at=0;Le&&(at=Le.getShadowCastingLayerCount());let kt=!1,Pt=-1;for(let st=0;st<z.length;++st){const At=Y[st];At.isHidden(this.transform.zoom)||At.is3D(A)&&(Pt=st)}K&&Pt===-1&&(q=!0);let Bt=!1;for(;this.currentLayer<z.length;){const st=Y[this.currentLayer],At=c.getLayerSourceCache(st);if(st.isSky())++this.currentLayer;else if(this.terrain&&this.style.isLayerDraped(st)){if(st.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer),this._lastOcclusionLayer=Math.max(this.currentLayer,this._lastOcclusionLayer)}else{if(!Bt&&st.is3D(A)&&!A){const rt=this.currentLayer,Ct=_t=>{for(this.currentLayer=0;this.currentLayer<Y.length;this.currentLayer++){const Et=Y[this.currentLayer];if(yy[Et.type]){const pt=this.style.getLayerSourceCache(Et);yy[Et.type](this,pt,Et,ft(Et,pt),_t)}}};Ct("initialize"),Ct("reset"),this.currentLayer=rt,Bt=!0}if(q&&!kt&&this.terrain&&!this.transform.isOrthographic&&(kt=!0,this.blitDepth()),K&&Pt!==-1&&this.currentLayer===Pt+1&&!this.transform.isOrthographic&&this.blitDepth(),this.terrain||this._renderTileClippingMasks(st,At,At?le[At.id]:void 0),this.renderLayer(this,At,st,ft(st,At)),!this.terrain&&Le&&at>0&&st.hasShadowPass()&&--at==0&&(Le.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer)){const rt=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=rt;this.currentLayer++){const Ct=Y[this.currentLayer];if(!Ct.hasLightBeamPass())continue;const _t=c.getLayerSourceCache(Ct);this.renderLayer(this,_t,Ct,_t?he[_t.id]:void 0)}this.currentLayer=rt,this.renderPass="translucent"}if(this.currentLayer>=this._lastOcclusionLayer&&this.layersWithOcclusionOpacity.length>0){const rt=this.currentLayer;this.depthOcclusion=!0;for(const Ct of this.layersWithOcclusionOpacity){this.currentLayer=Ct;const _t=Y[this.currentLayer],Et=c.getLayerSourceCache(_t),pt=Et?he[Et.id]:void 0;this.terrain||this._renderTileClippingMasks(_t,Et,Et?le[Et.id]:void 0),this.renderLayer(this,Et,_t,pt)}this.depthOcclusion=!1,this.currentLayer=rt,this.renderPass="translucent",this.layersWithOcclusionOpacity=[]}++this.currentLayer}}if(this.terrain&&this.terrain.postRender(),this._snow&&this._snow.draw(this),this._rain&&this._rain.draw(this),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let st=null;Y.forEach(At=>{const rt=c.getLayerSourceCache(At);rt&&!At.isHidden(this.transform.zoom)&&rt.getVisibleCoordinates().length&&(!st||st.getSource().maxzoom<rt.getSource().maxzoom)&&(st=rt)}),st&&this.options.showTileBoundaries&&Vg.debug(this,st,st.getVisibleCoordinates(),s.al.red,!1,this.options.showParseStatus)}this.terrain&&this._debugParams.showTerrainProxyTiles&&Vg.debug(this,this.terrain.proxySourceCache,this.terrain.proxyCoords,new s.al(1,.8,.1,1),!0,this.options.showParseStatus),this.options.showPadding&&function(st){const At=st.transform.padding;z1(st,st.transform.height-(At.top||0),3,_f),z1(st,At.bottom||0,3,a4),L1(st,At.left||0,3,o4),L1(st,st.transform.width-(At.right||0),3,sC);const rt=st.transform.centerPoint;(function(Ct,_t,Et,pt){Uh(Ct,_t-1,Et-10,2,20,pt),Uh(Ct,_t-10,Et-1,20,2,pt)})(st,rt.x,st.transform.height-rt.y,uy)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(performance.now()),this.saveCanvasCopy()),ie||(this.conflationActive=!1)}prepareLayer(c){this.gpuTimingStart(c);const{unsupportedLayers:h}=this.transform.projection,v=!h||!h.includes(c.type);if(xy[c.type]&&(v||this.terrain&&c.type==="custom")){const N=this.style.getLayerSourceCache(c);xy[c.type](c,N,this)}this.gpuTimingEnd()}renderLayer(c,h,v,N){v.isHidden(this.transform.zoom)||(v.type==="background"||v.type==="sky"||v.type==="custom"||v.type==="model"||v.type==="raster"||v.type==="raster-particle"||N&&N.length)&&(this.id=v.id,this.gpuTimingStart(v),c.transform.projection.unsupportedLayers&&c.transform.projection.unsupportedLayers.includes(v.type)&&(!c.terrain||v.type!=="custom")||v.type==="clip"||Vg[v.type](c,h,v,N,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(c){if(!this.options.gpuTiming)return;const h=this.context.extTimerQuery,v=this.context.gl;let N=this.gpuTimers[c.id];N||(N=this.gpuTimers[c.id]={calls:0,cpuTime:0,query:v.createQuery()}),N.calls++,v.beginQuery(h.TIME_ELAPSED_EXT,N.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const c=this.context.extTimerQuery,h=this.context.gl,v=h.createQuery();this.deferredRenderGpuTimeQueries.push(v),h.beginQuery(c.TIME_ELAPSED_EXT,v)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const c=this.gpuTimers;return this.gpuTimers={},c}collectDeferredRenderGpuQueries(){const c=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],c}queryGpuTimers(c){const h={};for(const v in c){const N=c[v],A=this.context.extTimerQuery,k=A.getQueryParameter(N.query,this.context.gl.QUERY_RESULT)/1e6;A.deleteQueryEXT(N.query),h[v]=k}return h}queryGpuTimeDeferredRender(c){if(!this.options.gpuTimingDeferredRender)return 0;const h=this.context.gl;let v=0;for(const N of c)v+=h.getQueryParameter(N,h.QUERY_RESULT)/1e6,h.deleteQuery(N);return v}translatePosMatrix(c,h,v,N,A){if(!v[0]&&!v[1])return c;const k=A?N==="map"?this.transform.angle:0:N==="viewport"?-this.transform.angle:0;if(k){const K=Math.sin(k),Y=Math.cos(k);v=[v[0]*Y-v[1]*K,v[0]*K+v[1]*Y]}const z=[A?v[0]:s.at(h,v[0],this.transform.zoom),A?v[1]:s.at(h,v[1],this.transform.zoom),0],q=new Float32Array(16);return s.ad.mat4.translate(q,c,z),q}saveTileTexture(c){const h=c.size[0],v=this._tileTextures[h];v?v.push(c):this._tileTextures[h]=[c]}getTileTexture(c){const h=this._tileTextures[c];return h&&h.length>0?h.pop():null}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture||this.forceTerrainMode}linearFloatFilteringSupported(){return this.context.extTextureFloatLinear!=null}currentGlobalDefines(c,h,v){const N=v===void 0?this.terrain&&this.terrain.renderingToTexture:v,A=[];return this.style&&this.style.enable3dLights()&&(c==="globeRaster"||c==="terrainRaster"?(A.push("LIGHTING_3D_MODE"),A.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):N||A.push("LIGHTING_3D_MODE")),this.renderPass==="shadow"&&(this._shadowMapDebug||A.push("DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(A.push("TERRAIN"),this.linearFloatFilteringSupported()&&A.push("TERRAIN_DEM_FLOAT_FORMAT")),this.transform.projection.name==="globe"&&A.push("GLOBE"),!this._fogVisible||N||h!==void 0&&!h||A.push("FOG","FOG_DITHERING"),N&&A.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&A.push("OVERDRAW_INSPECTOR"),A}getOrCreateProgram(c,h){this.cache=this.cache||{};const v=h&&h.defines||[],N=h&&h.config,A=this.currentGlobalDefines(c,h&&h.overrideFog,h&&h.overrideRtt).concat(v),k=ZS.cacheKey(Eg[c],c,A,N);return this.cache[k]||(this.cache[k]=new ZS(this.context,c,Eg[c],N,P1[c],A)),this.cache[k]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const c=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(c.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new s.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA8))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy(),this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),this.emptyDepthTexture&&this.emptyDepthTexture.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(c,h){if(this.style.enable3dLights()){const v=this.style.directionalLight,N=this.style.ambientLight;if(v&&N){const A=((k,z,q)=>{const K=k.properties.get("direction"),Y=k.properties.get("color-use-theme")==="none",ee=k.properties.get("color").toRenderColor(Y?null:q.getLut(k.scope)).toArray01(),Q=k.properties.get("intensity"),ie=z.properties.get("color-use-theme")==="none",de=z.properties.get("color").toRenderColor(ie?null:q.getLut(z.scope)).toArray01(),le=z.properties.get("intensity"),he=[K.x,K.y,K.z],fe=s.cN(de,le),Te=s.cN(ee,Q);return{u_lighting_ambient_color:fe,u_lighting_directional_dir:he,u_lighting_directional_color:Te,u_ground_radiance:KS(he,Te,fe)}})(v,N,this.style);h.setLightsUniformValues(c,A)}}}uploadCommonUniforms(c,h,v,N,A){if(this.uploadCommonLightUniforms(c,h),this.terrain&&this.terrain.renderingToTexture)return;const k=this.style.fog;if(k){const z=k.getOpacity(this.transform.pitch),q=((K,Y,ee,Q,ie,de,le,he,fe,Te,Re,Oe)=>{const $e=K.transform,Le=Y.properties.get("color-use-theme")==="none",Fe=Y.properties.get("color").toRenderColor(Le?null:K.style.getLut(Y.scope)).toArray01();Fe[3]=Q;const Be=K.frameCounter/1e3%1,[He,Ke]=Y.properties.get("vertical-range");return{u_fog_matrix:ee?$e.calculateFogTileMatrix(ee):Oe||K.identityMat,u_fog_range:Y.getFovAdjustedRange($e._fov),u_fog_color:Fe,u_fog_horizon_blend:Y.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(He,Ke),Ke],u_fog_temporal_offset:Be,u_frustum_tl:ie,u_frustum_tr:de,u_frustum_br:le,u_frustum_bl:he,u_globe_pos:fe,u_globe_radius:Te,u_viewport:Re,u_globe_transition:s.ag($e.zoom),u_is_globe:+($e.projection.name==="globe")}})(this,k,v,z,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*s.q.devicePixelRatio,this.transform.height*s.q.devicePixelRatio],N);h.setFogUniformValues(c,q)}A&&h.setCutoffUniformValues(c,A.uniformValues)}setTileLoadedFlag(c){this.tileLoaded=c}saveCanvasCopy(){const c=this.canvasCopy();c&&(this.frameCopies.push(c),this.tileLoaded=!1)}canvasCopy(){const c=this.context.gl,h=c.createTexture();return c.bindTexture(c.TEXTURE_2D,h),c.copyTexImage2D(c.TEXTURE_2D,0,c.RGBA,0,0,c.drawingBufferWidth,c.drawingBufferHeight,0),h}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const c=this.style&&this.style.fog;return!!c&&c.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const c=this._backgroundTiles,h=this._backgroundTiles={},v=this.transform.coveringTiles({tileSize:512});for(const N of v)h[N.key]=c[N.key]||new lc(N,512,this.transform.tileZoom,this);return h}clearBackgroundTiles(){this._backgroundTiles={}}isSourceForClippingOrConflation(c,h){return!(!c.is3D(!(!this.terrain||!this.terrain.enabled))||c.type!=="clip"&&(c.minzoom&&c.minzoom>this.transform.zoom||(this.style._clipLayerPresent||c.sourceLayer!=="building")&&(!h||h.type!=="batched-model")))}isTileAffectedByFog(c){if(!this.style||!this.style.fog)return!1;if(this.transform.projection.name==="globe")return!0;let h=this._cachedTileFogOpacities[c.key];return h||(this._cachedTileFogOpacities[c.key]=h=this.style.fog.getOpacityForTile(c)),h[0]>=nr||h[1]>=nr}setupDepthForOcclusion(c,h,v){const N=this.context,A=N.gl,k=!!v;var z;v||(v={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0}),N.activeTexture.set(A.TEXTURE3),c&&this.depthFBO&&this.depthTexture?(this.depthTexture.bind(A.NEAREST,A.CLAMP_TO_EDGE),v.u_depth_size_inv=[1/this.depthFBO.width,1/this.depthFBO.height],v.u_depth_range_unpack=[2/((z=this.depthRangeFor3D)[1]-z[0]),-1-2*z[0]/(z[1]-z[0])],v.u_occluder_half_size=.5*this.occlusionParams.occluderSize,v.u_occlusion_depth_offset=this.occlusionParams.depthOffset):this.emptyDepthTexture.bind(A.NEAREST,A.CLAMP_TO_EDGE),N.activeTexture.set(A.TEXTURE0),k||h.setTerrainUniformValues(N,v)}}function by(b,c){let h=!1,v=null;const N=()=>{v=null,h&&(b(),v=setTimeout(N,c),h=!1)};return()=>(h=!0,v||N(),v)}class Z1{constructor(c){this._hashName=c&&encodeURIComponent(c),s.aQ(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=by(this._updateHashUnthrottled.bind(this),300)}addTo(c){return this._map=c,window.addEventListener("hashchange",this._onHashChange,!1),c.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const c=this._map;if(!c)return"";const h=Y1(c);if(this._hashName){const v=this._hashName;let N=!1;const A=location.hash.slice(1).split("&").map(k=>{const z=k.split("=")[0];return z===v?(N=!0,`${z}=${h}`):k}).filter(k=>k);return N||A.push(`${v}=${h}`),`#${A.join("&")}`}return`#${h}`}_getCurrentHash(){const c=location.hash.replace("#","");if(this._hashName){let h;return c.split("&").map(v=>v.split("=")).forEach(v=>{v[0]===this._hashName&&(h=v)}),(h&&h[1]||"").split("/")}return c.split("/")}_onHashChange(){const c=this._map;if(!c)return!1;const h=this._getCurrentHash();if(h.length>=3&&!h.some(v=>isNaN(v))){const v=c.dragRotate.isEnabled()&&c.touchZoomRotate.isEnabled()?+(h[3]||0):c.getBearing();return c.jumpTo({center:[+h[2],+h[1]],zoom:+h[0],bearing:v,pitch:+(h[4]||0)}),!0}return!1}_updateHashUnthrottled(){history.replaceState(history.state,"",location.href.replace(/(#.+)?$/,this.getHashString()))}}function Y1(b,c){const h=b.getCenter(),v=Math.round(100*b.getZoom())/100,N=Math.ceil((v*Math.LN2+Math.log(512/360/.5))/Math.LN10),A=Math.pow(10,N),k=Math.round(h.lng*A)/A,z=Math.round(h.lat*A)/A,q=b.getBearing(),K=b.getPitch();let Y=c?`/${k}/${z}/${v}`:`${v}/${z}/${k}`;return(q||K)&&(Y+="/"+Math.round(10*q)/10),K&&(Y+=`/${Math.round(K)}`),Y}const Ug={linearity:.3,easing:s.dB(0,0,.3,1)},lC=s.l({deceleration:2500,maxSpeed:1400},Ug),cC=s.l({deceleration:20,maxSpeed:1400},Ug),uC=s.l({deceleration:1e3,maxSpeed:360},Ug),dC=s.l({deceleration:1e3,maxSpeed:90},Ug);class hC{constructor(c){this._map=c,this.clear()}clear(){this._inertiaBuffer=[]}record(c){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:s.q.now(),settings:c})}_drainInertiaBuffer(){const c=this._inertiaBuffer,h=s.q.now();for(;c.length>0&&h-c[0].time>160;)c.shift()}_onMoveEnd(c){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const h={zoom:0,bearing:0,pitch:0,pan:new s.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:A}of this._inertiaBuffer)h.zoom+=A.zoomDelta||0,h.bearing+=A.bearingDelta||0,h.pitch+=A.pitchDelta||0,A.panDelta&&h.pan._add(A.panDelta),A.around&&(h.around=A.around),A.pinchAround&&(h.pinchAround=A.pinchAround);const v=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,N={};if(h.pan.mag()){const A=Hg(h.pan.mag(),v,s.l({},lC,c||{}));N.offset=h.pan.mult(A.amount/h.pan.mag()),N.center=this._map.transform.center,Gg(N,A)}if(h.zoom){const A=Hg(h.zoom,v,cC);N.zoom=this._map.transform.zoom+A.amount,Gg(N,A)}if(h.bearing){const A=Hg(h.bearing,v,uC);N.bearing=this._map.transform.bearing+s.ay(A.amount,-179,179),Gg(N,A)}if(h.pitch){const A=Hg(h.pitch,v,dC);N.pitch=this._map.transform.pitch+A.amount,Gg(N,A)}if(N.zoom||N.bearing){const A=h.pinchAround===void 0?h.around:h.pinchAround;N.around=A?this._map.unproject(A):this._map.getCenter()}return this.clear(),N.noMoveStart=!0,N}}function Gg(b,c){(!b.duration||b.duration<c.duration)&&(b.duration=c.duration,b.easing=c.easing)}function Hg(b,c,h){const{maxSpeed:v,linearity:N,deceleration:A}=h,k=s.ay(b*N/(c/1e3),-v,v),z=Math.abs(k)/(A*N);return{easing:h.easing,duration:1e3*z,amount:k*(z/2)}}class zo extends s.A{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(c,h,v,N={}){const A=ce(h.getCanvasContainer(),v),k=h.unproject(A);super(c,s.l({point:A,lngLat:k,originalEvent:v},N)),this._defaultPrevented=!1,this.target=h}}class qg extends s.A{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(c,h,v){const N=c==="touchend"?v.changedTouches:v.touches,A=Pe(h.getCanvasContainer(),N),k=A.map(q=>h.unproject(q)),z=A.reduce((q,K,Y,ee)=>q.add(K.div(ee.length)),new s.P(0,0));super(c,{points:A,point:z,lngLats:k,lngLat:h.unproject(z),originalEvent:v}),this._defaultPrevented=!1}}class mC extends s.A{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(c,h){super("wheel",{originalEvent:h}),this._defaultPrevented=!1}}class fC{constructor(c,h){this._map=c,this._clickTolerance=h.clickTolerance}reset(){this._mousedownPos=void 0}wheel(c){return this._firePreventable(new mC(this._map,c))}mousedown(c,h){return this._mousedownPos=h,this._firePreventable(new zo(c.type,this._map,c))}mouseup(c){this._map.fire(new zo(c.type,this._map,c))}preclick(c){const h=s.l({},c);h.type="preclick",this._map.fire(new zo(h.type,this._map,h))}click(c,h){this._mousedownPos&&this._mousedownPos.dist(h)>=this._clickTolerance||(this.preclick(c),this._map.fire(new zo(c.type,this._map,c)))}dblclick(c){return this._firePreventable(new zo(c.type,this._map,c))}mouseover(c){this._map.fire(new zo(c.type,this._map,c))}mouseout(c){this._map.fire(new zo(c.type,this._map,c))}touchstart(c){return this._firePreventable(new qg(c.type,this._map,c))}touchmove(c){this._map.fire(new qg(c.type,this._map,c))}touchend(c){this._map.fire(new qg(c.type,this._map,c))}touchcancel(c){this._map.fire(new qg(c.type,this._map,c))}_firePreventable(c){if(this._map.fire(c),c.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class c4{constructor(c){this._map=c}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(c){this._map.fire(new zo(c.type,this._map,c))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new zo("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(c){this._delayContextMenu?this._contextMenuEvent=c:this._map.fire(new zo(c.type,this._map,c)),this._map.listens("contextmenu")&&c.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class u4{constructor(c,h){this._map=c,this._el=c.getCanvasContainer(),this._container=c.getContainer(),this._clickTolerance=h.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(c,h){this.isEnabled()&&c.shiftKey&&c.button===0&&(W(),this._startPos=this._lastPos=h,this._active=!0)}mousemoveWindow(c,h){if(!this._active)return;const v=h,N=this._startPos,A=this._lastPos;if(!N||!A||A.equals(v)||!this._box&&v.dist(N)<this._clickTolerance)return;this._lastPos=v,this._box||(this._box=L("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",c));const k=Math.min(N.x,v.x),z=Math.max(N.x,v.x),q=Math.min(N.y,v.y),K=Math.max(N.y,v.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${k}px,${q}px)`,this._box.style.width=z-k+"px",this._box.style.height=K-q+"px")})}mouseupWindow(c,h){if(!this._active)return;const v=this._startPos,N=h;if(v&&c.button===0){if(this.reset(),ae(),v.x!==N.x||v.y!==N.y)return this._map.fire(new s.A("boxzoomend",{originalEvent:c})),{cameraAnimation:A=>A.fitScreenCoordinates(v,N,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",c)}}keydown(c){this._active&&c.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",c))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),Z(),delete this._startPos,delete this._lastPos}_fireEvent(c,h){return this._map.fire(new s.A(c,{originalEvent:h}))}}function Ti(b,c){const h={};for(let v=0;v<b.length;v++)h[b[v].identifier]=c[v];return h}class pC{constructor(c){this.reset(),this.numTouches=c.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(c,h,v){(this.centroid||v.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=c.timeStamp),v.length===this.numTouches&&(this.centroid=function(N){const A=new s.P(0,0);for(const k of N)A._add(k);return A.div(N.length)}(h),this.touches=Ti(v,h)))}touchmove(c,h,v){if(this.aborted||!this.centroid)return;const N=Ti(v,h);for(const A in this.touches){const k=N[A];(!k||k.dist(this.touches[A])>30)&&(this.aborted=!0)}}touchend(c,h,v){if((!this.centroid||c.timeStamp-this.startTime>500)&&(this.aborted=!0),v.length===0){const N=!this.aborted&&this.centroid;if(this.reset(),N)return N}}}class X1{constructor(c){this.singleTap=new pC(c),this.numTaps=c.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(c,h,v){this.singleTap.touchstart(c,h,v)}touchmove(c,h,v){this.singleTap.touchmove(c,h,v)}touchend(c,h,v){const N=this.singleTap.touchend(c,h,v);if(N){const A=c.timeStamp-this.lastTime<500,k=!this.lastTap||this.lastTap.dist(N)<30;if(A&&k||this.reset(),this.count++,this.lastTime=c.timeStamp,this.lastTap=N,this.count===this.numTaps)return this.reset(),N}}}class d4{constructor(){this._zoomIn=new X1({numTouches:1,numTaps:2}),this._zoomOut=new X1({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(c,h,v){this._zoomIn.touchstart(c,h,v),this._zoomOut.touchstart(c,h,v)}touchmove(c,h,v){this._zoomIn.touchmove(c,h,v),this._zoomOut.touchmove(c,h,v)}touchend(c,h,v){const N=this._zoomIn.touchend(c,h,v),A=this._zoomOut.touchend(c,h,v);return N?(this._active=!0,c.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:k=>k.easeTo({duration:300,zoom:k.getZoom()+1,around:k.unproject(N)},{originalEvent:c})}):A?(this._active=!0,c.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:k=>k.easeTo({duration:300,zoom:k.getZoom()-1,around:k.unproject(A)},{originalEvent:c})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Wg={0:1,2:2},J1={Control:"ctrlKey",Alt:"altKey",Shift:"shiftKey",Meta:"metaKey"};class Kg{constructor(c){this.reset(),this._clickTolerance=c.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(c,h){return!1}_move(c,h){return{}}mousedown(c,h){if(this._lastPoint)return;const v=we(c);this._correctButton(c,v)&&(this._lastPoint=h,this._eventButton=v)}mousemoveWindow(c,h){const v=this._lastPoint;if(v){if(c.preventDefault(),this._eventButton!=null&&function(N,A){const k=Wg[A];return N.buttons===void 0||(N.buttons&k)!==k}(c,this._eventButton))this.reset();else if(this._moved||!(h.dist(v)<this._clickTolerance))return this._moved=!0,this._lastPoint=h,this._move(v,h)}}mouseupWindow(c){this._lastPoint&&we(c)===this._eventButton&&(this._moved&&ae(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class _y extends Kg{mousedown(c,h){super.mousedown(c,h),this._lastPoint&&(this._active=!0)}_correctButton(c,h){return h===0&&!c.ctrlKey}_move(c,h){return{around:h,panDelta:h.sub(c)}}}class Qc extends Kg{constructor(c){super(c),this._pitchRotateKey=c.pitchRotateKey?J1[c.pitchRotateKey]:void 0}_correctButton(c,h){return this._pitchRotateKey?h===0&&c[this._pitchRotateKey]:h===0&&c.ctrlKey||h===2}_move(c,h){const v=.8*(h.x-c.x);if(v)return this._active=!0,{bearingDelta:v}}contextmenu(c){this._pitchRotateKey||c.preventDefault()}}class Zg extends Kg{constructor(c){super(c),this._pitchRotateKey=c.pitchRotateKey?J1[c.pitchRotateKey]:void 0}_correctButton(c,h){return this._pitchRotateKey?h===0&&c[this._pitchRotateKey]:h===0&&c.ctrlKey||h===2}_move(c,h){const v=-.5*(h.y-c.y);if(v)return this._active=!0,{pitchDelta:v}}contextmenu(c){this._pitchRotateKey||c.preventDefault()}}class gs{constructor(c,h){this._map=c,this._el=c.getCanvasContainer(),this._minTouches=1,this._clickTolerance=h.clickTolerance||1,this.reset(),s.aQ(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new s.P(0,0)}touchstart(c,h,v){return this._calculateTransform(c,h,v)}touchmove(c,h,v){if(this._active&&!(v.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(v.length===1&&!s.dC())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return c.cancelable&&c.preventDefault(),this._calculateTransform(c,h,v)}}touchend(c,h,v){this._calculateTransform(c,h,v),this._active&&v.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(c,h,v){v.length>0&&(this._active=!0);const N=Ti(v,h),A=new s.P(0,0),k=new s.P(0,0);let z=0;for(const K in N){const Y=N[K],ee=this._touches[K];ee&&(A._add(Y),k._add(Y.sub(ee)),z++,N[K]=Y)}if(this._touches=N,z<this._minTouches||!k.mag())return;const q=k.div(z);return this._sum._add(q),this._sum.mag()<this._clickTolerance?void 0:{around:A.div(z),panDelta:q}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=L("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.removeAttribute("role")},500)}}class $l{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(c){}_move(c,h,v){return{}}touchstart(c,h,v){this._firstTwoTouches||v.length<2||(this._firstTwoTouches=[v[0].identifier,v[1].identifier],this._start([h[0],h[1]]))}touchmove(c,h,v){const N=this._firstTwoTouches;if(!N)return;c.preventDefault();const[A,k]=N,z=Sf(v,h,A),q=Sf(v,h,k);if(!z||!q)return;const K=this._aroundCenter?null:z.add(q).div(2);return this._move([z,q],K,c)}touchend(c,h,v){if(!this._firstTwoTouches)return;const[N,A]=this._firstTwoTouches,k=Sf(v,h,N),z=Sf(v,h,A);k&&z||(this._active&&ae(),this.reset())}touchcancel(){this.reset()}enable(c){this._enabled=!0,this._aroundCenter=!!c&&c.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Sf(b,c,h){for(let v=0;v<b.length;v++)if(b[v].identifier===h)return c[v]}function Yg(b,c){return Math.log(b/c)/Math.LN2}class gC extends $l{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(c){this._startDistance=this._distance=c[0].dist(c[1])}_move(c,h){const v=this._distance;if(this._distance=c[0].dist(c[1]),this._active||!(Math.abs(Yg(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Yg(this._distance,v),pinchAround:h}}}function xC(b,c){return 180*b.angleWith(c)/Math.PI}class Xg extends $l{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(c){this._startVector=this._vector=c[0].sub(c[1]),this._minDiameter=c[0].dist(c[1])}_move(c,h){const v=this._vector;if(this._vector=c[0].sub(c[1]),v&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:xC(this._vector,v),pinchAround:h}}_isBelowThreshold(c){this._minDiameter=Math.min(this._minDiameter,c.mag());const h=25/(Math.PI*this._minDiameter)*360,v=this._startVector;if(!v)return!1;const N=xC(c,v);return Math.abs(N)<h}}function Q1(b){return Math.abs(b.y)>Math.abs(b.x)}class h4 extends $l{constructor(c){super(),this._map=c}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(c){this._lastPoints=c,Q1(c[0].sub(c[1]))&&(this._valid=!1)}_move(c,h,v){const N=this._lastPoints;if(!N)return;const A=c[0].sub(N[0]),k=c[1].sub(N[1]);return this._map._cooperativeGestures&&!s.dC()&&v.touches.length<3||(this._valid=this.gestureBeginsVertically(A,k,v.timeStamp),!this._valid)?void 0:(this._lastPoints=c,this._active=!0,{pitchDelta:(A.y+k.y)/2*-.5})}gestureBeginsVertically(c,h,v){if(this._valid!==void 0)return this._valid;const N=c.mag()>=2,A=h.mag()>=2;if(!N&&!A)return;if(!N||!A)return this._firstMove==null&&(this._firstMove=v),v-this._firstMove<100&&void 0;const k=c.y>0==h.y>0;return Q1(c)&&Q1(h)&&k}}const ew={panStep:100,bearingStep:15,pitchStep:10};class tw{constructor(){const c=ew;this._panStep=c.panStep,this._bearingStep=c.bearingStep,this._pitchStep=c.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(c){if(c.altKey||c.ctrlKey||c.metaKey)return;let h=0,v=0,N=0,A=0,k=0;switch(c.keyCode){case 61:case 107:case 171:case 187:h=1;break;case 189:case 109:case 173:h=-1;break;case 37:c.shiftKey?v=-1:(c.preventDefault(),A=-1);break;case 39:c.shiftKey?v=1:(c.preventDefault(),A=1);break;case 38:c.shiftKey?N=1:(c.preventDefault(),k=-1);break;case 40:c.shiftKey?N=-1:(c.preventDefault(),k=1);break;default:return}return this._rotationDisabled&&(v=0,N=0),{cameraAnimation:z=>{const q=z.getZoom();z.easeTo({duration:300,easeId:"keyboardHandler",easing:Jg,zoom:h?Math.round(q)+h*(c.shiftKey?2:1):q,bearing:z.getBearing()+v*this._bearingStep,pitch:z.getPitch()+N*this._pitchStep,offset:[-A*this._panStep,-k*this._panStep],center:z.getCenter()},{originalEvent:c})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Jg(b){return b*(2-b)}const qh=4.000244140625,Vu=1/450;class mc{constructor(c,h){this._map=c,this._el=c.getCanvasContainer(),this._handler=h,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=Vu,s.aQ(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(c){this._defaultZoomRate=c}setWheelZoomRate(c){this._wheelZoomRate=c}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(c){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!c&&c.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(c){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(c.ctrlKey||c.metaKey||this.isZooming()||s.dC()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let h=c.deltaMode===WheelEvent.DOM_DELTA_LINE?40*c.deltaY:c.deltaY;const v=s.q.now(),N=v-(this._lastWheelEventTime||0);this._lastWheelEventTime=v,h!==0&&h%qh==0?this._type="wheel":h!==0&&Math.abs(h)<4?this._type="trackpad":N>400?(this._type=null,this._lastValue=h,this._timeout=window.setTimeout(this._onTimeout,40,c)):this._type||(this._type=Math.abs(N*h)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,h+=this._lastValue)),c.shiftKey&&h&&(h/=4),this._type&&(this._lastWheelEvent=c,this._delta-=h,this._active||this._start(c)),c.preventDefault()}_onTimeout(c){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(c)}_start(c){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const h=ce(this._el,c);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:h,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const c=this._map.transform;this._type==="wheel"&&c.projection.wrap&&(c._center.lng>=180||c._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const h=()=>c._terrainEnabled()&&this._aroundCoord?c.computeZoomRelativeTo(this._aroundCoord):c.zoom;if(this._delta!==0){const K=this._type==="wheel"&&Math.abs(this._delta)>qh?this._wheelZoomRate:this._defaultZoomRate;let Y=2/(1+Math.exp(-Math.abs(this._delta*K)));this._delta<0&&Y!==0&&(Y=1/Y);const ee=h(),Q=Math.pow(2,ee),ie=typeof this._targetZoom=="number"?c.zoomScale(this._targetZoom):Q;this._targetZoom=Math.min(c.maxZoom,Math.max(c.minZoom,c.scaleZoom(ie*Y))),this._type==="wheel"&&(this._startZoom=ee,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const v=typeof this._targetZoom=="number"?this._targetZoom:h(),N=this._startZoom,A=this._easing;let k,z=!1;if(this._type==="wheel"&&N&&A){const K=Math.min((s.q.now()-this._lastWheelEventTime)/200,1),Y=A(K);k=s.ah(N,v,Y),K<1?this._frameId||(this._frameId=!0):z=!0}else k=v,z=!0;this._active=!0,z&&(this._active=!1,this._finishTimeout=window.setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200));let q=k-h();return q*this._lastDelta<0&&(q=0),{noInertia:!0,needsRenderFrame:!z,zoomDelta:q,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(c){let h=s.dD;if(this._prevEase){const v=this._prevEase,N=(s.q.now()-v.start)/v.duration,A=v.easing(N+.01)-v.easing(N),k=.27/Math.sqrt(A*A+1e-4)*.01,z=Math.sqrt(.0729-k*k);h=s.dB(k,z,.25,1)}return this._prevEase={start:s.q.now(),duration:c,easing:h},h}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=L("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.removeAttribute("role")},200)}}class Ud{constructor(c,h){this._clickZoom=c,this._tapZoom=h}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Wh{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(c,h){return c.preventDefault(),{cameraAnimation:v=>{v.easeTo({duration:300,zoom:v.getZoom()+(c.shiftKey?-1:1),around:v.unproject(h)},{originalEvent:c})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Gd{constructor(){this._tap=new X1({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(c,h,v){this._swipePoint||(this._tapTime&&c.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?v.length>0&&(this._swipePoint=h[0],this._swipeTouch=v[0].identifier):this._tap.touchstart(c,h,v))}touchmove(c,h,v){if(this._tapTime){if(this._swipePoint){if(v[0].identifier!==this._swipeTouch)return;const N=h[0],A=N.y-this._swipePoint.y;return this._swipePoint=N,c.preventDefault(),this._active=!0,{zoomDelta:A/128}}}else this._tap.touchmove(c,h,v)}touchend(c,h,v){this._tapTime?this._swipePoint&&v.length===0&&this.reset():this._tap.touchend(c,h,v)&&(this._tapTime=c.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class m4{constructor(c,h,v){this._el=c,this._mousePan=h,this._touchPan=v}enable(c){this._inertiaOptions=c||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class f4{constructor(c,h,v){this._pitchWithRotate=c.pitchWithRotate,this._mouseRotate=h,this._mousePitch=v}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class p4{constructor(c,h,v,N){this._el=c,this._touchZoom=h,this._touchRotate=v,this._tapDragZoom=N,this._rotationDisabled=!1,this._enabled=!0}enable(c){this._touchZoom.enable(c),this._rotationDisabled||this._touchRotate.enable(c),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const wy=b=>b.zoom||b.drag||b.pitch||b.rotate;class yC extends s.A{}class oo{constructor(){this.constants=[1,1,.01],this.radius=0}setup(c,h){const v=s.ad.vec3.sub([],h,c);this.radius=s.ad.vec3.length(v[2]<0?s.ad.vec3.div([],v,this.constants):[v[0],v[1],0])}projectRay(c){s.ad.vec3.div(c,c,this.constants),s.ad.vec3.normalize(c,c),s.ad.vec3.mul(c,c,this.constants);const h=s.ad.vec3.scale([],c,this.radius);if(h[2]>0){const v=s.ad.vec3.scale([],[0,0,1],s.ad.vec3.dot(h,[0,0,1])),N=s.ad.vec3.scale([],s.ad.vec3.normalize([],[h[0],h[1],0]),this.radius),A=s.ad.vec3.add([],h,s.ad.vec3.scale([],s.ad.vec3.sub([],s.ad.vec3.add([],N,v),h),2));h[0]=A[0],h[1]=A[1]}return h}}function Cf(b){return b.panDelta&&b.panDelta.mag()||b.zoomDelta||b.bearingDelta||b.pitchDelta}class vC{constructor(c,h){this._map=c,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new hC(c),this._bearingSnap=h.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new oo,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(h),s.aQ(["handleEvent","handleWindowEvent"],this);const v=this._el;this._listeners=[[v,"touchstart",{passive:!0}],[v,"touchmove",{passive:!1}],[v,"touchend",void 0],[v,"touchcancel",void 0],[v,"mousedown",void 0],[v,"mousemove",void 0],[v,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[v,"mouseover",void 0],[v,"mouseout",void 0],[v,"dblclick",void 0],[v,"click",void 0],[v,"keydown",{capture:!1}],[v,"keyup",void 0],[v,"wheel",{passive:!1}],[v,"contextmenu",void 0],[window,"blur",void 0]];for(const[N,A,k]of this._listeners){const z=N===document?this.handleWindowEvent:this.handleEvent;N.addEventListener(A,z,k)}}destroy(){for(const[c,h,v]of this._listeners){const N=c===document?this.handleWindowEvent:this.handleEvent;c.removeEventListener(h,N,v)}}_addDefaultHandlers(c){const h=this._map,v=h.getCanvasContainer();this._add("mapEvent",new fC(h,c));const N=h.boxZoom=new u4(h,c);this._add("boxZoom",N);const A=new d4,k=new Wh;h.doubleClickZoom=new Ud(k,A),this._add("tapZoom",A),this._add("clickZoom",k);const z=new Gd;this._add("tapDragZoom",z);const q=h.touchPitch=new h4(h);this._add("touchPitch",q);const K=new Qc(c),Y=new Zg(c);h.dragRotate=new f4(c,K,Y),this._add("mouseRotate",K,["mousePitch"]),this._add("mousePitch",Y,["mouseRotate"]);const ee=new _y(c),Q=new gs(h,c);h.dragPan=new m4(v,ee,Q),this._add("mousePan",ee),this._add("touchPan",Q,["touchZoom","touchRotate"]);const ie=new Xg,de=new gC;h.touchZoomRotate=new p4(v,de,ie,z),this._add("touchRotate",ie,["touchPan","touchZoom"]),this._add("touchZoom",de,["touchPan","touchRotate"]),this._add("blockableMapEvent",new c4(h));const le=h.scrollZoom=new mc(h,this);this._add("scrollZoom",le,["mousePan"]);const he=h.keyboard=new tw;this._add("keyboard",he);for(const fe of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])c.interactive&&c[fe]&&h[fe].enable(c[fe])}_add(c,h,v){this._handlers.push({handlerName:c,handler:h,allowed:v}),this._handlersById[c]=h}stop(c){if(!this._updatingCamera){for(const{handler:h}of this._handlers)h.reset();this._inertia.clear(),this._fireEvents({},{},c),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:c}of this._handlers)if(c.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!wy(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(c,h,v){for(const N in c)if(N!==v&&(!h||h.indexOf(N)<0))return!0;return!1}handleWindowEvent(c){this.handleEvent(c,`${c.type}Window`)}_getMapTouches(c){const h=[];for(const v of c)this._el.contains(v.target)&&h.push(v);return h}handleEvent(c,h){this._updatingCamera=!0;const v=c.type==="renderFrame",N=v?void 0:c,A={needsRenderFrame:!1},k={},z={},q=c.touches?this._getMapTouches(c.touches):void 0,K=q?Pe(this._el,q):v?void 0:ce(this._el,c);for(const{handlerName:Q,handler:ie,allowed:de}of this._handlers){if(!ie.isEnabled())continue;let le;this._blockedByActive(z,de,Q)?ie.reset():ie[h||c.type]&&(le=ie[h||c.type](c,K,q),this.mergeHandlerResult(A,k,le,Q,N),le&&le.needsRenderFrame&&this._triggerRenderFrame()),(le||ie.isActive())&&(z[Q]=ie)}const Y={};for(const Q in this._previousActiveHandlers)z[Q]||(Y[Q]=N);this._previousActiveHandlers=z,(Object.keys(Y).length||Cf(A))&&(this._changes.push([A,k,Y]),this._triggerRenderFrame()),(Object.keys(z).length||Cf(A))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:ee}=A;ee&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],ee(this._map))}mergeHandlerResult(c,h,v,N,A){if(!v)return;s.l(c,v);const k={handlerName:N,originalEvent:v.originalEvent||A};v.zoomDelta!==void 0&&(h.zoom=k),v.panDelta!==void 0&&(h.drag=k),v.pitchDelta!==void 0&&(h.pitch=k),v.bearingDelta!==void 0&&(h.rotate=k)}_applyChanges(){const c={},h={},v={};for(const[N,A,k]of this._changes)N.panDelta&&(c.panDelta=(c.panDelta||new s.P(0,0))._add(N.panDelta)),N.zoomDelta&&(c.zoomDelta=(c.zoomDelta||0)+N.zoomDelta),N.bearingDelta&&(c.bearingDelta=(c.bearingDelta||0)+N.bearingDelta),N.pitchDelta&&(c.pitchDelta=(c.pitchDelta||0)+N.pitchDelta),N.around!==void 0&&(c.around=N.around),N.aroundCoord!==void 0&&(c.aroundCoord=N.aroundCoord),N.pinchAround!==void 0&&(c.pinchAround=N.pinchAround),N.noInertia&&(c.noInertia=N.noInertia),s.l(h,A),s.l(v,k);this._updateMapTransform(c,h,v),this._changes=[]}_updateMapTransform(c,h,v){const N=this._map,A=N.transform,k=Te=>[Te.x,Te.y,Te.z];if((Te=>{const Re=this._eventsInProgress.drag;return Re&&!this._handlersById[Re.handlerName].isActive()})()&&!Cf(c)){const Te=A.zoom;A.cameraElevationReference="sea",this._originalZoom!=null&&A._orthographicProjectionAtLowPitch&&A.projection.name!=="globe"&&A.pitch===0?(A.cameraElevationReference="ground",A.zoom=this._originalZoom):(A.recenterOnTerrain(),A.cameraElevationReference="ground"),Te!==A.zoom&&this._map._update(!0)}if(A._isCameraConstrained&&N._stop(!0),!Cf(c))return void this._fireEvents(h,v,!0);let{panDelta:z,zoomDelta:q,bearingDelta:K,pitchDelta:Y,around:ee,aroundCoord:Q,pinchAround:ie}=c;A._isCameraConstrained&&(q>0&&(q=0),A._isCameraConstrained=!1),ie!==void 0&&(ee=ie),(q||(Te=>h[Te]&&!this._eventsInProgress[Te])("drag"))&&ee&&(this._dragOrigin=k(A.pointCoordinate3D(ee)),this._originalZoom=A.zoom,this._trackingEllipsoid.setup(A._camera.position,this._dragOrigin)),A.cameraElevationReference="sea",N._stop(!0),ee=ee||N.transform.centerPoint,K&&(A.bearing+=K),Y&&(A.pitch+=Y),A._updateCameraState();const de=[0,0,0];if(z)if(A.projection.name==="mercator"){const Te=this._trackingEllipsoid.projectRay(A.screenPointToMercatorRay(ee).dir),Re=this._trackingEllipsoid.projectRay(A.screenPointToMercatorRay(ee.sub(z)).dir);de[0]=Re[0]-Te[0],de[1]=Re[1]-Te[1]}else{const Te=A.pointCoordinate(ee);if(A.projection.name==="globe"){z=z.rotate(-A.angle);const Re=A._pixelsPerMercatorPixel/A.worldSize;de[0]=-z.x*s.dE(s.aT(Te.y))*Re,de[1]=-z.y*s.dE(A.center.lat)*Re}else{const Re=A.pointCoordinate(ee.sub(z));Te&&Re&&(de[0]=Re.x-Te.x,de[1]=Re.y-Te.y)}}const le=A.zoom,he=[0,0,0];if(q){const Te=k(Q||A.pointCoordinate3D(ee)),Re={dir:s.ad.vec3.normalize([],s.ad.vec3.sub([],Te,A._camera.position))};if(Re.dir[2]<0){const Oe=A.zoomDeltaToMovement(Te,q);s.ad.vec3.scale(he,Re.dir,Oe)}}const fe=s.ad.vec3.add(de,de,he);A._translateCameraConstrained(fe),q&&Math.abs(A.zoom-le)>1e-4&&A.recenterOnTerrain(),A.cameraElevationReference="ground",this._map._update(),c.noInertia||this._inertia.record(c),this._fireEvents(h,v,!0)}_fireEvents(c,h,v){const N=wy(this._eventsInProgress),A=wy(c),k={};for(const Y in c){const{originalEvent:ee}=c[Y];this._eventsInProgress[Y]||(k[`${Y}start`]=ee),this._eventsInProgress[Y]=c[Y]}!N&&A&&this._fireEvent("movestart",A.originalEvent);for(const Y in k)this._fireEvent(Y,k[Y]);A&&this._fireEvent("move",A.originalEvent);for(const Y in c){const{originalEvent:ee}=c[Y];this._fireEvent(Y,ee)}const z={};let q;for(const Y in this._eventsInProgress){const{handlerName:ee,originalEvent:Q}=this._eventsInProgress[Y];this._handlersById[ee].isActive()||(delete this._eventsInProgress[Y],q=h[ee]||Q,z[`${Y}end`]=q)}for(const Y in z)this._fireEvent(Y,z[Y]);const K=wy(this._eventsInProgress);if(v&&(N||A)&&!K){this._updatingCamera=!0;const Y=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),ee=Q=>Q!==0&&-this._bearingSnap<Q&&Q<this._bearingSnap;Y?(ee(Y.bearing||this._map.getBearing())&&(Y.bearing=0),this._map.easeTo(Y,{originalEvent:q})):(this._map.fire(new s.A("moveend",{originalEvent:q})),ee(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(c,h){this._map.fire(new s.A(c,h?{originalEvent:h}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(c=>{this._frameId=void 0,this.handleEvent(new yC("renderFrame",{timeStamp:c})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const bC="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Af extends s.E{constructor(c,h){super(),this._moving=!1,this._zooming=!1,this.transform=c,this._bearingSnap=h.bearingSnap,this._respectPrefersReducedMotion=h.respectPrefersReducedMotion!==!1,s.aQ(["_renderFrameCallback"],this)}getCenter(){return new s.bO(this.transform.center.lng,this.transform.center.lat)}setCenter(c,h){return this.jumpTo({center:c},h)}panBy(c,h,v){return c=s.P.convert(c).mult(-1),this.panTo(this.transform.center,s.l({offset:c},h),v)}panTo(c,h,v){return this.easeTo(s.l({center:c},h),v)}getZoom(){return this.transform.zoom}setZoom(c,h){return this.jumpTo({zoom:c},h),this}zoomTo(c,h,v){return this.easeTo(s.l({zoom:c},h),v)}zoomIn(c,h){return this.zoomTo(this.getZoom()+1,c,h),this}zoomOut(c,h){return this.zoomTo(this.getZoom()-1,c,h),this}getBearing(){return this.transform.bearing}setBearing(c,h){return this.jumpTo({bearing:c},h),this}getPadding(){return this.transform.padding}setPadding(c,h){return this.jumpTo({padding:c},h),this}rotateTo(c,h,v){return this.easeTo(s.l({bearing:c},h),v)}resetNorth(c,h){return this.rotateTo(0,s.l({duration:1e3},c),h),this}resetNorthPitch(c,h){return this.easeTo(s.l({bearing:0,pitch:0,duration:1e3},c),h),this}snapToNorth(c,h){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(c,h):this}getPitch(){return this.transform.pitch}setPitch(c,h){return this.jumpTo({pitch:c},h),this}cameraForBounds(c,h){c=s.aB.convert(c);const v=h&&h.bearing||0,N=h&&h.pitch||0,A=c.getNorthWest(),k=c.getSouthEast();return this._cameraForBounds(this.transform,A,k,v,N,h)}_extendPadding(c){const h={top:0,right:0,bottom:0,left:0};return c==null?s.l({},h,this.transform.padding):typeof c=="number"?{top:c,bottom:c,right:c,left:c}:s.l({},h,c)}_extendCameraOptions(c){return(c=s.l({offset:[0,0],maxZoom:this.transform.maxZoom},c)).padding=this._extendPadding(c.padding),c}_minimumAABBFrustumDistance(c,h){const v=h.max[0]-h.min[0],N=h.max[1]-h.min[1];return v/N>c.aspect?v/(2*Math.tan(.5*c.fovX)*c.aspect):N/(2*Math.tan(.5*c.fovY)*c.aspect)}_cameraForBoundsOnGlobe(c,h,v,N,A,k){const z=c.clone(),q=this._extendCameraOptions(k);z.bearing=N,z.pitch=A;const K=s.bO.convert(h),Y=s.bO.convert(v),ee=.5*(K.lat+Y.lat),Q=.5*(K.lng+Y.lng),ie=s.dF(ee,Q),de=s.ad.vec3.normalize([],ie),le=s.ad.vec3.normalize([],s.ad.vec3.cross([],de,[0,1,0])),he=s.ad.vec3.cross([],le,de),fe=[le[0],le[1],le[2],0,he[0],he[1],he[2],0,de[0],de[1],de[2],0,0,0,0,1],Te=[ie,s.dF(K.lat,K.lng),s.dF(Y.lat,K.lng),s.dF(Y.lat,Y.lng),s.dF(K.lat,Y.lng),s.dF(ee,K.lng),s.dF(ee,Y.lng),s.dF(K.lat,Q),s.dF(Y.lat,Q)];let Re=s.ce.fromPoints(Te.map(_t=>[s.ad.vec3.dot(le,_t),s.ad.vec3.dot(he,_t),s.ad.vec3.dot(de,_t)]));const Oe=s.ad.vec3.transformMat4([],Re.center,fe);s.ad.vec3.squaredLength(Oe)===0&&s.ad.vec3.set(Oe,0,0,1),s.ad.vec3.normalize(Oe,Oe),s.ad.vec3.scale(Oe,Oe,s.az),z.center=s.dG(Oe);const $e=z.getWorldToCameraMatrix(),Le=s.ad.mat4.invert(new Float64Array(16),$e);Re=s.ce.applyTransform(Re,s.ad.mat4.multiply([],$e,fe));const Fe=this._extendAABB(Re,z,q,N);if(!Fe)return void s.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");Re=Fe,s.ad.vec3.transformMat4(Oe,Oe,$e);const Be=.5*(Re.max[2]-Re.min[2]),He=this._minimumAABBFrustumDistance(z,Re),Ke=s.ad.vec3.scale([],[0,0,1],Be),ft=s.ad.vec3.add(Ke,Oe,Ke),at=He+(z.pitch===0?0:s.ad.vec3.distance(Oe,ft)),kt=z.globeCenterInViewSpace,Pt=s.ad.vec3.sub([],Oe,[kt[0],kt[1],kt[2]]);s.ad.vec3.normalize(Pt,Pt),s.ad.vec3.scale(Pt,Pt,at);const Bt=s.ad.vec3.add([],Oe,Pt);s.ad.vec3.transformMat4(Bt,Bt,Le);const st=s.dv/s.az,At=s.ad.vec3.length(Bt),rt=s.bH(Math.max(At*st-s.dv,Number.EPSILON),0),Ct=Math.min(z.zoomFromMercatorZAdjusted(rt),q.maxZoom);return Ct>.5*(s.c6+s.bY)?(z.setProjection({name:"mercator"}),z.zoom=Ct,this._cameraForBounds(z,h,v,N,A,k)):{center:z.center,zoom:Ct,bearing:N,pitch:A}}_extendAABB(c,h,v,N){const A=.5*((v.padding.left||0)+(v.padding.right||0)),k=.5*((v.padding.top||0)+(v.padding.bottom||0)),z=k,q=A,K=A,Y=k,ee=h.width-(q+K),Q=h.height-(z+Y),ie=s.ad.vec3.sub([],c.max,c.min),de=Math.min(ee/ie[0],Q/ie[1]),le=Math.min(h.scaleZoom(h.scale*de),v.maxZoom);if(isNaN(le))return null;const he=h.scale/h.zoomScale(le),fe=new s.ce([c.min[0]-q*he,c.min[1]-Y*he,c.min[2]],[c.max[0]+K*he,c.max[1]+z*he,c.max[2]]),Te=(typeof v.offset.x=="number"&&typeof v.offset.y=="number"?new s.P(v.offset.x,v.offset.y):s.P.convert(v.offset)).rotate(-s.ak(N));return fe.center[0]-=Te.x*he,fe.center[1]+=Te.y*he,fe}queryTerrainElevation(c,h){const v=this.transform.elevation;return v?(h=s.l({},{exaggerated:!0},h),v.getAtPoint(s.ac.fromLngLat(c),null,h.exaggerated)):null}_cameraForBounds(c,h,v,N,A,k){if(c.projection.name==="globe")return this._cameraForBoundsOnGlobe(c,h,v,N,A,k);const z=c.clone(),q=this._extendCameraOptions(k);z.bearing=N,z.pitch=A;const K=s.bO.convert(h),Y=s.bO.convert(v),ee=new s.bO(K.lng,Y.lat),Q=new s.bO(Y.lng,K.lat),ie=z.project(K),de=z.project(Y),le=this.queryTerrainElevation(K),he=this.queryTerrainElevation(Y),fe=this.queryTerrainElevation(ee),Te=this.queryTerrainElevation(Q),Re=[[ie.x,ie.y,Math.min(le||0,he||0,fe||0,Te||0)],[de.x,de.y,Math.max(le||0,he||0,fe||0,Te||0)]];let Oe=s.ce.fromPoints(Re);const $e=z.getWorldToCameraMatrix(),Le=s.ad.mat4.invert(new Float64Array(16),$e);Oe=s.ce.applyTransform(Oe,$e);const Fe=this._extendAABB(Oe,z,q,N);if(!Fe)return void s.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");Oe=Fe;const Be=.5*s.ad.vec3.sub([],Oe.max,Oe.min)[2],He=this._minimumAABBFrustumDistance(z,Oe),Ke=[0,0,1,0];s.ad.vec4.transformMat4(Ke,Ke,$e),s.ad.vec4.normalize(Ke,Ke);const ft=s.ad.vec3.scale([],Ke,He+Be),at=s.ad.vec3.add([],Oe.center,ft);s.ad.vec3.transformMat4(Oe.center,Oe.center,Le),s.ad.vec3.transformMat4(at,at,Le);const kt=z.unproject(new s.P(Oe.center[0],Oe.center[1])),Pt=s.dH(z.projection,kt),Bt=Math.pow(2,Pt),st=Math.min(z._zoomFromMercatorZ(at[2]*z.pixelsPerMeter*Bt/z.worldSize),q.maxZoom);return z.mercatorFromTransition&&st<.5*(s.c6+s.bY)?(z.setProjection({name:"globe"}),z.zoom=st,this._cameraForBounds(z,h,v,N,A,k)):{center:kt,zoom:st,bearing:N,pitch:A}}fitBounds(c,h,v){const N=this.cameraForBounds(c,h);return this._fitInternal(N,h,v)}fitScreenCoordinates(c,h,v,N,A){const k=s.P.convert(c),z=s.P.convert(h),q=new s.P(Math.min(k.x,z.x),Math.min(k.y,z.y)),K=new s.P(Math.max(k.x,z.x),Math.max(k.y,z.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(k,z))return this;const Y=this.transform.pointLocation3D(q),ee=this.transform.pointLocation3D(K),Q=this.transform.pointLocation3D(new s.P(q.x,K.y)),ie=this.transform.pointLocation3D(new s.P(K.x,q.y)),de=[Math.min(Y.lng,ee.lng,Q.lng,ie.lng),Math.min(Y.lat,ee.lat,Q.lat,ie.lat)],le=[Math.max(Y.lng,ee.lng,Q.lng,ie.lng),Math.max(Y.lat,ee.lat,Q.lat,ie.lat)],he=N&&N.pitch?N.pitch:this.getPitch(),fe=this._cameraForBounds(this.transform,de,le,v,he,N);return this._fitInternal(fe,N,A)}_fitInternal(c,h,v){return c?(h=s.l(c,h)).linear?this.easeTo(h,v):this.flyTo(h,v):this}jumpTo(c,h){this.stop();const v=c.preloadOnly?this.transform.clone():this.transform;let N=!1,A=!1,k=!1;"zoom"in c&&v.zoom!==+c.zoom&&(N=!0,v.zoom=+c.zoom),c.center!==void 0&&(v.center=s.bO.convert(c.center)),"bearing"in c&&v.bearing!==+c.bearing&&(A=!0,v.bearing=+c.bearing),"pitch"in c&&v.pitch!==+c.pitch&&(k=!0,v.pitch=+c.pitch);const z=typeof c.padding=="number"?this._extendPadding(c.padding):c.padding;if(c.padding!=null&&!v.isPaddingEqual(z))if(c.retainPadding===!1){const q=v.clone();q.padding=z,v.setLocationAtPoint(v.center,q.centerPoint)}else v.padding=z;return c.preloadOnly?(this._preloadTiles(v),this):(this.fire(new s.A("movestart",h)).fire(new s.A("move",h)),N&&this.fire(new s.A("zoomstart",h)).fire(new s.A("zoom",h)).fire(new s.A("zoomend",h)),A&&this.fire(new s.A("rotatestart",h)).fire(new s.A("rotate",h)).fire(new s.A("rotateend",h)),k&&this.fire(new s.A("pitchstart",h)).fire(new s.A("pitch",h)).fire(new s.A("pitchend",h)),this.fire(new s.A("moveend",h)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||s.w(bC),this.transform.getFreeCameraOptions()}setFreeCameraOptions(c,h){const v=this.transform;if(!v.projection.supportsFreeCamera)return s.w(bC),this;this.stop();const N=v.zoom,A=v.pitch,k=v.bearing;v.setFreeCameraOptions(c);const z=N!==v.zoom,q=A!==v.pitch,K=k!==v.bearing;return this.fire(new s.A("movestart",h)).fire(new s.A("move",h)),z&&this.fire(new s.A("zoomstart",h)).fire(new s.A("zoom",h)).fire(new s.A("zoomend",h)),K&&this.fire(new s.A("rotatestart",h)).fire(new s.A("rotate",h)).fire(new s.A("rotateend",h)),q&&this.fire(new s.A("pitchstart",h)).fire(new s.A("pitch",h)).fire(new s.A("pitchend",h)),this.fire(new s.A("moveend",h)),this}easeTo(c,h){this._stop(!1,c.easeId),((c=s.l({offset:[0,0],duration:500,easing:s.dD},c)).animate===!1||this._prefersReducedMotion(c))&&(c.duration=0);const v=this.transform,N=this.getZoom(),A=this.getBearing(),k=this.getPitch(),z=this.getPadding(),q="zoom"in c?+c.zoom:N,K="bearing"in c?this._normalizeBearing(c.bearing,A):A,Y="pitch"in c?+c.pitch:k,ee=this._extendPadding(c.padding),Q=s.P.convert(c.offset);let ie,de,le;if(v.projection.name==="globe"){const Ke=s.ac.fromLngLat(v.center),ft=Q.rotate(-v.angle);Ke.x+=ft.x/v.worldSize,Ke.y+=ft.y/v.worldSize;const at=Ke.toLngLat(),kt=s.bO.convert(c.center||at);this._normalizeCenter(kt),ie=v.centerPoint.add(ft),de=new s.P(Ke.x,Ke.y).mult(v.worldSize),le=new s.P(s.av(kt.lng),s.aC(kt.lat)).mult(v.worldSize).sub(de)}else{ie=v.centerPoint.add(Q);const Ke=v.pointLocation(ie),ft=s.bO.convert(c.center||Ke);this._normalizeCenter(ft),de=v.project(Ke),le=v.project(ft).sub(de)}const he=v.zoomScale(q-N);let fe,Te;c.around&&(fe=s.bO.convert(c.around),Te=v.locationPoint(fe));const Re=this._zooming||q!==N,Oe=this._rotating||A!==K,$e=this._pitching||Y!==k,Le=!v.isPaddingEqual(ee),Fe=c.retainPadding===!1?v.clone():v,Be=Ke=>ft=>{if(Re&&(Ke.zoom=s.ah(N,q,ft)),Oe&&(Ke.bearing=s.ah(A,K,ft)),$e&&(Ke.pitch=s.ah(k,Y,ft)),Le&&(Fe.interpolatePadding(z,ee,ft),ie=Fe.centerPoint.add(Q)),fe)Ke.setLocationAtPoint(fe,Te);else{const at=Ke.zoomScale(Ke.zoom-N),kt=q>N?Math.min(2,he):Math.max(.5,he),Pt=Math.pow(kt,1-ft),Bt=Ke.unproject(de.add(le.mult(ft*Pt)).mult(at));Ke.setLocationAtPoint(Ke.renderWorldCopies?Bt.wrap():Bt,ie)}return c.preloadOnly||this._fireMoveEvents(h),Ke};if(c.preloadOnly){const Ke=this._emulate(Be,c.duration,v);return this._preloadTiles(Ke),this}const He={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=Re,this._rotating=Oe,this._pitching=$e,this._padding=Le,this._easeId=c.easeId,this._prepareEase(h,c.noMoveStart,He),this._ease(Be(v),Ke=>{v.cameraElevationReference==="sea"&&v.recenterOnTerrain(),this._afterEase(h,Ke)},c),this}_prepareEase(c,h,v={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&this.transform.pitch===0&&this.transform.projection.name!=="globe"&&(this.transform.cameraElevationReference="ground"),h||v.moving||this.fire(new s.A("movestart",c)),this._zooming&&!v.zooming&&this.fire(new s.A("zoomstart",c)),this._rotating&&!v.rotating&&this.fire(new s.A("rotatestart",c)),this._pitching&&!v.pitching&&this.fire(new s.A("pitchstart",c))}_fireMoveEvents(c){this.fire(new s.A("move",c)),this._zooming&&this.fire(new s.A("zoom",c)),this._rotating&&this.fire(new s.A("rotate",c)),this._pitching&&this.fire(new s.A("pitch",c))}_afterEase(c,h){if(this._easeId&&h&&this._easeId===h)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const v=this._zooming,N=this._rotating,A=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,v&&this.fire(new s.A("zoomend",c)),N&&this.fire(new s.A("rotateend",c)),A&&this.fire(new s.A("pitchend",c)),this.fire(new s.A("moveend",c))}flyTo(c,h){if(this._prefersReducedMotion(c)){const _t=s.aA(c,["center","zoom","bearing","pitch","around","padding","retainPadding"]);return this.jumpTo(_t,h)}this.stop(),c=s.l({offset:[0,0],speed:1.2,curve:1.42,easing:s.dD},c);const v=this.transform,N=this.getZoom(),A=this.getBearing(),k=this.getPitch(),z=this.getPadding(),q="zoom"in c?s.ay(+c.zoom,v.minZoom,v.maxZoom):N,K="bearing"in c?this._normalizeBearing(c.bearing,A):A,Y="pitch"in c?+c.pitch:k,ee=this._extendPadding(c.padding),Q=v.zoomScale(q-N),ie=s.P.convert(c.offset);let de=v.centerPoint.add(ie);const le=v.pointLocation(de),he=s.bO.convert(c.center||le);this._normalizeCenter(he);const fe=v.project(le),Te=v.project(he).sub(fe);let Re=c.curve;const Oe=Math.max(v.width,v.height),$e=Oe/Q,Le=Te.mag();if("minZoom"in c){const _t=s.ay(Math.min(c.minZoom,N,q),v.minZoom,v.maxZoom),Et=Oe/v.zoomScale(_t-N);Re=Math.sqrt(Et/Le*2)}const Fe=Re*Re;function Be(_t){const Et=($e*$e-Oe*Oe+(_t?-1:1)*Fe*Fe*Le*Le)/(2*(_t?$e:Oe)*Fe*Le);return Math.log(Math.sqrt(Et*Et+1)-Et)}function He(_t){return(Math.exp(_t)-Math.exp(-_t))/2}function Ke(_t){return(Math.exp(_t)+Math.exp(-_t))/2}const ft=Be(0);let at=function(_t){return Ke(ft)/Ke(ft+Re*_t)},kt=function(_t){return Oe*((Ke(ft)*(He(Et=ft+Re*_t)/Ke(Et))-He(ft))/Fe)/Le;var Et},Pt=(Be(1)-ft)/Re;if(Math.abs(Le)<1e-6||!isFinite(Pt)){if(Math.abs(Oe-$e)<1e-6)return this.easeTo(c,h);const _t=$e<Oe?-1:1;Pt=Math.abs(Math.log($e/Oe))/Re,kt=function(){return 0},at=function(Et){return Math.exp(_t*Re*Et)}}c.duration="duration"in c?+c.duration:1e3*Pt/("screenSpeed"in c?+c.screenSpeed/Re:+c.speed),c.maxDuration&&c.duration>c.maxDuration&&(c.duration=0);const Bt=A!==K,st=Y!==k,At=!v.isPaddingEqual(ee),rt=c.retainPadding===!1?v.clone():v,Ct=_t=>Et=>{const pt=Et*Pt,It=1/at(pt);_t.zoom=Et===1?q:N+_t.scaleZoom(It),Bt&&(_t.bearing=s.ah(A,K,Et)),st&&(_t.pitch=s.ah(k,Y,Et)),At&&(rt.interpolatePadding(z,ee,Et),de=rt.centerPoint.add(ie));const Kt=Et===1?he:_t.unproject(fe.add(Te.mult(kt(pt))).mult(It));return _t.setLocationAtPoint(_t.renderWorldCopies?Kt.wrap():Kt,de),_t._updateCameraOnTerrain(),c.preloadOnly||this._fireMoveEvents(h),_t};if(c.preloadOnly){const _t=this._emulate(Ct,c.duration,v);return this._preloadTiles(_t),this}return this._zooming=!0,this._rotating=Bt,this._pitching=st,this._padding=At,this._prepareEase(h,!1),this._ease(Ct(v),()=>this._afterEase(h),c),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_requestRenderFrame(c){}_cancelRenderFrame(c){}_stop(c,h){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const v=this._onEaseEnd;this._onEaseEnd=void 0,v.call(this,h)}if(!c){const v=this.handlers;v&&v.stop(!1)}return this}_ease(c,h,v){v.animate===!1||v.duration===0?(c(1),h()):(this._easeStart=s.q.now(),this._easeOptions=v,this._onEaseFrame=c,this._onEaseEnd=h,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const c=Math.min((s.q.now()-this._easeStart)/this._easeOptions.duration,1),h=this._onEaseFrame;h&&h(this._easeOptions.easing(c)),c<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(c,h){c=s.bF(c,-180,180);const v=Math.abs(c-h);return Math.abs(c-360-h)<v&&(c-=360),Math.abs(c+360-h)<v&&(c+=360),c}_normalizeCenter(c){const h=this.transform;if(h.maxBounds||h.projection.name!=="globe"&&!h.renderWorldCopies)return;const v=c.lng-h.center.lng;c.lng+=v>180?-360:v<-180?360:0}_prefersReducedMotion(c){return this._respectPrefersReducedMotion&&s.q.prefersReducedMotion&&!(c&&c.essential)}_emulate(c,h,v){const N=Math.ceil(15*h/1e3),A=[],k=c(v.clone());for(let z=0;z<=N;z++){const q=k(z/N);A.push(q.clone())}return A}_preloadTiles(c,h){}}class jy{constructor(c={}){this.options=c,s.aQ(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(c){const h=this.options&&this.options.compact,v=c._getUIString("AttributionControl.ToggleAttribution");this._map=c,this._container=L("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=L("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._compactButton.setAttribute("aria-label",v);const N=L("span","mapboxgl-ctrl-icon",this._compactButton);return N.setAttribute("aria-hidden","true"),N.setAttribute("title",v),this._innerContainer=L("div","mapboxgl-ctrl-attrib-inner",this._container),h&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),h===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let c=this._editLink;c||(c=this._editLink=this._container.querySelector(".mapbox-improve-map"));const h=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||s.e.ACCESS_TOKEN}];if(c){const v=h.reduce((N,A,k)=>(A.value&&(N+=`${A.key}=${A.value}${k<h.length-1?"&":""}`),N),"?");c.href=`${s.e.FEEDBACK_URL}/${v}#${Y1(this._map,!0)}`,c.rel="noopener nofollow"}}_updateData(c){!c||c.sourceDataType!=="metadata"&&c.sourceDataType!=="visibility"&&c.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let c=[];if(this._map.style.stylesheet){const N=this._map.style.stylesheet;this.styleOwner=N.owner,this.styleId=N.id}const h=this._map.style._mergedSourceCaches;for(const N in h){const A=h[N];if(A.used){const k=A.getSource();k.attribution&&c.indexOf(k.attribution)<0&&c.push(k.attribution)}}c.sort((N,A)=>N.length-A.length),c=c.filter((N,A)=>{for(let k=A+1;k<c.length;k++)if(c[k].indexOf(N)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?c=[...this.options.customAttribution,...c]:c.unshift(this.options.customAttribution));const v=c.join(" | ");v!==this._attribHTML&&(this._attribHTML=v,c.length?(this._innerContainer.innerHTML=v,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class cl{constructor(){s.aQ(["_updateLogo","_updateCompact"],this)}onAdd(c){this._map=c,this._container=L("div","mapboxgl-ctrl");const h=L("a","mapboxgl-ctrl-logo");return h.target="_blank",h.rel="noopener nofollow",h.href="https://www.mapbox.com/",h.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),h.setAttribute("rel","noopener nofollow"),this._container.appendChild(h),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(c){c&&c.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const c=this._map.style._sourceCaches;if(Object.entries(c).length===0)return!0;for(const h in c){const v=c[h].getSource();if(v.hasOwnProperty("mapbox_logo")&&!v.mapbox_logo)return!1}return!0}_updateCompact(){const c=this._container.children;if(c.length){const h=c[0];this._map.getCanvasContainer().offsetWidth<250?h.classList.add("mapboxgl-compact"):h.classList.remove("mapboxgl-compact")}}}class ul{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(c){const h=++this._id;return this._queue.push({callback:c,id:h,cancelled:!1}),h}remove(c){const h=this._currentlyRunning,v=h?this._queue.concat(h):this._queue;for(const N of v)if(N.id===c)return void(N.cancelled=!0)}run(c=0){const h=this._currentlyRunning=this._queue;this._queue=[];for(const v of h)if(!v.cancelled&&(v.callback(c),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}class Tf{constructor(c){this.jumpTo(c)}getValue(c){if(c<=this._startTime)return this._start;if(c>=this._endTime)return this._end;const h=s.cC((c-this._startTime)/(this._endTime-this._startTime));return this._start*(1-h)+this._end*h}isEasing(c){return c>=this._startTime&&c<=this._endTime}jumpTo(c){this._startTime=-1/0,this._endTime=-1/0,this._start=c,this._end=c}easeTo(c,h,v){this._start=this.getValue(h),this._end=c,this._startTime=h,this._endTime=h+v}}const Kh={"AttributionControl.ToggleAttribution":"Toggle attribution","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox homepage","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use ⌘ + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"};class Zh extends s.A{constructor(c,h,v,N){const{point:A,lngLat:k,originalEvent:z,target:q}=c;super(c.type,{point:A,lngLat:k,originalEvent:z,target:q}),this.preventDefault=()=>{c.preventDefault()},this.id=h,this.interaction=v,this.feature=N}}class rw{constructor(c){this.map=c,this.interactionsByType=new Map,this.delegatedInteractions=new Map,this.typeById=new Map,this.filters=new Map,this.handleType=this.handleType.bind(this),this.handleMove=this.handleMove.bind(this),this.handleOut=this.handleOut.bind(this),this.hoveredFeatures=new Map,this.prevHoveredFeatures=new Map}add(c,h){if(this.typeById.has(c))throw new Error(`Interaction id "${c}" already exists.`);const v=h.filter;let N=h.type;v&&this.filters.set(c,s.a_(v)),N==="mouseover"&&(N="mouseenter"),N==="mouseout"&&(N="mouseleave");const A=this.interactionsByType.get(N)||new Map;N==="mouseenter"||N==="mouseleave"?(this.delegatedInteractions.size===0&&(this.map.on("mousemove",this.handleMove),this.map.on("mouseout",this.handleOut)),this.delegatedInteractions.set(c,h)):A.size===0&&this.map.on(N,this.handleType),A.size===0&&this.interactionsByType.set(N,A),A.set(c,h),this.typeById.set(c,N)}get(c){const h=this.typeById.get(c);if(!h)return;const v=this.interactionsByType.get(h);return v?v.get(c):void 0}remove(c){const h=this.typeById.get(c);if(!h)return;this.typeById.delete(c),this.filters.delete(c);const v=this.interactionsByType.get(h);v&&(v.delete(c),h==="mouseenter"||h==="mouseleave"?(this.delegatedInteractions.delete(c),this.delegatedInteractions.size===0&&(this.map.off("mousemove",this.handleMove),this.map.off("mouseout",this.handleOut))):v.size===0&&this.map.off(h,this.handleType))}queryTargets(c,h){const v=[];for(const[N,A]of h)A.target&&v.push({targetId:N,target:A.target,filter:this.filters.get(N)});return this.map.style.queryRenderedTargets(c,v,this.map.transform)}handleMove(c){this.prevHoveredFeatures=this.hoveredFeatures,this.hoveredFeatures=new Map;const h=this.queryTargets(c.point,Array.from(this.delegatedInteractions).reverse());h.length&&(c.type="mouseenter",this.handleType(c,h));const v=new Map;for(const[N,{feature:A}]of this.prevHoveredFeatures)this.hoveredFeatures.has(N)||v.set(A.id,A);v.size&&(c.type="mouseleave",this.handleType(c,Array.from(v.values())))}handleOut(c){const h=Array.from(this.hoveredFeatures.values()).map(({feature:v})=>v);h.length&&(c.type="mouseleave",this.handleType(c,h)),this.hoveredFeatures.clear()}handleType(c,h){const v=Array.from(this.interactionsByType.get(c.type)).reverse(),N=!!h;h=h||this.queryTargets(c.point,v);const A=c.type==="mouseenter";let k=!1;const z=new Set;for(const q of h){for(const[K,Y]of v){if(!Y.target)continue;const ee=q.variants?q.variants[K]:null;if(ee){for(const Q of ee){if(Ed(Q,q,z,K))continue;const ie=new s.cx(q,Q),de=Rh(Q,q,K);N&&(ie.state=this.map.getFeatureState(ie));const le=A?this.prevHoveredFeatures.get(de):null,he=new Zh(c,K,Y,ie),fe=le?le.stop:Y.handler(he);if(A&&this.hoveredFeatures.set(de,{feature:q,stop:fe}),fe!==!1){k=!0;break}}if(k)break}}if(k)break}if(!k)for(const[q,K]of v){const{handler:Y,target:ee}=K;if(!ee&&Y(new Zh(c,q,K,null))!==!1)break}}}function $n(b,c){if(Array.isArray(b)&&Array.isArray(c)){const h=new Set(b),v=new Set(c);return h.size===v.size&&b.every(N=>v.has(N))}return s.bn(b,c)}const Hd={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1,precompilePrograms:!0,scaleFactor:1,spriteFormat:"auto"},g4={showCompass:!0,showZoom:!0,visualizePitch:!1};class x4{constructor(c,h,v=!1){this._clickTolerance=10,this.element=h,this.mouseRotate=new Qc({clickTolerance:c.dragRotate._mouseRotate._clickTolerance}),this.map=c,v&&(this.mousePitch=new Zg({clickTolerance:c.dragRotate._mousePitch._clickTolerance})),s.aQ(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),h.addEventListener("mousedown",this.mousedown),h.addEventListener("touchstart",this.touchstart,{passive:!1}),h.addEventListener("touchmove",this.touchmove),h.addEventListener("touchend",this.touchend),h.addEventListener("touchcancel",this.reset)}down(c,h){this.mouseRotate.mousedown(c,h),this.mousePitch&&this.mousePitch.mousedown(c,h),W()}move(c,h){const v=this.map,N=this.mouseRotate.mousemoveWindow(c,h),A=N&&N.bearingDelta;if(A&&v.setBearing(v.getBearing()+A),this.mousePitch){const k=this.mousePitch.mousemoveWindow(c,h),z=k&&k.pitchDelta;z&&v.setPitch(v.getPitch()+z)}}off(){const c=this.element;c.removeEventListener("mousedown",this.mousedown),c.removeEventListener("touchstart",this.touchstart,{passive:!1}),c.removeEventListener("touchmove",this.touchmove),c.removeEventListener("touchend",this.touchend),c.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){Z(),window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseup",this.mouseup)}mousedown(c){this.down(s.l({},c,{ctrlKey:!0,preventDefault:()=>c.preventDefault()}),ce(this.element,c)),window.addEventListener("mousemove",this.mousemove),window.addEventListener("mouseup",this.mouseup)}mousemove(c){this.move(c,ce(this.element,c))}mouseup(c){this.mouseRotate.mouseupWindow(c),this.mousePitch&&this.mousePitch.mouseupWindow(c),this.offTemp()}touchstart(c){c.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=Pe(this.element,c.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>c.preventDefault()},this._startPos))}touchmove(c){c.targetTouches.length!==1?this.reset():(this._lastPos=Pe(this.element,c.targetTouches)[0],this.move({preventDefault:()=>c.preventDefault()},this._lastPos))}touchend(c){c.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function Ny(b,c,h){if(b=new s.bO(b.lng,b.lat),c){const v=new s.bO(b.lng-360,b.lat),N=new s.bO(b.lng+360,b.lat),A=360*Math.ceil(Math.abs(b.lng-h.center.lng)/360),k=h.locationPoint3D(b).distSqr(c),z=c.x<0||c.y<0||c.x>h.width||c.y>h.height;h.locationPoint3D(v).distSqr(c)<k&&(z||Math.abs(v.lng-h.center.lng)<A)?b=v:h.locationPoint3D(N).distSqr(c)<k&&(z||Math.abs(N.lng-h.center.lng)<A)&&(b=N)}for(;Math.abs(b.lng-h.center.lng)>180;){const v=h.locationPoint3D(b);if(v.x>=0&&v.y>=0&&v.x<=h.width&&v.y<=h.height)break;b.lng>h.center.lng?b.lng-=360:b.lng+=360}return b}const eu={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"},ka={rotation:0,rotationAlignment:"auto",pitchAlignment:"auto",occludedOpacity:.2,altitude:0};class Pa extends s.E{constructor(c,h){super(),(c instanceof HTMLElement||h)&&(c=s.l({element:c},h)),s.aQ(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this);const{anchor:v="center",color:N="#3FB1CE",scale:A=1,draggable:k=!1,clickTolerance:z=0,rotation:q=ka.rotation,rotationAlignment:K=ka.rotationAlignment,pitchAlignment:Y=ka.pitchAlignment,occludedOpacity:ee=ka.occludedOpacity,altitude:Q=ka.altitude}=c||{};this._anchor=v,this._color=N,this._scale=A,this._draggable=k,this._clickTolerance=z,this._rotation=q,this._rotationAlignment=K,this._pitchAlignment=Y,this._occludedOpacity=ee,this._altitude=Q,this._state="inactive",this._isDragging=!1,this._updateMoving=()=>this._update(!0),c&&c.element?(this._element=c.element,this._offset=s.P.convert(c&&c.offset||[0,0])):(this._defaultMarker=!0,this._element=this._createDefaultMarker(),this._offset=s.P.convert(c&&c.offset||[0,-14])),this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",le=>{le.preventDefault()}),this._element.addEventListener("mousedown",le=>{le.preventDefault()});const ie=this._element.classList;for(const le in eu)ie.remove(`mapboxgl-marker-anchor-${le}`);ie.add(`mapboxgl-marker-anchor-${this._anchor}`);const de=c&&c.className?c.className.trim().split(/\s+/):[];ie.add(...de),this._popup=null}_createDefaultMarker(){const c=L("div"),h=B("svg",{display:"block",height:41*this._scale+"px",width:27*this._scale+"px",viewBox:"0 0 27 41"},c);if(this._altitude===0){const v=B("radialGradient",{id:"shadowGradient"},B("defs",{},h));B("stop",{offset:"10%","stop-opacity":.4},v),B("stop",{offset:"100%","stop-opacity":.05},v),B("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},h)}return B("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},h),B("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},h),B("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},h),c}addTo(c){return c===this._map||(this.remove(),this._map=c,c.getCanvasContainer().appendChild(this._element),c.on("move",this._updateMoving),c.on("moveend",this._update),c.on("remove",this._clearFadeTimer),c._addMarker(this),this.setDraggable(this._draggable),this._update(),c.on("click",this._onMapClick)),this}remove(){const c=this._map;return c&&(c.off("click",this._onMapClick),c.off("move",this._updateMoving),c.off("moveend",this._update),c.off("mousedown",this._addDragHandler),c.off("touchstart",this._addDragHandler),c.off("mouseup",this._onUp),c.off("touchend",this._onUp),c.off("mousemove",this._onMove),c.off("touchmove",this._onMove),c.off("remove",this._clearFadeTimer),c._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(c){return this._lngLat=s.bO.convert(c),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}setAltitude(c){return c===this._altitude||(this._defaultMarker&&(this._altitude===0&&c!==0||this._altitude!==0&&c===0)&&(this._element=this._createDefaultMarker()),this._altitude=c||ka.altitude,this._update()),this}getAltitude(){return this._altitude}getElement(){return this._element}setPopup(c){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),c){if(!("offset"in c.options)){const N=Math.sqrt(Math.pow(13.5,2)/2);c.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[N,-1*(38.1-13.5+N)],"bottom-right":[-N,-1*(38.1-13.5+N)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=c,c._marker=this,c._altitude=this._altitude,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(c){const h=c.code,v=c.charCode||c.keyCode;h!=="Space"&&h!=="Enter"&&v!==32&&v!==13||this.togglePopup()}_onMapClick(c){const h=c.originalEvent.target,v=this._element;this._popup&&(h===v||v.contains(h))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const c=this._popup;return c?(c.isOpen()?(c.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(c.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const c=this._map,h=this._pos;if(!c||!h)return!1;const v=c.unproject(h,this._altitude),N=c.getFreeCameraOptions();if(!N.position)return!1;const A=N.position.toLngLat();return A.distanceTo(v)<.9*A.distanceTo(this._lngLat)}_evaluateOpacity(){const c=this._map;if(!c)return;const h=this._pos;if(!h||h.x<0||h.x>c.transform.width||h.y<0||h.y>c.transform.height)return void this._clearFadeTimer();const v=c.unproject(h,this._altitude);let N;c._showingGlobe()&&s.dK(c.transform,this._lngLat)?N=0:(N=1-c._queryFogOpacity(v),c.transform._terrainEnabled()&&c.getTerrain()&&this._behindTerrain()&&(N*=this._occludedOpacity)),this._element.style.opacity=`${N}`,this._element.style.pointerEvents=N>0?"auto":"none",this._popup&&this._popup._setOpacity(N),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const c=this._pos;if(!c||!this._map)return;const h=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${c.x}px,${c.y}px)
            ${eu[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${h.x}px,${h.y}px)
        `}_calculateXYTransform(){const c=this._pos,h=this._map,v=this.getPitchAlignment();if(!h||!c||v!=="map")return"";if(!h._showingGlobe()){const q=h.getPitch();return q?`rotateX(${q}deg)`:""}const N=s.c4(s.dL(h.transform,this._lngLat)),A=c.sub(s.dM(h.transform)),k=Math.abs(A.x)+Math.abs(A.y);if(k===0)return"";const z=N/k;return`rotateX(${-A.y*z}deg) rotateY(${A.x*z}deg)`}_calculateZTransform(){const c=this._pos,h=this._map;if(!h||!c)return"";let v=0;const N=this.getRotationAlignment();if(N==="map")if(h._showingGlobe()){const A=h.project(new s.bO(this._lngLat.lng,this._lngLat.lat+.001),this._altitude),k=h.project(new s.bO(this._lngLat.lng,this._lngLat.lat-.001),this._altitude).sub(A);v=s.c4(Math.atan2(k.y,k.x))-90}else v=-h.getBearing();else if(N==="horizon"){const A=s.ae(4,6,h.getZoom()),k=s.dM(h.transform);k.y+=A*h.transform.height;const z=c.sub(k),q=s.c4(Math.atan2(z.y,z.x));v=(q>90?q-270:q+90)*(1-A)}return v+=this._rotation,v?`rotateZ(${v}deg)`:""}_update(c){cancelAnimationFrame(this._updateFrameId);const h=this._map;h&&(h.transform.renderWorldCopies&&(this._lngLat=Ny(this._lngLat,this._pos,h.transform)),this._pos=h.project(this._lngLat,this._altitude),c===!0?this._updateFrameId=requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),h._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(h._showingGlobe()||h.getTerrain()||h.getFog())&&!this._fadeTimer&&(this._fadeTimer=window.setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(c){return this._offset=s.P.convert(c),this._update(),this}addClassName(c){return this._element.classList.add(c),this}removeClassName(c){return this._element.classList.remove(c),this}toggleClassName(c){return this._element.classList.toggle(c)}_onMove(c){const h=this._map;if(!h)return;const v=this._pointerdownPos,N=this._positionDelta;if(v&&N){if(!this._isDragging){const A=this._clickTolerance||h._clickTolerance;if(c.point.dist(v)<A)return;this._isDragging=!0}this._pos=c.point.sub(N),this._lngLat=h.unproject(this._pos,this._altitude),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new s.A("dragstart"))),this.fire(new s.A("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const c=this._map;c&&(c.off("mousemove",this._onMove),c.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new s.A("dragend")),this._state="inactive"}_addDragHandler(c){const h=this._map,v=this._pos;h&&v&&this._element.contains(c.originalEvent.target)&&(c.preventDefault(),this._positionDelta=c.point.sub(v),this._pointerdownPos=c.point,this._state="pending",h.on("mousemove",this._onMove),h.on("touchmove",this._onMove),h.once("mouseup",this._onUp),h.once("touchend",this._onUp))}setDraggable(c){this._draggable=!!c;const h=this._map;return h&&(c?(h.on("mousedown",this._addDragHandler),h.on("touchstart",this._addDragHandler)):(h.off("mousedown",this._addDragHandler),h.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(c){return this._rotation=c||ka.rotation,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(c){return this._rotationAlignment=c||ka.rotationAlignment,this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(c){return this._pitchAlignment=c||ka.pitchAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(c){return this._occludedOpacity=c||ka.occludedOpacity,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const Lo={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},ba={maxWidth:100,unit:"metric"},nw={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},ds={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",altitude:0},_C=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function qd(b=new s.P(0,0),c="bottom"){if(typeof b=="number"){const h=Math.round(Math.sqrt(.5*Math.pow(b,2)));switch(c){case"top":return new s.P(0,b);case"top-left":return new s.P(h,h);case"top-right":return new s.P(-h,h);case"bottom":return new s.P(0,-b);case"bottom-left":return new s.P(h,-h);case"bottom-right":return new s.P(-h,-h);case"left":return new s.P(b,0);case"right":return new s.P(-b,0)}return new s.P(0,0)}return b instanceof s.P||Array.isArray(b)?s.P.convert(b):s.P.convert(b[c]||[0,0])}return{version:p,supported:F.supported,setRTLTextPlugin:s.dN,getRTLTextPluginStatus:s.dO,Map:class extends Af{constructor(b){w.mark(x.create);const c=b;if((b=s.l({},Hd,b)).minZoom!=null&&b.maxZoom!=null&&b.minZoom>b.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(b.minPitch!=null&&b.maxPitch!=null&&b.minPitch>b.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(b.minPitch!=null&&b.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(b.maxPitch!=null&&b.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(b.antialias&&s.dI(window)&&(b.antialias=!1,s.w("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Lx(b.minZoom,b.maxZoom,b.minPitch,b.maxPitch,b.renderWorldCopies,null,null),b),this._repaint=!!b.repaint,this._interactive=b.interactive,this._minTileCacheSize=b.minTileCacheSize,this._maxTileCacheSize=b.maxTileCacheSize,this._failIfMajorPerformanceCaveat=b.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=b.preserveDrawingBuffer,this._antialias=b.antialias,this._trackResize=b.trackResize,this._bearingSnap=b.bearingSnap,this._refreshExpiredTiles=b.refreshExpiredTiles,this._fadeDuration=b.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=b.crossSourceCollisions,this._collectResourceTiming=b.collectResourceTiming,this._language=this._parseLanguage(b.language),this._worldview=b.worldview,this._renderTaskQueue=new ul,this._domRenderTaskQueue=new ul,this._controls=[],this._markers=[],this._popups=[],this._mapId=s.aW(),this._locale=s.l({},Kh,b.locale),this._clickTolerance=b.clickTolerance,this._cooperativeGestures=b.cooperativeGestures,this._performanceMetricsCollection=b.performanceMetricsCollection,this._tessellationStep=b.tessellationStep,this._containerWidth=0,this._containerHeight=0,this._showParseStatus=!0,this._precompilePrograms=b.precompilePrograms,this._scaleFactorChanged=!1,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Tf(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._frameId=0,this._scaleFactor=b.scaleFactor,this._requestManager=new ye(b.transformRequest,b.accessToken,b.testMode),this._silenceAuthErrors=!!b.testMode,this._contextCreateOptions=b.contextCreateOptions?Object.assign({},b.contextCreateOptions):{},typeof b.container=="string"){const h=document.getElementById(b.container);if(!h)throw new Error(`Container '${b.container.toString()}' not found.`);this._container=h}else{if(!(b.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=b.container}if(this._container.childNodes.length>0&&s.w("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),b.maxBounds&&this.setMaxBounds(b.maxBounds),this._spriteFormat=b.spriteFormat,s.aQ(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._tp||(this._tp=new G1),this._tp.registerParameter(this,["Debug"],"showOverdrawInspector"),this._tp.registerParameter(this,["Debug"],"showTileBoundaries"),this._tp.registerParameter(this,["Debug"],"showParseStatus"),this._tp.registerParameter(this,["Debug"],"repaint"),this._tp.registerParameter(this,["Debug"],"showTileAABBs"),this._tp.registerParameter(this,["Debug"],"showPadding"),this._tp.registerParameter(this,["Debug"],"showCollisionBoxes",{noSave:!0}),this._tp.registerParameter(this.transform,["Debug"],"freezeTileCoverage",{noSave:!0},()=>{this._update()}),this._tp.registerParameter(this,["Debug","Wireframe"],"showTerrainWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers2DWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers3DWireframe"),this._tp.registerParameter(this,["Scaling"],"_scaleFactor",{min:.1,max:10,step:.1},()=>{this.setScaleFactor(this._scaleFactor)}),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");if(this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this._fullscreenchangeEvent="onfullscreenchange"in document?"fullscreenchange":"webkitfullscreenchange",window.addEventListener("online",this._onWindowOnline,!1),window.addEventListener("resize",this._onWindowResize,!1),window.addEventListener("orientationchange",this._onWindowResize,!1),window.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.addEventListener("visibilitychange",this._onVisibilityChange,!1),this.handlers=new vC(this,b),this._localFontFamily=b.localFontFamily,this._localIdeographFontFamily=b.localIdeographFontFamily,(b.style||!b.testMode)&&this.setStyle(b.style||s.e.DEFAULT_STYLE,{config:b.config,localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),b.projection&&this.setProjection(b.projection),this.indoor=new OS(this),b.hash&&(this._hash=new Z1(typeof b.hash=="string"&&b.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){c.center==null&&c.zoom==null||(this.transform._unmodified=!1),this.jumpTo({center:b.center,zoom:b.zoom,bearing:b.bearing,pitch:b.pitch});const h=b.bounds;h&&(this.resize(),this.fitBounds(h,s.l({},b.fitBoundsOptions,{duration:0})))}this.resize(),b.attributionControl&&this.addControl(new jy({customAttribution:b.customAttribution})),this._logoControl=new cl,this.addControl(this._logoControl,b.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet),this._postStyleLoadEvent()}),this.on("data",h=>{this._update(h.dataType==="style"),this.fire(new s.A(`${h.dataType}data`,h))}),this.on("dataloading",h=>{this.fire(new s.A(`${h.dataType}dataloading`,h))}),this._interactions=new rw(this)}_getMapId(){return this._mapId}addControl(b,c){if(c===void 0&&(c=b.getDefaultPosition?b.getDefaultPosition():"top-right"),!b||!b.onAdd)return this.fire(new s.z(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const h=b.onAdd(this);this._controls.push(b);const v=this._controlPositions[c];return c.indexOf("bottom")!==-1?v.insertBefore(h,v.firstChild):v.appendChild(h),this}removeControl(b){if(!b||!b.onRemove)return this.fire(new s.z(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const c=this._controls.indexOf(b);return c>-1&&this._controls.splice(c,1),b.onRemove(this),this}hasControl(b){return this._controls.indexOf(b)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(b){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const c=!this._moving;return c&&this.fire(new s.A("movestart",b)).fire(new s.A("move",b)),this.fire(new s.A("resize",b)),c&&this.fire(new s.A("moveend",b)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(b){return this.transform.setMaxBounds(s.aB.convert(b)),this._update()}setMinZoom(b){if((b=b??-2)>=-2&&b<=this.transform.maxZoom)return this.transform.minZoom=b,this._update(),this.getZoom()<b?this.setZoom(b):this.fire(new s.A("zoomstart")).fire(new s.A("zoom")).fire(new s.A("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(b){if((b=b??22)>=this.transform.minZoom)return this.transform.maxZoom=b,this._update(),this.getZoom()>b?this.setZoom(b):this.fire(new s.A("zoomstart")).fire(new s.A("zoom")).fire(new s.A("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(b){if((b=b??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(b>=0&&b<=this.transform.maxPitch)return this.transform.minPitch=b,this._update(),this.getPitch()<b?this.setPitch(b):this.fire(new s.A("pitchstart")).fire(new s.A("pitch")).fire(new s.A("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(b){if((b=b??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(b>=this.transform.minPitch)return this.transform.maxPitch=b,this._update(),this.getPitch()>b?this.setPitch(b):this.fire(new s.A("pitchstart")).fire(new s.A("pitch")).fire(new s.A("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getScaleFactor(){return this._scaleFactor}setScaleFactor(b){return this._scaleFactor=b,this.painter.scaleFactor=b,this._tp.refreshUI(),this._scaleFactorChanged=!0,this.style._updateFilteredLayers(c=>c.type==="symbol"),this._update(!0),this}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(b){return this.transform.renderWorldCopies=b,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(b){return b==="auto"?navigator.language:Array.isArray(b)?b.length===0?void 0:b.map(c=>c==="auto"?navigator.language:c):b}setLanguage(b){const c=this._parseLanguage(b);if(!this.style||c===this._language)return this;this._language=c,this.style.reloadSources();for(const h of this._controls)h._setLanguage&&h._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(b){return this.style&&b!==this._worldview?(this._worldview=b,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(b){return this._lazyInitEmptyStyle(),b?typeof b=="string"&&(b={name:b}):b=null,this._useExplicitProjection=!!b,this._prioritizeAndUpdateProjection(b,this.style.projection)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const b=this.transform,c=b.projection.name;let h;c==="globe"&&b.zoom>=s.bY?(b.setMercatorFromTransition(),h=!0):c==="mercator"&&b.zoom<s.bY&&(b.setProjection({name:"globe"}),h=!0),h&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(b,c){return this._updateProjection(b||c||{name:"mercator"})}_updateProjection(b){let c;return c=b.name==="globe"&&this.transform.zoom>=s.bY?this.transform.setMercatorFromTransition():this.transform.setProjection(b),this.style.applyProjectionUpdate(),c&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(b,c){return this.transform.locationPoint3D(s.bO.convert(b),c)}unproject(b,c){return this.transform.pointLocation3D(s.P.convert(b),c)}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(b,c,h){const v=N=>{let A=[];if(Array.isArray(c)){const k=c.filter(z=>this.getLayer(z));A=k.length?this.queryRenderedFeatures(N,{layers:k}):[]}else A=this.queryRenderedFeatures(N,{target:c});return A};if(b==="mouseenter"||b==="mouseover"){let N=!1;return{listener:h,targets:c,delegates:{mousemove:k=>{const z=v(k.point);z.length?N||(N=!0,h.call(this,new zo(b,this,k.originalEvent,{features:z}))):N=!1},mouseout:()=>{N=!1}}}}if(b==="mouseleave"||b==="mouseout"){let N=!1;return{listener:h,targets:c,delegates:{mousemove:z=>{v(z.point).length?N=!0:N&&(N=!1,h.call(this,new zo(b,this,z.originalEvent)))},mouseout:z=>{N&&(N=!1,h.call(this,new zo(b,this,z.originalEvent)))}}}}{const N=A=>{const k=v(A.point);k.length&&(A.features=k,h.call(this,A),delete A.features)};return{listener:h,targets:c,delegates:{[b]:N}}}}on(b,c,h){if(typeof c=="function"||h===void 0)return super.on(b,c);if(typeof c=="string"&&(c=[c]),!this._areTargetsValid(c))return this;const v=this._createDelegatedListener(b,c,h);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[b]=this._delegatedListeners[b]||[],this._delegatedListeners[b].push(v);for(const N in v.delegates)this.on(N,v.delegates[N]);return this}once(b,c,h){if(typeof c=="function"||h===void 0)return super.once(b,c);if(typeof c=="string"&&(c=[c]),!this._areTargetsValid(c))return this;const v=this._createDelegatedListener(b,c,h);for(const N in v.delegates)this.once(N,v.delegates[N]);return this}off(b,c,h){if(typeof c=="function"||h===void 0)return super.off(b,c);if(typeof c=="string"&&(c=[c]),!this._areTargetsValid(c))return this;const v=this._delegatedListeners?this._delegatedListeners[b]:void 0;return v&&(N=>{for(let A=0;A<N.length;A++){const k=N[A];if(k.listener===h&&$n(k.targets,c)){for(const z in k.delegates)this.off(z,k.delegates[z]);return N.splice(A,1),this}}})(v),this}queryRenderedFeatures(b,c){if(!this.style)return[];if(b===void 0||b instanceof s.P||Array.isArray(b)||c!==void 0||(c=b,b=void 0),b=b||[[0,0],[this.transform.width,this.transform.height]],!c){const A=this.style.queryRenderedFeatures(b,void 0,this.transform),k=this.style.queryRenderedFeatureset(b,void 0,this.transform);return A.concat(k)}let h=!0;if(c.target&&(h=this._isTargetValid(c.target),h&&!c.layers))return this.style.queryRenderedFeatureset(b,c,this.transform);let v=!0;if(c.layers&&Array.isArray(c.layers)){for(const A of c.layers)if(!this._isValidId(A)){v=!1;break}if(v&&!c.target)return this.style.queryRenderedFeatures(b,c,this.transform)}let N=[];return v&&(N=N.concat(this.style.queryRenderedFeatures(b,c,this.transform))),h&&(N=N.concat(this.style.queryRenderedFeatureset(b,c,this.transform))),N}querySourceFeatures(b,c){return!b||typeof b=="string"&&!this._isValidId(b)?[]:this.style.querySourceFeatures(b,c)}isPointOnSurface(b){const{name:c}=this.transform.projection;return c!=="globe"&&c!=="mercator"&&s.w(`${c} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(s.P.convert(b))}addInteraction(b,c){return this._interactions.add(b,c),this}removeInteraction(b){return this._interactions.remove(b),this}getCooperativeGestures(){return this._cooperativeGestures}setCooperativeGestures(b){return this._cooperativeGestures=b,this}setStyle(b,c){return c=s.l({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},c),this.style&&b&&c.diff!==!1&&c.localFontFamily===this._localFontFamily&&c.localIdeographFontFamily===this._localIdeographFontFamily&&!c.config?(this.style._diffStyle(b,(h,v)=>{h?(s.w(`Unable to perform style diff: ${String(h.message||h.error||h)}. Rebuilding the style from scratch.`),this._updateStyle(b,c)):v&&this._update(!0)},()=>{this._postStyleLoadEvent()}),this):(this._localIdeographFontFamily=c.localIdeographFontFamily,this._localFontFamily=c.localFontFamily,this._updateStyle(b,c))}_getUIString(b){const c=this._locale[b];if(c==null)throw new Error(`Missing UI string '${b}'`);return c}_updateStyle(b,c){if(this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),b){const h=s.l({},c);c&&c.config&&(h.initialConfig=c.config,delete h.config),this.style=new dc(this,h).load(b),this.style.setEventedParent(this,{style:this.style})}return this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new dc(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(s.w("There is no style added to the map."),!1)}_isValidId(b){return b==null?(this.fire(new s.z(new Error("IDs can't be empty."))),!1):!s.cs(b)||(this.fire(new s.z(new Error(`IDs can't contain special symbols: "${b}".`))),!1)}_isTargetValid(b){return"featuresetId"in b?this._isValidId("importId"in b?b.importId:b.featuresetId):"layerId"in b&&this._isValidId(b.layerId)}_areTargetsValid(b){if(Array.isArray(b)){for(const c of b)if(!this._isValidId(c))return!1;return!0}return this._isTargetValid(b)}addSource(b,c){return this._isValidId(b)?(this._lazyInitEmptyStyle(),this.style.addSource(b,c),this._update(!0)):this}isSourceLoaded(b){return!!this._isValidId(b)&&!!this.style&&this.style._isSourceCacheLoaded(b)}areTilesLoaded(){return this.style.areTilesLoaded()}addSourceType(b,c,h){this._lazyInitEmptyStyle(),this.style.addSourceType(b,c,h)}removeSource(b){return this._isValidId(b)?(this.style.removeSource(b),this._updateTerrain(),this._update(!0)):this}getSource(b){return this._isValidId(b)?this.style.getOwnSource(b):null}addImage(b,c,{pixelRatio:h=1,sdf:v=!1,stretchX:N,stretchY:A,content:k}={}){this._lazyInitEmptyStyle();const z=s.I.from(b);if(c instanceof HTMLImageElement||ImageBitmap&&c instanceof ImageBitmap){const{width:q,height:K,data:Y}=s.q.getImageData(c);this.style.addImage(z,this.style.scope,{data:new s.r({width:q,height:K},Y),pixelRatio:h,stretchX:N,stretchY:A,content:k,sdf:v,version:0,usvg:!1})}else if(c.width===void 0||c.height===void 0)this.fire(new s.z(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:q,height:K}=c,Y=c;this.style.addImage(z,this.style.scope,{data:new s.r({width:q,height:K},new Uint8Array(Y.data)),pixelRatio:h,stretchX:N,stretchY:A,content:k,sdf:v,usvg:!1,version:0,userImage:Y}),Y.onAdd&&Y.onAdd(this,b)}}updateImage(b,c){this._lazyInitEmptyStyle();const h=s.I.from(b),v=this.style.getImage(h,this.style.scope);if(!v)return void this.fire(new s.z(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const N=c instanceof HTMLImageElement||ImageBitmap&&c instanceof ImageBitmap?s.q.getImageData(c):c,{width:A,height:k,data:z}=N;if(A===void 0||k===void 0)return void this.fire(new s.z(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(A!==(v.usvg?v.icon.usvg_tree.width:v.data.width)||k!==(v.usvg?v.icon.usvg_tree.height:v.data.height))return void this.fire(new s.z(new Error(`The width and height of the updated image (${A}, ${k})
                must be that same as the previous version of the image
                (${v.data.width}, ${v.data.height})`)));const q=!(c instanceof HTMLImageElement||ImageBitmap&&c instanceof ImageBitmap);let K=!1;v.usvg?(v.data=new s.r({width:A,height:k},new Uint8Array(z)),v.usvg=!1,v.icon=void 0,K=!0):v.data.replace(z,q),this.style.updateImage(h,this.style.scope,v,K)}hasImage(b){return b?!!this.style&&!!this.style.getImage(s.I.from(b),this.style.scope):(this.fire(new s.z(new Error("Missing required image id"))),!1)}removeImage(b){this.style.removeImage(s.I.from(b),this.style.scope)}loadImage(b,c){s.o(this._requestManager.transformRequest(b,s.R.Image),(h,v)=>{c(h,v instanceof HTMLImageElement?s.q.getImageData(v):v)})}listImages(){return this.style.listImages().map(b=>b.name)}addModel(b,c){this._lazyInitEmptyStyle(),this.style.addModel(b,c)}hasModel(b){return b?this.style.hasModel(b):(this.fire(new s.z(new Error("Missing required model id"))),!1)}removeModel(b){this.style.removeModel(b)}listModels(){return this.style.listModels()}addLayer(b,c){return this._isValidId(b.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(b,c),this._update(!0)):this}getSlot(b){const c=this.getLayer(b);return c&&c.slot||null}setSlot(b,c){return this.style.setSlot(b,c),this.style.mergeLayers(),this._update(!0)}addImport(b,c){return this.style.addImport(b,c),this}updateImport(b,c){return typeof c!="string"&&c.id!==b?(this.removeImport(b),this.addImport(c)):(this.style.updateImport(b,c),this._update(!0))}removeImport(b){return this.style.removeImport(b),this}moveImport(b,c){return this.style.moveImport(b,c),this._update(!0)}moveLayer(b,c){return this._isValidId(b)?(this.style.moveLayer(b,c),this._update(!0)):this}removeLayer(b){return this._isValidId(b)?(this.style.removeLayer(b),this._update(!0)):this}getLayer(b){if(!this._isValidId(b))return null;const c=this.style.getOwnLayer(b);return c?c.type==="custom"?c.implementation:c.serialize():void 0}getSlots(){return this.style.getSlots()}setLayerZoomRange(b,c,h){return this._isValidId(b)?(this.style.setLayerZoomRange(b,c,h),this._update(!0)):this}setFilter(b,c,h={}){return this._isValidId(b)?(this.style.setFilter(b,c,h),this._update(!0)):this}getFilter(b){return this._isValidId(b)?this.style.getFilter(b):null}setPaintProperty(b,c,h,v={}){return this._isValidId(b)?(this.style.setPaintProperty(b,c,h,v),this._update(!0)):this}getPaintProperty(b,c){return this._isValidId(b)?this.style.getPaintProperty(b,c):null}setLayoutProperty(b,c,h,v={}){return this._isValidId(b)?(this.style.setLayoutProperty(b,c,h,v),this._update(!0)):this}getLayoutProperty(b,c){return this._isValidId(b)?this.style.getLayoutProperty(b,c):null}getGlyphsUrl(){return this.style.getGlyphsUrl()}setGlyphsUrl(b){return this.style.setGlyphsUrl(b),this._update(!0)}getSchema(b){return this.style.getSchema(b)}setSchema(b,c){return this.style.setSchema(b,c),this._update(!0)}getConfig(b){return this.style.getConfig(b)}setConfig(b,c){return this.style.setConfig(b,c),this._update(!0)}getConfigProperty(b,c){return this.style.getConfigProperty(b,c)}setConfigProperty(b,c,h){return this.style.setConfigProperty(b,c,h),this._update(!0)}getFeaturesetDescriptors(b){return this.style.getFeaturesetDescriptors(b)}setLights(b){if(this._lazyInitEmptyStyle(),b&&b.length===1&&b[0].type==="flat"){const c=b[0];c.properties?this.style.setFlatLight(c.properties,c.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(b),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const b=this.style.getLights()||[];return b.length===0&&b.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),b}setLight(b,c={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:b}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(b){return this._lazyInitEmptyStyle(),!b&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(b),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(b){return this._lazyInitEmptyStyle(),this.style.setFog(b),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setSnow(b){return this._lazyInitEmptyStyle(),this.style.setSnow(b),this._update(!0)}getSnow(){return this.style?this.style.getSnow():null}setRain(b){return this._lazyInitEmptyStyle(),this.style.setRain(b),this._update(!0)}getRain(){return this.style?this.style.getRain():null}setColorTheme(b){return this._lazyInitEmptyStyle(),this.style.setColorTheme(b),this._update(!0)}setImportColorTheme(b,c){return this._lazyInitEmptyStyle(),this.style.setImportColorTheme(b,c),this._update(!0)}setCamera(b){return this.style.setCamera(b),this._triggerCameraUpdate(b)}_triggerCameraUpdate(b){return this._update(this.transform.setOrthographicProjectionAtLowPitch(b["camera-projection"]==="orthographic"))}getCamera(){return this.style.camera}_queryFogOpacity(b){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(s.bO.convert(b),this.transform):0}setFeatureState(b,c){return b.source&&!this._isValidId(b.source)?this:(this.style.setFeatureState(b,c),this._update())}removeFeatureState(b,c){return b.source&&!this._isValidId(b.source)?this:(this.style.removeFeatureState(b,c),this._update())}getFeatureState(b){return b.source&&!this._isValidId(b.source)?null:this.style.getFeatureState(b)}_updateContainerDimensions(){if(!this._container)return;const b=this._container.getBoundingClientRect().width||400,c=this._container.getBoundingClientRect().height||300;let h,v,N,A=this._container;for(;A&&(!v||!N);){const k=window.getComputedStyle(A).transform;k&&k!=="none"&&(h=k.match(/matrix.*\((.+)\)/)[1].split(", "),h[0]&&h[0]!=="0"&&h[0]!=="1"&&(v=h[0]),h[3]&&h[3]!=="0"&&h[3]!=="1"&&(N=h[3])),A=A.parentElement}this._containerWidth=v?Math.abs(b/v):b,this._containerHeight=N?Math.abs(c/N):c}_detectMissingCSS(){window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&s.w("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const b=this._container;b.classList.add("mapboxgl-map"),(this._missingCSSCanary=L("div","mapboxgl-canary",b)).style.visibility="hidden",this._detectMissingCSS();const c=this._canvasContainer=L("div","mapboxgl-canvas-container",b);this._canvas=L("canvas","mapboxgl-canvas",c),this._interactive&&(c.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const h=this._controlContainer=L("div","mapboxgl-control-container",b),v=this._controlPositions={};["top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"].forEach(N=>{v[N]=L("div",`mapboxgl-ctrl-${N}`,h)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(b,c){const h=s.q.devicePixelRatio||1;this._canvas.width=h*Math.ceil(b),this._canvas.height=h*Math.ceil(c),this._canvas.style.width=`${b}px`,this._canvas.style.height=`${c}px`}_addMarker(b){this._markers.push(b)}_removeMarker(b){const c=this._markers.indexOf(b);c!==-1&&this._markers.splice(c,1)}_addPopup(b){this._popups.push(b)}_removePopup(b){const c=this._popups.indexOf(b);c!==-1&&this._popups.splice(c,1)}_setupPainter(){const b=s.l({},F.supported.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),c=this._canvas.getContext("webgl2",b);c?(St(c,!0),this.painter=new vy(c,this._contextCreateOptions,this.transform,this._scaleFactor,this._tp),this.on("data",h=>{h.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),s.m.testSupport(c)):this.fire(new s.z(new Error("Failed to initialize WebGL")))}_contextLost(b){b.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new s.A("webglcontextlost",{originalEvent:b}))}_contextRestored(b){this._setupPainter(),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight)),this._updateTerrain(),this.style.reloadModels(),this.style.clearSources(),this._update(),this.fire(new s.A("webglcontextrestored",{originalEvent:b}))}_onMapScroll(b){if(b.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}idle(){return!this.isMoving()&&this.loaded()}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}frameReady(){return this.loaded()&&!this._placementDirty}_update(b){return this.style?(this._styleDirty=this._styleDirty||b,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(b){return this._update(),this._renderTaskQueue.add(b)}_cancelRenderFrame(b){this._renderTaskQueue.remove(b)}_requestDomTask(b){!this.loaded()||this.loaded()&&!this.isMoving()?b():this._domRenderTaskQueue.add(b)}_render(b){let c;this.fire(new s.A("renderstart")),++this._frameId;const h=this.painter.context.extTimerQuery,v=s.q.now(),N=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(c=N.createQuery(),N.beginQuery(h.TIME_ELAPSED_EXT,c)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],performance.now())),this._renderTaskQueue.run(b),this._domRenderTaskQueue.run(b),this._removed)return;this._updateProjectionTransition();const A=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const K=this.transform.zoom,Y=this.transform.pitch,ee=s.q.now(),Q=new s.aa(K,{now:ee,fadeDuration:A,pitch:Y,transition:this.style.transition});this.style.update(Q)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let k=!1;this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),k=this._updateAverageElevation(v),this.style.updateSources(this.transform),this.style.updateImageProviders(),this.isMoving()||this._forceMarkerAndPopupUpdate()):k=this._updateAverageElevation(v);const z=this.style&&this.style._updatePlacement(this.painter,this.painter.transform,this.showCollisionBoxes,A,this._crossSourceCollisions,this.painter.replacementSource,this._scaleFactorChanged);if(this._scaleFactorChanged&&(this._scaleFactorChanged=!1),z&&(this._placementDirty=z.needsRerender),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showParseStatus:this.showParseStatus,wireframe:{terrain:this.showTerrainWireframe,layers2D:this.showLayers2DWireframe,layers3D:this.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:A,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new s.A("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,w.mark(x.load),this.fire(new s.A("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&(this.style.snow||this.style.rain)&&(this._styleDirty=!0),this.style&&this.style.imageManager.hasPatternsInFlight()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),c){const K=s.q.now()-v;N.endQuery(h.TIME_ELAPSED_EXT),setTimeout(()=>{const Y=N.getQueryParameter(c,N.QUERY_RESULT)/1e6;N.deleteQuery(c),this.fire(new s.A("gpu-timing-frame",{cpuTime:K,gpuTime:Y}))},50)}if(this.listens("gpu-timing-layer")){const K=this.painter.collectGpuTimers();setTimeout(()=>{const Y=this.painter.queryGpuTimers(K);this.fire(new s.A("gpu-timing-layer",{layerTimes:Y}))},50)}if(this.listens("gpu-timing-deferred-render")){const K=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const Y=this.painter.queryGpuTimeDeferredRender(K);this.fire(new s.A("gpu-timing-deferred-render",{gpuTime:Y}))},50)}const q=this._sourcesDirty||this._styleDirty||this._placementDirty||k;if(q||this._repaint)this.triggerRepaint();else{const K=this.idle();if(K&&(k=this._updateAverageElevation(v,!0)),k)this.triggerRepaint();else if(this._triggerFrame(!1),K&&(this.fire(new s.A("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const Y=this._calculateSpeedIndex();this.fire(new s.A("speedindexcompleted",{speedIndex:Y})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||q||(this._fullyLoaded=!0,w.mark(x.fullLoad),this._performanceMetricsCollection&&er(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(b){for(const c of this._markers)b&&!this.getRenderWorldCopies()&&(c._lngLat=c._lngLat.wrap()),c._update();for(const c of this._popups)!b||this.getRenderWorldCopies()||c._trackPointer||(c._lngLat=c._lngLat.wrap()),c._update()}_updateAverageElevation(b,c=!1){const h=N=>(this.transform.averageElevation=N,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&h(0);const v=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(v||(c||b-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(b)){const N=this.transform.averageElevation;let A=this.transform.sampleAverageElevation();this.transform.elevation!=null&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(A)?A=0:this._averageElevationLastSampledAt=b;const k=Math.abs(N-A);if(k>1){if(this._isInitialLoad||v)return this._averageElevation.jumpTo(A),h(A);this._averageElevation.easeTo(A,b,300)}else if(k>1e-4)return this._averageElevation.jumpTo(A),h(A)}return!!this._averageElevation.isEasing(b)&&h(this._averageElevation.getValue(b))}_authenticate(){ge(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,b=>{if(b&&(b.message===ze||b.status===401)){const c=this.painter.context.gl;St(c,!1),this._logoControl instanceof cl&&this._logoControl._updateLogo(),c&&c.clear(c.DEPTH_BUFFER_BIT|c.COLOR_BUFFER_BIT|c.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new s.z(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),qt(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_postStyleLoadEvent(){this.style.globalId&&tr(this._requestManager._customAccessToken,{map:this,style:this.style.globalId,importedStyles:this.style.getImportGlobalIds()})}_updateTerrain(){const b=this._isDragging();this.painter.updateTerrain(this.style,b)}_calculateSpeedIndex(){const b=this.painter.canvasCopy(),c=this.painter.getCanvasCopiesAndTimestamps();c.timeStamps.push(performance.now());const h=this.painter.context.gl,v=h.createFramebuffer();function N(A){h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,A,0);const k=new Uint8Array(h.drawingBufferWidth*h.drawingBufferHeight*4);return h.readPixels(0,0,h.drawingBufferWidth,h.drawingBufferHeight,h.RGBA,h.UNSIGNED_BYTE,k),k}return h.bindFramebuffer(h.FRAMEBUFFER,v),this._canvasPixelComparison(N(b),c.canvasCopies.map(N),c.timeStamps)}_canvasPixelComparison(b,c,h){let v=h[1]-h[0];const N=b.length/4;for(let A=0;A<c.length;A++){const k=c[A];let z=0;for(let q=0;q<k.length;q+=4)k[q]===b[q]&&k[q+1]===b[q+1]&&k[q+2]===b[q+2]&&k[q+3]===b[q+3]&&(z+=1);v+=(h[A+2]-h[A+1])*(1-z/N)}return v}remove(){this._hash&&this._hash.remove();for(const c of this._controls)c.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.indoor.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),window.removeEventListener("resize",this._onWindowResize,!1),window.removeEventListener("orientationchange",this._onWindowResize,!1),window.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.removeEventListener("online",this._onWindowOnline,!1),window.removeEventListener("visibilitychange",this._onVisibilityChange,!1);const b=this.painter.context.gl.getExtension("WEBGL_lose_context");b&&b.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),sr.delete(this.painter.context.gl),Dt.remove(),gt.remove(),this._removed=!0,this.fire(new s.A("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(b){this._renderNextFrame=this._renderNextFrame||b,this.style&&!this._frame&&(this._frame=s.q.frame(c=>{const h=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,h&&this._render(c)}))}_preloadTiles(b){const c=this.style?this.style.getSourceCaches():[];return s.bl(c,(h,v)=>h._preloadTiles(b,v),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(b){this._trackResize&&this.resize({originalEvent:b})._update()}_onVisibilityChange(){document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(b){this._showTileBoundaries!==b&&(this._showTileBoundaries=b,this._tp.refreshUI(),this._update())}get showParseStatus(){return!!this._showParseStatus}set showParseStatus(b){this._showParseStatus!==b&&(this._showParseStatus=b,this._tp.refreshUI(),this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(b){this._showTerrainWireframe!==b&&(this._showTerrainWireframe=b,this._tp.refreshUI(),this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(b){this._showLayers2DWireframe!==b&&(this._showLayers2DWireframe=b,this._tp.refreshUI(),this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(b){this._showLayers3DWireframe!==b&&(this._showLayers3DWireframe=b,this._tp.refreshUI(),this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(b){this._speedIndexTiming!==b&&(this._speedIndexTiming=b,this._update())}get showPadding(){return!!this._showPadding}set showPadding(b){this._showPadding!==b&&(this._showPadding=b,this._tp.refreshUI(),this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(b){this._showCollisionBoxes!==b&&(this._showCollisionBoxes=b,this._tp.refreshUI(),b?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(b){this._showOverdrawInspector!==b&&(this._showOverdrawInspector=b,this._tp.refreshUI(),this._update())}get repaint(){return!!this._repaint}set repaint(b){this._repaint!==b&&(this._repaint=b,this._tp.refreshUI(),this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(b){this._vertices=b,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(b){this._showTileAABBs!==b&&(this._showTileAABBs=b,this._tp.refreshUI(),b&&this._update())}_setCacheLimits(b,c){s.dJ(b,c)}get version(){return p}},NavigationControl:class{constructor(b={}){this.options=s.l({},g4,b),this._container=L("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",c=>c.preventDefault()),this.options.showZoom&&(s.aQ(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",c=>{this._map&&this._map.zoomIn({},{originalEvent:c})}),L("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",c=>{this._map&&this._map.zoomOut({},{originalEvent:c})}),L("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(s.aQ(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",c=>{const h=this._map;h&&(this.options.visualizePitch?h.resetNorthPitch({},{originalEvent:c}):h.resetNorth({},{originalEvent:c}))}),this._compassIcon=L("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const b=this._map;if(!b)return;const c=b.getZoom(),h=c===b.getMaxZoom(),v=c===b.getMinZoom();this._zoomInButton.disabled=h,this._zoomOutButton.disabled=v,this._zoomInButton.setAttribute("aria-disabled",h.toString()),this._zoomOutButton.setAttribute("aria-disabled",v.toString())}_rotateCompassArrow(){const b=this._map;if(!b)return;const c=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(b.transform.pitch*(Math.PI/180)),.5)}) rotateX(${b.transform.pitch}deg) rotateZ(${b.transform.angle*(180/Math.PI)}deg)`:`rotate(${b.transform.angle*(180/Math.PI)}deg)`;b._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=c)})}onAdd(b){return this._map=b,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),b.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&b.on("pitch",this._rotateCompassArrow),b.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new x4(b,this._compass,this.options.visualizePitch)),this._container}onRemove(){const b=this._map;b&&(this._container.remove(),this.options.showZoom&&b.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&b.off("pitch",this._rotateCompassArrow),b.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(b,c){const h=L("button",b,this._container);return h.type="button",h.addEventListener("click",c),h}_setButtonTitle(b,c){if(!this._map)return;const h=this._map._getUIString(`NavigationControl.${c}`);b.setAttribute("aria-label",h),b.firstElementChild&&b.firstElementChild.setAttribute("title",h)}},GeolocateControl:class extends s.E{constructor(b={}){super();const c=navigator.geolocation;this.options=s.l({geolocation:c},Lo,b),s.aQ(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=by(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(b){return this._map=b,this._container=L("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(b){const c=(h=!!this.options.geolocation)=>{this._supportsGeolocation=h,b(h)};this._supportsGeolocation!==void 0?b(this._supportsGeolocation):navigator.permissions!==void 0?navigator.permissions.query({name:"geolocation"}).then(h=>c(h.state!=="denied")).catch(()=>c()):c()}_isOutOfMapMaxBounds(b){const c=this._map.getMaxBounds(),h=b.coords;return!!c&&(h.longitude<c.getWest()||h.longitude>c.getEast()||h.latitude<c.getSouth()||h.latitude>c.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(b){if(this._map){if(this._isOutOfMapMaxBounds(b))return this._setErrorState(),this.fire(new s.A("outofmaxbounds",b)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=b,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(b),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(b),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new s.A("geolocate",b)),this._finish()}}_updateCamera(b){const c=new s.bO(b.coords.longitude,b.coords.latitude),h=b.coords.accuracy,v=this._map.getBearing(),N=s.l({bearing:v},this.options.fitBoundsOptions);this._map.fitBounds(c.toBounds(h),N,{geolocateSource:!0})}_updateMarker(b){if(b){const c=new s.bO(b.coords.longitude,b.coords.latitude);this._accuracyCircleMarker.setLngLat(c).addTo(this._map),this._userLocationDotMarker.setLngLat(c).addTo(this._map),this._accuracy=b.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const b=this._map.transform,c=s.bH(1,b._center.lat)*b.worldSize,h=Math.ceil(2*this._accuracy*c);this._circleElement.style.width=`${h}px`,this._circleElement.style.height=`${h}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(b){if(this._map){if(this.options.trackUserLocation)if(b.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const c=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",c),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",c),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(b.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new s.A("error",b)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(b){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",c=>c.preventDefault()),this._geolocateButton=L("button","mapboxgl-ctrl-geolocate",this._container),L("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",b===!1){s.w("Geolocation support is not available so the GeolocateControl will be disabled.");const c=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",c),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",c)}else{const c=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",c),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",c)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=L("div","mapboxgl-user-location"),this._dotElement.appendChild(L("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(L("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Pa({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=L("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Pa({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",c=>{c.geolocateSource||this._watchState!=="ACTIVE_LOCK"||c.originalEvent&&c.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new s.A("trackuserlocationend")))})}}_onDeviceOrientation(b){this._userLocationDotMarker&&(b.webkitCompassHeading?this._heading=b.webkitCompassHeading:b.absolute===!0&&(this._heading=-1*b.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return s.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new s.A("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new s.A("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new s.A("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let b;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(b={maximumAge:6e5,timeout:0},this._noTimeout=!0):(b=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,b),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=window.setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const b=()=>{"ondeviceorientationabsolute"in window?window.addEventListener("deviceorientationabsolute",this._onDeviceOrientation):window.addEventListener("deviceorientation",this._onDeviceOrientation)};typeof DeviceMotionEvent<"u"&&typeof DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(c=>{c==="granted"&&b()}).catch(console.error):b()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),window.removeEventListener("deviceorientation",this._onDeviceOrientation),window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:jy,ScaleControl:class{constructor(b={}){this.options=s.l({},ba,b),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),s.aQ(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const b=this.options.maxWidth||100,c=this._map,h=c._containerHeight/2,v=c._containerWidth/2-b/2,N=c.unproject([v,h]),A=c.unproject([v+b,h]),k=N.distanceTo(A);if(this.options.unit==="imperial"){const z=3.2808*k;z>5280?this._setScale(b,z/5280,"mile"):this._setScale(b,z,"foot")}else this.options.unit==="nautical"?this._setScale(b,k/1852,"nautical-mile"):k>=1e3?this._setScale(b,k/1e3,"kilometer"):this._setScale(b,k,"meter")}_setScale(b,c,h){this._map._requestDomTask(()=>{const v=function(A){const k=Math.pow(10,`${Math.floor(A)}`.length-1);let z=A/k;return z=z>=10?10:z>=5?5:z>=3?3:z>=2?2:z>=1?1:function(q){const K=Math.pow(10,Math.ceil(-Math.log(q)/Math.LN10));return Math.round(q*K)/K}(z),k*z}(c),N=v/c;this._container.innerHTML=this._isNumberFormatSupported&&h!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:h}).format(v):`${v}&nbsp;${nw[h]}`,this._container.style.width=b*N+"px"})}onAdd(b){return this._map=b,this._language=b.getLanguage(),this._container=L("div","mapboxgl-ctrl mapboxgl-ctrl-scale",b.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(b){this._language=b,this._update()}setUnit(b){this.options.unit=b,this._update()}},FullscreenControl:class{constructor(b={}){this._fullscreen=!1,b&&b.container&&(b.container instanceof HTMLElement?this._container=b.container:s.w("Full screen control 'container' must be a DOM element.")),s.aQ(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(b){return this._map=b,this._container||(this._container=this._map.getContainer()),this._controlContainer=L("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",s.w("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!document.fullscreenEnabled&&!document.webkitFullscreenEnabled)}_setupUI(){const b=this._fullscreenButton=L("button","mapboxgl-ctrl-fullscreen",this._controlContainer);L("span","mapboxgl-ctrl-icon",b).setAttribute("aria-hidden","true"),b.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const b=this._getTitle();this._fullscreenButton.setAttribute("aria-label",b),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",b)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(document.fullscreenElement||document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends s.E{constructor(b){super(),this.options=s.l(Object.create(ds),b),this._altitude=this.options.altitude,s.aQ(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(b&&b.className?b.className.trim().split(/\s+/):[])}addTo(b){return this._map&&this.remove(),this._map=b,this.options.closeOnClick&&b.on("preclick",this._onClose),this.options.closeOnMove&&b.on("move",this._onClose),b.on("remove",this.remove),this._update(),b._addPopup(this),this._focusFirstElement(),this._trackPointer?(b.on("mousemove",this._onMouseEvent),b.on("mouseup",this._onMouseEvent),b._canvasContainer.classList.add("mapboxgl-track-pointer")):b.on("move",this._update),this.fire(new s.A("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const b=this._map;return b&&(b.off("move",this._update),b.off("move",this._onClose),b.off("preclick",this._onClose),b.off("click",this._onClose),b.off("remove",this.remove),b.off("mousemove",this._onMouseEvent),b.off("mouseup",this._onMouseEvent),b.off("drag",this._onMouseEvent),b._canvasContainer&&b._canvasContainer.classList.remove("mapboxgl-track-pointer"),b._removePopup(this),this._map=void 0),this.fire(new s.A("close")),this}getLngLat(){return this._lngLat}setLngLat(b){this._lngLat=s.bO.convert(b),this._pos=null,this._trackPointer=!1,this._update();const c=this._map;return c&&(c.on("move",this._update),c.off("mousemove",this._onMouseEvent),c._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}getAltitude(){return this._altitude}setAltitude(b){return this._altitude=b,this._update(),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const b=this._map;return b&&(b.off("move",this._update),b.on("mousemove",this._onMouseEvent),b.on("drag",this._onMouseEvent),b._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(b){return this.setDOMContent(document.createTextNode(b))}setHTML(b){const c=document.createDocumentFragment(),h=document.createElement("body");let v;for(h.innerHTML=b;v=h.firstChild,v;)c.appendChild(v);return this.setDOMContent(c)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(b){return this.options.maxWidth=b,this._update(),this}setDOMContent(b){let c=this._content;if(c)for(;c.hasChildNodes();)c.firstChild&&c.removeChild(c.firstChild);else c=this._content=L("div","mapboxgl-popup-content",this._container||void 0);if(c.appendChild(b),this.options.closeButton){const h=this._closeButton=L("button","mapboxgl-popup-close-button",c);h.type="button",h.setAttribute("aria-label","Close popup"),h.innerHTML='<span aria-hidden="true">&#215;</span>',h.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(b){return this._classList.add(b),this._updateClassList(),this}removeClassName(b){return this._classList.delete(b),this._updateClassList(),this}setOffset(b){return this.options.offset=b,this._update(),this}toggleClassName(b){let c;return this._classList.delete(b)?c=!1:(this._classList.add(b),c=!0),this._updateClassList(),c}_onMouseEvent(b){this._update(b.point)}_getAnchor(b){if(this.options.anchor)return this.options.anchor;const c=this._map,h=this._container,v=this._pos;if(!c||!h||!v)return"bottom";const N=h.offsetWidth,A=h.offsetHeight,k=v.x<N/2,z=v.x>c.transform.width-N/2;if(v.y+b<A)return k?"top-left":z?"top-right":"top";if(v.y>c.transform.height-A){if(k)return"bottom-left";if(z)return"bottom-right"}return k?"left":z?"right":"bottom"}_updateClassList(){const b=this._container;if(!b)return;const c=[...this._classList];c.push("mapboxgl-popup"),this._anchor&&c.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&c.push("mapboxgl-popup-track-pointer"),b.className=c.join(" ")}_update(b){const c=this._map,h=this._content;if(!c||!this._lngLat&&!this._trackPointer||!h)return;let v=this._container;if(v||(v=this._container=L("div","mapboxgl-popup",c.getContainer()),this._tip=L("div","mapboxgl-popup-tip",v),v.appendChild(h)),this.options.maxWidth&&v.style.maxWidth!==this.options.maxWidth&&(v.style.maxWidth=this.options.maxWidth),c.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Ny(this._lngLat,this._pos,c.transform)),!this._trackPointer||b){const N=this._pos=this._trackPointer&&b instanceof s.P?b:c.project(this._lngLat,this._altitude),A=qd(this.options.offset),k=this._anchor=this._getAnchor(A.y),z=qd(this.options.offset,k),q=N.add(z).round();c._requestDomTask(()=>{this._container&&k&&(this._container.style.transform=`${eu[k]} translate(${q.x}px,${q.y}px)`)})}if(!this._marker&&c._showingGlobe()){const N=s.dK(c.transform,this._lngLat)?0:1;this._setOpacity(N)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const b=this._container.querySelector(_C);b&&b.focus()}_onClose(){this.remove()}_setOpacity(b){this._container&&(this._container.style.opacity=`${b}`),this._content&&(this._content.style.pointerEvents=b?"auto":"none")}},Marker:Pa,Style:dc,LngLat:s.bO,LngLatBounds:s.aB,Point:s.P,MercatorCoordinate:s.ac,FreeCameraOptions:Q_,Evented:s.E,config:s.e,prewarm:s.dP,clearPrewarmedResources:s.dQ,get accessToken(){return s.e.ACCESS_TOKEN},set accessToken(b){s.e.ACCESS_TOKEN=b},get baseApiUrl(){return s.e.API_URL},set baseApiUrl(b){s.e.API_URL=b},get workerCount(){return s.dR.workerCount},set workerCount(b){s.dR.workerCount=b},get maxParallelImageRequests(){return s.e.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(b){s.e.MAX_PARALLEL_IMAGE_REQUESTS=b},clearStorage(b){s.dS(b)},get workerUrl(){return s.dT.workerUrl},set workerUrl(b){s.dT.workerUrl=b},get workerClass(){return s.dT.workerClass},set workerClass(b){s.dT.workerClass=b},get workerParams(){return s.dT.workerParams},set workerParams(b){s.dT.workerParams=b},get dracoUrl(){return s.dU()},set dracoUrl(b){s.dV(b)},get meshoptUrl(){return s.dW()},set meshoptUrl(b){s.dX(b)},setNow:s.q.setNow,restoreNow:s.q.restoreNow}});var d=a;return d})})(Xhe);var umt=Xhe.exports;const av=Vi(umt),dmt=[106.8456,-6.2088],hmt=[[106.6,-6.4],[107,-6]],CY="pk.enter-your-mapbox-token-here",mmt=({model:e,viewType:t})=>{const r=U.useRef(null),i=U.useRef(null),[a,l]=U.useState("streets"),[d,s]=U.useState("sites"),[p,x]=U.useState(CY),[w,j]=U.useState(CY==="pk.enter-your-mapbox-token-here"),S=P=>{const F=[{lng:106.8225,lat:-6.1751,type:"macro",status:"active",congestion:.2},{lng:106.8425,lat:-6.2051,type:"micro",status:"active",congestion:.8},{lng:106.7825,lat:-6.1851,type:"macro",status:"inactive",congestion:0},{lng:106.8625,lat:-6.2251,type:"small",status:"active",congestion:.5},{lng:106.8025,lat:-6.1651,type:"macro",status:"active",congestion:.3},{lng:106.8825,lat:-6.2451,type:"micro",status:"active",congestion:.7},{lng:106.8125,lat:-6.1951,type:"small",status:"active",congestion:.4},{lng:106.9025,lat:-6.2651,type:"macro",status:"active",congestion:.6},{lng:106.7625,lat:-6.2151,type:"micro",status:"inactive",congestion:0},{lng:106.8325,lat:-6.2351,type:"small",status:"active",congestion:.9},{lng:106.8277,lat:-6.1792,type:"macro",status:"active",congestion:.3},{lng:106.8477,lat:-6.2092,type:"micro",status:"active",congestion:.5},{lng:106.7877,lat:-6.1892,type:"macro",status:"active",congestion:.2},{lng:106.8677,lat:-6.2292,type:"small",status:"active",congestion:.6},{lng:106.8077,lat:-6.1692,type:"macro",status:"active",congestion:.4},{lng:106.8877,lat:-6.2492,type:"micro",status:"inactive",congestion:0},{lng:106.8177,lat:-6.1992,type:"small",status:"active",congestion:.7},{lng:106.9077,lat:-6.2692,type:"macro",status:"active",congestion:.8},{lng:106.7677,lat:-6.2192,type:"micro",status:"active",congestion:.3},{lng:106.8377,lat:-6.2392,type:"small",status:"active",congestion:.5}];P.getSource("cell-sites")||P.addSource("cell-sites",{type:"geojson",data:{type:"FeatureCollection",features:F.map(L=>({type:"Feature",geometry:{type:"Point",coordinates:[L.lng,L.lat]},properties:{type:L.type,status:L.status,congestion:L.congestion}}))}}),P.getLayer("cell-sites-layer")||P.addLayer({id:"cell-sites-layer",type:"circle",source:"cell-sites",paint:{"circle-radius":["case",["==",["get","type"],"macro"],8,["==",["get","type"],"micro"],6,4],"circle-color":["case",["==",["get","status"],"inactive"],"#8E9196",[">",["get","congestion"],.7],"#ea384c",[">",["get","congestion"],.4],"#F97316","#9b87f5"],"circle-stroke-width":1,"circle-stroke-color":"#ffffff"}}),P.getLayer("cell-sites-heat")||P.addLayer({id:"cell-sites-heat",type:"heatmap",source:"cell-sites",layout:{visibility:"none"},paint:{"heatmap-weight":["interpolate",["linear"],["get","congestion"],0,0,1,1],"heatmap-intensity":1,"heatmap-color":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.2,"rgb(0, 255, 255)",.4,"rgb(0, 255, 0)",.6,"rgb(255, 255, 0)",.8,"rgb(255, 0, 0)"],"heatmap-radius":30,"heatmap-opacity":.8}}),P.on("click","cell-sites-layer",L=>{if(!L.features||L.features.length===0)return;const B=L.features[0],V=B.properties;if(!V)return;const $=B.geometry.coordinates.slice(),G=document.createElement("div");G.className="bg-beam-dark-accent text-white p-2 rounded-md text-xs",G.innerHTML=`
        <div class="font-bold border-b border-gray-700 pb-1 mb-1">Cell Site Details</div>
        <div>Type: ${V.type.charAt(0).toUpperCase()+V.type.slice(1)}</div>
        <div>Status: ${V.status.charAt(0).toUpperCase()+V.status.slice(1)}</div>
        <div>Congestion: ${Math.round(V.congestion*100)}%</div>
      `,new av.Popup({closeButton:!0,className:"custom-popup"}).setLngLat($).setDOMContent(G).addTo(P)}),P.on("mouseenter","cell-sites-layer",()=>{P.getCanvas().style.cursor="pointer"}),P.on("mouseleave","cell-sites-layer",()=>{P.getCanvas().style.cursor=""})};return U.useEffect(()=>{if(!(!r.current||i.current||!p||p==="pk.enter-your-mapbox-token-here")){try{av.accessToken=p,i.current=new av.Map({container:r.current,style:"mapbox://styles/mapbox/streets-v11",center:dmt,zoom:11,bounds:hmt,minZoom:9,maxZoom:17}),i.current.on("load",()=>{i.current&&S(i.current)}),i.current.addControl(new av.NavigationControl,"top-right"),i.current.addControl(new av.FullscreenControl,"top-right"),i.current.addControl(new av.GeolocateControl({positionOptions:{enableHighAccuracy:!0},trackUserLocation:!0}),"top-right")}catch(P){console.error("Error initializing map:",P)}return()=>{i.current&&(i.current.remove(),i.current=null)}}},[p]),U.useEffect(()=>{if(!i.current)return;const P=a==="streets"?"mapbox://styles/mapbox/streets-v11":"mapbox://styles/mapbox/satellite-streets-v11";i.current.setStyle(P),i.current.once("style.load",()=>{i.current&&(S(i.current),i.current.getLayer("cell-sites-layer")&&i.current.getLayer("cell-sites-heat")&&(i.current.setLayoutProperty("cell-sites-layer","visibility",d==="sites"?"visible":"none"),i.current.setLayoutProperty("cell-sites-heat","visibility",d==="heatmap"?"visible":"none")))})},[a]),U.useEffect(()=>{i.current&&i.current.getLayer("cell-sites-layer")&&i.current.getLayer("cell-sites-heat")&&(i.current.setLayoutProperty("cell-sites-layer","visibility",d==="sites"?"visible":"none"),i.current.setLayoutProperty("cell-sites-heat","visibility",d==="heatmap"?"visible":"none"))},[d]),U.useEffect(()=>{if(!i.current||!i.current.getSource("cell-sites"))return;console.log(`Model changed to: ${e}`);const F={churn:"#9b87f5",propensity:"#8B5CF6",arpu:"#0EA5E9",apra:"#D946EF"}[e]||"#9b87f5";i.current.getLayer("cell-sites-layer")&&i.current.setPaintProperty("cell-sites-layer","circle-color",["case",["==",["get","status"],"inactive"],"#8E9196",[">",["get","congestion"],.7],"#ea384c",[">",["get","congestion"],.4],"#F97316",F])},[e]),n.jsxs("div",{className:"w-full h-full flex flex-col",children:[w&&n.jsxs("div",{className:"p-3 bg-beam-dark-accent/50 border border-gray-700/50 rounded-lg mb-3",children:[n.jsxs("div",{className:"text-amber-400 text-xs mb-2",children:["Please enter your Mapbox API token to enable the map functionality. You can get one for free at ",n.jsx("a",{href:"https://mapbox.com",target:"_blank",rel:"noopener noreferrer",className:"underline",children:"mapbox.com"})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("input",{type:"text",value:p,onChange:P=>x(P.target.value),placeholder:"Enter your Mapbox token",className:"flex-1 p-2 text-sm rounded bg-beam-dark-accent border border-gray-700 text-white"}),n.jsx(lt,{size:"sm",variant:"default",className:"bg-ptt-blue hover:bg-blue-600 text-white",onClick:()=>j(!1),children:"Save"})]})]}),n.jsxs("div",{className:"absolute top-4 left-4 z-10 flex flex-col gap-2",children:[n.jsxs(lt,{size:"sm",variant:a==="streets"?"default":"outline",className:`flex items-center gap-2 ${a==="streets"?"bg-ptt-blue text-white":"bg-beam-dark-accent/80 text-white"}`,onClick:()=>l("streets"),children:[n.jsx(ex,{className:"h-4 w-4"}),n.jsx("span",{children:"Street"})]}),n.jsxs(lt,{size:"sm",variant:a==="satellite"?"default":"outline",className:`flex items-center gap-2 ${a==="satellite"?"bg-ptt-blue text-white":"bg-beam-dark-accent/80 text-white"}`,onClick:()=>l("satellite"),children:[n.jsx(Cve,{className:"h-4 w-4"}),n.jsx("span",{children:"Satellite"})]})]}),n.jsxs("div",{className:"absolute top-4 right-4 z-10 flex flex-col gap-2",children:[n.jsxs(lt,{size:"sm",variant:d==="sites"?"default":"outline",className:`flex items-center gap-2 ${d==="sites"?"bg-ptt-blue text-white":"bg-beam-dark-accent/80 text-white"}`,onClick:()=>s("sites"),children:[n.jsx(ex,{className:"h-4 w-4"}),n.jsx("span",{children:"Sites"})]}),n.jsxs(lt,{size:"sm",variant:d==="heatmap"?"default":"outline",className:`flex items-center gap-2 ${d==="heatmap"?"bg-ptt-blue text-white":"bg-beam-dark-accent/80 text-white"}`,onClick:()=>s("heatmap"),children:[n.jsx(to,{className:"h-4 w-4"}),n.jsx("span",{children:"Heatmap"})]})]}),n.jsx("div",{ref:r,className:"flex-1 rounded-lg overflow-hidden",style:{height:"100%",minHeight:"450px"}}),n.jsxs("div",{className:"absolute bottom-4 left-4 z-10 bg-beam-dark-accent/80 p-2 rounded border border-gray-700/50 text-white text-xs",children:[n.jsx("div",{className:"font-bold mb-1",children:"Legend"}),n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx("div",{className:"h-3 w-3 rounded-full bg-9b87f5"}),n.jsx("span",{children:"Low Congestion"})]}),n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx("div",{className:"h-3 w-3 rounded-full bg-F97316"}),n.jsx("span",{children:"Medium Congestion"})]}),n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx("div",{className:"h-3 w-3 rounded-full bg-ea384c"}),n.jsx("span",{children:"High Congestion"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"h-3 w-3 rounded-full bg-8E9196"}),n.jsx("span",{children:"Inactive"})]})]})]})},fmt=({cellSites:e,onSiteClick:t,onAnalysisClick:r})=>{const[i,a]=U.useState("physical"),[l,d]=U.useState("all"),[s,p]=U.useState("churn"),[x,w]=U.useState("all"),j=e.filter(Z=>x!=="all"?Z.district===x:l!=="all"?Z.region===l:!0),S=Z=>({churn:"Customer Churn Risk",propensity:"Service Propensity",arpu:"Revenue (ARPU)",apra:"Usage Pattern Analysis"})[Z]||Z,P=()=>{const Z=j.reduce((se,ae)=>(se[ae.type]=(se[ae.type]||0)+1,se),{});return{macro:Z.macro||0,micro:Z.micro||0,small:Z.small||0,femto:Z.femto||0,total:j.length}},F=()=>{const Z=j.reduce((se,ae)=>(se[ae.status]=(se[ae.status]||0)+1,se),{});return{active:Z.active||0,inactive:Z.inactive||0,maintenance:Z.maintenance||0}},L=()=>{const Z=j.filter(ce=>ce.congestion>.8).length,se=j.filter(ce=>ce.congestion>.5&&ce.congestion<=.8).length,ae=j.filter(ce=>ce.congestion<=.5).length;return{high:Z,medium:se,low:ae}},B=Z=>{t==null||t(Z.id,Z)},V=Z=>{const se={sites:j,region:l,district:x,model:s};r==null||r(Z,se)},$=P(),G=F(),W=L();return n.jsxs("div",{className:"space-y-6",children:[n.jsx(jt,{className:"p-4 bg-beam-dark-accent/50 border-gray-700 rounded-lg",children:n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"text-sm text-gray-300 mb-2 block",children:"View Type"}),n.jsxs(_n,{value:i,onValueChange:a,children:[n.jsx(xn,{className:"bg-beam-dark-accent/50 border-gray-700",children:n.jsx(wn,{})}),n.jsxs(yn,{className:"bg-beam-dark border-gray-700",children:[n.jsx(yt,{value:"physical",children:"Physical Network"}),n.jsx(yt,{value:"district",children:"District View"}),n.jsx(yt,{value:"state",children:"State View"}),n.jsx(yt,{value:"capacity",children:"Capacity Heatmap"})]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm text-gray-300 mb-2 block",children:"Business Model"}),n.jsxs(_n,{value:s,onValueChange:p,children:[n.jsx(xn,{className:"bg-beam-dark-accent/50 border-gray-700",children:n.jsx(wn,{})}),n.jsxs(yn,{className:"bg-beam-dark border-gray-700",children:[n.jsx(yt,{value:"churn",children:"Churn Model"}),n.jsx(yt,{value:"propensity",children:"Propensity Model"}),n.jsx(yt,{value:"arpu",children:"ARPU Model"}),n.jsx(yt,{value:"apra",children:"APRA Model"})]})]})]}),i==="district"&&n.jsxs("div",{children:[n.jsx("label",{className:"text-sm text-gray-300 mb-2 block",children:"District"}),n.jsxs(_n,{value:x,onValueChange:w,children:[n.jsx(xn,{className:"bg-beam-dark-accent/50 border-gray-700",children:n.jsx(wn,{})}),n.jsxs(yn,{className:"bg-beam-dark border-gray-700",children:[n.jsx(yt,{value:"all",children:"All Districts"}),n.jsx(yt,{value:"Central Jakarta",children:"Central Jakarta"}),n.jsx(yt,{value:"South Jakarta",children:"South Jakarta"}),n.jsx(yt,{value:"North Jakarta",children:"North Jakarta"}),n.jsx(yt,{value:"East Jakarta",children:"East Jakarta"}),n.jsx(yt,{value:"West Jakarta",children:"West Jakarta"})]})]})]}),i==="state"&&n.jsxs("div",{children:[n.jsx("label",{className:"text-sm text-gray-300 mb-2 block",children:"State"}),n.jsxs(_n,{value:l,onValueChange:d,children:[n.jsx(xn,{className:"bg-beam-dark-accent/50 border-gray-700",children:n.jsx(wn,{})}),n.jsxs(yn,{className:"bg-beam-dark border-gray-700",children:[n.jsx(yt,{value:"all",children:"All Regions"}),n.jsx(yt,{value:"Jakarta",children:"Jakarta"}),n.jsx(yt,{value:"West Java",children:"West Java"}),n.jsx(yt,{value:"Central Java",children:"Central Java"}),n.jsx(yt,{value:"East Java",children:"East Java"})]})]})]}),n.jsx("div",{className:"flex items-end",children:n.jsxs(lt,{onClick:()=>V("network-performance"),className:"w-full bg-ptt-blue hover:bg-blue-700",children:[n.jsx(mh,{className:"mr-2 h-4 w-4"}),"Analyze View"]})})]})}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[n.jsx(jt,{className:"p-4 bg-beam-dark-accent/50 border-gray-700 cursor-pointer hover:border-ptt-blue/50 transition-colors",onClick:()=>V("site-types"),children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(ga,{className:"h-8 w-8 text-ptt-blue"}),n.jsxs("div",{children:[n.jsx("div",{className:"text-sm text-gray-400",children:"Total Sites"}),n.jsx("div",{className:"text-2xl font-bold text-white",children:$.total}),n.jsxs("div",{className:"text-xs text-gray-500",children:[$.macro," Macro • ",$.micro," Micro • ",$.small," Small"]})]})]})}),n.jsx(jt,{className:"p-4 bg-beam-dark-accent/50 border-gray-700 cursor-pointer hover:border-green-500/50 transition-colors",onClick:()=>V("site-status"),children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(ro,{className:"h-8 w-8 text-green-500"}),n.jsxs("div",{children:[n.jsx("div",{className:"text-sm text-gray-400",children:"Active Sites"}),n.jsx("div",{className:"text-2xl font-bold text-white",children:G.active}),n.jsxs("div",{className:"text-xs text-gray-500",children:[G.maintenance," in maintenance"]})]})]})}),n.jsx(jt,{className:"p-4 bg-beam-dark-accent/50 border-gray-700 cursor-pointer hover:border-yellow-500/50 transition-colors",onClick:()=>V("congestion-analysis"),children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(fs,{className:"h-8 w-8 text-yellow-500"}),n.jsxs("div",{children:[n.jsx("div",{className:"text-sm text-gray-400",children:"High Congestion"}),n.jsx("div",{className:"text-2xl font-bold text-white",children:W.high}),n.jsxs("div",{className:"text-xs text-gray-500",children:[W.medium," medium risk"]})]})]})}),n.jsx(jt,{className:"p-4 bg-beam-dark-accent/50 border-gray-700 cursor-pointer hover:border-ptt-blue/50 transition-colors",onClick:()=>V("revenue-analysis"),children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(En,{className:"h-8 w-8 text-ptt-blue"}),n.jsxs("div",{children:[n.jsx("div",{className:"text-sm text-gray-400",children:"Avg Performance"}),n.jsxs("div",{className:"text-2xl font-bold text-white",children:[Math.round(j.reduce((Z,se)=>Z+se.performanceScore,0)/j.length),"%"]}),n.jsx("div",{className:"text-xs text-gray-500",children:S(s)})]})]})})]}),n.jsxs(jt,{className:"p-4 bg-beam-dark-accent/50 border-gray-700 rounded-lg",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-lg font-medium text-white",children:"Quick Site Access"}),n.jsxs(Tt,{variant:"outline",className:"text-xs",children:[j.length," sites in view"]})]}),n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 max-h-48 overflow-y-auto",children:j.slice(0,6).map(Z=>n.jsxs("div",{onClick:()=>B(Z),className:"bg-beam-dark-accent/30 p-3 rounded-lg border border-gray-700/50 hover:border-ptt-blue/50 cursor-pointer transition-colors",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("div",{className:"text-sm font-medium text-white",children:Z.id}),n.jsx(Tt,{className:`text-xs ${Z.status==="active"?"bg-green-500/20 text-green-400":Z.status==="maintenance"?"bg-yellow-500/20 text-yellow-400":"bg-red-500/20 text-red-400"}`,children:Z.status})]}),n.jsx("div",{className:"text-xs text-gray-400 mb-1",children:Z.name}),n.jsxs("div",{className:"flex items-center justify-between text-xs",children:[n.jsx("span",{className:"text-gray-500",children:Z.type.toUpperCase()}),n.jsxs("span",{className:`font-medium ${Z.congestion>.8?"text-red-400":Z.congestion>.5?"text-yellow-400":"text-green-400"}`,children:[Math.round(Z.congestion*100),"%"]})]})]},Z.id))}),j.length>6&&n.jsx("div",{className:"mt-3 text-center",children:n.jsxs(lt,{variant:"outline",size:"sm",onClick:()=>V("all-sites"),className:"border-gray-600 text-white hover:bg-gray-700",children:["View All ",j.length," Sites"]})})]}),n.jsxs(jt,{className:"p-6 bg-beam-dark-accent/50 border-gray-700 rounded-lg",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-lg font-medium text-white",children:"Network Visualization"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Tt,{variant:"outline",className:"text-xs",children:S(s)}),n.jsx(Tt,{variant:"outline",className:"text-xs",children:i==="physical"?"Physical View":i==="district"?`District: ${x}`:i==="state"?`State: ${l}`:"Capacity Heatmap"})]})]}),n.jsx("div",{className:"h-[500px]",children:i==="capacity"?n.jsx(mmt,{model:s,viewType:i}):n.jsx(cmt,{viewType:i,region:l,model:s,district:x})})]})]})},pmt=()=>{const[e,t]=U.useState("customer-network"),[r,i]=U.useState("6m"),a=[{month:"Jan",NetworkQuality:85,ChurnRate:2.1},{month:"Feb",NetworkQuality:82,ChurnRate:2.3},{month:"Mar",NetworkQuality:78,ChurnRate:2.8},{month:"Apr",NetworkQuality:75,ChurnRate:3.2},{month:"May",NetworkQuality:72,ChurnRate:3.5},{month:"Jun",NetworkQuality:70,ChurnRate:3.8},{month:"Jul",NetworkQuality:73,ChurnRate:3.6},{month:"Aug",NetworkQuality:76,ChurnRate:3.3},{month:"Sep",NetworkQuality:79,ChurnRate:2.9},{month:"Oct",NetworkQuality:81,ChurnRate:2.5},{month:"Nov",NetworkQuality:83,ChurnRate:2.3},{month:"Dec",NetworkQuality:84,ChurnRate:2.2}],l=[{congestion:10,revenue:95,name:"Low"},{congestion:20,revenue:90,name:"Low-Med"},{congestion:30,revenue:85,name:"Medium"},{congestion:40,revenue:80,name:"Med"},{congestion:50,revenue:75,name:"Med-High"},{congestion:60,revenue:65,name:"High"},{congestion:70,revenue:55,name:"High"},{congestion:80,revenue:40,name:"Very High"},{congestion:90,revenue:30,name:"Critical"}],d=[{month:"Jan","4G":55,"5G":10,Fiber:35},{month:"Feb","4G":53,"5G":12,Fiber:35},{month:"Mar","4G":51,"5G":14,Fiber:35},{month:"Apr","4G":49,"5G":16,Fiber:35},{month:"May","4G":47,"5G":18,Fiber:35},{month:"Jun","4G":45,"5G":20,Fiber:35},{month:"Jul","4G":43,"5G":22,Fiber:35},{month:"Aug","4G":41,"5G":24,Fiber:35},{month:"Sep","4G":39,"5G":26,Fiber:35},{month:"Oct","4G":37,"5G":28,Fiber:35},{month:"Nov","4G":35,"5G":30,Fiber:35},{month:"Dec","4G":33,"5G":32,Fiber:35}];return n.jsx("div",{className:"glass-panel backdrop-blur-md bg-beam-dark-accent/30 border border-gray-700/50 rounded-xl p-6 shadow-lg",children:n.jsxs("div",{className:"flex flex-col gap-6",children:[n.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[n.jsx("h2",{className:"text-xl font-bold text-white",children:"Cross-Dimensional Analysis"}),n.jsxs("div",{className:"flex flex-wrap gap-3",children:[n.jsx("div",{className:"flex items-center gap-2",children:n.jsxs(_n,{value:e,onValueChange:t,children:[n.jsx(xn,{className:"w-[220px] bg-beam-dark-accent/50 border-gray-700",children:n.jsx(wn,{placeholder:"Analysis Type"})}),n.jsxs(yn,{className:"bg-beam-dark border-gray-700",children:[n.jsx(yt,{value:"customer-network",children:"Customer & Network"}),n.jsx(yt,{value:"revenue-congestion",children:"Revenue & Congestion"}),n.jsx(yt,{value:"service-adoption",children:"Service Adoption Trends"})]})]})}),n.jsx("div",{className:"flex items-center gap-2",children:n.jsxs(_n,{value:r,onValueChange:i,children:[n.jsx(xn,{className:"w-[120px] bg-beam-dark-accent/50 border-gray-700",children:n.jsx(wn,{placeholder:"Timeframe"})}),n.jsxs(yn,{className:"bg-beam-dark border-gray-700",children:[n.jsx(yt,{value:"3m",children:"3 Months"}),n.jsx(yt,{value:"6m",children:"6 Months"}),n.jsx(yt,{value:"1y",children:"1 Year"}),n.jsx(yt,{value:"2y",children:"2 Years"})]})]})})]})]}),e==="customer-network"&&n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[n.jsxs("div",{className:"col-span-3 bg-beam-dark-accent/50 border-gray-700 rounded-lg p-4",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[n.jsx(qi,{className:"h-5 w-5 text-ptt-blue"}),n.jsx("h3",{className:"text-lg font-medium text-white",children:"Customer Churn vs. Network Quality"})]}),n.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"Analysis of correlation between network performance metrics and customer retention rates"}),n.jsx("div",{className:"h-[350px]",children:n.jsx(ms,{width:"100%",height:"100%",children:n.jsxs(LM,{data:a,margin:{top:5,right:30,left:20,bottom:5},children:[n.jsx($s,{strokeDasharray:"3 3",stroke:"#333"}),n.jsx(is,{dataKey:"month",stroke:"#666"}),n.jsx(Gi,{yAxisId:"left",stroke:"#e61e2b"}),n.jsx(Gi,{yAxisId:"right",orientation:"right",stroke:"#999"}),n.jsx(yi,{contentStyle:{backgroundColor:"#1a0604",borderColor:"#333",color:"#fff"}}),n.jsx(xa,{}),n.jsx(jl,{yAxisId:"left",type:"monotone",dataKey:"NetworkQuality",stroke:"#e61e2b",name:"Network Quality (%)"}),n.jsx(jl,{yAxisId:"right",type:"monotone",dataKey:"ChurnRate",stroke:"#999",name:"Churn Rate (%)"})]})})})]}),n.jsx("div",{className:"col-span-3 bg-beam-dark-accent/50 border-gray-700 rounded-lg p-4",children:n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[n.jsxs("div",{className:"bg-beam-dark-accent/30 p-4 rounded-lg border border-gray-700/50",children:[n.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"Correlation Coefficient"}),n.jsx("div",{className:"text-2xl font-bold text-white",children:"-0.89"}),n.jsx("div",{className:"text-xs text-gray-400",children:"Strong negative correlation"})]}),n.jsxs("div",{className:"bg-beam-dark-accent/30 p-4 rounded-lg border border-gray-700/50",children:[n.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"Network Quality Threshold"}),n.jsx("div",{className:"text-2xl font-bold text-white",children:"78%"}),n.jsx("div",{className:"text-xs text-gray-400",children:"Minimum acceptable quality"})]}),n.jsxs("div",{className:"bg-beam-dark-accent/30 p-4 rounded-lg border border-gray-700/50",children:[n.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"Churn Impact"}),n.jsx("div",{className:"text-2xl font-bold text-white",children:"$2.1M"}),n.jsx("div",{className:"text-xs text-gray-400",children:"Monthly revenue at risk"})]})]})})]}),e==="revenue-congestion"&&n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[n.jsxs("div",{className:"col-span-3 bg-beam-dark-accent/50 border-gray-700 rounded-lg p-4",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[n.jsx(En,{className:"h-5 w-5 text-ptt-blue"}),n.jsx("h3",{className:"text-lg font-medium text-white",children:"Network Congestion vs. Revenue Impact"})]}),n.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"Analysis of how network congestion levels affect service revenue across regions"}),n.jsx("div",{className:"h-[350px]",children:n.jsx(ms,{width:"100%",height:"100%",children:n.jsxs(nWe,{margin:{top:20,right:20,bottom:20,left:20},children:[n.jsx($s,{strokeDasharray:"3 3",stroke:"#333"}),n.jsx(is,{type:"number",dataKey:"congestion",name:"Congestion (%)",stroke:"#666"}),n.jsx(Gi,{type:"number",dataKey:"revenue",name:"Revenue (%)",stroke:"#666"}),n.jsx(lS,{type:"category",dataKey:"name"}),n.jsx(yi,{cursor:{strokeDasharray:"3 3"},contentStyle:{backgroundColor:"#1a0604",borderColor:"#333",color:"#fff"}}),n.jsx(cS,{name:"Revenue-Congestion Correlation",data:l,fill:"#e61e2b"})]})})})]}),n.jsx("div",{className:"col-span-3 bg-beam-dark-accent/50 border-gray-700 rounded-lg p-4",children:n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[n.jsxs("div",{className:"bg-beam-dark-accent/30 p-4 rounded-lg border border-gray-700/50",children:[n.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"Revenue Loss Rate"}),n.jsx("div",{className:"text-2xl font-bold text-white",children:"1.2%"}),n.jsx("div",{className:"text-xs text-gray-400",children:"Per 10% congestion increase"})]}),n.jsxs("div",{className:"bg-beam-dark-accent/30 p-4 rounded-lg border border-gray-700/50",children:[n.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"Critical Congestion Point"}),n.jsx("div",{className:"text-2xl font-bold text-white",children:"65%"}),n.jsx("div",{className:"text-xs text-gray-400",children:"Significant revenue impact"})]}),n.jsxs("div",{className:"bg-beam-dark-accent/30 p-4 rounded-lg border border-gray-700/50",children:[n.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"Most Affected Region"}),n.jsx("div",{className:"text-2xl font-bold text-white",children:"Central"}),n.jsx("div",{className:"text-xs text-gray-400",children:"Business district area"})]})]})})]}),e==="service-adoption"&&n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[n.jsxs("div",{className:"col-span-3 bg-beam-dark-accent/50 border-gray-700 rounded-lg p-4",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[n.jsx(IQ,{className:"h-5 w-5 text-ptt-blue"}),n.jsx("h3",{className:"text-lg font-medium text-white",children:"Technology Adoption Trends"})]}),n.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"Analysis of service adoption patterns and technology migration"}),n.jsx("div",{className:"h-[350px]",children:n.jsx(ms,{width:"100%",height:"100%",children:n.jsxs(uS,{data:d,margin:{top:10,right:30,left:0,bottom:0},children:[n.jsxs("defs",{children:[n.jsxs("linearGradient",{id:"color4G",x1:"0",y1:"0",x2:"0",y2:"1",children:[n.jsx("stop",{offset:"5%",stopColor:"#999",stopOpacity:.8}),n.jsx("stop",{offset:"95%",stopColor:"#999",stopOpacity:.1})]}),n.jsxs("linearGradient",{id:"color5G",x1:"0",y1:"0",x2:"0",y2:"1",children:[n.jsx("stop",{offset:"5%",stopColor:"#e61e2b",stopOpacity:.8}),n.jsx("stop",{offset:"95%",stopColor:"#e61e2b",stopOpacity:.1})]}),n.jsxs("linearGradient",{id:"colorFiber",x1:"0",y1:"0",x2:"0",y2:"1",children:[n.jsx("stop",{offset:"5%",stopColor:"#f15761",stopOpacity:.8}),n.jsx("stop",{offset:"95%",stopColor:"#f15761",stopOpacity:.1})]})]}),n.jsx($s,{strokeDasharray:"3 3",stroke:"#333"}),n.jsx(is,{dataKey:"month",stroke:"#666"}),n.jsx(Gi,{stroke:"#666"}),n.jsx(yi,{contentStyle:{backgroundColor:"#1a0604",borderColor:"#333",color:"#fff"}}),n.jsx(xa,{}),n.jsx(Zo,{type:"monotone",dataKey:"4G",stackId:"1",stroke:"#999",fillOpacity:1,fill:"url(#color4G)"}),n.jsx(Zo,{type:"monotone",dataKey:"5G",stackId:"1",stroke:"#e61e2b",fillOpacity:1,fill:"url(#color5G)"}),n.jsx(Zo,{type:"monotone",dataKey:"Fiber",stackId:"1",stroke:"#f15761",fillOpacity:1,fill:"url(#colorFiber)"})]})})})]}),n.jsx("div",{className:"col-span-3 bg-beam-dark-accent/50 border-gray-700 rounded-lg p-4",children:n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[n.jsxs("div",{className:"bg-beam-dark-accent/30 p-4 rounded-lg border border-gray-700/50",children:[n.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"5G Growth Rate"}),n.jsx("div",{className:"text-2xl font-bold text-white",children:"+22%"}),n.jsx("div",{className:"text-xs text-gray-400",children:"Year-over-year"})]}),n.jsxs("div",{className:"bg-beam-dark-accent/30 p-4 rounded-lg border border-gray-700/50",children:[n.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"4G to 5G Migration"}),n.jsx("div",{className:"text-2xl font-bold text-white",children:"2.3%"}),n.jsx("div",{className:"text-xs text-gray-400",children:"Monthly migration rate"})]}),n.jsxs("div",{className:"bg-beam-dark-accent/30 p-4 rounded-lg border border-gray-700/50",children:[n.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"Fiber Penetration"}),n.jsx("div",{className:"text-2xl font-bold text-white",children:"35%"}),n.jsx("div",{className:"text-xs text-gray-400",children:"Market share"})]})]})})]})]})})},gmt=()=>{const[e,t]=U.useState([{id:"ran-001",name:"RAN Intelligence Agent",type:"ran",status:"active",performance:94,lastAction:"Optimizing cell coverage in sector 7",metrics:{requestsProcessed:2847,averageResponseTime:120,successRate:98.5}},{id:"core-001",name:"Core Network Agent",type:"core",status:"processing",performance:91,lastAction:"Analyzing traffic routing patterns",metrics:{requestsProcessed:1956,averageResponseTime:95,successRate:99.2}},{id:"capacity-001",name:"Capacity Analyzer Agent",type:"capacity",status:"active",performance:88,lastAction:"Forecasting capacity needs for Q2",metrics:{requestsProcessed:734,averageResponseTime:280,successRate:97.8}},{id:"service-001",name:"Service Impact Agent",type:"service",status:"idle",performance:96,lastAction:"Completed SLA compliance check",metrics:{requestsProcessed:445,averageResponseTime:150,successRate:99.7}},{id:"customer-001",name:"Customer Analytics Agent",type:"customer",status:"active",performance:89,lastAction:"Processing churn prediction model",metrics:{requestsProcessed:1233,averageResponseTime:340,successRate:94.2}}]),[r,i]=U.useState([{id:"msg-001",from:"RAN Intelligence Agent",to:"Capacity Analyzer Agent",type:"data",content:"Sharing updated cell utilization data for capacity planning",timestamp:new Date(Date.now()-3e5),priority:"medium"},{id:"msg-002",from:"Service Impact Agent",to:"Core Network Agent",type:"alert",content:"Potential service degradation detected in region North-East",timestamp:new Date(Date.now()-18e4),priority:"high"},{id:"msg-003",from:"Customer Analytics Agent",to:"RAN Intelligence Agent",type:"recommendation",content:"High-value customer experiencing poor signal quality in area ID: 4521",timestamp:new Date(Date.now()-12e4),priority:"critical"}]),a=p=>{switch(p){case"ran":return n.jsx(Yi,{className:"h-5 w-5"});case"core":return n.jsx(ga,{className:"h-5 w-5"});case"capacity":return n.jsx(En,{className:"h-5 w-5"});case"service":return n.jsx(bs,{className:"h-5 w-5"});case"customer":return n.jsx(qi,{className:"h-5 w-5"});default:return n.jsx(bd,{className:"h-5 w-5"})}},l=p=>{switch(p){case"active":return"bg-green-500";case"processing":return"bg-blue-500";case"idle":return"bg-gray-500";case"error":return"bg-red-500";default:return"bg-gray-500"}},d=p=>{switch(p){case"critical":return"border-l-red-500 bg-red-50";case"high":return"border-l-orange-500 bg-orange-50";case"medium":return"border-l-yellow-500 bg-yellow-50";case"low":return"border-l-blue-500 bg-blue-50";default:return"border-l-gray-500 bg-gray-50"}};U.useEffect(()=>{const p=setInterval(()=>{t(x=>x.map(w=>({...w,performance:Math.max(75,Math.min(100,w.performance+(Math.random()-.5)*4)),metrics:{...w.metrics,requestsProcessed:w.metrics.requestsProcessed+Math.floor(Math.random()*10),averageResponseTime:Math.max(50,w.metrics.averageResponseTime+(Math.random()-.5)*20)}})))},3e3);return()=>clearInterval(p)},[]);const s=(p,x)=>{t(w=>w.map(j=>j.id===p?{...j,lastAction:x,status:"processing"}:j)),setTimeout(()=>{t(w=>w.map(j=>j.id===p?{...j,status:"active"}:j))},2e3)};return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[n.jsxs(jt,{className:"lg:col-span-2",children:[n.jsx(wr,{children:n.jsxs(fr,{className:"flex items-center gap-2",children:[n.jsx(bd,{className:"h-5 w-5"}),"Agent Orchestra Status"]})}),n.jsx(Ht,{children:n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:e.map(p=>n.jsxs("div",{className:"border rounded-lg p-4 space-y-3",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[a(p.type),n.jsx("span",{className:"font-medium text-sm",children:p.name.split(" ")[0]})]}),n.jsx("div",{className:`w-3 h-3 rounded-full ${l(p.status)}`})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex justify-between text-xs",children:[n.jsx("span",{children:"Performance"}),n.jsxs("span",{children:[p.performance.toFixed(1),"%"]})]}),n.jsx(vn,{value:p.performance,className:"h-2"})]}),n.jsx("div",{className:"text-xs text-muted-foreground",children:p.lastAction}),n.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-muted-foreground",children:"Requests"}),n.jsx("div",{className:"font-medium",children:p.metrics.requestsProcessed.toLocaleString()})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-muted-foreground",children:"Avg Time"}),n.jsxs("div",{className:"font-medium",children:[p.metrics.averageResponseTime,"ms"]})]})]})]},p.id))})})]}),n.jsxs(jt,{children:[n.jsx(wr,{children:n.jsxs(fr,{className:"flex items-center gap-2",children:[n.jsx(bs,{className:"h-5 w-5"}),"System Health"]})}),n.jsxs(Ht,{className:"space-y-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsx("span",{children:"Overall Performance"}),n.jsx("span",{className:"font-medium",children:"92.4%"})]}),n.jsx(vn,{value:92.4,className:"h-2"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsx("span",{children:"Agent Coordination"}),n.jsx("span",{className:"font-medium",children:"98.1%"})]}),n.jsx(vn,{value:98.1,className:"h-2"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsx("span",{children:"Data Processing"}),n.jsx("span",{className:"font-medium",children:"95.7%"})]}),n.jsx(vn,{value:95.7,className:"h-2"})]}),n.jsxs("div",{className:"pt-4 space-y-2",children:[n.jsx("div",{className:"text-sm font-medium",children:"Active Agents"}),n.jsxs("div",{className:"text-2xl font-bold",children:[e.filter(p=>p.status==="active").length,"/",e.length]})]}),n.jsx(lt,{variant:"outline",size:"sm",className:"w-full",onClick:()=>s("system","Full system optimization"),children:"Optimize All Agents"})]})]})]}),n.jsxs(jt,{children:[n.jsx(wr,{children:n.jsx(fr,{children:"Inter-Agent Communication Stream"})}),n.jsx(Ht,{children:n.jsx("div",{className:"space-y-3 max-h-60 overflow-y-auto",children:r.map(p=>n.jsxs("div",{className:`border-l-4 p-3 rounded ${d(p.priority)}`,children:[n.jsxs("div",{className:"flex justify-between items-start mb-2",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Tt,{variant:"outline",className:"text-xs",children:p.type}),n.jsx("span",{className:"text-sm font-medium",children:p.from}),n.jsx("span",{className:"text-xs text-muted-foreground",children:"→"}),n.jsx("span",{className:"text-sm",children:p.to})]}),n.jsx("span",{className:"text-xs text-muted-foreground",children:p.timestamp.toLocaleTimeString()})]}),n.jsx("div",{className:"text-sm text-gray-700",children:p.content})]},p.id))})})]})]})},xmt=()=>{const[e,t]=U.useState([{id:"cell-001",name:"Downtown Hub Alpha",location:{lat:40.7589,lng:-73.9851},status:"optimal",utilization:78,signalStrength:92,connectedUsers:234,maxCapacity:300,interference:12,lastOptimized:new Date(Date.now()-36e5)},{id:"cell-002",name:"Business District Beta",location:{lat:40.7614,lng:-73.9776},status:"warning",utilization:89,signalStrength:85,connectedUsers:267,maxCapacity:300,interference:28,lastOptimized:new Date(Date.now()-72e5)},{id:"cell-003",name:"Residential Gamma",location:{lat:40.7505,lng:-73.9934},status:"critical",utilization:95,signalStrength:76,connectedUsers:285,maxCapacity:300,interference:45,lastOptimized:new Date(Date.now()-144e5)},{id:"cell-004",name:"Shopping Center Delta",location:{lat:40.7549,lng:-73.984},status:"optimal",utilization:65,signalStrength:94,connectedUsers:195,maxCapacity:300,interference:8,lastOptimized:new Date(Date.now()-18e5)}]),[r,i]=U.useState([{id:"opt-001",type:"power_adjustment",cellId:"cell-002",description:"Reducing transmission power to minimize interference",impact:"medium",status:"executing",timestamp:new Date(Date.now()-3e5),predictedImprovement:15},{id:"opt-002",type:"antenna_tilt",cellId:"cell-003",description:"Adjusting antenna downtilt for better coverage",impact:"high",status:"pending",timestamp:new Date(Date.now()-12e4),predictedImprovement:22},{id:"opt-003",type:"frequency_reallocation",cellId:"cell-003",description:"Reallocating spectrum to less congested bands",impact:"high",status:"completed",timestamp:new Date(Date.now()-6e5),predictedImprovement:18}]),[a,l]=U.useState({totalCellsMonitored:4,optimizationsToday:12,averageImprovement:17.5,predictiveAccuracy:94.2,energySavings:8.3,userExperienceScore:4.6}),d=w=>{switch(w){case"optimal":return"text-green-600 bg-green-100";case"warning":return"text-yellow-600 bg-yellow-100";case"critical":return"text-red-600 bg-red-100";case"maintenance":return"text-blue-600 bg-blue-100";default:return"text-gray-600 bg-gray-100"}},s=w=>{switch(w){case"optimal":return n.jsx(ro,{className:"h-4 w-4"});case"warning":return n.jsx(fs,{className:"h-4 w-4"});case"critical":return n.jsx(fs,{className:"h-4 w-4"});case"maintenance":return n.jsx(ws,{className:"h-4 w-4"});default:return n.jsx(kc,{className:"h-4 w-4"})}},p=w=>{switch(w){case"power_adjustment":return n.jsx(Yi,{className:"h-4 w-4"});case"antenna_tilt":return n.jsx(kc,{className:"h-4 w-4"});case"frequency_reallocation":return n.jsx(to,{className:"h-4 w-4"});case"handover_optimization":return n.jsx(Ov,{className:"h-4 w-4"});default:return n.jsx(bd,{className:"h-4 w-4"})}};U.useEffect(()=>{const w=setInterval(()=>{t(j=>j.map(S=>({...S,utilization:Math.max(30,Math.min(100,S.utilization+(Math.random()-.5)*10)),signalStrength:Math.max(60,Math.min(100,S.signalStrength+(Math.random()-.5)*5)),connectedUsers:Math.max(50,Math.min(S.maxCapacity,S.connectedUsers+Math.floor((Math.random()-.5)*20))),interference:Math.max(5,Math.min(50,S.interference+(Math.random()-.5)*8))}))),l(j=>({...j,optimizationsToday:j.optimizationsToday+Math.floor(Math.random()*2),averageImprovement:Math.max(10,Math.min(25,j.averageImprovement+(Math.random()-.5)*2)),predictiveAccuracy:Math.max(90,Math.min(98,j.predictiveAccuracy+(Math.random()-.5)*1))}))},5e3);return()=>clearInterval(w)},[]);const x=w=>{var S;const j={id:`opt-${Date.now()}`,type:"power_adjustment",cellId:w,description:`Auto-optimization initiated for ${(S=e.find(P=>P.id===w))==null?void 0:S.name}`,impact:"medium",status:"executing",timestamp:new Date,predictedImprovement:Math.floor(Math.random()*20)+10};i(P=>[j,...P]),setTimeout(()=>{i(P=>P.map(F=>F.id===j.id?{...F,status:"completed"}:F)),t(P=>P.map(F=>F.id===w?{...F,utilization:Math.max(60,F.utilization-10),interference:Math.max(5,F.interference-5),lastOptimized:new Date}:F))},3e3)};return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-4",children:[n.jsx(jt,{children:n.jsx(Ht,{className:"p-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-muted-foreground",children:"Cells Monitored"}),n.jsx("p",{className:"text-2xl font-bold",children:a.totalCellsMonitored})]}),n.jsx(kc,{className:"h-8 w-8 text-blue-600"})]})})}),n.jsx(jt,{children:n.jsx(Ht,{className:"p-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-muted-foreground",children:"Optimizations Today"}),n.jsx("p",{className:"text-2xl font-bold",children:a.optimizationsToday})]}),n.jsx(En,{className:"h-8 w-8 text-green-600"})]})})}),n.jsx(jt,{children:n.jsx(Ht,{className:"p-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-muted-foreground",children:"Avg Improvement"}),n.jsxs("p",{className:"text-2xl font-bold",children:[a.averageImprovement.toFixed(1),"%"]})]}),n.jsx(to,{className:"h-8 w-8 text-purple-600"})]})})}),n.jsx(jt,{children:n.jsx(Ht,{className:"p-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-muted-foreground",children:"Prediction Accuracy"}),n.jsxs("p",{className:"text-2xl font-bold",children:[a.predictiveAccuracy.toFixed(1),"%"]})]}),n.jsx(bd,{className:"h-8 w-8 text-orange-600"})]})})})]}),n.jsxs($i,{defaultValue:"cells",className:"space-y-6",children:[n.jsxs(Di,{className:"grid w-full grid-cols-3",children:[n.jsx(Jt,{value:"cells",children:"Cell Tower Status"}),n.jsx(Jt,{value:"optimizations",children:"Active Optimizations"}),n.jsx(Jt,{value:"analytics",children:"Performance Analytics"})]}),n.jsx(ur,{value:"cells",className:"space-y-4",children:n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.map(w=>n.jsxs(jt,{children:[n.jsx(wr,{className:"pb-3",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx(fr,{className:"text-lg",children:w.name}),n.jsxs(Tt,{className:d(w.status),children:[s(w.status),n.jsx("span",{className:"ml-1 capitalize",children:w.status})]})]})}),n.jsxs(Ht,{className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-sm text-muted-foreground",children:"Utilization"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(vn,{value:w.utilization,className:"flex-1 h-2"}),n.jsxs("span",{className:"text-sm font-medium",children:[w.utilization,"%"]})]})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-sm text-muted-foreground",children:"Signal Strength"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(vn,{value:w.signalStrength,className:"flex-1 h-2"}),n.jsxs("span",{className:"text-sm font-medium",children:[w.signalStrength,"%"]})]})]})]}),n.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-muted-foreground",children:"Connected Users"}),n.jsxs("div",{className:"font-medium",children:[w.connectedUsers,"/",w.maxCapacity]})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-muted-foreground",children:"Interference"}),n.jsxs("div",{className:"font-medium",children:[w.interference,"%"]})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-muted-foreground",children:"Last Optimized"}),n.jsxs("div",{className:"font-medium",children:[Math.floor((Date.now()-w.lastOptimized.getTime())/6e4),"m ago"]})]})]}),n.jsx(lt,{variant:"outline",size:"sm",className:"w-full",onClick:()=>x(w.id),disabled:w.status==="maintenance",children:w.utilization>85?"Optimize Now":"Force Optimization"})]})]},w.id))})}),n.jsx(ur,{value:"optimizations",className:"space-y-4",children:n.jsxs(jt,{children:[n.jsx(wr,{children:n.jsx(fr,{children:"Recent Optimization Actions"})}),n.jsx(Ht,{children:n.jsx("div",{className:"space-y-4",children:r.map(w=>{var j;return n.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[p(w.type),n.jsxs("div",{children:[n.jsx("div",{className:"font-medium",children:w.description}),n.jsxs("div",{className:"text-sm text-muted-foreground",children:[(j=e.find(S=>S.id===w.cellId))==null?void 0:j.name," •",w.timestamp.toLocaleTimeString()]})]})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs(Tt,{variant:w.impact==="high"?"destructive":w.impact==="medium"?"default":"secondary",children:[w.impact," impact"]}),n.jsx(Tt,{variant:w.status==="completed"?"default":w.status==="executing"?"secondary":"outline",children:w.status}),n.jsxs("div",{className:"text-sm font-medium text-green-600",children:["+",w.predictedImprovement,"%"]})]})]},w.id)})})})]})}),n.jsx(ur,{value:"analytics",className:"space-y-4",children:n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[n.jsxs(jt,{children:[n.jsx(wr,{children:n.jsx(fr,{children:"Performance Metrics"})}),n.jsxs(Ht,{className:"space-y-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsx("span",{children:"Energy Savings"}),n.jsxs("span",{className:"font-medium text-green-600",children:["+",a.energySavings,"%"]})]}),n.jsx(vn,{value:a.energySavings,className:"h-2"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsx("span",{children:"User Experience Score"}),n.jsxs("span",{className:"font-medium",children:[a.userExperienceScore,"/5.0"]})]}),n.jsx(vn,{value:a.userExperienceScore/5*100,className:"h-2"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsx("span",{children:"Coverage Optimization"}),n.jsx("span",{className:"font-medium",children:"91.2%"})]}),n.jsx(vn,{value:91.2,className:"h-2"})]})]})]}),n.jsxs(jt,{children:[n.jsx(wr,{children:n.jsx(fr,{children:"AI Predictions"})}),n.jsx(Ht,{className:"space-y-4",children:n.jsxs("div",{className:"text-sm space-y-2",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{children:"Peak hour capacity stress:"}),n.jsx("span",{className:"font-medium text-orange-600",children:"6:00 PM - 8:00 PM"})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{children:"Recommended preemptive actions:"}),n.jsx("span",{className:"font-medium",children:"3 pending"})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{children:"Next maintenance window:"}),n.jsx("span",{className:"font-medium",children:"Sunday 2:00 AM"})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{children:"Predicted traffic increase:"}),n.jsx("span",{className:"font-medium text-blue-600",children:"+12% this week"})]})]})})]})]})})]})]})},ymt=()=>{const[e,t]=U.useState([{id:"premium",name:"Premium Business",size:12500,churnRate:2.1,avgRevenue:8500,networkUsage:95,satisfactionScore:94,riskLevel:"low",growthTrend:"up"},{id:"enterprise",name:"Enterprise",size:3200,churnRate:1.8,avgRevenue:25e3,networkUsage:87,satisfactionScore:96,riskLevel:"low",growthTrend:"up"},{id:"consumer",name:"Consumer Mobile",size:85e4,churnRate:8.5,avgRevenue:45,networkUsage:78,satisfactionScore:82,riskLevel:"medium",growthTrend:"stable"},{id:"youth",name:"Youth Data Plans",size:125e3,churnRate:12.3,avgRevenue:25,networkUsage:92,satisfactionScore:76,riskLevel:"high",growthTrend:"down"}]),[r,i]=U.useState([{service:"Mobile Data",subscribers:98e4,churnRate:7.2,revenueImpact:45e6,networkLoad:85,customerSat:83,issues:["Network congestion in CBD","Slow speeds during peak hours"]},{service:"Fixed Broadband",subscribers:34e4,churnRate:4.1,revenueImpact:28e6,networkLoad:72,customerSat:88,issues:["Installation delays","Rural coverage gaps"]},{service:"Business Internet",subscribers:15700,churnRate:2.8,revenueImpact:185e5,networkLoad:68,customerSat:92,issues:["SLA breach concerns","Backup circuit reliability"]},{service:"IoT Connectivity",subscribers:125e3,churnRate:3.2,revenueImpact:52e5,networkLoad:45,customerSat:87,issues:["Device compatibility","Coverage in remote areas"]}]),[a,l]=U.useState([{region:"Central Business District",totalGB:125e3,popularServices:["Netflix","YouTube","Teams","WhatsApp"],peakHours:"9:00-11:00, 19:00-22:00",deviceTypes:[{type:"Smartphone",percentage:65},{type:"Laptop",percentage:25},{type:"Tablet",percentage:10}],qualityScore:87},{region:"Residential Suburbs",totalGB:89e3,popularServices:["Netflix","Disney+","Spotify","Instagram"],peakHours:"19:00-23:00",deviceTypes:[{type:"Smartphone",percentage:72},{type:"Smart TV",percentage:18},{type:"Laptop",percentage:10}],qualityScore:91},{region:"Industrial Areas",totalGB:45e3,popularServices:["Teams","Outlook","SAP","Zoom"],peakHours:"8:00-17:00",deviceTypes:[{type:"Laptop",percentage:55},{type:"Smartphone",percentage:35},{type:"IoT Device",percentage:10}],qualityScore:94}]),[d,s]=U.useState([{segment:"Youth Data Plans",riskScore:84,predictedChurn:156,revenue_at_risk:39e4},{segment:"Consumer Mobile",riskScore:62,predictedChurn:5100,revenue_at_risk:229500},{segment:"Fixed Broadband",riskScore:28,predictedChurn:952,revenue_at_risk:78540},{segment:"Premium Business",riskScore:15,predictedChurn:26,revenue_at_risk:221e3}]);U.useEffect(()=>{const w=setInterval(()=>{t(j=>j.map(S=>({...S,churnRate:Math.max(0,S.churnRate+(Math.random()-.5)*.1),satisfactionScore:Math.min(100,Math.max(0,S.satisfactionScore+(Math.random()-.5)*2)),networkUsage:Math.min(100,Math.max(0,S.networkUsage+(Math.random()-.5)*3))})))},5e3);return()=>clearInterval(w)},[]);const p=w=>{switch(w){case"low":return"bg-green-500/20 text-green-300 border-green-500/30";case"medium":return"bg-yellow-500/20 text-yellow-300 border-yellow-500/30";case"high":return"bg-red-500/20 text-red-300 border-red-500/30";default:return"bg-gray-500/20 text-gray-300 border-gray-500/30"}},x=w=>{switch(w){case"up":return n.jsx(En,{className:"h-4 w-4 text-green-400"});case"down":return n.jsx(tx,{className:"h-4 w-4 text-red-400"});default:return n.jsx(bs,{className:"h-4 w-4 text-yellow-400"})}};return n.jsx("div",{className:"space-y-6",children:n.jsxs("div",{className:"glass-panel backdrop-blur-md bg-beam-dark-accent/30 border border-gray-700/50 rounded-xl p-6",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[n.jsx("div",{className:"bg-beam-blue/20 p-3 rounded-lg",children:n.jsx(qi,{className:"h-6 w-6 text-beam-blue"})}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl font-bold text-white",children:"Customer Analytics Intelligence"}),n.jsx("p",{className:"text-gray-400",children:"Real-time business dimension analysis with network correlation"})]})]}),n.jsxs($i,{defaultValue:"segments",className:"w-full",children:[n.jsxs(Di,{className:"grid w-full grid-cols-4 mb-6 bg-beam-dark-accent/40 border border-gray-700/50 rounded-xl p-1",children:[n.jsx(Jt,{value:"segments",className:"rounded-lg data-[state=active]:bg-beam-blue data-[state=active]:text-white",children:"Customer Segments"}),n.jsx(Jt,{value:"services",className:"rounded-lg data-[state=active]:bg-beam-blue data-[state=active]:text-white",children:"Service Analytics"}),n.jsx(Jt,{value:"browsing",className:"rounded-lg data-[state=active]:bg-beam-blue data-[state=active]:text-white",children:"Usage Patterns"}),n.jsx(Jt,{value:"churn",className:"rounded-lg data-[state=active]:bg-beam-blue data-[state=active]:text-white",children:"Churn Prediction"})]}),n.jsx(ur,{value:"segments",children:n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.map(w=>n.jsxs(jt,{className:"bg-beam-dark-accent/50 border-gray-700/50 p-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-lg font-semibold text-white",children:w.name}),n.jsxs("div",{className:"flex items-center gap-2",children:[x(w.growthTrend),n.jsx(Tt,{className:p(w.riskLevel),children:w.riskLevel.toUpperCase()})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-sm text-gray-400",children:"Subscribers"}),n.jsx("div",{className:"text-xl font-bold text-white",children:w.size.toLocaleString()})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-sm text-gray-400",children:"Avg Revenue"}),n.jsxs("div",{className:"text-xl font-bold text-white",children:["$",w.avgRevenue]})]})]}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{children:[n.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[n.jsx("span",{className:"text-gray-400",children:"Churn Rate"}),n.jsxs("span",{className:"text-white",children:[w.churnRate.toFixed(1),"%"]})]}),n.jsx(vn,{value:w.churnRate,className:"h-2"})]}),n.jsxs("div",{children:[n.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[n.jsx("span",{className:"text-gray-400",children:"Satisfaction Score"}),n.jsxs("span",{className:"text-white",children:[w.satisfactionScore.toFixed(1),"%"]})]}),n.jsx(vn,{value:w.satisfactionScore,className:"h-2"})]}),n.jsxs("div",{children:[n.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[n.jsx("span",{className:"text-gray-400",children:"Network Usage"}),n.jsxs("span",{className:"text-white",children:[w.networkUsage,"%"]})]}),n.jsx(vn,{value:w.networkUsage,className:"h-2"})]})]})]},w.id))})}),n.jsx(ur,{value:"services",children:n.jsx("div",{className:"space-y-4",children:r.map((w,j)=>n.jsxs(jt,{className:"bg-beam-dark-accent/50 border-gray-700/50 p-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-lg font-semibold text-white",children:w.service}),n.jsx("div",{className:"flex items-center gap-4",children:n.jsxs("div",{className:"text-right",children:[n.jsx("div",{className:"text-sm text-gray-400",children:"Revenue Impact"}),n.jsxs("div",{className:"text-lg font-bold text-white",children:["$",(w.revenueImpact/1e6).toFixed(1),"M"]})]})})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 mb-4",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-sm text-gray-400",children:"Subscribers"}),n.jsx("div",{className:"text-lg font-bold text-white",children:w.subscribers.toLocaleString()})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-sm text-gray-400",children:"Churn Rate"}),n.jsxs("div",{className:"text-lg font-bold text-white",children:[w.churnRate,"%"]})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-sm text-gray-400",children:"Network Load"}),n.jsxs("div",{className:"text-lg font-bold text-white",children:[w.networkLoad,"%"]})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-sm text-gray-400",children:"Customer Sat"}),n.jsxs("div",{className:"text-lg font-bold text-white",children:[w.customerSat,"%"]})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-sm text-gray-400",children:"Status"}),n.jsxs("div",{className:"flex items-center gap-1",children:[w.churnRate<5?n.jsx(ro,{className:"h-4 w-4 text-green-400"}):n.jsx(fs,{className:"h-4 w-4 text-yellow-400"}),n.jsx("span",{className:"text-sm text-white",children:w.churnRate<5?"Healthy":"At Risk"})]})]})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-sm text-gray-400 mb-2",children:"Current Issues:"}),n.jsx("div",{className:"flex flex-wrap gap-2",children:w.issues.map((S,P)=>n.jsx(Tt,{variant:"outline",className:"bg-red-500/10 border-red-500/20 text-red-300",children:S},P))})]})]},j))})}),n.jsx(ur,{value:"browsing",children:n.jsx("div",{className:"space-y-4",children:a.map((w,j)=>n.jsxs(jt,{className:"bg-beam-dark-accent/50 border-gray-700/50 p-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-lg font-semibold text-white",children:w.region}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Zs,{className:"h-5 w-5 text-beam-blue"}),n.jsxs("span",{className:"text-white font-bold",children:[w.totalGB.toLocaleString()," GB"]})]})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-sm text-gray-400 mb-2",children:"Popular Services"}),n.jsx("div",{className:"flex flex-wrap gap-1",children:w.popularServices.map((S,P)=>n.jsx(Tt,{variant:"outline",className:"bg-beam-blue/10 border-beam-blue/20 text-beam-blue",children:S},P))})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-sm text-gray-400 mb-2",children:"Peak Hours"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx($a,{className:"h-4 w-4 text-gray-400"}),n.jsx("span",{className:"text-white",children:w.peakHours})]})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-sm text-gray-400 mb-2",children:"Quality Score"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Ove,{className:"h-4 w-4 text-green-400"}),n.jsxs("span",{className:"text-white font-bold",children:[w.qualityScore,"%"]})]})]})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-sm text-gray-400 mb-2",children:"Device Distribution"}),n.jsx("div",{className:"grid grid-cols-3 gap-2",children:w.deviceTypes.map((S,P)=>n.jsxs("div",{className:"bg-beam-dark-accent/50 p-3 rounded-lg",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-sm text-white",children:S.type}),n.jsxs("span",{className:"text-sm font-bold text-beam-blue",children:[S.percentage,"%"]})]}),n.jsx(vn,{value:S.percentage,className:"h-1 mt-1"})]},P))})]})]},j))})}),n.jsx(ur,{value:"churn",children:n.jsxs("div",{className:"space-y-4",children:[n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:d.map((w,j)=>n.jsx(jt,{className:"bg-beam-dark-accent/50 border-gray-700/50 p-4",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-sm text-gray-400 mb-1",children:w.segment}),n.jsxs("div",{className:"text-2xl font-bold text-white mb-2",children:[w.riskScore,"%"]}),n.jsx(vn,{value:w.riskScore,className:"h-2 mb-3"}),n.jsx("div",{className:"text-xs text-gray-400",children:"Risk Score"})]})},j))}),n.jsxs(jt,{className:"bg-beam-dark-accent/50 border-gray-700/50 p-6",children:[n.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Churn Prediction Details"}),n.jsx("div",{className:"space-y-4",children:d.map((w,j)=>n.jsxs("div",{className:"flex items-center justify-between p-3 bg-beam-dark-accent/30 rounded-lg",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-white font-medium",children:w.segment}),n.jsxs("div",{className:"text-sm text-gray-400",children:[w.predictedChurn," customers at risk"]})]}),n.jsxs("div",{className:"text-right",children:[n.jsxs("div",{className:"text-white font-bold",children:["$",w.revenue_at_risk.toLocaleString()]}),n.jsx("div",{className:"text-sm text-gray-400",children:"Revenue at Risk"})]})]},j))})]})]})})]})]})})},vmt=()=>{const[e,t]=U.useState([{category:"Mobile Data Services",currentRevenue:425e5,projectedLoss:85e4,affectedCustomers:125e3,serviceLevel:87,networkCause:"Peak hour congestion in urban areas",priority:"critical",trendDirection:"down"},{category:"Enterprise Solutions",currentRevenue:1875e4,projectedLoss:32e4,affectedCustomers:2400,serviceLevel:94,networkCause:"Fiber link redundancy issues",priority:"high",trendDirection:"stable"},{category:"Fixed Broadband",currentRevenue:282e5,projectedLoss:18e4,affectedCustomers:8500,serviceLevel:91,networkCause:"DSL performance degradation",priority:"medium",trendDirection:"up"},{category:"IoT & M2M",currentRevenue:52e5,projectedLoss:45e3,affectedCustomers:15e3,serviceLevel:96,networkCause:"Coverage gaps in rural deployment",priority:"low",trendDirection:"up"}]),[r,i]=U.useState([{service:"Mobile Network",availability:99.2,performance:87,customerSat:83,revenueImpact:425e5,issueCount:12,slaCompliance:94,icon:n.jsx(Vp,{className:"h-5 w-5 text-beam-blue"})},{service:"Fixed Broadband",availability:99.7,performance:91,customerSat:88,revenueImpact:282e5,issueCount:4,slaCompliance:97,icon:n.jsx(Sve,{className:"h-5 w-5 text-beam-blue"})},{service:"Enterprise WAN",availability:99.9,performance:94,customerSat:92,revenueImpact:1875e4,issueCount:2,slaCompliance:98,icon:n.jsx(Zs,{className:"h-5 w-5 text-beam-blue"})},{service:"Data Center",availability:99.95,performance:96,customerSat:94,revenueImpact:124e5,issueCount:1,slaCompliance:99,icon:n.jsx(gve,{className:"h-5 w-5 text-beam-blue"})}]),[a,l]=U.useState([{networkMetric:"Peak Hour Latency",businessMetric:"Customer Churn Rate",correlation:.78,impact:"High latency increases churn by 2.3% per 10ms",recommendation:"Implement traffic shaping during 7-10 PM",currentValue:45,targetValue:25},{networkMetric:"Network Availability",businessMetric:"Enterprise Revenue",correlation:.92,impact:"1% availability drop = $850K revenue loss",recommendation:"Deploy redundant links in critical areas",currentValue:99.2,targetValue:99.8},{networkMetric:"Download Speed",businessMetric:"Customer Satisfaction",correlation:.84,impact:"Speed degradation below 25Mbps affects satisfaction",recommendation:"Upgrade capacity in congested cells",currentValue:28.5,targetValue:50},{networkMetric:"Call Drop Rate",businessMetric:"Premium Plan Retention",correlation:.71,impact:">1% drop rate causes 15% premium churn",recommendation:"Optimize handover parameters",currentValue:1.8,targetValue:.5}]),[d,s]=U.useState([{id:1,severity:"critical",message:"Enterprise SLA breach detected - CBD fiber link",revenue_impact:125e3,affected_customers:340,timestamp:new Date},{id:2,severity:"high",message:"Mobile data speeds below 20Mbps in Zone 5",revenue_impact:45e3,affected_customers:12500,timestamp:new Date},{id:3,severity:"medium",message:"Increased complaints about video streaming quality",revenue_impact:18e3,affected_customers:5600,timestamp:new Date}]);U.useEffect(()=>{const j=setInterval(()=>{i(S=>S.map(P=>({...P,availability:Math.max(95,Math.min(100,P.availability+(Math.random()-.5)*.2)),performance:Math.max(70,Math.min(100,P.performance+(Math.random()-.5)*2)),customerSat:Math.max(70,Math.min(100,P.customerSat+(Math.random()-.5)*1.5))}))),t(S=>S.map(P=>({...P,serviceLevel:Math.max(70,Math.min(100,P.serviceLevel+(Math.random()-.5)*2)),projectedLoss:Math.max(0,P.projectedLoss+(Math.random()-.5)*5e4)})))},8e3);return()=>clearInterval(j)},[]);const p=j=>{switch(j){case"critical":return"bg-red-500/20 text-red-300 border-red-500/30";case"high":return"bg-orange-500/20 text-orange-300 border-orange-500/30";case"medium":return"bg-yellow-500/20 text-yellow-300 border-yellow-500/30";case"low":return"bg-green-500/20 text-green-300 border-green-500/30";default:return"bg-gray-500/20 text-gray-300 border-gray-500/30"}},x=j=>{switch(j){case"critical":return"border-l-red-500 bg-red-500/10";case"high":return"border-l-orange-500 bg-orange-500/10";case"medium":return"border-l-yellow-500 bg-yellow-500/10";default:return"border-l-green-500 bg-green-500/10"}},w=j=>{switch(j){case"up":return n.jsx(En,{className:"h-4 w-4 text-green-400"});case"down":return n.jsx(tx,{className:"h-4 w-4 text-red-400"});default:return n.jsx(to,{className:"h-4 w-4 text-yellow-400"})}};return n.jsx("div",{className:"space-y-6",children:n.jsxs("div",{className:"glass-panel backdrop-blur-md bg-beam-dark-accent/30 border border-gray-700/50 rounded-xl p-6",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[n.jsx("div",{className:"bg-ptt-red/20 p-3 rounded-lg",children:n.jsx(sc,{className:"h-6 w-6 text-ptt-red"})}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl font-bold text-white",children:"Service Impact Analysis"}),n.jsx("p",{className:"text-gray-400",children:"Real-time business correlation with network performance"})]})]}),n.jsxs($i,{defaultValue:"impact",className:"w-full",children:[n.jsxs(Di,{className:"grid w-full grid-cols-4 mb-6 bg-beam-dark-accent/40 border border-gray-700/50 rounded-xl p-1",children:[n.jsx(Jt,{value:"impact",className:"rounded-lg data-[state=active]:bg-beam-blue data-[state=active]:text-white",children:"Business Impact"}),n.jsx(Jt,{value:"kpis",className:"rounded-lg data-[state=active]:bg-beam-blue data-[state=active]:text-white",children:"Service KPIs"}),n.jsx(Jt,{value:"correlation",className:"rounded-lg data-[state=active]:bg-beam-blue data-[state=active]:text-white",children:"Network-Business Link"}),n.jsx(Jt,{value:"alerts",className:"rounded-lg data-[state=active]:bg-beam-blue data-[state=active]:text-white",children:"Real-time Alerts"})]}),n.jsx(ur,{value:"impact",children:n.jsx("div",{className:"space-y-4",children:e.map((j,S)=>n.jsxs(jt,{className:"bg-beam-dark-accent/50 border-gray-700/50 p-5",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("h3",{className:"text-lg font-semibold text-white",children:j.category}),w(j.trendDirection)]}),n.jsx(Tt,{className:p(j.priority),children:j.priority.toUpperCase()})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-sm text-gray-400",children:"Current Revenue"}),n.jsxs("div",{className:"text-lg font-bold text-white",children:["$",(j.currentRevenue/1e6).toFixed(1),"M"]})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-sm text-gray-400",children:"Projected Loss"}),n.jsxs("div",{className:"text-lg font-bold text-red-400",children:["$",(j.projectedLoss/1e3).toFixed(0),"K"]})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-sm text-gray-400",children:"Affected Customers"}),n.jsx("div",{className:"text-lg font-bold text-white",children:j.affectedCustomers.toLocaleString()})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-sm text-gray-400",children:"Service Level"}),n.jsxs("div",{className:"text-lg font-bold text-white",children:[j.serviceLevel,"%"]})]})]}),n.jsxs("div",{className:"mb-4",children:[n.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[n.jsx("span",{className:"text-gray-400",children:"Service Performance"}),n.jsxs("span",{className:"text-white",children:[j.serviceLevel,"%"]})]}),n.jsx(vn,{value:j.serviceLevel,className:"h-2"})]}),n.jsxs("div",{className:"bg-beam-dark-accent/30 p-3 rounded-lg",children:[n.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"Network Root Cause:"}),n.jsx("div",{className:"text-white",children:j.networkCause})]})]},S))})}),n.jsx(ur,{value:"kpis",children:n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:r.map((j,S)=>n.jsxs(jt,{className:"bg-beam-dark-accent/50 border-gray-700/50 p-5",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[n.jsx("div",{className:"bg-beam-blue/20 p-2 rounded-lg",children:j.icon}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-lg font-semibold text-white",children:j.service}),n.jsxs("div",{className:"text-sm text-gray-400",children:["Revenue: $",(j.revenueImpact/1e6).toFixed(1),"M"]})]})]}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{children:[n.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[n.jsx("span",{className:"text-gray-400",children:"Availability"}),n.jsxs("span",{className:"text-white",children:[j.availability.toFixed(1),"%"]})]}),n.jsx(vn,{value:j.availability,className:"h-2"})]}),n.jsxs("div",{children:[n.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[n.jsx("span",{className:"text-gray-400",children:"Performance"}),n.jsxs("span",{className:"text-white",children:[j.performance,"%"]})]}),n.jsx(vn,{value:j.performance,className:"h-2"})]}),n.jsxs("div",{children:[n.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[n.jsx("span",{className:"text-gray-400",children:"Customer Satisfaction"}),n.jsxs("span",{className:"text-white",children:[j.customerSat,"%"]})]}),n.jsx(vn,{value:j.customerSat,className:"h-2"})]}),n.jsxs("div",{children:[n.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[n.jsx("span",{className:"text-gray-400",children:"SLA Compliance"}),n.jsxs("span",{className:"text-white",children:[j.slaCompliance,"%"]})]}),n.jsx(vn,{value:j.slaCompliance,className:"h-2"})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-4 pt-4 border-t border-gray-700/50",children:[n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-lg font-bold text-white",children:j.issueCount}),n.jsx("div",{className:"text-xs text-gray-400",children:"Active Issues"})]}),n.jsxs("div",{className:"text-center",children:[n.jsxs("div",{className:"flex items-center justify-center gap-1",children:[j.issueCount<=2?n.jsx(ro,{className:"h-4 w-4 text-green-400"}):n.jsx(fs,{className:"h-4 w-4 text-yellow-400"}),n.jsx("span",{className:"text-sm font-bold text-white",children:j.issueCount<=2?"Healthy":"Monitor"})]}),n.jsx("div",{className:"text-xs text-gray-400",children:"Status"})]})]})]},S))})}),n.jsx(ur,{value:"correlation",children:n.jsx("div",{className:"space-y-4",children:a.map((j,S)=>n.jsxs(jt,{className:"bg-beam-dark-accent/50 border-gray-700/50 p-5",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{children:[n.jsxs("h3",{className:"text-lg font-semibold text-white",children:[j.networkMetric," ↔ ",j.businessMetric]}),n.jsxs("div",{className:"text-sm text-gray-400",children:["Correlation: ",(j.correlation*100).toFixed(0),"%"]})]}),n.jsxs("div",{className:"text-right",children:[n.jsxs("div",{className:"text-2xl font-bold text-white",children:[(j.correlation*100).toFixed(0),"%"]}),n.jsx("div",{className:"text-xs text-gray-400",children:"Correlation"})]})]}),n.jsx("div",{className:"mb-4",children:n.jsx(vn,{value:j.correlation*100,className:"h-3"})}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[n.jsxs("div",{className:"bg-beam-dark-accent/30 p-3 rounded-lg",children:[n.jsx("div",{className:"text-sm text-gray-400",children:"Current Value"}),n.jsxs("div",{className:"text-lg font-bold text-white",children:[j.currentValue,j.networkMetric.includes("Rate")?"%":j.networkMetric.includes("Speed")?" Mbps":j.networkMetric.includes("Latency")?"ms":j.networkMetric.includes("Availability")?"%":""]})]}),n.jsxs("div",{className:"bg-beam-dark-accent/30 p-3 rounded-lg",children:[n.jsx("div",{className:"text-sm text-gray-400",children:"Target Value"}),n.jsxs("div",{className:"text-lg font-bold text-green-400",children:[j.targetValue,j.networkMetric.includes("Rate")?"%":j.networkMetric.includes("Speed")?" Mbps":j.networkMetric.includes("Latency")?"ms":j.networkMetric.includes("Availability")?"%":""]})]})]}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"bg-yellow-500/10 border border-yellow-500/20 p-3 rounded-lg",children:[n.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"Business Impact:"}),n.jsx("div",{className:"text-white",children:j.impact})]}),n.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/20 p-3 rounded-lg",children:[n.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"Recommendation:"}),n.jsx("div",{className:"text-white",children:j.recommendation})]})]})]},S))})}),n.jsx(ur,{value:"alerts",children:n.jsx("div",{className:"space-y-4",children:d.map(j=>n.jsxs(jt,{className:`border-l-4 ${x(j.severity)} border-gray-700/50 p-5`,children:[n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(fs,{className:"h-5 w-5 text-yellow-400"}),n.jsxs("div",{children:[n.jsx("div",{className:"text-white font-medium",children:j.message}),n.jsx("div",{className:"text-sm text-gray-400",children:j.timestamp.toLocaleTimeString()})]})]}),n.jsx(Tt,{className:p(j.severity),children:j.severity.toUpperCase()})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"bg-beam-dark-accent/30 p-3 rounded-lg",children:[n.jsx("div",{className:"text-sm text-gray-400",children:"Revenue Impact"}),n.jsxs("div",{className:"text-lg font-bold text-red-400",children:["$",j.revenue_impact.toLocaleString()]})]}),n.jsxs("div",{className:"bg-beam-dark-accent/30 p-3 rounded-lg",children:[n.jsx("div",{className:"text-sm text-gray-400",children:"Affected Customers"}),n.jsx("div",{className:"text-lg font-bold text-white",children:j.affected_customers.toLocaleString()})]})]}),n.jsxs("div",{className:"flex gap-2 mt-4",children:[n.jsxs(lt,{size:"sm",variant:"outline",className:"bg-green-500/10 hover:bg-green-500/20 border-green-500/30 text-green-300",children:[n.jsx(Yi,{className:"h-4 w-4 mr-1"}),"Auto-Remediate"]}),n.jsxs(lt,{size:"sm",variant:"outline",className:"bg-blue-500/10 hover:bg-blue-500/20 border-blue-500/30 text-blue-300",children:[n.jsx(qi,{className:"h-4 w-4 mr-1"}),"Escalate to NOC"]})]})]},j.id))})})]})]})})},bmt=({onAgentClick:e})=>{const[t,r]=U.useState([{id:"agent-1",name:"Topology Agent",type:"core",status:"active",icon:n.jsx(ga,{className:"h-5 w-5 text-ptt-blue"}),description:"Analyzes network structure and connectivity patterns",capabilities:["Path analysis","Redundancy verification","Topology mapping"]},{id:"agent-2",name:"Traffic Forecasting Agent",type:"analytics",status:"active",icon:n.jsx(FD,{className:"h-5 w-5 text-ptt-blue"}),description:"Predicts future traffic patterns based on historical data",capabilities:["Growth analysis","Anomaly detection","Seasonal forecasting"]},{id:"agent-3",name:"Capacity Planning Agent",type:"planning",status:"active",icon:n.jsx(MQ,{className:"h-5 w-5 text-ptt-blue"}),description:"Plans network capacity based on forecasted demand",capabilities:["Bottleneck identification","Upgrade recommendations","Cost optimization"]},{id:"agent-4",name:"Customer Experience Agent",type:"analytics",status:"idle",icon:n.jsx(ln,{className:"h-5 w-5 text-ptt-blue"}),description:"Correlates network metrics with customer experience",capabilities:["Churn prediction","Service quality mapping","Experience scoring"]},{id:"agent-5",name:"Network Optimization Agent",type:"optimization",status:"idle",icon:n.jsx(bd,{className:"h-5 w-5 text-ptt-blue"}),description:"Optimizes network configuration for performance",capabilities:["Traffic balancing","Resource allocation","Energy efficiency"]},{id:"agent-6",name:"Failure Scenario Agent",type:"resilience",status:"disabled",icon:n.jsx(Ave,{className:"h-5 w-5 text-ptt-blue"}),description:"Simulates network failures and recovery scenarios",capabilities:["Fault simulation","Recovery time prediction","Resilience scoring"]}]),i=l=>{r(t.map(d=>d.id===l?{...d,status:"active"}:d))},a=l=>{r(t.map(d=>d.id===l?{...d,status:"idle"}:d))};return n.jsx("div",{className:"space-y-6",children:n.jsxs($i,{defaultValue:"orchestra",className:"w-full",children:[n.jsxs(Di,{className:"grid w-full grid-cols-7 mb-6 bg-beam-dark-accent/40 border border-gray-700/50 rounded-xl p-1 gap-1",children:[n.jsx(Jt,{value:"orchestra",className:"rounded-lg flex items-center gap-2 data-[state=active]:bg-beam-blue data-[state=active]:text-white",children:"Agent Orchestra"}),n.jsx(Jt,{value:"ran",className:"rounded-lg flex items-center gap-2 data-[state=active]:bg-beam-blue data-[state=active]:text-white",children:"RAN Intelligence"}),n.jsx(Jt,{value:"customer",className:"rounded-lg flex items-center gap-2 data-[state=active]:bg-beam-blue data-[state=active]:text-white",children:"Customer Analytics"}),n.jsx(Jt,{value:"service",className:"rounded-lg flex items-center gap-2 data-[state=active]:bg-beam-blue data-[state=active]:text-white",children:"Service Impact"}),n.jsx(Jt,{value:"core",className:"rounded-lg flex items-center gap-2 data-[state=active]:bg-beam-blue data-[state=active]:text-white",children:"Core Network"}),n.jsx(Jt,{value:"capacity",className:"rounded-lg flex items-center gap-2 data-[state=active]:bg-beam-blue data-[state=active]:text-white",children:"Capacity Analysis"}),n.jsx(Jt,{value:"fleet",className:"rounded-lg flex items-center gap-2 data-[state=active]:bg-beam-blue data-[state=active]:text-white",children:"Agent Fleet"})]}),n.jsx(ur,{value:"orchestra",className:"mt-0",children:n.jsx(gmt,{})}),n.jsx(ur,{value:"ran",className:"mt-0",children:n.jsx(xmt,{})}),n.jsx(ur,{value:"customer",className:"mt-0",children:n.jsx(ymt,{})}),n.jsx(ur,{value:"service",className:"mt-0",children:n.jsx(vmt,{})}),n.jsx(ur,{value:"core",className:"mt-0",children:n.jsxs("div",{className:"glass-panel backdrop-blur-md bg-beam-dark-accent/30 border border-gray-700/50 rounded-xl p-12 text-center",children:[n.jsx(ga,{className:"h-16 w-16 mx-auto mb-4 text-beam-blue"}),n.jsx("h3",{className:"text-xl font-semibold text-white mb-2",children:"Core Network Agent"}),n.jsx("p",{className:"text-gray-400",children:"Advanced core network management coming soon..."})]})}),n.jsx(ur,{value:"capacity",className:"mt-0",children:n.jsxs("div",{className:"glass-panel backdrop-blur-md bg-beam-dark-accent/30 border border-gray-700/50 rounded-xl p-12 text-center",children:[n.jsx(FD,{className:"h-16 w-16 mx-auto mb-4 text-beam-blue"}),n.jsx("h3",{className:"text-xl font-semibold text-white mb-2",children:"Capacity Performance Analyzer"}),n.jsx("p",{className:"text-gray-400",children:"ML-driven capacity analysis coming soon..."})]})}),n.jsx(ur,{value:"fleet",className:"mt-0",children:n.jsx("div",{className:"glass-panel backdrop-blur-md bg-beam-dark-accent/30 border border-gray-700/50 rounded-xl p-6 shadow-lg",children:n.jsxs("div",{className:"flex flex-col gap-6",children:[n.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[n.jsx("h2",{className:"text-xl font-bold text-white",children:"Network Agent Fleet"}),n.jsxs("div",{className:"flex flex-wrap gap-2",children:[n.jsxs(Tt,{variant:"outline",className:"bg-green-500/20 text-green-300 border-green-500/30 px-3 py-1",children:[t.filter(l=>l.status==="active").length," Active"]}),n.jsxs(Tt,{variant:"outline",className:"bg-yellow-500/20 text-yellow-300 border-yellow-500/30 px-3 py-1",children:[t.filter(l=>l.status==="idle").length," Idle"]}),n.jsxs(Tt,{variant:"outline",className:"bg-gray-500/20 text-gray-300 border-gray-500/30 px-3 py-1",children:[t.filter(l=>l.status==="disabled").length," Disabled"]})]})]}),n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:t.map(l=>n.jsx(jt,{className:"bg-beam-dark-accent/50 border-gray-700/50 overflow-hidden",children:n.jsxs("div",{className:"p-4",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[n.jsx("div",{className:"bg-beam-dark-accent/70 p-2 rounded-lg",children:l.icon}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-white font-medium",children:l.name}),n.jsxs("div",{className:"text-xs text-gray-400",children:[l.type.charAt(0).toUpperCase()+l.type.slice(1)," Agent"]})]}),n.jsx("div",{className:"ml-auto",children:n.jsx("div",{className:`h-2.5 w-2.5 rounded-full ${l.status==="active"?"bg-green-500 animate-pulse":l.status==="idle"?"bg-yellow-500":"bg-gray-500"}`})})]}),n.jsx("p",{className:"text-sm text-gray-300 mb-3",children:l.description}),n.jsxs("div",{className:"mb-3",children:[n.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Capabilities:"}),n.jsx("div",{className:"flex flex-wrap gap-1",children:l.capabilities.map((d,s)=>n.jsx(Tt,{variant:"outline",className:"text-xs bg-ptt-red/10 border-ptt-red/20 text-gray-300",children:d},s))})]}),n.jsxs("div",{className:"flex justify-end gap-2 mt-3",children:[l.status!=="active"&&n.jsx(lt,{size:"sm",variant:"outline",className:"bg-green-500/10 hover:bg-green-500/20 border-green-500/30 text-green-300",onClick:()=>i(l.id),children:"Activate"}),l.status==="active"&&n.jsx(lt,{size:"sm",variant:"outline",className:"bg-yellow-500/10 hover:bg-yellow-500/20 border-yellow-500/30 text-yellow-300",onClick:()=>a(l.id),children:"Deactivate"}),n.jsxs(lt,{size:"sm",variant:"outline",className:"bg-ptt-red/10 hover:bg-ptt-red/20 border-ptt-red/30 text-white",children:[n.jsx(eve,{className:"h-4 w-4 mr-1"})," Deploy"]})]})]})},l.id))})]})})})]})})},Xj={kl:{name:"Kuala Lumpur Metro",cellSites:[{id:"KL001",name:"KLCC Twin Towers",type:"macro",coordinates:[101.7117,3.1578],district:"Kuala Lumpur City Centre",region:"Kuala Lumpur",status:"active",congestion:.89,capacity:1200,utilization:1068,technology:"5G",customers:850,revenue:12400,churnRate:.021,avgArpu:145,lastMaintenance:"2024-01-15",nextMaintenance:"2024-07-15",issues:["Peak hour congestion in business district"],performanceScore:88},{id:"KL002",name:"Bukit Bintang Shopping District",type:"micro",coordinates:[101.7103,3.1478],district:"Bukit Bintang",region:"Kuala Lumpur",status:"active",congestion:.94,capacity:800,utilization:752,technology:"Hybrid",customers:720,revenue:9950,churnRate:.028,avgArpu:138,lastMaintenance:"2024-02-08",nextMaintenance:"2024-08-08",issues:["Critical congestion during shopping hours","Mall interference"],performanceScore:79},{id:"KL003",name:"Mont Kiara Residential",type:"small",coordinates:[101.6503,3.1728],district:"Mont Kiara",region:"Kuala Lumpur",status:"active",congestion:.52,capacity:450,utilization:234,technology:"4G",customers:380,revenue:6270,churnRate:.015,avgArpu:165,lastMaintenance:"2024-03-02",nextMaintenance:"2024-09-02",issues:[],performanceScore:93}]},johor:{name:"Johor Bahru Metro",cellSites:[{id:"JB001",name:"JB City Square",type:"macro",coordinates:[103.7414,1.4927],district:"Johor Bahru",region:"Johor",status:"active",congestion:.76,capacity:900,utilization:684,technology:"5G",customers:680,revenue:8700,churnRate:.019,avgArpu:128,lastMaintenance:"2024-01-20",nextMaintenance:"2024-07-20",issues:["Cross-border traffic surge during weekends"],performanceScore:86},{id:"JB002",name:"Skudai University Town",type:"micro",coordinates:[103.6414,1.5327],district:"Skudai",region:"Johor",status:"active",congestion:.68,capacity:600,utilization:408,technology:"Hybrid",customers:520,revenue:6140,churnRate:.022,avgArpu:118,lastMaintenance:"2024-02-15",nextMaintenance:"2024-08-15",issues:["Student area high data usage"],performanceScore:89}]},penang:{name:"Penang Island",cellSites:[{id:"PG001",name:"Georgetown Heritage Zone",type:"macro",coordinates:[100.3414,5.4141],district:"Georgetown",region:"Penang",status:"active",congestion:.71,capacity:700,utilization:497,technology:"5G",customers:580,revenue:7660,churnRate:.017,avgArpu:132,lastMaintenance:"2024-01-25",nextMaintenance:"2024-07-25",issues:["Heritage building restrictions","Tourist area congestion"],performanceScore:87},{id:"PG002",name:"Bayan Lepas Tech Park",type:"micro",coordinates:[100.2814,5.3241],district:"Bayan Lepas",region:"Penang",status:"active",congestion:.59,capacity:550,utilization:325,technology:"Hybrid",customers:450,revenue:6390,churnRate:.02,avgArpu:142,lastMaintenance:"2024-02-18",nextMaintenance:"2024-08-18",issues:[],performanceScore:91}]},sabah:{name:"Kota Kinabalu Metro",cellSites:[{id:"KK001",name:"KK City Centre",type:"macro",coordinates:[116.0753,5.9789],district:"Kota Kinabalu",region:"Sabah",status:"active",congestion:.74,capacity:600,utilization:444,technology:"5G",customers:420,revenue:5250,churnRate:.023,avgArpu:125,lastMaintenance:"2024-01-30",nextMaintenance:"2024-07-30",issues:["Remote location challenges"],performanceScore:84}]}};Xj.kl.cellSites;const _mt=[{id:"agent-001",name:"Network Topology Analyzer",type:"topology",status:"active",description:"Analyzes network structure, connectivity patterns, and identifies optimization opportunities",capabilities:["Topology Mapping","Connection Analysis","Path Optimization","Redundancy Assessment"],metrics:{accuracy:94,reliability:97,speed:89,coverage:92},lastDeployed:"2024-01-20T10:30:00Z",deploymentHistory:[{date:"2024-01-20",duration:45,result:"Success",impact:"Identified 3 optimization opportunities"},{date:"2024-01-15",duration:52,result:"Success",impact:"Mapped 250+ network connections"}],currentTask:"Analyzing Central Jakarta topology",queuedTasks:2},{id:"agent-002",name:"Customer Churn Predictor",type:"churn-analysis",status:"busy",description:"Predicts customer churn risk based on network performance and usage patterns",capabilities:["Churn Prediction","Risk Scoring","Behavior Analysis","Retention Recommendations"],metrics:{accuracy:91,reliability:88,speed:93,coverage:87},lastDeployed:"2024-01-22T14:15:00Z",deploymentHistory:[{date:"2024-01-22",duration:120,result:"In Progress",impact:"Processing 15,000 customer profiles"},{date:"2024-01-18",duration:95,result:"Success",impact:"Identified 450 high-risk customers"}],currentTask:"Processing churn risk analysis for South Jakarta",queuedTasks:5},{id:"agent-003",name:"Capacity Optimizer",type:"capacity",status:"idle",description:"Optimizes network capacity allocation and predicts future capacity requirements",capabilities:["Capacity Planning","Load Balancing","Resource Optimization","Forecasting"],metrics:{accuracy:96,reliability:94,speed:78,coverage:89},lastDeployed:"2024-01-19T09:45:00Z",deploymentHistory:[{date:"2024-01-19",duration:180,result:"Success",impact:"Optimized capacity for 12 high-traffic sites"}],queuedTasks:1},{id:"agent-004",name:"Service Quality Monitor",type:"quality",status:"active",description:"Monitors service quality metrics and identifies performance degradation",capabilities:["QoS Monitoring","Performance Analysis","SLA Tracking","Alert Generation"],metrics:{accuracy:98,reliability:96,speed:95,coverage:94},lastDeployed:"2024-01-22T16:00:00Z",deploymentHistory:[{date:"2024-01-22",duration:30,result:"Success",impact:"Detected 2 performance anomalies"}],currentTask:"Real-time quality monitoring",queuedTasks:0}],wmt=({isOpen:e,onClose:t,agentId:r,onDeploy:i,onStop:a})=>{const l=_mt.find(x=>x.id===r);if(!l)return null;const d=x=>{switch(x){case"active":return n.jsx(bs,{className:"h-4 w-4 text-green-500"});case"busy":return n.jsx(Yi,{className:"h-4 w-4 text-yellow-500"});case"idle":return n.jsx($a,{className:"h-4 w-4 text-gray-500"});case"error":return n.jsx(ub,{className:"h-4 w-4 text-red-500"});default:return n.jsx($a,{className:"h-4 w-4 text-gray-500"})}},s=x=>{switch(x){case"active":return"bg-green-500/20 text-green-400 border-green-500/50";case"busy":return"bg-yellow-500/20 text-yellow-400 border-yellow-500/50";case"idle":return"bg-gray-500/20 text-gray-400 border-gray-500/50";case"error":return"bg-red-500/20 text-red-400 border-red-500/50";default:return"bg-gray-500/20 text-gray-400 border-gray-500/50"}},p=()=>{l.status==="active"||l.status==="busy"?a==null||a(r):i==null||i(r)};return n.jsx(Ml,{open:e,onOpenChange:t,children:n.jsxs(Qo,{className:"max-w-4xl max-h-[90vh] overflow-y-auto bg-beam-dark border-gray-700",children:[n.jsx(el,{children:n.jsxs(tl,{className:"text-xl font-bold text-white flex items-center gap-3",children:[d(l.status),l.name,n.jsx(Tt,{className:`ml-2 ${s(l.status)}`,children:l.status.toUpperCase()})]})}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mt-6",children:[n.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[n.jsxs(jt,{className:"p-4 bg-beam-dark-accent/50 border-gray-700",children:[n.jsx("h3",{className:"text-lg font-semibold text-white mb-3",children:"Agent Overview"}),n.jsx("p",{className:"text-gray-300 mb-4",children:l.description}),l.currentTask&&n.jsxs("div",{className:"bg-beam-dark-accent/30 p-3 rounded-lg border border-gray-700/50",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx(bs,{className:"h-4 w-4 text-ptt-blue"}),n.jsx("span",{className:"text-sm font-medium text-white",children:"Current Task"})]}),n.jsx("p",{className:"text-sm text-gray-300",children:l.currentTask})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-4",children:[n.jsxs("div",{className:"bg-beam-dark-accent/30 p-3 rounded-lg",children:[n.jsx("div",{className:"text-sm text-gray-400",children:"Queued Tasks"}),n.jsx("div",{className:"text-xl font-bold text-white",children:l.queuedTasks})]}),n.jsxs("div",{className:"bg-beam-dark-accent/30 p-3 rounded-lg",children:[n.jsx("div",{className:"text-sm text-gray-400",children:"Last Deployed"}),n.jsx("div",{className:"text-sm text-white",children:new Date(l.lastDeployed).toLocaleDateString()})]})]})]}),n.jsxs(jt,{className:"p-4 bg-beam-dark-accent/50 border-gray-700",children:[n.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Performance Metrics"}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Ch,{className:"h-4 w-4 text-ptt-blue"}),n.jsx("span",{className:"text-sm text-white",children:"Accuracy"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(vn,{value:l.metrics.accuracy,className:"w-24"}),n.jsxs("span",{className:"text-sm text-white",children:[l.metrics.accuracy,"%"]})]})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(dn,{className:"h-4 w-4 text-ptt-blue"}),n.jsx("span",{className:"text-sm text-white",children:"Reliability"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(vn,{value:l.metrics.reliability,className:"w-24"}),n.jsxs("span",{className:"text-sm text-white",children:[l.metrics.reliability,"%"]})]})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Yi,{className:"h-4 w-4 text-ptt-blue"}),n.jsx("span",{className:"text-sm text-white",children:"Speed"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(vn,{value:l.metrics.speed,className:"w-24"}),n.jsxs("span",{className:"text-sm text-white",children:[l.metrics.speed,"%"]})]})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(En,{className:"h-4 w-4 text-ptt-blue"}),n.jsx("span",{className:"text-sm text-white",children:"Coverage"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(vn,{value:l.metrics.coverage,className:"w-24"}),n.jsxs("span",{className:"text-sm text-white",children:[l.metrics.coverage,"%"]})]})]})]})]}),n.jsxs(jt,{className:"p-4 bg-beam-dark-accent/50 border-gray-700",children:[n.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Recent Deployments"}),n.jsx("div",{className:"space-y-3",children:l.deploymentHistory.map((x,w)=>n.jsxs("div",{className:"bg-beam-dark-accent/30 p-3 rounded-lg border border-gray-700/50",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ro,{className:"h-4 w-4 text-green-500"}),n.jsx("span",{className:"text-sm font-medium text-white",children:new Date(x.date).toLocaleDateString()})]}),n.jsxs(Tt,{variant:"outline",className:"text-xs",children:[x.duration,"min"]})]}),n.jsx("p",{className:"text-sm text-gray-300",children:x.impact})]},w))})]})]}),n.jsxs("div",{className:"space-y-6",children:[n.jsxs(jt,{className:"p-4 bg-beam-dark-accent/50 border-gray-700",children:[n.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Capabilities"}),n.jsx("div",{className:"space-y-2",children:l.capabilities.map((x,w)=>n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ro,{className:"h-4 w-4 text-green-500"}),n.jsx("span",{className:"text-sm text-gray-300",children:x})]},w))})]}),n.jsxs(jt,{className:"p-4 bg-beam-dark-accent/50 border-gray-700",children:[n.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Actions"}),n.jsxs("div",{className:"space-y-3",children:[n.jsx(lt,{onClick:p,className:`w-full ${l.status==="active"||l.status==="busy"?"bg-red-600 hover:bg-red-700":"bg-ptt-blue hover:bg-blue-700"}`,children:l.status==="active"||l.status==="busy"?"Stop Agent":"Deploy Agent"}),n.jsx(lt,{variant:"outline",className:"w-full border-gray-600 text-white hover:bg-gray-700",children:"Configure Settings"}),n.jsx(lt,{variant:"outline",className:"w-full border-gray-600 text-white hover:bg-gray-700",children:"View Logs"}),n.jsx(lt,{variant:"outline",className:"w-full border-gray-600 text-white hover:bg-gray-700",children:"Download Report"})]})]}),n.jsxs(jt,{className:"p-4 bg-beam-dark-accent/50 border-gray-700",children:[n.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Quick Stats"}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-sm text-gray-400",children:"Total Deployments"}),n.jsx("span",{className:"text-sm font-medium text-white",children:l.deploymentHistory.length})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-sm text-gray-400",children:"Success Rate"}),n.jsxs("span",{className:"text-sm font-medium text-white",children:[Math.round(l.deploymentHistory.filter(x=>x.result==="Success").length/l.deploymentHistory.length*100),"%"]})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-sm text-gray-400",children:"Avg Duration"}),n.jsxs("span",{className:"text-sm font-medium text-white",children:[Math.round(l.deploymentHistory.reduce((x,w)=>x+w.duration,0)/l.deploymentHistory.length),"min"]})]})]})]})]})]})]})})},jmt=({isOpen:e,onClose:t,siteData:r,onOptimize:i,onMaintenance:a})=>{const l=x=>{switch(x){case"active":return n.jsx(Ov,{className:"h-4 w-4 text-green-500"});case"maintenance":return n.jsx(Vc,{className:"h-4 w-4 text-yellow-500"});case"inactive":return n.jsx(fs,{className:"h-4 w-4 text-red-500"});default:return n.jsx(Ov,{className:"h-4 w-4 text-gray-500"})}},d=x=>{switch(x){case"active":return"bg-green-500/20 text-green-400 border-green-500/50";case"maintenance":return"bg-yellow-500/20 text-yellow-400 border-yellow-500/50";case"inactive":return"bg-red-500/20 text-red-400 border-red-500/50";default:return"bg-gray-500/20 text-gray-400 border-gray-500/50"}},s=x=>x>.8?"text-red-400":x>.6?"text-yellow-400":"text-green-400",p=x=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(x);return n.jsx(Ml,{open:e,onOpenChange:t,children:n.jsxs(Qo,{className:"max-w-5xl max-h-[90vh] overflow-y-auto bg-beam-dark border-gray-700",children:[n.jsx(el,{children:n.jsxs(tl,{className:"text-xl font-bold text-white flex items-center gap-3",children:[n.jsx(kc,{className:"h-6 w-6 text-ptt-blue"}),r.name,n.jsx(Tt,{className:`ml-2 ${d(r.status)}`,children:r.status.toUpperCase()})]})}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mt-6",children:[n.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[n.jsxs(jt,{className:"p-4 bg-beam-dark-accent/50 border-gray-700",children:[n.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Site Information"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ex,{className:"h-4 w-4 text-ptt-blue"}),n.jsx("span",{className:"text-sm text-gray-400",children:"Site ID:"}),n.jsx("span",{className:"text-sm font-medium text-white",children:r.id})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(kc,{className:"h-4 w-4 text-ptt-blue"}),n.jsx("span",{className:"text-sm text-gray-400",children:"Type:"}),n.jsx("span",{className:"text-sm font-medium text-white capitalize",children:r.type})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Ov,{className:"h-4 w-4 text-ptt-blue"}),n.jsx("span",{className:"text-sm text-gray-400",children:"Technology:"}),n.jsx(Tt,{variant:"outline",className:"text-xs",children:r.technology})]})]}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{children:[n.jsx("span",{className:"text-sm text-gray-400",children:"District:"}),n.jsx("span",{className:"text-sm font-medium text-white ml-2",children:r.district})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-sm text-gray-400",children:"Region:"}),n.jsx("span",{className:"text-sm font-medium text-white ml-2",children:r.region})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-sm text-gray-400",children:"Coordinates:"}),n.jsxs("span",{className:"text-sm font-medium text-white ml-2",children:[r.coordinates[1].toFixed(4),", ",r.coordinates[0].toFixed(4)]})]})]})]})]}),n.jsxs(jt,{className:"p-4 bg-beam-dark-accent/50 border-gray-700",children:[n.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Performance Metrics"}),n.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("span",{className:"text-sm text-white",children:"Congestion Level"}),n.jsxs("span",{className:`text-sm font-bold ${s(r.congestion)}`,children:[Math.round(r.congestion*100),"%"]})]}),n.jsx(vn,{value:r.congestion*100,className:"h-2"})]}),n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("span",{className:"text-sm text-white",children:"Capacity Utilization"}),n.jsxs("span",{className:"text-sm font-medium text-white",children:[r.utilization,"/",r.capacity]})]}),n.jsx(vn,{value:r.utilization/r.capacity*100,className:"h-2"})]})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("span",{className:"text-sm text-white",children:"Performance Score"}),n.jsxs("span",{className:"text-sm font-bold text-ptt-blue",children:[r.performanceScore,"/100"]})]}),n.jsx(vn,{value:r.performanceScore,className:"h-2"})]}),n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("span",{className:"text-sm text-white",children:"Churn Rate"}),n.jsxs("span",{className:"text-sm font-medium text-red-400",children:[(r.churnRate*100).toFixed(2),"%"]})]}),n.jsx(vn,{value:r.churnRate*100,className:"h-2"})]})]})]})]}),n.jsxs(jt,{className:"p-4 bg-beam-dark-accent/50 border-gray-700",children:[n.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Business Impact"}),n.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[n.jsxs("div",{className:"bg-beam-dark-accent/30 p-3 rounded-lg text-center",children:[n.jsx(qi,{className:"h-6 w-6 text-ptt-blue mx-auto mb-2"}),n.jsx("div",{className:"text-sm text-gray-400",children:"Active Customers"}),n.jsx("div",{className:"text-lg font-bold text-white",children:r.customers.toLocaleString()})]}),n.jsxs("div",{className:"bg-beam-dark-accent/30 p-3 rounded-lg text-center",children:[n.jsx(sc,{className:"h-6 w-6 text-green-500 mx-auto mb-2"}),n.jsx("div",{className:"text-sm text-gray-400",children:"Monthly Revenue"}),n.jsx("div",{className:"text-lg font-bold text-white",children:p(r.revenue)})]}),n.jsxs("div",{className:"bg-beam-dark-accent/30 p-3 rounded-lg text-center",children:[n.jsx(En,{className:"h-6 w-6 text-blue-500 mx-auto mb-2"}),n.jsx("div",{className:"text-sm text-gray-400",children:"Avg ARPU"}),n.jsx("div",{className:"text-lg font-bold text-white",children:p(r.avgArpu)})]})]})]}),r.issues.length>0&&n.jsxs(jt,{className:"p-4 bg-beam-dark-accent/50 border-gray-700",children:[n.jsxs("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center gap-2",children:[n.jsx(fs,{className:"h-5 w-5 text-yellow-500"}),"Active Issues"]}),n.jsx("div",{className:"space-y-2",children:r.issues.map((x,w)=>n.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/30 p-3 rounded-lg",children:n.jsx("p",{className:"text-sm text-yellow-200",children:x})},w))})]})]}),n.jsxs("div",{className:"space-y-6",children:[n.jsxs(jt,{className:"p-4 bg-beam-dark-accent/50 border-gray-700",children:[n.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Maintenance Schedule"}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"bg-beam-dark-accent/30 p-3 rounded-lg",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx(xh,{className:"h-4 w-4 text-ptt-blue"}),n.jsx("span",{className:"text-sm font-medium text-white",children:"Last Maintenance"})]}),n.jsx("p",{className:"text-sm text-gray-300",children:new Date(r.lastMaintenance).toLocaleDateString()})]}),n.jsxs("div",{className:"bg-beam-dark-accent/30 p-3 rounded-lg",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx(xh,{className:"h-4 w-4 text-ptt-blue"}),n.jsx("span",{className:"text-sm font-medium text-white",children:"Next Scheduled"})]}),n.jsx("p",{className:"text-sm text-gray-300",children:new Date(r.nextMaintenance).toLocaleDateString()})]})]})]}),n.jsxs(jt,{className:"p-4 bg-beam-dark-accent/50 border-gray-700",children:[n.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Quick Actions"}),n.jsxs("div",{className:"space-y-3",children:[n.jsx(lt,{onClick:()=>i==null?void 0:i(r.id),className:"w-full bg-ptt-blue hover:bg-blue-700",disabled:r.status!=="active",children:"Optimize Performance"}),n.jsx(lt,{onClick:()=>a==null?void 0:a(r.id),variant:"outline",className:"w-full border-gray-600 text-white hover:bg-gray-700",children:"Schedule Maintenance"}),n.jsx(lt,{variant:"outline",className:"w-full border-gray-600 text-white hover:bg-gray-700",children:"View Analytics"}),n.jsx(lt,{variant:"outline",className:"w-full border-gray-600 text-white hover:bg-gray-700",children:"Generate Report"})]})]}),n.jsxs(jt,{className:"p-4 bg-beam-dark-accent/50 border-gray-700",children:[n.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Site Health"}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-sm text-gray-400",children:"Overall Status"}),n.jsxs("div",{className:"flex items-center gap-2",children:[l(r.status),n.jsx("span",{className:"text-sm text-white capitalize",children:r.status})]})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-sm text-gray-400",children:"Alert Level"}),n.jsx("span",{className:`text-sm font-medium ${r.issues.length>0?"text-yellow-400":"text-green-400"}`,children:r.issues.length>0?"Attention Needed":"Normal"})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-sm text-gray-400",children:"Efficiency"}),n.jsxs("span",{className:"text-sm font-medium text-white",children:[Math.round(r.revenue/r.customers*100)/100,"%"]})]})]})]})]})]})]})})},Nmt=()=>{const[e,t]=U.useState({activeTab:"topology",selectedNetwork:"kl",selectedRegion:"all",selectedDistrict:"all",selectedAgent:null,selectedSiteId:null,selectedModel:"churn",selectedView:"physical",modalType:null,modalData:null}),r=U.useCallback(w=>{t(j=>({...j,...w}))},[]),i=U.useCallback(w=>{r({activeTab:"agents",selectedAgent:w,modalType:"agent-detail",modalData:{agentId:w}})},[r]),a=U.useCallback((w,j)=>{r({selectedSiteId:w,modalType:"site-detail",modalData:j})},[r]),l=U.useCallback(w=>{r({activeTab:"simulation",modalType:"simulation-results",modalData:w})},[r]),d=U.useCallback((w,j)=>{r({activeTab:"analysis",modalType:"analysis-report",modalData:{type:w,data:j}})},[r]),s=U.useCallback(()=>{r({modalType:null,modalData:null})},[r]),p=U.useCallback(w=>{r({activeTab:w})},[r]),x=U.useCallback(w=>{r({selectedNetwork:w,selectedSiteId:null,selectedAgent:null,modalType:null,modalData:null})},[r]);return{navState:e,updateNavState:r,navigateToAgent:i,navigateToSite:a,navigateToSimulation:l,navigateToAnalysis:d,closeModal:s,setActiveTab:p,switchNetwork:x}};function Smt({selectedNetwork:e,onNetworkChange:t}){const[r,i]=U.useState(!1),a=Xj[e],l=d=>{const p=Xj[d].cellSites;return{totalSites:p.length,activeSites:p.filter(x=>x.status==="active").length,totalCustomers:p.reduce((x,w)=>x+w.customers,0),avgPerformance:Math.round(p.reduce((x,w)=>x+w.performanceScore,0)/p.length)}};return n.jsxs(jt,{className:"w-full",children:[n.jsx(wr,{className:"pb-3",children:n.jsxs(fr,{className:"flex items-center gap-2 text-lg",children:[n.jsx(ga,{className:"h-5 w-5 text-primary"}),"Network Selection"]})}),n.jsxs(Ht,{className:"space-y-4",children:[n.jsxs(Ip,{open:r,onOpenChange:i,children:[n.jsx(Op,{asChild:!0,children:n.jsxs(lt,{variant:"outline",className:"w-full justify-between bg-background",onClick:()=>i(!r),children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ex,{className:"h-4 w-4"}),a.name]}),n.jsx(Na,{className:`h-4 w-4 transition-transform ${r?"rotate-180":""}`})]})}),n.jsx(_m,{className:"w-full min-w-[300px] bg-background border border-border",align:"start",children:Object.entries(Xj).map(([d,s])=>{const p=l(d);return n.jsx(Ao,{onClick:()=>{t(d),i(!1)},className:"cursor-pointer p-3 focus:bg-muted",children:n.jsxs("div",{className:"flex flex-col gap-1 w-full",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"font-medium",children:s.name}),e===d&&n.jsx(Tt,{variant:"secondary",className:"text-xs",children:"Current"})]}),n.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[n.jsxs("span",{children:[p.totalSites," sites"]}),n.jsxs("span",{children:[p.totalCustomers.toLocaleString()," customers"]}),n.jsxs("span",{children:[p.avgPerformance,"% avg performance"]})]})]})},d)})})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("div",{className:"space-y-1",children:[n.jsx("div",{className:"text-xs text-muted-foreground",children:"Total Sites"}),n.jsx("div",{className:"text-lg font-semibold",children:l(e).totalSites})]}),n.jsxs("div",{className:"space-y-1",children:[n.jsx("div",{className:"text-xs text-muted-foreground",children:"Active Sites"}),n.jsx("div",{className:"text-lg font-semibold text-green-500",children:l(e).activeSites})]}),n.jsxs("div",{className:"space-y-1",children:[n.jsx("div",{className:"text-xs text-muted-foreground",children:"Customers"}),n.jsx("div",{className:"text-lg font-semibold",children:l(e).totalCustomers.toLocaleString()})]}),n.jsx("div",{className:"space-y-1 flex items-center gap-1",children:n.jsxs("div",{children:[n.jsx("div",{className:"text-xs text-muted-foreground",children:"Performance"}),n.jsxs("div",{className:"text-lg font-semibold flex items-center gap-1",children:[l(e).avgPerformance,"%",n.jsx(bs,{className:"h-3 w-3 text-primary"})]})]})})]})]})]})}const Cmt=()=>{const{toast:e}=Ah(),{navState:t,navigateToAgent:r,navigateToSite:i,navigateToSimulation:a,navigateToAnalysis:l,closeModal:d,setActiveTab:s,switchNetwork:p}=Nmt(),x=B=>{e({title:"Agent Deployed",description:`Agent ${B} has been successfully deployed.`})},w=B=>{e({title:"Agent Stopped",description:`Agent ${B} has been stopped.`})},j=B=>{e({title:"Optimization Started",description:`Performance optimization initiated for site ${B}.`})},S=B=>{e({title:"Maintenance Scheduled",description:`Maintenance has been scheduled for site ${B}.`})},P=(B,V)=>{l(B,V),s("analysis")},F=Xj[t.selectedNetwork],L=t.selectedSiteId?F.cellSites.find(B=>B.id===t.selectedSiteId):null;return n.jsx("div",{className:"flex-1 h-screen overflow-y-auto bg-beam-dark bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-gray-900 via-beam-dark to-beam-dark text-beam-text",children:n.jsx("div",{className:"p-6 md:p-8",children:n.jsxs("div",{className:"flex gap-6",children:[n.jsx("div",{className:"w-80 flex-shrink-0",children:n.jsx(Smt,{selectedNetwork:t.selectedNetwork,onNetworkChange:p})}),n.jsxs("div",{className:"flex-1 flex flex-col gap-6",children:[n.jsx(amt,{}),n.jsxs($i,{defaultValue:"topology",value:t.activeTab,onValueChange:s,className:"w-full",children:[n.jsxs(Di,{className:"grid grid-cols-4 mb-6 bg-beam-dark-accent/40 border border-gray-700/50 rounded-xl p-1 gap-1",children:[n.jsx(Jt,{value:"topology",className:"rounded-lg flex items-center gap-2 data-[state=active]:bg-beam-blue data-[state=active]:text-white data-[state=active]:shadow-md",children:"Network Topology"}),n.jsx(Jt,{value:"agents",className:"rounded-lg flex items-center gap-2 data-[state=active]:bg-beam-blue data-[state=active]:text-white data-[state=active]:shadow-md",children:"Network Agents"}),n.jsx(Jt,{value:"simulation",className:"rounded-lg flex items-center gap-2 data-[state=active]:bg-beam-blue data-[state=active]:text-white data-[state=active]:shadow-md",children:"Simulation & Forecasting"}),n.jsx(Jt,{value:"analysis",className:"rounded-lg flex items-center gap-2 data-[state=active]:bg-beam-blue data-[state=active]:text-white data-[state=active]:shadow-md",children:"Cross-Dimensional Analysis"})]}),n.jsx(ur,{value:"topology",className:"mt-0",children:n.jsx(fmt,{cellSites:F.cellSites,onSiteClick:i,onAnalysisClick:P})}),n.jsx(ur,{value:"agents",className:"mt-0",children:n.jsx(bmt,{onAgentClick:r})}),n.jsx(ur,{value:"simulation",className:"mt-0",children:n.jsx(lmt,{onSimulationComplete:a})}),n.jsx(ur,{value:"analysis",className:"mt-0",children:n.jsx(pmt,{})})]}),t.modalType==="agent-detail"&&t.selectedAgent&&n.jsx(wmt,{isOpen:!0,onClose:d,agentId:t.selectedAgent,onDeploy:x,onStop:w}),t.modalType==="site-detail"&&L&&n.jsx(jmt,{isOpen:!0,onClose:d,siteData:L,onOptimize:j,onMaintenance:S})]})]})})})};function Amt(){const e=[{label:"Portfolio Risk Score",value:"7.2/10",trend:"up",color:"text-red-500"},{label:"Credit Risk Exposure",value:"$2.4M",trend:"down",color:"text-green-500"},{label:"Market Volatility",value:"15.3%",trend:"up",color:"text-yellow-500"},{label:"Compliance Score",value:"94%",trend:"stable",color:"text-blue-500"}],t=[{name:"Credit Risk Analyzer",status:"active",description:"AI agent analyzing credit portfolios and default probabilities",metrics:{accuracy:"94%",processed:"1,247",alerts:23}},{name:"Market Risk Monitor",status:"active",description:"Real-time market risk assessment and volatility tracking",metrics:{accuracy:"91%",processed:"856",alerts:12}},{name:"Operational Risk Guard",status:"active",description:"Operational risk detection and process compliance monitoring",metrics:{accuracy:"97%",processed:"2,134",alerts:8}},{name:"Regulatory Compliance Bot",status:"active",description:"Automated regulatory compliance checking and reporting",metrics:{accuracy:"99%",processed:"567",alerts:3}}],r=[{type:"High",message:"Credit concentration risk detected in Tech sector",time:"2 min ago"},{type:"Medium",message:"Market volatility spike in emerging markets",time:"15 min ago"},{type:"Low",message:"Compliance review required for new regulations",time:"1 hour ago"},{type:"Medium",message:"Operational risk threshold exceeded in trading",time:"2 hours ago"}];return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsxs("h1",{className:"text-3xl font-bold text-white flex items-center gap-3",children:[n.jsx(En,{className:"w-8 h-8 text-red-500"}),"Risk Analytics"]}),n.jsx("p",{className:"text-gray-400 mt-2",children:"AI-powered risk assessment and monitoring across all business units"})]}),n.jsxs("div",{className:"flex gap-3",children:[n.jsxs(lt,{variant:"outline",className:"text-white border-gray-600",children:[n.jsx(to,{className:"w-4 h-4 mr-2"}),"Generate Report"]}),n.jsxs(lt,{className:"bg-red-600 hover:bg-red-700",children:[n.jsx(fs,{className:"w-4 h-4 mr-2"}),"Risk Dashboard"]})]})]}),n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:e.map((i,a)=>n.jsx(jt,{className:"bg-gray-800 border-gray-700",children:n.jsx(Ht,{className:"p-6",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-400",children:i.label}),n.jsx("p",{className:`text-2xl font-bold ${i.color}`,children:i.value})]}),n.jsx("div",{className:"p-3 bg-gray-700 rounded-lg",children:i.trend==="up"?n.jsx(En,{className:"w-6 h-6 text-red-500"}):i.trend==="down"?n.jsx(En,{className:"w-6 h-6 text-green-500 rotate-180"}):n.jsx(bs,{className:"w-6 h-6 text-blue-500"})})]})})},a))}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[n.jsxs(jt,{className:"bg-gray-800 border-gray-700",children:[n.jsx(wr,{children:n.jsxs(fr,{className:"text-white flex items-center gap-2",children:[n.jsx(ti,{className:"w-5 h-5 text-red-500"}),"Active Risk Agents"]})}),n.jsx(Ht,{className:"space-y-4",children:t.map((i,a)=>n.jsxs("div",{className:"p-4 bg-gray-700 rounded-lg",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("h3",{className:"font-semibold text-white",children:i.name}),n.jsx(Tt,{variant:"secondary",className:"bg-green-600 text-white",children:i.status})]}),n.jsx("p",{className:"text-sm text-gray-300 mb-3",children:i.description}),n.jsxs("div",{className:"flex gap-4 text-xs",children:[n.jsxs("span",{className:"text-green-400",children:["Accuracy: ",i.metrics.accuracy]}),n.jsxs("span",{className:"text-blue-400",children:["Processed: ",i.metrics.processed]}),n.jsxs("span",{className:"text-yellow-400",children:["Alerts: ",i.metrics.alerts]})]})]},a))})]}),n.jsxs(jt,{className:"bg-gray-800 border-gray-700",children:[n.jsx(wr,{children:n.jsxs(fr,{className:"text-white flex items-center gap-2",children:[n.jsx(fs,{className:"w-5 h-5 text-yellow-500"}),"Recent Risk Alerts"]})}),n.jsx(Ht,{className:"space-y-3",children:r.map((i,a)=>n.jsxs("div",{className:"p-3 bg-gray-700 rounded-lg",children:[n.jsxs("div",{className:"flex items-center justify-between mb-1",children:[n.jsx(Tt,{variant:"secondary",className:i.type==="High"?"bg-red-600 text-white":i.type==="Medium"?"bg-yellow-600 text-white":"bg-blue-600 text-white",children:i.type}),n.jsx("span",{className:"text-xs text-gray-400",children:i.time})]}),n.jsx("p",{className:"text-sm text-gray-300",children:i.message})]},a))})]})]}),n.jsxs(jt,{className:"bg-gray-800 border-gray-700",children:[n.jsx(wr,{children:n.jsxs(fr,{className:"text-white flex items-center gap-2",children:[n.jsx(dn,{className:"w-5 h-5 text-blue-500"}),"Risk Analysis Tools"]})}),n.jsx(Ht,{children:n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[n.jsxs("div",{className:"p-4 bg-gray-700 rounded-lg text-center",children:[n.jsx(sc,{className:"w-8 h-8 text-green-500 mx-auto mb-2"}),n.jsx("h3",{className:"font-semibold text-white mb-1",children:"Credit Risk Models"}),n.jsx("p",{className:"text-sm text-gray-300",children:"Advanced ML models for credit assessment"}),n.jsx(lt,{variant:"outline",size:"sm",className:"mt-3 text-white border-gray-600",children:"Configure"})]}),n.jsxs("div",{className:"p-4 bg-gray-700 rounded-lg text-center",children:[n.jsx(to,{className:"w-8 h-8 text-blue-500 mx-auto mb-2"}),n.jsx("h3",{className:"font-semibold text-white mb-1",children:"Market Risk Analytics"}),n.jsx("p",{className:"text-sm text-gray-300",children:"Real-time market risk monitoring"}),n.jsx(lt,{variant:"outline",size:"sm",className:"mt-3 text-white border-gray-600",children:"Configure"})]}),n.jsxs("div",{className:"p-4 bg-gray-700 rounded-lg text-center",children:[n.jsx(qi,{className:"w-8 h-8 text-purple-500 mx-auto mb-2"}),n.jsx("h3",{className:"font-semibold text-white mb-1",children:"Operational Risk"}),n.jsx("p",{className:"text-sm text-gray-300",children:"Process and operational risk detection"}),n.jsx(lt,{variant:"outline",size:"sm",className:"mt-3 text-white border-gray-600",children:"Configure"})]})]})})]})]})}const Tmt=()=>{const[e,t]=U.useState(""),[r,i]=U.useState(""),[a,l]=U.useState(!1),[d,s]=U.useState("login"),p=eB();U.useEffect(()=>{if(d==="login"){const j=setTimeout(()=>{p("/")},500);return()=>clearTimeout(j)}},[d,p]);const x=j=>{j.preventDefault(),l(!0),setTimeout(()=>{Ls.success("Logged in successfully"),p("/")},500)},w=j=>{j.preventDefault(),l(!0),setTimeout(()=>{Ls.success("Account created! Redirecting to dashboard"),p("/")},500)};return n.jsx("div",{className:"flex items-center justify-center min-h-screen bg-beam-dark bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-gray-900 via-beam-dark to-beam-dark",children:n.jsxs(jt,{className:"w-[400px] bg-beam-dark-accent/30 border-gray-700/50",children:[n.jsxs(wr,{className:"space-y-1",children:[n.jsx("div",{className:"flex items-center justify-center mb-4",children:n.jsx("div",{className:"flex items-center justify-center w-12 h-12 bg-true-red rounded-lg",children:n.jsx(m_,{className:"h-7 w-7 text-white"})})}),n.jsx(fr,{className:"text-2xl text-white text-center",children:"Banking Agent OS"}),n.jsx(Ii,{className:"text-center text-gray-400",children:"Secure access to your banking AI platform"})]}),n.jsxs(Ht,{className:"space-y-4",children:[n.jsxs($i,{value:d,onValueChange:s,children:[n.jsxs(Di,{className:"grid w-full grid-cols-2 mb-4 bg-beam-dark/70 border border-gray-700/50",children:[n.jsx(Jt,{value:"login",children:"Login"}),n.jsx(Jt,{value:"signup",children:"Sign Up"})]}),n.jsx(ur,{value:"login",children:n.jsxs("form",{onSubmit:x,className:"space-y-4",children:[n.jsx("div",{className:"space-y-2",children:n.jsx(An,{type:"email",placeholder:"Email",value:e,onChange:j=>t(j.target.value),className:"bg-beam-dark/70 border-gray-700/50 text-white"})}),n.jsx("div",{className:"space-y-2",children:n.jsx(An,{type:"password",placeholder:"Password",value:r,onChange:j=>i(j.target.value),className:"bg-beam-dark/70 border-gray-700/50 text-white"})}),n.jsx(lt,{type:"submit",className:"w-full",disabled:a,children:a?"Logging in...":"Login"})]})}),n.jsx(ur,{value:"signup",children:n.jsxs("form",{onSubmit:w,className:"space-y-4",children:[n.jsx("div",{className:"space-y-2",children:n.jsx(An,{type:"email",placeholder:"Email",value:e,onChange:j=>t(j.target.value),className:"bg-beam-dark/70 border-gray-700/50 text-white"})}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(An,{type:"password",placeholder:"Password",value:r,onChange:j=>i(j.target.value),className:"bg-beam-dark/70 border-gray-700/50 text-white"}),n.jsx("p",{className:"text-xs text-gray-400",children:"Password must be at least 6 characters"})]}),n.jsx(lt,{type:"submit",className:"w-full",disabled:a,children:a?"Creating account...":"Create account"})]})})]}),n.jsxs(x$,{className:"bg-blue-900/20 border-blue-900/50 text-blue-300",children:[n.jsx(f_,{className:"h-4 w-4"}),n.jsx(y$,{children:"For this demo: selecting Login will automatically redirect you to the banking dashboard. No actual authentication is performed."})]})]}),n.jsx(WE,{className:"flex justify-center",children:n.jsx("p",{className:"text-sm text-gray-400",children:d==="login"?"Don't have an account? Switch to Sign Up tab":"Already have an account? Switch to Login tab"})})]})})},kmt=()=>{const{currentIndustry:e,setIndustry:t,availableIndustries:r}=b_(),[i,a]=U.useState(e.logo),[l,d]=U.useState(e.logo),[s,p]=U.useState(!1),[x,w]=U.useState(!1),j=U.useRef(null),S=async B=>{var $;const V=($=B.target.files)==null?void 0:$[0];if(V){if(!V.type.startsWith("image/")){Ls.error("Please select a valid image file");return}if(V.size>2*1024*1024){Ls.error("File size must be less than 2MB");return}p(!0);try{const G=new FileReader;G.onload=W=>{var se;const Z=(se=W.target)==null?void 0:se.result;d(Z),a(Z),p(!1),Ls.success("Logo uploaded successfully")},G.readAsDataURL(V)}catch{p(!1),Ls.error("Failed to upload logo")}}},P=B=>{a(B),d(B)},F=()=>{const B={...e,logo:i};t(B),localStorage.setItem("customLogo",i),localStorage.setItem("industryConfig",JSON.stringify(B)),Ls.success("Logo updated successfully!"),w(!1)},L=()=>{const B=r.find($=>$.id===e.id),V=(B==null?void 0:B.logo)||"https://aws.amazon.com/favicon.ico";a(V),d(V),localStorage.removeItem("customLogo"),Ls.info("Logo reset to default")};return n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"flex items-center justify-center w-12 h-12 bg-white rounded-lg p-1",children:n.jsx("img",{src:l,alt:"Current Logo",className:"w-full h-full object-contain",onError:B=>{const V=B.target;V.src="https://aws.amazon.com/favicon.ico"}})}),n.jsxs("div",{children:[n.jsx("p",{className:"text-white text-sm font-medium",children:"Current Logo"}),n.jsx("p",{className:"text-gray-400 text-xs",children:e.displayName})]})]}),n.jsxs(lt,{variant:"outline",size:"sm",onClick:()=>w(!x),className:"border-gray-600 text-white hover:bg-gray-800",children:[n.jsx(EQ,{className:"h-4 w-4 mr-2"}),"Change Logo"]})]}),x&&n.jsxs("div",{className:"space-y-4 p-4 bg-gray-800/50 rounded-lg border border-gray-700",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(mr,{className:"text-white text-sm",children:"Upload File"}),n.jsx("input",{ref:j,type:"file",accept:"image/*",onChange:S,className:"hidden"}),n.jsx(lt,{variant:"outline",onClick:()=>{var B;return(B=j.current)==null?void 0:B.click()},disabled:s,className:"w-full border-gray-600 text-white hover:bg-gray-800",size:"sm",children:s?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-white mr-2"}),"Uploading..."]}):n.jsxs(n.Fragment,{children:[n.jsx(Ive,{className:"h-3 w-3 mr-2"}),"Choose File"]})})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(mr,{className:"text-white text-sm",children:"Logo URL"}),n.jsxs("div",{className:"flex gap-1",children:[n.jsx(An,{value:i,onChange:B=>P(B.target.value),placeholder:"https://example.com/logo.png",className:"bg-gray-800 border-gray-600 text-white text-sm",size:"sm"}),n.jsx(lt,{variant:"outline",size:"sm",onClick:()=>d(i),className:"border-gray-600 text-white hover:bg-gray-800 px-2",children:n.jsx(mh,{className:"h-3 w-3"})})]})]})]}),n.jsxs("div",{className:"flex justify-between pt-2 border-t border-gray-700",children:[n.jsxs(lt,{variant:"outline",onClick:L,size:"sm",className:"border-gray-600 text-white hover:bg-gray-800",children:[n.jsx(vx,{className:"h-3 w-3 mr-2"}),"Reset"]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs(lt,{variant:"outline",onClick:()=>{a(e.logo),d(e.logo),w(!1)},size:"sm",className:"border-gray-600 text-white hover:bg-gray-800",children:[n.jsx(Pc,{className:"h-3 w-3 mr-2"}),"Cancel"]}),n.jsxs(lt,{onClick:F,size:"sm",className:"bg-blue-600 hover:bg-blue-700 text-white",children:[n.jsx(hh,{className:"h-3 w-3 mr-2"}),"Save"]})]})]}),n.jsx("div",{className:"text-xs text-gray-500 space-y-1 pt-2 border-t border-gray-700",children:n.jsxs("p",{children:[n.jsx("strong",{children:"Guidelines:"})," PNG/JPG/GIF/SVG, max 2MB, square aspect ratio preferred"]})})]})]})},Pmt=()=>n.jsx("div",{className:"space-y-6",children:n.jsxs(jt,{className:"bg-beam-dark-accent/30 border-gray-700/50",children:[n.jsxs(wr,{children:[n.jsxs(fr,{className:"text-white flex items-center",children:[n.jsx(ws,{className:"h-4 w-4 mr-2 text-blue-400"}),"General Settings"]}),n.jsx(Ii,{className:"text-gray-400",children:"Configure application-wide settings"})]}),n.jsx(Ht,{children:n.jsxs("div",{className:"space-y-6",children:[n.jsx("div",{className:"space-y-3",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"space-y-0.5",children:[n.jsx(mr,{className:"text-white",children:"Theme"}),n.jsx("p",{className:"text-gray-400 text-sm",children:"Choose your preferred theme"})]}),n.jsxs(_n,{defaultValue:"dark",children:[n.jsx(xn,{className:"w-[180px] bg-beam-dark border-gray-700 text-white",children:n.jsx(wn,{placeholder:"Select theme"})}),n.jsxs(yn,{children:[n.jsx(yt,{value:"dark",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx(xve,{className:"h-4 w-4 mr-2"}),"Dark"]})}),n.jsx(yt,{value:"light",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx(Pve,{className:"h-4 w-4 mr-2"}),"Light"]})}),n.jsx(yt,{value:"system",children:"System"})]})]})]})}),n.jsx(Da,{className:"bg-gray-700/50"}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"space-y-0.5",children:[n.jsx(mr,{className:"text-white",children:"Platform Logo"}),n.jsx("p",{className:"text-gray-400 text-sm",children:"Customize your platform logo"})]}),n.jsx(kmt,{})]}),n.jsx(Da,{className:"bg-gray-700/50"}),n.jsx("div",{className:"space-y-3",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"space-y-0.5",children:[n.jsx(mr,{className:"text-white",children:"Notifications"}),n.jsx("p",{className:"text-gray-400 text-sm",children:"Enable or disable app notifications"})]}),n.jsx(ko,{id:"notifications",defaultChecked:!0})]})}),n.jsx(Da,{className:"bg-gray-700/50"}),n.jsx("div",{className:"space-y-3",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"space-y-0.5",children:[n.jsx(mr,{className:"text-white",children:"Analytics"}),n.jsx("p",{className:"text-gray-400 text-sm",children:"Allow anonymous usage data collection"})]}),n.jsx(ko,{id:"analytics",defaultChecked:!0})]})}),n.jsx(Da,{className:"bg-gray-700/50"}),n.jsx("div",{className:"space-y-3",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"space-y-0.5",children:[n.jsx(mr,{className:"text-white",children:"Developer Mode"}),n.jsx("p",{className:"text-gray-400 text-sm",children:"Enable advanced features for developers"})]}),n.jsx(ko,{id:"developer-mode"})]})}),n.jsx("div",{className:"flex justify-end pt-4",children:n.jsx(lt,{variant:"default",children:"Save Settings"})})]})})]})}),Emt=()=>{const[e,t]=U.useState("runtime"),[r,i]=U.useState([]),[a,l]=U.useState([]),[d,s]=U.useState([]),[p,x]=U.useState({total_agents:0,active_agents:0,deploying_agents:0,failed_agents:0,avg_response_time:0,success_rate:0,requests_per_minute:0}),[w,j]=U.useState(!0),[S,P]=U.useState(!1),[F,L]=U.useState(!1),[B,V]=U.useState(!1),$="http://localhost:5001/api",G=async we=>{if(confirm("Are you sure you want to delete this agent? This action cannot be undone."))try{(await fetch(`${$}/agents/${we}`,{method:"DELETE"})).ok?(se(),console.log("Agent deleted successfully")):console.error("Failed to delete agent")}catch(xe){console.error("Error deleting agent:",xe)}},W=async we=>{if(confirm("Are you sure you want to delete this memory store? This action cannot be undone."))try{(await fetch(`${$}/memory-stores/${we}`,{method:"DELETE"})).ok?(ae(),console.log("Memory store deleted successfully")):console.error("Failed to delete memory store")}catch(xe){console.error("Error deleting memory store:",xe)}},Z=async we=>{if(confirm("Are you sure you want to delete this workload identity? This action cannot be undone."))try{(await fetch(`${$}/workload-identities/${we}`,{method:"DELETE"})).ok?(ce(),console.log("Workload identity deleted successfully")):console.error("Failed to delete workload identity")}catch(xe){console.error("Error deleting workload identity:",xe)}},se=async()=>{try{const xe=await(await fetch(`${$}/agents`)).json();i(xe.agents||[])}catch(we){console.error("Error fetching agents:",we)}},ae=async()=>{try{const xe=await(await fetch(`${$}/memory-stores`)).json();l(xe.memory_stores||[])}catch(we){console.error("Error fetching memory stores:",we)}},ce=async()=>{try{const xe=await(await fetch(`${$}/workload-identities`)).json();s(xe.workload_identities||[])}catch(we){console.error("Error fetching workload identities:",we)}},Pe=async()=>{try{const xe=await(await fetch(`${$}/monitoring/system`)).json();x(xe)}catch(we){console.error("Error fetching system metrics:",we)}};return U.useEffect(()=>{(async()=>{j(!0),await Promise.all([se(),ae(),ce(),Pe()]),j(!1)})();const xe=setInterval(()=>{se(),Pe()},5e3);return()=>clearInterval(xe)},[]),n.jsxs("div",{className:"min-h-screen bg-gray-900 text-white",children:[n.jsx("div",{className:"border-b border-gray-800 bg-gray-900/95 backdrop-blur",children:n.jsx("div",{className:"max-w-7xl mx-auto px-6 py-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("div",{className:"flex items-center gap-4",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-8 h-8 bg-green-600 rounded flex items-center justify-center",children:n.jsx("span",{className:"text-white font-bold text-sm",children:"T"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-xl font-semibold text-white",children:"Agent Control Panel"}),n.jsx("p",{className:"text-sm text-gray-400",children:"Manage AI agents with AWS Bedrock AgentCore services"})]})]})}),n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("span",{className:"px-2 py-1 bg-green-500/20 text-green-400 rounded text-xs border border-green-500/30",children:"Demo Mode Enabled"}),n.jsxs("span",{className:"text-xs text-gray-400",children:["Last updated: ",new Date().toLocaleTimeString()]})]})]})})}),n.jsxs("div",{className:"max-w-7xl mx-auto px-6 py-6",children:[n.jsxs("div",{className:"flex space-x-1 bg-gray-800 p-1 rounded-lg mb-6",children:[n.jsx("button",{onClick:()=>t("aws-config"),className:`px-4 py-2 text-sm font-medium rounded-md ${e==="aws-config"?"text-white bg-green-600":"text-gray-300 bg-gray-700 hover:bg-gray-600"}`,children:"AWS Config"}),n.jsx("button",{onClick:()=>t("runtime"),className:`px-4 py-2 text-sm font-medium rounded-md ${e==="runtime"?"text-white bg-green-600":"text-gray-300 bg-gray-700 hover:bg-gray-600"}`,children:"Runtime"}),n.jsx("button",{onClick:()=>t("memory"),className:`px-4 py-2 text-sm font-medium rounded-md ${e==="memory"?"text-white bg-green-600":"text-gray-300 bg-gray-700 hover:bg-gray-600"}`,children:"Memory"}),n.jsx("button",{onClick:()=>t("identity"),className:`px-4 py-2 text-sm font-medium rounded-md ${e==="identity"?"text-white bg-green-600":"text-gray-300 bg-gray-700 hover:bg-gray-600"}`,children:"Identity"}),n.jsx("button",{onClick:()=>t("gateway"),className:`px-4 py-2 text-sm font-medium rounded-md ${e==="gateway"?"text-white bg-green-600":"text-gray-300 bg-gray-700 hover:bg-gray-600"}`,children:"Gateway"}),n.jsx("button",{onClick:()=>t("monitoring"),className:`px-4 py-2 text-sm font-medium rounded-md ${e==="monitoring"?"text-white bg-green-600":"text-gray-300 bg-gray-700 hover:bg-gray-600"}`,children:"Monitoring"})]}),w?n.jsx("div",{className:"flex items-center justify-center py-12",children:n.jsx("div",{className:"text-gray-400",children:"Loading..."})}):n.jsxs("div",{className:"space-y-6",children:[e==="aws-config"&&n.jsx(Mmt,{}),e==="runtime"&&n.jsx(Imt,{agents:r,systemMetrics:p,onDeployAgent:()=>V(!0),onRefresh:se,onDeleteAgent:G}),e==="memory"&&n.jsx(Omt,{memoryStores:a,onCreateStore:()=>P(!0),onRefresh:ae,onDeleteStore:W}),e==="identity"&&n.jsx(Rmt,{workloadIdentities:d,onCreateIdentity:()=>L(!0),onRefresh:ce,onDeleteIdentity:Z}),e==="gateway"&&n.jsx(Dmt,{}),e==="monitoring"&&n.jsx(zmt,{systemMetrics:p})]}),S&&n.jsx(Lmt,{onClose:()=>P(!1),onSuccess:()=>{P(!1),ae()}}),F&&n.jsx(Fmt,{onClose:()=>L(!1),onSuccess:()=>{L(!1),ce()}}),B&&n.jsx(Bmt,{onClose:()=>V(!1),onSuccess:()=>{V(!1),se()}})]})]})},Mmt=()=>n.jsxs("div",{className:"space-y-6",children:[n.jsx("div",{className:"flex items-center justify-between",children:n.jsxs("div",{children:[n.jsx("h2",{className:"text-2xl font-bold text-white",children:"AWS Configuration"}),n.jsx("p",{className:"text-gray-400",children:"Configure AWS Bedrock AgentCore services and credentials"})]})}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-6",children:[n.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"AWS Credentials"}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"AWS Region"}),n.jsxs("select",{className:"w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white",children:[n.jsx("option",{children:"us-east-1"}),n.jsx("option",{children:"us-west-2"}),n.jsx("option",{children:"eu-west-1"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Access Key ID"}),n.jsx("input",{type:"password",className:"w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white",placeholder:"AKIA..."})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Secret Access Key"}),n.jsx("input",{type:"password",className:"w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white",placeholder:"••••••••"})]}),n.jsx("button",{className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded",children:"Save Configuration"})]})]}),n.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-6",children:[n.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Service Status"}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-gray-300",children:"Bedrock Runtime"}),n.jsx("span",{className:"px-2 py-1 bg-green-500/20 text-green-400 rounded text-xs",children:"Available"})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-gray-300",children:"AgentCore"}),n.jsx("span",{className:"px-2 py-1 bg-green-500/20 text-green-400 rounded text-xs",children:"Available"})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-gray-300",children:"Lambda"}),n.jsx("span",{className:"px-2 py-1 bg-green-500/20 text-green-400 rounded text-xs",children:"Available"})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-gray-300",children:"S3"}),n.jsx("span",{className:"px-2 py-1 bg-green-500/20 text-green-400 rounded text-xs",children:"Available"})]})]})]})]})]}),Imt=({agents:e,systemMetrics:t,onDeployAgent:r,onRefresh:i,onDeleteAgent:a})=>{const l=s=>{switch(s){case"active":return"bg-green-500/20 text-green-400 border-green-500/30";case"deploying":return"bg-blue-500/20 text-blue-400 border-blue-500/30";case"failed":return"bg-red-500/20 text-red-400 border-red-500/30";case"stopped":return"bg-gray-500/20 text-gray-400 border-gray-500/30";default:return"bg-gray-500/20 text-gray-400 border-gray-500/30"}},d=s=>{switch(s){case"active":return"✅";case"deploying":return"🔄";case"failed":return"❌";case"stopped":return"⏹️";default:return"❓"}};return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("h2",{className:"text-2xl font-bold text-white",children:"Agent Runtime"}),n.jsx("p",{className:"text-gray-400",children:"Deploy and manage agents using AWS Bedrock AgentCore Runtime"})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{onClick:i,className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded flex items-center gap-2",children:"🔄 Refresh"}),n.jsx("button",{onClick:()=>window.open("/agent-command","_blank"),className:"bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded flex items-center gap-2",children:"🧠 Advanced Creation"}),n.jsx("button",{onClick:r,className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded flex items-center gap-2",children:"➕ Quick Deploy"})]})]}),n.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg",children:[n.jsx("div",{className:"p-6 border-b border-gray-700",children:n.jsx("div",{className:"flex items-center justify-between",children:n.jsxs("div",{children:[n.jsx("h3",{className:"text-lg font-semibold text-white",children:"Deployed Agents"}),n.jsx("p",{className:"text-sm text-gray-400",children:"Deploy New"})]})})}),n.jsx("div",{className:"p-6",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-5 gap-4 text-sm font-medium text-gray-400 border-b border-gray-700 pb-2",children:[n.jsx("div",{children:"Name"}),n.jsx("div",{children:"Status"}),n.jsx("div",{children:"Endpoint"}),n.jsx("div",{children:"Created"}),n.jsx("div",{children:"Actions"})]}),e.length===0?n.jsx("div",{className:"text-center py-8 text-gray-400",children:'No agents deployed yet. Click "Deploy Agent" to get started.'}):e.map(s=>{var p;return n.jsxs("div",{className:"grid grid-cols-5 gap-4 items-center py-3 border-b border-gray-700/50",children:[n.jsxs("div",{className:"flex flex-col",children:[n.jsx("div",{className:"text-white font-medium",children:s.name}),n.jsxs("div",{className:"flex gap-1 mt-1",children:[n.jsx("span",{className:`px-1 py-0.5 rounded text-xs ${s.framework==="bedrock-agentcore"?"bg-orange-500/20 text-orange-400":s.framework==="strands"?"bg-purple-500/20 text-purple-400":"bg-gray-500/20 text-gray-400"}`,children:s.framework}),((p=s.config)==null?void 0:p.creation_type)==="complex"&&n.jsx("span",{className:"px-1 py-0.5 bg-blue-500/20 text-blue-400 rounded text-xs",children:"Advanced"})]})]}),n.jsx("div",{children:n.jsxs("span",{className:`px-2 py-1 rounded text-xs border flex items-center gap-1 w-fit ${l(s.status)}`,children:[d(s.status)," ",n.jsx("span",{className:"capitalize",children:s.status})]})}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-blue-400 text-sm font-mono truncate max-w-xs",children:s.endpoint}),n.jsx("button",{className:"text-gray-400 hover:text-blue-400",children:"🔗"})]}),n.jsx("div",{className:"text-gray-400 text-sm",children:new Date(s.created_at).toLocaleDateString()}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{className:"p-1 border border-gray-600 rounded text-white hover:bg-gray-700",title:"Start",children:"▶️"}),n.jsx("button",{className:"p-1 border border-gray-600 rounded text-white hover:bg-gray-700",title:"Stop",children:"⏹️"}),n.jsx("button",{onClick:()=>a(s.id),className:"p-1 border border-red-600 text-red-400 rounded hover:bg-red-900/20",title:"Delete",children:"🗑️"})]})]},s.id)})]})})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[n.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-400",children:"Total Agents"}),n.jsx("p",{className:"text-2xl font-bold text-white",children:t.total_agents})]}),n.jsx("div",{className:"text-2xl",children:"⚡"})]})}),n.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-400",children:"Active"}),n.jsx("p",{className:"text-2xl font-bold text-green-400",children:t.active_agents})]}),n.jsx("div",{className:"text-2xl",children:"✅"})]})}),n.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-400",children:"Success Rate"}),n.jsxs("p",{className:"text-2xl font-bold text-green-400",children:[t.success_rate.toFixed(1),"%"]})]}),n.jsx("div",{className:"text-2xl",children:"📊"})]})}),n.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-400",children:"Avg Response"}),n.jsxs("p",{className:"text-2xl font-bold text-yellow-400",children:[Math.round(t.avg_response_time),"ms"]})]}),n.jsx("div",{className:"text-2xl",children:"⏱️"})]})})]})]})},Omt=({memoryStores:e,onCreateStore:t,onRefresh:r,onDeleteStore:i})=>n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("h2",{className:"text-2xl font-bold text-white",children:"Memory Management"}),n.jsx("p",{className:"text-gray-400",children:"Configure agent memory using AWS Bedrock AgentCore Memory"})]}),n.jsx("button",{onClick:t,className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded flex items-center gap-2",children:"➕ Create Memory Store"})]}),n.jsxs("div",{className:"flex space-x-1 bg-gray-800 p-1 rounded-lg mb-6 w-fit",children:[n.jsx("button",{className:"px-4 py-2 text-sm font-medium text-white bg-gray-700 rounded-md",children:"Memory Stores"}),n.jsx("button",{className:"px-4 py-2 text-sm font-medium text-gray-300 hover:bg-gray-700 rounded-md",children:"Create New"})]}),n.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg",children:n.jsx("div",{className:"p-6",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-4 gap-4 text-sm font-medium text-gray-400 border-b border-gray-700 pb-2",children:[n.jsx("div",{children:"Name"}),n.jsx("div",{children:"Description"}),n.jsx("div",{children:"Strategies"}),n.jsx("div",{children:"Actions"})]}),e.length===0?n.jsx("div",{className:"text-center py-8 text-gray-400",children:'No memory stores configured yet. Click "Create Memory Store" to get started.'}):e.map(a=>n.jsxs("div",{className:"grid grid-cols-4 gap-4 items-center py-3 border-b border-gray-700/50",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-white",children:"📁"}),n.jsx("span",{className:"text-white font-medium",children:a.name})]}),n.jsx("div",{className:"text-gray-300",children:a.description}),n.jsx("div",{className:"flex gap-1",children:a.strategies.map((l,d)=>n.jsx("span",{className:"px-2 py-1 bg-blue-500/20 text-blue-400 rounded text-xs",children:l},d))}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{className:"p-1 border border-gray-600 rounded text-white hover:bg-gray-700",title:"Configure",children:"⚙️"}),n.jsx("button",{onClick:()=>i(a.id),className:"p-1 border border-red-600 text-red-400 rounded hover:bg-red-900/20",title:"Delete",children:"🗑️"})]})]},a.id))]})})})]}),Rmt=({workloadIdentities:e,onCreateIdentity:t,onRefresh:r,onDeleteIdentity:i})=>n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("h2",{className:"text-2xl font-bold text-white",children:"Workload Identity"}),n.jsx("p",{className:"text-gray-400",children:"Manage agent identities using AWS Bedrock AgentCore Identity"})]}),n.jsx("button",{onClick:t,className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded flex items-center gap-2",children:"➕ Create Identity"})]}),n.jsxs("div",{className:"flex space-x-1 bg-gray-800 p-1 rounded-lg mb-6 w-fit",children:[n.jsx("button",{className:"px-4 py-2 text-sm font-medium text-white bg-gray-700 rounded-md",children:"Workload Identities"}),n.jsx("button",{className:"px-4 py-2 text-sm font-medium text-gray-300 hover:bg-gray-700 rounded-md",children:"Create New"})]}),n.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg",children:n.jsx("div",{className:"p-6",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm font-medium text-gray-400 border-b border-gray-700 pb-2",children:[n.jsx("div",{children:"Name"}),n.jsx("div",{children:"Credential Providers"}),n.jsx("div",{children:"Actions"})]}),e.length===0?n.jsx("div",{className:"text-center py-8 text-gray-400",children:'No workload identities configured yet. Click "Create Identity" to get started.'}):e.map(a=>n.jsxs("div",{className:"grid grid-cols-3 gap-4 items-center py-3 border-b border-gray-700/50",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-white",children:"🔐"}),n.jsx("span",{className:"text-white font-medium",children:a.name})]}),n.jsx("div",{className:"flex gap-1",children:a.credential_providers.map((l,d)=>n.jsxs("span",{className:"px-2 py-1 bg-green-500/20 text-green-400 rounded text-xs",children:[l.name," (",l.type,")"]},d))}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{className:"p-1 border border-gray-600 rounded text-white hover:bg-gray-700",title:"Configure",children:"⚙️"}),n.jsx("button",{onClick:()=>i(a.id),className:"p-1 border border-red-600 text-red-400 rounded hover:bg-red-900/20",title:"Delete",children:"🗑️"})]})]},a.id))]})})})]}),Dmt=()=>n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("h2",{className:"text-2xl font-bold text-white",children:"API Gateway"}),n.jsx("p",{className:"text-gray-400",children:"Configure API Gateway for agent endpoints"})]}),n.jsx("button",{className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded flex items-center gap-2",children:"➕ Create Gateway"})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-6",children:[n.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Gateway Configuration"}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Gateway Name"}),n.jsx("input",{type:"text",className:"w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white",placeholder:"agent-api-gateway"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Stage"}),n.jsxs("select",{className:"w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white",children:[n.jsx("option",{children:"prod"}),n.jsx("option",{children:"dev"}),n.jsx("option",{children:"staging"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Throttling (requests/sec)"}),n.jsx("input",{type:"number",className:"w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white",placeholder:"1000"})]})]})]}),n.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-6",children:[n.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Active Gateways"}),n.jsx("div",{className:"space-y-3",children:n.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-700 rounded",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-white font-medium",children:"agent-api-gateway"}),n.jsx("div",{className:"text-sm text-gray-400",children:"https://api.gateway.amazonaws.com/prod"})]}),n.jsx("span",{className:"px-2 py-1 bg-green-500/20 text-green-400 rounded text-xs",children:"Active"})]})})]})]})]}),zmt=({systemMetrics:e})=>n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("h2",{className:"text-2xl font-bold text-white",children:"Real-Time Monitoring"}),n.jsx("p",{className:"text-gray-400",children:"Monitor agent performance and system health"})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded",children:"📊 View Logs"}),n.jsx("button",{className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded",children:"📈 Metrics Dashboard"})]})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[n.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-400",children:"System Health"}),n.jsx("p",{className:"text-2xl font-bold text-green-400",children:"100%"})]}),n.jsx("div",{className:"text-2xl",children:"🛡️"})]})}),n.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-400",children:"Active Agents"}),n.jsx("p",{className:"text-2xl font-bold text-blue-400",children:e.active_agents})]}),n.jsx("div",{className:"text-2xl",children:"⚡"})]})}),n.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-400",children:"Requests/Min"}),n.jsx("p",{className:"text-2xl font-bold text-green-400",children:Math.round(e.requests_per_minute)})]}),n.jsx("div",{className:"text-2xl",children:"📈"})]})}),n.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-400",children:"Avg Response"}),n.jsxs("p",{className:"text-2xl font-bold text-yellow-400",children:[Math.round(e.avg_response_time),"ms"]})]}),n.jsx("div",{className:"text-2xl",children:"⏱️"})]})})]}),n.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-6",children:[n.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Performance Metrics"}),n.jsx("div",{className:"h-64 bg-gray-700 rounded flex items-center justify-center",children:n.jsx("div",{className:"text-gray-400",children:"📊 Real-time performance charts would be displayed here"})})]}),n.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-6",children:[n.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Recent Activity"}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-700 rounded",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("span",{className:"px-2 py-1 bg-green-500/20 text-green-400 rounded text-xs",children:"INFO"}),n.jsx("span",{className:"text-white",children:"Customer Service Agent processed request"})]}),n.jsx("span",{className:"text-gray-400 text-sm",children:new Date().toLocaleTimeString()})]}),n.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-700 rounded",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("span",{className:"px-2 py-1 bg-blue-500/20 text-blue-400 rounded text-xs",children:"DEPLOY"}),n.jsx("span",{className:"text-white",children:"Risk Assessment Agent deployment started"})]}),n.jsx("span",{className:"text-gray-400 text-sm",children:new Date().toLocaleTimeString()})]})]})]})]}),Lmt=({onClose:e,onSuccess:t})=>{const[r,i]=U.useState({name:"",description:"",strategies:[]}),a=async d=>{d.preventDefault();try{(await fetch("http://localhost:5001/api/memory-stores",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})).ok&&t()}catch(s){console.error("Error creating memory store:",s)}},l=d=>{i(s=>({...s,strategies:s.strategies.includes(d)?s.strategies.filter(p=>p!==d):[...s.strategies,d]}))};return n.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-6 w-full max-w-2xl",children:[n.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Create Memory Store"}),n.jsx("p",{className:"text-gray-400 mb-6",children:"Configure a new memory store for agent context and learning"}),n.jsxs("form",{onSubmit:a,className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Store Name"}),n.jsx("input",{type:"text",value:r.name,onChange:d=>i(s=>({...s,name:d.target.value})),className:"w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white",placeholder:"Enter memory store name",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Description"}),n.jsx("textarea",{value:r.description,onChange:d=>i(s=>({...s,description:d.target.value})),className:"w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white h-24",placeholder:"Describe what this memory store will contain..."})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Memory Strategies"}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("label",{className:"flex items-center gap-2",children:[n.jsx("input",{type:"checkbox",checked:r.strategies.includes("semantic"),onChange:()=>l("semantic"),className:"rounded"}),n.jsx("span",{className:"text-white",children:"Semantic Memory - Vector-based similarity search for contextual retrieval"})]}),n.jsxs("label",{className:"flex items-center gap-2",children:[n.jsx("input",{type:"checkbox",checked:r.strategies.includes("summarization"),onChange:()=>l("summarization"),className:"rounded"}),n.jsx("span",{className:"text-white",children:"Summarization - Automatic summarization of long conversations"})]})]})]}),n.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[n.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 text-gray-300 border border-gray-600 rounded hover:bg-gray-700",children:"Cancel"}),n.jsx("button",{type:"submit",className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded",children:"Create Memory Store"})]})]})]})})},Fmt=({onClose:e,onSuccess:t})=>{const[r,i]=U.useState({name:"",credential_providers:[{name:"",type:"oauth2",client_id:"",client_secret:""}]}),a=async d=>{d.preventDefault();try{(await fetch("http://localhost:5001/api/workload-identities",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})).ok&&t()}catch(s){console.error("Error creating workload identity:",s)}},l=()=>{i(d=>({...d,credential_providers:[...d.credential_providers,{name:"",type:"oauth2",client_id:"",client_secret:""}]}))};return n.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-6 w-full max-w-2xl max-h-[80vh] overflow-y-auto",children:[n.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Create Workload Identity"}),n.jsx("p",{className:"text-gray-400 mb-6",children:"Configure a new workload identity with credential providers"}),n.jsxs("form",{onSubmit:a,className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Identity Name"}),n.jsx("input",{type:"text",value:r.name,onChange:d=>i(s=>({...s,name:d.target.value})),className:"w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white",placeholder:"Enter identity name",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Credential Providers"}),r.credential_providers.map((d,s)=>n.jsx("div",{className:"bg-gray-700 p-4 rounded mb-4",children:n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-300 mb-1",children:"Provider Name"}),n.jsx("input",{type:"text",value:d.name,onChange:p=>{const x=[...r.credential_providers];x[s].name=p.target.value,i(w=>({...w,credential_providers:x}))},className:"w-full bg-gray-600 border border-gray-500 rounded px-3 py-2 text-white",placeholder:"e.g., Salesforce OAuth"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-300 mb-1",children:"Type"}),n.jsxs("select",{value:d.type,onChange:p=>{const x=[...r.credential_providers];x[s].type=p.target.value,i(w=>({...w,credential_providers:x}))},className:"w-full bg-gray-600 border border-gray-500 rounded px-3 py-2 text-white",children:[n.jsx("option",{value:"oauth2",children:"OAuth2"}),n.jsx("option",{value:"api-key",children:"API Key"}),n.jsx("option",{value:"jwt",children:"JWT"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-300 mb-1",children:"Client ID"}),n.jsx("input",{type:"text",value:d.client_id,onChange:p=>{const x=[...r.credential_providers];x[s].client_id=p.target.value,i(w=>({...w,credential_providers:x}))},className:"w-full bg-gray-600 border border-gray-500 rounded px-3 py-2 text-white",placeholder:"OAuth2 Client ID"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-300 mb-1",children:"Client Secret"}),n.jsx("input",{type:"password",value:d.client_secret,onChange:p=>{const x=[...r.credential_providers];x[s].client_secret=p.target.value,i(w=>({...w,credential_providers:x}))},className:"w-full bg-gray-600 border border-gray-500 rounded px-3 py-2 text-white",placeholder:"OAuth2 Client Secret"})]})]})},s)),n.jsx("button",{type:"button",onClick:l,className:"text-green-400 hover:text-green-300 text-sm flex items-center gap-1",children:"➕ Add Provider"})]}),n.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[n.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 text-gray-300 border border-gray-600 rounded hover:bg-gray-700",children:"Cancel"}),n.jsx("button",{type:"submit",className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded",children:"Create Identity"})]})]})]})})},Bmt=({onClose:e,onSuccess:t})=>{const[r,i]=U.useState({name:"",framework:"bedrock-agentcore",config:{model:"claude-3-sonnet",region:"us-east-1"}}),a=async l=>{l.preventDefault();try{(await fetch("http://localhost:5001/api/agents",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})).ok&&t()}catch(d){console.error("Error deploying agent:",d)}};return n.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-6 w-full max-w-2xl",children:[n.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Deploy New Agent"}),n.jsx("p",{className:"text-gray-400 mb-6",children:"Deploy a new agent to AWS Bedrock AgentCore Runtime"}),n.jsxs("form",{onSubmit:a,className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Agent Name"}),n.jsx("input",{type:"text",value:r.name,onChange:l=>i(d=>({...d,name:l.target.value})),className:"w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white",placeholder:"Enter agent name",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Framework"}),n.jsxs("select",{value:r.framework,onChange:l=>i(d=>({...d,framework:l.target.value})),className:"w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white",children:[n.jsx("option",{value:"bedrock-agentcore",children:"AWS Bedrock AgentCore"}),n.jsx("option",{value:"strands",children:"Strands"}),n.jsx("option",{value:"generic",children:"Generic"})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Model"}),n.jsxs("select",{value:r.config.model,onChange:l=>i(d=>({...d,config:{...d.config,model:l.target.value}})),className:"w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white",children:[n.jsx("option",{value:"claude-3-sonnet",children:"Claude 3 Sonnet"}),n.jsx("option",{value:"claude-3-haiku",children:"Claude 3 Haiku"}),n.jsx("option",{value:"titan-text",children:"Amazon Titan Text"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Region"}),n.jsxs("select",{value:r.config.region,onChange:l=>i(d=>({...d,config:{...d.config,region:l.target.value}})),className:"w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white",children:[n.jsx("option",{value:"us-east-1",children:"us-east-1"}),n.jsx("option",{value:"us-west-2",children:"us-west-2"}),n.jsx("option",{value:"eu-west-1",children:"eu-west-1"})]})]})]}),n.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[n.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 text-gray-300 border border-gray-600 rounded hover:bg-gray-700",children:"Cancel"}),n.jsx("button",{type:"submit",className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded",children:"Deploy Agent"})]})]})]})})},$mt=()=>{const[e,t]=U.useState([]),[r,i]=U.useState([]),[a,l]=U.useState(!0),[d,s]=U.useState("overview"),[p,x]=U.useState(!1),[w,j]=U.useState(!1);U.useEffect(()=>{S()},[]);const S=async()=>{try{l(!0);const[V,$]=await Promise.all([ah.getServers(),ah.getTools()]);t(V),i($)}catch(V){console.error("Failed to load MCP data:",V),Ls.error("Failed to load MCP data")}finally{l(!1)}},P=e.filter(V=>V.status==="connected"),F=r.length,L=r.filter(V=>V.verified).length,B=12;return a?n.jsx("div",{className:"flex items-center justify-center min-h-screen",children:n.jsx(OQ,{className:"h-8 w-8 animate-spin text-blue-400"})}):n.jsxs("div",{className:"max-w-7xl mx-auto p-6 min-h-screen",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold text-white",children:"MCP Gateway"}),n.jsx("p",{className:"text-gray-400 mt-2",children:"Enterprise-ready gateway for AI development tools and agent integration"})]}),n.jsxs("div",{className:"flex items-center space-x-4",children:[n.jsx("div",{className:"bg-green-900/30 border border-green-500/30 rounded-lg px-3 py-1",children:n.jsxs("span",{className:"text-green-400 text-sm",children:[P.length," Connected"]})}),n.jsx("div",{className:"bg-blue-900/30 border border-blue-500/30 rounded-lg px-3 py-1",children:n.jsxs("span",{className:"text-blue-400 text-sm",children:[F," Tools Available"]})}),n.jsx("div",{className:"bg-purple-900/30 border border-purple-500/30 rounded-lg px-3 py-1",children:n.jsxs("span",{className:"text-purple-400 text-sm",children:[L," Verified"]})}),n.jsxs(lt,{onClick:()=>x(!0),className:"bg-blue-600 hover:bg-blue-700",children:[n.jsx(Mo,{className:"h-4 w-4 mr-2"}),"Add Server"]})]})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[n.jsx(jt,{className:"bg-gray-800 border-gray-700",children:n.jsx(Ht,{className:"p-6",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-400",children:"Gateway Servers"}),n.jsx("p",{className:"text-2xl font-bold text-white",children:e.length}),n.jsxs("p",{className:"text-xs text-gray-500",children:[P.length," connected"]})]}),n.jsx(eo,{className:"h-8 w-8 text-blue-400"})]})})}),n.jsx(jt,{className:"bg-gray-800 border-gray-700",children:n.jsx(Ht,{className:"p-6",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-400",children:"Available Tools"}),n.jsx("p",{className:"text-2xl font-bold text-white",children:F}),n.jsxs("p",{className:"text-xs text-gray-500",children:[L," verified"]})]}),n.jsx(Yi,{className:"h-8 w-8 text-green-400"})]})})}),n.jsx(jt,{className:"bg-gray-800 border-gray-700",children:n.jsx(Ht,{className:"p-6",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-400",children:"Active Agents"}),n.jsx("p",{className:"text-2xl font-bold text-white",children:B}),n.jsx("p",{className:"text-xs text-gray-500",children:"Using gateway tools"})]}),n.jsx(qi,{className:"h-8 w-8 text-purple-400"})]})})}),n.jsx(jt,{className:"bg-gray-800 border-gray-700",children:n.jsx(Ht,{className:"p-6",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-400",children:"Security Status"}),n.jsx("p",{className:"text-2xl font-bold text-green-400",children:"Secure"}),n.jsx("p",{className:"text-xs text-gray-500",children:"All authenticated"})]}),n.jsx(dn,{className:"h-8 w-8 text-green-400"})]})})})]}),n.jsxs($i,{value:d,onValueChange:s,className:"space-y-6",children:[n.jsxs(Di,{className:"bg-gray-800 border-gray-700",children:[n.jsxs(Jt,{value:"overview",className:"data-[state=active]:bg-blue-600",children:[n.jsx(to,{className:"h-4 w-4 mr-2"}),"Overview"]}),n.jsxs(Jt,{value:"servers",className:"data-[state=active]:bg-blue-600",children:[n.jsx(eo,{className:"h-4 w-4 mr-2"}),"Servers"]}),n.jsxs(Jt,{value:"tools",className:"data-[state=active]:bg-blue-600",children:[n.jsx(Yi,{className:"h-4 w-4 mr-2"}),"Tools"]}),n.jsxs(Jt,{value:"analytics",className:"data-[state=active]:bg-blue-600",children:[n.jsx(En,{className:"h-4 w-4 mr-2"}),"Analytics"]})]}),n.jsxs(ur,{value:"overview",className:"space-y-6",children:[n.jsxs(jt,{className:"bg-gray-800 border-gray-700",children:[n.jsxs(wr,{children:[n.jsx(fr,{className:"text-white",children:"Quick Actions"}),n.jsx(Ii,{children:"Manage your MCP gateway and tool discovery"})]}),n.jsx(Ht,{children:n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[n.jsxs(lt,{onClick:()=>x(!0),className:"bg-green-600 hover:bg-green-700 p-4 h-auto flex flex-col items-center space-y-2",children:[n.jsx(Mo,{className:"h-6 w-6"}),n.jsx("span",{children:"Add Server"})]}),n.jsxs(lt,{onClick:()=>j(!0),className:"bg-blue-600 hover:bg-blue-700 p-4 h-auto flex flex-col items-center space-y-2",children:[n.jsx(Bc,{className:"h-6 w-6"}),n.jsx("span",{children:"Create Tool"})]}),n.jsxs(lt,{className:"bg-purple-600 hover:bg-purple-700 p-4 h-auto flex flex-col items-center space-y-2",children:[n.jsx($c,{className:"h-6 w-6"}),n.jsx("span",{children:"Discover Tools"})]}),n.jsxs(lt,{className:"bg-orange-600 hover:bg-orange-700 p-4 h-auto flex flex-col items-center space-y-2",children:[n.jsx(ws,{className:"h-6 w-6"}),n.jsx("span",{children:"Gateway Config"})]})]})})]}),n.jsxs(jt,{className:"bg-gray-800 border-gray-700",children:[n.jsx(wr,{children:n.jsx(fr,{className:"text-white",children:"Recent Activity"})}),n.jsx(Ht,{children:n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-700/50 rounded-lg",children:[n.jsx(bs,{className:"h-4 w-4 text-green-400"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-white text-sm",children:'Server "AWS AgentCore Gateway" connected'}),n.jsx("p",{className:"text-gray-400 text-xs",children:"2 minutes ago"})]})]}),n.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-700/50 rounded-lg",children:[n.jsx(bs,{className:"h-4 w-4 text-blue-400"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-white text-sm",children:'New tool "S3 Upload" registered'}),n.jsx("p",{className:"text-gray-400 text-xs",children:"5 minutes ago"})]})]}),n.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-700/50 rounded-lg",children:[n.jsx(bs,{className:"h-4 w-4 text-purple-400"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-white text-sm",children:'Agent "Banking Assistant" used 3 tools'}),n.jsx("p",{className:"text-gray-400 text-xs",children:"10 minutes ago"})]})]})]})})]})]}),n.jsx(ur,{value:"servers",className:"space-y-6",children:n.jsx(Vmt,{servers:e,onRefresh:S})}),n.jsx(ur,{value:"tools",className:"space-y-6",children:n.jsx(Umt,{tools:r,servers:e,onRefresh:S})}),n.jsx(ur,{value:"analytics",className:"space-y-6",children:n.jsx(Gmt,{servers:e,tools:r})})]}),n.jsx(Hmt,{open:p,onOpenChange:x,onSuccess:S}),n.jsx(qmt,{open:w,onOpenChange:j,servers:e,onSuccess:S})]})},Vmt=({servers:e,onRefresh:t})=>{const r=l=>{switch(l){case"connected":return n.jsx(ro,{className:"h-4 w-4 text-green-500"});case"disconnected":return n.jsx(BD,{className:"h-4 w-4 text-gray-400"});case"testing":return n.jsx(ub,{className:"h-4 w-4 text-yellow-500 animate-pulse"});case"error":return n.jsx(BD,{className:"h-4 w-4 text-red-500"})}},i=async l=>{try{await ah.updateServer(l.id,{status:"testing"}),t(),setTimeout(async()=>{const d=await ah.testServerConnection(l.id);await ah.updateServer(l.id,{status:d?"connected":"error",lastHealthCheck:new Date}),t(),Ls.success(d?"Connection successful":"Connection failed")},2e3)}catch{Ls.error("Failed to test connection")}},a=async l=>{try{await ah.deleteServer(l),Ls.success("Server deleted successfully"),t()}catch{Ls.error("Failed to delete server")}};return n.jsxs(jt,{className:"bg-gray-800 border-gray-700",children:[n.jsx(wr,{children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx(fr,{className:"text-white",children:"MCP Servers"}),n.jsx(Ii,{children:"Manage your Model Context Protocol servers"})]}),n.jsxs(lt,{onClick:t,variant:"outline",size:"sm",children:[n.jsx(bs,{className:"h-4 w-4 mr-2"}),"Refresh"]})]})}),n.jsx(Ht,{children:n.jsx("div",{className:"space-y-4",children:e.map(l=>n.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-700 rounded-lg",children:[n.jsxs("div",{className:"flex items-center space-x-3",children:[r(l.status),n.jsxs("div",{className:"flex items-center space-x-2",children:[l.type==="aws"&&n.jsx(ln,{className:"h-4 w-4 text-orange-500"}),l.type==="remote"&&n.jsx(Zs,{className:"h-4 w-4 text-blue-500"}),l.type==="local"&&n.jsx(eo,{className:"h-4 w-4 text-green-500"})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-white font-semibold",children:l.name}),n.jsx("p",{className:"text-gray-400 text-sm",children:l.description}),n.jsx("p",{className:"text-gray-500 text-xs",children:l.url})]})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(Tt,{className:`${l.type==="aws"?"bg-orange-900/30 text-orange-400 border-orange-500/30":l.type==="remote"?"bg-blue-900/30 text-blue-400 border-blue-500/30":"bg-green-900/30 text-green-400 border-green-500/30"}`,children:l.type.toUpperCase()}),n.jsx(Tt,{className:`${l.status==="connected"?"bg-green-900/30 text-green-400 border-green-500/30":l.status==="error"?"bg-red-900/30 text-red-400 border-red-500/30":"bg-gray-900/30 text-gray-400 border-gray-500/30"}`,children:l.status}),n.jsxs("div",{className:"flex space-x-1",children:[n.jsx(lt,{variant:"outline",size:"sm",onClick:()=>i(l),disabled:l.status==="testing",children:n.jsx(VQ,{className:"h-4 w-4"})}),n.jsx(lt,{variant:"outline",size:"sm",onClick:()=>a(l.id),className:"text-red-400 hover:text-red-300",children:n.jsx(BN,{className:"h-4 w-4"})})]})]})]},l.id))})})]})},Umt=({tools:e,servers:t,onRefresh:r})=>{const i=l=>{switch(l){case"aws":return n.jsx(ln,{className:"h-4 w-4 text-orange-400"});case"git":return n.jsx(Bc,{className:"h-4 w-4 text-purple-400"});case"filesystem":return n.jsx(eo,{className:"h-4 w-4 text-green-400"});case"api":return n.jsx(Zs,{className:"h-4 w-4 text-blue-400"});case"text":return n.jsx(Yi,{className:"h-4 w-4 text-yellow-400"});default:return n.jsx(ws,{className:"h-4 w-4 text-gray-400"})}},a=async l=>{try{await ah.deleteTool(l),Ls.success("Tool deleted successfully"),r()}catch{Ls.error("Failed to delete tool")}};return n.jsxs(jt,{className:"bg-gray-800 border-gray-700",children:[n.jsx(wr,{children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx(fr,{className:"text-white",children:"MCP Tools"}),n.jsx(Ii,{children:"Available tools from connected servers"})]}),n.jsxs(lt,{onClick:r,variant:"outline",size:"sm",children:[n.jsx(bs,{className:"h-4 w-4 mr-2"}),"Refresh"]})]})}),n.jsx(Ht,{children:n.jsx("div",{className:"grid gap-4",children:e.map(l=>n.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-700 rounded-lg",children:[n.jsxs("div",{className:"flex items-center space-x-3",children:[i(l.category),n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("h3",{className:"text-white font-semibold",children:l.name}),l.verified&&n.jsx(ro,{className:"h-3 w-3 text-green-400"})]}),n.jsx("p",{className:"text-gray-400 text-sm",children:l.description}),n.jsx("p",{className:"text-gray-500 text-xs",children:l.serverName})]})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(Tt,{variant:"outline",className:"text-xs",children:l.category}),n.jsx(Tt,{variant:"outline",className:"text-xs",children:l.usageComplexity}),n.jsx(lt,{variant:"outline",size:"sm",onClick:()=>a(l.id),className:"text-red-400 hover:text-red-300",children:n.jsx(BN,{className:"h-4 w-4"})})]})]},l.id))})})]})},Gmt=({servers:e,tools:t})=>{const r=e.filter(l=>l.status==="connected"),i=t.filter(l=>l.verified),a=t.reduce((l,d)=>(l[d.category]=(l[d.category]||0)+1,l),{});return n.jsxs("div",{className:"grid gap-6",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[n.jsxs(jt,{className:"bg-gray-800 border-gray-700",children:[n.jsx(wr,{children:n.jsx(fr,{className:"text-white",children:"Server Health"})}),n.jsx(Ht,{children:n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-400",children:"Connected"}),n.jsx("span",{className:"text-green-400",children:r.length})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-400",children:"Disconnected"}),n.jsx("span",{className:"text-red-400",children:e.length-r.length})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-400",children:"Total"}),n.jsx("span",{className:"text-white",children:e.length})]})]})})]}),n.jsxs(jt,{className:"bg-gray-800 border-gray-700",children:[n.jsx(wr,{children:n.jsx(fr,{className:"text-white",children:"Tool Statistics"})}),n.jsx(Ht,{children:n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-400",children:"Total Tools"}),n.jsx("span",{className:"text-white",children:t.length})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-400",children:"Verified"}),n.jsx("span",{className:"text-green-400",children:i.length})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-400",children:"Categories"}),n.jsx("span",{className:"text-blue-400",children:Object.keys(a).length})]})]})})]}),n.jsxs(jt,{className:"bg-gray-800 border-gray-700",children:[n.jsx(wr,{children:n.jsx(fr,{className:"text-white",children:"Usage Metrics"})}),n.jsx(Ht,{children:n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-400",children:"Active Agents"}),n.jsx("span",{className:"text-purple-400",children:"12"})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-400",children:"Tool Calls Today"}),n.jsx("span",{className:"text-yellow-400",children:"1,247"})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-400",children:"Success Rate"}),n.jsx("span",{className:"text-green-400",children:"98.5%"})]})]})})]})]}),n.jsxs(jt,{className:"bg-gray-800 border-gray-700",children:[n.jsx(wr,{children:n.jsx(fr,{className:"text-white",children:"Tools by Category"})}),n.jsx(Ht,{children:n.jsx("div",{className:"space-y-3",children:Object.entries(a).map(([l,d])=>n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full"}),n.jsx("span",{className:"text-white capitalize",children:l})]}),n.jsxs("span",{className:"text-gray-400",children:[d," tools"]})]},l))})})]})]})},Hmt=({open:e,onOpenChange:t,onSuccess:r})=>{const[i,a]=U.useState({name:"",description:"",url:"",type:"remote",transport:"auto",authentication:{type:"none"},enabled:!0}),l=async()=>{try{await ah.registerServer(i),Ls.success("Server added successfully"),r(),t(!1),a({name:"",description:"",url:"",type:"remote",transport:"auto",authentication:{type:"none"},enabled:!0})}catch{Ls.error("Failed to add server")}};return n.jsx(Ml,{open:e,onOpenChange:t,children:n.jsxs(Qo,{className:"bg-gray-900 border-gray-700 max-w-md",children:[n.jsxs(el,{children:[n.jsx(tl,{className:"text-white",children:"Add MCP Server"}),n.jsx(fg,{className:"text-gray-400",children:"Register a new Model Context Protocol server"})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx(mr,{className:"text-white",children:"Server Name"}),n.jsx(An,{value:i.name||"",onChange:d=>a({...i,name:d.target.value}),placeholder:"My MCP Server",className:"bg-gray-800 border-gray-600 text-white"})]}),n.jsxs("div",{children:[n.jsx(mr,{className:"text-white",children:"Description"}),n.jsx(po,{value:i.description||"",onChange:d=>a({...i,description:d.target.value}),placeholder:"Server description...",className:"bg-gray-800 border-gray-600 text-white"})]}),n.jsxs("div",{children:[n.jsx(mr,{className:"text-white",children:"Server URL"}),n.jsx(An,{value:i.url||"",onChange:d=>a({...i,url:d.target.value}),placeholder:"http://localhost:8000/mcp",className:"bg-gray-800 border-gray-600 text-white"})]}),n.jsxs("div",{children:[n.jsx(mr,{className:"text-white",children:"Server Type"}),n.jsxs(_n,{value:i.type,onValueChange:d=>a({...i,type:d}),children:[n.jsx(xn,{className:"bg-gray-800 border-gray-600 text-white",children:n.jsx(wn,{})}),n.jsxs(yn,{className:"bg-gray-800 border-gray-600",children:[n.jsx(yt,{value:"local",children:"Local Server"}),n.jsx(yt,{value:"remote",children:"Remote Server"}),n.jsx(yt,{value:"aws",children:"AWS Gateway"})]})]})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(ko,{checked:i.enabled,onCheckedChange:d=>a({...i,enabled:d})}),n.jsx(mr,{className:"text-white",children:"Enable server"})]}),n.jsxs("div",{className:"flex justify-end space-x-2",children:[n.jsx(lt,{variant:"outline",onClick:()=>t(!1),children:"Cancel"}),n.jsx(lt,{onClick:l,className:"bg-blue-600 hover:bg-blue-700",children:"Add Server"})]})]})]})})},qmt=({open:e,onOpenChange:t,servers:r,onSuccess:i})=>{const[a,l]=U.useState({name:"",description:"",category:"other",usageComplexity:"simple",verified:!1,agentRecommended:!1}),[d,s]=U.useState(""),p=async()=>{if(!d){Ls.error("Please select a server");return}try{await ah.createTool(d,a),Ls.success("Tool created successfully"),i(),t(!1),l({name:"",description:"",category:"other",usageComplexity:"simple",verified:!1,agentRecommended:!1}),s("")}catch{Ls.error("Failed to create tool")}};return n.jsx(Ml,{open:e,onOpenChange:t,children:n.jsxs(Qo,{className:"bg-gray-900 border-gray-700 max-w-md",children:[n.jsxs(el,{children:[n.jsx(tl,{className:"text-white",children:"Create MCP Tool"}),n.jsx(fg,{className:"text-gray-400",children:"Create a new tool for an MCP server"})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx(mr,{className:"text-white",children:"Server"}),n.jsxs(_n,{value:d,onValueChange:s,children:[n.jsx(xn,{className:"bg-gray-800 border-gray-600 text-white",children:n.jsx(wn,{placeholder:"Select a server"})}),n.jsx(yn,{className:"bg-gray-800 border-gray-600",children:r.map(x=>n.jsx(yt,{value:x.id,children:x.name},x.id))})]})]}),n.jsxs("div",{children:[n.jsx(mr,{className:"text-white",children:"Tool Name"}),n.jsx(An,{value:a.name||"",onChange:x=>l({...a,name:x.target.value}),placeholder:"My Tool",className:"bg-gray-800 border-gray-600 text-white"})]}),n.jsxs("div",{children:[n.jsx(mr,{className:"text-white",children:"Description"}),n.jsx(po,{value:a.description||"",onChange:x=>l({...a,description:x.target.value}),placeholder:"Tool description...",className:"bg-gray-800 border-gray-600 text-white"})]}),n.jsxs("div",{children:[n.jsx(mr,{className:"text-white",children:"Category"}),n.jsxs(_n,{value:a.category,onValueChange:x=>l({...a,category:x}),children:[n.jsx(xn,{className:"bg-gray-800 border-gray-600 text-white",children:n.jsx(wn,{})}),n.jsxs(yn,{className:"bg-gray-800 border-gray-600",children:[n.jsx(yt,{value:"aws",children:"AWS"}),n.jsx(yt,{value:"git",children:"Git"}),n.jsx(yt,{value:"filesystem",children:"Filesystem"}),n.jsx(yt,{value:"api",children:"API"}),n.jsx(yt,{value:"text",children:"Text"}),n.jsx(yt,{value:"data",children:"Data"}),n.jsx(yt,{value:"other",children:"Other"})]})]})]}),n.jsxs("div",{children:[n.jsx(mr,{className:"text-white",children:"Complexity"}),n.jsxs(_n,{value:a.usageComplexity,onValueChange:x=>l({...a,usageComplexity:x}),children:[n.jsx(xn,{className:"bg-gray-800 border-gray-600 text-white",children:n.jsx(wn,{})}),n.jsxs(yn,{className:"bg-gray-800 border-gray-600",children:[n.jsx(yt,{value:"simple",children:"Simple"}),n.jsx(yt,{value:"moderate",children:"Moderate"}),n.jsx(yt,{value:"advanced",children:"Advanced"})]})]})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(ko,{checked:a.verified,onCheckedChange:x=>l({...a,verified:x})}),n.jsx(mr,{className:"text-white",children:"Verified tool"})]}),n.jsxs("div",{className:"flex justify-end space-x-2",children:[n.jsx(lt,{variant:"outline",onClick:()=>t(!1),children:"Cancel"}),n.jsx(lt,{onClick:p,className:"bg-blue-600 hover:bg-blue-700",children:"Create Tool"})]})]})]})})},Wmt=()=>(console.log("MCPGatewayTest rendering..."),n.jsxs("div",{className:"p-6",children:[n.jsx("h1",{className:"text-3xl font-bold text-white mb-4",children:"MCP Gateway Test"}),n.jsx("p",{className:"text-gray-400",children:"This is a test to see if the component renders properly."}),n.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4 mt-4",children:n.jsx("p",{className:"text-white",children:"Test card content"})})]})),Kmt=()=>{const[e,t]=U.useState(!1),[r,i]=U.useState(null),[a,l]=U.useState([]),d=[{id:"user-interface",title:"User Interface",position:{x:80,y:80},width:180,height:140,color:"border-blue-500/50 bg-blue-500/10",nodes:[{id:"sidebar",name:"Sidebar",icon:UD,color:"bg-blue-500"},{id:"main-content",name:"Main Content",icon:qi,color:"bg-blue-600"}],services:[{name:"React",icon:Zs,color:"bg-blue-400"},{name:"Vite",icon:Yi,color:"bg-blue-300"}]},{id:"industry-context",title:"Industry Context",position:{x:340,y:80},width:180,height:140,color:"border-purple-500/50 bg-purple-500/10",nodes:[{id:"industry-provider",name:"Industry Provider",icon:ws,color:"bg-purple-500"},{id:"theme-config",name:"Theme Config",icon:dn,color:"bg-purple-600"}],services:[{name:"Supabase",icon:ln,color:"bg-purple-400"},{name:"React Query",icon:ga,color:"bg-purple-300"}]},{id:"agent-dashboard",title:"Agent Dashboard",position:{x:600,y:80},width:180,height:140,color:"border-cyan-500/50 bg-cyan-500/10",nodes:[{id:"agents-table",name:"Agents Table",icon:Hi,color:"bg-cyan-500"},{id:"agent-monitoring",name:"Agent Monitoring",icon:to,color:"bg-cyan-600"}],services:[{name:"SQLite",icon:ln,color:"bg-cyan-400"},{name:"Flask API",icon:eo,color:"bg-cyan-300"}]},{id:"command-centre",title:"Agent Command Centre",position:{x:80,y:280},width:180,height:140,color:"border-green-500/50 bg-green-500/10",nodes:[{id:"create-agent",name:"Create Agent",icon:Mo,color:"bg-green-500"},{id:"quick-actions",name:"Quick Actions",icon:Yi,color:"bg-green-600"}],services:[{name:"AgentCore",icon:Hi,color:"bg-green-400"},{name:"Strands",icon:ga,color:"bg-green-300"}]},{id:"mcp-gateway",title:"MCP Gateway",position:{x:340,y:280},width:180,height:140,color:"border-orange-500/50 bg-orange-500/10",nodes:[{id:"mcp-settings",name:"MCP Settings",icon:eo,color:"bg-orange-500"},{id:"mcp-dashboard",name:"MCP Dashboard",icon:ga,color:"bg-orange-600"}],services:[{name:"MCP Protocol",icon:ga,color:"bg-orange-400"},{name:"WebSockets",icon:bs,color:"bg-orange-300"}]},{id:"multi-agent-workspace",title:"Multi-Agent Workspace",position:{x:600,y:280},width:180,height:140,color:"border-teal-500/50 bg-teal-500/10",nodes:[{id:"agent-palette",name:"Agent Palette",icon:Zs,color:"bg-teal-500"},{id:"properties-panel",name:"Properties Panel",icon:ws,color:"bg-teal-600"}],services:[{name:"LangChain",icon:ga,color:"bg-teal-400"},{name:"ChromaDB",icon:ln,color:"bg-teal-300"}]},{id:"agentcore-observability",title:"AgentCore Observability",position:{x:80,y:480},width:180,height:140,color:"border-red-500/50 bg-red-500/10",nodes:[{id:"real-agent-monitoring",name:"Real Agent Monitoring",icon:bs,color:"bg-red-500"},{id:"deployment-control",name:"Deployment Control",icon:op,color:"bg-red-600"}],services:[{name:"AWS Bedrock",icon:ti,color:"bg-red-400"},{name:"Pinecone",icon:ln,color:"bg-red-300"}]},{id:"settings-pages",title:"Settings & Configuration",position:{x:340,y:480},width:180,height:140,color:"border-gray-500/50 bg-gray-500/10",nodes:[{id:"general-settings",name:"General Settings",icon:ws,color:"bg-gray-500"},{id:"logo-settings",name:"Logo Settings",icon:UD,color:"bg-gray-600"}],services:[{name:"Local Storage",icon:ln,color:"bg-gray-400"},{name:"Form Validation",icon:dn,color:"bg-gray-300"}]}],s=[{from:"user-interface",to:"industry-context",label:"Context",type:"user"},{from:"industry-context",to:"agent-dashboard",label:"Templates",type:"data"},{from:"user-interface",to:"command-centre",label:"Create",type:"user"},{from:"command-centre",to:"mcp-gateway",label:"Tools",type:"control"},{from:"agent-dashboard",to:"multi-agent-workspace",label:"Deploy",type:"data"},{from:"command-centre",to:"agentcore-observability",label:"Monitor",type:"control"},{from:"mcp-gateway",to:"settings-pages",label:"Config",type:"user"},{from:"multi-agent-workspace",to:"agentcore-observability",label:"Runtime",type:"control"}];U.useEffect(()=>{if(e){const j=setInterval(()=>{const S=s[Math.floor(Math.random()*s.length)];l([S.from,S.to]),setTimeout(()=>{l([])},1500)},2500);return()=>clearInterval(j)}},[e]);const p=(j,S)=>{const P=j.position.x+j.width/2,F=j.position.y+j.height,L=S.position.x+S.width/2,B=S.position.y,V=L-P,$=B-F,G=Math.sqrt(V*V+$*$);if(Math.abs(V)>Math.abs($)){const W=P+V/2,Z=Math.min(60,G/4);return`M ${P} ${F} C ${P} ${F+Z}, ${W} ${F+Z}, ${W} ${F+$/2} S ${L} ${B-Z}, ${L} ${B}`}else{const W=Math.min(80,G/3);return`M ${P} ${F} C ${P+W} ${F}, ${L-W} ${B}, ${L} ${B}`}},x=({section:j})=>{const S=a.includes(j.id);return n.jsxs("div",{className:`absolute rounded-lg border-2 ${j.color} p-4 transition-all duration-500 backdrop-blur-sm ${S?"shadow-xl shadow-purple-400/40 border-purple-400 scale-105 bg-opacity-20":"hover:shadow-lg hover:scale-102 bg-opacity-10"}`,style:{left:j.position.x,top:j.position.y,width:j.width,height:j.height},children:[S&&n.jsx("div",{className:"absolute inset-0 rounded-xl bg-gradient-to-br from-purple-500/20 via-transparent to-purple-600/20 animate-pulse"}),n.jsx("h3",{className:`relative text-white font-medium text-sm mb-3 text-center ${S?"text-purple-200":""}`,children:j.title}),n.jsx("div",{className:`relative grid gap-3 mb-3 ${j.nodes.length<=2?"grid-cols-2":j.nodes.length<=3?"grid-cols-3":"grid-cols-4"}`,children:j.nodes.map(P=>{const F=P.icon,L=r===P.id;return n.jsx("div",{className:`cursor-pointer transition-all duration-300 transform ${L?"scale-110 z-10":"hover:scale-105"} ${S?"animate-pulse":""}`,onClick:()=>i(L?null:P.id),children:n.jsxs("div",{className:`relative rounded-lg border-2 ${L?"border-purple-400 shadow-xl shadow-purple-400/50 bg-purple-500/20":"border-gray-600/50 hover:border-gray-400"} ${P.color} bg-opacity-90 backdrop-blur-sm transition-all duration-300 p-3 h-16 group`,children:[L&&n.jsx("div",{className:"absolute inset-0 rounded-xl bg-gradient-to-br from-purple-400/30 to-purple-600/30 animate-pulse"}),n.jsxs("div",{className:"relative flex flex-col items-center gap-2 h-full justify-center",children:[n.jsx(F,{className:`w-5 h-5 text-white transition-all duration-300 ${L?"scale-110":"group-hover:scale-105"}`}),n.jsx("span",{className:`text-xs font-medium text-white text-center leading-tight transition-all duration-300 ${L?"text-purple-100":""}`,children:P.name})]}),n.jsx("div",{className:`absolute top-2 right-2 w-3 h-3 rounded-full transition-all duration-300 ${L?"bg-purple-400 animate-ping":"bg-green-400"}`,children:n.jsx("div",{className:`absolute inset-0 rounded-full ${L?"bg-purple-400":"bg-green-400"} animate-pulse`})})]})},P.id)})}),j.services&&n.jsxs("div",{className:"relative",children:[n.jsx("div",{className:"text-xs text-gray-400 mb-2 text-center",children:"Powered by:"}),n.jsx("div",{className:"flex justify-center gap-2",children:j.services.map((P,F)=>{const L=P.icon;return n.jsxs("div",{className:`flex items-center gap-1 px-2 py-1 rounded text-xs ${P.color} bg-opacity-20 border border-current border-opacity-30 transition-all duration-300 hover:bg-opacity-30`,children:[n.jsx(L,{className:"w-3 h-3 text-white"}),n.jsx("span",{className:"text-white font-medium",children:P.name})]},F)})})]})]})};return n.jsxs(jt,{className:"bg-gray-900 border-gray-700",children:[n.jsxs(wr,{className:"flex flex-row items-center justify-between",children:[n.jsxs("div",{children:[n.jsxs(fr,{className:"text-white flex items-center gap-2",children:[n.jsx(ga,{className:"w-5 h-5"}),"AgentOS Logical Flow"]}),n.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"Interactive visualization of how AgentOS components connect and communicate"})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs(lt,{variant:e?"default":"outline",size:"sm",onClick:()=>t(!e),className:"text-white",children:[e?n.jsx(zQ,{className:"w-4 h-4 mr-2"}):n.jsx(Sh,{className:"w-4 h-4 mr-2"}),e?"Pause Flow":"Start Flow"]}),n.jsxs(lt,{variant:"outline",size:"sm",onClick:()=>{i(null),l([])},className:"text-white",children:[n.jsx(vx,{className:"w-4 h-4 mr-2"}),"Reset"]})]})]}),n.jsxs(Ht,{children:[n.jsxs("div",{className:"relative bg-gradient-to-br from-gray-950 via-gray-900 to-gray-800 rounded-lg border-2 border-gray-700 p-6 h-[700px] overflow-hidden",children:[n.jsxs("div",{className:"text-center mb-4",children:[n.jsx("h2",{className:"text-xl font-bold text-white mb-1",children:"AgentOS Architecture Flow"}),n.jsx("p",{className:"text-gray-400 text-sm",children:"Interactive component connections and data flow"})]}),n.jsxs("svg",{className:"absolute inset-0 w-full h-full pointer-events-none",style:{zIndex:10},children:[n.jsxs("defs",{children:[n.jsxs("linearGradient",{id:"activeGradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[n.jsx("stop",{offset:"0%",stopColor:"#8B5CF6",stopOpacity:"0.8"}),n.jsx("stop",{offset:"50%",stopColor:"#A855F7",stopOpacity:"1"}),n.jsx("stop",{offset:"100%",stopColor:"#C084FC",stopOpacity:"0.8"})]}),n.jsxs("linearGradient",{id:"inactiveGradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[n.jsx("stop",{offset:"0%",stopColor:"#4B5563",stopOpacity:"0.3"}),n.jsx("stop",{offset:"50%",stopColor:"#6B7280",stopOpacity:"0.5"}),n.jsx("stop",{offset:"100%",stopColor:"#4B5563",stopOpacity:"0.3"})]}),n.jsxs("filter",{id:"glow",x:"-50%",y:"-50%",width:"200%",height:"200%",children:[n.jsx("feGaussianBlur",{stdDeviation:"3",result:"coloredBlur"}),n.jsxs("feMerge",{children:[n.jsx("feMergeNode",{in:"coloredBlur"}),n.jsx("feMergeNode",{in:"SourceGraphic"})]})]}),n.jsxs("pattern",{id:"animatedDash",patternUnits:"userSpaceOnUse",width:"20",height:"4",children:[n.jsx("rect",{width:"20",height:"4",fill:"none"}),n.jsx("rect",{width:"10",height:"4",fill:"currentColor",opacity:"0.8",children:n.jsx("animateTransform",{attributeName:"transform",type:"translate",values:"0,0; 20,0; 0,0",dur:"2s",repeatCount:"indefinite"})})]})]}),s.map((j,S)=>{const P=d.find(V=>V.id===j.from),F=d.find(V=>V.id===j.to);if(!P||!F)return null;const L=a.includes(j.from)&&a.includes(j.to),B=`path-${S}`;return n.jsxs("g",{children:[L&&n.jsx("path",{d:p(P,F),stroke:"url(#activeGradient)",strokeWidth:"4",fill:"none",opacity:"0.2",filter:"url(#glow)",className:"animate-pulse"}),n.jsx("path",{id:B,d:p(P,F),stroke:L?"url(#activeGradient)":"url(#inactiveGradient)",strokeWidth:L?2.5:1.5,fill:"none",strokeDasharray:j.type==="data"?"12,6":j.type==="control"?"18,8":"none",className:L?"animate-pulse":"transition-all duration-500",opacity:L?1:.6,strokeLinecap:"round",strokeLinejoin:"round"}),L&&n.jsxs(n.Fragment,{children:[n.jsx("circle",{r:"4",fill:"#A855F7",opacity:"0.8",children:n.jsx("animateMotion",{dur:"3s",repeatCount:"indefinite",children:n.jsx("mpath",{href:`#${B}`})})}),n.jsx("circle",{r:"3",fill:"#C084FC",opacity:"0.6",children:n.jsx("animateMotion",{dur:"3s",begin:"0.5s",repeatCount:"indefinite",children:n.jsx("mpath",{href:`#${B}`})})}),n.jsx("circle",{r:"2",fill:"#DDD6FE",opacity:"0.8",children:n.jsx("animateMotion",{dur:"3s",begin:"1s",repeatCount:"indefinite",children:n.jsx("mpath",{href:`#${B}`})})})]}),n.jsx("g",{transform:`translate(${F.position.x+F.width/2}, ${F.position.y})`,children:n.jsx("polygon",{points:"-8,-8 8,-8 0,0",fill:L?"#A855F7":"#6B7280",stroke:L?"#8B5CF6":"#4B5563",strokeWidth:"1",className:L?"animate-pulse":"",filter:L?"url(#glow)":"none"})}),n.jsxs("g",{transform:`translate(${(P.position.x+P.width/2+F.position.x+F.width/2)/2}, ${(P.position.y+P.height+F.position.y)/2})`,children:[n.jsx("rect",{x:"-30",y:"-10",width:"60",height:"20",rx:"10",fill:L?"#1F2937":"#374151",stroke:L?"#8B5CF6":"#6B7280",strokeWidth:"1",opacity:"0.9",className:L?"animate-pulse":""}),n.jsx("text",{textAnchor:"middle",dominantBaseline:"middle",fill:L?"#A855F7":"#9CA3AF",fontSize:"11",fontWeight:"500",className:`${L?"animate-pulse":""}`,children:j.label})]})]},S)})]}),d.map(j=>n.jsx(x,{section:j},j.id)),n.jsxs("div",{className:"absolute bottom-4 right-4 bg-gray-800/90 backdrop-blur-sm rounded-lg p-3 border border-gray-600",children:[n.jsx("h4",{className:"text-white font-medium mb-2 text-sm",children:"Flow Types"}),n.jsxs("div",{className:"space-y-1",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"w-4 h-0.5 bg-gray-500"}),n.jsx("span",{className:"text-xs text-gray-300",children:"User"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"w-4 h-0.5 bg-gray-500",style:{background:"repeating-linear-gradient(to right, #6B7280 0, #6B7280 6px, transparent 6px, transparent 9px)"}}),n.jsx("span",{className:"text-xs text-gray-300",children:"Data"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"w-4 h-0.5 bg-gray-500",style:{background:"repeating-linear-gradient(to right, #6B7280 0, #6B7280 9px, transparent 9px, transparent 12px)"}}),n.jsx("span",{className:"text-xs text-gray-300",children:"Control"})]})]})]})]}),r&&n.jsx("div",{className:"mt-6 p-4 bg-gray-800 rounded-lg border border-gray-600",children:(()=>{let j=null,S=null;for(const F of d){const L=F.nodes.find(B=>B.id===r);if(L){j=L,S=F;break}}if(!j||!S)return null;const P=j.icon;return n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[n.jsx("div",{className:`p-3 rounded-lg ${j.color}`,children:n.jsx(P,{className:"w-6 h-6 text-white"})}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-xl font-semibold text-white",children:j.name}),n.jsx(Tt,{variant:"secondary",className:"mt-1",children:S.title})]})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsx("h4",{className:"text-sm font-medium text-gray-300 mb-3",children:"Component Role"}),n.jsxs("p",{className:"text-sm text-gray-300 mb-4",children:["This component is part of the ",n.jsx("strong",{children:S.title})," layer in the AgentOS architecture."]}),n.jsx("h4",{className:"text-sm font-medium text-gray-300 mb-3",children:"Key Functions"}),n.jsx("div",{className:"space-y-2",children:w(r).map((F,L)=>n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:`w-2 h-2 rounded-full ${j.color.replace("bg-","bg-")}`}),n.jsx("span",{className:"text-sm text-gray-300",children:F})]},L))})]}),n.jsxs("div",{children:[n.jsx("h4",{className:"text-sm font-medium text-gray-300 mb-3",children:"AgentOS Integration"}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500"}),n.jsx("span",{className:"text-sm text-gray-300",children:"Active in AgentOS platform"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500"}),n.jsx("span",{className:"text-sm text-gray-300",children:"Real-time data processing"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"w-2 h-2 rounded-full bg-purple-500"}),n.jsx("span",{className:"text-sm text-gray-300",children:"Cloud-native architecture"})]})]})]})]})]})})()})]})]});function w(j){return{sidebar:["Navigation menu","Industry-specific routing","User interface"],"main-content":["Page rendering","Component routing","Content display"],"industry-provider":["Industry context management","Theme configuration","Settings provider"],"theme-config":["UI theming","Brand customization","Color schemes"],"create-agent":["Agent creation wizard","Configuration forms","Deployment setup"],"quick-actions":["Rapid agent creation","Template selection","Workflow shortcuts"],"agents-table":["Agent listing","Status display","Management interface"],"agent-monitoring":["Performance metrics","Health monitoring","Real-time status"],"mcp-settings":["MCP server configuration","Connection management","Tool settings"],"mcp-dashboard":["MCP server overview","Tool registry","Connection status"],"agent-palette":["Pre-built agent templates","Drag & drop interface","Agent library"],"properties-panel":["Agent configuration","Parameter settings","Connection setup"],"real-agent-monitoring":["Live agent tracking","Performance analytics","Error monitoring"],"deployment-control":["Agent lifecycle","Start/stop controls","Resource management"],"general-settings":["Application settings","User preferences","System configuration"],"logo-settings":["Brand customization","Logo upload","Visual identity"],"aws-bedrock":["Foundation models","Claude AI integration","Model inference"],"aws-lambda":["Serverless functions","Event processing","Microservices"],"aws-s3":["Object storage","Static assets","Data persistence"],"aws-dynamodb":["NoSQL database","Agent state storage","Configuration data"],"aws-cloudwatch":["Monitoring & logging","Performance metrics","Error tracking"],"aws-iam":["Identity management","Access control","Security policies"],"aws-guardrails":["Content filtering","Safety controls","Compliance monitoring"],agentcore:["Agent orchestration","Workflow management","State coordination"],strands:["Multi-agent workflows","Complex reasoning","Agent coordination"],langgraph:["Graph-based workflows","State machines","Agent orchestration"]}[j]||["Core functionality","System integration","Data processing"]}},Zmt=()=>{const[e,t]=U.useState(!1),[r,i]=U.useState(null),[a,l]=U.useState(null),[d,s]=U.useState("overview"),p=[{id:"authentication",name:"AgentOS Authentication",icon:dn,color:"bg-blue-600",details:["AgentOS Login System","Role-based Access Control","Session Management"],parent:"user-interaction"},{id:"dashboard",name:"AgentOS Dashboard",icon:UD,color:"bg-blue-500",details:["Industry Selection Hub","AgentOS Navigation","Real-time Status Overview"],parent:"user-interaction"},{id:"theming",name:"AgentOS Theming Engine",icon:ws,color:"bg-blue-400",details:["Custom AgentOS Branding","Industry-specific Themes","UI Customization"],parent:"user-interaction"},{id:"agent-creation",name:"AgentOS Agent Creation",icon:Mo,color:"bg-green-600",details:["Simple Agent Mode","Advanced Agent Mode","AgentOS Step Wizard"],parent:"agent-command-centre"},{id:"quick-actions",name:"AgentOS Quick Actions",icon:Yi,color:"bg-green-500",details:["Create Agent","AWS Strands Workflow","Multi-Agent Workspace"],parent:"agent-command-centre"},{id:"project-management",name:"AgentOS Project Management",icon:ln,color:"bg-green-400",details:["Project Data Hub","Agent Traceability","Cost Analysis Dashboard"],parent:"agent-command-centre"},{id:"server-management",name:"AgentOS MCP Server Management",icon:eo,color:"bg-orange-600",details:["MCP Server Registry","Connection Health Monitor","Auto Discovery Engine"],parent:"mcp-gateway"},{id:"tool-registry",name:"AgentOS Tool Registry",icon:Bc,color:"bg-orange-500",details:["Tool Catalog System","Verification Engine","Category Management"],parent:"mcp-gateway"},{id:"gateway-analytics",name:"AgentOS Gateway Analytics",icon:to,color:"bg-orange-400",details:["Usage Metrics Dashboard","Performance Analytics","Success Rate Tracking"],parent:"mcp-gateway"},{id:"workspace-selector",name:"AgentOS Workspace Selector",icon:Zs,color:"bg-cyan-600",details:["Wealth Management OS","Telco CVM OS","Network Twin OS"],parent:"multi-agent-workspace"},{id:"agent-palette",name:"AgentOS Agent Palette",icon:Hi,color:"bg-cyan-500",details:["Pre-configured Agents","Drag & Drop Interface","Agent Templates"],parent:"multi-agent-workspace"},{id:"properties-panel",name:"AgentOS Properties Panel",icon:ws,color:"bg-cyan-400",details:["Agent Configuration","Connection Management","Parameter Settings"],parent:"multi-agent-workspace"},{id:"execution-engine",name:"AgentOS Execution Engine",icon:Yi,color:"bg-purple-600",details:["Task Processing Engine","Concurrent Execution","Load Balancing"],parent:"agent-runtime"},{id:"memory-manager",name:"AgentOS Memory Manager",icon:ln,color:"bg-purple-500",details:["Context Storage System","Memory Store Management","State Preservation"],parent:"agent-runtime"},{id:"framework-adapters",name:"AgentOS Framework Adapters",icon:ga,color:"bg-purple-400",details:["AWS Bedrock AgentCore","AWS Strands Integration","Custom Framework Support"],parent:"agent-runtime"},{id:"runtime-monitor",name:"AgentOS Runtime Monitor",icon:bs,color:"bg-red-600",details:["Real-time Agent Status","Performance Metrics","Health Check System"],parent:"agent-control-panel"},{id:"deployment-manager",name:"AgentOS Deployment Manager",icon:op,color:"bg-red-500",details:["Deploy/Stop/Start Controls","Lifecycle Management","Auto Scaling"],parent:"agent-control-panel"},{id:"identity-manager",name:"AgentOS Identity Manager",icon:dn,color:"bg-red-400",details:["Workload Identity Management","Credential Storage","Access Control"],parent:"agent-control-panel"},{id:"bedrock-services",name:"AWS Bedrock Services",icon:ti,color:"bg-amber-600",details:["Foundation Models","Claude Integration","Custom Model Support"],parent:"aws-services"},{id:"compute-services",name:"AWS Compute Services",icon:Yi,color:"bg-amber-500",details:["Lambda Functions","Step Functions","Auto Scaling Groups"],parent:"aws-services"},{id:"data-services",name:"AWS Data Services",icon:ln,color:"bg-amber-400",details:["S3 Storage","DynamoDB","CloudWatch Monitoring"],parent:"aws-services"},{id:"banking-os",name:"AgentOS Banking Solutions",icon:En,color:"bg-indigo-600",details:["Risk Analytics Engine","Wealth Management Platform","Compliance Framework"],parent:"industry-solutions"},{id:"telco-os",name:"AgentOS Telco Solutions",icon:ga,color:"bg-indigo-500",details:["Network Twin Platform","Customer Value Management","Operations Center"],parent:"industry-solutions"},{id:"healthcare-os",name:"AgentOS Healthcare Solutions",icon:qi,color:"bg-indigo-400",details:["Patient Care Platform","Clinical Support System","Healthcare Compliance"],parent:"industry-solutions"}],x={"user-interaction":{title:"AgentOS User Interface Layer",description:"Frontend interfaces and user experience components for the AgentOS platform",icon:qi,color:"blue",architecture:["AgentOS React Frontend Application","AgentOS Authentication & Authorization System","Industry-specific AgentOS Theming Engine","AgentOS Responsive Dashboard Framework","Real-time AgentOS Status Monitoring Interface"],services:["AgentOS React Frontend Framework","AgentOS Authentication Service","AgentOS Local Storage Management","AgentOS Industry Context Service"]},"agent-command-centre":{title:"AgentOS Command Centre",description:"Central hub for agent creation and management within the AgentOS ecosystem",icon:hb,color:"green",architecture:["AgentOS Agent Creation Wizard","AgentOS Quick Action Engine","AgentOS Project Management System","AgentOS Cost Analysis & Tracking","AgentOS Template Management Framework"],services:["AgentOS Agent Creation API","AgentOS Project Data Management Service","AgentOS Template Storage System","AgentOS Cost Tracking Service"]},"mcp-gateway":{title:"AgentOS MCP Gateway",description:"Model Context Protocol integration and tool management for AgentOS agents",icon:eo,color:"orange",architecture:["AgentOS MCP Server Discovery Engine","AgentOS Tool Registry & Verification System","AgentOS Gateway Load Balancer","AgentOS Analytics & Monitoring Dashboard","AgentOS Health Check & Failover System"],services:["AgentOS MCP Server Registry","AgentOS Tool Discovery Service","AgentOS Gateway Health Monitoring","AgentOS Connection Management Service"]},"multi-agent-workspace":{title:"AgentOS Multi-Agent Workspace",description:"Collaborative environment for multi-agent workflows within AgentOS",icon:Hi,color:"cyan",architecture:["AgentOS Workspace Management System","AgentOS Agent Palette & Template Library","AgentOS Drag & Drop Interface Engine","AgentOS Properties Configuration Panel","AgentOS Real-time Collaboration Framework"],services:["AgentOS Workspace State Management","AgentOS Agent Template System","AgentOS Drag & Drop Engine","AgentOS Properties Configuration Service"]},"agent-runtime":{title:"AgentOS Runtime Engine",description:"Core execution environment for AI agents within the AgentOS platform",icon:Yi,color:"purple",architecture:["AgentOS Multi-threaded Execution Engine","AgentOS Memory Management System","AgentOS Framework Adapter Layer","AgentOS Task Queue & Scheduler","AgentOS Context Preservation Engine"],services:["AWS Bedrock - Foundation Models","AWS AgentCore - Agent Framework","AWS Strands - Workflow Engine","AgentOS Memory Store Management","AgentOS Task Execution Service"]},"agent-control-panel":{title:"AgentOS Control Panel",description:"Monitoring and lifecycle management for agents within AgentOS",icon:bs,color:"red",architecture:["AgentOS Real-time Monitoring Dashboard","AgentOS Deployment Automation System","AgentOS Identity & Access Management","AgentOS Performance Analytics Engine","AgentOS Automated Scaling Framework"],services:["AgentOS Monitoring Dashboard Service","AgentOS Deployment Management API","AgentOS Performance Analytics Service","AgentOS Health Check System"]},"aws-services":{title:"AgentOS Core Services",description:"Core AWS services powering the AgentOS platform infrastructure",icon:op,color:"amber",architecture:["AgentOS AWS Bedrock Integration Layer","AgentOS Serverless Computing Framework","AgentOS Managed Database Services","AgentOS Monitoring & Observability Platform","AgentOS Security & Compliance Framework"],services:["AWS Bedrock - Foundation Models","AWS AgentCore - Agent Framework","AWS Strands - Workflow Engine","Model Context Protocol (MCP)","AgentOS Runtime Environment"]},"industry-solutions":{title:"AgentOS Industry Solutions",description:"Specialized AgentOS solutions tailored for different industry verticals",icon:Zs,color:"indigo",architecture:["AgentOS Banking & Financial Services Platform","AgentOS Telecommunications Operations Center","AgentOS Healthcare Management System","AgentOS Industry-specific AI Models","AgentOS Compliance & Regulatory Framework"],services:["AgentOS Banking - Wealth Management Platform","AgentOS Telco - Customer Value Management","AgentOS Healthcare - Patient Care System","AgentOS Industry-specific Templates","AgentOS Compliance & Risk Management"]}},w=({layerId:S,onClose:P})=>{const F=x[S];if(!F)return null;const L=F.icon,B=p.filter(V=>V.parent===S);return n.jsx(Ml,{open:!0,onOpenChange:P,children:n.jsxs(Qo,{className:"max-w-4xl max-h-[80vh] overflow-y-auto bg-gray-900 border-gray-700",children:[n.jsx(el,{children:n.jsxs(tl,{className:"flex items-center gap-3 text-white",children:[n.jsx("div",{className:`p-3 rounded-lg bg-${F.color}-600`,children:n.jsx(L,{className:"w-6 h-6 text-white"})}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl font-bold",children:F.title}),n.jsx("p",{className:"text-gray-400 text-sm font-normal",children:F.description})]})]})}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mt-6",children:[n.jsxs("div",{className:"space-y-4",children:[n.jsxs("h3",{className:"text-lg font-semibold text-white flex items-center gap-2",children:[n.jsx(ga,{className:"w-5 h-5"}),"AgentOS Components"]}),n.jsx("div",{className:"space-y-3",children:B.map(V=>{const $=V.icon;return n.jsxs("div",{className:"p-4 bg-gray-800 rounded-lg border border-gray-600",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[n.jsx("div",{className:`p-2 rounded-lg ${V.color}`,children:n.jsx($,{className:"w-4 h-4 text-white"})}),n.jsx("h4",{className:"font-medium text-white",children:V.name})]}),n.jsx("div",{className:"space-y-1",children:V.details.map(G=>n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${V.color.replace("bg-","bg-")} opacity-75`}),n.jsx("span",{className:"text-xs text-gray-300",children:G})]},G))})]},V.id)})})]}),n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{children:[n.jsxs("h3",{className:"text-lg font-semibold text-white flex items-center gap-2 mb-4",children:[n.jsx(Bc,{className:"w-5 h-5"}),"AgentOS Architecture"]}),n.jsx("div",{className:"space-y-2",children:F.architecture.map((V,$)=>n.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-800 rounded-lg",children:[n.jsx("div",{className:`w-2 h-2 rounded-full bg-${F.color}-500`}),n.jsx("span",{className:"text-sm text-gray-300",children:V})]},$))})]}),n.jsxs("div",{children:[n.jsxs("h3",{className:"text-lg font-semibold text-white flex items-center gap-2 mb-4",children:[n.jsx(op,{className:"w-5 h-5"}),"AgentOS Services"]}),n.jsx("div",{className:"space-y-2",children:F.services.map((V,$)=>n.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-800 rounded-lg",children:[n.jsx("div",{className:"w-2 h-2 rounded-full bg-orange-500"}),n.jsx("span",{className:"text-sm text-gray-300",children:V})]},$))})]})]})]})]})})},j=({component:S,isAnimating:P,compact:F=!1})=>{const L=S.icon,B=r===S.id;return n.jsxs("div",{className:`relative group cursor-pointer transition-all duration-300 ${B?"scale-105 z-30":"z-20"}`,onClick:()=>i(B?null:S.id),children:[n.jsx("div",{className:`absolute inset-0 rounded-lg ${S.color} opacity-20 blur-lg ${B?"opacity-40 blur-xl":""} ${P?"animate-pulse":""}`}),n.jsx("div",{className:`relative ${F?"p-3":"p-4"} rounded-lg border-2 ${B?"border-purple-400 shadow-lg shadow-purple-400/30":"border-gray-600/50"} bg-gray-900/90 backdrop-blur-sm hover:border-gray-500 transition-all ${F?"min-h-[140px]":"min-h-[160px]"}`,children:n.jsxs("div",{className:"flex flex-col gap-3",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs("div",{className:`${F?"p-2":"p-3"} rounded-lg ${S.color} relative`,children:[n.jsx(L,{className:`${F?"w-4 h-4":"w-5 h-5"} text-white`}),n.jsx("div",{className:"absolute -top-1 -right-1 w-2 h-2 rounded-full bg-green-400 animate-pulse"})]}),n.jsx("div",{className:"flex-1 min-w-0",children:n.jsx("h4",{className:"text-sm font-medium text-white leading-tight",children:S.name})})]}),n.jsx("div",{className:"space-y-1.5 pl-2",children:S.details.map((V,$)=>n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${S.color.replace("bg-","bg-")} opacity-75`}),n.jsx("span",{className:"text-xs text-gray-300 leading-tight",children:V})]},V))})]})}),n.jsx("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-800 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none whitespace-nowrap z-40",children:"Click for AgentOS details"})]})};return n.jsx("div",{className:"space-y-6",children:n.jsxs(jt,{className:"bg-gray-900 border-gray-700",children:[n.jsx(wr,{children:n.jsxs("div",{children:[n.jsxs(fr,{className:"text-white flex items-center gap-2",children:[n.jsx(ga,{className:"w-5 h-5"}),"AgentOS Architecture Blueprint"]}),n.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"Complete AgentOS platform architecture and logical flow visualization"})]})}),n.jsx(Ht,{children:n.jsxs($i,{defaultValue:"architecture",className:"w-full",children:[n.jsxs(Di,{className:"grid w-full grid-cols-2 bg-gray-800",children:[n.jsxs(Jt,{value:"architecture",className:"flex items-center gap-2",children:[n.jsx(ln,{className:"w-4 h-4"}),"Architecture Blueprint"]}),n.jsxs(Jt,{value:"logical-flow",className:"flex items-center gap-2",children:[n.jsx(p_,{className:"w-4 h-4"}),"AgentOS Logical Flow"]})]}),n.jsxs(ur,{value:"architecture",className:"space-y-6 mt-6",children:[n.jsxs("div",{className:"flex flex-row items-center justify-between mb-4",children:[n.jsx("div",{}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx(lt,{variant:d==="overview"?"default":"outline",size:"sm",onClick:()=>s("overview"),className:"text-white",children:"Overview"}),n.jsx(lt,{variant:d==="detailed"?"default":"outline",size:"sm",onClick:()=>s("detailed"),className:"text-white",children:"Detailed"}),n.jsxs(lt,{variant:e?"default":"outline",size:"sm",onClick:()=>t(!e),className:"text-white",children:[e?n.jsx(zQ,{className:"w-4 h-4 mr-2"}):n.jsx(Sh,{className:"w-4 h-4 mr-2"}),e?"Pause Flow":"Start Flow"]})]})]}),n.jsxs("div",{className:"relative bg-gradient-to-br from-indigo-950 via-purple-950 to-gray-900 rounded-lg border-2 border-purple-500/30 p-8 min-h-[800px]",children:[n.jsx("div",{className:"absolute top-4 left-4 right-4 h-16 border-2 border-orange-500/50 rounded-lg bg-orange-500/10 flex items-center px-4",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(op,{className:"w-5 h-5 text-orange-400"}),n.jsx("span",{className:"text-orange-400 font-medium",children:"AgentOS Cloud Infrastructure"})]})}),n.jsxs("div",{className:"mt-24 space-y-8",children:[n.jsxs("div",{className:"border-2 border-blue-500/50 rounded-lg bg-blue-500/10 p-6 cursor-pointer hover:bg-blue-500/20 transition-all duration-300",onClick:()=>l("user-interaction"),children:[n.jsxs("h3",{className:"text-blue-400 font-medium mb-4 flex items-center gap-2",children:[n.jsx(qi,{className:"w-4 h-4"}),"AgentOS User Interface Layer",n.jsx("span",{className:"text-xs text-gray-400 ml-auto",children:"Click to explore"})]}),n.jsx("div",{className:"grid grid-cols-3 gap-4",children:p.filter(S=>S.parent==="user-interaction").map(S=>n.jsx(j,{component:S,isAnimating:e},S.id))})]}),n.jsxs("div",{className:"border-2 border-green-500/50 rounded-lg bg-green-500/10 p-6 cursor-pointer hover:bg-green-500/20 transition-all duration-300",onClick:()=>l("agent-command-centre"),children:[n.jsxs("h3",{className:"text-green-400 font-medium mb-4 flex items-center gap-2",children:[n.jsx(hb,{className:"w-4 h-4"}),"AgentOS Command Centre",n.jsx("span",{className:"text-xs text-gray-400 ml-auto",children:"Click to explore"})]}),n.jsx("div",{className:"grid grid-cols-3 gap-4",children:p.filter(S=>S.parent==="agent-command-centre").map(S=>n.jsx(j,{component:S,isAnimating:e},S.id))})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[n.jsxs("div",{className:"border-2 border-orange-500/50 rounded-lg bg-orange-500/10 p-6 cursor-pointer hover:bg-orange-500/20 transition-all duration-300",onClick:()=>l("mcp-gateway"),children:[n.jsxs("h3",{className:"text-orange-400 font-medium mb-4 flex items-center gap-2",children:[n.jsx(eo,{className:"w-4 h-4"}),"AgentOS MCP Gateway",n.jsx("span",{className:"text-xs text-gray-400 ml-auto",children:"Click to explore"})]}),n.jsx("div",{className:"space-y-3",children:p.filter(S=>S.parent==="mcp-gateway").map(S=>n.jsx(j,{component:S,isAnimating:e,compact:!0},S.id))})]}),n.jsxs("div",{className:"border-2 border-cyan-500/50 rounded-lg bg-cyan-500/10 p-6 cursor-pointer hover:bg-cyan-500/20 transition-all duration-300",onClick:()=>l("multi-agent-workspace"),children:[n.jsxs("h3",{className:"text-cyan-400 font-medium mb-4 flex items-center gap-2",children:[n.jsx(Hi,{className:"w-4 h-4"}),"AgentOS Multi-Agent Workspace",n.jsx("span",{className:"text-xs text-gray-400 ml-auto",children:"Click to explore"})]}),n.jsx("div",{className:"space-y-3",children:p.filter(S=>S.parent==="multi-agent-workspace").map(S=>n.jsx(j,{component:S,isAnimating:e,compact:!0},S.id))})]})]}),n.jsxs("div",{className:"border-2 border-purple-500/50 rounded-lg bg-purple-500/10 p-6 cursor-pointer hover:bg-purple-500/20 transition-all duration-300",onClick:()=>l("agent-runtime"),children:[n.jsxs("h3",{className:"text-purple-400 font-medium mb-4 flex items-center gap-2",children:[n.jsx(Yi,{className:"w-4 h-4"}),"AgentOS Runtime Engine",n.jsx("span",{className:"text-xs text-gray-400 ml-auto",children:"Click to explore"})]}),n.jsx("div",{className:"grid grid-cols-3 gap-4",children:p.filter(S=>S.parent==="agent-runtime").map(S=>n.jsx(j,{component:S,isAnimating:e},S.id))})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[n.jsxs("div",{className:"border-2 border-red-500/50 rounded-lg bg-red-500/10 p-6 cursor-pointer hover:bg-red-500/20 transition-all duration-300",onClick:()=>l("agent-control-panel"),children:[n.jsxs("h3",{className:"text-red-400 font-medium mb-4 flex items-center gap-2",children:[n.jsx(bs,{className:"w-4 h-4"}),"AgentOS Control Panel",n.jsx("span",{className:"text-xs text-gray-400 ml-auto",children:"Click to explore"})]}),n.jsx("div",{className:"space-y-3",children:p.filter(S=>S.parent==="agent-control-panel").map(S=>n.jsx(j,{component:S,isAnimating:e,compact:!0},S.id))})]}),n.jsxs("div",{className:"border-2 border-amber-500/50 rounded-lg bg-amber-500/10 p-6 cursor-pointer hover:bg-amber-500/20 transition-all duration-300",onClick:()=>l("aws-services"),children:[n.jsxs("h3",{className:"text-amber-400 font-medium mb-4 flex items-center gap-2",children:[n.jsx(op,{className:"w-4 h-4"}),"AgentOS Core Services",n.jsx("span",{className:"text-xs text-gray-400 ml-auto",children:"Click to explore"})]}),n.jsx("div",{className:"space-y-3",children:p.filter(S=>S.parent==="aws-services").map(S=>n.jsx(j,{component:S,isAnimating:e,compact:!0},S.id))})]})]}),n.jsxs("div",{className:"border-2 border-indigo-500/50 rounded-lg bg-indigo-500/10 p-6 cursor-pointer hover:bg-indigo-500/20 transition-all duration-300",onClick:()=>l("industry-solutions"),children:[n.jsxs("h3",{className:"text-indigo-400 font-medium mb-4 flex items-center gap-2",children:[n.jsx(Zs,{className:"w-4 h-4"}),"AgentOS Industry Solutions",n.jsx("span",{className:"text-xs text-gray-400 ml-auto",children:"Click to explore"})]}),n.jsx("div",{className:"grid grid-cols-3 gap-4",children:p.filter(S=>S.parent==="industry-solutions").map(S=>n.jsx(j,{component:S,isAnimating:e},S.id))})]})]})]}),r&&n.jsx("div",{className:"mt-6 p-4 bg-gray-800 rounded-lg border border-gray-600",children:(()=>{const S=p.find(F=>F.id===r);if(!S)return null;const P=S.icon;return n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[n.jsx("div",{className:`p-3 rounded-lg ${S.color}`,children:n.jsx(P,{className:"w-6 h-6 text-white"})}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-xl font-semibold text-white",children:S.name}),n.jsx(Tt,{variant:"secondary",className:"mt-1",children:"AgentOS Component"})]})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsx("h4",{className:"text-sm font-medium text-gray-300 mb-3",children:"Key Features"}),n.jsx("div",{className:"space-y-2",children:S.details.map((F,L)=>n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:`w-2 h-2 rounded-full ${S.color.replace("bg-","bg-")}`}),n.jsx("span",{className:"text-sm text-gray-300",children:F})]},F))})]}),n.jsxs("div",{children:[n.jsx("h4",{className:"text-sm font-medium text-gray-300 mb-3",children:"AgentOS Integration"}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500"}),n.jsx("span",{className:"text-sm text-gray-300",children:"Fully integrated with AgentOS platform"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500"}),n.jsx("span",{className:"text-sm text-gray-300",children:"Real-time monitoring and analytics"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"w-2 h-2 rounded-full bg-purple-500"}),n.jsx("span",{className:"text-sm text-gray-300",children:"Scalable cloud-native architecture"})]})]})]})]})]})})()}),a&&n.jsx(w,{layerId:a,onClose:()=>l(null)})]}),n.jsx(ur,{value:"logical-flow",className:"space-y-6 mt-6",children:n.jsx(Kmt,{})})]})})]})})},Ymt=()=>n.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[n.jsxs("div",{className:"mb-6",children:[n.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"System Architecture Flow"}),n.jsx("p",{className:"text-gray-400",children:"Visualize how the Agent Command Centre connects to MCP Gateway, Agent Control Panel, and the entire system workflow"})]}),n.jsx(Zmt,{})]});function Xmt(){return n.jsxs(XF,{children:[n.jsx(gwe,{children:n.jsxs(cwe,{children:[n.jsx(jo,{path:"/",element:n.jsx(Ia,{children:n.jsx(TNe,{})})}),n.jsx(jo,{path:"/agents",element:n.jsx(Ia,{children:n.jsx(hWe,{})})}),n.jsx(jo,{path:"/multi-agent-workspace",element:n.jsx(Ia,{children:n.jsx(btt,{})})}),n.jsx(jo,{path:"/agent-command",element:n.jsx(Ia,{children:n.jsx(Xst,{})})}),n.jsx(jo,{path:"/agent-exchange",element:n.jsx(Ia,{children:n.jsx(smt,{})})}),n.jsx(jo,{path:"/risk-analytics",element:n.jsx(Ia,{children:n.jsx(Amt,{})})}),n.jsx(jo,{path:"/network-twin",element:n.jsx(Ia,{children:n.jsx(Cmt,{})})}),n.jsx(jo,{path:"/wealth-management",element:n.jsx(Ia,{children:n.jsx(uat,{})})}),n.jsx(jo,{path:"/customer-insights",element:n.jsx(Ia,{children:n.jsx(Sut,{})})}),n.jsx(jo,{path:"/customer-analytics",element:n.jsx(Ia,{children:n.jsx(Cut,{})})}),n.jsx(jo,{path:"/auth",element:n.jsx(Tmt,{})}),n.jsx(jo,{path:"/settings",element:n.jsx(Ia,{children:n.jsx(Pmt,{})})}),n.jsx(jo,{path:"/agent-control",element:n.jsx(Ia,{children:n.jsx(Emt,{})})}),n.jsx(jo,{path:"/mcp-dashboard",element:n.jsx(Ia,{children:n.jsx($mt,{})})}),n.jsx(jo,{path:"/mcp-test",element:n.jsx(Ia,{children:n.jsx(Wmt,{})})}),n.jsx(jo,{path:"/system-flow",element:n.jsx(Ia,{children:n.jsx(Ymt,{})})})]})}),n.jsx(jbe,{}),n.jsx(Kbe,{richColors:!0})]})}const Jmt=new Zxe;FR.createRoot(document.getElementById("root")).render(n.jsx(ke.StrictMode,{children:n.jsx(Xxe,{client:Jmt,children:n.jsx(_be,{children:n.jsx(Xje,{children:n.jsx(Xmt,{})})})})}));export{Vi as g};
