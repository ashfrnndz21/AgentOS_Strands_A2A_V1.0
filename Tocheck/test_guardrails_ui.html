<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Guardrails UI</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #1a1a1a;
            color: white;
            padding: 20px;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
        }
        .section {
            background-color: #2a2a2a;
            border: 1px solid #444;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }
        .section h3 {
            color: #8b5cf6;
            margin-top: 0;
        }
        .toggle {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: #374151;
            padding: 12px;
            border-radius: 6px;
            margin-bottom: 10px;
        }
        .input-group {
            margin-bottom: 15px;
        }
        .input-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        .input-group input, .input-group select, .input-group textarea {
            width: 100%;
            padding: 8px;
            background-color: #374151;
            border: 1px solid #6b7280;
            border-radius: 4px;
            color: white;
        }
        .flex-row {
            display: flex;
            gap: 10px;
        }
        .flex-row > div {
            flex: 1;
        }
        .badge {
            display: inline-block;
            background-color: #6366f1;
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            margin: 2px;
            font-size: 12px;
        }
        .badge .remove {
            margin-left: 5px;
            cursor: pointer;
            color: #ff6b6b;
        }
        .add-button {
            background-color: #10b981;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
        }
        .custom-fields {
            background-color: #1f2937;
            padding: 15px;
            border-radius: 6px;
            margin-top: 10px;
        }
        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üõ°Ô∏è Dynamic Guardrails Test Interface</h1>
        <p>This interface demonstrates the dynamic guardrails functionality that should be available in the agent creation.</p>

        <!-- System Guardrails -->
        <div class="section">
            <h3>üîí System Guardrails</h3>
            <div class="toggle">
                <div>
                    <strong>Global Guardrails</strong>
                    <div style="font-size: 12px; color: #9ca3af;">Apply organization-wide safety rules</div>
                </div>
                <input type="checkbox" id="globalGuardrails">
            </div>
            <div class="toggle">
                <div>
                    <strong>Local Guardrails</strong>
                    <div style="font-size: 12px; color: #9ca3af;">Apply project-specific safety rules</div>
                </div>
                <input type="checkbox" id="localGuardrails">
            </div>
        </div>

        <!-- PII Redaction -->
        <div class="section">
            <h3>üëÅÔ∏è PII Redaction</h3>
            <div class="toggle">
                <div>
                    <strong>Enable PII Protection</strong>
                    <div style="font-size: 12px; color: #9ca3af;">Automatically redact personally identifiable information</div>
                </div>
                <input type="checkbox" id="piiEnabled" onchange="togglePiiFields()">
            </div>

            <div id="piiFields" class="custom-fields hidden">
                <div class="flex-row">
                    <div class="input-group">
                        <label>Redaction Strategy</label>
                        <select id="piiStrategy" onchange="updatePiiStrategy()">
                            <option value="mask">Mask with characters</option>
                            <option value="remove">Remove completely</option>
                            <option value="placeholder">Replace with placeholder</option>
                        </select>
                    </div>
                    <div class="input-group" id="maskCharField" style="display: none;">
                        <label>Mask Character</label>
                        <input type="text" maxlength="1" value="*" placeholder="*">
                    </div>
                    <div class="input-group" id="placeholderField">
                        <label>Placeholder Text</label>
                        <input type="text" value="[REDACTED]" placeholder="[REDACTED]">
                    </div>
                </div>

                <div class="input-group">
                    <label>Custom PII Types</label>
                    <div class="flex-row">
                        <input type="text" id="newPiiType" placeholder="e.g., Employee ID, Badge Number">
                        <button class="add-button" onclick="addPiiType()">Add</button>
                    </div>
                    <div id="piiTypes" style="margin-top: 10px;">
                        <!-- Dynamic badges will appear here -->
                    </div>
                </div>

                <div class="input-group">
                    <label>Custom Regex Patterns</label>
                    <div class="flex-row">
                        <input type="text" id="newPattern" placeholder="e.g., \\b\\d{3}-\\d{2}-\\d{4}\\b for SSN">
                        <button class="add-button" onclick="addPattern()">Add</button>
                    </div>
                    <div id="patterns" style="margin-top: 10px;">
                        <!-- Dynamic patterns will appear here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Content Filtering -->
        <div class="section">
            <h3>üö´ Content Filtering</h3>
            <div class="toggle">
                <div>
                    <strong>Enable Content Filter</strong>
                    <div style="font-size: 12px; color: #9ca3af;">Filter harmful or inappropriate content</div>
                </div>
                <input type="checkbox" id="contentEnabled" onchange="toggleContentFields()">
            </div>

            <div id="contentFields" class="custom-fields hidden">
                <div class="input-group">
                    <label>Filter Level</label>
                    <select>
                        <option value="basic">Basic - Block clearly harmful content</option>
                        <option value="moderate" selected>Moderate - Balanced filtering</option>
                        <option value="strict">Strict - Conservative filtering</option>
                    </select>
                </div>

                <div class="input-group">
                    <label>Custom Blocked Keywords</label>
                    <div class="flex-row">
                        <input type="text" id="newKeyword" placeholder="Enter keyword to block">
                        <button class="add-button" onclick="addKeyword()">Add</button>
                    </div>
                    <div id="keywords" style="margin-top: 10px;">
                        <!-- Dynamic keywords will appear here -->
                    </div>
                </div>

                <div class="input-group">
                    <label>Blocked Phrases</label>
                    <textarea rows="3" placeholder="Enter phrases to block (one per line)"></textarea>
                </div>

                <div class="input-group">
                    <label>Allowed Domains (Optional)</label>
                    <textarea rows="2" placeholder="Enter allowed domains (one per line, e.g., company.com)"></textarea>
                </div>
            </div>
        </div>

        <!-- Behavior Limits -->
        <div class="section">
            <h3>‚ö†Ô∏è Behavior Limits</h3>
            <div class="toggle">
                <div>
                    <strong>Enable Behavior Limits</strong>
                    <div style="font-size: 12px; color: #9ca3af;">Restrict harmful advice and inappropriate responses</div>
                </div>
                <input type="checkbox" id="behaviorEnabled" onchange="toggleBehaviorFields()">
            </div>

            <div id="behaviorFields" class="custom-fields hidden">
                <div class="flex-row">
                    <div class="input-group">
                        <label>Max Response Length</label>
                        <input type="number" value="2000" min="100" max="5000">
                    </div>
                    <div class="toggle" style="margin-top: 20px;">
                        <div>
                            <strong>Require Approval</strong>
                            <div style="font-size: 12px; color: #9ca3af;">Require human approval for responses</div>
                        </div>
                        <input type="checkbox">
                    </div>
                </div>

                <div class="input-group">
                    <label>Custom Behavior Restrictions</label>
                    <div class="flex-row">
                        <input type="text" id="newLimit" placeholder="e.g., No investment advice, No legal counsel">
                        <button class="add-button" onclick="addLimit()">Add</button>
                    </div>
                    <div id="limits" style="margin-top: 10px;">
                        <!-- Dynamic limits will appear here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Custom Rules -->
        <div class="section">
            <h3>‚öôÔ∏è Custom Rules</h3>
            <div class="custom-fields">
                <h4>Create Custom Rule</h4>
                <div class="flex-row">
                    <div class="input-group">
                        <label>Rule Name</label>
                        <input type="text" placeholder="e.g., Block Competitor Names">
                    </div>
                    <div class="input-group">
                        <label>Action</label>
                        <select>
                            <option value="block">Block completely</option>
                            <option value="warn">Show warning</option>
                            <option value="replace">Replace with text</option>
                        </select>
                    </div>
                </div>
                <div class="input-group">
                    <label>Description</label>
                    <textarea rows="2" placeholder="Describe what this rule does"></textarea>
                </div>
                <div class="flex-row">
                    <div class="input-group">
                        <label>Pattern (Optional)</label>
                        <input type="text" placeholder="Regex pattern or keyword">
                    </div>
                    <div class="input-group">
                        <label>Replacement Text</label>
                        <input type="text" placeholder="Text to replace with">
                    </div>
                </div>
                <button class="add-button" style="width: 100%; margin-top: 10px;">Add Custom Rule</button>
            </div>
        </div>

        <!-- Summary -->
        <div class="section" style="background-color: #065f46; border-color: #10b981;">
            <h3>üìä Configuration Summary</h3>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                <div>
                    <strong>System:</strong>
                    <div id="systemSummary">None</div>
                </div>
                <div>
                    <strong>PII Protection:</strong>
                    <div id="piiSummary">Disabled</div>
                </div>
                <div>
                    <strong>Content Filter:</strong>
                    <div id="contentSummary">Disabled</div>
                </div>
                <div>
                    <strong>Custom Rules:</strong>
                    <div id="rulesSummary">0 active</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Sample data arrays
        let piiTypes = [];
        let patterns = [];
        let keywords = [];
        let limits = [];

        function togglePiiFields() {
            const enabled = document.getElementById('piiEnabled').checked;
            const fields = document.getElementById('piiFields');
            fields.classList.toggle('hidden', !enabled);
            updateSummary();
        }

        function toggleContentFields() {
            const enabled = document.getElementById('contentEnabled').checked;
            const fields = document.getElementById('contentFields');
            fields.classList.toggle('hidden', !enabled);
            updateSummary();
        }

        function toggleBehaviorFields() {
            const enabled = document.getElementById('behaviorEnabled').checked;
            const fields = document.getElementById('behaviorFields');
            fields.classList.toggle('hidden', !enabled);
            updateSummary();
        }

        function updatePiiStrategy() {
            const strategy = document.getElementById('piiStrategy').value;
            const maskField = document.getElementById('maskCharField');
            const placeholderField = document.getElementById('placeholderField');
            
            maskField.style.display = strategy === 'mask' ? 'block' : 'none';
            placeholderField.style.display = strategy === 'placeholder' ? 'block' : 'none';
        }

        function addPiiType() {
            const input = document.getElementById('newPiiType');
            const value = input.value.trim();
            if (value && !piiTypes.includes(value)) {
                piiTypes.push(value);
                input.value = '';
                renderBadges('piiTypes', piiTypes, removePiiType);
                updateSummary();
            }
        }

        function addPattern() {
            const input = document.getElementById('newPattern');
            const value = input.value.trim();
            if (value && !patterns.includes(value)) {
                patterns.push(value);
                input.value = '';
                renderPatterns();
                updateSummary();
            }
        }

        function addKeyword() {
            const input = document.getElementById('newKeyword');
            const value = input.value.trim();
            if (value && !keywords.includes(value)) {
                keywords.push(value);
                input.value = '';
                renderBadges('keywords', keywords, removeKeyword);
                updateSummary();
            }
        }

        function addLimit() {
            const input = document.getElementById('newLimit');
            const value = input.value.trim();
            if (value && !limits.includes(value)) {
                limits.push(value);
                input.value = '';
                renderBadges('limits', limits, removeLimit);
                updateSummary();
            }
        }

        function renderBadges(containerId, array, removeFunction) {
            const container = document.getElementById(containerId);
            container.innerHTML = array.map((item, index) => 
                `<span class="badge">${item}<span class="remove" onclick="${removeFunction.name}(${index})">√ó</span></span>`
            ).join('');
        }

        function renderPatterns() {
            const container = document.getElementById('patterns');
            container.innerHTML = patterns.map((pattern, index) => 
                `<div style="display: flex; justify-content: space-between; align-items: center; background-color: #374151; padding: 8px; border-radius: 4px; margin-bottom: 5px;">
                    <code style="color: #10b981;">${pattern}</code>
                    <span class="remove" onclick="removePattern(${index})" style="cursor: pointer; color: #ef4444;">√ó</span>
                </div>`
            ).join('');
        }

        function removePiiType(index) {
            piiTypes.splice(index, 1);
            renderBadges('piiTypes', piiTypes, removePiiType);
            updateSummary();
        }

        function removePattern(index) {
            patterns.splice(index, 1);
            renderPatterns();
            updateSummary();
        }

        function removeKeyword(index) {
            keywords.splice(index, 1);
            renderBadges('keywords', keywords, removeKeyword);
            updateSummary();
        }

        function removeLimit(index) {
            limits.splice(index, 1);
            renderBadges('limits', limits, removeLimit);
            updateSummary();
        }

        function updateSummary() {
            const globalEnabled = document.getElementById('globalGuardrails').checked;
            const localEnabled = document.getElementById('localGuardrails').checked;
            const piiEnabled = document.getElementById('piiEnabled').checked;
            const contentEnabled = document.getElementById('contentEnabled').checked;
            const behaviorEnabled = document.getElementById('behaviorEnabled').checked;

            document.getElementById('systemSummary').textContent = 
                globalEnabled || localEnabled ? 'Enabled' : 'None';
            
            document.getElementById('piiSummary').textContent = 
                piiEnabled ? `${document.getElementById('piiStrategy').value} (${piiTypes.length + patterns.length} custom)` : 'Disabled';
            
            document.getElementById('contentSummary').textContent = 
                contentEnabled ? `moderate (${keywords.length} keywords)` : 'Disabled';
            
            document.getElementById('rulesSummary').textContent = 
                `${limits.length} active`;
        }

        // Initialize
        updatePiiStrategy();
        updateSummary();

        // Add some sample data
        setTimeout(() => {
            piiTypes = ['Employee ID', 'Badge Number'];
            patterns = ['\\bEMP-\\d{6}\\b', '\\b\\d{3}-\\d{2}-\\d{4}\\b'];
            keywords = ['confidential', 'internal'];
            limits = ['No investment advice', 'No legal counsel'];
            
            renderBadges('piiTypes', piiTypes, removePiiType);
            renderPatterns();
            renderBadges('keywords', keywords, removeKeyword);
            renderBadges('limits', limits, removeLimit);
            updateSummary();
        }, 1000);
    </script>
</body>
</html>